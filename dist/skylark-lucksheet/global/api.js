/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../store","../utils/util","../methods/get","../locale/locale","./method","./formula","./func_methods","./tooltip","./json","./editor","./formula","./cleargridelement","./format","./setdata","./sort","./getRowlen","./getdata","./refresh","./extend","./validate","./datecontroll","./border","./draw","../controllers/server","../controllers/menuButton","../controllers/selection","../controllers/luckysheetConfigsetting","../controllers/freezen","../controllers/resize","../controllers/sheetmanage","../controllers/conditionformat","../controllers/sheetSearch","../controllers/select","../controllers/constant","../controllers/filter","../controllers/controlHistory","../controllers/zoom","../controllers/dataVerificationCtrl","../controllers/imageCtrl","skylark-moment","../controllers/updateCell"],function(e,t,l,n,r,o,i,a,s,c,u,f,d,h,g,m,p,y,v,w,x,k,b,S,_,T,I,C,R,z,M,F,j,D,H,A,B,O,P,N,E){"use strict";const{replaceHtml:V,getObjType:W,chatatABC:G,luckysheetactiveCell:L}=t,{getSheetIndex:U,getluckysheet_select_save:Y,getluckysheetfile:J,getRangetxt:q}=l,{genarate:Z,update:Q}=d,{setAccuracy:K,setcellvalue:X}=h,{orderbydata:ee}=g,{rowlenByRange:te}=m,{getdatabyselection:le,getcellvalue:ne}=p,{luckysheetrefreshgrid:re,jfrefreshgrid:oe,jfrefreshgrid_rhcw:ie}=y,{luckysheetDeleteCell:ae,luckysheetextendtable:se,luckysheetdeletetable:ce}=v,{isRealNull:ue,valueIsError:fe,isRealNum:de,isEditMode:he,hasPartMC:ge}=w,{isdatetime:me,diff:pe}=x,{getBorderInfoCompute:ye}=k,{luckysheetDrawMain:ve}=b,{luckysheet_searcharray:we}=F,{selectHightlightShow:xe,selectIsOverlap:ke}=j,{sheetHTML:be,luckysheetdefaultstyle:Se}=D,{createFilterOptions:_e}=H,{zoomRefreshView:Te,zoomNumberDomBind:Ie}=B,{luckysheetupdateCell:Ce}=E;function $e(t,l,n,i={}){let s=e.flowdata[t][l];const c=JSON.stringify(s);if(!de(t)||!de(l))return a.info("The row or column parameter is invalid.","");let{order:f=U(e.currentSheetIndex),isRefresh:d=!0,success:h}={...i},g=e.luckysheetfile[f];if(null==g)return a.info("The order parameter is invalid.","");if(!r.createHookFunction("cellUpdateBefore",t,l,n,d))return;let m=g.data;d&&(m=$.extend(!0,[],g.data)),0==m.length&&(m=z.buildGridData(g));let p={bg:1,ff:1,fc:1,bl:1,it:1,fs:1,cl:1,un:1,vt:1,ht:1,mc:1,tr:1,tb:1,rt:1,qp:1};if(null==n||0==n.toString().length)o.delFunctionGroup(t,l),X(t,l,m,n);else if(n instanceof Object){let e={},r=m[t][l];ue(r)&&(r={}),null!=n.f&&null==n.v?(e.f=n.f,null!=n.ct&&(e.ct=n.ct),m=u.updatecell(t,l,e,!1).data):(null!=n.ct&&(e.ct=n.ct),null!=n.f&&(e.f=n.f),null!=n.v?e.v=n.v:e.v=r.v,null!=n.m&&(e.m=n.m),o.delFunctionGroup(t,l),X(t,l,m,e));for(let e in n){let o=n[e];e in p?_.updateFormatCell(m,e,o,t,t,l,l):r[e]=o}m[t][l]=r}else"="==n.toString().substr(0,1)||"<span"==n.toString().substr(0,5)?m=u.updatecell(t,l,n,!1).data:(o.delFunctionGroup(t,l),X(t,l,m,n));setTimeout(()=>{r.createHookFunction("cellUpdated",t,l,JSON.parse(c),e.flowdata[t][l],d)},0),g.index==e.currentSheetIndex&&d?oe(m,[{row:[t,t],column:[l,l]}]):g.data=m,h&&"function"==typeof h&&h(m)}function Re(t,l={}){if(!t&&0!=t)return a.info("Search content cannot be null or empty","");let n=U(e.currentSheetIndex),{isRegularExpression:r=!1,isWholeWord:o=!1,isCaseSensitive:s=!1,order:c=n,type:u="m"}={...l},f=e.luckysheetfile[c].data,d=[];for(let e=0;e<f.length;e++){const l=f[e];for(let n=0;n<l.length;n++){const a=l[n];if(a)if(a.row=e,a.column=n,o)s?t.toString()==a[u]&&d.push(a):a[u]&&t.toString().toLowerCase()==a[u].toLowerCase()&&d.push(a);else if(r){let e;(e=s?new RegExp(i.getRegExpStr(t),"g"):new RegExp(i.getRegExpStr(t),"ig")).test(a[u])&&d.push(a)}else if(s){new RegExp(i.getRegExpStr(t),"g").test(a[u])&&d.push(a)}else{new RegExp(i.getRegExpStr(t),"ig").test(a[u])&&d.push(a)}}}return d}function ze(t){if(C.saveFrozen("freezenRow",t),!t||t==U(e.currentSheetIndex)){let t=$("#luckysheet-cell-main").scrollTop(),l=we(e.visibledatarow,t);-1==l&&(l=0);let n=e.visibledatarow[l]-2-t+e.columnHeaderHeight,r=[e.visibledatarow[l],l+1,t,C.cutVolumn(e.visibledatarow,l+1),n];C.saveFreezen(r,n,null,null),null!=C.freezenverticaldata&&(C.cancelFreezenVertical(),C.createAssistCanvas(),re()),C.createFreezenHorizontal(r,n),C.createAssistCanvas(),re()}}function Me(t){if(C.saveFrozen("freezenColumn",t),!t||t==U(e.currentSheetIndex)){let t=$("#luckysheet-cell-main").scrollLeft(),l=we(e.visibledatacolumn,t);-1==l&&(l=0);let n=e.visibledatacolumn[l]-2-t+e.rowHeaderWidth,r=[e.visibledatacolumn[l],l+1,t,C.cutVolumn(e.visibledatacolumn,l+1),n];C.saveFreezen(null,null,r,n),null!=C.freezenhorizontaldata&&(C.cancelFreezenHorizontal(),C.createAssistCanvas(),re()),C.createFreezenVertical(r,n),C.createAssistCanvas(),re()}}function Fe(t,l){const r=n().freezen;if(t&&(t.hasOwnProperty("row_focus")||o.iscelldata(t))){if("string"==typeof t&&o.iscelldata(t)&&(t={row_focus:(t=o.getcellrange(t)).row[0],column_focus:t.column[0]}),C.saveFrozen("freezenRowRange",l,t),!l||l==U(e.currentSheetIndex)){let l=$("#luckysheet-cell-main").scrollTop(),n=we(e.visibledatarow,l),r=t.row_focus;r>n&&(n=r),-1==n&&(n=0);let o=e.visibledatarow[n]-2-l+e.columnHeaderHeight,i=[e.visibledatarow[n],n+1,l,C.cutVolumn(e.visibledatarow,n+1),o];C.saveFreezen(i,o,null,null),null!=C.freezenverticaldata&&(C.cancelFreezenVertical(),C.createAssistCanvas(),re()),C.createFreezenHorizontal(i,o),C.createAssistCanvas(),re()}}else he()?alert(r.noSeletionError):a.info(r.noSeletionError,"")}function je(t,l){const r=n().freezen;let i="string"==typeof t&&o.iscelldata(t);if(t&&(t.hasOwnProperty("column_focus")||i)){if(i&&(t={row_focus:(t=o.getcellrange(t)).row[0],column_focus:t.column[0]}),C.saveFrozen("freezenColumnRange",l,t),!l||l==U(e.currentSheetIndex)){let l=$("#luckysheet-cell-main").scrollLeft(),n=we(e.visibledatacolumn,l),r=t.column_focus;r>n&&(n=r),-1==n&&(n=0);let o=e.visibledatacolumn[n]-2-l+e.rowHeaderWidth,i=[e.visibledatacolumn[n],n+1,l,C.cutVolumn(e.visibledatacolumn,n+1),o];C.saveFreezen(null,null,i,o),null!=C.freezenhorizontaldata&&(C.cancelFreezenHorizontal(),C.createAssistCanvas(),re()),C.createFreezenVertical(i,o),C.createAssistCanvas(),re()}}else he()?alert(r.noSeletionError):a.info(r.noSeletionError,"")}function De(t){C.saveFrozen("freezenCancel",t),t&&t!=U(e.currentSheetIndex)||(null!=C.freezenverticaldata&&C.cancelFreezenVertical(),null!=C.freezenhorizontaldata&&C.cancelFreezenHorizontal(),C.createAssistCanvas(),re())}function He(t,l=0,r={}){if(!de(l))return a.info("The index parameter is invalid.","");let o,i=U(e.currentSheetIndex),{number:s=1,order:c=i,success:u}={...r},f=n().info;de(s)?(s=parseInt(s))<1||s>100?he()?alert(f.tipInputNumberLimit):a.info(f.tipInputNumberLimit,""):(c&&e.luckysheetfile[c]&&(o=e.luckysheetfile[c].index),se(t,l,s,"lefttop",o),u&&"function"==typeof u&&u()):he()?alert(f.tipInputNumber):a.info(f.tipInputNumber,"")}function Ae(t,l,n,r={}){if(!de(l)||!de(n))return a.info("Please enter the index for deleting rows or columns correctly.","");let o,i=U(e.currentSheetIndex),{order:s=i,success:c}={...r};s&&e.luckysheetfile[s]&&(o=e.luckysheetfile[s].index),ce(t,l,n,o),c&&"function"==typeof c&&c()}function Be(t,l,n,r={}){if(!de(l)||!de(n))return a.info("Please enter the index for deleting rows or columns correctly.","");let o=U(e.currentSheetIndex),{order:i=o,success:s}={...r},c=e.luckysheetfile[i],u="row"===t?"rowhidden":"colhidden",f=$.extend(!0,{},c.config);null==f[u]&&(f[u]={});for(let e=l;e<=n;e++)f[u][e]=0;if(e.clearjfundo){let l={};l.type="row"===t?"showHidRows":"showHidCols",l.sheetIndex=c.index,l.config=$.extend(!0,{},c.config),l.curconfig=f,e.jfundo.length=0,e.jfredo.push(l)}e.luckysheetfile[i].config=f,S.saveParam("cg",c.index,f[u],{k:u}),i==o&&(e.config=f,ie(e.flowdata.length,e.flowdata[0].length)),s&&"function"==typeof s&&s()}function Oe(t,l,n,r={}){if(!de(l)||!de(n))return a.info("Please enter the index for deleting rows or columns correctly.","");let o=U(e.currentSheetIndex),{order:i=o,success:s}={...r},c=e.luckysheetfile[i],u="row"===t?"rowhidden":"colhidden",f=$.extend(!0,{},c.config);if(null!=f[u]){for(let e=l;e<=n;e++)delete f[u][e];if(e.clearjfundo){let l={};l.type="row"===t?"showHidRows":"showHidCols",l.sheetIndex=c.index,l.config=$.extend(!0,{},c.config),l.curconfig=f,e.jfundo.length=0,e.jfredo.push(l)}e.luckysheetfile[i].config=e.config,S.saveParam("cg",c.index,f[u],{k:u}),i===o&&(e.config=f,ie(e.flowdata.length,e.flowdata[0].length)),s&&"function"==typeof s&&s()}}function Pe(){let t=e.luckysheet_select_save,l=[];for(let e=0;e<t.length;e++){let n=t[e],r={row:n.row,column:n.column};l.push(r)}return l}function Ne(e){let t=[];return(e=e||Pe()).forEach(e=>{let l=e.row,n=e.column;for(let e=l[0];e<=l[1];e++)for(let l=n[0];l<=n[1];l++)t.push({r:e,c:l})}),t}function Ee(t,l,n={}){let r=U(e.currentSheetIndex),i=e.luckysheet_select_save[e.luckysheet_select_save.length-1],{range:s=i,order:c=r}={...n};if(!t)return a.info("Arguments attr cannot be null or undefined.",""),"error";if(s instanceof Array)return a.info("setRangeValue only supports a single selection.",""),"error";if("string"==W(s)){if(!o.iscelldata(s))return a.info("The range parameter is invalid.",""),"error";s=o.getcellrange(s)}if("object"!=W(s)||null==s.row||null==s.column)return a.info("The range parameter is invalid.",""),"error";for(let e=s.row[0];e<=s.row[1];e++)for(let n=s.column[0];n<=s.column[1];n++)console.log("r",e),console.log("c",n),$e(e,n,{[t]:l},{order:c,isRefresh:!1})}function Ve(t={}){let l=e.luckysheet_select_save,n=U(e.currentSheetIndex),{range:r=l,order:i=n,success:s}={...t},c=e.luckysheetfile[i],u=$.extend(!0,{},c.config),f=$.extend(!0,[],c.data);if(0==f.length&&(f=$.extend(!0,[],z.buildGridData(c))),"string"==W(r)){if(!o.iscelldata(r))return a.info("Incorrect selection format","");let e=o.getcellrange(r);r=[{row:e.row,column:e.column}]}else if("object"==W(r)){if(!r.hasOwnProperty("row")||!r.hasOwnProperty("column"))return a.info("Incorrect selection format","");r=[{row:r.row,column:r.column}]}if(ke(r))return a.info("Cannot merge overlapping range","");if(null!=u.merge){let e=!1;for(let t=0;t<r.length;t++){let l=r[t].row[0],n=r[t].row[1],o=r[t].column[0],i=r[t].column[1];if(e=ge(u,l,n,o,i))break}if(e)return a.info("Cannot perform this operation on partially merged cells","")}for(let e=0;e<r.length;e++){let t=r[e].row[0],l=r[e].row[1],n=r[e].column[0],o=r[e].column[1];if(t==l&&n==o)continue;let i={};for(let e=t;e<=l;e++)for(let t=n;t<=o;t++){let l=f[e][t];if(null!=l&&null!=l.mc){let n=l.mc.r,r=l.mc.c;if("rs"in l.mc)delete l.mc,delete u.merge[n+"_"+r],i[n+"_"+r]=$.extend(!0,{},l);else{let l=JSON.parse(JSON.stringify(i[n+"_"+r]));delete l.v,delete l.m,delete l.ct,delete l.f,delete l.spl,f[e][t]=l}}}}i==n?(e.clearjfundo&&(e.jfundo.length=0,e.jfredo.push({type:"mergeChange",sheetIndex:c.index,data:$.extend(!0,[],c.data),curData:f,range:r,config:$.extend(!0,{},c.config),curConfig:u})),e.clearjfundo=!1,oe(f,r,{cfg:u}),e.clearjfundo=!0):(c.data=f,c.config=u)}function We(){let t=$.extend(!0,[],e.luckysheetfile);return t.forEach((e,t,l)=>{null!=e.data&&e.data.length>0&&(e.celldata=z.getGridData(e.data)),delete e.load,delete e.freezen}),t}function Ge(){const t=e.toJsonOptions;return t.title=$("#luckysheet_info_detail_input").val(),t.data=We(),J().forEach((e,l)=>{void 0!=e.data&&(t.data[l].row="array"===W(e.data)?e.data.length:0,t.data[l].column="array"===W(e.data[0])?e.data[0].length:0)}),t}return{getCellValue:function(t,l,n={}){if(!de(t)||!de(l))return a.info("Arguments row or column cannot be null or undefined.","");let r,i=U(e.currentSheetIndex),{type:s="v",order:c=i}={...n},u=e.luckysheetfile[c].data[t][l];return"object"==W(u)&&(r=u[s],"f"==s&&null!=r?r=o.functionHTMLGenerate(r):"f"==s?r=u.v:u&&u.ct&&"yyyy-MM-dd"==u.ct.fa&&(r=u.m)),void 0==r&&(r=null),r},setCellValue:$e,clearCell:function(t,l,n={}){if(!de(t)||!de(l))return a.info("Arguments row and column cannot be null or undefined.","");let r=U(e.currentSheetIndex),{order:i=r,success:s}={...n},c=$.extend(!0,[],e.luckysheetfile[i].data),u=c[t][l];"object"==W(u)?(delete u.m,delete u.v,null!=u.f&&(delete u.f,o.delFunctionGroup(t,l,i),delete u.spl)):u=null,i===r?oe(c,[{row:[t,t],column:[l,l]}]):e.luckysheetfile[i].data=c,s&&"function"==typeof s&&s(u)},deleteCell:function(t,l,n,r={}){if(!t||["left","up"].indexOf(t)<0)return a.info("Arguments move cannot be null or undefined and its value must be 'left' or 'up'","");if(!de(l)||!de(n))return a.info("Arguments row and column cannot be null or undefined.","");let o,i=U(e.currentSheetIndex),{order:s=i,success:c}={...r},u="move"+t.replace(t[0],t[0].toUpperCase());s&&e.luckysheetfile[s]&&(o=e.luckysheetfile[s].index),ae(u,l,l,n,n,o),c&&"function"==typeof c&&c()},setCellFormat:function(t,l,n,r,o={}){if(!de(t)||!de(l))return a.info("Arguments row or column cannot be null or undefined.","");if(!n)return a.info("Arguments attr cannot be null or undefined.","");let i=U(e.currentSheetIndex),{order:s=i,success:c}={...o},u=e.luckysheetfile[s];if(null==u)return a.info("The order parameter is invalid.","");let f=$.extend(!0,[],u.data);0==f.length&&(f=z.buildGridData(u));let d=f[t][l]||{},h=$.extend(!0,{},u.config);if(!("ct"!=n||r&&r.hasOwnProperty("fa")&&r.hasOwnProperty("t")))return new TypeError("While set attribute 'ct' to cell, the value must have property 'fa' and 't'");if("bd"==n){null==h.borderInfo&&(h.borderInfo=[]);let e={rangeType:"range",borderType:"border-all",color:"#000",style:"1",range:[{column:[l,l],row:[t,t]}],...r};h.borderInfo.push(e)}else d[n]=r;f[t][l]=d,u.index==e.currentSheetIndex?(u.config=h,e.config=h,oe(f,[{row:[t,t],column:[l,l]}])):(u.config=h,u.data=f),c&&"function"==typeof c&&c(d)},find:Re,replace:function(t,l,n={}){let r=Re(t,n),o=U(e.currentSheetIndex),{order:i=o}={...n},s=e.luckysheetfile[i];if(null==s)return a.info("The order parameter is invalid.","");let c=$.extend(!0,[],s.data);r.forEach(e=>{e.m=l,$e(e.row,e.column,l,{order:i,isRefresh:!1})});let u=$.extend(!0,[],s.data);return s.data.length=0,s.data.push(...c),s.index==e.currentSheetIndex&&oe(u,void 0,void 0,!0,!1),re(),n.success&&"function"==typeof n.success&&n.success(r),r},exitEditMode:function(t={}){parseInt($("#luckysheet-input-box").css("top"))>0&&($("#luckysheet-formula-search-c").is(":visible")&&null!=o.searchFunctionCell?o.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(o.updatecell(e.luckysheetCellUpdate[0],e.luckysheetCellUpdate[1]),e.luckysheet_select_save=[{row:[e.luckysheetCellUpdate[0],e.luckysheetCellUpdate[0]],column:[e.luckysheetCellUpdate[1],e.luckysheetCellUpdate[1]],row_focus:e.luckysheetCellUpdate[0],column_focus:e.luckysheetCellUpdate[1]}]),$("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide()),t.success&&"function"==typeof t.success&&t.success()},enterEditMode:function(t={}){if(!$("#luckysheet-conditionformat-dialog").is(":visible")){if($("#luckysheet-cell-selected").is(":visible")){let t=e.luckysheet_select_save[e.luckysheet_select_save.length-1],l=t.row_focus,n=t.column_focus;Ce(l,n,e.flowdata)}t.success&&"function"==typeof t.success&&t.success()}},frozenFirstRow:ze,frozenFirstColumn:Me,frozenRowRange:Fe,frozenColumnRange:je,cancelFrozen:De,setHorizontalFrozen:function(t,l={}){let n=U(e.currentSheetIndex),{range:r,order:o=n,success:i}={...l};De(o),t?Fe(r,o):ze(o),i&&"function"==typeof i&&i()},setVerticalFrozen:function(t,l={}){let n=U(e.currentSheetIndex),{range:r,order:o=n,success:i}={...l};De(o),t?je(r,o):Me(o),i&&"function"==typeof i&&i()},setBothFrozen:function(t,l={}){let r=U(e.currentSheetIndex),{range:i,order:s=r,success:c}={...l},u=!s||s==U(e.currentSheetIndex);const f=n().freezen;if(De(s),t){C.saveFrozen("freezenRCRange",s,i);let t="string"==typeof i&&o.iscelldata(i);if(u){if(!(i&&i.hasOwnProperty("column_focus")&&i.hasOwnProperty("row_focus")||t))return void(he()?alert(f.noSeletionError):a.info(f.noSeletionError,""));t&&(i={row_focus:(i=o.getcellrange(i)).row[0],column_focus:i.column[0]});let l=$("#luckysheet-cell-main").scrollTop(),n=we(e.visibledatarow,l),r=i.row_focus;r>n&&(n=r),-1==n&&(n=0);let s=e.visibledatarow[n]-2-l+e.columnHeaderHeight,c=[e.visibledatarow[n],n+1,l,C.cutVolumn(e.visibledatarow,n+1),s];C.saveFreezen(c,s,null,null),C.createFreezenHorizontal(c,s);let u=$("#luckysheet-cell-main").scrollLeft(),d=we(e.visibledatacolumn,u),h=i.column_focus;h>d&&(d=h),-1==d&&(d=0);let g=e.visibledatacolumn[d]-2-u+e.rowHeaderWidth,m=[e.visibledatacolumn[d],d+1,u,C.cutVolumn(e.visibledatacolumn,d+1),g];C.saveFreezen(null,null,m,g),C.createFreezenVertical(m,g),C.createAssistCanvas(),re()}}else if(C.saveFrozen("freezenRC",s),u){let t=$("#luckysheet-cell-main").scrollTop(),l=we(e.visibledatarow,t);-1==l&&(l=0);let n=e.visibledatarow[l]-2-t+e.columnHeaderHeight,r=[e.visibledatarow[l],l+1,t,C.cutVolumn(e.visibledatarow,l+1),n];C.saveFreezen(r,n,null,null),C.createFreezenHorizontal(r,n);let o=$("#luckysheet-cell-main").scrollLeft(),i=we(e.visibledatacolumn,o);-1==i&&(i=0);let a=e.visibledatacolumn[i]-2-o+e.rowHeaderWidth,s=[e.visibledatacolumn[i],i+1,o,C.cutVolumn(e.visibledatacolumn,i+1),a];C.saveFreezen(null,null,s,a),C.createFreezenVertical(s,a),C.createAssistCanvas(),re()}},insertRowOrColumn:He,insertRow:function(e=0,t={}){He("row",e,t)},insertColumn:function(e=0,t={}){He("column",e,t)},deleteRowOrColumn:Ae,deleteRow:function(e,t,l={}){Ae("row",e,t,l)},deleteColumn:function(e,t,l={}){Ae("column",e,t,l)},hideRowOrColumn:Be,showRowOrColumn:Oe,hideRow:function(e,t,l={}){Be("row",e,t,l)},showRow:function(e,t,l={}){Oe("row",e,t,l)},hideColumn:function(e,t,l={}){Be("column",e,t,l)},showColumn:function(e,t,l={}){Oe("column",e,t,l)},setRowHeight:function(t,l={}){if("object"!=W(t))return a.info("The rowInfo parameter is invalid.","");let{order:n=U(e.currentSheetIndex),success:r}={...l},o=e.luckysheetfile[n];if(null==o)return a.info("The order parameter is invalid.","");let i=$.extend(!0,{},o.config);null==i.rowlen&&(i.rowlen={});for(let e in t)if(parseInt(e)>=0){let l=t[e];Number(l)>=0&&(i.rowlen[parseInt(e)]=Number(l))}o.config=i,S.saveParam("cg",o.index,i.rowlen,{k:"rowlen"}),o.index==e.currentSheetIndex&&(e.config=i,ie(e.flowdata.length,e.flowdata[0].length)),r&&"function"==typeof r&&r()},setColumnWidth:function(t,l={}){if("object"!=W(t))return a.info("The columnInfo parameter is invalid.","");let{order:n=U(e.currentSheetIndex),success:r}={...l},o=e.luckysheetfile[n];if(null==o)return a.info("The order parameter is invalid.","");let i=$.extend(!0,{},o.config);null==i.columnlen&&(i.columnlen={});for(let e in t)if(parseInt(e)>=0){let l=t[e];Number(l)>=0&&(i.columnlen[parseInt(e)]=Number(l))}o.config=i,S.saveParam("cg",o.index,i.columnlen,{k:"columnlen"}),o.index==e.currentSheetIndex&&(e.config=i,ie(e.flowdata.length,e.flowdata[0].length)),r&&"function"==typeof r&&r()},getRowHeight:function(t,l={}){if("array"!=W(t)||0==t.length)return a.info("The rowInfo parameter is invalid.","");let{order:n=U(e.currentSheetIndex),success:r}={...l},o=e.luckysheetfile[n];if(null==o)return a.info("The order parameter is invalid.","");let i=$.extend(!0,{},o.config).rowlen||{},s={};return t.forEach(t=>{if(parseInt(t)>=0){let l=i[parseInt(t)]||e.defaultrowlen;s[parseInt(t)]=l}}),setTimeout(()=>{r&&"function"==typeof r&&r()},1),s},getColumnWidth:function(t,l={}){if("array"!=W(t)||0==t.length)return a.info("The columnInfo parameter is invalid.","");let{order:n=U(e.currentSheetIndex),success:r}={...l},o=e.luckysheetfile[n];if(null==o)return a.info("The order parameter is invalid.","");let i=$.extend(!0,{},o.config).columnlen||{},s={};return t.forEach(t=>{if(parseInt(t)>=0){let l=i[parseInt(t)]||e.defaultcollen;s[parseInt(t)]=l}}),setTimeout(()=>{r&&"function"==typeof r&&r()},1),s},getDefaultRowHeight:function(t={}){let{order:l=U(e.currentSheetIndex),success:n}={...t};return setTimeout(()=>{n&&"function"==typeof n&&n()},1),e.luckysheetfile[l].defaultRowHeight},getDefaultColWidth:function(t={}){let{order:l=U(e.currentSheetIndex),success:n}={...t};return setTimeout(()=>{n&&"function"==typeof n&&n()},1),e.luckysheetfile[l].defaultColWidth},getRange:Pe,getRangeWithFlatten:Ne,getRangeValuesWithFlatte:function(t){let l=[];return(t=t||Ne()).forEach(t=>{l.push(e.flowdata[t.r][t.c])}),l},getRangeAxis:function(){let t=[],l=e.luckysheet_select_save,n=e.currentSheetIndex;return l.forEach(e=>{let l=q(n,{column:e.column,row:e.row});t.push(l)}),t},getRangeValue:function(t={}){let l=U(e.currentSheetIndex),{range:n,order:r=l}={...t},i=e.luckysheetfile[r];if(!n||"object"==typeof n)return le(n,i.index);if("string"==typeof n){if(o.iscelldata(n))return le(o.getcellrange(n),i.index);a.info("The range is invalid, please check range parameter.","")}},getRangeHtml:function(t={}){let{range:l=e.luckysheet_select_save,order:n=U(e.currentSheetIndex),success:r}={...t};if("string"==W(l)){if(!o.iscelldata(l))return a.info("The range parameter is invalid.","");let e=o.getcellrange(l);l=[{row:e.row,column:e.column}]}else if("object"==W(l)){if(null==l.row||null==l.column)return a.info("The range parameter is invalid.","");l=[{row:l.row,column:l.column}]}if("array"!=W(l))return a.info("The range parameter is invalid.","");let i=e.luckysheetfile[n];if(null==i)return a.info("The order parameter is invalid.","");let s=$.extend(!0,{},i.config);if(null!=s.merge){let e=!1;for(let t=0;t<l.length;t++){let n=l[t].row[0],r=l[t].row[1],o=l[t].column[0],i=l[t].column[1];if(e=ge(s,n,r,o,i))break}if(e)return a.info("Cannot perform this operation on partially merged cells","")}let c=$.extend(!0,[],i.luckysheet_conditionformat_save);if(l.length>1&&c.length>0){let e=!1,t=M.getComputeMap(i.index);for(let n=0;n<l.length;n++){let r=l[n].row[0],o=l[n].row[1],i=l[n].column[0],a=l[n].column[1];for(let l=r;l<=o;l++){for(let n=i;n<=a;n++)if(null!=M.checksCF(l,n,t)){e=!0;break}if(e)break}if(e)break}if(e)return a.info("Cannot perform this operation on multiple selection areas, please select a single area","")}if(l.length>1){let e=!0,t=l[0].row[0],n=l[0].row[1],r=!0,o=l[0].column[0],i=l[0].column[1];for(let a=1;a<l.length;a++)l[a].row[0]==t&&l[a].row[1]==n||(e=!1),l[a].column[0]==o&&l[a].column[1]==i||(r=!1);if(!e&&!r||ke(l))return a.info("Cannot perform this operation on multiple selection areas, please select a single area","")}let u,f=[],d=[];for(let e=0;e<l.length;e++){let t=l[e].row[0],n=l[e].row[1],r=l[e].column[0],o=l[e].column[1];for(let e=t;e<=n;e++)if(null==s.rowhidden||null==s.rowhidden[e]){f.includes(e)||f.push(e);for(let e=r;e<=o;e++)null!=s.colhidden&&null!=s.colhidden[e]||d.includes(e)||d.push(e)}}s.borderInfo&&s.borderInfo.length>0&&(u=ye(i.index));let h=i.data;null!=h&&0!=h.length||(h=z.buildGridData(i));let g="",m="";f=f.sort(),d=d.sort();for(let e=0;e<f.length;e++){let t=f[e];if(null==s.rowhidden||null==s.rowhidden[t]){g+="<tr>";for(let e=0;e<d.length;e++){let l=d[e];if(null!=s.colhidden&&null!=s.colhidden[l])continue;let n='<td ${span} style="${style}">';if(null!=h[t]&&null!=h[t][l]){let e="",r="";t==f[0]&&(null==s.columnlen||null==s.columnlen[l.toString()]?m+='<colgroup width="72px"></colgroup>':m+='<colgroup width="'+s.columnlen[l.toString()]+'px"></colgroup>'),l==d[0]&&(null==s.rowlen||null==s.rowlen[t.toString()]?e+="height:19px;":e+="height:"+s.rowlen[t.toString()]+"px;");let o,i=/^(w|W)((0?)|(0\.0+))$/;if(o=null!=h[t][l].ct&&null!=h[t][l].ct.fa&&h[t][l].ct.fa.match(i)?ne(t,l,h):ne(t,l,h,"m"),e+=_.getStyleByCell(h,t,l),"object"==W(h[t][l])&&"mc"in h[t][l]){if(!("rs"in h[t][l].mc))continue;if(r='rowspan="'+h[t][l].mc.rs+'" colspan="'+h[t][l].mc.cs+'"',u&&u[t+"_"+l]){let n={color:{},style:{}},r={color:{},style:{}},o={color:{},style:{}},i={color:{},style:{}};for(let e=t;e<t+h[t][l].mc.rs;e++)for(let a=l;a<l+h[t][l].mc.cs;a++){if(e==t&&u[e+"_"+a]&&u[e+"_"+a].t){let t=u[e+"_"+a].t.style,l=u[e+"_"+a].t.color;null==o.style[t]?o.style[t]=1:o.style[t]=o.style[t]+1,null==o.color[l]?o.color[l]=1:o.color[l]=o.color[l]+1}if(e==t+h[t][l].mc.rs-1&&u[e+"_"+a]&&u[e+"_"+a].b){let t=u[e+"_"+a].b.style,l=u[e+"_"+a].b.color;null==i.style[t]?i.style[t]=1:i.style[t]=i.style[t]+1,null==i.color[l]?i.color[l]=1:i.color[l]=i.color[l]+1}if(a==l&&u[e+"_"+a]&&u[e+"_"+a].l){let r=u[t+"_"+l].l.style,o=u[e+"_"+a].l.color;null==n.style[r]?n.style[r]=1:n.style[r]=n.style[r]+1,null==n.color[o]?n.color[o]=1:n.color[o]=n.color[o]+1}if(a==l+h[t][l].mc.cs-1&&u[e+"_"+a]&&u[e+"_"+a].r){let t=u[e+"_"+a].r.style,l=u[e+"_"+a].r.color;null==r.style[t]?r.style[t]=1:r.style[t]=r.style[t]+1,null==r.color[l]?r.color[l]=1:r.color[l]=r.color[l]+1}}let a=h[t][l].mc.rs,s=h[t][l].mc.cs;if(JSON.stringify(n).length>23){let t=null,l=null;for(let e in n.color)n.color[e]>=a/2&&(t=e);for(let e in n.style)n.style[e]>=a/2&&(l=e);null!=t&&null!=l&&(e+="border-left:"+T.getHtmlBorderStyle(l,t))}if(JSON.stringify(r).length>23){let t=null,l=null;for(let e in r.color)r.color[e]>=a/2&&(t=e);for(let e in r.style)r.style[e]>=a/2&&(l=e);null!=t&&null!=l&&(e+="border-right:"+T.getHtmlBorderStyle(l,t))}if(JSON.stringify(o).length>23){let t=null,l=null;for(let e in o.color)o.color[e]>=s/2&&(t=e);for(let e in o.style)o.style[e]>=s/2&&(l=e);null!=t&&null!=l&&(e+="border-top:"+T.getHtmlBorderStyle(l,t))}if(JSON.stringify(i).length>23){let t=null,l=null;for(let e in i.color)i.color[e]>=s/2&&(t=e);for(let e in i.style)i.style[e]>=s/2&&(l=e);null!=t&&null!=l&&(e+="border-bottom:"+T.getHtmlBorderStyle(l,t))}}}else if(u&&u[t+"_"+l]){if(u[t+"_"+l].l){let n=u[t+"_"+l].l.style,r=u[t+"_"+l].l.color;e+="border-left:"+T.getHtmlBorderStyle(n,r)}if(u[t+"_"+l].r){let n=u[t+"_"+l].r.style,r=u[t+"_"+l].r.color;e+="border-right:"+T.getHtmlBorderStyle(n,r)}if(u[t+"_"+l].b){let n=u[t+"_"+l].b.style,r=u[t+"_"+l].b.color;e+="border-bottom:"+T.getHtmlBorderStyle(n,r)}if(u[t+"_"+l].t){let n=u[t+"_"+l].t.style,r=u[t+"_"+l].t.color;e+="border-top:"+T.getHtmlBorderStyle(n,r)}}n=V(n,{style:e,span:r}),null==o&&(o=ne(t,l,h)),null==o&&(o=" "),n+=o}else{let e="";if(u&&u[t+"_"+l]){if(u[t+"_"+l].l){let n=u[t+"_"+l].l.style,r=u[t+"_"+l].l.color;e+="border-left:"+T.getHtmlBorderStyle(n,r)}if(u[t+"_"+l].r){let n=u[t+"_"+l].r.style,r=u[t+"_"+l].r.color;e+="border-right:"+T.getHtmlBorderStyle(n,r)}if(u[t+"_"+l].b){let n=u[t+"_"+l].b.style,r=u[t+"_"+l].b.color;e+="border-bottom:"+T.getHtmlBorderStyle(n,r)}if(u[t+"_"+l].t){let n=u[t+"_"+l].t.style,r=u[t+"_"+l].t.color;e+="border-top:"+T.getHtmlBorderStyle(n,r)}}n+="",t==f[0]&&(null==s.columnlen||null==s.columnlen[l.toString()]?m+='<colgroup width="72px"></colgroup>':m+='<colgroup width="'+s.columnlen[l.toString()]+'px"></colgroup>'),l==d[0]&&(null==s.rowlen||null==s.rowlen[t.toString()]?e+="height:19px;":e+="height:"+s.rowlen[t.toString()]+"px;"),n=V(n,{style:e,span:""}),n+=" "}g+=n+="</td>"}g+="</tr>"}}return g='<table data-type="luckysheet_copy_action_table">'+m+g+"</table>"},getRangeArray:function(t,l={}){if(!["oneDimensional","twoDimensional"].includes(t))return a.info("The dimensional parameter is invalid.","");let{range:n=e.luckysheet_select_save[e.luckysheet_select_save.length-1],order:r=U(e.currentSheetIndex)}={...l},i=e.luckysheetfile[r];if(null==i)return a.info("The order parameter is invalid.","");if("string"==W(n)){if(!o.iscelldata(n))return a.info("The range parameter is invalid.","");n=o.getcellrange(n)}if("object"!=W(n)||null==n.row||null==n.column)return a.info("The range parameter is invalid.","");let s=n.row[0],c=n.row[1],u=n.column[0],f=n.column[1],d=$.extend(!0,{},i.config);if(null!=d.merge&&ge(d,s,c,u,f))return a.info("Cannot perform this operation on partially merged cells","");let h=i.data;null!=h&&0!=h.length||(h=z.buildGridData(i));let g=[];if("oneDimensional"==t)for(let e=s;e<=c;e++)for(let t=u;t<=f;t++){let l=h[e][t];null==l||null==l.v?g.push(null):g.push(l.v)}else if("twoDimensional"==t)for(let e=s;e<=c;e++){let t=[];for(let l=u;l<=f;l++){let n=h[e][l];null==n||null==n.v?t.push(null):t.push(n.v)}g.push(t)}return g},getRangeJson:function(t,l={}){let r=e.luckysheet_select_save[0],i=U(e.currentSheetIndex),{range:s=r,order:c=i}={...l},u=e.luckysheetfile[c],f=u.config;if(s&&"string"==typeof s&&o.iscelldata(s)&&(s=o.getcellrange(s)),!s||s.length>1)return void(he()?alert(locale_drag.noMulti):a.info(locale_drag.noMulti,""));if(null!=f.merge){let e=!1,t=s.row[0],l=s.row[1],r=s.column[0],o=s.column[1];if(e=ge(f,t,l,r,o))return void(he()?alert(n().drag.noPartMerge):a.info(n().drag.noPartMerge,""))}let d=le(s,u.index),h=[];if(0!==d.length){if(t)if(1===d.length){let e={};for(let t=0;t<d[0].length;t++)e[ne(0,t,d)]="";h.push(e)}else for(let e=1;e<d.length;e++){let t={};for(let l=0;l<d[0].length;l++)void 0==ne(0,l,d)?t[""]=ne(e,l,d):t[ne(0,l,d)]=ne(e,l,d);h.push(t)}else{let e=s.column[0];for(let t=0;t<d.length;t++){let l={};for(let n=0;n<d[0].length;n++)l[G(n+e)]=ne(t,n,d);h.push(l)}}return h}},getRangeDiagonal:function(t,l={}){if(["normal","anti","offset"].indexOf(t)<0)return a.info("The type parameter must be included in ['normal', 'anti', 'offset']","");let r=U(e.currentSheetIndex),i=e.luckysheet_select_save,{column:s=1,range:c=i,order:u=r}={...l},f=e.luckysheetfile[u].config;if(c&&"string"==typeof c&&o.iscelldata(c)&&(c=o.getcellrange(c)),!c||c.length>1)return void(he()?alert(n().drag.noMulti):a.info(n().drag.noMulti,""));if(null!=f.merge){let e=!1,t=c[0].row[0],l=c[0].row[1],r=c[0].column[0],o=c[0].column[1];if(e=ge(f,t,l,r,o))return void(he()?alert(n().drag.noPartMerge):a.info(n().drag.noPartMerge,""))}let d=le(c,u),h=[];if(0===d.length)return;let g=d[0].length;switch(t){case"normal":for(let e=0;e<d.length&&!(e>=g);e++)h.push(d[e][e]);break;case"anti":for(let e=0;e<d.length&&!(e>=g);e++)h.push(d[e][g-e-1]);break;case"offset":if("NaN"==s.toString())return void(he()?alert(n().drag.inputCorrect):a.info(n().drag.inputCorrect,""));if(s<0)return void(he()?alert(n().drag.offsetColumnLessZero):a.info(n().drag.offsetColumnLessZero,""));for(let e=0;e<d.length&&!(e+s>=g);e++)h.push(d[e][e+s])}T.copybyformat(new Event,JSON.stringify(h))},getRangeBoolean:function(t={}){let l=U(e.currentSheetIndex),r=e.luckysheet_select_save,{range:i=r,order:s=l}={...t},c=e.luckysheetfile[s].config;if(i&&"string"==typeof i&&o.iscelldata(i)&&(i=o.getcellrange(i)),!i||i.length>1)return void(he()?alert(n().drag.noMulti):a.info(n().drag.noMulti,""));if(null!=c.merge){let e=!1,t=i[0].row[0],l=i[0].row[1],r=i[0].column[0],o=i[0].column[1];if(e=ge(c,t,l,r,o))return void(he()?alert(n().drag.noPartMerge):a.info(n().drag.noPartMerge,""))}let u=le(i,s),f=[];if(0!==u.length){for(let e=0;e<u.length;e++){let t=[];for(let l=0;l<u[0].length;l++){let n,r=!1;r=null!=(n="object"==W(u[e][l])?u[e][l].v:u[e][l])&&""!=n&&(null==(n=parseInt(n))||n>0),t.push(r)}f.push(t)}T.copybyformat(event,JSON.stringify(f))}},setRangeShow:function(t,l={}){if("string"==W(t)){if(!o.iscelldata(t))return a.info("The range parameter is invalid.","");let e=o.getcellrange(t);t=[{row:e.row,column:e.column}]}else if("object"==W(t)){if(null==t.row||null==t.column)return a.info("The range parameter is invalid.","");t=[{row:t.row,column:t.column}]}if("array"==W(t))for(let e=0;e<t.length;e++)if("string"===W(t[e])){if(!o.iscelldata(t[e]))return a.info("The range parameter is invalid.","");let l=o.getcellrange(t[e]);t[e]={row:l.row,column:l.column}}else if("object"==W(t)){if(null==t.row||null==t.column)return a.info("The range parameter is invalid.","");t={row:t.row,column:t.column}}if("array"!=W(t))return a.info("The range parameter is invalid.","");let{show:n=!0,order:r=U(e.currentSheetIndex),success:i}={...l},s=e.luckysheetfile[r];if(null==s)return a.info("The order parameter is invalid.","");for(let e=0;e<t.length;e++){let l=_.mergeMoveMain(t[e].column,t[e].row,t[e]);l&&(t[e]={row:l[1],column:l[0]})}s.luckysheet_select_save=t,s.index==e.currentSheetIndex&&(e.luckysheet_select_save=t,xe(),n||($("#luckysheet-cell-selected-boxs").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty())),i&&"function"==typeof i&&i()},setRangeValue:function(t,l={}){let n=U(e.currentSheetIndex),r=e.luckysheet_select_save[e.luckysheet_select_save.length-1],{range:i=r,isRefresh:s=!0,order:c=n,success:u}={...l};if(null==t)return a.info("The data which will be set to range cannot be null.","");if(i instanceof Array)return a.info("setRangeValue only supports a single selection.","");"string"==typeof i&&o.iscelldata(i)&&(i=o.getcellrange(i));let f=i.row[1]-i.row[0]+1,d=i.column[1]-i.column[0]+1;if(t.length!==f||t[0].length!==d)return a.info("The data to be set does not match the selection.","");let h=e.luckysheetfile[c];if(null==h)return a.info("The order parameter is invalid.","");let g=$.extend(!0,[],h.data);for(let e=0;e<f;e++)for(let l=0;l<d;l++)$e(i.row[0]+e,i.column[0]+l,t[e][l],{order:c,isRefresh:!1});let m=$.extend(!0,[],h.data);h.data.length=0,h.data.push(...g),h.index==e.currentSheetIndex&&oe(m,[{row:i.row,column:i.column}],void 0,!0,!1),s&&re(),u&&"function"==typeof u&&u()},setSingleRangeFormat:Ee,setRangeFormat:function(t,l,n={}){let r=U(e.currentSheetIndex),i=e.luckysheet_select_save,{range:s=i,order:c=r,success:u}={...n};if("string"==W(s)){if(!o.iscelldata(s))return a.info("The range parameter is invalid.","");let e=o.getcellrange(s);s=[{row:e.row,column:e.column}]}else if("object"==W(s)){if(null==s.row||null==s.column)return a.info("The range parameter is invalid.","");s=[{row:s.row,column:s.column}]}if("array"!=W(s))return a.info("The range parameter is invalid.","");let f=e.luckysheetfile[c];if(null==f)return a.info("The order parameter is invalid.","");let d=$.extend(!0,[],f.data),h=[];for(let e=0;e<s.length;e++)h.push(Ee(t,l,{range:s[e],order:c}));if(h.some(e=>"error"===e))return f.data.length=0,f.data.push(...d),!1;let g=$.extend(!0,[],f.data);f.data.length=0,f.data.push(...d),f.index==e.currentSheetIndex&&oe(g,void 0,void 0,!0,!1),re(),u&&"function"==typeof u&&u()},setRangeFilter:function(t,l={}){if(!["open","close"].includes(t))return a.info("The type parameter is invalid.","");let{range:n=e.luckysheet_select_save[e.luckysheet_select_save.length-1],order:r=U(e.currentSheetIndex),success:i}={...l},s=e.luckysheetfile[r];if(null==s)return a.info("The order parameter is invalid.","");if("string"==W(n)){if(!o.iscelldata(n))return a.info("The range parameter is invalid.","");n=o.getcellrange(n)}if("object"!=W(n)||null==n.row||null==n.column)return a.info("The range parameter is invalid.","");if(setTimeout(()=>{i&&"function"==typeof i&&i()},1),"open"==t)return s.filter_select=n,s.index==e.currentSheetIndex&&_e(n,s.filter),{row:n.row,column:n.column};if("close"==t){let e=$.extend(!0,{},s.filter_select);return s.filter_select=null,$("#luckysheet-filter-selected-sheet"+s.index).remove(),$("#luckysheet-filter-options-sheet"+s.index).remove(),{row:e.row,column:e.column}}},setRangeMerge:function(t,l={}){if(["all","horizontal","vertical"].indexOf(t)<0)return a.info("The type parameter must be included in ['all', 'horizontal', 'vertical']","");let n=U(e.currentSheetIndex),r=e.luckysheet_select_save,{range:i=r,order:s=n,success:c}={...l},u=e.luckysheetfile[s],f=$.extend(!0,{},u.config),d=$.extend(!0,[],u.data);if(0==d.length&&(d=$.extend(!0,[],z.buildGridData(u))),"string"==W(i)){if(!o.iscelldata(i))return a.info("Incorrect selection format","");let e=o.getcellrange(i);i=[{row:e.row,column:e.column}]}else if("object"==W(i)){if(!i.hasOwnProperty("row")||!i.hasOwnProperty("column"))return a.info("Incorrect selection format","");i=[{row:i.row,column:i.column}]}if(ke(i))return a.info("Cannot merge overlapping range","");if(null!=f.merge){let e=!1;for(let t=0;t<i.length;t++){let l=i[t].row[0],n=i[t].row[1],r=i[t].column[0],o=i[t].column[1];if(e=ge(f,l,n,r,o))break}if(e)return a.info("Cannot perform this operation on partially merged cells","")}let h=!1;for(let e=0;e<i.length;e++){let t=i[e].row[0],l=i[e].row[1],n=i[e].column[0],r=i[e].column[1];for(let e=t;e<=l;e++){for(let t=n;t<=r;t++){let l=d[e][t];if("object"==W(l)&&"mc"in l){h=!0;break}}if(h)break}}if(h)Ve({range:i,order:s});else{for(let e=0;e<i.length;e++){let l=i[e].row[0],n=i[e].row[1],r=i[e].column[0],o=i[e].column[1];if(l!=n||r!=o)if("all"==t){let e={},t=!1;for(let i=l;i<=n;i++)for(let n=r;n<=o;n++){let o=d[i][n];null==o||ue(o.v)&&null==o.f||t||(e=$.extend(!0,{},o),t=!0),d[i][n]={mc:{r:l,c:r}}}d[l][r]=e,d[l][r].mc={r:l,c:r,rs:n-l+1,cs:o-r+1},f.merge[l+"_"+r]={r:l,c:r,rs:n-l+1,cs:o-r+1}}else if("vertical"==t)for(let e=r;e<=o;e++){let t={},r=!1;for(let o=l;o<=n;o++){let n=d[o][e];null==n||ue(n.v)&&null==n.f||r||(t=$.extend(!0,{},n),r=!0),d[o][e]={mc:{r:l,c:e}}}d[l][e]=t,d[l][e].mc={r:l,c:e,rs:n-l+1,cs:1},f.merge[l+"_"+e]={r:l,c:e,rs:n-l+1,cs:1}}else if("horizontal"==t)for(let e=l;e<=n;e++){let t={},l=!1;for(let n=r;n<=o;n++){let o=d[e][n];null==o||ue(o.v)&&null==o.f||l||(t=$.extend(!0,{},o),l=!0),d[e][n]={mc:{r:e,c:r}}}d[e][r]=t,d[e][r].mc={r:e,c:r,rs:1,cs:o-r+1},f.merge[e+"_"+r]={r:e,c:r,rs:1,cs:o-r+1}}}s==n?(e.clearjfundo&&(e.jfundo.length=0,e.jfredo.push({type:"mergeChange",sheetIndex:u.index,data:$.extend(!0,[],u.data),curData:d,range:i,config:$.extend(!0,{},u.config),curConfig:f})),e.clearjfundo=!1,oe(d,i,{cfg:f}),e.clearjfundo=!0):(u.data=d,u.config=f)}c&&"function"==typeof c&&c()},cancelRangeMerge:Ve,setRangeSort:function(t,l={}){if(["asc","desc"].indexOf(t)<0)return a.info("The type parameter must be included in ['asc', 'desc'","");let r=U(e.currentSheetIndex),i=e.luckysheet_select_save[0],{range:s=i,order:c=r,success:u}={...l},f=e.luckysheetfile[c],d=$.extend(!0,{},f.config),h=$.extend(!0,[],f.data);if(0==h.length&&(h=$.extend(!0,[],z.buildGridData(f))),s instanceof Array&&s.length>1)return void a.info(n().sort.noRangeError,"");s&&"string"==typeof s&&o.iscelldata(s)&&(s=o.getcellrange(s));let g=s.row[0],m=s.row[1],p=s.column[0],y=s.column[1],v=!1,w=[];for(let e=g;e<=m;e++){let t=[];for(let l=p;l<=y;l++){if(null!=h[e][l]&&null!=h[e][l].mc){v=!0;break}t.push(h[e][l])}w.push(t)}if(v)return void a.info(n().sort.mergeError,"");w=ee([].concat(w),0,"asc"===t);for(let e=g;e<=m;e++)for(let t=p;t<=y;t++)h[e][t]=w[e-g][t-p];let x={};null!=d.rowlen&&(x={cfg:d=te(h,g,m,d),RowlChange:!0}),f.index==e.currentSheetIndex?oe(h,[{row:[g,m],column:[p,y]}],x):(f.data=h,f.config=d),u&&"function"==typeof u&&u()},setRangeSortMulti:function(t,l,r={}){if(!(l&&l instanceof Array))return a.info("The sort parameter is invalid.","");let i=U(e.currentSheetIndex),s=e.luckysheet_select_save[0],{range:c=s,order:u=i,success:f}={...r},d=e.luckysheetfile[u],h=$.extend(!0,{},d.config),g=$.extend(!0,[],d.data);if(0==g.length&&(g=$.extend(!0,[],z.buildGridData(d))),c instanceof Array&&c.length>1)return void a.info(n().sort.noRangeError,"");c&&"string"==typeof c&&o.iscelldata(c)&&(c=o.getcellrange(c));let m,p=c.row[0],y=c.row[1],v=c.column[0],w=c.column[1],x=!1,k=[];for(let e=m=t?p+1:p;e<=y;e++){let t=[];for(let l=v;l<=w;l++){if(null!=g[e][l]&&null!=g[e][l].mc){x=!0;break}t.push(g[e][l])}k.push(t)}if(x)return void a.info(n().sort.mergeError,"");l.forEach(e=>{let t=e.i;t-=v,k=ee([].concat(k),t,"asc"===e.sort)});for(let e=m;e<=y;e++)for(let t=v;t<=w;t++)g[e][t]=k[e-m][t-v];let b={};null!=h.rowlen&&(b={cfg:h=te(g,m,y,h),RowlChange:!0}),d.index===e.currentSheetIndex?oe(g,[{row:[m,y],column:[v,w]}],b):(d.data=g,d.config=h),f&&"function"==typeof f&&f()},setRangeConditionalFormatDefault:function(t,l,r={}){if(!t||!["greaterThan","lessThan","betweenness","equal","textContains","occurrenceDate","duplicateValue","top10","top10%","last10","last10%","AboveAverage","SubAverage"].includes(t))return a.info("The conditionName parameter is invalid.","");if("array"!=W(l)||0==l.length)return a.info("The conditionValue parameter is invalid.","");let{format:o={textColor:"#000000",cellColor:"#ff0000"},cellrange:i=e.luckysheet_select_save,order:s=U(e.currentSheetIndex),success:c}={...r},u=e.luckysheetfile[s],f=u.data;if(null!=f&&0!=f.length||(f=z.buildGridData(u)),null==u)return a.info("Incorrect worksheet index","");const d=n().conditionformat;let h=[],g=[];if("betweenness"==t){let e=l[0],t=l[1],n=M.getRangeByTxt(e);if(n.length>1)return void M.infoDialog(d.onlySingleCell,"");if(1==n.length){let t=n[0].row[0],l=n[0].row[1],r=n[0].column[0],o=n[0].column[1];if(t!=l||r!=o)return void M.infoDialog(d.onlySingleCell,"");e=ne(t,r,f),h.push({row:n[0].row,column:n[0].column}),g.push(e)}else if(0==n.length){if(isNaN(e)||""==e)return void M.infoDialog(d.conditionValueCanOnly,"");g.push(e)}let r=M.getRangeByTxt(t);if(r.length>1)return void M.infoDialog(d.onlySingleCell,"");if(1==r.length){let e=r[0].row[0],l=r[0].row[1],n=r[0].column[0],o=r[0].column[1];if(e!=l||n!=o)return void M.infoDialog(d.onlySingleCell,"");t=ne(e,n,f),h.push({row:r[0].row,column:r[0].column}),g.push(t)}else if(0==r.length){if(isNaN(t)||""==t)return void M.infoDialog(d.conditionValueCanOnly,"");g.push(t)}}else if("greaterThan"==t||"lessThan"==t||"equal"==t){let e=l[0],t=M.getRangeByTxt(e);if(t.length>1)return void M.infoDialog(d.onlySingleCell,"");if(1==t.length){let l=t[0].row[0],n=t[0].row[1],r=t[0].column[0],o=t[0].column[1];if(l!=n||r!=o)return void M.infoDialog(d.onlySingleCell,"");e=ne(l,r,f),h.push({row:t[0].row,column:t[0].column}),g.push(e)}else if(0==t.length){if(isNaN(e)||""==e)return void M.infoDialog(d.conditionValueCanOnly,"");g.push(e)}}else if("textContains"==t){let e=l[0],t=M.getRangeByTxt(e);if(t.length>1)return void M.infoDialog(d.onlySingleCell,"");if(1==t.length){let l=t[0].row[0],n=t[0].row[1],r=t[0].column[0],o=t[0].column[1];if(l!=n||r!=o)return void M.infoDialog(d.onlySingleCell,"");e=ne(l,r,f),h.push({row:t[0].row,column:t[0].column}),g.push(e)}else if(0==t.length){if(""==e)return void M.infoDialog(d.conditionValueCanOnly,"");g.push(e)}}else if("occurrenceDate"==t){let e,t=l[0],n=l[1];if(!me(t)||!me(n))return a.info("The conditionValue parameter is invalid.","");e=pe(t,n)>0?N(n).format("YYYY/MM/DD")+"-"+N(t).format("YYYY/MM/DD"):N(t).format("YYYY/MM/DD")+"-"+N(n).format("YYYY/MM/DD"),g.push(e)}else if("duplicateValue"==t){let e=l[0];if("0"!=e||"1"!=e)return a.info("The conditionValue parameter is invalid.","");g.push(e)}else if("top10"==t||"top10%"==t||"last10"==t||"last10%"==t){let e=l[0];if(parseInt(e)!=e||parseInt(e)<1||parseInt(e)>1e3)return void M.infoDialog(d.pleaseEnterInteger,"");g.push(parseInt(e))}else"AboveAverage"!=t&&"SubAverage"!=t||g.push(t);if(!o.hasOwnProperty("textColor")||!o.hasOwnProperty("cellColor"))return a.info("The format parameter is invalid.","");if("string"==W(i)?i=M.getRangeByTxt(i):"object"==W(i)&&(i=[i]),"array"!=W(i))return a.info("The cellrange parameter is invalid.","");let m={type:"default",cellrange:i,format:o,conditionName:t,conditionRange:h,conditionValue:g},p=$.extend(!0,[],e.luckysheetfile),y=M.getHistoryRules(p),v=u.luckysheet_conditionformat_save||[];v.push(m),u.luckysheet_conditionformat_save=v;let w=$.extend(!0,[],e.luckysheetfile),x=M.getCurrentRules(w);M.ref(y,x),S.allowUpdate&&S.saveParam("all",u.index,v,{k:"luckysheet_conditionformat_save"}),c&&"function"==typeof c&&c()},setRangeConditionalFormat:function(t,l={}){if(!t||!["dataBar","colorGradation","icons"].includes(t))return a.info("The type parameter is invalid.","");let{format:n,cellrange:r=e.luckysheet_select_save,order:o=U(e.currentSheetIndex),success:i}={...l},s=e.luckysheetfile[o];if(null==s)return a.info("Incorrect worksheet index","");if("dataBar"==t){if(null==n&&(n=["#638ec6","#ffffff"]),"array"!=W(n)||n.length<1||n.length>2)return a.info("The format parameter is invalid.","")}else if("colorGradation"==t){if(null==n&&(n=["rgb(99, 190, 123)","rgb(255, 235, 132)","rgb(248, 105, 107)"]),"array"!=W(n)||n.length<2||n.length>3)return a.info("The format parameter is invalid.","")}else if("icons"==t){null==n&&(n="threeWayArrowMultiColor");let e=["threeWayArrowMultiColor","threeTriangles","fourWayArrowMultiColor","fiveWayArrowMultiColor","threeWayArrowGrayColor","fourWayArrowGrayColor","fiveWayArrowGrayColor","threeColorTrafficLightRimless","threeSigns","greenRedBlackGradient","threeColorTrafficLightBordered","fourColorTrafficLight","threeSymbolsCircled","tricolorFlag","threeSymbolsnoCircle","threeStars","fiveQuadrantDiagram","fiveBoxes","grade4","grade5"];if("string"!=W(n)||!e.includes(n))return a.info("The format parameter is invalid.","");switch(n){case"threeWayArrowMultiColor":n={len:3,leftMin:0,top:0};break;case"threeTriangles":n={len:3,leftMin:0,top:1};break;case"fourWayArrowMultiColor":n={len:4,leftMin:0,top:2};break;case"fiveWayArrowMultiColor":n={len:5,leftMin:0,top:3};break;case"threeWayArrowGrayColor":n={len:3,leftMin:5,top:0};break;case"fourWayArrowGrayColor":n={len:4,leftMin:5,top:1};break;case"fiveWayArrowGrayColor":n={len:5,leftMin:5,top:2};break;case"threeColorTrafficLightRimless":n={len:3,leftMin:0,top:4};break;case"threeSigns":n={len:3,leftMin:0,top:5};break;case"greenRedBlackGradient":n={len:4,leftMin:0,top:6};break;case"threeColorTrafficLightBordered":n={len:3,leftMin:5,top:4};break;case"fourColorTrafficLight":n={len:4,leftMin:5,top:5};break;case"threeSymbolsCircled":n={len:3,leftMin:0,top:7};break;case"tricolorFlag":n={len:3,leftMin:0,top:8};break;case"threeSymbolsnoCircle":n={len:3,leftMin:5,top:7};break;case"threeStars":n={len:3,leftMin:0,top:9};break;case"fiveQuadrantDiagram":n={len:5,leftMin:0,top:10};break;case"fiveBoxes":n={len:5,leftMin:0,top:11};break;case"grade4":n={len:4,leftMin:5,top:9};break;case"grade5":n={len:5,leftMin:5,top:10}}}if("string"==W(r)?r=M.getRangeByTxt(r):"object"==W(r)&&(r=[r]),"array"!=W(r))return a.info("The cellrange parameter is invalid.","");let c={type:t,cellrange:r,format:n},u=$.extend(!0,[],e.luckysheetfile),f=M.getHistoryRules(u),d=s.luckysheet_conditionformat_save||[];d.push(c),s.luckysheet_conditionformat_save=d;let h=$.extend(!0,[],e.luckysheetfile),g=M.getCurrentRules(h);M.ref(f,g),S.allowUpdate&&S.saveParam("all",s.index,d,{k:"luckysheet_conditionformat_save"}),i&&"function"==typeof i&&i()},deleteRangeConditionalFormat:function(t,l={}){if(!de(t))return a.info("The itemIndex parameter is invalid.","");t=Number(t);let{order:n=U(e.currentSheetIndex),success:r}={...l},o=e.luckysheetfile[n];if(null==o)return a.info("The order parameter is invalid.","");let i=$.extend(!0,[],o.luckysheet_conditionformat_save);if(0==i.length)return a.info("This worksheet has no conditional format to delete","");if(null==i[t])return a.info("The conditional format of the index cannot be found","");let s=i.splice(t,1),c=$.extend(!0,[],e.luckysheetfile),u=M.getHistoryRules(c);o.luckysheet_conditionformat_save=i;let f=$.extend(!0,[],e.luckysheetfile),d=M.getCurrentRules(f);return M.ref(u,d),S.allowUpdate&&S.saveParam("all",o.index,ruleArr,{k:"luckysheet_conditionformat_save"}),setTimeout(()=>{r&&"function"==typeof r&&r()},1),s},clearRange:function(t={}){let{range:l=e.luckysheet_select_save,order:n=U(e.currentSheetIndex),success:r}={...t};if("string"==W(l)){if(!o.iscelldata(l))return a.info("The range parameter is invalid.","");let e=o.getcellrange(l);l=[{row:e.row,column:e.column}]}else if("object"==W(l)){if(null==l.row||null==l.column)return a.info("The range parameter is invalid.","");l=[{row:l.row,column:l.column}]}if("array"!=W(l))return a.info("The range parameter is invalid.","");let i=e.luckysheetfile[n];if(null==i)return a.info("The order parameter is invalid.","");let s=$.extend(!0,{},i.config),c=!1;for(let e=0;e<l.length;e++){let t=l[e].row[0],n=l[e].row[1],r=l[e].column[0],o=l[e].column[1];if(c=ge(s,t,n,r,o))break}if(c)return a.info("Cannot perform this operation on partially merged cells","");let u=$.extend(!0,[],i.data);0==u.length&&(u=$.extend(!0,[],z.buildGridData(i)));for(let e=0;e<l.length;e++){let t=l[e].row[0],n=l[e].row[1],r=l[e].column[0],a=l[e].column[1];for(let e=t;e<=n;e++)for(let t=r;t<=a;t++){let l=u[e][t];"object"==W(l)?(delete l.m,delete l.v,null!=l.f&&(delete l.f,o.delFunctionGroup(e,t,i.index),delete l.spl),null!=l.ct&&"inlineStr"==l.ct.t&&delete l.ct):u[e][t]=null}}i.index==e.currentSheetIndex?oe(u,l):i.data=u,r&&"function"==typeof r&&r()},deleteRange:function(t,l={}){if(!["left","up"].includes(t))return a.info("The move parameter is invalid.","");let{range:n=e.luckysheet_select_save[e.luckysheet_select_save.length-1],order:r=U(e.currentSheetIndex),success:i}={...l};if("string"==W(n)){if(!o.iscelldata(n))return a.info("The range parameter is invalid.","");let e=o.getcellrange(n);n={row:e.row,column:e.column}}if("object"!=W(n)||null==n.row||null==n.column)return a.info("The range parameter is invalid.","");if(null==e.luckysheetfile[r])return a.info("The order parameter is invalid.","");let s=n.row[0],c=n.row[1],u=n.column[0],f=n.column[1];"left"==t?ae("moveLeft",s,c,u,f,r):"up"==t&&ae("moveUp",s,c,u,f,r),i&&"function"==typeof i&&i()},matrixOperation:function(t,l={}){if(!t||["flipUpDown","flipLeftRight","flipClockwise","flipCounterClockwise","transpose","deleteZeroByRow","deleteZeroByColumn","removeDuplicateByRow","removeDuplicateByColumn","newMatrix"].indexOf(t)<0)return a.info("The type parameter is invalid.","");let r=e.luckysheet_select_save[0],{range:i=r,success:s}={...l};if(i instanceof Array&&i.length>1)return void a.info(n().drag.noMulti,"");i&&"string"==typeof i&&o.iscelldata(i)&&(i=o.getcellrange(i));let u,f,d,h=le(i),g=[];if(0!==h.length){switch(t){case"flipUpDown":for(let e=h.length-1;e>=0;e--){let t=[];for(let l=0;l<h[0].length;l++){let n="";null!=h[e]&&null!=h[e][l]&&(n=h[e][l]),t.push(n)}g.push(t)}break;case"flipLeftRight":for(let e=0;e<h.length;e++){let t=[];for(let l=h[0].length-1;l>=0;l--){let n="";null!=h[e]&&null!=h[e][l]&&(n=h[e][l]),t.push(n)}g.push(t)}break;case"flipClockwise":for(let e=0;e<h[0].length;e++){let t=[];for(let l=h.length-1;l>=0;l--){let n="";null!=h[l]&&null!=h[l][e]&&(n=h[l][e]),t.push(n)}g.push(t)}break;case"flipCounterClockwise":for(let e=h[0].length-1;e>=0;e--){let t=[];for(let l=0;l<h.length;l++){let n="";null!=h[l]&&null!=h[l][e]&&(n=h[l][e]),t.push(n)}g.push(t)}break;case"transpose":for(let e=0;e<h[0].length;e++){let t=[];for(let l=0;l<h.length;l++){let n="";null!=h[l]&&null!=h[l][e]&&(n=h[l][e]),t.push(n)}g.push(t)}break;case"deleteZeroByRow":u=h[0].length;for(let e=0;e<h.length;e++){let t=[],l=!0,n=!0;for(let n=0;n<u;n++){let r="";if(null!=h[e]&&null!=h[e][n]){if(("0"==(r=h[e][n]).v||0==r.v)&&l)continue;l=!1}t.push(r)}let r=[];if(t.length==u)r=t;else{for(let e=t.length-1;e>=0;e--){let l="";if(null!=t[e]){if(("0"==(l=t[e]).v||0==l.v)&&n)continue;n=!1}r.unshift(l)}let e=u-r.length;for(let t=0;t<e;t++)r.push("")}g.push(r)}break;case"deleteZeroByColumn":u=h.length,f=h[0].length;for(let e=0;e<f;e++){let t=[],l=!0,n=!0;for(let n=0;n<u;n++){let r="";if(null!=h[n]&&null!=h[n][e]){if(("0"==(r=h[n][e]).v||0==r.v)&&l)continue;l=!1}t.push(r)}let r=[];if(t.length==u)r=t;else{for(let e=t.length-1;e>=0;e--){let l="";if(null!=t[e]){if(("0"==(l=t[e]).v||0==l.v)&&n)continue;n=!1}r.unshift(l)}let e=u-r.length;for(let t=0;t<e;t++)r.push("")}g.push(r)}d=[];for(let e=0;e<g[0].length;e++){let t=[];for(let l=0;l<g.length;l++){let n="";null!=g[l]&&null!=g[l][e]&&(n=g[l][e]),t.push(n)}d.push(t)}break;case"removeDuplicateByRow":u=h[0].length;for(let e=0;e<h.length;e++){let t=[],l={};for(let t=0;t<u;t++){let n=null;null!=h[e]&&null!=h[e][t]&&((n=h[e][t]).v in l?l[n.v].push(n):(l[n.v]=[],l[n.v].push(n)))}for(let n=0;n<u;n++){let r=null;null!=h[e]&&null!=h[e][n]&&1==l[(r=h[e][n]).v].length&&t.push(r)}let n=u-t.length;for(let e=0;e<n;e++)t.push(null);g.push(t)}break;case"removeDuplicateByColumn":f=h[0].length,u=h.length;for(let e=0;e<f;e++){let t=[],l={};for(let t=0;t<u;t++){let n=null;null!=h[t]&&null!=h[t][e]&&((n=h[t][e]).v in l?l[n.v].push(n):(l[n.v]=[],l[n.v].push(n)))}for(let n=0;n<u;n++){let r=null;null!=h[n]&&null!=h[n][e]&&1==l[(r=h[n][e]).v].length&&t.push(r)}a1=t;let n=u-a1.length;for(let e=0;e<n;e++)a1.push(null);g.push(a1)}d=[];for(let e=0;e<g[0].length;e++){let t=[];for(let l=0;l<g.length;l++){let n=null;null!=g[l]&&null!=g[l][e]&&(n=g[l][e]),t.push(n)}d.push(t)}break;case"newMatrix":console.log("TODO")}c.controlHandler(g,i),s&&"function"==typeof s&&s()}},matrixCalculation:function(t,l,r={}){if(!t||["plus","minus","multiply","divided","power","root","log"].indexOf(t)<0)return a.info("The type parameter is invalid.","");if(!de(l))return a.info("The number parameter is invalid.","");let i=e.luckysheet_select_save[0],{range:s=i,success:u}={...r};if(s instanceof Array&&s.length>1)return void a.info(n().drag.noMulti,"");s&&"string"==typeof s&&o.iscelldata(s)&&(s=o.getcellrange(s));let f=le(s);if(0==f.length)return;let d=[];for(let e=0;e<f.length;e++){let n=[];for(let r=0;r<f[0].length;r++){let o="";null!=f[e]&&null!=f[e][r]&&(o=f[e][r],null!=parseInt(o)&&void 0!=f[e][r].ct&&"n"==f[e][r].ct.t&&("minus"==t?o.v=o.v-l:"multiply"==t?o.v=o.v*l:"divided"==t?o.v=numFormat(o.v/l,4):"power"==t?o.v=Math.pow(o.v,l):"root"==t?2==l?o.v=numFormat(Math.sqrt(o.v),4):3==l&&Math.cbrt?o.v=numFormat(Math.cbrt(o.v),4):o.v=numFormat(jfnqrt(o.v,l),4):o.v="log"==t?numFormat(1e4*Math.log(o.v)/Math.log(Math.abs(l)),4):o.v+l,null==o.v?o.m="":o.m=o.v.toString())),n.push(o)}d.push(n)}c.controlHandler(d,s),u&&"function"==typeof u&&u()},setSheetAdd:function(t={}){let l=e.luckysheetfile.length-1,{sheetObject:n={},order:r=l,success:o}={...t};if(!de(r))return a.info("Parameter is not a table index","");r=Number(r);let i=z.generateRandomSheetIndex();n.calcChain&&n.calcChain.length>0&&n.calcChain.forEach(e=>{e.index=i});let s=z.generateRandomSheetName(e.luckysheetfile,!1);if(n.name){let t=!1;for(let l=0;l<e.luckysheetfile.length;l++)if(e.luckysheetfile[l].name==n.name){t=!0;break}t||(s=n.name)}$("#luckysheet-sheet-container-c").append(V(be,{index:i,active:"",name:s,style:"",colorset:""}));let c={name:"",color:"",status:"0",order:"",index:"",celldata:[],row:e.defaultrowNum,column:e.defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!1};if((c=$.extend(!0,c,n)).index=i,c.name=s,c.order=r,r<=0){let t=e.luckysheetfile[0].index,l=$("#luckysheet-sheets-item"+t);$("#luckysheet-sheets-item"+i).insertBefore(l),e.luckysheetfile.splice(0,0,c)}else{r>e.luckysheetfile.length&&(r=e.luckysheetfile.length);let t=e.luckysheetfile[r-1].index,l=$("#luckysheet-sheets-item"+t);$("#luckysheet-sheets-item"+i).insertAfter(l),e.luckysheetfile.splice(r,0,c)}let u={};if(e.luckysheetfile.forEach((e,t,l)=>{l[t].order=t,u[e.index.toString()]=t}),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+i).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+i+'" class="luckysheet-datavisual-selection-set"></div>'),f(!0),S.saveParam("sha",null,$.extend(!0,{},c)),S.saveParam("shr",null,u),e.clearjfundo){e.jfundo.length=0;let t={type:"addSheet"};t.sheetconfig=$.extend(!0,{},c),t.index=i,t.currentSheetIndex=e.currentSheetIndex,e.jfredo.push(t)}z.changeSheetExec(i,!1,!0),o&&"function"==typeof o&&o()},setSheetDelete:function(t={}){let{order:l=U(e.currentSheetIndex),success:r}={...t},o=e.luckysheetfile[l];return null==o?a.info("The order parameter is invalid.",""):1===e.luckysheetfile.length?a.info(n().sheetconfig.noMoreSheet,""):(z.deleteSheet(o.index),setTimeout(()=>{r&&"function"==typeof r&&r()},1),o)},setSheetCopy:function(t={}){let{targetOrder:l,order:n=U(e.currentSheetIndex),success:r}={...t},o=e.luckysheetfile[n];if(null==o)return a.info("The order parameter is invalid.","");if(null==l&&(l=n+1),!de(l))return a.info("The targetOrder parameter is invalid.","");let i=o.index,s=z.generateRandomSheetIndex(),c=$.extend(!0,{},o);c.order=e.luckysheetfile.length,c.index=s,c.name=z.generateCopySheetName(e.luckysheetfile,c.name);let u="";null!=c.color&&(u='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+c.color+';"></div>');let d=$("#luckysheet-sheets-item"+i);if(de(l)&&(d=$("#luckysheet-sheets-item"+e.luckysheetfile[l-1].index)),$("#luckysheet-sheet-container-c").append(V(be,{index:c.index,active:"",name:c.name,order:c.order,style:"",colorset:u})),$("#luckysheet-sheets-item"+c.index).insertAfter(d),e.luckysheetfile.splice(l,0,c),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+s).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+s+'" class="luckysheet-datavisual-selection-set"></div>'),f(!0),S.saveParam("shc",s,{copyindex:i,name:c.name}),z.changeSheetExec(s),z.reOrderAllSheet(),e.clearjfundo)e.jfredo.push({type:"copySheet",copyindex:i,index:c.index,sheetIndex:c.index});else if(e.jfredo.length>0){let t=e.jfredo[e.jfredo.length-1];"copySheet"==t.type&&(t.index=c.index,t.sheetIndex=c.index)}return setTimeout(()=>{r&&"function"==typeof r&&r()},1),c},setSheetHide:function(t={}){let{order:l=U(e.currentSheetIndex),success:n}={...t},r=e.luckysheetfile[l];return null==r?a.info("The order parameter is invalid.",""):(z.setSheetHide(r.index),setTimeout(()=>{n&&"function"==typeof n&&n()},1),r)},setSheetShow:function(t={}){let{order:l=U(e.currentSheetIndex),success:n}={...t},r=e.luckysheetfile[l];return null==r?a.info("The order parameter is invalid.",""):(z.setSheetShow(r.index),setTimeout(()=>{n&&"function"==typeof n&&n()},1),r)},setSheetActive:function(t,l={}){if(null==t||!de(t)||null==e.luckysheetfile[t])return a.info("The order parameter is invalid.","");let n=e.luckysheetfile[t],{success:r}={...l};return $("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+n.index).addClass("luckysheet-sheets-item-active"),z.changeSheet(n.index),setTimeout(()=>{r&&"function"==typeof r&&r()},1),S.multipleRangeShow(),n},setSheetName:function(t,l={}){if("string"!=W(t)||0==t.toString().length)return a.info("The name parameter is invalid.","");let{order:n=U(e.currentSheetIndex),success:r}={...l},o=e.luckysheetfile[n];if(null==o)return a.info("The order parameter is invalid.","");let i=o.name;if(o.name=t,$("#luckysheet-sheets-item"+o.index+" .luckysheet-sheets-item-name").text(t),S.saveParam("all",o.index,t,{k:"name"}),e.clearjfundo){let l={type:"sheetName"};l.sheetIndex=o.index,l.oldtxt=i,l.txt=t,e.jfundo.length=0,e.jfredo.push(l)}r&&"function"==typeof r&&r()},setSheetColor:function(t,l={}){if("string"!=W(t)||0==t.toString().length)return a.info("The color parameter is invalid.","");let{order:n=U(e.currentSheetIndex),success:r}={...l},o=e.luckysheetfile[n];if(null==o)return a.info("The order parameter is invalid.","");let i=o.color;if(o.color=t,$("#luckysheet-sheets-item"+o.index).find(".luckysheet-sheets-item-color").remove(),$("#luckysheet-sheets-item"+o.index).append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+t+';"></div>'),S.saveParam("all",o.index,t,{k:"color"}),e.clearjfundo){let l={type:"sheetColor"};l.sheetIndex=o.index,l.oldcolor=i,l.color=t,e.jfundo.length=0,e.jfredo.push(l)}r&&"function"==typeof r&&r()},setSheetMove:function(t,l={}){if("left"!=t&&"right"!=t&&!de(t))return a.info("Type parameter not available","");de(t)&&(t=parseInt(t));let n=U(e.currentSheetIndex),{order:r=n,success:o}={...l},i=e.luckysheetfile[r];if(null==i)return a.info("ncorrect worksheet index","");let s=i.index;if("left"==t){if(0==r)return;let t=e.luckysheetfile[r-1].index;$("#luckysheet-sheets-item"+s).insertBefore($("#luckysheet-sheets-item"+t)),e.luckysheetfile.splice(r,1),e.luckysheetfile.splice(r-1,0,i)}else if("right"==t){if(r==e.luckysheetfile.length-1)return;let t=e.luckysheetfile[r+1].index;$("#luckysheet-sheets-item"+s).insertAfter($("#luckysheet-sheets-item"+t)),e.luckysheetfile.splice(r,1),e.luckysheetfile.splice(r+1,0,i)}else{if(t<0&&(t=0),t>e.luckysheetfile.length-1&&(t=e.luckysheetfile.length-1),t==r)return;if(t<r){let l=e.luckysheetfile[t].index;$("#luckysheet-sheets-item"+s).insertBefore($("#luckysheet-sheets-item"+l))}else{let l=e.luckysheetfile[t].index;$("#luckysheet-sheets-item"+s).insertAfter($("#luckysheet-sheets-item"+l))}e.luckysheetfile.splice(r,1),e.luckysheetfile.splice(t,0,i)}let c={};e.luckysheetfile.forEach((e,t,l)=>{l[t].order=t,c[e.index.toString()]=t}),S.saveParam("shr",null,c),o&&"function"==typeof o&&o()},setSheetOrder:function(t,l={}){if(null==t||0==t.length)return a.info("Type orderList not available","");let n={};t.forEach(e=>{n[e.index.toString()]=e.order}),e.luckysheetfile.sort((e,t)=>{let l=n[e.index.toString()],r=n[t.index.toString()];return null!=l&&null!=r?l-r:null!=l?-1:1});let r={};e.luckysheetfile.forEach((e,t,l)=>{if(l[t].order=t,r[e.index.toString()]=t,t>0){let n=l[t-1].index;$("#luckysheet-sheets-item"+e.index).insertAfter($("#luckysheet-sheets-item"+n))}}),S.saveParam("shr",null,r);let{success:o}={...l};o&&"function"==typeof o&&o()},setSheetZoom:function(t,l={}){if(!de(t)||t<.1||t>4)return a.info("The zoom parameter is invalid.","");let{order:n=U(e.currentSheetIndex),success:r}={...l},o=e.luckysheetfile[n];if(null==o)return a.info("The order parameter is invalid.","");o.zoomRatio=t,S.saveParam("all",o.index,t,{k:"zoomRatio"}),o.index==e.currentSheetIndex&&(e.zoomRatio=t,Ie(),Te()),r&&"function"==typeof r&&r()},showGridLines:function(t={}){let{order:l=U(e.currentSheetIndex),success:n}={...t},r=e.luckysheetfile[l];return null==r?a.info("The order parameter is invalid.",""):(r.showGridLines=!0,r.index==e.currentSheetIndex&&(e.showGridLines=!0,setTimeout(function(){re()},1)),setTimeout(()=>{n&&"function"==typeof n&&n()},1),r)},hideGridLines:function(t={}){let{order:l=U(e.currentSheetIndex),success:n}={...t},r=e.luckysheetfile[l];return null==r?a.info("The order parameter is invalid.",""):(r.showGridLines=!1,r.index==e.currentSheetIndex&&(e.showGridLines=!1,setTimeout(function(){re()},1)),setTimeout(()=>{n&&"function"==typeof n&&n()},1),r)},refresh:function(e={}){oe();let{success:t}={...e};t&&"function"==typeof t&&t()},scroll:function(t={}){let{scrollLeft:l,scrollTop:n,targetRow:r,targetColumn:o,success:i}={...t};if(null!=l){if(!de(l))return a.info("The scrollLeft parameter is invalid.","");$("#luckysheet-scrollbar-x").scrollLeft(l)}else if(null!=o){if(!de(o))return a.info("The targetColumn parameter is invalid.","");e.visibledatacolumn[o];let t=o<=0?0:e.visibledatacolumn[o-1];$("#luckysheet-scrollbar-x").scrollLeft(t)}if(null!=n){if(!de(n))return a.info("The scrollTop parameter is invalid.","");$("#luckysheet-scrollbar-y").scrollTop(n)}else if(null!=r){if(!de(r))return a.info("The targetRow parameter is invalid.","");e.visibledatarow[r];let t=r<=0?0:e.visibledatarow[r-1];$("#luckysheet-scrollbar-y").scrollTop(t)}i&&"function"==typeof i&&i()},resize:function(e={}){R();let{success:t}={...e};t&&"function"==typeof t&&t()},getScreenshot:function(t={}){let{range:l=e.luckysheet_select_save[e.luckysheet_select_save.length-1]}={...t};if("string"==W(l)){if(!o.iscelldata(l))return a.info("The range parameter is invalid.","");let e=o.getcellrange(l);l={row:e.row,column:e.column}}if("object"!=W(l)||null==l.row||null==l.column)return a.info("The range parameter is invalid.","");let n=l.row[0],r=l.row[1],i=l.column[0],s=l.column[1];if(ge(e.config,n,r,i,s))return a.info("Cannot perform this operation on partially merged cells","");let c,u,f,d,h=e.visibledatarow,g=e.visibledatacolumn;n-1<0?(c=0,u=h[r]):(c=h[n-1],u=h[r]-h[n-1]),i-1<0?(f=0,d=g[s]):(f=g[i-1],d=g[s]-g[i-1]);let m=$("<canvas>").attr({width:Math.ceil(d*e.devicePixelRatio),height:Math.ceil(u*e.devicePixelRatio)}).css({width:d,height:u});ve(f,c,d,u,1,1,null,null,m);let p=m.get(0).getContext("2d");return p.beginPath(),p.moveTo(0,0),p.lineTo(0,e.devicePixelRatio*u),p.lineWidth=2*e.devicePixelRatio,p.strokeStyle=Se.strokeStyle,p.stroke(),p.closePath(),p.beginPath(),p.moveTo(0,0),p.lineTo(e.devicePixelRatio*d,0),p.lineWidth=2*e.devicePixelRatio,p.strokeStyle=Se.strokeStyle,p.stroke(),p.closePath(),m.get(0).toDataURL("image/png")},setWorkbookName:function(e,t={}){if(null==e||0==e.toString().length)return a.info("The name parameter is invalid.","");$("#luckysheet_info_detail_input").val(e);let{success:l}={...t};l&&"function"==typeof l&&l()},getWorkbookName:function(e={}){let t="",l=$("#luckysheet_info_detail_input");if(0==l.length)return a.info("Failed to get workbook name, label loading failed!"),t;t=$.trim(l.val());let{success:n}={...e};return setTimeout(()=>{n&&"function"==typeof n&&n()},1),t},undo:function(t={}){let l=$.extend(!0,{},e.jfredo[e.jfredo.length-1]);A.redo(new Event("custom")),L();let{success:n}={...t};return setTimeout(()=>{n&&"function"==typeof n&&n()},1),l},redo:function(t={}){let l=$.extend(!0,{},e.jfundo[e.jfundo.length-1]);A.undo(new Event("custom")),L();let{success:n}={...t};return setTimeout(()=>{n&&"function"==typeof n&&n()},1),l},getAllSheets:We,getSheet:function(t={}){let{index:l,order:n,name:r}={...t};return null!=l?z.getSheetByIndex(l):null!=n?e.luckysheetfile[n]:null!=r?z.getSheetByName(r):z.getSheetByIndex()},getSheetData:function(t={}){let{order:l=U(e.currentSheetIndex)}={...t},n=e.luckysheetfile[l];if(null==n)return a.info("The order parameter is invalid.","");let r=$.extend(!0,[],n.data);return null!=r&&0!=r.length||(r=$.extend(!0,[],z.buildGridData(n))),r},getConfig:function(t={}){let{order:l=U(e.currentSheetIndex)}={...t},n=e.luckysheetfile[l];return null==n?a.info("The order parameter is invalid.",""):$.extend(!0,{},n.config)},setConfig:function(t,l={}){if("object"!=W(t))return a.info("The cfg parameter is invalid.","");let{order:n=U(e.currentSheetIndex),success:r}={...l},o=e.luckysheetfile[n];if(null==o)return a.info("The order parameter is invalid.","");o.config=t,o.index==e.currentSheetIndex&&(e.config=t,("rowhidden"in t||"colhidden"in t||"rowlen"in t||"columnlen"in t)&&ie(e.flowdata.length,e.flowdata[0].length),setTimeout(function(){re()},1)),r&&"function"==typeof r&&r()},getLuckysheetfile:function(){return J()},setDataVerification:function(t,l={}){if("object"!=W(t))return a.info("The optionItem parameter is invalid.","");let{type:r,type2:i=null,value1:s="",value2:c="",remote:u=!1,prohibitInput:f=!1,hintShow:d=!1,hintText:h="",checked:g=!1}={...t},m=["bw","nb","eq","ne","gt","lt","gte","lte"],p=["include","exclude","equal"],y=["bw","nb","eq","ne","bf","nbf","af","naf"],v=["card","phone"];if(!["dropdown","checkbox","number","number_integer","number_decimal","text_content","text_length","date","validity"].includes(r))return a.info("The optionItem.type parameter is invalid.","");let w=n().dataVerification;if("dropdown"==r){if(0==s.length)return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo1)}else if("checkbox"==r){if(0==s.length||0==c.length)return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo2)}else if("number"==r||"number_integer"==r||"number_decimal"==r){if(!m.includes(i))return a.info("The optionItem.type2 parameter is invalid.","");if(!de(s))return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo3);if("bw"==i||"nb"==i){if(!de(c))return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo3);if(Number(c)<Number(s))return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo4)}}else if("text_content"==r){if(!p.includes(i))return a.info("The optionItem.type2 parameter is invalid.","");if(0==s.length)return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo5)}else if("text_length"==r){if(!m.includes(i))return a.info("The optionItem.type2 parameter is invalid.","");if(!de(s))return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo3);if("bw"==i||"nb"==i){if(!de(c))return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo3);if(Number(c)<Number(s))return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo4)}}else if("date"==r){if(!y.includes(i))return a.info("The optionItem.type2 parameter is invalid.","");if(!me(s))return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo6);if("bw"==i||"nb"==i){if(!me(c))return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo6);if(pe(s,c)>0)return void a.info('<i class="fa fa-exclamation-triangle"></i>',w.tooltipInfo7)}}else if("validity"==r&&!v.includes(i))return a.info("The optionItem.type2 parameter is invalid.","");if("boolean"!=W(u))return a.info("The optionItem.remote parameter is invalid.","");if("boolean"!=W(f))return a.info("The optionItem.prohibitInput parameter is invalid.","");if("boolean"!=W(d))return a.info("The optionItem.hintShow parameter is invalid.","");let{range:x=e.luckysheet_select_save[e.luckysheet_select_save.length-1],order:k=U(e.currentSheetIndex),success:b}={...l};if("string"==W(x)){if(!o.iscelldata(x))return a.info("The range parameter is invalid.","");let e=o.getcellrange(x);x={row:e.row,column:e.column}}if("object"!=W(x)||null==x.row||null==x.column)return a.info("The range parameter is invalid.","");let S=e.luckysheetfile[k];if(null==S)return a.info("The order parameter is invalid.","");let _={type:r,type2:i,value1:s,value2:c,checked:g,remote:u,prohibitInput:f,hintShow:d,hintText:h},T=$.extend(!0,{},S.dataVerification),I=$.extend(!0,[],S.data);0==I.length&&(I=z.buildGridData(S));let C=x.row[0],R=x.row[1],M=x.column[0],F=x.column[1];for(let e=C;e<=R;e++)for(let t=M;t<=F;t++)T[e+"_"+t]=_,"checkbox"==r&&X(e,t,I,_.checked?_.value1:_.value2);if(S.index==e.currentSheetIndex){let t=$.extend(!0,{},S.dataVerification);"checkbox"==r?O.refOfCheckbox(t,T,e.currentSheetIndex,I,x):O.ref(t,T,e.currentSheetIndex)}else S.dataVerification=T,S.data=I;b&&"function"==typeof b&&b()},deleteDataVerification:function(t={}){let{range:l=e.luckysheet_select_save[e.luckysheet_select_save.length-1],order:n=U(e.currentSheetIndex),success:r}={...t};if("string"==W(l)){if(!o.iscelldata(l))return a.info("The range parameter is invalid.","");let e=o.getcellrange(l);l={row:e.row,column:e.column}}if("object"!=W(l)||null==l.row||null==l.column)return a.info("The range parameter is invalid.","");let i=e.luckysheetfile[n];if(null==i)return a.info("The order parameter is invalid.","");let s=$.extend(!0,{},i.dataVerification),c=l.row[0],u=l.row[1],f=l.column[0],d=l.column[1];for(let e=c;e<=u;e++)for(let t=f;t<=d;t++)delete s[e+"_"+t];if(i.index==e.currentSheetIndex){let t=$.extend(!0,{},i.dataVerification);O.ref(t,s,e.currentSheetIndex)}else i.dataVerification=s;r&&"function"==typeof r&&r()},insertImage:function(t,l={}){let{order:n=U(e.currentSheetIndex),rowIndex:r,colIndex:o,success:i}={...l},s=e.luckysheetfile[n];if(null==s)return a.info("The order parameter is invalid.","");if(s.index==e.currentSheetIndex){let l=e.luckysheet_select_save[e.luckysheet_select_save.length-1];null==r&&(r=l.row_focus||0),r<0&&(r=0),r>e.visibledatarow.length&&(r=e.visibledatarow.length),null==o&&(o=l.column_focus||0),o<0&&(o=0),o>e.visibledatacolumn.length&&(o=e.visibledatacolumn.length);let n=0==o?0:e.visibledatacolumn[o-1],a=0==r?0:e.visibledatarow[r-1],s=new Image;s.onload=function(){let e=s.width,l=s.height,r={src:t,left:n,top:a,originWidth:e,originHeight:l};P.addImgItem(r),i&&"function"==typeof i&&i()},s.src=t}else{let l=s.images||{},n=s.config,a=s.zoomRatio||1,c=s.row,u=s.visibledatarow||[];if(0===u.length){let t=0;for(let l=0;l<c;l++){let r=e.defaultrowlen;null!=n.rowlen&&null!=n.rowlen[l]&&(r=n.rowlen[l]),null==n.rowhidden||null==n.rowhidden[l]?(t+=Math.round((r+1)*a),u.push(t)):u.push(t)}}let f=s.column,d=s.visibledatacolumn||[];if(0===d.length){let t=0;for(let l=0;l<f;l++){let r=e.defaultcollen;null!=n.columnlen&&null!=n.columnlen[l]&&(r=n.columnlen[l]),null==n.colhidden||null==n.colhidden[l]?(t+=Math.round((r+1)*a),d.push(t)):d.push(t)}}null==r&&(r=0),r<0&&(r=0),r>u.length&&(r=u.length),null==o&&(o=0),o<0&&(o=0),o>d.length&&(o=d.length);let h=0==o?0:d[o-1],g=0==r?0:u[r-1],m=new Image;m.onload=function(){let e,n,r={src:t,left:h,top:g,originWidth:m.width,originHeight:m.height};r.originHeight<r.originWidth?(n=Math.round(r.originHeight*(400/r.originWidth)),e=400):(e=Math.round(r.originWidth*(400/r.originHeight)),n=400);let o=$.extend(!0,{},P.imgItem);o.src=r.src,o.originWidth=r.originWidth,o.originHeight=r.originHeight,o.default.width=e,o.default.height=n,o.default.left=r.left,o.default.top=r.top,o.crop.width=e,o.crop.height=n;let a=P.generateRandomId();l[a]=o,s.images=l,i&&"function"==typeof i&&i()},m.src=t}},deleteImage:function(t={}){let{order:l=U(e.currentSheetIndex),idList:n="all",success:r}={...t},o=e.luckysheetfile[l];if(null==o)return a.info("The order parameter is invalid.","");let i=o.images;return null==i?a.info("The worksheet has no pictures to delete.",""):"all"!=n&&"array"!=W(n)?a.info("The idList parameter is invalid.",""):("array"==W(n)?n.forEach(e=>{delete i[e]}):i=null,o.images=i,o.index==e.currentSheetIndex&&(null==P.currentImgId||"all"!=n&&!n.includes(P.currentImgId)||($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide()),P.images=i,P.allImagesShow(),P.init()),void(r&&"function"==typeof r&&r()))},getImageOption:function(t={}){let{order:l=U(e.currentSheetIndex),success:n}={...t},r=e.luckysheetfile[l];return null==r?a.info("The order parameter is invalid.",""):(setTimeout(function(){n&&"function"==typeof n&&n()},1),r.images)},transToCellData:function(e,t={}){let{success:l}={...t};return setTimeout(()=>{l&&"function"==typeof l&&l()},0),z.getGridData(e)},transToData:function(e,t={}){let{success:l}={...t};return setTimeout(()=>{l&&"function"==typeof l&&l()},0),z.buildGridData({celldata:e})},toJson:Ge,changLang:function(e="zh"){if(!["zh","en","es"].includes(e))return a.info("The lang parameter is invalid.","");let t=Ge();t.lang=e,luckysheet.create(t)},closeWebsocket:function(){null!=S.websocket&&S.websocket.close(1e3)},getRangeByTxt:function(t){if(null==t)return{column:e.luckysheet_select_save[e.luckysheet_select_save.length-1].column,row:e.luckysheet_select_save[e.luckysheet_select_save.length-1].row};const l=M.getRangeByTxt(t);return{column:l[0].column,row:l[0].row}},getTxtByRange:function(t=e.luckysheet_select_save){return"object"===W(t)&&(t=[t]),M.getTxtByRange(t)},pagerInit:function(e){$("#luckysheet-bottom-pager").remove(),$("#luckysheet-sheet-area").append('<div id="luckysheet-bottom-pager" style="font-size: 14px; margin-left: 10px; display: inline-block;"></div>'),$("#luckysheet-bottom-pager").sPage({page:e.pageIndex,total:e.total,selectOption:e.selectOption,pageSize:e.pageSize,showTotal:!0,showSkip:e.showSkip||!0,showPN:e.showPN||!0,backFun:function(e){e.pageIndex=e.page,r.createHookFunction("onTogglePager",e)}})},refreshFormula:function(e){o.execFunctionGroupForce(!0),re(),setTimeout(()=>{e&&"function"==typeof e&&e()})},refreshMenuButtonFocus:function(t,l,n,r){if(t=t||e.flowdata,null==l&&null==n){let t=e.luckysheet_select_save[e.luckysheet_select_save.length-1];l=t.row_focus||t.row[0],n=t.column_focus||t.column[0]}_.menuButtonFocus(t,l,n),setTimeout(()=>{r&&"function"==typeof r&&r()})}}});
//# sourceMappingURL=../sourcemaps/global/api.js.map
