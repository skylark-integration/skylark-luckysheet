/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../controllers/constant","./browser","../utils/util","../locale/locale","../controllers/server"],function(t,e,o,n,l){"use strict";const{modelHTML:s,luckysheetchartpointconfigHTML:i,luckysheetToolHTML:c}=t,{replaceHtml:p}=o;return{info:function(t,e){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-info").remove();let o=n().button;$("body").append(p(s,{id:"luckysheet-info",addclass:"",title:t,content:e,botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;'+o.close+"&nbsp;&nbsp;</button>",style:"z-index:100003"}));let l=$("#luckysheet-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),i=l.outerHeight(),c=l.outerWidth(),d=$(window).width(),u=$(window).height(),h=$(document).scrollLeft(),r=$(document).scrollTop();$("#luckysheet-info").css({left:(d+h-c)/2,top:(u+r-i)/3}).show()},confirm:function(t,e,o,i,c,d){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove();const u=n().button;null==c&&(c=u.confirm),null==d&&(d=u.cancel),$("body").append(p(s,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:t,content:e,botton:'<button class="btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+c+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+d+"&nbsp;&nbsp;</button>"}));let h=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),r=h.outerHeight(),a=h.outerWidth(),f=$(window).width(),m=$(window).height(),b=$(document).scrollLeft(),k=$(document).scrollTop();$("#luckysheet-confirm").css({left:(f+b-a)/2,top:(m+k-r)/3}).show(),h.find(".luckysheet-model-conform-btn").click(function(){"function"==typeof o&&o(),l.keepHighLightBox(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),h.find(".luckysheet-model-cancel-btn").click(function(){"function"==typeof i&&i(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()})},screenshot:function(t,o,l){const i=n().screenshot;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove(),$("body").append(p(s,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:t,content:o,botton:'<a style="text-decoration:none;color:#fff;" class="download btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+i.downLoadBtn+'&nbsp;&nbsp;</a>&nbsp;&nbsp;<button class="btn btn-primary luckysheet-model-copy-btn">&nbsp;&nbsp;'+i.downLoadCopy+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+i.downLoadClose+"&nbsp;&nbsp;</button>"}));let c=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),d=c.outerHeight(),u=c.outerWidth(),h=$(window).width(),r=$(window).height(),a=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-confirm").css({left:(h+a-u)/2,top:(r+f-d)/3}).show(),c.find(".luckysheet-model-conform-btn").click(function(){"1"==e.isIE()?alert(i.browserNotTip):(window.ActiveXObject||"ActiveXObject"in window)&&(0===$("#IframeReportImg").length&&$('<iframe style="display:none;" id="IframeReportImg" name="IframeReportImg" onload="downloadImg();" width="0" height="0" src="about:blank"></iframe>').appendTo("body"),$("#IframeReportImg").attr("src")!=l?$("#IframeReportImg").attr("src",l):"about:blank"!=$("#IframeReportImg").src&&window.frames.IframeReportImg.document.execCommand("SaveAs"))}),c.find(".luckysheet-model-cancel-btn").click(function(){$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#luckysheet-confirm .luckysheet-model-copy-btn").click(function(){let t=new clipboard.DT;t.setData("text/html","<img src='"+l+"'>"),"1"==e.isIE()?alert(i.rightclickTip):(clipboard.write(t),alert(i.successTip))})},chartPointConfig:function(t,e,o){$("body").append(p(s,{id:t,addclass:"luckysheet-chart-point-config-c",title:"数据点批量设置",content:i,botton:'<button class="btn btn-danger luckysheet-model-save-btn">&nbsp;&nbsp;保存设置&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;取消&nbsp;&nbsp;</button>',style:"z-index:100003;height:80%;width:80%;top:10%;left:10%;"})),$("#luckysheet-modal-dialog-mask").show();let n=$(window).width(),l=$(window).height();$("#"+t).find(".luckysheet-chart-point-config").css("height",l-160),$("#"+t).css({height:l-90,width:n-100,left:7,top:14}).show().find(".luckysheet-model-save-btn").click(function(){"function"==typeof e&&e(),$("#"+t).hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#"+t).find(".luckysheet-model-save-btn").click(function(){"function"==typeof o&&o(),$("#"+t).hide(),$("#luckysheet-modal-dialog-mask").hide()})},sheetConfig:function(){},hoverTipshowState:!1,hoverTipshowTimeOut:null,createHoverTip:function(t,e){let o=this;$(t).on("mouseover",e,function(t){o.hoverTipshowState||(clearTimeout(o.hoverTipshowTimeOut),o.hoverTipshowTimeOut=setTimeout(function(){let e=$(t.currentTarget),o=e.offset(),n=$("#luckysheet-tooltip-up"),l=e.data("tips");if(!(null!=l&&0!=l.length||null!=(l=e.prev().data("tips"))&&0!=l.length))return;0==n.length&&($("body").append(c),n=$("#luckysheet-tooltip-up")),n.removeClass("jfk-tooltip-hide").find("div.jfk-tooltip-contentId").html(l);let s=n.outerWidth();n.find("div.jfk-tooltip-arrow").css("left",s/2);let i=o.left+(e.outerWidth()-s)/2;i<2&&(i=2,n.find("div.jfk-tooltip-arrow").css("left",e.outerWidth()/2)),n.css({top:o.top+e.outerHeight()+1,left:i})},300))}).on("mouseout",e,function(t){o.hoverTipshowState=!1,clearTimeout(o.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")}).on("click",e,function(t){o.hoverTipshowState=!0,clearTimeout(o.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")})},popover:function(t,e,o,l,s,i){let c=n(),p=c.button,d=c.paint;null==s&&(s=p.close);let u='<div id="luckysheetpopover" class="luckysheetpopover"><div class="luckysheetpopover-content">'+d.start+'</div><div class="luckysheetpopover-btn">'+s+"</div></div>";$("#luckysheetpopover").remove(),$("body").append(u),$("#luckysheetpopover .luckysheetpopover-content").html(t);let h=$("#luckysheetpopover").outerWidth(),r=$("#luckysheetpopover").outerHeight(),a={};"topLeft"==e?(a.top="20px",a.left="20px"):"topCenter"==e?(a.top="20px",a.left="50%",a["margin-left"]=-h/2):"topRight"==e?(a.top="20px",a.right="20px"):"midLeft"==e?(a.top="50%",a["margin-top"]=-r/2,a.left="20px"):"center"==e?(a.top="50%",a["margin-top"]=-r/2,a.left="50%",a["margin-left"]=-h/2):"midRight"==e?(a.top="50%",a["margin-top"]=-r/2,a.right="20px"):"bottomLeft"==e?(a.bottom="20px",a.left="20px"):"bottomCenter"==e?(a.bottom="20px",a.left="50%",a["margin-left"]=-h/2):"bottomRight"==e?(a.bottom="20px",a.right="20px"):(a.top="20px",a.left="50%",a["margin-left"]=-h/2),"white"==l&&(a.background="rgba(255, 255, 255, 0.65)",a.color="#000",$("#luckysheetpopover .luckysheetpopover-btn").css({border:"1px solid #000"})),setTimeout(function(){$("#luckysheetpopover .luckysheetpopover-content").css({"margin-left":-$("#luckysheetpopover .luckysheetpopover-btn").outerWidth()/2})},1),$("#luckysheetpopover").css(a).fadeIn(),$("#luckysheetpopover .luckysheetpopover-btn").click(function(){"function"==typeof i&&i()}),null!=o&&"number"==typeof o&&setTimeout(function(){$("#luckysheetpopover").fadeOut().remove(),"function"==typeof i&&i()},o)}}});
//# sourceMappingURL=../sourcemaps/global/tooltip.js.map
