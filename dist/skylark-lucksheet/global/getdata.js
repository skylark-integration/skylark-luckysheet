/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../utils/util","../methods/get","../controllers/server","./formula","./editor","./dynamicArray","../controllers/sheetmanage","../controllers/inlineString","../locale/locale","../store"],function(l,n,t,e,u,r,o,i,f,c){"use strict";const{getObjType:a,rgbTohex:s}=l,{getSheetIndex:g}=n,{dynamicArrayCompute:d}=r,{isInlineStringCT:h,isInlineStringCell:w,convertCssToStyleList:y}=i;function m(l,n,t,u){let r;if(null==u&&(u="v"),null==t&&(t=c.flowdata),null!=l&&null!=n)r=t[l][n];else if(null!=l)r=t[l];else{if(null==n)return t;r=t[0].map(function(l,n){return t.map(function(l){return l[n]})})[n]}let o=r;return"object"==a(r)&&(o=r[u],"f"==u&&null!=o?o=e.functionHTMLGenerate(o):"f"==u?o=r.v:r&&r.ct&&"d"==r.ct.t&&(o=r.m)),void 0==o&&(o=null),o}function p(l,n,t){if(null==l||null==n)return;let e;if(null==t)e=c.flowdata;else{e=o.getSheetByIndex(t).data}return e&&e[l]&&e[l][n]?e[l][n]:void 0}function b(l,n,t,e=!0){if(null==l)return;let u="";const r=f().fontarray;for(let o in l){let i=l[o];if(e&&(i=S(l,o)),"bl"==o&&"0"!=i&&(u+="font-weight: bold;"),"it"==o&&"0"!=i&&(u+="font-style:italic;"),"ff"==o){let l=i;u+="font-family: "+(l=isNaN(parseInt(i))?i:r[parseInt(i)])+";"}if("fs"==o&&"10"!=i&&(u+="font-size: "+i+"pt;"),("fc"==o&&"#000000"!=i||null!=n||null!=t&&null!=t.textColor)&&(null!=t&&null!=t.textColor?u+="color: "+t.textColor+";":u+=null!=n?"color: "+n[0]+";":"color: "+i+";"),"cl"==o&&"0"!=i&&(u+="text-decoration: line-through;"),"un"==o&&("1"==i||"3"==i)){let n=l._color;null==n&&(n=l.fc);let t=l._fontSize;null==t&&(t=l.fs),u+="border-bottom: "+Math.floor(t/9)+"px solid "+n+";"}}return u}function S(l,n){let t=l;return n in{bl:1,it:1,ff:1,cl:1,un:1}||"fs"==n&&w(l)?null==t?t="0":null==(t=t[n])&&(t="0"):"fc"==n?null==t?t="#000000":(null==(t=t[n])&&(t="#000000"),t.indexOf("rgba")>-1&&(t=s(t))):"bg"==n?null==t?t=null:null==(t=t[n])?t=null:t.toString().indexOf("rgba")>-1&&(t=s(t)):"bs"==n.substr(0,2)?null==t?t="none":null==(t=t[n])&&(t="none"):"bc"==n.substr(0,2)?null==t?t="#000000":null==(t=t[n])&&(t="#000000"):"ht"==n?(null==t?t="1":null==(t=t[n])&&(t="1"),-1==["0","1","2"].indexOf(t.toString())&&(t="1")):"vt"==n?(null==t?t="0":null==(t=t[n])&&(t="0"),-1==["0","1","2"].indexOf(t.toString())&&(t="0")):"ct"==n?null==t?t=null:null==(t=t[n])&&(t=null):"fs"==n?null==t?t="10":null==(t=t[n])&&(t="10"):"tb"==n?null==t?t="0":null==(t=t[n])&&(t="0"):"tr"==n?null==t?t="0":null==(t=t[n])&&(t="0"):"rt"==n&&(null==t?t=null:null==(t=t[n])&&(t=null)),t}return{getdatabyselection:function(l,n){if(null==l&&(l=c.luckysheet_select_save[0]),null==l.row||0==l.row.length)return[];let t,e;null!=n&&n!=c.currentSheetIndex?(t=c.luckysheetfile[g(n)].data,e=c.luckysheetfile[g(n)].config):(t=u.deepCopyFlowData(c.flowdata),e=c.config);let r=[];for(let n=l.row[0];n<=l.row[1];n++){if(null==t[n])continue;if(null!=e.rowhidden&&null!=e.rowhidden[n])continue;let u=[];for(let e=l.column[0];e<=l.column[1];e++)u.push(t[n][e]);r.push(u)}return r},getdatabyselectionD:function(l,n){if(null==n||null==n.row||0==n.row.length)return[];let t=d(c.luckysheetfile[g(c.currentSheetIndex)].dynamicArray),e=[];if(null==l)return e;for(let u=n.row[0];u<=n.row[1];u++){if(null==l[u])continue;let r=[];for(let e=n.column[0];e<=n.column[1];e++){let n;n=u+"_"+e in t?t[u+"_"+e]:l[u][e],r.push(n)}e.push(r)}return e},getdatabyselectionNoCopy:function(l){if(null==l||null==l.row||0==l.row.length)return[];let n=[];for(let t=l.row[0];t<=l.row[1];t++){let e=[];if(null==c.config.rowhidden||null==c.config.rowhidden[t]){for(let n=l.column[0];n<=l.column[1];n++){let l="";null!=c.flowdata[t]&&null!=c.flowdata[t][n]&&(l=c.flowdata[t][n]),e.push(l)}n.push(e)}}return n},getcellvalue:m,datagridgrowth:function(l,n,e,u){if(n<=0&&e<=0)return l;n<=0&&(n=0),e<=0&&(e=0);let r=0;0==l.length?(l=[],r=0):r=l[0].length;let o=[];for(let l=0;l<e;l++)o.push(null);let i=[];for(let l=0;l<r+e;l++)i.push(null);for(let n=0;n<l.length;n++)l[n]=[].concat(l[n].concat(o));for(let t=0;t<n;t++)l.push([].concat(i));return u&&(t.saveParam("all",c.currentSheetIndex,l.length,{k:"row"}),t.saveParam("all",c.currentSheetIndex,l[0].length,{k:"column"})),l},getcellFormula:function(l,n,t,e){let u;return null==(u=null!=e?e[l][n]:p(l,n,t))?null:u.f},getOrigincell:p,getRealCellValue:function(l,n){let t=m(l,n,null,"m");if(null==t&&null==(t=m(l,n))){let e=m(l,n,null,"ct");h(e)&&(t=e.s)}return t},getInlineStringNoStyle:function(l,n){let t=m(l,n,null,"ct");if(h(t)){let l=t.s,n="";for(let t=0;t<l.length;t++){let e=l[t];null!=e.v&&(n+=e.v)}return n}return""},getInlineStringStyle:function(l,n,t){let e=m(l,n,t,"ct");if(null==t&&(t=c.flowdata),t[l][n],h(e)){let l=e.s,n="";for(let t=0;t<l.length;t++){let e=l[t];null!=e.v&&(n+="<span index='"+t+"' style='"+b(e)+"'>"+e.v+"</span>")}return n}return""},getFontStyleByCell:b,checkstatusByCell:S,textTrim:function(l){return null==l||0==l.length?l:l.replace(/^\s+|\s+$/gm,"")}}});
//# sourceMappingURL=../sourcemaps/global/getdata.js.map
