/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./browser","./formula","./getdata","./refresh","../methods/get","../store"],function(e,t,l,o,a,n){"use strict";const{datagridgrowth:r}=l,{jfrefreshgrid:s,jfrefreshgridall:c,jfrefreshrange:u}=o,{getSheetIndex:d}=a;return{deepCopyFlowDataState:!1,deepCopyFlowDataCache:"",deepCopyFlowDataWorker:null,deepCopyFlowData:function(e){let t=this;return t.deepCopyFlowDataState?(null!=t.deepCopyFlowDataWorker&&t.deepCopyFlowDataWorker.terminate(),t.deepCopyFlowDataCache):(null==e&&(e=n.flowdata),$.extend(!0,[],e))},webWorkerFlowDataCache:function(t){let l=this;try{null!=l.deepCopyFlowDataWorker&&l.deepCopyFlowDataWorker.terminate();let o,a="data:text/javascript;chartset=US-ASCII,onmessage = function (e) { postMessage(e.data); };";if(l.deepCopyFlowDataState=!1,1==e.isIE()){let e="self.onmessage=function(e){postMessage(e.data);}";(o=new Worker("./plugins/Worker-helper.js")).postMessage(e)}else o=new Worker(a);l.deepCopyFlowDataWorker=o,o.postMessage(t),o.onmessage=function(e){l.deepCopyFlowDataCache=e.data,l.deepCopyFlowDataState=!0}}catch(e){l.deepCopyFlowDataCache=$.extend(!0,[],t)}},controlHandler:function(e,t){let l=this.deepCopyFlowData(n.flowdata),o=t||n.luckysheet_select_save[n.luckysheet_select_save.length-1],a=null==o.row?0:o.row[0],s=null==o.column?0:o.column[0],d=e.length,p=e[0].length,h=a+d-l.length,f=s+p-l[0].length;(h>0||f>0)&&(l=r([].concat(l),h,f,!0));for(let t=0;t<d;t++){let o=[].concat(l[t+a]);for(let l=0;l<p;l++){let a="";null!=e[t]&&null!=e[t][l]&&(a=e[t][l]),o[l+s]=a}l[t+a]=o}h>0||f>0?c(l[0].length,l.length,l,null,n.luckysheet_select_save,"datachangeAll"):u(l,n.luckysheet_select_save)},clearRangeByindex:function(e,l,o,a,r){let c=d(r),p=$.extend(!0,[],n.luckysheetfile[c].data);for(let n=e;n<=l;n++){let e=[].concat(p[n]);for(let l=o;l<=a;l++)t.delFunctionGroup(n,l),t.execFunctionGroup(n,l,""),e[l]=null;p[n]=e}if(r==n.currentSheetIndex){l-e+1>5e3?s(p,[{row:[e,l],column:[o,a]}]):u(p,{row:[e,l],column:[o,a]})}else n.luckysheetfile[c].data=p},controlHandlerD:function(e){let t=this.deepCopyFlowData(n.flowdata),l=n.luckysheet_select_save[n.luckysheet_select_save.length-1],o=l.row[0],a=l.row[1],c=l.column[0],u=l.column[1],d=e.length,p=e[0].length,h=o+d-t.length,f=c+p-t[0].length;(h>0||f>0)&&(t=r([].concat(t),h,f,!0));for(let e=o;e<=a;e++)for(let l=c;l<=u;l++)t[e][l]=null;for(let l=0;l<d;l++)for(let a=0;a<p;a++)t[o+l][c+a]=e[l][a];s(t,[{row:[o,a],column:[c,u]},{row:[o,o+d-1],column:[c,c+p-1]}])}}});
//# sourceMappingURL=../sourcemaps/global/editor.js.map
