/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../store"],function(e){"use strict";function t(e){return e!==document.body&&document.body.contains(e)}return{luckysheetRangeLast:function(e){let t;if(document.createRange)if(e.innerHTML!=e.innerText||""==e.innerHTML)e.focus(),(t=window.getSelection()).selectAllChildren(e),t.collapseToEnd();else{let n=e.innerText.length;(t=document.createRange()).selectNodeContents(e),t.setStart(e.childNodes[0],n),t.collapse(!0);let l=window.getSelection();l.removeAllRanges(),l.addRange(t)}else document.selection&&((t=document.body.createTextRange()).moveToElementText(e),t.collapse(!1),t.select())},getCursortPosition:function(e){let t=0;if(document.selection){e.focus();let n=document.selection.createRange();n.moveStart("character",-e.value.length),t=n.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t},hideMenuByCancel:function(t){t.target.classList.contains("luckysheet-cols-rows-shift-left")||t.target.classList.contains("luckysheet-cols-rows-shift-right")||$(t.target).hasClass("luckysheet-mousedown-cancel")||0!=$(t.target).filter("[class*='sp-palette']").length||0!=$(t.target).filter("[class*='sp-thumb']").length||0!=$(t.target).filter("[class*='sp-']").length||($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide(),e.luckysheet_cols_menu_status=!1)},selectTextContent:function(e){if(window.getSelection){let l=document.createRange();var n=e.firstChild;l.setStart(n,0),l.setEnd(n,n.length),l.startContainer&&t(l.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(l))}else if(document.selection){let t=document.body.createTextRange();t.moveToElementText(e),t.select()}},selectTextDom:function(e){if(window.getSelection){let n=document.createRange();n.selectNodeContents(e),n.startContainer&&t(n.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(n))}else if(document.selection){let t=document.body.createTextRange();t.moveToElementText(e),t.select()}},selectTextContentCross:function(e,n){if(window.getSelection){let s=document.createRange();var l=e.firstChild,o=n.firstChild;s.setStart(l,0),s.setEnd(o,o.length),s.startContainer&&t(s.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(s))}},selectTextContentCollapse:function(e,n){if(window.getSelection){let o=document.createRange();var l=e.firstChild;n>l.length?n=l.length:n<0&&(n=0),o.setStart(l,n),o.collapse(!0),o.startContainer&&t(o.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(o))}}}});
//# sourceMappingURL=../sourcemaps/global/cursorPos.js.map
