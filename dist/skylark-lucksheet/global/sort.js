/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../utils/util","./validate","./datecontroll","./tooltip","./editor","./getRowlen","./refresh","../controllers/protection","../store","../vendors/numeral"],function(e,l,t,n,o,r,u,i,c,f){"use strict";const{getObjType:a}=e,{isRealNull:s,isRealNum:v,isEditMode:d}=l,{isdatetime:h,diff:g}=t,{rowlenByRange:m}=r,{jfrefreshgrid:p}=u,{checkProtectionAuthorityNormal:w}=i;function b(e,l,t){null==t&&(t=!0);let n=function(e,t){let n=e[l],o=t[l];return"object"==a(e[l])&&(n=e[l].v),"object"==a(t[l])&&(o=t[l].v),s(n)?1:s(o)?-1:h(n)&&h(o)?g(n,o):v(n)&&v(o)?f(n).value()-f(o).value():v(n)||v(o)?v(n)?v(o)?void 0:-1:1:n.localeCompare(o,"zh")},o=function(e,t){let n=e[l],o=t[l];return"object"==a(e[l])&&(n=e[l].v),"object"==a(t[l])&&(o=t[l].v),s(n)?1:s(o)?-1:h(n)&&h(o)?g(o,n):v(n)&&v(o)?f(o).value()-f(n).value():v(n)||v(o)?v(n)?v(o)?void 0:1:-1:o.localeCompare(n,"zh")};return t?e.sort(n):e.sort(o)}return{orderbydata:b,orderbydata1D:function(e,l){null==l&&(l=!0);let t=function(e,l){let t=e,n=l;return"object"==a(e)&&(t=e.v),"object"==a(l)&&(n=l.v),null==t&&(t=""),null==n&&(n=""),h(t)&&h(n)?g(t,n):v(t)&&v(n)?f(t).value()-f(n).value():v(t)||v(n)?v(t)?v(n)?void 0:-1:1:t.localeCompare(n,"zh")},n=function(e,l){let t=e,n=l;return"object"==a(e)&&(t=e.v),"object"==a(l)&&(n=l.v),null==t&&(t=""),null==n&&(n=""),h(t)&&h(n)?g(n,t):v(t)&&v(n)?f(n).value()-f(t).value():v(t)||v(n)?v(t)?v(n)?void 0:1:-1:n.localeCompare(t,"zh")};return l?e.sort(t):e.sort(n)},sortSelection:function(e){if(!w(c.currentSheetIndex,"sort"))return;if(c.luckysheet_select_save.length>1)return void(d()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):n.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""));null==e&&(e=!0);let l,t,r=o.deepCopyFlowData(c.flowdata),u=c.luckysheet_select_save[0].row[0],i=c.luckysheet_select_save[0].row[1],f=c.luckysheet_select_save[0].column[0],a=c.luckysheet_select_save[0].column[1];for(let e=u;e<=i;e++)if(null!=r[e]&&null!=r[e][f]){let n=r[e][f];if(null!=n.mc||s(n.v))continue;if(null==l&&/[\u4e00-\u9fa5]+/g.test(n.v)){l=e+1,t=e+1;continue}null==l&&(l=e),t=e}if(null==l||l>i)return;let v=!1,h=[];for(let e=l;e<=t;e++){let l=[];for(let t=f;t<=a;t++){if(null!=r[e][t]&&null!=r[e][t].mc){v=!0;break}l.push(r[e][t])}h.push(l)}if(v)return void(d()?alert("选区有合并单元格，无法执行此操作！"):n.info("选区有合并单元格，无法执行此操作！",""));h=b(h,0,e);for(let e=l;e<=t;e++)for(let t=f;t<=a;t++)r[e][t]=h[e-l][t-f];let g={};if(null!=c.config.rowlen){let e=$.extend(!0,{},c.config);g={cfg:e=m(r,l,t,e),RowlChange:!0}}p(r,[{row:[l,t],column:[f,a]}],g)},sortColumnSeletion:function(e,l){if(!w(c.currentSheetIndex,"sort"))return;null==l&&(l=!0);let t,r,u=o.deepCopyFlowData(c.flowdata),i=u.length-1,f=u[0].length-1;for(let l=0;l<=i;l++)null!=u[l][e]&&null!=u[l][e].mc||(null==u[l][e]||s(u[l][e].v)||!/[\u4e00-\u9fa5]+/g.test(u[l][e].v)||null!=t?(null==t&&(t=l),null==u[l][e]||s(u[l][e].v)||(r=l)):(t=l+1,r=l+1));if(null==t||t>i)return;let a=!1,v=[];for(let e=t;e<=r;e++){let l=[];for(let t=0;t<=f;t++){if(null!=u[e][t]&&null!=u[e][t].mc){a=!0;break}l.push(u[e][t])}v.push(l)}if(a)return void(d()?alert("列排序会扩展至整个表格选区，选区有合并单元格，无法执行此操作，请选择功能栏排序功能！"):n.info("列排序会扩展至整个表格选区，选区有合并单元格，无法执行此操作，请选择功能栏排序功能！",""));v=b(v,e,l);for(let e=t;e<=r;e++)for(let l=0;l<=f;l++)u[e][l]=v[e-t][l-0];let h={};if(null!=c.config.rowlen){let e=$.extend(!0,{},c.config);h={cfg:e=m(u,t,r,e),RowlChange:!0}}p(u,[{row:[t,r],column:[0,f]}],h)}}});
//# sourceMappingURL=../sourcemaps/global/sort.js.map
