/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../controllers/server","../controllers/constant","../controllers/sheetmanage","./formula","../controllers/imageCtrl","../controllers/dataVerificationCtrl","../controllers/pivotTable","../controllers/freezen","../methods/get","./extend","../controllers/luckysheetConfigsetting","./editor","./createsheet","../store"],function(e,t,l,n,a,u,o,c,r,i,s,h,d,y){"use strict";const{luckysheetlodingHTML:f,luckyColor:k}=t,{getSheetIndex:g}=r,{luckysheetextendData:_}=i,m={container:null,luckysheetfile:null,defaultcolumnNum:60,defaultrowNum:84,fullscreenmode:!0,devicePixelRatio:1,currentSheetIndex:0,calculateSheetIndex:0,flowdata:[],config:{},visibledatarow:[],visibledatacolumn:[],ch_width:0,rh_height:0,cellmainWidth:0,cellmainHeight:0,toolbarHeight:0,infobarHeight:0,calculatebarHeight:0,rowHeaderWidth:46,columnHeaderHeight:20,cellMainSrollBarSize:12,sheetBarHeight:31,statisticBarHeight:23,luckysheetTableContentHW:[0,0],defaultcollen:73,defaultrowlen:19,jfcountfuncTimeout:null,jfautoscrollTimeout:null,luckysheet_select_status:!1,luckysheet_select_save:[{row:[0,0],column:[0,0]}],luckysheet_selection_range:[],luckysheet_copy_save:{},luckysheet_paste_iscut:!1,filterchage:!0,luckysheet_filter_save:{row:[],column:[]},luckysheet_sheet_move_status:!1,luckysheet_sheet_move_data:[],luckysheet_scroll_status:!1,luckysheetisrefreshdetail:!0,luckysheetisrefreshtheme:!0,luckysheetcurrentisPivotTable:!1,luckysheet_rows_selected_status:!1,luckysheet_cols_selected_status:!1,luckysheet_rows_change_size:!1,luckysheet_rows_change_size_start:[],luckysheet_cols_change_size:!1,luckysheet_cols_change_size_start:[],luckysheet_cols_dbclick_timeout:null,luckysheet_cols_dbclick_times:0,luckysheetCellUpdate:[],luckysheet_shiftpositon:null,iscopyself:!0,orderbyindex:0,luckysheet_model_move_state:!1,luckysheet_model_xy:[0,0],luckysheet_model_move_obj:null,luckysheet_cell_selected_move:!1,luckysheet_cell_selected_move_index:[],luckysheet_cell_selected_extend:!1,luckysheet_cell_selected_extend_index:[],luckysheet_cell_selected_extend_time:null,clearjfundo:!0,jfredo:[],jfundo:[],lang:"en",createChart:"",highlightChart:"",zIndex:15,chartparam:{luckysheetCurrentChart:null,luckysheetCurrentChartActive:!1,luckysheetCurrentChartMove:null,luckysheetCurrentChartMoveTimeout:null,luckysheetCurrentChartMoveObj:null,luckysheetCurrentChartMoveXy:null,luckysheetCurrentChartMoveWinH:null,luckysheetCurrentChartMoveWinW:null,luckysheetCurrentChartResize:null,luckysheetCurrentChartResizeObj:null,luckysheetCurrentChartResizeXy:null,luckysheetCurrentChartResizeWinH:null,luckysheetCurrentChartResizeWinW:null,luckysheetInsertChartTosheetChange:!0,luckysheetCurrentChartZIndexRank:100,luckysheet_chart_redo_click:!1,luckysheetCurrentChartMaxState:!1,jfrefreshchartall:"",changeChartCellData:"",renderChart:"",getChartJson:""},functionList:null,luckysheet_function:null,chart_selection:{},currentChart:"",scrollRefreshSwitch:!0,measureTextCache:{},measureTextCellInfoCache:{},measureTextCacheTimeOut:null,cellOverflowMapCache:{},zoomRatio:1,visibledatacolumn_unique:null,visibledatarow_unique:null,showGridLines:!0,toobarObject:{},inlineStringEditCache:null,inlineStringEditRange:null,fontList:[],currentSheetView:"viewNormal"},x={searchFunctionCell:null,functionlistPosition:{},rangechangeindex:null,rangestart:!1,rangetosheet:null,rangeSetValueTo:null,func_selectedrange:{},rangedrag_column_start:!1,rangedrag_row_start:!1,rangeResizeObj:null,rangeResize:null,rangeResizeIndex:null,rangeResizexy:null,rangeResizeWinH:null,rangeResizeWinW:null,rangeResizeTo:null,rangeMovexy:null,rangeMove:!1,rangeMoveObj:null,rangeMoveIndex:null,rangeMoveRangedata:null,functionHTMLIndex:0,functionRangeIndex:null,execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},cellTextToIndexList:{},isFunctionRangeSave:!1,execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},formulaContainCellList:{},cellTextToIndexList:{},execFunctionGlobalData:{},groupValuesRefreshData:[],functionResizeData:{},functionResizeStatus:!1,functionResizeTimeout:null,data_parm_index:0},C={sheetMaxIndex:0,nulldata:null,mergeCalculationSheet:{},checkLoadSheetIndexToDataIndex:{},CacheNotLoadControll:[]},v={pivotDatas:null,pivotSheetIndex:0,pivotDataSheetIndex:0,celldata:null,origindata:null,pivot_data_type:{},pivot_select_save:null,column:null,row:null,values:null,filter:null,showType:null,rowhidden:null,selected:null,caljs:null,initial:!0,filterparm:null,luckysheet_pivotTable_select_state:!1,jgridCurrentPivotInput:null,movestate:!1,moveitemposition:[],movesave:{},drawPivotTable:!0,pivotTableBoundary:[12,6]},p={imgItem:{type:"3",src:"",originWidth:null,originHeight:null,default:{width:null,height:null,left:null,top:null},crop:{width:null,height:null,offsetLeft:0,offsetTop:0},isFixedPos:!1,fixedLeft:null,fixedTop:null,border:{width:0,radius:0,style:"solid",color:"#000"}},images:null,currentImgId:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,cropChange:null,cropChangeXY:null,cropChangeObj:null,copyImgItemObj:null},w={defaultItem:{type:"dropdown",type2:null,value1:"",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},curItem:null,dataVerification:null,selectRange:[],selectStatus:!1};return{addDataAjax:function(t,l,n,a){null==l&&(l=y.currentSheetIndex),null==n&&(n=e.loadSheetUrl),$("#luckysheet-grid-window-1").append(f()),t.currentPage++;let u=sessionStorage.getItem("x-auth-token");$.ajax({method:"POST",url:n,headers:{"x-auth-token":u},data:JSON.stringify(t),contentType:"application/json;charset=UTF-8",success:function(e){"string"==typeof e&&(e=JSON.parse(e));let t=e.data,l=t.celldata;_(t.row,l),setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500),a&&"function"==typeof a&&a(t)}})},reload:function(t,n,a,u){null==n&&(n=y.currentSheetIndex),null==a&&(a=e.loadSheetUrl),$("#luckysheet-grid-window-1").append(f());let o={gridKey:e.gridKey,index:n};t=$.extend(!0,t,o);let c=y.luckysheetfile[g(n)];$.post(a,t,function(t){let a=new Function("return "+t)();c.celldata=a[n.toString()];let o=l.buildGridData(c);setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500),c.data=o,y.flowdata=o,h.webWorkerFlowDataCache(o),d(o[0].length,o.length,o,null,!1),c.load="1",y.luckysheet_select_save.length=0,y.luckysheet_selection_range=[],e.saveParam("shs",null,y.currentSheetIndex),l.changeSheet(n),u&&"function"==typeof u&&u()})},clearSheetByIndex:function(e){let t=g(e),l=y.luckysheetfile[t];l.isPivotTable?delete y.luckysheetfile[t]:(l.data=[],l.row=y.defaultrowNum,l.column=y.defaultcolumnNum,l.chart=[],l.config=null,l.filter=null,l.filter_select=null,l.celldata=[],l.pivotTable={},l.calcChain=[],l.status=0,l.load=0,y.flowdata=[],h.webWorkerFlowDataCache(y.flowdata),$("#"+y.container+" .luckysheet-data-visualization-chart").remove(),$("#"+y.container+" .luckysheet-datavisual-selection-set").remove(),$("#luckysheet-row-count-show, #luckysheet-formula-functionrange-select, #luckysheet-row-count-show, #luckysheet-column-count-show, #luckysheet-change-size-line, #luckysheet-cell-selected-focus, #luckysheet-selection-copy, #luckysheet-cell-selected-extend, #luckysheet-cell-selected-move, #luckysheet-cell-selected").hide(),delete l.load)},clear:function(e){let t=this;if("all"==e)for(let e=0;e<y.luckysheetfile.length;e++){let l=y.luckysheetfile[e];t.clearSheetByIndex(l.index)}else null==e&&(e=y.currentSheetIndex),t.clearSheetByIndex(e);l.changeSheet(y.luckysheetfile[0].index)},destroy:function(){$("#"+y.container).empty(),$("body > .luckysheet-cols-menu").remove(),$("#luckysheet-modal-dialog-mask, #luckysheetTextSizeTest, #luckysheet-icon-morebtn-div").remove(),$("#luckysheet-input-box").parent().remove(),$("#luckysheet-formula-help-c").remove(),$(".chartSetting, .luckysheet-modal-dialog-slider").remove(),$(document).off(".luckysheetEvent"),$(document).off(".luckysheetProtection"),c.initialHorizontal=!0,c.initialVertical=!0;let e=$.extend(!0,{},m);for(let t in e)t in y&&(y[t]=e[t]);let t=$.extend(!0,{},x);for(let e in t)e in n&&(n[e]=t[e]);let r=$.extend(!0,{},C);for(let e in r)e in l&&(l[e]=r[e]);let i=$.extend(!0,{},v);for(let e in i)e in o&&(o[e]=i[e]);let s=$.extend(!0,{},p);for(let e in s)e in a&&(a[e]=s[e]);let h=$.extend(!0,{},w);for(let e in h)e in u&&(u[e]=h[e]);y.asyncLoad=["core"]},editorChart:function(e){let t=k[0],l="luckysheetEditMode-datav-chart";e.chart_id=l;let n=e.chartTheme;n=null==n?"default0000":n,luckysheet.insertChartTosheet(e.sheetIndex,e.dataSheetIndex,e.option,e.chartType,e.selfOption,e.defaultOption,e.row,e.column,t,l,"luckysheetEditMode-datav-chart_selection",e.chartStyle,e.rangeConfigCheck,e.rangeRowCheck,e.rangeColCheck,e.chartMarkConfig,e.chartTitleConfig,e.winWidth,e.winHeight,e.scrollLeft,e.scrollTop,n,e.myWidth,e.myHeight,null!=e.myLeft?parseFloat(e.myLeft):null,null!=e.myTop?parseFloat(e.myTop):null,e.myindexrank,!0),$("#"+l).find(".luckysheet-modal-controll-update").click()},createHookFunction:function(){let e=arguments[0];if(s.hook&&null!=s.hook[e]&&"function"==typeof s.hook[e]){var t=Array.prototype.slice.apply(arguments);return t.shift(),!1!==s.hook[e].apply(this,t)}return!0}}});
//# sourceMappingURL=../sourcemaps/global/method.js.map
