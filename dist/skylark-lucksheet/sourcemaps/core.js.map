{"version":3,"sources":["core.js"],"names":["define","defaultSetting","m_util","Store","server","luckysheetConfigsetting","sheetmanage","luckysheetsizeauto","luckysheetHandler","m_filter","m_matrixOperation","m_sheetBar","m_formulaBar","m_rowColumnOperation","m_keyboard","m_orderBy","m_expendPlugins","m_get","m_set","m_refresh","functionlist","m_constant","m_getdata","m_setdata","m_select","m_zoom","m_print","method","api","flatpickr","m_listener","common_extend","initialFilterHandler","initialMatrixOperation","initialSheetBar","formulaBarInitial","rowColumnOperationInitial","keyboardInitial","orderByInitial","initPlugins","getluckysheetfile","getluckysheet_select_save","getconfig","setluckysheet_select_save","luckysheetrefreshgrid","jfrefreshgrid","luckysheetlodingHTML","getcellvalue","getdatabyselection","setcellvalue","selectHightlightShow","zoomInitial","printInitial","initListener","luckysheet","initialWorkBook","create","setting","destroy","toJsonOptions","c","extendsetting","loadurl","loadUrl","menu","title","container","luckysheetfile","data","defaultcolumnNum","column","defaultrowNum","row","fullscreenmode","lang","allowEdit","limitSheetNameLength","defaultSheetNameMaxLength","fontList","gridKey","updateUrl","updateImageUrl","loadSheetUrl","allowUpdate","autoFormatw","accuracy","total","allowCopy","showtoolbar","showtoolbarConfig","showinfobar","showsheetbar","showsheetbarConfig","showstatisticBar","showstatisticBarConfig","sheetFormulaBar","cellRightClickConfig","sheetRightClickConfig","pointEdit","pointEditUpdate","pointEditZoom","userInfo","userMenuItem","myFolderUrl","functionButton","showConfigWindowResize","enableAddRow","enableAddBackTop","enablePage","pageInfo","editMode","beforeCreateDom","workbookCreateBefore","workbookCreateAfter","fireMousedown","forceCalculation","plugins","rowHeaderWidth","columnHeaderHeight","defaultColWidth","defaultRowHeight","hook","pager","initShowsheetbarConfig","asyncLoad","push","devicePixelRatio","Math","ceil","$","append","initialjfFile","post","d","Function","openWebSocket","getGridData","buildGridData","flowdata"],"mappings":"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","file":"../core.js","sourcesContent":["define([\n    './config',\n    './utils/util',\n    './store',\n    './controllers/server',\n    './methods/luckysheetConfigsetting',\n    './controllers/sheetmanage',\n    './widgets/resize',\n    './controllers/handler',\n    './controllers/filter',\n    './controllers/matrixOperation',\n    './controllers/sheetBar',\n    './controllers/formulaBar',\n    './controllers/rowColumnOperation',\n    './controllers/keyboard',\n    './controllers/orderBy',\n    './controllers/expendPlugins',\n    './methods/get',\n    './methods/set',\n    './controllers/refresh',\n    './function/functionlist',\n    './widgets/constant',\n    './methods/getdata',\n    './methods/setdata',\n    './widgets/select',\n    './controllers/zoom',\n    './controllers/print',\n    './widgets/method',\n    './global/api',\n    './vendors/flatpickr',\n///    'flatpickr/dist/l10n/zh.js',\n    './controllers/listener'\n], function (defaultSetting, m_util, Store, server, luckysheetConfigsetting, sheetmanage, luckysheetsizeauto, luckysheetHandler, m_filter, m_matrixOperation, m_sheetBar, m_formulaBar, m_rowColumnOperation, m_keyboard, m_orderBy, m_expendPlugins, m_get, m_set, m_refresh, functionlist, m_constant, m_getdata, m_setdata, m_select, m_zoom, m_print, method, api, flatpickr,/* Mandarin,*/ m_listener) {\n    'use strict';\n    const {common_extend} = m_util;\n    const {initialFilterHandler} = m_filter;\n    const {initialMatrixOperation} = m_matrixOperation;\n    const {initialSheetBar} = m_sheetBar;\n    const {formulaBarInitial} = m_formulaBar;\n    const {rowColumnOperationInitial} = m_rowColumnOperation;\n    const {keyboardInitial} = m_keyboard;\n    const {orderByInitial} = m_orderBy;\n    const {initPlugins} = m_expendPlugins;\n    const {getluckysheetfile, getluckysheet_select_save, getconfig} = m_get;\n    const {setluckysheet_select_save} = m_set;\n    const {luckysheetrefreshgrid, jfrefreshgrid} = m_refresh;\n    const {luckysheetlodingHTML} = m_constant;\n    const {getcellvalue, getdatabyselection} = m_getdata;\n    const {setcellvalue} = m_setdata;\n    const {selectHightlightShow} = m_select;\n    const {zoomInitial} = m_zoom;\n    const {printInitial} = m_print;\n    const {initListener} = m_listener;\n    let luckysheet = {};    // mount api\n                            // luckysheet.api = api;\n                            // Object.assign(luckysheet, api);\n    // mount api\n    // luckysheet.api = api;\n    // Object.assign(luckysheet, api);\n    luckysheet = common_extend(api, luckysheet);    //创建luckysheet表格\n    //创建luckysheet表格\n    luckysheet.create = function (setting) {\n        method.destroy();    // Store original parameters for api: toJson\n        // Store original parameters for api: toJson\n        Store.toJsonOptions = {};\n        for (let c in setting) {\n            if (c !== 'data') {\n                Store.toJsonOptions[c] = setting[c];\n            }\n        }\n        let extendsetting = common_extend(defaultSetting, setting);\n        let loadurl = extendsetting.loadUrl, menu = extendsetting.menu, title = extendsetting.title;\n        let container = extendsetting.container;\n        Store.container = container;\n        Store.luckysheetfile = extendsetting.data;\n        Store.defaultcolumnNum = extendsetting.column;\n        Store.defaultrowNum = extendsetting.row;\n        Store.fullscreenmode = extendsetting.fullscreenmode;\n        Store.lang = extendsetting.lang;    //language\n        //language\n        Store.allowEdit = extendsetting.allowEdit;\n        Store.limitSheetNameLength = extendsetting.limitSheetNameLength;\n        Store.defaultSheetNameMaxLength = extendsetting.defaultSheetNameMaxLength;\n        Store.fontList = extendsetting.fontList;\n        Store.gridKey = extendsetting.gridKey;\n        Store.loadUrl = extendsetting.loadUrl;\n        Store.updateUrl = extendsetting.updateUrl;\n        Store.updateImageUrl = extendsetting.updateImageUrl;\n        Store.title = extendsetting.title;\n        Store.loadSheetUrl = extendsetting.loadSheetUrl;\n        Store.allowUpdate = extendsetting.allowUpdate;\n        luckysheetConfigsetting.autoFormatw = extendsetting.autoFormatw;\n        luckysheetConfigsetting.accuracy = extendsetting.accuracy;\n        luckysheetConfigsetting.total = extendsetting.data[0].total;\n        luckysheetConfigsetting.allowCopy = extendsetting.allowCopy;\n        luckysheetConfigsetting.showtoolbar = extendsetting.showtoolbar;\n        luckysheetConfigsetting.showtoolbarConfig = extendsetting.showtoolbarConfig;\n        luckysheetConfigsetting.showinfobar = extendsetting.showinfobar;\n        luckysheetConfigsetting.showsheetbar = extendsetting.showsheetbar;\n        luckysheetConfigsetting.showsheetbarConfig = extendsetting.showsheetbarConfig;\n        luckysheetConfigsetting.showstatisticBar = extendsetting.showstatisticBar;\n        luckysheetConfigsetting.showstatisticBarConfig = extendsetting.showstatisticBarConfig;\n        luckysheetConfigsetting.sheetFormulaBar = extendsetting.sheetFormulaBar;\n        luckysheetConfigsetting.cellRightClickConfig = extendsetting.cellRightClickConfig;\n        luckysheetConfigsetting.sheetRightClickConfig = extendsetting.sheetRightClickConfig;\n        luckysheetConfigsetting.pointEdit = extendsetting.pointEdit;\n        luckysheetConfigsetting.pointEditUpdate = extendsetting.pointEditUpdate;\n        luckysheetConfigsetting.pointEditZoom = extendsetting.pointEditZoom;\n        luckysheetConfigsetting.userInfo = extendsetting.userInfo;\n        luckysheetConfigsetting.userMenuItem = extendsetting.userMenuItem;\n        luckysheetConfigsetting.myFolderUrl = extendsetting.myFolderUrl;\n        luckysheetConfigsetting.functionButton = extendsetting.functionButton;\n        luckysheetConfigsetting.showConfigWindowResize = extendsetting.showConfigWindowResize;\n        luckysheetConfigsetting.enableAddRow = extendsetting.enableAddRow;\n        luckysheetConfigsetting.enableAddBackTop = extendsetting.enableAddBackTop;\n        luckysheetConfigsetting.enablePage = extendsetting.enablePage;\n        luckysheetConfigsetting.pageInfo = extendsetting.pageInfo;\n        luckysheetConfigsetting.editMode = extendsetting.editMode;\n        luckysheetConfigsetting.beforeCreateDom = extendsetting.beforeCreateDom;\n        luckysheetConfigsetting.workbookCreateBefore = extendsetting.workbookCreateBefore;\n        luckysheetConfigsetting.workbookCreateAfter = extendsetting.workbookCreateAfter;\n        luckysheetConfigsetting.fireMousedown = extendsetting.fireMousedown;\n        luckysheetConfigsetting.forceCalculation = extendsetting.forceCalculation;\n        luckysheetConfigsetting.plugins = extendsetting.plugins;\n        luckysheetConfigsetting.rowHeaderWidth = extendsetting.rowHeaderWidth;\n        luckysheetConfigsetting.columnHeaderHeight = extendsetting.columnHeaderHeight;\n        luckysheetConfigsetting.defaultColWidth = extendsetting.defaultColWidth;\n        luckysheetConfigsetting.defaultRowHeight = extendsetting.defaultRowHeight;\n        luckysheetConfigsetting.title = extendsetting.title;\n        luckysheetConfigsetting.container = extendsetting.container;\n        luckysheetConfigsetting.hook = extendsetting.hook;\n        luckysheetConfigsetting.pager = extendsetting.pager;\n        luckysheetConfigsetting.initShowsheetbarConfig = false;\n        ///if (Store.lang === 'zh') //TODO: lwf\n        ///    flatpickr.localize(Mandarin.zh);\n        // Store the currently used plugins for monitoring asynchronous loading\n        Store.asyncLoad.push(...luckysheetConfigsetting.plugins);    // Register plugins\n        // Register plugins\n        initPlugins(extendsetting.plugins, extendsetting.data);    // Store formula information, including internationalization\n        // Store formula information, including internationalization\n        functionlist();\n        let devicePixelRatio = extendsetting.devicePixelRatio;\n        if (devicePixelRatio == null) {\n            devicePixelRatio = 1;\n        }\n        Store.devicePixelRatio = Math.ceil(devicePixelRatio);    //loading\n        //loading\n        $('#' + container).append(luckysheetlodingHTML());\n        if (loadurl == '') {\n            sheetmanage.initialjfFile(menu, title);    // luckysheetsizeauto();\n            // luckysheetsizeauto();\n            initialWorkBook();\n        } else {\n            $.post(loadurl, { 'gridKey': server.gridKey }, function (d) {\n                let data = new Function('return ' + d)();\n                Store.luckysheetfile = data;\n                sheetmanage.initialjfFile(menu, title);    // luckysheetsizeauto();\n                // luckysheetsizeauto();\n                initialWorkBook();    //需要更新数据给后台时，建立WebSocket连接\n                //需要更新数据给后台时，建立WebSocket连接\n                if (server.allowUpdate) {\n                    server.openWebSocket();\n                }\n            });\n        }\n    };\n    function initialWorkBook() {\n        luckysheetHandler();    //Overall dom initialization\n        //Overall dom initialization\n        initialFilterHandler();    //Filter initialization\n        //Filter initialization\n        initialMatrixOperation();    //Right click matrix initialization\n        //Right click matrix initialization\n        initialSheetBar();    //bottom sheet bar initialization\n        //bottom sheet bar initialization\n        formulaBarInitial();    //top formula bar initialization\n        //top formula bar initialization\n        rowColumnOperationInitial();    //row and coloumn operate initialization\n        //row and coloumn operate initialization\n        keyboardInitial();    //Keyboard operate initialization\n        //Keyboard operate initialization\n        orderByInitial();    //menu bar orderby function initialization\n        //menu bar orderby function initialization\n        zoomInitial();    //zoom method initialization\n        //zoom method initialization\n        printInitial();    //print initialization\n        //print initialization\n        initListener();\n    } \n    //获取所有表格数据\n    luckysheet.getluckysheetfile = getluckysheetfile;  \n    //获取当前表格 选区\n    luckysheet.getluckysheet_select_save = getluckysheet_select_save;  \n    //设置当前表格 选区\n    luckysheet.setluckysheet_select_save = setluckysheet_select_save;   \n    //获取当前表格 config配置\n    luckysheet.getconfig = getconfig;   \n    //二维数组数据 转化成 {r, c, v}格式 一维数组 (传入参数为二维数据data)\n    luckysheet.getGridData = sheetmanage.getGridData;  \n    //生成表格所需二维数组 （传入参数为表格数据对象file）\n    luckysheet.buildGridData = sheetmanage.buildGridData;    \n     // Refresh the canvas display data according to scrollHeight and scrollWidth\n    luckysheet.luckysheetrefreshgrid = luckysheetrefreshgrid;    // Refresh canvas\n    // Refresh canvas\n    luckysheet.jfrefreshgrid = jfrefreshgrid;    // Get the value of the cell\n    // Get the value of the cell\n    luckysheet.getcellvalue = getcellvalue;    // Set cell value\n    // Set cell value\n    luckysheet.setcellvalue = setcellvalue;    // Get selection range value\n    // Get selection range value\n    luckysheet.getdatabyselection = getdatabyselection;\n    luckysheet.sheetmanage = sheetmanage;    // Data of the current table\n    // Data of the current table\n    luckysheet.flowdata = function () {\n        return Store.flowdata;\n    };    // Set selection highlight\n    // Set selection highlight\n    luckysheet.selectHightlightShow = selectHightlightShow;    // Reset parameters after destroying the table\n    // Reset parameters after destroying the table\n    luckysheet.destroy = method.destroy;\n    return { luckysheet };\n});"]}