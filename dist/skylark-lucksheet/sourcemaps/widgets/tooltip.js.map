{"version":3,"sources":["widgets/tooltip.js"],"names":["define","m_constant","browser","m_util","locale","modelHTML","luckysheetchartpointconfigHTML","luckysheetToolHTML","replaceHtml","info","title","content","$","show","remove","locale_button","button","append","id","addclass","botton","close","style","$t","find","css","end","myh","outerHeight","myw","outerWidth","winw","window","width","winh","height","scrollLeft","document","scrollTop","left","top","confirm","func1","func2","name1","name2","cancel","click","hide","screenshot","imgurl","locale_screenshot","downLoadBtn","downLoadCopy","downLoadClose","isIE","alert","browserNotTip","ActiveXObject","length","appendTo","attr","src","frames","execCommand","dt","clipboard","DT","setData","rightclickTip","write","successTip","chartPointConfig","savefunc1","closefunc2","sheetConfig","hoverTipshowState","hoverTipshowTimeOut","createHoverTip","obj","to","_this","this","on","e","clearTimeout","setTimeout","currentTarget","toffset","offset","$toolup","tips","data","prev","removeClass","html","toolwidth","toolleft","addClass","popover","position","btntxt","exitsFuc","_locale","locale_paint","paint","htmldiv","start","w","h","pcss","right","bottom","background","color","border","margin-left","fadeIn","fadeOut"],"mappings":";;;;;;;AAAAA,QACI,sBACA,mBACA,gBACA,oBACD,SAAUC,EAAYC,EAASC,EAAQC,GACtC,aACA,MAAMC,UAACA,EAASC,+BAAEA,EAA8BC,mBAAEA,GAAsBN,GAClEO,YAACA,GAAeL,EAgRtB,OA9QIM,KAAM,SAAUC,EAAOC,GACnBC,EAAE,iCAAiCC,OACnCD,EAAE,oBAAoBE,SACtB,IACIC,EADUX,IACcY,OAC5BJ,EAAE,QAAQK,OAAOT,EAAYH,GACzBa,GAAM,kBACNC,SAAY,GACZT,MAASA,EACTC,QAAWA,EACXS,OAAU,0EAA4EL,EAAcM,MAAQ,wBAC5GC,MAAS,oBAEb,IAAIC,EAAKX,EAAE,oBAAoBY,KAAK,oCAAoCC,IAAI,YAAa,KAAKC,MAAOC,EAAMJ,EAAGK,cAAeC,EAAMN,EAAGO,aAClIC,EAAOnB,EAAEoB,QAAQC,QAASC,EAAOtB,EAAEoB,QAAQG,SAC3CC,EAAaxB,EAAEyB,UAAUD,aAAcE,EAAY1B,EAAEyB,UAAUC,YACnE1B,EAAE,oBAAoBa,KAClBc,MAASR,EAAOK,EAAaP,GAAO,EACpCW,KAAQN,EAAOI,EAAYX,GAAO,IACnCd,QAEP4B,QAAS,SAAU/B,EAAOC,EAAS+B,EAAOC,EAAOC,EAAOC,GACpDjC,EAAE,iCAAiCC,OACnCD,EAAE,uBAAuBE,SACzB,MACMC,EADUX,IACcY,OACjB,MAAT4B,IACAA,EAAQ7B,EAAc0B,SAEb,MAATI,IACAA,EAAQ9B,EAAc+B,QAE1BlC,EAAE,QAAQK,OAAOT,EAAYH,GACzBa,GAAM,qBACNC,SAAY,GACZG,MAAS,iBACTZ,MAASA,EACTC,QAAWA,EACXS,OAAU,4EAA8EwB,EAAQ,gGAAkGC,EAAQ,2BAE9M,IAAItB,EAAKX,EAAE,uBAAuBY,KAAK,oCAAoCC,IAAI,YAAa,KAAKC,MAAOC,EAAMJ,EAAGK,cAAeC,EAAMN,EAAGO,aACrIC,EAAOnB,EAAEoB,QAAQC,QAASC,EAAOtB,EAAEoB,QAAQG,SAC3CC,EAAaxB,EAAEyB,UAAUD,aAAcE,EAAY1B,EAAEyB,UAAUC,YACnE1B,EAAE,uBAAuBa,KACrBc,MAASR,EAAOK,EAAaP,GAAO,EACpCW,KAAQN,EAAOI,EAAYX,GAAO,IACnCd,OACHU,EAAGC,KAAK,iCAAiCuB,MAAM,WACvB,mBAATL,GACPA,IAGJ9B,EAAE,uBAAuBoC,OACzBpC,EAAE,iCAAiCoC,SAEvCzB,EAAGC,KAAK,gCAAgCuB,MAAM,WACtB,mBAATJ,GACPA,IAEJ/B,EAAE,uBAAuBoC,OACzBpC,EAAE,iCAAiCoC,UAG3CC,WAAY,SAAUvC,EAAOC,EAASuC,GAClC,MACMC,EADU/C,IACkB6C,WAClCrC,EAAE,iCAAiCC,OACnCD,EAAE,uBAAuBE,SACzBF,EAAE,QAAQK,OAAOT,EAAYH,GACzBa,GAAM,qBACNC,SAAY,GACZG,MAAS,iBACTZ,MAASA,EACTC,QAAWA,EACXS,OAAU,yHAA2H+B,EAAkBC,YAAc,qGAAuGD,EAAkBE,aAAe,gGAAkGF,EAAkBG,cAAgB,2BAErb,IAAI/B,EAAKX,EAAE,uBAAuBY,KAAK,oCAAoCC,IAAI,YAAa,KAAKC,MAAOC,EAAMJ,EAAGK,cAAeC,EAAMN,EAAGO,aACrIC,EAAOnB,EAAEoB,QAAQC,QAASC,EAAOtB,EAAEoB,QAAQG,SAC3CC,EAAaxB,EAAEyB,UAAUD,aAAcE,EAAY1B,EAAEyB,UAAUC,YACnE1B,EAAE,uBAAuBa,KACrBc,MAASR,EAAOK,EAAaP,GAAO,EACpCW,KAAQN,EAAOI,EAAYX,GAAO,IACnCd,OACHU,EAAGC,KAAK,iCAAiCuB,MAAM,WACrB,KAAlB7C,EAAQqD,OACRC,MAAML,EAAkBM,gBAElBzB,OAAO0B,eAAiB,kBAAmB1B,UACR,IAAjCpB,EAAE,oBAAoB+C,QACtB/C,EAAE,sJAAsJgD,SAAS,QAEjKhD,EAAE,oBAAoBiD,KAAK,QAAUX,EACrCtC,EAAE,oBAAoBiD,KAAK,MAAOX,GAED,eAA7BtC,EAAE,oBAAoBkD,KACtB9B,OAAO+B,OAAwB,gBAAE1B,SAAS2B,YAAY,aAM1EzC,EAAGC,KAAK,gCAAgCuB,MAAM,WAC1CnC,EAAE,uBAAuBoC,OACzBpC,EAAE,iCAAiCoC,SAEvCpC,EAAE,kDAAkDmC,MAAM,WACtD,IAAIkB,EAAK,IAAIC,UAAUC,GACvBF,EAAGG,QAAQ,YAAa,aAAelB,EAAS,MAC1B,KAAlBhD,EAAQqD,OACRC,MAAML,EAAkBkB,gBAExBH,UAAUI,MAAML,GAChBT,MAAML,EAAkBoB,gBAIpCC,iBAAkB,SAAUtD,EAAIuD,EAAWC,GACvC9D,EAAE,QAAQK,OAAOT,EAAYH,GACzBa,GAAMA,EACNC,SAAY,kCACZT,MAAS,UACTC,QAAWL,EACXc,OAAU,+LACVE,MAAS,2DAEbV,EAAE,iCAAiCC,OACnC,IAAIkB,EAAOnB,EAAEoB,QAAQC,QAASC,EAAOtB,EAAEoB,QAAQG,SAC/CvB,EAAE,IAAMM,GAAIM,KAAK,kCAAkCC,IAAI,SAAUS,EAAO,KACxEtB,EAAE,IAAMM,GAAIO,KACRU,OAAUD,EAAO,GACjBD,MAASF,EAAO,IAChBQ,KAAQ,EACRC,IAAO,KACR3B,OAAOW,KAAK,8BAA8BuB,MAAM,WACvB,mBAAb0B,GACPA,IAEJ7D,EAAE,IAAMM,GAAI8B,OACZpC,EAAE,iCAAiCoC,SAEvCpC,EAAE,IAAMM,GAAIM,KAAK,8BAA8BuB,MAAM,WACxB,mBAAd2B,GACPA,IAEJ9D,EAAE,IAAMM,GAAI8B,OACZpC,EAAE,iCAAiCoC,UAG3C2B,YAAa,aAEbC,mBAAmB,EACnBC,oBAAqB,KACrBC,eAAgB,SAAUC,EAAKC,GAC3B,IAAIC,EAAQC,KACZtE,EAAEmE,GAAKI,GAAG,YAAaH,EAAI,SAAUI,GAC7BH,EAAML,oBAGVS,aAAaJ,EAAMJ,qBACnBI,EAAMJ,oBAAsBS,WAAW,WACnC,IAAI/D,EAAKX,EAAEwE,EAAEG,eAAgBC,EAAUjE,EAAGkE,SAAUC,EAAU9E,EAAE,0BAC5D+E,EAAOpE,EAAGqE,KAAK,QACnB,KAAY,MAARD,GAA+B,GAAfA,EAAKhC,QAET,OADZgC,EAAOpE,EAAGsE,OAAOD,KAAK,UACa,GAAfD,EAAKhC,QACrB,OAGc,GAAlB+B,EAAQ/B,SACR/C,EAAE,QAAQK,OAAOV,GACjBmF,EAAU9E,EAAE,2BAEhB8E,EAAQI,YAAY,oBAAoBtE,KAAK,6BAA6BuE,KAAKJ,GAC/E,IAAIK,EAAYN,EAAQ5D,aACxB4D,EAAQlE,KAAK,yBAAyBC,IAAI,OAAQuE,EAAY,GAC9D,IAAIC,EAAWT,EAAQjD,MAAQhB,EAAGO,aAAekE,GAAa,EAC1DC,EAAW,IACXA,EAAW,EACXP,EAAQlE,KAAK,yBAAyBC,IAAI,OAAQF,EAAGO,aAAe,IAExE4D,EAAQjE,KACJe,IAAOgD,EAAQhD,IAAMjB,EAAGK,cAAgB,EACxCW,KAAQ0D,KAEb,QACJd,GAAG,WAAYH,EAAI,SAAUI,GAC5BH,EAAML,mBAAoB,EAC1BS,aAAaJ,EAAMJ,qBACnBjE,EAAE,0BAA0BsF,SAAS,sBACtCf,GAAG,QAASH,EAAI,SAAUI,GACzBH,EAAML,mBAAoB,EAC1BS,aAAaJ,EAAMJ,qBACnBjE,EAAE,0BAA0BsF,SAAS,uBAG7CC,QAAS,SAAUxF,EAASyF,EAAU/E,EAAOC,EAAO+E,EAAQC,GACxD,IAAIC,EAAUnG,IACVW,EAAgBwF,EAAQvF,OACxBwF,EAAeD,EAAQE,MACb,MAAVJ,IACAA,EAAStF,EAAcM,OAE3B,IAAIqF,EAAU,gGAAkGF,EAAaG,MAAQ,4CAA8CN,EAAS,eAC5LzF,EAAE,sBAAsBE,SACxBF,EAAE,QAAQK,OAAOyF,GACjB9F,EAAE,iDAAiDmF,KAAKpF,GACxD,IAAIiG,EAAIhG,EAAE,sBAAsBkB,aAAc+E,EAAIjG,EAAE,sBAAsBgB,cACtEkF,KACY,WAAZV,GACAU,EAAKtE,IAAM,OACXsE,EAAKvE,KAAO,QACO,aAAZ6D,GACPU,EAAKtE,IAAM,OACXsE,EAAKvE,KAAO,MACZuE,EAAK,gBAAkBF,EAAI,GACR,YAAZR,GACPU,EAAKtE,IAAM,OACXsE,EAAKC,MAAQ,QACM,WAAZX,GACPU,EAAKtE,IAAM,MACXsE,EAAK,eAAiBD,EAAI,EAC1BC,EAAKvE,KAAO,QACO,UAAZ6D,GACPU,EAAKtE,IAAM,MACXsE,EAAK,eAAiBD,EAAI,EAC1BC,EAAKvE,KAAO,MACZuE,EAAK,gBAAkBF,EAAI,GACR,YAAZR,GACPU,EAAKtE,IAAM,MACXsE,EAAK,eAAiBD,EAAI,EAC1BC,EAAKC,MAAQ,QACM,cAAZX,GACPU,EAAKE,OAAS,OACdF,EAAKvE,KAAO,QACO,gBAAZ6D,GACPU,EAAKE,OAAS,OACdF,EAAKvE,KAAO,MACZuE,EAAK,gBAAkBF,EAAI,GACR,eAAZR,GACPU,EAAKE,OAAS,OACdF,EAAKC,MAAQ,SAEbD,EAAKtE,IAAM,OACXsE,EAAKvE,KAAO,MACZuE,EAAK,gBAAkBF,EAAI,GAElB,SAATtF,IACAwF,EAAKG,WAAa,4BAClBH,EAAKI,MAAQ,OACbtG,EAAE,6CAA6Ca,KAAM0F,OAAU,oBAEnE7B,WAAW,WACP1E,EAAE,iDAAiDa,KAAM2F,eAAgBxG,EAAE,6CAA6CkB,aAAe,KACxI,GACHlB,EAAE,sBAAsBa,IAAIqF,GAAMO,SAClCzG,EAAE,6CAA6CmC,MAAM,WAC1B,mBAAZuD,GACPA,MAGK,MAATjF,GAAiC,iBAATA,GACxBiE,WAAW,WACP1E,EAAE,sBAAsB0G,UAAUxG,SACX,mBAAZwF,GACPA,KAELjF","file":"../../widgets/tooltip.js","sourcesContent":["define([\n    '../widgets/constant',\n    '../utils/browser',\n    '../utils/util',\n    '../locale/locale'\n], function (m_constant, browser, m_util, locale) {\n    'use strict';\n    const {modelHTML, luckysheetchartpointconfigHTML, luckysheetToolHTML} = m_constant;\n    const {replaceHtml} = m_util;\n    const tooltip = {\n        info: function (title, content) {\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-info').remove();\n            let _locale = locale();\n            let locale_button = _locale.button;\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-info',\n                'addclass': '',\n                'title': title,\n                'content': content,\n                'botton': '<button class=\"btn btn-default luckysheet-model-close-btn\">&nbsp;&nbsp;' + locale_button.close + '&nbsp;&nbsp;</button>',\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-info').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-info').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n        },\n        confirm: function (title, content, func1, func2, name1, name2) {\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-confirm').remove();\n            const _locale = locale();\n            const locale_button = _locale.button;\n            if (name1 == null) {\n                name1 = locale_button.confirm;\n            }\n            if (name2 == null) {\n                name2 = locale_button.cancel;\n            }\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-confirm',\n                'addclass': '',\n                'style': 'z-index:100003',\n                'title': title,\n                'content': content,\n                'botton': '<button class=\"btn btn-primary luckysheet-model-conform-btn\">&nbsp;&nbsp;' + name1 + '&nbsp;&nbsp;</button><button class=\"btn btn-default luckysheet-model-cancel-btn\">&nbsp;&nbsp;' + name2 + '&nbsp;&nbsp;</button>'\n            }));\n            let $t = $('#luckysheet-confirm').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-confirm').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n            $t.find('.luckysheet-model-conform-btn').click(function () {\n                if (typeof func1 == 'function') {\n                    func1();\n                }\n                ///server.keepHighLightBox(); // TODO : lwf\n                $('#luckysheet-confirm').hide();\n                $('#luckysheet-modal-dialog-mask').hide();\n            });\n            $t.find('.luckysheet-model-cancel-btn').click(function () {\n                if (typeof func2 == 'function') {\n                    func2();\n                }\n                $('#luckysheet-confirm').hide();\n                $('#luckysheet-modal-dialog-mask').hide();\n            });\n        },\n        screenshot: function (title, content, imgurl) {\n            const _locale = locale();\n            const locale_screenshot = _locale.screenshot;\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-confirm').remove();\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-confirm',\n                'addclass': '',\n                'style': 'z-index:100003',\n                'title': title,\n                'content': content,\n                'botton': '<a style=\"text-decoration:none;color:#fff;\" class=\"download btn btn-primary luckysheet-model-conform-btn\">&nbsp;&nbsp;' + locale_screenshot.downLoadBtn + '&nbsp;&nbsp;</a>&nbsp;&nbsp;<button class=\"btn btn-primary luckysheet-model-copy-btn\">&nbsp;&nbsp;' + locale_screenshot.downLoadCopy + '&nbsp;&nbsp;</button><button class=\"btn btn-default luckysheet-model-cancel-btn\">&nbsp;&nbsp;' + locale_screenshot.downLoadClose + '&nbsp;&nbsp;</button>'\n            }));\n            let $t = $('#luckysheet-confirm').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-confirm').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n            $t.find('.luckysheet-model-conform-btn').click(function () {\n                if (browser.isIE() == '1') {\n                    alert(locale_screenshot.browserNotTip);\n                } else {\n                    if (!!window.ActiveXObject || 'ActiveXObject' in window) {\n                        if ($('#IframeReportImg').length === 0) {\n                            $('<iframe style=\"display:none;\" id=\"IframeReportImg\" name=\"IframeReportImg\" onload=\"downloadImg();\" width=\"0\" height=\"0\" src=\"about:blank\"></iframe>').appendTo('body');\n                        }\n                        if ($('#IframeReportImg').attr('src') != imgurl) {\n                            $('#IframeReportImg').attr('src', imgurl);\n                        } else {\n                            if ($('#IframeReportImg').src != 'about:blank') {\n                                window.frames['IframeReportImg'].document.execCommand('SaveAs');\n                            }\n                        }\n                    }\n                }\n            });\n            $t.find('.luckysheet-model-cancel-btn').click(function () {\n                $('#luckysheet-confirm').hide();\n                $('#luckysheet-modal-dialog-mask').hide();\n            });\n            $('#luckysheet-confirm .luckysheet-model-copy-btn').click(function () {\n                let dt = new clipboard.DT();\n                dt.setData('text/html', \"<img src='\" + imgurl + \"'>\");\n                if (browser.isIE() == '1') {\n                    alert(locale_screenshot.rightclickTip);\n                } else {\n                    clipboard.write(dt);\n                    alert(locale_screenshot.successTip);\n                }\n            });\n        },\n        chartPointConfig: function (id, savefunc1, closefunc2) {\n            $('body').append(replaceHtml(modelHTML, {\n                'id': id,\n                'addclass': 'luckysheet-chart-point-config-c',\n                'title': '数据点批量设置',\n                'content': luckysheetchartpointconfigHTML,\n                'botton': '<button class=\"btn btn-danger luckysheet-model-save-btn\">&nbsp;&nbsp;保存设置&nbsp;&nbsp;</button><button class=\"btn btn-default luckysheet-model-close-btn\">&nbsp;&nbsp;取消&nbsp;&nbsp;</button>',\n                'style': 'z-index:100003;height:80%;width:80%;top:10%;left:10%;'\n            }));\n            $('#luckysheet-modal-dialog-mask').show();\n            let winw = $(window).width(), winh = $(window).height();\n            $('#' + id).find('.luckysheet-chart-point-config').css('height', winh - 160);\n            $('#' + id).css({\n                'height': winh - 90,\n                'width': winw - 100,\n                'left': 7,\n                'top': 14\n            }).show().find('.luckysheet-model-save-btn').click(function () {\n                if (typeof savefunc1 == 'function') {\n                    savefunc1();\n                }\n                $('#' + id).hide();\n                $('#luckysheet-modal-dialog-mask').hide();\n            });\n            $('#' + id).find('.luckysheet-model-save-btn').click(function () {\n                if (typeof closefunc2 == 'function') {\n                    closefunc2();\n                }\n                $('#' + id).hide();\n                $('#luckysheet-modal-dialog-mask').hide();\n            });\n        },\n        sheetConfig: function () {\n        },\n        hoverTipshowState: false,\n        hoverTipshowTimeOut: null,\n        createHoverTip: function (obj, to) {\n            let _this = this;\n            $(obj).on('mouseover', to, function (e) {\n                if (_this.hoverTipshowState) {\n                    return;\n                }\n                clearTimeout(_this.hoverTipshowTimeOut);\n                _this.hoverTipshowTimeOut = setTimeout(function () {\n                    let $t = $(e.currentTarget), toffset = $t.offset(), $toolup = $('#luckysheet-tooltip-up');\n                    let tips = $t.data('tips');\n                    if (tips == null || tips.length == 0) {\n                        tips = $t.prev().data('tips');\n                        if (tips == null || tips.length == 0) {\n                            return;\n                        }\n                    }\n                    if ($toolup.length == 0) {\n                        $('body').append(luckysheetToolHTML);\n                        $toolup = $('#luckysheet-tooltip-up');\n                    }\n                    $toolup.removeClass('jfk-tooltip-hide').find('div.jfk-tooltip-contentId').html(tips);\n                    let toolwidth = $toolup.outerWidth();\n                    $toolup.find('div.jfk-tooltip-arrow').css('left', toolwidth / 2);\n                    let toolleft = toffset.left + ($t.outerWidth() - toolwidth) / 2;\n                    if (toolleft < 2) {\n                        toolleft = 2;\n                        $toolup.find('div.jfk-tooltip-arrow').css('left', $t.outerWidth() / 2);\n                    }\n                    $toolup.css({\n                        'top': toffset.top + $t.outerHeight() + 1,\n                        'left': toolleft\n                    });\n                }, 300);\n            }).on('mouseout', to, function (e) {\n                _this.hoverTipshowState = false;\n                clearTimeout(_this.hoverTipshowTimeOut);\n                $('#luckysheet-tooltip-up').addClass('jfk-tooltip-hide');\n            }).on('click', to, function (e) {\n                _this.hoverTipshowState = true;\n                clearTimeout(_this.hoverTipshowTimeOut);\n                $('#luckysheet-tooltip-up').addClass('jfk-tooltip-hide');\n            });\n        },\n        popover: function (content, position, close, style, btntxt, exitsFuc) {\n            let _locale = locale();\n            let locale_button = _locale.button;\n            let locale_paint = _locale.paint;\n            if (btntxt == null) {\n                btntxt = locale_button.close;\n            }\n            let htmldiv = '<div id=\"luckysheetpopover\" class=\"luckysheetpopover\"><div class=\"luckysheetpopover-content\">' + locale_paint.start + '</div><div class=\"luckysheetpopover-btn\">' + btntxt + '</div></div>';\n            $('#luckysheetpopover').remove();\n            $('body').append(htmldiv);\n            $('#luckysheetpopover .luckysheetpopover-content').html(content);\n            let w = $('#luckysheetpopover').outerWidth(), h = $('#luckysheetpopover').outerHeight();\n            let pcss = {};\n            if (position == 'topLeft') {\n                pcss.top = '20px';\n                pcss.left = '20px';\n            } else if (position == 'topCenter') {\n                pcss.top = '20px';\n                pcss.left = '50%';\n                pcss['margin-left'] = -w / 2;\n            } else if (position == 'topRight') {\n                pcss.top = '20px';\n                pcss.right = '20px';\n            } else if (position == 'midLeft') {\n                pcss.top = '50%';\n                pcss['margin-top'] = -h / 2;\n                pcss.left = '20px';\n            } else if (position == 'center') {\n                pcss.top = '50%';\n                pcss['margin-top'] = -h / 2;\n                pcss.left = '50%';\n                pcss['margin-left'] = -w / 2;\n            } else if (position == 'midRight') {\n                pcss.top = '50%';\n                pcss['margin-top'] = -h / 2;\n                pcss.right = '20px';\n            } else if (position == 'bottomLeft') {\n                pcss.bottom = '20px';\n                pcss.left = '20px';\n            } else if (position == 'bottomCenter') {\n                pcss.bottom = '20px';\n                pcss.left = '50%';\n                pcss['margin-left'] = -w / 2;\n            } else if (position == 'bottomRight') {\n                pcss.bottom = '20px';\n                pcss.right = '20px';\n            } else {\n                pcss.top = '20px';\n                pcss.left = '50%';\n                pcss['margin-left'] = -w / 2;\n            }\n            if (style == 'white') {\n                pcss.background = 'rgba(255, 255, 255, 0.65)';\n                pcss.color = '#000';\n                $('#luckysheetpopover .luckysheetpopover-btn').css({ 'border': '1px solid #000' });\n            }\n            setTimeout(function () {\n                $('#luckysheetpopover .luckysheetpopover-content').css({ 'margin-left': -$('#luckysheetpopover .luckysheetpopover-btn').outerWidth() / 2 });\n            }, 1);\n            $('#luckysheetpopover').css(pcss).fadeIn();\n            $('#luckysheetpopover .luckysheetpopover-btn').click(function () {\n                if (typeof exitsFuc == 'function') {\n                    exitsFuc();\n                }\n            });\n            if (close != null && typeof close == 'number') {\n                setTimeout(function () {\n                    $('#luckysheetpopover').fadeOut().remove();\n                    if (typeof exitsFuc == 'function') {\n                        exitsFuc();\n                    }\n                }, close);\n            }\n        }\n    };\n    return tooltip;\n});"]}