{"version":3,"sources":["widgets/resize.js"],"names":["define","luckysheetConfigsetting","Store","locale","tooltip","gridW","gridH","luckysheetsizeauto","isRefreshCanvas","showinfobar","$","show","infobarHeight","document","querySelector","offsetHeight","hide","toobarObject","toobarElements","length","container","find","toolbarHeight","initShowsheetbarConfig","config","add","menu","sheet","showsheetbar","s","JSON","stringify","showsheetbarConfig","Object","assign","isHide","sheetBarHeight","customSheetbarConfig","initStatisticBarConfig","count","view","zoom","showstatisticBar","showstatisticBarConfig","statisticBarHeight","customStatisticBarConfig","formulaEle","sheetFormulaBar","style","display","calculatebarHeight","css","width","showConfigWindowResize","is","outerWidth","locale_toolbar","toolbar","ismore","morebtn","toolMoreTip","toolMore","morediv","offset","top","scrollTop","append","each","$t","this","$container","appendChild","createTextNode","remove","toobarWidths","moreButtonIndex","undefined","index","element","Array","ele","click","right","window","left","scrollLeft","toggle","text","indexOf","toolCloseHTML","toolClose","html","toolMoreHTML","off","hover","next","addClass","removeClass","prev","createHoverTip","height","changeSheetContainerSize","refresh","invalidate","cellmainHeight","columnHeaderHeight","cellmainWidth","rowHeaderWidth","cellMainSrollBarSize","luckysheetTableContentHW","attr","Math","ceil","devicePixelRatio","gridwidth","end","gridheight","menuToolBarWidth","showtoolbar","showtoolbarConfig","toobarConfig","undo","redo","paintFormat","currencyFormat","percentageFormat","numberDecrease","numberIncrease","moreFormats","font","fontSize","bold","italic","strikethrough","underline","textColor","fillColor","border","mergeCell","horizontalAlignMode","verticalAlignMode","textWrapMode","textRotateMode","image","link","chart","postil","pivotTable","function","frozenMode","sortAndFilter","conditionalFormat","dataVerification","splitColumn","screenshot","findAndReplace","protection","print","hasOwnProperty","undoRedo","push","extend","item","sort","a","b","forEach","curr","arr"],"mappings":"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","file":"../../widgets/resize.js","sourcesContent":["define([\n    '../methods/luckysheetConfigsetting',\n    '../store',\n    '../locale/locale',\n    '../widgets/tooltip'\n], function (luckysheetConfigsetting, Store, locale, tooltip) {\n    'use strict';\n    let gridW = 0, gridH = 0;\n     function luckysheetsizeauto(isRefreshCanvas = true) {\n        if (!luckysheetConfigsetting.showinfobar) {\n            Store.infobarHeight = 0;\n            $('#luckysheet_info_detail').hide();\n        } else {\n            $('#luckysheet_info_detail').show(); ;\n            // Store.infobarHeight = 56;\n            Store.infobarHeight = document.querySelector('#luckysheet_info_detail').offsetHeight;\n        }\n        if (!!Store.toobarObject && !!Store.toobarObject.toobarElements && Store.toobarObject.toobarElements.length === 0) {\n            $('#' + Store.container).find('.luckysheet-wa-editor').hide();\n            Store.toolbarHeight = 0;\n        } else {\n            $('#' + Store.container).find('.luckysheet-wa-editor').show();    // Store.toolbarHeight = 72;\n            // Store.toolbarHeight = 72;\n            Store.toolbarHeight = document.querySelector('#' + Store.container + ' .luckysheet-wa-editor').offsetHeight;\n        }\n        // if (!luckysheetConfigsetting.showsheetbar) {\n        //     $(\"#\" + Store.container).find(\"#luckysheet-sheet-area\").hide();\n        //     Store.sheetBarHeight = 0;\n        // }\n        // else {\n        //     $(\"#\" + Store.container).find(\"#luckysheet-sheet-area\").show();\n        //     Store.sheetBarHeight = 31;\n        // }\n        customSheetbarConfig();\n        // if (!luckysheetConfigsetting.showstatisticBar) {\n        //     $(\"#\" + Store.container).find(\".luckysheet-stat-area\").hide();\n        //     Store.statisticBarHeight = 0;\n        // }\n        // else {\n        //     $(\"#\" + Store.container).find(\".luckysheet-stat-area\").show();\n        //     Store.statisticBarHeight = 23;\n        // }\n        customStatisticBarConfig();    // 公式栏\n        // 公式栏\n        const formulaEle = document.querySelector('#' + Store.container + ' .luckysheet-wa-calculate');\n        if (!luckysheetConfigsetting.sheetFormulaBar) {\n            formulaEle.style.display = 'none';\n            Store.calculatebarHeight = 0;\n        } else {\n            formulaEle.style.display = 'block';\n            Store.calculatebarHeight = formulaEle.offsetHeight;\n        }\n        $('#' + Store.container).find('.luckysheet-grid-container').css('top', Store.toolbarHeight + Store.infobarHeight + Store.calculatebarHeight);\n        gridW = $('#' + Store.container).width();\n        if (luckysheetConfigsetting.showConfigWindowResize) {\n            //数据透视表  图表  交替颜色 Protection\n            if ($('#luckysheet-modal-dialog-slider-pivot').is(':visible')) {\n                gridW -= $('#luckysheet-modal-dialog-slider-pivot').outerWidth();\n            } else if ($('.chartSetting').is(':visible')) {\n                gridW -= $('.chartSetting').outerWidth();\n            } else if ($('#luckysheet-modal-dialog-slider-alternateformat').is(':visible')) {\n                gridW -= $('#luckysheet-modal-dialog-slider-alternateformat').outerWidth();\n            }\n            if ($('#luckysheet-modal-dialog-slider-protection').is(':visible')) {\n                gridW -= $('#luckysheet-modal-dialog-slider-protection').outerWidth();\n            }\n        }\n        const _locale = locale();\n        const locale_toolbar = _locale.toolbar;\n        let ismore = false, toolbarW = 0, morebtn = `<div class=\"luckysheet-toolbar-button luckysheet-inline-block\" data-tips=\"${ locale_toolbar.toolMoreTip }\" id=\"luckysheet-icon-morebtn\" role=\"button\" style=\"user-select: none;\"> \n            <div class=\"luckysheet-toolbar-button-outer-box luckysheet-inline-block\" style=\"user-select: none;\"> \n                <div class=\"luckysheet-toolbar-button-inner-box luckysheet-inline-block\" style=\"user-select: none;\">\n\n                    <div class=\"luckysheet-toolbar-menu-button-caption luckysheet-inline-block\" style=\"user-select: none;\">\n                        ${ locale_toolbar.toolMore }\n                    </div> \n                    <div class=\"luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige\" style=\"user-select: none;font-size:12px;\">\n                    </div>\n\n                </div> \n            </div>\n         </div>`, morediv = '<div id=\"luckysheet-icon-morebtn-div\" class=\"luckysheet-wa-editor\" style=\"position:absolute;top:' + (Store.infobarHeight + Store.toolbarHeight + $('#' + Store.container).offset().top + $('body').scrollTop()) + 'px; right:0px;z-index:1003;padding:5.5px;display:none;height:auto;white-space:initial;\"></div>';\n        if ($('#luckysheet-icon-morebtn-div').length == 0) {\n            $('body').append(morediv);\n        }\n        $('#luckysheet-icon-morebtn-div').hide();    // $(\"#luckysheet-icon-morebtn-div > div\").appendTo($(\"#luckysheet-wa-editor\"));\n        // $(\"#luckysheet-icon-morebtn-div > div\").appendTo($(\"#luckysheet-wa-editor\"));\n        $('#luckysheet-icon-morebtn-div > div').each(function () {\n            const $t = $(this)[0];\n            const $container = $('#luckysheet-wa-editor')[0];\n            $container.appendChild(document.createTextNode(' '));\n            $container.appendChild($t);\n        });\n        $('#luckysheet-icon-morebtn').remove();    // 所有按钮宽度与元素定位\n        // 所有按钮宽度与元素定位\n        const toobarWidths = Store.toobarObject.toobarWidths;\n        const toobarElements = Store.toobarObject.toobarElements;\n        let moreButtonIndex = 0;    // When you resize the window during initialization, you will find that the dom has not been rendered yet\n        // When you resize the window during initialization, you will find that the dom has not been rendered yet\n        if (toobarWidths == undefined) {\n            return;\n        } \n        // 找到应该隐藏的起始元素位置\n        for (let index = toobarWidths.length - 1; index >= 0; index--) {\n            // #luckysheet-icon-morebtn button width plus right is 83px\n            if (toobarWidths[index] < gridW - 90) {\n                moreButtonIndex = index;\n                if (moreButtonIndex < toobarWidths.length - 1) {\n                    ismore = true;\n                }\n                break;\n            }\n        } \n        // 从起始位置开始，后面的元素统一挪到下方隐藏DIV中\n        for (let index = moreButtonIndex; index < toobarElements.length; index++) {\n            const element = toobarElements[index];\n            if (element instanceof Array) {\n                for (const ele of element) {\n                    $('#luckysheet-icon-morebtn-div').append($(`${ ele }`));\n                }\n            } else {\n                $('#luckysheet-icon-morebtn-div').append($(`${ element }`));\n            }\n        }\n        if (ismore) {\n            $('#luckysheet-wa-editor').append(morebtn);\n            $('#luckysheet-icon-morebtn').click(function () {\n                let right = $(window).width() - $('#luckysheet-icon-morebtn').offset().left - $('#luckysheet-icon-morebtn').width() + $('body').scrollLeft();\n                $('#luckysheet-icon-morebtn-div').toggle().css('right', right < 0 ? 0 : right);\n                let $txt = $(this).find('.luckysheet-toolbar-menu-button-caption');\n                if ($txt.text().indexOf(locale_toolbar.toolMore) > -1) {\n                    const toolCloseHTML = `\n                <div class=\"luckysheet-toolbar-menu-button-caption luckysheet-inline-block\" style=\"user-select: none;\">\n                    ${ locale_toolbar.toolClose }\n                </div> \n                <div class=\"luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-shangyige\" style=\"user-select: none;font-size:12px;\">\n                </div>\n                `;\n                    $(this).find('.luckysheet-toolbar-button-inner-box').html(toolCloseHTML);\n                } else {\n                    const toolMoreHTML = `\n                <div class=\"luckysheet-toolbar-menu-button-caption luckysheet-inline-block\" style=\"user-select: none;\">\n                    ${ locale_toolbar.toolMore }\n                </div> \n                <div class=\"luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige\" style=\"user-select: none;font-size:12px;\">\n                </div>\n                `;\n                    $(this).find('.luckysheet-toolbar-button-inner-box').html(toolMoreHTML);\n                }\n            });    //$(\"#luckysheet-wa-editor div\").trigger(\"create\");\n                   // $(\"#luckysheet-icon-morebtn-div .luckysheet-toolbar-menu-button\").css(\"margin-right\", -1);\n                   // $(\"#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-left\").css(\"margin-right\", -3);\n                   // “更多”容器中，联动hover效果\n            //$(\"#luckysheet-wa-editor div\").trigger(\"create\");\n            // $(\"#luckysheet-icon-morebtn-div .luckysheet-toolbar-menu-button\").css(\"margin-right\", -1);\n            // $(\"#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-left\").css(\"margin-right\", -3);\n            // “更多”容器中，联动hover效果\n            $('#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-left').off('hover').hover(function () {\n                $(this).next('.luckysheet-toolbar-button-split-right').addClass('luckysheet-toolbar-button-split-right-hover');\n            }, function () {\n                $(this).next('.luckysheet-toolbar-button-split-right').removeClass('luckysheet-toolbar-button-split-right-hover');\n            });\n            $('#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-right').off('hover').hover(function () {\n                $(this).prev('.luckysheet-toolbar-button-split-left').addClass('luckysheet-toolbar-button-hover');\n            }, function () {\n                $(this).prev('.luckysheet-toolbar-button-split-left').removeClass('luckysheet-toolbar-button-hover');\n            }); \n            // tooltip\n            tooltip.createHoverTip('#luckysheet-icon-morebtn-div', '.luckysheet-toolbar-menu-button, .luckysheet-toolbar-button, .luckysheet-toolbar-combo-button');\n        }\n        $('#' + Store.container + ' .luckysheet-wa-editor .luckysheet-toolbar-button-split-left').off('hover').hover(function () {\n            $(this).next('.luckysheet-toolbar-button-split-right').addClass('luckysheet-toolbar-button-split-right-hover');\n        }, function () {\n            $(this).next('.luckysheet-toolbar-button-split-right').removeClass('luckysheet-toolbar-button-split-right-hover');\n        });\n        $('#' + Store.container + ' .luckysheet-wa-editor .luckysheet-toolbar-button-split-right').off('hover').hover(function () {\n            $(this).prev('.luckysheet-toolbar-button-split-left').addClass('luckysheet-toolbar-button-hover');\n        }, function () {\n            $(this).prev('.luckysheet-toolbar-button-split-left').removeClass('luckysheet-toolbar-button-hover');\n        });    // When adding elements to the luckysheet-icon-morebtn-div element of the toolbar, it will affect the height of the entire workbook area, so the height is obtained here\n        // When adding elements to the luckysheet-icon-morebtn-div element of the toolbar, it will affect the height of the entire workbook area, so the height is obtained here\n        gridH = $('#' + Store.container).height();\n        $('#' + Store.container).find('.luckysheet').height(gridH - 2).width(gridW - 2);\n        changeSheetContainerSize(gridW, gridH);\n        if (isRefreshCanvas) {\n            ///luckysheetrefreshgrid($('#luckysheet-cell-main').scrollLeft(), $('#luckysheet-cell-main').scrollTop());\n            Store.refresh($('#luckysheet-cell-main').scrollLeft(), $('#luckysheet-cell-main').scrollTop());\n        }\n        ///sheetmanage.sheetArrowShowAndHide(); TODO:lwf\n        ///sheetmanage.sheetBarShowAndHide(); TODO:lwf\n        Store.invalidate();\n    };\n    function changeSheetContainerSize(gridW, gridH) {\n        if (gridW == null) {\n            gridW = $('#' + Store.container).width();\n        }\n        if (gridH == null) {\n            gridH = $('#' + Store.container).height();\n        }\n        Store.cellmainHeight = gridH - (Store.infobarHeight + Store.toolbarHeight + Store.calculatebarHeight + Store.columnHeaderHeight + Store.sheetBarHeight + Store.statisticBarHeight);\n        Store.cellmainWidth = gridW - Store.rowHeaderWidth;\n        $('#luckysheet-cols-h-c, #luckysheet-cell-main').width(Store.cellmainWidth);\n        $('#luckysheet-cell-main').height(Store.cellmainHeight);\n        $('#luckysheet-rows-h').height(Store.cellmainHeight - Store.cellMainSrollBarSize);\n        $('#luckysheet-scrollbar-y').height(Store.cellmainHeight + Store.columnHeaderHeight - Store.cellMainSrollBarSize - 3);\n        $('#luckysheet-scrollbar-x').height(Store.cellMainSrollBarSize);\n        $('#luckysheet-scrollbar-y').width(Store.cellMainSrollBarSize);\n        $('#luckysheet-scrollbar-x').width(Store.cellmainWidth).css('left', Store.rowHeaderWidth - 2);\n        Store.luckysheetTableContentHW = [\n            Store.cellmainWidth + Store.rowHeaderWidth - Store.cellMainSrollBarSize,\n            Store.cellmainHeight + Store.columnHeaderHeight - Store.cellMainSrollBarSize\n        ];\n        $('#luckysheetTableContent, #luckysheetTableContentF').attr({\n            width: Math.ceil(Store.luckysheetTableContentHW[0] * Store.devicePixelRatio),\n            height: Math.ceil(Store.luckysheetTableContentHW[1] * Store.devicePixelRatio)\n        }).css({\n            width: Store.luckysheetTableContentHW[0],\n            height: Store.luckysheetTableContentHW[1]\n        });\n        $('#' + Store.container).find('#luckysheet-grid-window-1').css('bottom', Store.sheetBarHeight);\n        $('#' + Store.container).find('.luckysheet-grid-window').css('bottom', Store.statisticBarHeight);\n        let gridwidth = $('#luckysheet-grid-window-1').width();\n        $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-handle').css({ 'width': gridwidth - 10 }).end().find('.luckysheet-freezebar-horizontal-drop').css({ 'width': gridwidth - 10 });\n        let gridheight = $('#luckysheet-grid-window-1').height();\n        $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-handle').css({ 'height': gridheight - 10 }).end().find('.luckysheet-freezebar-vertical-drop').css({ 'height': gridheight - 10 });\n        ///luckysheetFreezen.createAssistCanvas(); TODO:lwf\n    }    \n    /**\n * \n * \n * Toolbar judgment rules: First set the display and hide of all tool buttons according to showtoolbar, and then override the judgment of showtoolbar according to showtoolbarConfig rules\n * \n * The width value of each button in the statistics toolbar is used to calculate which needs to be placed in more buttons\n */\n    function menuToolBarWidth() {\n        const showtoolbar = luckysheetConfigsetting.showtoolbar;\n        const showtoolbarConfig = luckysheetConfigsetting.showtoolbarConfig;\n        const toobarWidths = Store.toobarObject.toobarWidths = [];\n        const toobarElements = Store.toobarObject.toobarElements = [];\n        const toobarConfig = Store.toobarObject.toobarConfig = {\n            undo: {\n                ele: '#luckysheet-icon-undo',\n                index: 0\n            },\n            //Undo redo\n            redo: {\n                ele: '#luckysheet-icon-redo',\n                index: 1\n            },\n            paintFormat: {\n                ele: [\n                    '#luckysheet-icon-paintformat',\n                    '#toolbar-separator-paint-format'\n                ],\n                index: 2\n            },\n            //Format brush\n            currencyFormat: {\n                ele: '#luckysheet-icon-currency',\n                index: 3\n            },\n            //currency format\n            percentageFormat: {\n                ele: '#luckysheet-icon-percent',\n                index: 4\n            },\n            //Percentage format\n            numberDecrease: {\n                ele: '#luckysheet-icon-fmt-decimal-decrease',\n                index: 5\n            },\n            //'Decrease the number of decimal places'\n            numberIncrease: {\n                ele: '#luckysheet-icon-fmt-decimal-increase',\n                index: 6\n            },\n            //'Increase the number of decimal places\n            moreFormats: {\n                ele: [\n                    '#luckysheet-icon-fmt-other',\n                    '#toolbar-separator-more-format'\n                ],\n                index: 7\n            },\n            //'More Formats'\n            font: {\n                ele: [\n                    '#luckysheet-icon-font-family',\n                    '#toolbar-separator-font-family'\n                ],\n                index: 8\n            },\n            //'font'\n            fontSize: {\n                ele: [\n                    '#luckysheet-icon-font-size',\n                    '#toolbar-separator-font-size'\n                ],\n                index: 9\n            },\n            //'Font size'\n            bold: {\n                ele: '#luckysheet-icon-bold',\n                index: 10\n            },\n            //'Bold (Ctrl+B)'\n            italic: {\n                ele: '#luckysheet-icon-italic',\n                index: 11\n            },\n            //'Italic (Ctrl+I)'\n            strikethrough: {\n                ele: '#luckysheet-icon-strikethrough',\n                index: 12\n            },\n            //'Strikethrough (Alt+Shift+5)'\n            underline: {\n                ele: '#luckysheet-icon-underline',\n                index: 13\n            },\n            //'Underline (Alt+Shift+6)'\n            textColor: {\n                ele: [\n                    '#luckysheet-icon-text-color',\n                    '#luckysheet-icon-text-color-menu',\n                    '#toolbar-separator-text-color'\n                ],\n                index: 14\n            },\n            //'Text color'\n            fillColor: {\n                ele: [\n                    '#luckysheet-icon-cell-color',\n                    '#luckysheet-icon-cell-color-menu'\n                ],\n                index: 15\n            },\n            //'Cell color'\n            border: {\n                ele: [\n                    '#luckysheet-icon-border-all',\n                    '#luckysheet-icon-border-menu'\n                ],\n                index: 16\n            },\n            //'border'\n            mergeCell: {\n                ele: [\n                    '#luckysheet-icon-merge-button',\n                    '#luckysheet-icon-merge-menu',\n                    '#toolbar-separator-merge-cell'\n                ],\n                index: 17\n            },\n            //'Merge cells'\n            horizontalAlignMode: {\n                ele: [\n                    '#luckysheet-icon-align',\n                    '#luckysheet-icon-align-menu'\n                ],\n                index: 18\n            },\n            //'Horizontal alignment'\n            verticalAlignMode: {\n                ele: [\n                    '#luckysheet-icon-valign',\n                    '#luckysheet-icon-valign-menu'\n                ],\n                index: 19\n            },\n            //'Vertical alignment'\n            textWrapMode: {\n                ele: [\n                    '#luckysheet-icon-textwrap',\n                    '#luckysheet-icon-textwrap-menu'\n                ],\n                index: 20\n            },\n            //'Wrap mode'\n            textRotateMode: {\n                ele: [\n                    '#luckysheet-icon-rotation',\n                    '#luckysheet-icon-rotation-menu',\n                    '#toolbar-separator-text-rotate'\n                ],\n                index: 21\n            },\n            //'Text Rotation Mode'\n            image: {\n                ele: '#luckysheet-insertImg-btn-title',\n                index: 22\n            },\n            //'Insert link'\n            link: {\n                ele: '#luckysheet-insertLink-btn-title',\n                index: 23\n            },\n            //'Insert picture'\n            chart: {\n                ele: '#luckysheet-chart-btn-title',\n                index: 24\n            },\n            //'chart' (the icon is hidden, but if the chart plugin is configured, you can still create a new chart by right click)\n            postil: {\n                ele: '#luckysheet-icon-postil',\n                index: 25\n            },\n            //'comment'\n            pivotTable: {\n                ele: [\n                    '#luckysheet-pivot-btn-title',\n                    '#toolbar-separator-pivot-table'\n                ],\n                index: 26\n            },\n            //'PivotTable'\n            function: {\n                ele: [\n                    '#luckysheet-icon-function',\n                    '#luckysheet-icon-function-menu'\n                ],\n                index: 27\n            },\n            //'formula'\n            frozenMode: {\n                ele: [\n                    '#luckysheet-freezen-btn-horizontal',\n                    '#luckysheet-icon-freezen-menu'\n                ],\n                index: 28\n            },\n            //'freeze mode'\n            sortAndFilter: {\n                ele: '#luckysheet-icon-autofilter',\n                index: 29\n            },\n            //'sort and filter'\n            conditionalFormat: {\n                ele: '#luckysheet-icon-conditionformat',\n                index: 30\n            },\n            //'Conditional Format'\n            dataVerification: {\n                ele: '#luckysheet-dataVerification-btn-title',\n                index: 31\n            },\n            // 'Data Verification'\n            splitColumn: {\n                ele: '#luckysheet-splitColumn-btn-title',\n                index: 32\n            },\n            //'Split column' \n            screenshot: {\n                ele: '#luckysheet-chart-btn-screenshot',\n                index: 33\n            },\n            //'screenshot'\n            findAndReplace: {\n                ele: '#luckysheet-icon-seachmore',\n                index: 34\n            },\n            //'Find and Replace'\n            protection: {\n                ele: '#luckysheet-icon-protection',\n                index: 35\n            },\n            // 'Worksheet protection'\n            print: {\n                ele: '#luckysheet-icon-print',\n                index: 36\n            }\n        };\n        // 'print'\n        const config = {\n            undo: true,\n            //Undo\n            redo: true,\n            //Redo\n            paintFormat: true,\n            //Format brush\n            currencyFormat: true,\n            //currency format\n            percentageFormat: true,\n            //Percentage format\n            numberDecrease: true,\n            //'Decrease the number of decimal places'\n            numberIncrease: true,\n            //'Increase the number of decimal places\n            moreFormats: true,\n            //'More Formats'\n            font: true,\n            //'font'\n            fontSize: true,\n            //'Font size'\n            bold: true,\n            //'Bold (Ctrl+B)'\n            italic: true,\n            //'Italic (Ctrl+I)'\n            strikethrough: true,\n            //'Strikethrough (Alt+Shift+5)'\n            underline: true,\n            //'Underline (Alt+Shift+6)'\n            textColor: true,\n            //'Text color'\n            fillColor: true,\n            //'Cell color'\n            border: true,\n            //'border'\n            mergeCell: true,\n            //'Merge cells'\n            horizontalAlignMode: true,\n            //'Horizontal alignment'\n            verticalAlignMode: true,\n            //'Vertical alignment'\n            textWrapMode: true,\n            //'Wrap mode'\n            textRotateMode: true,\n            //'Text Rotation Mode'\n            image: true,\n            // 'Insert picture'\n            link: true,\n            // 'Insert link'(TODO)\n            chart: true,\n            //'chart' (the icon is hidden, but if the chart plugin is configured, you can still create a new chart by right click)\n            postil: true,\n            //'comment'\n            pivotTable: true,\n            //'PivotTable'\n            function: true,\n            //'formula'\n            frozenMode: true,\n            //'freeze mode'\n            sortAndFilter: true,\n            //'Sort and filter'\n            conditionalFormat: true,\n            //'Conditional Format'\n            dataVerification: true,\n            // 'Data Verification'\n            splitColumn: true,\n            //'Split column'\n            screenshot: true,\n            //'screenshot'\n            findAndReplace: true,\n            //'Find and Replace'\n            protection: true,\n            // 'Worksheet protection'\n            print: true\n        };    // false means all false\n        // 'print'\n        // false means all false\n        if (!showtoolbar) {\n            for (let s in config) {\n                config[s] = false;\n            }\n        }    // showtoolbarConfig determines the final result\n        // showtoolbarConfig determines the final result\n        if (JSON.stringify(showtoolbarConfig) !== '{}') {\n            if (showtoolbarConfig.hasOwnProperty('undoRedo')) {\n                config.undo = config.redo = showtoolbarConfig.undoRedo;\n                delete showtoolbarConfig.undoRedo;\n            }\n            Object.assign(config, showtoolbarConfig);\n        }    // 1. The button set to false, remove the dom\n             // 2. Build toobarWidths and toobarElements\n        // 1. The button set to false, remove the dom\n        // 2. Build toobarWidths and toobarElements\n        for (let s in config) {\n            if (config[s]) {\n                toobarElements.push($.extend(true, {}, toobarConfig[s]));\n            } else {\n                if (toobarConfig[s].ele instanceof Array) {\n                    for (const item of toobarConfig[s].ele) {\n                        $(item).remove();\n                    }\n                } else {\n                    $(toobarConfig[s].ele).remove();\n                }\n            }\n        }\n        toobarElements.sort(sortToolbar);\n        function sortToolbar(a, b) {\n            if (a.index > b.index) {\n                return 1;\n            } else {\n                return -1;\n            }\n        }\n        toobarElements.forEach((curr, index, arr) => {\n            arr[index] = curr.ele;\n            if (index !== toobarElements.length - 1) {\n                if (curr.ele instanceof Array) {\n                    toobarWidths.push($(curr.ele[0]).offset().left);\n                } else {\n                    toobarWidths.push($(curr.ele).offset().left);\n                }\n            } else {\n                if (curr.ele instanceof Array) {\n                    toobarWidths.push($(curr.ele[0]).offset().left);\n                    toobarWidths.push($(curr.ele[0]).offset().left + $(curr.ele[0]).outerWidth() + 5);\n                } else {\n                    toobarWidths.push($(curr.ele).offset().left);\n                    toobarWidths.push($(curr.ele).offset().left + $(curr.ele).outerWidth() + 5);\n                }\n            }\n        });\n    }    /**\n *Custom configuration bottom sheet button\n */\n    /**\n *Custom configuration bottom sheet button\n */\n    function customSheetbarConfig() {\n        if (!luckysheetConfigsetting.initShowsheetbarConfig) {\n            luckysheetConfigsetting.initShowsheetbarConfig = true;\n            const config = {\n                add: true,\n                //Add worksheet\n                menu: true,\n                //Worksheet management menu\n                sheet: true    //Worksheet display\n            };\n            //Worksheet display\n            if (!luckysheetConfigsetting.showsheetbar) {\n                for (let s in config) {\n                    config[s] = false;\n                }\n            }    // showsheetbarConfig determines the final result\n            // showsheetbarConfig determines the final result\n            if (JSON.stringify(luckysheetConfigsetting.showsheetbarConfig) !== '{}') {\n                Object.assign(config, luckysheetConfigsetting.showsheetbarConfig);\n            }\n            luckysheetConfigsetting.showsheetbarConfig = config;\n        }\n        const config = luckysheetConfigsetting.showsheetbarConfig;\n        let isHide = 0;\n        for (let s in config) {\n            if (!config[s]) {\n                switch (s) {\n                case 'add':\n                    $('#luckysheet-sheets-add').hide();\n                    isHide++;\n                    break;\n                case 'menu':\n                    $('#luckysheet-sheets-m').hide();\n                    isHide++;\n                    break;\n                case 'sheet':\n                    $('#luckysheet-sheet-container').hide();\n                    $('#luckysheet-sheets-leftscroll').hide();\n                    $('#luckysheet-sheets-rightscroll').hide();\n                    isHide++;\n                    break;\n                default:\n                    break;\n                }\n            }\n        }\n        if (isHide === 3) {\n            $('#' + Store.container).find('#luckysheet-sheet-area').hide();\n            Store.sheetBarHeight = 0;\n        } else {\n            $('#' + Store.container).find('#luckysheet-sheet-area').show();\n            Store.sheetBarHeight = 31;\n        }\n    }  \n    /**\n * Customize the bottom count bar\n */\n    function customStatisticBarConfig() {\n        if (!luckysheetConfigsetting.initStatisticBarConfig) {\n            luckysheetConfigsetting.initStatisticBarConfig = true;\n            const config = {\n                count: true,\n                // Count bar\n                view: true,\n                // print view\n                zoom: true    // Zoom\n            };\n            // Zoom\n            if (!luckysheetConfigsetting.showstatisticBar) {\n                for (let s in config) {\n                    config[s] = false;\n                }\n            }    // showstatisticBarConfig determines the final result\n            // showstatisticBarConfig determines the final result\n            if (JSON.stringify(luckysheetConfigsetting.showstatisticBarConfig) !== '{}') {\n                Object.assign(config, luckysheetConfigsetting.showstatisticBarConfig);\n            }\n            luckysheetConfigsetting.showstatisticBarConfig = config;\n        }\n        const config = luckysheetConfigsetting.showstatisticBarConfig;\n        let isHide = 0;\n        for (let s in config) {\n            if (!config[s]) {\n                switch (s) {\n                case 'count':\n                    $('#luckysheet-sta-content').hide();\n                    isHide++;\n                    break;\n                case 'view':\n                    $('.luckysheet-print-viewList').hide();\n                    isHide++;\n                    break;\n                case 'zoom':\n                    $('#luckysheet-zoom-content').hide();\n                    isHide++;\n                    break;\n                default:\n                    break;\n                }\n            }\n        }\n        if (isHide === 3) {\n            $('#' + Store.container).find('.luckysheet-stat-area').hide();\n            Store.statisticBarHeight = 0;\n        } else {\n            $('#' + Store.container).find('.luckysheet-stat-area').show();\n            Store.statisticBarHeight = 23;\n        }\n    }\n\n    Object.assign(luckysheetsizeauto,{\n        changeSheetContainerSize,\n        menuToolBarWidth\n    });\n    \n   return luckysheetsizeauto;\n});"]}