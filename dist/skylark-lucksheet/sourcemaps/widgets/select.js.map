{"version":3,"sources":["widgets/select.js"],"names":["define","cells","m_dynamicArray","m_location","browser","m_get","Store","luckysheetConfigsetting","locale","dynamicArrayHightShow","rowLocationByIndex","colLocationByIndex","getSheetIndex","getRangetxt","selectTitlesMap","rangeMap","range1","range2","map","$","extend","i","selectTitlesRange","mapArr","push","sort","a","b","rangeArr","item","length","j","luckysheet_count_show","left","top","width","height","rowseleted","columnseleted","rowl","coll","drawWidth","luckysheetTableContentHW","drawHeight","scrollWidth","scrollLeft","scrollHeight","scrollTop","locale_info","info","leftv","topv","css","display","html","toString","split","join","row","hide","text","column","selectHelpboxFill","range","luckysheet_select_save","rf","cf","config","currentSheetIndex","seletedHighlistByindex","id","r1","r2","c1","c2","visibledatarow","row_pre","col","visibledatacolumn","col_pre","selectHightlightShow","isRestore","show","siblings","remove","row_focus","column_focus","row_f","row_pre_f","col_f","col_pre_f","margeset","mergeborer","flowdata","mobilecheck","border","find","end","append","s","rowTitleMap","columnTitleMap","empty","rowTitleRange","columnTitleRange","selectTitlesShow","luckysheetfile","luckysheet_select_save_previous","JSON","stringify","createHookFunction","selectIsOverlap","overlap","str_r","end_r","str_c","end_c","r","c","selectionCopyShow","luckysheet_selection_range","copyDomHtml","collaborativeEditBox","all_width","all_height","cooperativeEdit","changeCollaborationSize","forEach","value","count_col","v","change_width","count_row","change_height","merge_range","change_left","change_top","columnlen","k","luckysheet_cols_change_size_start","rowlen","luckysheet_rows_change_size_start","counts","Object","keys","flag_sure_merge","flag_merge_width","change_bottom","offsetHeight","bottom"],"mappings":"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","file":"../../widgets/select.js","sourcesContent":["define([\n    '../methods/cells',\n    '../methods/dynamicArray',\n    '../methods/location',\n    '../utils/browser',\n    '../methods/get',\n    '../store',\n    '../methods/luckysheetConfigsetting',\n    '../locale/locale'\n], function (cells, m_dynamicArray, m_location, browser, m_get, Store, luckysheetConfigsetting, locale) {\n    'use strict';\n    const {dynamicArrayHightShow} = m_dynamicArray;\n    const {rowLocationByIndex, colLocationByIndex} = m_location;\n    const {getSheetIndex, getRangetxt} = m_get;\n    //公式函数 选区实体框\n    function seletedHighlistByindex(id, r1, r2, c1, c2) {\n        let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n        let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n        $('#' + id).css({\n            'left': col_pre,\n            'width': col - col_pre - 1,\n            'top': row_pre,\n            'height': row - row_pre - 1\n        });\n    } \n    //Set selection highlight\n    function selectHightlightShow(isRestore = false) {\n        $('#luckysheet-cell-selected-boxs').show();\n        $('#luckysheet-cell-selected-boxs #luckysheet-cell-selected').siblings('.luckysheet-cell-selected').remove();\n        if (Store.luckysheet_select_save.length > 0) {\n            for (let i = 0; i < Store.luckysheet_select_save.length; i++) {\n                let r1 = Store.luckysheet_select_save[i].row[0], r2 = Store.luckysheet_select_save[i].row[1];\n                let c1 = Store.luckysheet_select_save[i].column[0], c2 = Store.luckysheet_select_save[i].column[1];\n                let rf, cf;\n                if (Store.luckysheet_select_save[i].row_focus == null) {\n                    rf = r1;\n                } else {\n                    rf = Store.luckysheet_select_save[i].row_focus;\n                }\n                if (Store.luckysheet_select_save[i].column_focus == null) {\n                    cf = c1;\n                } else {\n                    cf = Store.luckysheet_select_save[i].column_focus;\n                }\n                let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                let row_f = Store.visibledatarow[rf], row_pre_f = rf - 1 == -1 ? 0 : Store.visibledatarow[rf - 1];\n                let col_f = Store.visibledatacolumn[cf], col_pre_f = cf - 1 == -1 ? 0 : Store.visibledatacolumn[cf - 1];\n                let margeset = cells.mergeborer(Store.flowdata, rf, cf);\n                if (!!margeset) {\n                    row_f = margeset.row[1];\n                    row_pre_f = margeset.row[0];\n                    col_f = margeset.column[1];\n                    col_pre_f = margeset.column[0];\n                }\n                Store.luckysheet_select_save[i]['row'] = [\n                    r1,\n                    r2\n                ];\n                Store.luckysheet_select_save[i]['column'] = [\n                    c1,\n                    c2\n                ];\n                Store.luckysheet_select_save[i]['row_focus'] = rf;\n                Store.luckysheet_select_save[i]['column_focus'] = cf;\n                Store.luckysheet_select_save[i]['left'] = col_pre_f;\n                Store.luckysheet_select_save[i]['width'] = col_f - col_pre_f - 1;\n                Store.luckysheet_select_save[i]['top'] = row_pre_f;\n                Store.luckysheet_select_save[i]['height'] = row_f - row_pre_f - 1;\n                Store.luckysheet_select_save[i]['left_move'] = col_pre;\n                Store.luckysheet_select_save[i]['width_move'] = col - col_pre - 1;\n                Store.luckysheet_select_save[i]['top_move'] = row_pre;\n                Store.luckysheet_select_save[i]['height_move'] = row - row_pre - 1;\n                if (i == 0) {\n                    if (Store.luckysheet_select_save.length == 1) {\n                        if (browser.mobilecheck()) {\n                            //移动端\n                            $('#luckysheet-cell-selected-boxs #luckysheet-cell-selected').css({\n                                'left': Store.luckysheet_select_save[i]['left_move'],\n                                'width': Store.luckysheet_select_save[i]['width_move'],\n                                'top': Store.luckysheet_select_save[i]['top_move'],\n                                'height': Store.luckysheet_select_save[i]['height_move'],\n                                'display': 'block',\n                                'border': '1px solid #0188fb'\n                            }).find('.luckysheet-cs-draghandle').css('display', 'block').end().find('.luckysheet-cs-fillhandle').css('display', 'none').end().find('.luckysheet-cs-touchhandle').css('display', 'block');\n                        } else {\n                            $('#luckysheet-cell-selected-boxs #luckysheet-cell-selected').css({\n                                'left': Store.luckysheet_select_save[i]['left_move'],\n                                'width': Store.luckysheet_select_save[i]['width_move'],\n                                'top': Store.luckysheet_select_save[i]['top_move'],\n                                'height': Store.luckysheet_select_save[i]['height_move'],\n                                'display': 'block',\n                                'border': '1px solid #0188fb'\n                            }).find('.luckysheet-cs-draghandle').css('display', 'block').end().find('.luckysheet-cs-fillhandle').css('display', 'block').end().find('.luckysheet-cs-touchhandle').css('display', 'none');\n                        }\n                    } else {\n                        $('#luckysheet-cell-selected-boxs #luckysheet-cell-selected').css({\n                            'left': Store.luckysheet_select_save[i]['left_move'],\n                            'width': Store.luckysheet_select_save[i]['width_move'],\n                            'top': Store.luckysheet_select_save[i]['top_move'],\n                            'height': Store.luckysheet_select_save[i]['height_move'],\n                            'display': 'block',\n                            'border': '1px solid rgba(1, 136, 251, 0.15)'\n                        }).find('.luckysheet-cs-draghandle').css('display', 'none').end().find('.luckysheet-cs-fillhandle').css('display', 'none');\n                    }\n                } else {\n                    $('#luckysheet-cell-selected-boxs').append('<div class=\"luckysheet-cell-selected\" style=\"left: ' + Store.luckysheet_select_save[i]['left_move'] + 'px; width: ' + Store.luckysheet_select_save[i]['width_move'] + 'px; top: ' + Store.luckysheet_select_save[i]['top_move'] + 'px; height: ' + Store.luckysheet_select_save[i]['height_move'] + 'px; border: 1px solid rgba(1, 136, 251, 0.15); display: block;\"></div>');\n                }\n                if (i == Store.luckysheet_select_save.length - 1) {\n                    //focus 取选区数组最后一个\n                    $('#luckysheet-cell-selected-focus').css({\n                        'left': Store.luckysheet_select_save[i]['left'],\n                        'width': Store.luckysheet_select_save[i]['width'],\n                        'top': Store.luckysheet_select_save[i]['top'],\n                        'height': Store.luckysheet_select_save[i]['height'],\n                        'display': 'block'\n                    });    //行列数\n                    //行列数\n                    luckysheet_count_show(Store.luckysheet_select_save[i]['left_move'], Store.luckysheet_select_save[i]['top_move'], Store.luckysheet_select_save[i]['width_move'], Store.luckysheet_select_save[i]['height_move'], [\n                        r1,\n                        r2\n                    ], [\n                        c1,\n                        c2\n                    ]);    //左上角选择区域框\n                    //左上角选择区域框\n                    ///formula.fucntionboxshow(rf, cf);    //focus单元格数据验证 //TODO : lwf\n                    //focus单元格数据验证\n                    ////dataVerificationCtrl.cellFocus(rf, cf); //TODO : lwf\n                }\n            }    //行列标题栏\n            //行列标题栏\n            selectTitlesShow(Store.luckysheet_select_save, isRestore);    //左上角范围显示\n            //左上角范围显示\n            selectHelpboxFill();    //动态数组显示\n            //动态数组显示\n            if (Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1] && Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                dynamicArrayHightShow(Store.luckysheet_select_save[0].row[0], Store.luckysheet_select_save[0].column[0]);\n            }\n        }\n        Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].luckysheet_select_save = Store.luckysheet_select_save;    // Hook function, change the range selection box, selectHightlightShowillbe triggered multiple times when mousemove is moused, and thhistoricalvalue is used here to throttle\n        // Hook function, change the range selection box, selectHightlightShowillbe triggered multiple times when mousemove is moused, and thhistoricalvalue is used here to throttle\n        const luckysheet_select_save_previous = JSON.stringify(Store.luckysheet_select_save);\n        if (Store.luckysheet_select_save_previous == null | Store.luckysheet_select_save_previous !== luckysheet_select_save_previous) {\n            luckysheetConfigsetting.createHookFunction('rangeSelect', Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)], Store.luckysheet_select_save);\n        }\n        Store.luckysheet_select_save_previous = luckysheet_select_save_previous;\n    }    //选区标题栏\n    //选区标题栏\n    function selectTitlesShow(rangeArr, isRestore = false) {\n        let s = $.extend(true, [], rangeArr);\n        let rowTitleMap = {}, columnTitleMap = {};\n        for (let i = 0; i < s.length; i++) {\n            let r1 = s[i]['row'][0], r2 = s[i]['row'][1], c1 = s[i]['column'][0], c2 = s[i]['column'][1];    \n            // if(isRestore){\n            //     let margeset = cells.mergeborer(Store.flowdata, r1, c1);\n            //     if(!!margeset){\n            //         r1 = margeset.row[2];\n            //         r2 = margeset.row[3];\n            //         c1 = margeset.column[2];\n            //         c2 = margeset.column[3];\n            //     }\n            // }\n            //行、列标题栏\n            rowTitleMap = selectTitlesMap(rowTitleMap, r1, r2);\n            columnTitleMap = selectTitlesMap(columnTitleMap, c1, c2);\n        }    //行标题\n        //行标题\n        $('#luckysheet-rows-h-selected').empty();\n        let rowTitleRange = selectTitlesRange(rowTitleMap);\n        for (let i = 0; i < rowTitleRange.length; i++) {\n            let r1 = rowTitleRange[i][0], r2 = rowTitleRange[i][rowTitleRange[i].length - 1];\n            let row = rowLocationByIndex(r2)[1], row_pre = rowLocationByIndex(r1)[0];\n            $('#luckysheet-rows-h-selected').append('<div class=\"luckysheet-rows-h-selected\" style=\"top: ' + row_pre + 'px; height: ' + (row - row_pre - 1) + 'px; display: block; background-color: rgba(76, 76, 76, 0.1);\"></div>');\n        }    //列标题\n        //列标题\n        $('#luckysheet-cols-h-selected').empty();\n        let columnTitleRange = selectTitlesRange(columnTitleMap);\n        for (let j = 0; j < columnTitleRange.length; j++) {\n            let c1 = columnTitleRange[j][0], c2 = columnTitleRange[j][columnTitleRange[j].length - 1];\n            let col = colLocationByIndex(c2)[1], col_pre = colLocationByIndex(c1)[0];\n            $('#luckysheet-cols-h-selected').append('<div class=\"luckysheet-cols-h-selected\" style=\"left: ' + col_pre + 'px; width: ' + (col - col_pre - 1) + 'px; display: block; background-color: rgba(76, 76, 76, 0.1);\"></div>');\n        }\n    }\n    function selectTitlesMap(rangeMap, range1, range2) {\n        let map = $.extend(true, {}, rangeMap);\n        for (let i = range1; i <= range2; i++) {\n            if (i in map) {\n                continue;\n            }\n            map[i] = 0;\n        }\n        return map;\n    }\n    function selectTitlesRange(map) {\n        let mapArr = [];\n        for (let i in map) {\n            mapArr.push(i);\n        }\n        mapArr.sort(function (a, b) {\n            return a - b;\n        });\n        let rangeArr = [];\n        let item = [];\n        if (mapArr.length > 1) {\n            for (let j = 1; j < mapArr.length; j++) {\n                if (mapArr[j] - mapArr[j - 1] == 1) {\n                    item.push(mapArr[j - 1]);\n                    if (j == mapArr.length - 1) {\n                        item.push(mapArr[j]);\n                        rangeArr.push(item);\n                    }\n                } else {\n                    if (j == 1) {\n                        if (j == mapArr.length - 1) {\n                            item.push(mapArr[j - 1]);\n                            rangeArr.push(item);\n                            rangeArr.push([mapArr[j]]);\n                        } else {\n                            rangeArr.push(mapArr[0]);\n                        }\n                    } else if (j == mapArr.length - 1) {\n                        item.push(mapArr[j - 1]);\n                        rangeArr.push(item);\n                        rangeArr.push([mapArr[j]]);\n                    } else {\n                        item.push(mapArr[j - 1]);\n                        rangeArr.push(item);\n                        item = [];\n                    }\n                }\n            }\n        } else {\n            rangeArr.push([mapArr[0]]);\n        }\n        return rangeArr;\n    }    //选区是否重叠\n    //选区是否重叠\n    function selectIsOverlap(range) {\n        if (range == null) {\n            range = Store.luckysheet_select_save;\n        }\n        let overlap = false;\n        let map = {};\n        for (let s = 0; s < range.length; s++) {\n            let str_r = range[s].row[0], end_r = range[s].row[1];\n            let str_c = range[s].column[0], end_c = range[s].column[1];\n            for (let r = str_r; r <= end_r; r++) {\n                for (let c = str_c; c <= end_c; c++) {\n                    if (r + '_' + c in map) {\n                        overlap = true;\n                        break;\n                    } else {\n                        map[r + '_' + c] = 0;\n                    }\n                }\n            }\n        }\n        return overlap;\n    }    // 协同提示框\n    // 协同提示框\n    function collaborativeEditBox() {\n        let all_width = Store.visibledatacolumn;    //当前操作页的所有列距离左边的距离\n        //当前操作页的所有列距离左边的距离\n        let all_height = Store.visibledatarow;    //当前操作页的所有列距离顶部的距离\n        //当前操作页的所有列距离顶部的距离\n        Store.cooperativeEdit.changeCollaborationSize.forEach(value => {\n            if (value.i == Store.currentSheetIndex) {\n                let count_col = value.v.column;    //系统提示框所在的列范围\n                //系统提示框所在的列范围\n                let change_width = all_width[count_col[0]] - 1;    //提示框所在列号为0时要改变的宽\n                //提示框所在列号为0时要改变的宽\n                if (value.v.column[0] !== 0) {\n                    //用提示框右边框到图表最左的距离减去左边框到图表左边距离再减去边框值\n                    change_width = all_width[count_col[1]] - all_width[count_col[0] - 1] - (count_col[1] - count_col[0] + 1);\n                }\n                let count_row = value.v.row;    //系统提示框所在的行范围\n                //系统提示框所在的行范围\n                let change_height = all_height[count_row[0]] - 1;\n                if (value.v.row[0] !== 0) {\n                    change_height = all_height[count_row[1]] - all_height[count_row[0] - 1] - (count_row[1] - count_row[0] + 1);\n                }\n                let range = Store.cooperativeEdit.merge_range;    //获取单元格合并后的数据\n                //获取单元格合并后的数据\n                let change_left = all_width[value.v.column[0] - 1] - 1;    //提示框离图表最左边的距离\n                //提示框离图表最左边的距离\n                let change_top = all_height[value.v.row[0] - 1] - 1;    //提示框离图表最右边的距离\n                //提示框离图表最右边的距离\n                if (Store.config.columnlen !== null) {\n                    //当改变宽的列不在提示框范围内时，将改变列的初始位置改为在提示框范围内\n                    for (let k in Store.config.columnlen) {\n                        if (value.v.column[0] <= k && k <= value.v.column[1]) {\n                            Store.luckysheet_cols_change_size_start[1] = k - 0;\n                            break;\n                        }\n                    }\n                }\n                if (Store.config.rowlen !== null) {\n                    for (let k in Store.config.rowlen) {\n                        if (value.v.row[0] <= k && k <= value.v.row[1]) {\n                            Store.luckysheet_rows_change_size_start[1] = k - 0;\n                            break;\n                        }\n                    }\n                }    // 改变列宽的位置在提示框范围内\n                // 改变列宽的位置在提示框范围内\n                let flag_width = value.v.column[0] <= Store.luckysheet_cols_change_size_start[1] && Store.luckysheet_cols_change_size_start[1] <= value.v.column[1];\n                if (flag_width) {\n                    if (Store.luckysheet_cols_change_size_start[1] == 0) {\n                        change_width = all_width[0] - 1;\n                    } else {\n                        // 不在提示框范围内\n                        let counts = value.v.column;\n                        change_width = all_width[counts[1]] - all_width[counts[0] - 1] - (counts[1] - counts[0] + 1);\n                    }\n                }\n                let flag_height = value.v.row[0] <= Store.luckysheet_rows_change_size_start[1] && Store.luckysheet_rows_change_size_start[1] <= value.v.row[1];\n                if (flag_height) {\n                    if (Store.luckysheet_rows_change_size_start[1] == 0) {\n                        change_height = all_height[0] - 1;\n                    } else {\n                        let counts = value.v.row;\n                        change_height = all_height[counts[1]] - all_height[counts[0] - 1] - (counts[1] - counts[0] + 1);\n                    }\n                }    //合并单元格时执行\n                //合并单元格时执行\n                if (Object.keys(range).length > 0) {\n                    let flag_sure_merge = false;\n                    if (range.v.length > 1) {\n                        flag_sure_merge = Object.keys(range.v[1][0]).length > 0;\n                    }\n                    if (range.v[0].length > 1) {\n                        flag_sure_merge = Object.keys(range.v[0][1]).length > 0;\n                    }\n                    if (flag_sure_merge) {\n                        // 合并成一个时执行\n                        let flag_merge_width = range.column[0] <= value.v.column[0] && range.column[1] >= value.v.column[1];\n                        change_left = all_width[range.column[0] - 1] - 1;\n                        change_top = all_height[range.row[0] - 1] - 1;\n                        change_width = all_width[range.column[1]] - 1;\n                        change_height = all_height[range.row[1]] - 1;\n                        if (flag_merge_width) {\n                            if (range.column[0] !== 0) {\n                                let counts = range.column;\n                                change_width = all_width[counts[1]] - all_width[counts[0] - 1] - (counts[1] - counts[0] + 1);\n                            } else {\n                                change_left = 0;\n                            }\n                            value.v.column = range.column;\n                        }\n                        let flag_merge_height = range.row[0] <= value.v.row[0] && range.row[1] >= value.v.row[1];\n                        if (flag_merge_height) {\n                            if (range.row[0] !== 0) {\n                                let counts = range.row;\n                                change_height = all_height[counts[1]] - all_height[counts[0] - 1] - (counts[1] - counts[0] + 1);\n                            } else {\n                                change_top = 0;\n                            }\n                            value.v.row = range.row;\n                        }\n                    } else {\n                        // 合并取消变成多个单元格时执行\n                        change_width = all_width[count_col[0]] - all_width[count_col[0] - 1] - 1;\n                        if (count_col[0] === 0) {\n                            change_width = all_width[count_col[0]] - 1;\n                        }\n                        change_height = all_height[count_row[0]] - all_height[count_row[0] - 1] - 1;\n                        if (count_row[0] === 0) {\n                            change_height = all_height[count_row[0]] - 1;\n                        }\n                    }\n                }\n                $('#luckysheet-multipleRange-show-' + value.id).css({\n                    'height': change_height,\n                    'width': change_width,\n                    'top': change_top + 'px',\n                    'left': change_left + 'px'\n                });\n                let change_bottom = $('#luckysheet-multipleRange-show-' + value.id)[0].offsetHeight - 1;\n                $('#luckysheet-multipleRange-show-' + value.id + '>.username').css({ 'bottom': change_bottom + 'px' });\n            }\n        });\n    }    //复制选区虚线框\n    //复制选区虚线框\n    function selectionCopyShow(range) {\n        $('#luckysheet-selection-copy').empty();\n        if (range == null) {\n            range = Store.luckysheet_selection_range;\n        }\n        if (range.length > 0) {\n            for (let s = 0; s < range.length; s++) {\n                let r1 = range[s].row[0], r2 = range[s].row[1];\n                let c1 = range[s].column[0], c2 = range[s].column[1];\n                let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                let copyDomHtml = '<div class=\"luckysheet-selection-copy\" style=\"display: block; left: ' + col_pre + 'px; width: ' + (col - col_pre - 1) + 'px; top: ' + row_pre + 'px; height: ' + (row - row_pre - 1) + 'px;\">' + '<div class=\"luckysheet-selection-copy-top luckysheet-copy\"></div>' + '<div class=\"luckysheet-selection-copy-right luckysheet-copy\"></div>' + '<div class=\"luckysheet-selection-copy-bottom luckysheet-copy\"></div>' + '<div class=\"luckysheet-selection-copy-left luckysheet-copy\"></div>' + '<div class=\"luckysheet-selection-copy-hc\"></div>' + '</div>';\n                $('#luckysheet-selection-copy').append(copyDomHtml);\n            }\n        }\n    }    //选区行列数显示\n    //选区行列数显示\n    function luckysheet_count_show(left, top, width, height, rowseleted, columnseleted) {\n        let rowl = rowseleted[1] - rowseleted[0] + 1, coll = columnseleted[1] - columnseleted[0] + 1;\n        let drawWidth = Store.luckysheetTableContentHW[0], drawHeight = Store.luckysheetTableContentHW[1];\n        let scrollWidth = $('#luckysheet-cell-main').scrollLeft(), scrollHeight = $('#luckysheet-cell-main').scrollTop();\n        const _locale = locale();\n        const locale_info = _locale.info;\n        if (rowl >= 4) {\n            let leftv = left - 25;\n            if (leftv < 0) {\n                leftv = left + 5;\n            }\n            if (leftv < scrollWidth) {\n                leftv = scrollWidth + 10;\n            }\n            let topv = top + height / 2;\n            if (height > drawHeight) {\n                topv = scrollHeight + drawHeight / 2;\n            }\n            $('#luckysheet-row-count-show').css({\n                'left': leftv,\n                'top': topv,\n                'display': 'block',\n                'width': '11px'\n            }).html('<div>' + rowl.toString().split('').join('</div><div>') + '</div><div>' + locale_info.row + '</div>');\n        } else {\n            $('#luckysheet-row-count-show').hide();\n        }\n        if (coll >= 4) {\n            let topv = top - 25;\n            if (topv < 0) {\n                topv = top + 5;\n            }\n            if (topv < scrollHeight) {\n                topv = scrollHeight + 10;\n            }\n            let leftv = left + width / 2;\n            if (width > drawWidth) {\n                leftv = scrollWidth + drawWidth / 2;\n            }\n            $('#luckysheet-column-count-show').css({\n                'left': leftv,\n                'top': topv,\n                'display': 'block'\n            }).text(coll + locale_info.column);\n        } else {\n            $('#luckysheet-column-count-show').hide();\n        }\n    }\n    function selectHelpboxFill() {\n        let range = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n        let rf = range['row_focus'], cf = range['column_focus'];\n        if (Store.config['merge'] != null && rf + '_' + cf in Store.config['merge']) {\n            $('#luckysheet-helpbox-cell').text(getRangetxt(Store.currentSheetIndex, {\n                column: [\n                    cf,\n                    cf\n                ],\n                row: [\n                    rf,\n                    rf\n                ]\n            }));\n        } else {\n            $('#luckysheet-helpbox-cell').text(getRangetxt(Store.currentSheetIndex, range));\n        }\n    }\n    return {\n        seletedHighlistByindex,\n        selectHightlightShow,\n        selectIsOverlap,\n        selectionCopyShow,\n        collaborativeEditBox,\n        luckysheet_count_show,\n        selectHelpboxFill\n    };\n});"]}