{"version":3,"sources":["widgets/imageCtrl.js"],"names":["define","imageCtrl_methods","m_location","m_constant","m_protection","m_get","m_set","m_util","Store","locale","mouseposition","modelHTML","checkProtectionAuthorityNormal","getSheetIndex","setluckysheet_scroll_status","replaceHtml","Object","assign","modelHtml","id","imgItem","src","imgItemParam","this","getImgItemParam","width","zoomRatio","height","left","top","position","borderWidth","border","default","crop","offsetLeft","offsetTop","style","color","radius","getSliderHtml","imageText","imageSetting","close","conventional","moveCell1","moveCell2","moveCell3","fixedPos","solid","dashed","dotted","double","sliderHtmlShow","$","remove","sliderHtml","append","images","currentImgId","type","prop","isFixedPos","val","css","attr","init","colorSelectDialog","currenColor","_locale","locale_button","button","locale_toolbar","toolbar","locale_imageCtrl","imageCtrl","show","addclass","title","borderTile","content","borderCur","botton","confirm","cancel","$t","find","end","myh","outerHeight","myw","outerWidth","winw","window","winh","scrollLeft","document","scrollTop","spectrum","showPalette","showPaletteOnly","preferredFormat","clickoutFiresChange","showInitial","showInput","flat","hideAfterPaletteSelect","showSelectionPalette","showButtons","maxPaletteSize","maxSelectionSize","cancelText","chooseText","confirmColor","togglePaletteMoreText","customColor","togglePaletteLessText","collapse","togglePaletteOnly","clearText","noColorSelectedText","localStorageKey","gridKey","palette","move","toHexString","_this","click","hide","off","on","configChange","value","checked","valueAsNumber","$parent","parents","e","currentSheetIndex","cancelActiveImgItem","item","background-image","background-size","background-position","border-width","border-style","border-color","border-radius","right","bottom","stopPropagation","is","currentWinW","scrollWidth","currentWinH","scrollHeight","offset","moveXY","pageX","pageY","resize","data","mouse","x","y","resizeXY","croppingEnter","croppingExit","cropChange","cropChangeXY","restoreImgItem","removeImgItem","ref","addImgItem","img","originHeight","originWidth","Math","round","extend","fixedLeft","rowHeaderWidth","fixedTop","infobarHeight","toolbarHeight","calculatebarHeight","columnHeaderHeight","generateRandomId","moveImgItem","obj","resizeImgItem","scaleX","clientWidth","scaleY","clientHeight","cropping","cropChangeImgItem","cropChangeObj","copyImgItem","copyImgItemObj","clipboardData","originalEvent","cpdata","setData","textarea","html","focus","select","execCommand","setTimeout","blur","pasteImgItem","rowIndex","luckysheet_select_save","row_focus","colIndex","column_focus","visibledatacolumn","visibledatarow","allImagesShow","empty","imgId"],"mappings":"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","file":"../../widgets/imageCtrl.js","sourcesContent":["define([\n    '../methods/imageCtrl_methods',\n    '../methods/location',\n    './constant',\n    '../methods/protection_methods',\n    '../methods/get',\n    '../methods/set',\n    '../utils/util',\n    '../store',\n    '../locale/locale'\n], function (imageCtrl_methods,m_location, m_constant, m_protection, m_get, m_set, m_util, Store, locale) {\n    'use strict';\n    const {mouseposition} = m_location;\n    const {modelHTML} = m_constant;\n    const {checkProtectionAuthorityNormal} = m_protection;\n    const {getSheetIndex} = m_get;\n    const {setluckysheet_scroll_status} = m_set;\n    const {replaceHtml} = m_util;\n    const imageCtrl = Object.assign(imageCtrl_methods, {\n        modelHtml: function (id, imgItem) {\n            let _this = this;\n            let src = imgItem.src;\n            let imgItemParam = _this.getImgItemParam(imgItem);\n            let width = imgItemParam.width * Store.zoomRatio;\n            let height = imgItemParam.height * Store.zoomRatio;\n            let left = imgItemParam.left * Store.zoomRatio;\n            let top = imgItemParam.top * Store.zoomRatio;\n            let position = imgItemParam.position;\n            let borderWidth = imgItem.border.width;\n            return `<div id=\"${ id }\" class=\"luckysheet-modal-dialog luckysheet-modal-dialog-image\" style=\"width:${ width }px;height:${ height }px;padding:0;position:${ position };left:${ left }px;top:${ top }px;z-index:200;\">\n                    <div class=\"luckysheet-modal-dialog-content\" style=\"width:100%;height:100%;overflow:hidden;position:relative;\">\n                        <img src=\"${ src }\" style=\"position:absolute;width:${ imgItem.default.width * Store.zoomRatio }px;height:${ imgItem.default.height * Store.zoomRatio }px;left:${ -imgItem.crop.offsetLeft * Store.zoomRatio }px;top:${ -imgItem.crop.offsetTop * Store.zoomRatio }px;\" />\n                    </div>\n                    <div class=\"luckysheet-modal-dialog-border\" style=\"border:${ borderWidth }px ${ imgItem.border.style } ${ imgItem.border.color };border-radius:${ imgItem.border.radius * Store.zoomRatio }px;position:absolute;left:${ -borderWidth }px;right:${ -borderWidth }px;top:${ -borderWidth }px;bottom:${ -borderWidth }px;\"></div>\n                </div>`;\n        },\n        getSliderHtml: function () {\n            let imageText = locale().imageText;\n            return `<div id=\"luckysheet-modal-dialog-slider-imageCtrl\" class=\"luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-imageCtrl\" style=\"display:block;\">\n                    <div class=\"luckysheet-modal-dialog-slider-title\">\n                        <span>${ imageText.imageSetting }</span>\n                        <span class=\"luckysheet-model-close-btn\" title=\"${ imageText.close }\">\n                            <i class=\"fa fa-times\" aria-hidden=\"true\"></i>\n                        </span>\n                    </div>\n                    <div class=\"luckysheet-modal-dialog-slider-content\">\n                        <div class=\"slider-box\">\n                            <div class=\"slider-box-title\">${ imageText.conventional }</div>\n                            <div class=\"slider-box-radios\">\n                                <div class=\"radio-item\">\n                                    <input type=\"radio\" id=\"imgItemType1\" name=\"imgItemType\" value=\"1\">\n                                    <label for=\"imgItemType1\">${ imageText.moveCell1 }</label>\n                                </div>\n                                <div class=\"radio-item\">\n                                    <input type=\"radio\" id=\"imgItemType2\" name=\"imgItemType\" value=\"2\">\n                                    <label for=\"imgItemType2\">${ imageText.moveCell2 }</label>\n                                </div>\n                                <div class=\"radio-item\">\n                                    <input type=\"radio\" id=\"imgItemType3\" name=\"imgItemType\" value=\"3\">\n                                    <label for=\"imgItemType3\">${ imageText.moveCell3 }</label>\n                                </div>\n                            </div>\n                            <div class=\"slider-box-checkbox\">\n                                <input type=\"checkbox\" id=\"imgItemIsFixedPos\">\n                                <label for=\"imgItemIsFixedPos\">${ imageText.fixedPos }</label>\n                            </div>\n                        </div>\n                        <div class=\"slider-box\">\n                            <div class=\"slider-box-title\">${ imageText.border }</div>\n                            <div class=\"slider-box-borderConfig\">\n                                <div class=\"border-item\">\n                                    <label>${ imageText.width }</label>\n                                    <input type=\"number\" id=\"imgItemBorderWidth\" min=\"0\">\n                                </div>\n                                <div class=\"border-item\">\n                                    <label>${ imageText.radius }</label>\n                                    <input type=\"number\" id=\"imgItemBorderRadius\" min=\"0\">\n                                </div>\n                                <div class=\"border-item\">\n                                    <label>${ imageText.style }</label>\n                                    <select id=\"imgItemBorderStyle\">\n                                        <option value=\"solid\">${ imageText.solid }</option>\n                                        <option value=\"dashed\">${ imageText.dashed }</option>\n                                        <option value=\"dotted\">${ imageText.dotted }</option>\n                                        <option value=\"double\">${ imageText.double }</option>\n                                    </select>\n                                </div>\n                                <div class=\"border-item\">\n                                    <label>${ imageText.color }</label>\n                                    <div id=\"imgItemBorderColor\" class=\"imgItemBorderColor\">\n                                        <span></span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>`;\n        },\n        sliderHtmlShow: function () {\n            let _this = this;\n            $('#luckysheet-modal-dialog-slider-imageCtrl').remove();\n            let sliderHtml = _this.getSliderHtml();\n            $('body').append(sliderHtml);\n            ///luckysheetsizeauto(); //TODO: lwf\n            let imgItem = _this.images[_this.currentImgId];    //类型\n            //类型\n            let type = imgItem.type;\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemType' + type).prop('checked', true);    //固定位置\n            //固定位置\n            let isFixedPos = imgItem.isFixedPos;\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemIsFixedPos').prop('checked', isFixedPos);    //边框宽度\n            //边框宽度\n            let border = imgItem.border;\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderWidth').val(border.width);\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderRadius').val(border.radius);\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderStyle').val(border.style);\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span').css('background-color', border.color).attr('title', border.color);\n            _this.init();\n        },\n        colorSelectDialog: function (currenColor) {\n            const _locale = locale();\n            const locale_button = _locale.button;\n            const locale_toolbar = _locale.toolbar;\n            const locale_imageCtrl = _locale.imageCtrl;\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-imageCtrl-colorSelect-dialog').remove();\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-imageCtrl-colorSelect-dialog',\n                'addclass': 'luckysheet-imageCtrl-colorSelect-dialog',\n                'title': locale_imageCtrl.borderTile,\n                'content': `<div class=\"currenColor\">\n                            ${ locale_imageCtrl.borderCur }:<span title=\"${ currenColor }\" style=\"background-color:${ currenColor }\"></span>\n                        </div>\n                        <div class=\"colorshowbox\"></div>`,\n                'botton': `<button id=\"luckysheet-imageCtrl-colorSelect-dialog-confirm\" class=\"btn btn-primary\">${ locale_button.confirm }</button>\n                        <button class=\"btn btn-default luckysheet-model-close-btn\">${ locale_button.cancel }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-imageCtrl-colorSelect-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-imageCtrl-colorSelect-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();    //初始化选择颜色插件\n            //初始化选择颜色插件\n            $('#luckysheet-imageCtrl-colorSelect-dialog').find('.colorshowbox').spectrum({\n                showPalette: true,\n                showPaletteOnly: true,\n                preferredFormat: 'hex',\n                clickoutFiresChange: false,\n                showInitial: true,\n                showInput: true,\n                flat: true,\n                hideAfterPaletteSelect: true,\n                showSelectionPalette: true,\n                showButtons: false,\n                //隐藏选择取消按钮\n                maxPaletteSize: 8,\n                maxSelectionSize: 8,\n                color: currenColor,\n                cancelText: locale_button.cancel,\n                chooseText: locale_toolbar.confirmColor,\n                togglePaletteMoreText: locale_toolbar.customColor,\n                togglePaletteLessText: locale_toolbar.collapse,\n                togglePaletteOnly: true,\n                clearText: locale_toolbar.clearText,\n                noColorSelectedText: locale_toolbar.noColorSelectedText,\n                localStorageKey: 'spectrum.textcolor' + Store.gridKey,\n                palette: [\n                    [\n                        '#000',\n                        '#444',\n                        '#666',\n                        '#999',\n                        '#ccc',\n                        '#eee',\n                        '#f3f3f3',\n                        '#fff'\n                    ],\n                    [\n                        '#f00',\n                        '#f90',\n                        '#ff0',\n                        '#0f0',\n                        '#0ff',\n                        '#00f',\n                        '#90f',\n                        '#f0f'\n                    ],\n                    [\n                        '#f4cccc',\n                        '#fce5cd',\n                        '#fff2cc',\n                        '#d9ead3',\n                        '#d0e0e3',\n                        '#cfe2f3',\n                        '#d9d2e9',\n                        '#ead1dc'\n                    ],\n                    [\n                        '#ea9999',\n                        '#f9cb9c',\n                        '#ffe599',\n                        '#b6d7a8',\n                        '#a2c4c9',\n                        '#9fc5e8',\n                        '#b4a7d6',\n                        '#d5a6bd'\n                    ],\n                    [\n                        '#e06666',\n                        '#f6b26b',\n                        '#ffd966',\n                        '#93c47d',\n                        '#76a5af',\n                        '#6fa8dc',\n                        '#8e7cc3',\n                        '#c27ba0'\n                    ],\n                    [\n                        '#c00',\n                        '#e69138',\n                        '#f1c232',\n                        '#6aa84f',\n                        '#45818e',\n                        '#3d85c6',\n                        '#674ea7',\n                        '#a64d79'\n                    ],\n                    [\n                        '#900',\n                        '#b45f06',\n                        '#bf9000',\n                        '#38761d',\n                        '#134f5c',\n                        '#0b5394',\n                        '#351c75',\n                        '#741b47'\n                    ],\n                    [\n                        '#600',\n                        '#783f04',\n                        '#7f6000',\n                        '#274e13',\n                        '#0c343d',\n                        '#073763',\n                        '#20124d',\n                        '#4c1130'\n                    ]\n                ],\n                move: function (color) {\n                    if (color != null) {\n                        color = color.toHexString();\n                    } else {\n                        color = '#000';\n                    }\n                    $('#luckysheet-imageCtrl-colorSelect-dialog .currenColor span').css('background-color', color).attr('title', color);\n                }\n            });\n        },\n        init: function () {\n            let _this = this;    //关闭\n            //关闭\n            $('#luckysheet-modal-dialog-slider-imageCtrl .luckysheet-model-close-btn').click(function () {\n                $('#luckysheet-modal-dialog-slider-imageCtrl').hide();\n                ///luckysheetsizeauto(); // TODO: lwf\n            });    //常规\n            //常规\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('change.radio').on('change.radio', '.radio-item input[type=radio][name=imgItemType]', function () {\n                _this.configChange('type', this.value);\n            });    //固定位置\n            //固定位置\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('change.checkbox').on('change.checkbox', '.slider-box-checkbox input[type=checkbox]', function () {\n                _this.configChange('fixedPos', this.checked);\n            });    //边框宽度\n            //边框宽度\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('change.borderWidth').on('change.borderWidth', '#imgItemBorderWidth', function () {\n                _this.configChange('border-width', this.valueAsNumber);\n            });    //边框半径\n            //边框半径\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('change.borderRadius').on('change.borderRadius', '#imgItemBorderRadius', function () {\n                _this.configChange('border-radius', this.valueAsNumber);\n            });    //边框样式\n            //边框样式\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('change.borderStyle').on('change.borderStyle', '#imgItemBorderStyle', function () {\n                _this.configChange('border-style', this.value);\n            });    //边框颜色 选择\n            //边框颜色 选择\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('click.color').on('click.color', '#imgItemBorderColor', function () {\n                let currenColor = $(this).find('span').attr('title');\n                _this.colorSelectDialog(currenColor);\n            });    //边框选择颜色 确定 \n            //边框选择颜色 确定 \n            $(document).off('click.selectColorConfirm').on('click.selectColorConfirm', '#luckysheet-imageCtrl-colorSelect-dialog-confirm', function () {\n                let $parent = $(this).parents('#luckysheet-imageCtrl-colorSelect-dialog');\n                $('#luckysheet-modal-dialog-mask').hide();\n                $parent.hide();\n                let currenColor = $parent.find('.currenColor span').attr('title');\n                $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span').css('background-color', currenColor).attr('title', currenColor);\n                _this.configChange('border-color', currenColor);\n            });    //image active\n            //image active\n            $('#luckysheet-image-showBoxs').off('mousedown.active').on('mousedown.active', '.luckysheet-modal-dialog-image', function (e) {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects', false)) {\n                    return;\n                }\n                $(this).hide();\n                let id = $(this).attr('id');\n                if (_this.currentImgId != null && _this.currentImgId != id) {\n                    _this.cancelActiveImgItem();\n                }\n                _this.currentImgId = id;\n                let item = _this.images[id];\n                let imgItemParam = _this.getImgItemParam(item);\n                let width = imgItemParam.width * Store.zoomRatio;\n                let height = imgItemParam.height * Store.zoomRatio;\n                let left = imgItemParam.left * Store.zoomRatio;\n                let top = imgItemParam.top * Store.zoomRatio;\n                let position = imgItemParam.position;\n                $('#luckysheet-modal-dialog-activeImage').show().css({\n                    'width': width,\n                    'height': height,\n                    'left': left,\n                    'top': top,\n                    'position': position\n                });\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content').css({\n                    'background-image': 'url(' + item.src + ')',\n                    'background-size': item.default.width * Store.zoomRatio + 'px ' + item.default.height * Store.zoomRatio + 'px',\n                    'background-position': -item.crop.offsetLeft * Store.zoomRatio + 'px ' + -item.crop.offsetTop * Store.zoomRatio + 'px'\n                });\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border').css({\n                    'border-width': item.border.width * Store.zoomRatio,\n                    'border-style': item.border.style,\n                    'border-color': item.border.color,\n                    'border-radius': item.border.radius * Store.zoomRatio,\n                    'left': -item.border.width * Store.zoomRatio,\n                    'right': -item.border.width * Store.zoomRatio,\n                    'top': -item.border.width * Store.zoomRatio,\n                    'bottom': -item.border.width * Store.zoomRatio\n                });\n                _this.sliderHtmlShow();\n                e.stopPropagation();\n            });    //image move\n            //image move\n            $('#luckysheet-modal-dialog-activeImage').off('mousedown.move').on('mousedown.move', '.luckysheet-modal-dialog-content', function (e) {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects', false)) {\n                    return;\n                }\n                if (!$('#luckysheet-modal-dialog-slider-imageCtrl').is(':visible')) {\n                    _this.sliderHtmlShow();\n                }\n                _this.move = true;\n                _this.currentWinW = $('#luckysheet-cell-main')[0].scrollWidth;\n                _this.currentWinH = $('#luckysheet-cell-main')[0].scrollHeight;\n                let offset = $('#luckysheet-modal-dialog-activeImage').offset();\n                _this.moveXY = [\n                    e.pageX - offset.left,\n                    e.pageY - offset.top\n                ];\n                setluckysheet_scroll_status(true);\n                e.stopPropagation();\n            });    //image resize\n            //image resize\n            $('#luckysheet-modal-dialog-activeImage').off('mousedown.resize').on('mousedown.resize', '.luckysheet-modal-dialog-resize-item', function (e) {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects', false)) {\n                    return;\n                }\n                _this.currentWinW = $('#luckysheet-cell-main')[0].scrollWidth;\n                _this.currentWinH = $('#luckysheet-cell-main')[0].scrollHeight;\n                _this.resize = $(this).data('type');\n                let scrollTop = $('#luckysheet-cell-main').scrollTop(), scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let mouse = mouseposition(e.pageX, e.pageY);\n                let x = mouse[0] + scrollLeft;\n                let y = mouse[1] + scrollTop;\n                let position = $('#luckysheet-modal-dialog-activeImage').position();\n                let width = $('#luckysheet-modal-dialog-activeImage').width();\n                let height = $('#luckysheet-modal-dialog-activeImage').height();\n                _this.resizeXY = [\n                    x,\n                    y,\n                    width,\n                    height,\n                    position.left + scrollLeft,\n                    position.top + scrollTop,\n                    scrollLeft,\n                    scrollTop\n                ];\n                setluckysheet_scroll_status(true);\n                e.stopPropagation();\n            });    //image croppingEnter\n            //image croppingEnter\n            $('#luckysheet-modal-dialog-activeImage').off('mousedown.croppingEnter').on('mousedown.croppingEnter', '.luckysheet-modal-controll-crop', function (e) {\n                _this.croppingEnter();\n                e.stopPropagation();\n            });    //image croppingExit\n            //image croppingExit\n            $('#luckysheet-modal-dialog-cropping').off('mousedown.croppingExit').on('mousedown.croppingExit', '.luckysheet-modal-controll-crop', function (e) {\n                _this.croppingExit();\n                e.stopPropagation();\n            });    //image crop change\n            //image crop change\n            $('#luckysheet-modal-dialog-cropping').off('mousedown.cropChange').on('mousedown.cropChange', '.resize-item', function (e) {\n                _this.cropChange = $(this).data('type');\n                let scrollTop = $('#luckysheet-cell-main').scrollTop(), scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let mouse = mouseposition(e.pageX, e.pageY);\n                let x = mouse[0] + scrollLeft;\n                let y = mouse[1] + scrollTop;\n                _this.cropChangeXY = [\n                    x,\n                    y\n                ];\n                setluckysheet_scroll_status(true);\n                e.stopPropagation();\n            });    //image restore\n            //image restore\n            $('#luckysheet-image-showBoxs').off('mousedown.restore').on('mousedown.restore', '.luckysheet-modal-controll-restore', function (e) {\n                _this.restoreImgItem();\n                e.stopPropagation();\n            });    //image delete\n            //image delete\n            $('#luckysheet-image-showBoxs').off('mousedown.delete').on('mousedown.delete', '.luckysheet-modal-controll-del', function (e) {\n                _this.removeImgItem();\n                e.stopPropagation();\n            });\n        },\n        configChange: function (type, value) {\n            let _this = this;\n            let imgItem = _this.images[_this.currentImgId];\n            switch (type) {\n            case 'type':\n                imgItem.type = value;\n                break;\n            case 'fixedPos':\n                imgItem.isFixedPos = value;\n                let imgItemParam = _this.getImgItemParam(imgItem);\n                let width = imgItemParam.width;\n                let height = imgItemParam.height;\n                let left = imgItemParam.left;\n                let top = imgItemParam.top;\n                let position = imgItemParam.position;\n                $('#luckysheet-modal-dialog-activeImage').show().css({\n                    'width': width,\n                    'height': height,\n                    'left': left,\n                    'top': top,\n                    'position': position\n                });\n                break;\n            case 'border-width':\n                imgItem.border.width = value;\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border').css({\n                    'border-width': value,\n                    'left': -value,\n                    'right': -value,\n                    'top': -value,\n                    'bottom': -value\n                });\n                break;\n            case 'border-radius':\n                imgItem.border.radius = value;\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border').css('border-radius', value);\n                break;\n            case 'border-style':\n                imgItem.border.style = value;\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border').css('border-style', value);\n                break;\n            case 'border-color':\n                imgItem.border.color = value;\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border').css('border-color', value);\n                break;\n            }\n            _this.ref();\n        },\n\n        cancelActiveImgItem: function () {\n            let _this = this;\n            $('#luckysheet-modal-dialog-activeImage').hide();\n            $('#luckysheet-modal-dialog-cropping').hide();\n            $('#luckysheet-modal-dialog-slider-imageCtrl').hide();\n            let imgItem = _this.images[_this.currentImgId];\n            let imgItemParam = _this.getImgItemParam(imgItem);\n            let width = imgItemParam.width * Store.zoomRatio;\n            let height = imgItemParam.height * Store.zoomRatio;\n            let left = imgItemParam.left * Store.zoomRatio;\n            let top = imgItemParam.top * Store.zoomRatio;\n            let position = imgItemParam.position;\n            $('#' + _this.currentImgId).show().css({\n                'width': width,\n                'height': height,\n                'left': left,\n                'top': top,\n                'position': position\n            });\n            $('#' + _this.currentImgId + ' img').css({\n                'width': imgItem.default.width * Store.zoomRatio,\n                'height': imgItem.default.height * Store.zoomRatio,\n                'left': -imgItem.crop.offsetLeft * Store.zoomRatio,\n                'top': -imgItem.crop.offsetTop * Store.zoomRatio\n            });\n            $('#' + _this.currentImgId + ' .luckysheet-modal-dialog-border').css({\n                'border-width': imgItem.border.width * Store.zoomRatio,\n                'border-style': imgItem.border.style,\n                'border-color': imgItem.border.color,\n                'border-radius': imgItem.border.radius * Store.zoomRatio,\n                'left': -imgItem.border.width * Store.zoomRatio,\n                'right': -imgItem.border.width * Store.zoomRatio,\n                'top': -imgItem.border.width * Store.zoomRatio,\n                'bottom': -imgItem.border.width * Store.zoomRatio\n            });\n            _this.currentImgId = null;\n        },\n        addImgItem: function (img) {\n            let _this = this;\n            let width, height;\n            let max = 400;\n            if (img.originHeight < img.originWidth) {\n                height = Math.round(img.originHeight * (max / img.originWidth));\n                width = max;\n            } else {\n                width = Math.round(img.originWidth * (max / img.originHeight));\n                height = max;\n            }\n            if (_this.images == null) {\n                _this.images = {};\n            }\n            let imgItem = $.extend(true, {}, _this.imgItem);\n            imgItem.src = img.src;\n            imgItem.originWidth = img.originWidth;\n            imgItem.originHeight = img.originHeight;\n            imgItem.default.width = width;\n            imgItem.default.height = height;\n            imgItem.default.left = img.left;\n            imgItem.default.top = img.top;\n            imgItem.crop.width = width;\n            imgItem.crop.height = height;\n            let scrollTop = $('#luckysheet-cell-main').scrollTop(), scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            imgItem.fixedLeft = img.left - scrollLeft + Store.rowHeaderWidth;\n            imgItem.fixedTop = img.top - scrollTop + Store.infobarHeight + Store.toolbarHeight + Store.calculatebarHeight + Store.columnHeaderHeight;\n            let id = _this.generateRandomId();\n            let modelHtml = _this.modelHtml(id, imgItem);\n            $('#luckysheet-image-showBoxs .img-list').append(modelHtml);\n            _this.images[id] = imgItem;\n            _this.ref();\n            _this.init();\n        },\n        moveImgItem: function () {\n            let _this = this;\n            _this.move = false;\n            let obj = $('#luckysheet-modal-dialog-activeImage')[0];\n            let item = _this.images[_this.currentImgId];\n            if (item.isFixedPos) {\n                item.fixedLeft = obj.offsetLeft - item.crop.offsetLeft;\n                item.fixedTop = obj.offsetTop - item.crop.offsetTop;\n            } else {\n                item.default.left = obj.offsetLeft - item.crop.offsetLeft;\n                item.default.top = obj.offsetTop - item.crop.offsetTop;\n            }\n            _this.ref();\n        },\n        resizeImgItem: function () {\n            let _this = this;\n            _this.resize = null;\n            let obj = $('#luckysheet-modal-dialog-activeImage')[0];\n            let item = _this.images[_this.currentImgId];\n            let scaleX = obj.clientWidth / item.crop.width;\n            let scaleY = obj.clientHeight / item.crop.height;\n            item.default.width = Math.round(item.default.width * scaleX);\n            item.default.height = Math.round(item.default.height * scaleY);\n            item.crop.width = Math.round(item.crop.width * scaleX);\n            item.crop.height = Math.round(item.crop.height * scaleY);\n            item.crop.offsetLeft = Math.round(item.crop.offsetLeft * scaleX);\n            item.crop.offsetTop = Math.round(item.crop.offsetTop * scaleY);\n            if (item.isFixedPos) {\n                item.fixedLeft = obj.offsetLeft;\n                item.fixedTop = obj.offsetTop;\n            } else {\n                item.default.left = obj.offsetLeft - item.crop.offsetLeft;\n                item.default.top = obj.offsetTop - item.crop.offsetTop;\n            }\n            _this.ref();\n        },\n        croppingEnter: function () {\n            let _this = this;\n            _this.cropping = true;\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects', false)) {\n                return;\n            }\n            $('#luckysheet-modal-dialog-activeImage').hide();\n            $('#luckysheet-modal-dialog-slider-imageCtrl').hide();\n            let item = _this.images[_this.currentImgId];\n            let imgItemParam = _this.getImgItemParam(item);\n            let width = imgItemParam.width;\n            let height = imgItemParam.height;\n            let left = imgItemParam.left;\n            let top = imgItemParam.top;\n            let position = imgItemParam.position;\n            $('#luckysheet-modal-dialog-cropping').show().css({\n                'width': width,\n                'height': height,\n                'left': left,\n                'top': top,\n                'position': position\n            });\n            $('#luckysheet-modal-dialog-cropping .cropping-mask').css({\n                'width': item.default.width,\n                'height': item.default.height,\n                'background-image': 'url(' + item.src + ')',\n                'left': -item.crop.offsetLeft,\n                'top': -item.crop.offsetTop\n            });\n            $('#luckysheet-modal-dialog-cropping .cropping-content').css({\n                'background-image': 'url(' + item.src + ')',\n                'background-size': item.default.width + 'px ' + item.default.height + 'px',\n                'background-position': -item.crop.offsetLeft + 'px ' + -item.crop.offsetTop + 'px'\n            });\n            $('#luckysheet-modal-dialog-cropping .luckysheet-modal-dialog-border').css({\n                'border-width': item.border.width,\n                'border-style': item.border.style,\n                'border-color': item.border.color,\n                'border-radius': item.border.radius,\n                'left': -item.border.width,\n                'right': -item.border.width,\n                'top': -item.border.width,\n                'bottom': -item.border.width\n            });\n        },\n        croppingExit: function () {\n            let _this = this;\n            _this.cropping = false;\n            $('#luckysheet-modal-dialog-cropping').hide();\n            let item = _this.images[_this.currentImgId];\n            let imgItemParam = _this.getImgItemParam(item);\n            let width = imgItemParam.width;\n            let height = imgItemParam.height;\n            let left = imgItemParam.left;\n            let top = imgItemParam.top;\n            let position = imgItemParam.position;\n            $('#luckysheet-modal-dialog-activeImage').show().css({\n                'width': width,\n                'height': height,\n                'left': left,\n                'top': top,\n                'position': position\n            });\n            $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content').css({\n                'background-image': 'url(' + item.src + ')',\n                'background-size': item.default.width + 'px ' + item.default.height + 'px',\n                'background-position': -item.crop.offsetLeft + 'px ' + -item.crop.offsetTop + 'px'\n            });\n        },\n        cropChangeImgItem: function () {\n            let _this = this;\n            _this.cropChange = null;\n            let item = _this.images[_this.currentImgId];\n            item.crop.width = _this.cropChangeObj.width;\n            item.crop.height = _this.cropChangeObj.height;\n            item.crop.offsetLeft = _this.cropChangeObj.offsetLeft;\n            item.crop.offsetTop = _this.cropChangeObj.offsetTop;\n            _this.ref();\n        },\n        restoreImgItem: function () {\n            let _this = this;\n            let imgItem = _this.images[_this.currentImgId];\n            imgItem.default.width = imgItem.originWidth;\n            imgItem.default.height = imgItem.originHeight;\n            imgItem.crop.width = imgItem.originWidth;\n            imgItem.crop.height = imgItem.originHeight;\n            imgItem.crop.offsetLeft = 0;\n            imgItem.crop.offsetTop = 0;\n            let imgItemParam = _this.getImgItemParam(imgItem);\n            let width = imgItemParam.width;\n            let height = imgItemParam.height;\n            let left = imgItemParam.left;\n            let top = imgItemParam.top;\n            let position = imgItemParam.position;\n            $('#luckysheet-modal-dialog-activeImage').show().css({\n                'width': width,\n                'height': height,\n                'left': left,\n                'top': top,\n                'position': position\n            });\n            $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content').css({\n                'background-image': 'url(' + imgItem.src + ')',\n                'background-size': imgItem.default.width + 'px ' + imgItem.default.height + 'px',\n                'background-position': -imgItem.crop.offsetLeft + 'px ' + -imgItem.crop.offsetTop + 'px'\n            });\n            _this.ref();\n        },\n        removeImgItem: function () {\n            let _this = this;\n            $('#luckysheet-modal-dialog-activeImage').hide();\n            $('#luckysheet-modal-dialog-cropping').hide();\n            $('#luckysheet-modal-dialog-slider-imageCtrl').hide();\n            $('#' + _this.currentImgId).remove();\n            delete _this.images[_this.currentImgId];\n            _this.currentImgId = null;\n            _this.ref();\n        },\n        copyImgItem: function (e) {\n            let _this = this;\n            _this.copyImgItemObj = $.extend(true, {}, _this.images[_this.currentImgId]);\n            let clipboardData = window.clipboardData;    //for IE\n            //for IE\n            if (!clipboardData) {\n                // for chrome\n                clipboardData = e.originalEvent.clipboardData;\n            }\n            let cpdata = '<table data-type=\"luckysheet_copy_action_image\"><tr><td><td></tr></table>';\n            if (!clipboardData) {\n                let textarea = $('#luckysheet-copy-content');\n                textarea.html(cpdata);\n                textarea.focus();\n                textarea.select();\n                document.execCommand('selectAll');\n                document.execCommand('Copy');    // 等50毫秒，keyPress事件发生了再去处理数据\n                // 等50毫秒，keyPress事件发生了再去处理数据\n                setTimeout(function () {\n                    $('#luckysheet-copy-content').blur();\n                }, 10);\n            } else {\n                clipboardData.setData('Text', cpdata);\n                return false;    //否则设不生效\n            }\n        },\n        //否则设不生效\n        pasteImgItem: function () {\n            let _this = this;\n            let rowIndex = Store.luckysheet_select_save[0].row_focus || 0;\n            let colIndex = Store.luckysheet_select_save[0].column_focus || 0;\n            let left = colIndex == 0 ? 0 : Store.visibledatacolumn[colIndex - 1];\n            let top = rowIndex == 0 ? 0 : Store.visibledatarow[rowIndex - 1];\n            let img = $.extend(true, {}, _this.copyImgItemObj);\n            img.default.left = left - img.crop.offsetLeft;\n            img.default.top = top - img.crop.offsetTop;\n            let scrollTop = $('#luckysheet-cell-main').scrollTop(), scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            img.fixedLeft = img.default.left - scrollLeft + Store.rowHeaderWidth;\n            img.fixedTop = img.default.top - scrollTop + Store.infobarHeight + Store.toolbarHeight + Store.calculatebarHeight + Store.columnHeaderHeight;\n            let id = _this.generateRandomId();\n            let modelHtml = _this.modelHtml(id, img);\n            $('#luckysheet-image-showBoxs .img-list').append(modelHtml);\n            _this.images[id] = img;\n            _this.ref();\n            _this.init();\n        },\n        allImagesShow: function () {\n            let _this = this;\n            $('#luckysheet-modal-dialog-activeImage').hide();\n            $('#luckysheet-modal-dialog-cropping').hide();\n            $('#luckysheet-modal-dialog-slider-imageCtrl').hide();\n            $('#luckysheet-image-showBoxs .img-list').empty();\n            if (_this.images == null) {\n                return;\n            }\n            for (let imgId in _this.images) {\n                let imgItem = _this.images[imgId];\n                let modelHtml = _this.modelHtml(imgId, imgItem);\n                $('#luckysheet-image-showBoxs .img-list').append(modelHtml);\n            }\n        }\n\n    });\n    return imageCtrl;\n});"]}