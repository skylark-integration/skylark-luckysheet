{"version":3,"sources":["widgets/hyperlinkCtrl.js"],"names":["define","m_util","m_getdata","m_location","formula","tooltip","m_constant","m_select","cells","m_get","locale","Store","replaceHtml","getcellvalue","rowLocation","colLocation","mouseposition","modelHTML","selectHightlightShow","getSheetIndex","item","linkType","linkAddress","linkTooltip","hyperlink","createDialog","_locale","hyperlinkText","insertLink","toolbarText","toolbar","buttonText","button","$","show","remove","sheetListOption","luckysheetfile","forEach","name","content","linkText","external","internal","placeholder1","linkSheet","linkCell","placeholder2","placeholder3","append","id","addclass","title","botton","confirm","cancel","style","$t","find","css","end","myh","outerHeight","myw","outerWidth","winw","window","width","winh","height","scrollLeft","document","scrollTop","left","top","this","dataAllocation","init","_this","off","on","e","value","hide","last","luckysheet_select_save","length","rowIndex","row_focus","row","colIndex","column_focus","column","val","test","info","tooltipInfo1","iscelldata","tooltipInfo2","replace","historyHyperlink","extend","currentHyperlink","d","deepCopyFlowData","flowdata","cell","fc","un","v","ref","currentSheetIndex","text","sheettxt","split","rangetxt","cellFocus","r","c","open","cellrange","getcellrange","sheetIndex","range","removeClass","addClass","changeSheet","row_pre","visibledatarow","col_pre","visibledatacolumn","overshow","event","target","closest","mouse","pageX","pageY","x","y","freezenverticaldata","freezenhorizontaldata","row_index","col_index","margeset","mergeborer","col","html","appendTo","clearjfundo","jfundo","redo","type","jfredo","push","webWorkerFlowDataCache","data","allowUpdate","saveParam","k","historyParam","refresh"],"mappings":"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","file":"../../widgets/hyperlinkCtrl.js","sourcesContent":["define([\n    '../utils/util',\n    '../methods/getdata',\n    '../methods/location',\n    '../methods/formula_methods',\n    './tooltip',\n    './constant',\n    './select',\n    '../methods/cells',\n    '../methods/get',\n    '../locale/locale',\n    '../store'\n], function (m_util, m_getdata,  m_location, formula, tooltip, m_constant, m_select, cells, m_get, locale, Store) {\n    'use strict';\n    const {replaceHtml} = m_util;\n    const {getcellvalue} = m_getdata;\n    const {rowLocation, colLocation, mouseposition} = m_location;\n    const {modelHTML} = m_constant;\n    const {selectHightlightShow} = m_select;\n    const {getSheetIndex} = m_get;\n    const hyperlinkCtrl = {\n        item: {\n            linkType: 'external',\n            //链接类型 external外部链接，internal内部链接\n            linkAddress: '',\n            //链接地址 网页地址或工作表单元格引用\n            linkTooltip: ''\n        },\n        //提示\n        hyperlink: null,\n        createDialog: function () {\n            let _this = this;\n            const _locale = locale();\n            const hyperlinkText = _locale.insertLink;\n            const toolbarText = _locale.toolbar;\n            const buttonText = _locale.button;\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-insertLink-dialog').remove();\n            let sheetListOption = '';\n            Store.luckysheetfile.forEach(item => {\n                sheetListOption += `<option value=\"${ item.name }\">${ item.name }</option>`;\n            });\n            let content = `<div class=\"box\">\n                            <div class=\"box-item\">\n                                <label for=\"luckysheet-insertLink-dialog-linkText\">${ hyperlinkText.linkText }：</label>\n                                <input type=\"text\" id=\"luckysheet-insertLink-dialog-linkText\"/>\n                            </div>\n                            <div class=\"box-item\">\n                                <label for=\"luckysheet-insertLink-dialog-linkType\">${ hyperlinkText.linkType }：</label>\n                                <select id=\"luckysheet-insertLink-dialog-linkType\">\n                                    <option value=\"external\">${ hyperlinkText.external }</option>\n                                    <option value=\"internal\">${ hyperlinkText.internal }</option>\n                                </select>\n                            </div>\n                            <div class=\"show-box show-box-external\">\n                                <div class=\"box-item\">\n                                    <label for=\"luckysheet-insertLink-dialog-linkAddress\">${ hyperlinkText.linkAddress }：</label>\n                                    <input type=\"text\" id=\"luckysheet-insertLink-dialog-linkAddress\" placeholder=\"${ hyperlinkText.placeholder1 }\" />\n                                </div>\n                            </div>\n                            <div class=\"show-box show-box-internal\">\n                                <div class=\"box-item\">\n                                    <label for=\"luckysheet-insertLink-dialog-linkSheet\">${ hyperlinkText.linkSheet }：</label>\n                                    <select id=\"luckysheet-insertLink-dialog-linkSheet\">\n                                        ${ sheetListOption }\n                                    </select>\n                                </div>\n                                <div class=\"box-item\">\n                                    <label for=\"luckysheet-insertLink-dialog-linkCell\">${ hyperlinkText.linkCell }：</label>\n                                    <input type=\"text\" id=\"luckysheet-insertLink-dialog-linkCell\" value=\"A1\" placeholder=\"${ hyperlinkText.placeholder2 }\" />\n                                </div>\n                            </div>\n                            <div class=\"box-item\">\n                                <label for=\"luckysheet-insertLink-dialog-linkTooltip\">${ hyperlinkText.linkTooltip }：</label>\n                                <input type=\"text\" id=\"luckysheet-insertLink-dialog-linkTooltip\" placeholder=\"${ hyperlinkText.placeholder3 }\" />\n                            </div>\n                        </div>`;\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-insertLink-dialog',\n                'addclass': 'luckysheet-insertLink-dialog',\n                'title': toolbarText.insertLink,\n                'content': content,\n                'botton': `<button id=\"luckysheet-insertLink-dialog-confirm\" class=\"btn btn-primary\">${ buttonText.confirm }</button>\n                        <button class=\"btn btn-default luckysheet-model-close-btn\">${ buttonText.cancel }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-insertLink-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 350).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-insertLink-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n            _this.dataAllocation();\n        },\n        init: function () {\n            let _this = this;\n            const _locale = locale();\n            const hyperlinkText = _locale.insertLink;    //链接类型\n            //链接类型\n            $(document).off('change.linkType').on('change.linkType', '#luckysheet-insertLink-dialog-linkType', function (e) {\n                let value = this.value;\n                $('#luckysheet-insertLink-dialog .show-box').hide();\n                $('#luckysheet-insertLink-dialog .show-box-' + value).show();\n            });    //确认按钮\n            //确认按钮\n            $(document).off('click.confirm').on('click.confirm', '#luckysheet-insertLink-dialog-confirm', function (e) {\n                let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                let rowIndex = last.row_focus || last.row[0];\n                let colIndex = last.column_focus || last.column[0];    //文本\n                //文本\n                let linkText = $('#luckysheet-insertLink-dialog-linkText').val();\n                let linkType = $('#luckysheet-insertLink-dialog-linkType').val();\n                let linkAddress = $('#luckysheet-insertLink-dialog-linkAddress').val();\n                let linkSheet = $('#luckysheet-insertLink-dialog-linkSheet').val();\n                let linkCell = $('#luckysheet-insertLink-dialog-linkCell').val();\n                let linkTooltip = $('#luckysheet-insertLink-dialog-linkTooltip').val();\n                if (linkType == 'external') {\n                    if (!/^http[s]?:\\/\\//.test(linkAddress)) {\n                        linkAddress = 'https://' + linkAddress;\n                    }\n                    if (!/^http[s]?:\\/\\/([\\w\\-\\.]+)+[\\w-]*([\\w\\-\\.\\/\\?%&=]+)?$/ig.test(linkAddress)) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', hyperlinkText.tooltipInfo1);\n                        return;\n                    }\n                } else {\n                    if (!formula.iscelldata(linkCell)) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', hyperlinkText.tooltipInfo2);\n                        return;\n                    }\n                    linkAddress = linkSheet + '!' + linkCell;\n                }\n                if (linkText == null || linkText.replace(/\\s/g, '') == '') {\n                    linkText = linkAddress;\n                }\n                let item = {\n                    linkType: linkType,\n                    linkAddress: linkAddress,\n                    linkTooltip: linkTooltip\n                };\n                let historyHyperlink = $.extend(true, {}, _this.hyperlink);\n                let currentHyperlink = $.extend(true, {}, _this.hyperlink);\n                currentHyperlink[rowIndex + '_' + colIndex] = item;\n                let d = Store.deepCopyFlowData(Store.flowdata);\n                let cell = d[rowIndex][colIndex];\n                if (cell == null) {\n                    cell = {};\n                }\n                cell.fc = 'rgb(0, 0, 255)';\n                cell.un = 1;\n                cell.v = linkText;\n                d[rowIndex][colIndex] = cell;\n                _this.ref(historyHyperlink, currentHyperlink, Store.currentSheetIndex, d, {\n                    row: [\n                        rowIndex,\n                        rowIndex\n                    ],\n                    column: [\n                        colIndex,\n                        colIndex\n                    ]\n                });\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-insertLink-dialog').hide();\n            });\n        },\n        dataAllocation: function () {\n            let _this = this;\n            let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n            let rowIndex = last.row_focus || last.row[0];\n            let colIndex = last.column_focus || last.column[0];\n            let hyperlink = _this.hyperlink || {};\n            let item = hyperlink[rowIndex + '_' + colIndex] || {};    //文本\n            //文本\n            let text = getcellvalue(rowIndex, colIndex, null, 'm');\n            $('#luckysheet-insertLink-dialog-linkText').val(text);    //链接类型\n            //链接类型\n            let linkType = item.linkType || 'external';\n            $('#luckysheet-insertLink-dialog-linkType').val(linkType);\n            $('#luckysheet-insertLink-dialog .show-box').hide();\n            $('#luckysheet-insertLink-dialog .show-box-' + linkType).show();    //链接地址\n            //链接地址\n            let linkAddress = item.linkAddress || '';\n            if (linkType == 'external') {\n                $('#luckysheet-insertLink-dialog-linkAddress').val(linkAddress);\n            } else {\n                if (formula.iscelldata(linkAddress)) {\n                    let sheettxt = linkAddress.split('!')[0];\n                    let rangetxt = linkAddress.split('!')[1];\n                    $('#luckysheet-insertLink-dialog-linkSheet').val(sheettxt);\n                    $('#luckysheet-insertLink-dialog-linkCell').val(rangetxt);\n                }\n            }    //提示\n            //提示\n            let linkTooltip = item.linkTooltip || '';\n            $('#luckysheet-insertLink-dialog-linkTooltip').val(linkTooltip);\n        },\n        cellFocus: function (r, c) {\n            let _this = this;\n            if (_this.hyperlink == null || _this.hyperlink[r + '_' + c] == null) {\n                return;\n            }\n            let item = _this.hyperlink[r + '_' + c];\n            if (item.linkType == 'external') {\n                window.open(item.linkAddress);\n            } else {\n                let cellrange = formula.getcellrange(item.linkAddress);\n                let sheetIndex = cellrange.sheetIndex;\n                let range = [{\n                        row: cellrange.row,\n                        column: cellrange.column\n                    }];\n                if (sheetIndex != Store.currentSheetIndex) {\n                    $('#luckysheet-sheet-area div.luckysheet-sheets-item').removeClass('luckysheet-sheets-item-active');\n                    $('#luckysheet-sheets-item' + sheetIndex).addClass('luckysheet-sheets-item-active');\n                    Store.changeSheet(sheetIndex);\n                }\n                Store.luckysheet_select_save = range;\n                selectHightlightShow(true);\n                let row_pre = cellrange.row[0] - 1 == -1 ? 0 : Store.visibledatarow[cellrange.row[0] - 1];\n                let col_pre = cellrange.column[0] - 1 == -1 ? 0 : Store.visibledatacolumn[cellrange.column[0] - 1];\n                $('#luckysheet-scrollbar-x').scrollLeft(col_pre);\n                $('#luckysheet-scrollbar-y').scrollTop(row_pre);\n            }\n        },\n        overshow: function (event) {\n            let _this = this;\n            $('#luckysheet-hyperlink-overshow').remove();\n            if ($(event.target).closest('#luckysheet-cell-main').length == 0) {\n                return;\n            }\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let x = mouse[0] + scrollLeft;\n            let y = mouse[1] + scrollTop;\n            if (Store.freezenverticaldata != null && mouse[0] < Store.freezenverticaldata[0] - Store.freezenverticaldata[2]) {\n                return;\n            }\n            if (Store.freezenhorizontaldata != null && mouse[1] < Store.freezenhorizontaldata[0] - Store.freezenhorizontaldata[2]) {\n                return;\n            }\n            let row_index = rowLocation(y)[2];\n            let col_index = colLocation(x)[2];\n            let margeset = cells.mergeborer(Store.flowdata, row_index, col_index);\n            if (!!margeset) {\n                row_index = margeset.row[2];\n                col_index = margeset.column[2];\n            }\n            if (_this.hyperlink == null || _this.hyperlink[row_index + '_' + col_index] == null) {\n                return;\n            }\n            let item = _this.hyperlink[row_index + '_' + col_index];\n            let linkTooltip = item.linkTooltip;\n            if (linkTooltip == null || linkTooltip.replace(/\\s/g, '') == '') {\n                linkTooltip = item.linkAddress;\n            }\n            let row = Store.visibledatarow[row_index], row_pre = row_index - 1 == -1 ? 0 : Store.visibledatarow[row_index - 1];\n            let col = Store.visibledatacolumn[col_index], col_pre = col_index - 1 == -1 ? 0 : Store.visibledatacolumn[col_index - 1];\n            if (!!margeset) {\n                row = margeset.row[1];\n                row_pre = margeset.row[0];\n                col = margeset.column[1];\n                col_pre = margeset.column[0];\n            }\n            let html = `<div id=\"luckysheet-hyperlink-overshow\" style=\"background:#fff;padding:5px 10px;border:1px solid #000;box-shadow:2px 2px #999;position:absolute;left:${ col_pre }px;top:${ row + 5 }px;z-index:100;\">\n                        <div>${ linkTooltip }</div>\n                        <div>单击鼠标可以追踪</div>\n                    </div>`;\n            $(html).appendTo($('#luckysheet-cell-main'));\n        },\n        ref: function (historyHyperlink, currentHyperlink, sheetIndex, d, range) {\n            let _this = this;\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                let redo = {};\n                redo['type'] = 'updateHyperlink';\n                redo['sheetIndex'] = sheetIndex;\n                redo['historyHyperlink'] = historyHyperlink;\n                redo['currentHyperlink'] = currentHyperlink;\n                redo['data'] = Store.flowdata;\n                redo['curData'] = d;\n                redo['range'] = range;\n                Store.jfredo.push(redo);\n            }\n            _this.hyperlink = currentHyperlink;\n            Store.luckysheetfile[getSheetIndex(sheetIndex)].hyperlink = currentHyperlink;\n            Store.flowdata = d;\n            Store.webWorkerFlowDataCache(Store.flowdata);    //worker存数据\n            //worker存数据\n            Store.luckysheetfile[getSheetIndex(sheetIndex)].data = Store.flowdata;    //共享编辑模式\n            //共享编辑模式\n            if (Store.allowUpdate) {\n                Store.saveParam('all', sheetIndex, currentHyperlink, { 'k': 'hyperlink' });\n                Store.historyParam(Store.flowdata, sheetIndex, range);\n            }\n            ///setTimeout(function () {\n            ///    luckysheetrefreshgrid();\n            ///}, 1);\n            Store.refresh();\n        }\n    };\n    return hyperlinkCtrl;\n});"]}