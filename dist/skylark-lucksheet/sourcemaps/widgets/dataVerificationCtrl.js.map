{"version":3,"sources":["widgets/dataVerificationCtrl.js"],"names":["define","m_dataVerificationCtrl_methods","m_util","formula","m_validate","m_datecontroll","tooltip","m_setdata","m_getdata","m_constant","m_select","cells","m_get","locale","Store","replaceHtml","isRealNum","isRealNull","isdatetime","diff","setcellvalue","getcellvalue","modelHTML","selectionCopyShow","getSheetIndex","getRangetxt","Object","assign","createDialog","_locale","dvText","dataVerification","toolbarText","toolbar","buttonText","button","$","show","remove","content","cellRange","selectCellRange","verificationCondition","dropdown","checkbox","number","number_integer","number_decimal","text_content","text_length","date","validity","placeholder1","selected","placeholder2","notSelected","between","notBetween","equal","notEqualTo","moreThanThe","lessThan","greaterOrEqualTo","lessThanOrEqualTo","placeholder3","include","exclude","placeholder4","earlierThan","noEarlierThan","laterThan","noLaterThan","identificationNumber","phoneNumber","remote","prohibitInput","hintShow","placeholder5","append","id","addclass","title","botton","confirm","deleteVerification","cancel","style","$t","find","css","end","myh","outerHeight","myw","outerWidth","winw","window","width","winh","height","scrollLeft","document","scrollTop","left","top","this","dataAllocation","init","_this","off","on","e","dropdownListShow","stopPropagation","hide","value","target","innerText","last","luckysheet_select_save","length","row_focus","column_focus","text","txt","siblings","val","trim","rangeDialog","selectRange","range","getRangeByTxt","rangetosheet","currentSheetIndex","sheetIndex","changeSheet","s","r1","row","r2","c1","column","c2","visibledatarow","row_pre","col","visibledatacolumn","col_pre","push","left_move","width_move","top_move","height_move","dataSource","attr","parents","info","item","curItem","value1","type","value2","type2","checked","rangeTxt","selectCellRange2","str","edr","stc","edc","d","deepCopyFlowData","flowdata","tooltipInfo1","tooltipInfo2","tooltipInfo3","Number","tooltipInfo4","tooltipInfo5","tooltipInfo6","tooltipInfo7","is","hintText","historyDataVerification","extend","currentDataVerification","r","c","refOfCheckbox","ref","rowIndex","colIndex","defaultItem","prop","close","getTxtByRange","join","indexOf","arr","split","i","iscelldata","getcellrange","cellFocus","clickMode","margeset","mergeborer","checkboxChange","max-width","max-height","lang","getHintText","html","cellValue","validateCellData","failureText","getFailureText","optionHtml","getDropdownList","forEach","scrollHeight","clearjfundo","jfundo","redo","jfredo","luckysheetfile","allowUpdate","saveParam","k","refresh","webWorkerFlowDataCache","data","historyParam"],"mappings":"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","file":"../../widgets/dataVerificationCtrl.js","sourcesContent":["define([\n    '../methods/dataVerificationCtrl_methods',\n    '../utils/util',\n    '../methods/formula_methods',\n    '../methods/validate',\n    '../methods/datecontroll',\n    '../widgets/tooltip',\n    '../methods/setdata',\n    '../methods/getdata',\n    '../widgets/constant',\n    '../widgets/select',\n    '../methods/cells',\n    '../methods/get',\n    '../locale/locale',\n    '../store'\n], function (m_dataVerificationCtrl_methods, m_util, formula, m_validate, m_datecontroll, tooltip, m_setdata, m_getdata, m_constant, m_select,  cells,  m_get, locale, Store) {\n    'use strict';\n    const {replaceHtml} = m_util;\n    const {isRealNum, isRealNull} = m_validate;\n    const {isdatetime, diff} = m_datecontroll;\n    const {setcellvalue} = m_setdata;\n    const {getcellvalue} = m_getdata;\n    const {modelHTML} = m_constant;\n    const {selectionCopyShow} = m_select;\n    const {getSheetIndex, getRangetxt} = m_get;\n    const dataVerificationCtrl = Object.assign(m_dataVerificationCtrl_methods,{\n\n        createDialog: function () {\n            let _this = this;\n            const _locale = locale();\n            const dvText = _locale.dataVerification;\n            const toolbarText = _locale.toolbar;\n            const buttonText = _locale.button;\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-dataVerification-dialog').remove();\n            let content = `<div class=\"box\">\n                            <div class=\"box-item\" style=\"border-top:1px solid #E1E4E8;\">\n                                <div class=\"box-item-title\">${ dvText.cellRange }</div>\n                                <div id=\"data-verification-range\" class=\"range\">\n                                    <input class=\"formulaInputFocus\" spellcheck=\"false\">\n                                    <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ dvText.selectCellRange }\"></i>\n                                </div>\n                            </div>\n                            <div class=\"box-item\">\n                                <div class=\"box-item-title\">${ dvText.verificationCondition }</div>\n                                <select id=\"data-verification-type-select\">\n                                    <option value=\"dropdown\">${ dvText.dropdown }</option>\n                                    <option value=\"checkbox\">${ dvText.checkbox }</option>\n                                    <option value=\"number\">${ dvText.number }</option>\n                                    <option value=\"number_integer\">${ dvText.number_integer }</option>\n                                    <option value=\"number_decimal\">${ dvText.number_decimal }</option>\n                                    <option value=\"text_content\">${ dvText.text_content }</option>\n                                    <option value=\"text_length\">${ dvText.text_length }</option>\n                                    <option value=\"date\">${ dvText.date }</option>\n                                    <option value=\"validity\">${ dvText.validity }</option>\n                                </select>\n                                <div class=\"show-box\">\n                                    <div class=\"show-box-item show-box-item-dropdown\">\n                                        <div class=\"range\">\n                                            <input class=\"formulaInputFocus data-verification-value1\" placeholder=\"${ dvText.placeholder1 }\" spellcheck=\"false\">\n                                            <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ dvText.selectCellRange }\"></i>\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-checkbox\">\n                                        <div class=\"check-box\">\n                                            <span>${ dvText.selected } ——</span>\n                                            <input type=\"text\" class=\"data-verification-value1\" placeholder=\"${ dvText.placeholder2 }\">\n                                        </div>\n                                        <div class=\"check-box\">\n                                            <span>${ dvText.notSelected } ——</span>\n                                            <input type=\"text\" class=\"data-verification-value2\" placeholder=\"${ dvText.placeholder2 }\">\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-number\">\n                                        <select id=\"data-verification-number-select\">\n                                            <option value=\"bw\">${ dvText.between }</option>\n                                            <option value=\"nb\">${ dvText.notBetween }</option>\n                                            <option value=\"eq\">${ dvText.equal }</option>\n                                            <option value=\"ne\">${ dvText.notEqualTo }</option>\n                                            <option value=\"gt\">${ dvText.moreThanThe }</option>\n                                            <option value=\"lt\">${ dvText.lessThan }</option>\n                                            <option value=\"gte\">${ dvText.greaterOrEqualTo }</option>\n                                            <option value=\"lte\">${ dvText.lessThanOrEqualTo }</option>\n                                        </select>\n                                        <div class=\"input input1\">\n                                            <input type=\"number\" class=\"data-verification-value1\" placeholder=\"1\">\n                                            <span>-</span>\n                                            <input type=\"number\" class=\"data-verification-value2\" placeholder=\"100\">\n                                        </div>\n                                        <div class=\"input input2\">\n                                            <input type=\"number\" class=\"data-verification-value1\" placeholder=\"${ dvText.placeholder3 }\">\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-text\">\n                                        <select id=\"data-verification-text-select\">\n                                            <option value=\"include\">${ dvText.include }</option>\n                                            <option value=\"exclude\">${ dvText.exclude }</option>\n                                            <option value=\"equal\">${ dvText.equal }</option>\n                                        </select>\n                                        <div class=\"input input2\">\n                                            <input type=\"text\" class=\"data-verification-value1\" placeholder=\"${ dvText.placeholder4 }\"/>\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-textLength\">\n                                        <select id=\"data-verification-textLength-select\">\n                                            <option value=\"bw\">${ dvText.between }</option>\n                                            <option value=\"nb\">${ dvText.notBetween }</option>\n                                            <option value=\"eq\">${ dvText.equal }</option>\n                                            <option value=\"ne\">${ dvText.notEqualTo }</option>\n                                            <option value=\"gt\">${ dvText.moreThanThe }</option>\n                                            <option value=\"lt\">${ dvText.lessThan }</option>\n                                            <option value=\"gte\">${ dvText.greaterOrEqualTo }</option>\n                                            <option value=\"lte\">${ dvText.lessThanOrEqualTo }</option>\n                                        </select>\n                                        <div class=\"input input1\">\n                                            <input type=\"number\" class=\"data-verification-value1\" placeholder=\"1\">\n                                            <span>-</span>\n                                            <input type=\"number\" class=\"data-verification-value2\" placeholder=\"100\">\n                                        </div>\n                                        <div class=\"input input2\">\n                                            <input type=\"number\" class=\"data-verification-value1\" placeholder=\"${ dvText.placeholder3 }\">\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-date\">\n                                        <select id=\"data-verification-date-select\">\n                                            <option value=\"bw\">${ dvText.between }</option>\n                                            <option value=\"nb\">${ dvText.notBetween }</option>\n                                            <option value=\"eq\">${ dvText.equal }</option>\n                                            <option value=\"ne\">${ dvText.notEqualTo }</option>\n                                            <option value=\"bf\">${ dvText.earlierThan }</option>\n                                            <option value=\"nbf\">${ dvText.noEarlierThan }</option>\n                                            <option value=\"af\">${ dvText.laterThan }</option>\n                                            <option value=\"naf\">${ dvText.noLaterThan }</option>\n                                        </select>\n                                        <div class=\"input input1\">\n                                            <input type=\"date\" class=\"data-verification-value1\" placeholder=\"2020/9/10\">\n                                            <span>-</span>\n                                            <input type=\"date\" class=\"data-verification-value2\" placeholder=\"2020/9/10\">\n                                        </div>\n                                        <div class=\"input input2\">\n                                            <input type=\"date\" class=\"data-verification-value1\" placeholder=\"2020/9/10\">\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-validity\">\n                                        <select id=\"data-verification-validity-select\">\n                                            <option value=\"card\">${ dvText.identificationNumber }</option>\n                                            <option value=\"phone\">${ dvText.phoneNumber }</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"box-item\">\n                                <div class=\"check\">\n                                    <input type=\"checkbox\" id=\"data-verification-remote\" class=\"data-verification-remote\">\n                                    <label for=\"data-verification-remote\">${ dvText.remote }</label>\n                                </div>\n                                <div class=\"check\">\n                                    <input type=\"checkbox\" id=\"data-verification-prohibitInput\">\n                                    <label for=\"data-verification-prohibitInput\">${ dvText.prohibitInput }</label>\n                                </div>\n                                <div class=\"check\">\n                                    <input type=\"checkbox\" id=\"data-verification-hint-show\">\n                                    <label for=\"data-verification-hint-show\">${ dvText.hintShow }</label>\n                                </div>\n                                <div class=\"data-verification-hint-text\">\n                                    <input type=\"text\" placeholder=\"${ dvText.placeholder5 }\">\n                                </div>\n                            </div>\n                        </div>`;\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-dataVerification-dialog',\n                'addclass': 'luckysheet-dataVerification-dialog',\n                'title': toolbarText.dataVerification,\n                'content': content,\n                'botton': `<button id=\"luckysheet-dataVerification-dialog-confirm\" class=\"btn btn-primary\">${ buttonText.confirm }</button>\n                        <button id=\"luckysheet-dataVerification-dialog-delete\" class=\"btn btn-default\">${ dvText.deleteVerification }</button>\n                        <button class=\"btn btn-default luckysheet-model-close-btn\">${ buttonText.cancel }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-dataVerification-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 350).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-dataVerification-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n            _this.dataAllocation();\n        },\n        init: function () {\n            let _this = this;\n            const dvText = locale().dataVerification;    //单元格数据验证 类型是 下拉列表\n            //单元格数据验证 类型是 下拉列表\n            $(document).off('click.dropdownBtn').on('click.dropdownBtn', '#luckysheet-dataVerification-dropdown-btn', function (e) {\n                _this.dropdownListShow();\n                e.stopPropagation();\n            });\n            $(document).off('click.dropdownListItem').on('click.dropdownListItem', '#luckysheet-dataVerification-dropdown-List .dropdown-List-item', function (e) {\n                $('#luckysheet-dataVerification-dropdown-List').hide();\n                let value = e.target.innerText;\n                let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                let rowIndex = last.row_focus;\n                let colIndex = last.column_focus;\n                $('#luckysheet-rich-text-editor').text(value);\n                ///formula.updatecell(rowIndex, colIndex); // TODO:lwf\n                e.stopPropagation();\n            });    //单元格范围\n            //单元格范围\n            $(document).off('click.dvRange').on('click.dvRange', '#data-verification-range .fa-table', function (e) {\n                $('#luckysheet-dataVerification-dialog').hide();\n                let dataSource = '0';\n                let txt = $(this).siblings('input').val().trim();\n                _this.rangeDialog(dataSource, txt);\n                _this.selectRange = [];\n                let range = _this.getRangeByTxt(txt);\n                formula.rangetosheet = Store.currentSheetIndex;\n                if (range[0].sheetIndex != Store.currentSheetIndex) {\n                    Store.changeSheet(range[0].sheetIndex);\n                }\n                if (range.length > 0) {\n                    for (let s = 0; s < range.length; s++) {\n                        let r1 = range[s].row[0], r2 = range[s].row[1];\n                        let c1 = range[s].column[0], c2 = range[s].column[1];\n                        let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                        let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                        _this.selectRange.push({\n                            'left': col_pre,\n                            'width': col - col_pre - 1,\n                            'top': row_pre,\n                            'height': row - row_pre - 1,\n                            'left_move': col_pre,\n                            'width_move': col - col_pre - 1,\n                            'top_move': row_pre,\n                            'height_move': row - row_pre - 1,\n                            'row': [\n                                r1,\n                                r2\n                            ],\n                            'column': [\n                                c1,\n                                c2\n                            ],\n                            'row_focus': r1,\n                            'column_focus': c1\n                        });\n                    }\n                }\n                selectionCopyShow(_this.selectRange);\n            });\n            $(document).off('click.dvRange2').on('click.dvRange2', '#luckysheet-dataVerification-dialog .show-box-item-dropdown .range .fa-table', function (e) {\n                $('#luckysheet-dataVerification-dialog').hide();\n                let dataSource = '1';\n                let txt = $(this).siblings('input').val().trim();\n                _this.rangeDialog(dataSource, txt);\n                _this.selectRange = [];\n                let range = _this.getRangeByTxt(txt);\n                formula.rangetosheet = Store.currentSheetIndex;\n                if (range[0].sheetIndex != Store.currentSheetIndex) {\n                    Store.changeSheet(range[0].sheetIndex);\n                }\n                if (range.length > 0) {\n                    for (let s = 0; s < range.length; s++) {\n                        let r1 = range[s].row[0], r2 = range[s].row[1];\n                        let c1 = range[s].column[0], c2 = range[s].column[1];\n                        let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                        let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                        _this.selectRange.push({\n                            'left': col_pre,\n                            'width': col - col_pre - 1,\n                            'top': row_pre,\n                            'height': row - row_pre - 1,\n                            'left_move': col_pre,\n                            'width_move': col - col_pre - 1,\n                            'top_move': row_pre,\n                            'height_move': row - row_pre - 1,\n                            'row': [\n                                r1,\n                                r2\n                            ],\n                            'column': [\n                                c1,\n                                c2\n                            ],\n                            'row_focus': r1,\n                            'column_focus': c1\n                        });\n                    }\n                }\n                selectionCopyShow(_this.selectRange);\n            });\n            $(document).off('click.dvRangeConfirm').on('click.dvRangeConfirm', '#luckysheet-dataVerificationRange-dialog-confirm', function (e) {\n                let dataSource = $(this).attr('data-source');\n                let txt = $(this).parents('#luckysheet-dataVerificationRange-dialog').find('input').val();\n                if (_this.getRangeByTxt(txt).length > 1) {\n                    tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', '不能对多重选择区域执行此操作\\uFF0C请选择单个区域\\uFF0C然后再试');\n                    return;\n                }\n                if (dataSource == '0') {\n                    $('#luckysheet-dataVerification-dialog #data-verification-range input').val(txt);\n                } else if (dataSource == '1') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-dropdown .range input').val(txt);\n                }\n                $('#luckysheet-dataVerificationRange-dialog').hide();\n                $('#luckysheet-modal-dialog-mask').show();\n                $('#luckysheet-dataVerification-dialog').show();\n                if (formula.rangetosheet != null && formula.rangetosheet != Store.currentSheetIndex) {\n                    Store.changeSheet(formula.rangetosheet);\n                    formula.rangetosheet = null;\n                }\n                let range = [];\n                selectionCopyShow(range);\n            });\n            $(document).off('click.dvRangeClose').on('click.dvRangeClose', '#luckysheet-dataVerificationRange-dialog-close', function (e) {\n                $('#luckysheet-dataVerificationRange-dialog').hide();\n                $('#luckysheet-modal-dialog-mask').show();\n                $('#luckysheet-dataVerification-dialog').show();\n                if (formula.rangetosheet != null && formula.rangetosheet != Store.currentSheetIndex) {\n                    Store.changeSheet(formula.rangetosheet);\n                    formula.rangetosheet = null;\n                }\n                let range = [];\n                selectionCopyShow(range);\n            });\n            $(document).on('click', '#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close', function (e) {\n                $('#luckysheet-dataVerificationRange-dialog').hide();\n                $('#luckysheet-modal-dialog-mask').show();\n                $('#luckysheet-dataVerification-dialog').show();\n                if (formula.rangetosheet != null && formula.rangetosheet != Store.currentSheetIndex) {\n                    Store.changeSheet(formula.rangetosheet);\n                    formula.rangetosheet = null;\n                }\n                let range = [];\n                selectionCopyShow(range);\n            });    //验证条件 下拉框\n            //验证条件 下拉框\n            $(document).off('change.typeSelect').on('change.typeSelect', '#data-verification-type-select', function (e) {\n                $('#luckysheet-dataVerification-dialog .show-box .show-box-item').hide();\n                let value = this.value;\n                let item = _this.curItem;\n                if (value == 'dropdown') {\n                    $('#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown').show();\n                    let value1 = '';\n                    if (value == item.type) {\n                        value1 = item.value1;\n                    }\n                    $('#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1').val(value1);\n                } else if (value == 'checkbox') {\n                    $('#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox').show();\n                    let value1 = '';\n                    let value2 = '';\n                    if (value == item.type) {\n                        value1 = item.value1;\n                        value2 = item.value2;\n                    }\n                    $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1').val(value1);\n                    $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2').val(value2);\n                } else if (value == 'number' || value == 'number_integer' || value == 'number_decimal') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number').show();\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .input').hide();\n                    let type2 = 'bw';\n                    let value1 = '';\n                    let value2 = '';\n                    if (item.type == 'number' || item.type == 'number_integer' || item.type == 'number_decimal') {\n                        type2 = item.type2;\n                        value1 = item.value1;\n                        value2 = item.value2;\n                    }\n                    $('#luckysheet-dataVerification-dialog #data-verification-number-select').val(type2);\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-number .input1').show();\n                    } else {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-number .input2').show();\n                    }\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1').val(value1);\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2').val(value2);\n                } else if (value == 'text_content') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-text').show();\n                    let type2 = 'include';\n                    let value1 = '';\n                    if (value == item.type) {\n                        type2 = item.type2;\n                        value1 = item.value1;\n                    }\n                    $('#luckysheet-dataVerification-dialog #data-verification-text-select').val(type2);\n                    $('#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1').val(value1);\n                } else if (value == 'text_length') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength').show();\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input').hide();\n                    let type2 = 'bw';\n                    let value1 = '';\n                    let value2 = '';\n                    if (value == item.type) {\n                        type2 = item.type2;\n                        value1 = item.value1;\n                        value2 = item.value2;\n                    }\n                    $('#luckysheet-dataVerification-dialog #data-verification-textLength-select').val(type2);\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input1').show();\n                    } else {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input2').show();\n                    }\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1').val(value1);\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2').val(value2);\n                } else if (value == 'date') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date').show();\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .input').hide();\n                    let type2 = 'bw';\n                    let value1 = '';\n                    let value2 = '';\n                    if (value == item.type) {\n                        type2 = item.type2;\n                        value1 = item.value1;\n                        value2 = item.value2;\n                    }\n                    $('#luckysheet-dataVerification-dialog #data-verification-date-select').val(type2);\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-date .input1').show();\n                    } else {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-date .input2').show();\n                    }\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1').val(value1);\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2').val(value2);\n                } else if (value == 'validity') {\n                    $('#luckysheet-dataVerification-dialog .show-box .show-box-item-validity').show();\n                    let type2 = 'card';\n                    if (value == item.type) {\n                        type2 = item.type2;\n                    }\n                    $('#luckysheet-dataVerification-dialog #data-verification-validity-select').val(type2);\n                }\n            });\n            $(document).off('change.numberSelect').on('change.numberSelect', '#data-verification-number-select', function (e) {\n                $('#luckysheet-dataVerification-dialog .show-box-item-number .input').hide();\n                let value = this.value;\n                if (value == 'bw' || value == 'nb') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .input1').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .input2').show();\n                }\n            });\n            $(document).off('change.dateSelect').on('change.dateSelect', '#data-verification-date-select', function (e) {\n                $('#luckysheet-dataVerification-dialog .show-box-item-date .input').hide();\n                let value = this.value;\n                if (value == 'bw' || value == 'nb') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .input1').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .input2').show();\n                }\n            });    //选中单元格时显示提示语\n            //选中单元格时显示提示语\n            $(document).off('change.hintShow').on('change.hintShow', '#data-verification-hint-show', function (e) {\n                if (this.checked) {\n                    $('#luckysheet-dataVerification-dialog .data-verification-hint-text').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .data-verification-hint-text').hide();\n                }\n            });    //确认按钮\n            //确认按钮\n            $(document).off('click.dvSaveConfirm').on('click.dvSaveConfirm', '#luckysheet-dataVerification-dialog-confirm', function (e) {\n                let rangeTxt = $('#luckysheet-dataVerification-dialog #data-verification-range input').val().trim();\n                let range = _this.getRangeByTxt(rangeTxt);\n                if (range.length == 0) {\n                    tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.selectCellRange2);\n                    return;\n                }\n                let str = range[range.length - 1].row[0], edr = range[range.length - 1].row[1], stc = range[range.length - 1].column[0], edc = range[range.length - 1].column[1];\n                let d = Store.deepCopyFlowData(Store.flowdata);\n                if (str < 0) {\n                    str = 0;\n                }\n                if (edr > d.length - 1) {\n                    edr = d.length - 1;\n                }\n                if (stc < 0) {\n                    stc = 0;\n                }\n                if (edc > d[0].length - 1) {\n                    edc = d[0].length - 1;\n                }\n                let type = $('#luckysheet-dataVerification-dialog #data-verification-type-select').val();\n                let type2 = null, value1 = '', value2 = '';\n                if (type == 'dropdown') {\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1').val().trim();\n                    if (value1.length == 0) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo1);\n                        return;\n                    }\n                } else if (type == 'checkbox') {\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1').val().trim();\n                    value2 = $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2').val().trim();\n                    if (value1.length == 0 || value2.length == 0) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo2);\n                        return;\n                    }\n                } else if (type == 'number' || type == 'number_integer' || type == 'number_decimal') {\n                    type2 = $('#luckysheet-dataVerification-dialog #data-verification-number-select').val();\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value1').val().trim();\n                    if (!isRealNum(value1)) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo3);\n                        return;\n                    }\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        value2 = $('#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value2').val().trim();\n                        if (!isRealNum(value2)) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo3);\n                            return;\n                        }\n                        if (Number(value2) < Number(value1)) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo4);\n                            return;\n                        }\n                    }\n                } else if (type == 'text_content') {\n                    type2 = $('#luckysheet-dataVerification-dialog #data-verification-text-select').val();\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1').val().trim();\n                    if (value1.length == 0) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo5);\n                        return;\n                    }\n                } else if (type == 'text_length') {\n                    type2 = $('#luckysheet-dataVerification-dialog #data-verification-textLength-select').val();\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value1').val().trim();\n                    if (!isRealNum(value1)) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo3);\n                        return;\n                    }\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        value2 = $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value2').val().trim();\n                        if (!isRealNum(value2)) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo3);\n                            return;\n                        }\n                        if (Number(value2) < Number(value1)) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo4);\n                            return;\n                        }\n                    }\n                } else if (type == 'date') {\n                    type2 = $('#luckysheet-dataVerification-dialog #data-verification-date-select').val();\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value1').val().trim();\n                    if (!isdatetime(value1)) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo6);\n                        return;\n                    }\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        value2 = $('#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value2').val().trim();\n                        if (!isdatetime(value2)) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo6);\n                            return;\n                        }\n                        if (diff(value1, value2) > 0) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo7);\n                            return;\n                        }\n                    }\n                } else if (type == 'validity') {\n                    type2 = $('#luckysheet-dataVerification-dialog #data-verification-validity-select').val();\n                }\n                let remote = $('#luckysheet-dataVerification-dialog #data-verification-remote').is(':checked');\n                let prohibitInput = $('#luckysheet-dataVerification-dialog #data-verification-prohibitInput').is(':checked');\n                let hintShow = $('#luckysheet-dataVerification-dialog #data-verification-hint-show').is(':checked');\n                let hintText = '';\n                if (hintShow) {\n                    hintText = $('#luckysheet-dataVerification-dialog .data-verification-hint-text input').val().trim();\n                }\n                let item = {\n                    type: type,\n                    type2: type2,\n                    value1: value1,\n                    value2: value2,\n                    checked: false,\n                    remote: remote,\n                    prohibitInput: prohibitInput,\n                    hintShow: hintShow,\n                    hintText: hintText\n                };\n                let historyDataVerification = $.extend(true, {}, Store.dataVerification);\n                let currentDataVerification = $.extend(true, {}, Store.dataVerification);\n                for (let r = str; r <= edr; r++) {\n                    for (let c = stc; c <= edc; c++) {\n                        currentDataVerification[r + '_' + c] = item;\n                        if (type == 'checkbox') {\n                            setcellvalue(r, c, d, item.value2);\n                        }\n                    }\n                }\n                if (type == 'checkbox') {\n                    _this.refOfCheckbox(historyDataVerification, currentDataVerification, Store.currentSheetIndex, d, range[range.length - 1]);\n                } else {\n                    _this.ref(historyDataVerification, currentDataVerification, Store.currentSheetIndex);\n                }\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-dataVerification-dialog').hide();\n            });    //删除验证按钮\n            //删除验证按钮\n            $(document).off('click.delete').on('click.delete', '#luckysheet-dataVerification-dialog-delete', function (e) {\n                let rangeTxt = $('#luckysheet-dataVerification-dialog #data-verification-range input').val().trim();\n                let range = _this.getRangeByTxt(rangeTxt);\n                if (range.length == 0) {\n                    tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.selectCellRange2);\n                    return;\n                }\n                let historyDataVerification = $.extend(true, {}, Store.dataVerification);\n                let currentDataVerification = $.extend(true, {}, Store.dataVerification);\n                let str = range[range.length - 1].row[0], edr = range[range.length - 1].row[1], stc = range[range.length - 1].column[0], edc = range[range.length - 1].column[1];\n                for (let r = str; r <= edr; r++) {\n                    for (let c = stc; c <= edc; c++) {\n                        delete currentDataVerification[r + '_' + c];\n                    }\n                }\n                _this.ref(historyDataVerification, currentDataVerification, Store.currentSheetIndex);\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-dataVerification-dialog').hide();\n            });    //info提示弹框 关闭\n            //info提示弹框 关闭\n            $(document).on('click', '#luckysheet-info .luckysheet-modal-dialog-title-close, #luckysheet-info .luckysheet-model-close-btn', function (e) {\n                $(this).parents('#luckysheet-info').hide();\n                if ($('#luckysheet-dataVerification-dialog').is(':visible')) {\n                    $('#luckysheet-modal-dialog-mask').show();\n                }\n                e.stopPropagation();\n            });\n        },\n        dataAllocation: function () {\n            let _this = this;    //单元格范围\n            //单元格范围\n            let range = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n            let rangeTxt = getRangetxt(Store.currentSheetIndex, range, Store.currentSheetIndex);\n            $('#luckysheet-dataVerification-dialog #data-verification-range input').val(rangeTxt);    //focus单元格\n            //focus单元格\n            let rowIndex = range.row_focus || range.row[0];\n            let colIndex = range.column_focus || range.column[0];\n            let dataVerification = $.extend(true, {}, Store.dataVerification);\n            let item = dataVerification[rowIndex + '_' + colIndex];\n            if (item == null) {\n                item = $.extend(true, {}, _this.defaultItem);\n            }\n            _this.curItem = item;    //验证条件\n            //验证条件\n            $('#luckysheet-dataVerification-dialog #data-verification-type-select').val(item.type);\n            $('#luckysheet-dataVerification-dialog .show-box .show-box-item').hide();\n            if (item.type == 'dropdown') {\n                $('#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown').show();\n                $('#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1').val(item.value1);\n            } else if (item.type == 'checkbox') {\n                $('#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox').show();\n                $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1').val(item.value1);\n                $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2').val(item.value2);\n            } else if (item.type == 'number' || item.type == 'number_integer' || item.type == 'number_decimal') {\n                $('#luckysheet-dataVerification-dialog .show-box-item-number').show();\n                $('#luckysheet-dataVerification-dialog #data-verification-number-select').val(item.type2);\n                $('#luckysheet-dataVerification-dialog .show-box-item-number .input').hide();\n                if (item.type2 == 'bw' || item.type2 == 'nb') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .input1').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .input2').show();\n                }\n                $('#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1').val(item.value1);\n                $('#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2').val(item.value2);\n            } else if (item.type == 'text_content') {\n                $('#luckysheet-dataVerification-dialog .show-box-item-text').show();\n                $('#luckysheet-dataVerification-dialog #data-verification-text-select').val(item.type2);\n                $('#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1').val(item.value1);\n            } else if (item.type == 'text_length') {\n                $('#luckysheet-dataVerification-dialog .show-box-item-textLength').show();\n                $('#luckysheet-dataVerification-dialog #data-verification-textLength-select').val(item.type2);\n                $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input').hide();\n                if (item.type2 == 'bw' || item.type2 == 'nb') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input1').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input2').show();\n                }\n                $('#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1').val(item.value1);\n                $('#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2').val(item.value2);\n            } else if (item.type == 'date') {\n                $('#luckysheet-dataVerification-dialog .show-box-item-date').show();\n                $('#luckysheet-dataVerification-dialog #data-verification-date-select').val(item.type2);\n                $('#luckysheet-dataVerification-dialog .show-box-item-date .input').hide();\n                if (item.type2 == 'bw' || item.type2 == 'nb') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .input1').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .input2').show();\n                }\n                $('#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1').val(item.value1);\n                $('#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2').val(item.value2);\n            } else if (item.type == 'validity') {\n                $('#luckysheet-dataVerification-dialog .show-box .show-box-item-validity').show();\n                $('#luckysheet-dataVerification-dialog #data-verification-validity-select').val(item.type2);\n            }    //自动远程获取选项\n            //自动远程获取选项\n            $('#luckysheet-dataVerification-dialog #data-verification-remote').prop('checked', item.remote);    //输入数据无效时禁止输入\n            //输入数据无效时禁止输入\n            $('#luckysheet-dataVerification-dialog #data-verification-prohibitInput').prop('checked', item.prohibitInput);    //选中单元格时显示提示语\n            //选中单元格时显示提示语\n            $('#luckysheet-dataVerification-dialog #data-verification-hint-show').prop('checked', item.hintShow);\n            if (item.hintShow) {\n                $('#luckysheet-dataVerification-dialog .data-verification-hint-text').show();\n            } else {\n                $('#luckysheet-dataVerification-dialog .data-verification-hint-text').hide();\n            }\n            $('#luckysheet-dataVerification-dialog .data-verification-hint-text input').val(item.hintText);\n        },\n        rangeDialog: function (dataSource, txt) {\n            let _this = this;\n            const _locale = locale();\n            const dvText = _locale.dataVerification;\n            const buttonText = _locale.button;\n            $('#luckysheet-modal-dialog-mask').hide();\n            $('#luckysheet-dataVerificationRange-dialog').remove();\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-dataVerificationRange-dialog',\n                'addclass': 'luckysheet-dataVerificationRange-dialog',\n                'title': dvText.selectCellRange,\n                'content': `<input readonly=\"readonly\" placeholder=\"${ dvText.selectCellRange2 }\" value=\"${ txt }\"/>`,\n                'botton': `<button id=\"luckysheet-dataVerificationRange-dialog-confirm\" class=\"btn btn-primary\" data-source=\"${ dataSource }\">${ buttonText.confirm }</button>\n                        <button id=\"luckysheet-dataVerificationRange-dialog-close\" class=\"btn btn-default\">${ buttonText.close }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-dataVerificationRange-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-dataVerificationRange-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n        },\n        getTxtByRange: function (range) {\n            if (range.length > 0) {\n                let txt = [];\n                for (let s = 0; s < range.length; s++) {\n                    let r1 = range[s].row[0], r2 = range[s].row[1];\n                    let c1 = range[s].column[0], c2 = range[s].column[1];\n                    txt.push(getRangetxt(Store.currentSheetIndex, {\n                        'row': [\n                            r1,\n                            r2\n                        ],\n                        'column': [\n                            c1,\n                            c2\n                        ]\n                    }, Store.currentSheetIndex));\n                }\n                return txt.join(',');\n            }\n        },\n        getRangeByTxt: function (txt) {\n            let range = [];\n            if (txt.indexOf(',') != -1) {\n                let arr = txt.split(',');\n                for (let i = 0; i < arr.length; i++) {\n                    if (formula.iscelldata(arr[i])) {\n                        range.push(formula.getcellrange(arr[i]));\n                    } else {\n                        range = [];\n                        break;\n                    }\n                }\n            } else {\n                if (formula.iscelldata(txt)) {\n                    range.push(formula.getcellrange(txt));\n                }\n            }\n            return range;\n        },\n        cellFocus: function (r, c, clickMode) {\n            $('#luckysheet-dataVerification-dropdown-btn').hide();\n            $('#luckysheet-dataVerification-showHintBox').hide();\n            let _this = this;\n            if (Store.dataVerification == null || Store.dataVerification[r + '_' + c] == null) {\n                $('#luckysheet-dataVerification-dropdown-List').hide();\n                return;\n            }\n            let row = Store.visibledatarow[r], row_pre = r == 0 ? 0 : Store.visibledatarow[r - 1];\n            let col = Store.visibledatacolumn[c], col_pre = c == 0 ? 0 : Store.visibledatacolumn[c - 1];\n            let margeset = cells.mergeborer(Store.flowdata, r, c);\n            if (!!margeset) {\n                row = margeset.row[1];\n                row_pre = margeset.row[0];\n                col = margeset.column[1];\n                col_pre = margeset.column[0];\n            }\n            let item = Store.dataVerification[r + '_' + c];    //单元格数据验证 类型是 复选框\n            //单元格数据验证 类型是 复选框\n            if (clickMode && item.type == 'checkbox') {\n                _this.checkboxChange(r, c);\n                return;\n            }    //单元格数据验证 类型是 下拉列表\n            //单元格数据验证 类型是 下拉列表\n            if (item.type == 'dropdown') {\n                $('#luckysheet-dataVerification-dropdown-btn').show().css({\n                    'max-width': col - col_pre,\n                    'max-height': row - row_pre,\n                    'left': col - 20,\n                    'top': row_pre + (row - row_pre - 20) / 2\n                });\n                if ($('#luckysheet-dataVerification-dropdown-List').is(':visible')) {\n                    let dataIndex = $('#luckysheet-dataVerification-dropdown-List').prop('data-index');\n                    if (dataIndex != r + '_' + c) {\n                        $('#luckysheet-dataVerification-dropdown-List').hide();\n                    }\n                }\n            } else {\n                $('#luckysheet-dataVerification-dropdown-List').hide();\n            }    //提示语\n            //提示语\n            if (item.hintShow) {\n                let hintText;\n                if (Store.lang == 'en') {\n                    hintText = '<span style=\"color:#f5a623;\">Hint: </span>';\n                } else {\n                    hintText = '<span style=\"color:#f5a623;\">提示\\uFF1A</span>';\n                }\n                hintText += _this.getHintText(item);\n                $('#luckysheet-dataVerification-showHintBox').html(hintText).show().css({\n                    'left': col_pre,\n                    'top': row\n                });\n                return;\n            }    //数据验证未通过\n            //数据验证未通过\n            let cellValue = getcellvalue(r, c, null);\n            if (isRealNull(cellValue)) {\n                return;\n            }\n            let validate = _this.validateCellData(cellValue, item);\n            if (!validate) {\n                let failureText;\n                if (Store.lang == 'en') {\n                    failureText = '<span style=\"color:#f72626;\">Failure: </span>';\n                } else {\n                    failureText = '<span style=\"color:#f72626;\">失效\\uFF1A</span>';\n                }\n                failureText += _this.getFailureText(item);\n                $('#luckysheet-dataVerification-showHintBox').html(failureText).show().css({\n                    'left': col_pre,\n                    'top': row\n                });\n            }\n        },\n\n        dropdownListShow: function () {\n            $('#luckysheet-dataVerification-showHintBox').hide();\n            let _this = this;\n            let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n            let rowIndex = last.row_focus;\n            let colIndex = last.column_focus;\n            let row = Store.visibledatarow[rowIndex], row_pre = rowIndex == 0 ? 0 : Store.visibledatarow[rowIndex - 1];\n            let col = Store.visibledatacolumn[colIndex], col_pre = colIndex == 0 ? 0 : Store.visibledatacolumn[colIndex - 1];\n            let margeset = cells.mergeborer(Store.flowdata, rowIndex, colIndex);\n            if (!!margeset) {\n                row = margeset.row[1];\n                row_pre = margeset.row[0];\n                col = margeset.column[1];\n                col_pre = margeset.column[0];\n            }\n            let item = Store.dataVerification[rowIndex + '_' + colIndex];\n            let list = _this.getDropdownList(item.value1);\n            let optionHtml = '';\n            list.forEach(i => {\n                optionHtml += `<div class=\"dropdown-List-item luckysheet-mousedown-cancel\">${ i }</div>`;\n            });\n            $('#luckysheet-dataVerification-dropdown-List').html(optionHtml).prop('data-index', rowIndex + '_' + colIndex).show().css({\n                'width': col - col_pre - 1,\n                'left': col_pre,\n                'top': row\n            });\n            let myh = $('#luckysheet-dataVerification-dropdown-List').outerHeight();\n            let currentWinH = $('#luckysheet-cell-main')[0].scrollHeight;\n            if (row + myh > currentWinH - 42 - 6) {\n                $('#luckysheet-dataVerification-dropdown-List').css({ 'top': row_pre - myh });\n            }\n        },\n\n        checkboxChange: function (r, c) {\n            let _this = this;\n            let historyDataVerification = $.extend(true, {}, Store.dataVerification);\n            let currentDataVerification = $.extend(true, {}, Store.dataVerification);\n            let item = currentDataVerification[r + '_' + c];\n            item.checked = !item.checked;\n            let value = item.value2;\n            if (item.checked) {\n                value = item.value1;\n            }\n            let d = Store.deepCopyFlowData(Store.flowdata);\n            setcellvalue(r, c, d, value);\n            _this.refOfCheckbox(historyDataVerification, currentDataVerification, Store.currentSheetIndex, d, {\n                'row': [\n                    r,\n                    r\n                ],\n                'column': [\n                    c,\n                    c\n                ]\n            });\n        },\n        ref: function (historyDataVerification, currentDataVerification, sheetIndex) {\n            let _this = this;\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                let redo = {};\n                redo['type'] = 'updateDataVerification';\n                redo['sheetIndex'] = sheetIndex;\n                redo['historyDataVerification'] = historyDataVerification;\n                redo['currentDataVerification'] = currentDataVerification;\n                Store.jfredo.push(redo);\n            }\n            Store.dataVerification = currentDataVerification;\n            Store.luckysheetfile[getSheetIndex(sheetIndex)].dataVerification = currentDataVerification;    //共享编辑模式\n            //共享编辑模式\n            if (Store.allowUpdate) {\n                Store.saveParam('all', sheetIndex, currentDataVerification, { 'k': 'dataVerification' });\n            }\n            ///setTimeout(function () {\n            ////    luckysheetrefreshgrid();\n            ///}, 1);\n            Store.refresh();\n        },\n        refOfCheckbox: function (historyDataVerification, currentDataVerification, sheetIndex, d, range) {\n            let _this = this;\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                let redo = {};\n                redo['type'] = 'updateDataVerificationOfCheckbox';\n                redo['sheetIndex'] = sheetIndex;\n                redo['historyDataVerification'] = historyDataVerification;\n                redo['currentDataVerification'] = currentDataVerification;\n                redo['data'] = Store.flowdata;\n                redo['curData'] = d;\n                redo['range'] = range;\n                Store.jfredo.push(redo);\n            }\n            Store.dataVerification = currentDataVerification;\n            Store.luckysheetfile[getSheetIndex(sheetIndex)].dataVerification = currentDataVerification;\n            Store.flowdata = d;\n            Store.webWorkerFlowDataCache(Store.flowdata);    //worker存数据\n            //worker存数据\n            Store.luckysheetfile[getSheetIndex(sheetIndex)].data = Store.flowdata;    //共享编辑模式\n            //共享编辑模式\n            if (Store.allowUpdate) {\n                Store.saveParam('all', sheetIndex, currentDataVerification, { 'k': 'dataVerification' });\n                Store.historyParam(Store.flowdata, sheetIndex, range);\n            }\n            ///setTimeout(function () {\n            ////    luckysheetrefreshgrid();\n            ///}, 1);\n            Store.refresh();\n        }\n    });\n    return dataVerificationCtrl;\n});"]}