{"version":3,"sources":["expendPlugins/chart/plugin.js"],"names":["define","m_util","m_chartUtil","m_getdata","chartInfo","formula","m_func","m_get","m_location","m_set","m_sheetMove","luckysheetConfigsetting","luckysheetsizeauto","Vuex","Vue","elementui","chartmix","seriesLoadScripts","loadLinks","$$","arrayRemoveItem","generateRandomKey","replaceHtml","getdatabyselection","getcellvalue","luckysheet_getcelldata","getSheetIndex","getRangetxt","getvisibledatacolumn","getvisibledatarow","rowLocation","colLocation","mouseposition","setluckysheet_scroll_status","luckysheetMoveHighlightCell","luckysheetMoveHighlightCell2","luckysheetMoveHighlightRange","luckysheetMoveHighlightRange2","luckysheetMoveEndCell","isEditMode","_rowLocation","_colLocation","dependLinks","renderCharts","chartLists","isDemo","undefined","i","length","chart","chartparam","insertToStore","chart_id","chartOptions","chart_id_c","$t","$","id","addclass","title","content","appendTo","setChartMoveableEffect","children","chart_json","container","document","getElementById","getChartJson","renderChart","currentChart","showNeedRangeShow","click","e","delChart","showChartSettingComponent","mousedown","luckysheetCurrentChartMaxState","stopPropagation","target","is","luckysheetCurrentChartMoveTimeout","setTimeout","luckysheetCurrentChartMove","toffset","luckysheetCurrentChartMoveObj","offset","tpsition","position","luckysheetCurrentChartMoveXy","pageX","left","pageY","top","scrollLeft","scrollTop","luckysheetCurrentChartMoveWinH","scrollHeight","luckysheetCurrentChartMoveWinW","scrollWidth","hasClass","filter","hide","find","luckysheetCurrentChartActive","luckysheetCurrentChartResize","this","data","mouse","x","y","luckysheetCurrentChartResizeObj","luckysheetCurrentChartResizeXy","width","height","luckysheetCurrentChartResizeWinH","luckysheetCurrentChartResizeWinW","luckysheetCurrentChart","style","background","zIndex","jfrefreshchartall","flowdata1","r_st","r_ed","c_st","c_ed","rangeArray","row","column","luckysheetgetcellrange","getcellrange","rangeTxt","sheetIndex","getcelldata","chartData","changeChartCellData","$container","hover","removeClass","addClass","remove","hideAllNeedRangeShow","sheetFile","luckysheetfile","currentSheetIndex","index","findIndex","item","splice","deleteChart","chartId","needRangeShow","selectRangeBorderShow","selectRangeBorderHide","chart_selection","create","css","luckysheetCurrentChartZIndexRank","show","luckysheet_chart_redo_click","highlightChart","settingShow","refresh","empty","renderChartShow","forEach","file","isShow","resizeChart","store","Store","console","info","default","use","outDom","getElementsByTagName","initChart","lang","bottom","right","border","z-index","box-shadow","-webkit-box-shadow","-moz-box-shadow","-moz-user-select","-khtml-user-select","-webkit-user-select","-ms-user-select","user-select","padding-left","display","createChart","changeChartRange","st_r","st_c","rangeSplitArray","rangeRowCheck","exits","chart_rowtitle_html","getRangeShowHtml","rowtitle","rangeColCheck","chart_coltitle_html","coltitle","chart_content_html","append","type","r1","r2","c1","c2","visibledatarow","visibledatacolumn","row_pre","col","col_pre","color","html","rangeMove","rangeMovexy","rangeMoveIndex","rangeMoveObj","rangeMoveDraging","event","sheetBarHeight","statisticBarHeight","winH","window","winW","row_index","col_index","$id","attr","row_s","range","row_e","col_s","col_e","rangeMoveDragged","updateJson","rangeResize","rangeResizexy","rangeResizeIndex","rangeResizeObj","rangeResizeDraging","obj_r1","obj_r2","obj_c1","obj_c2","rangeResizeDragged","status","asyncLoad","createLuckyChart","jfgird_select_save","luckysheet","getluckysheet_select_save","shiftpositon_row","row_ed","r","c","value","flowdata","toString","setluckysheet_select_save","luckysheet_shiftpositon","extend","shiftpositon_col","column_ed","dir","render","JSON","stringify","push"],"mappings":"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","file":"../../../expendPlugins/chart/plugin.js","sourcesContent":["define([\n    '../../utils/util',\n    '../../utils/chartUtil',\n    '../../methods/getdata',\n    '../../store',\n    '../../controllers/formula',\n    '../../function/func',\n    '../../methods/get',\n    '../../methods/location',\n    '../../methods/set',\n    '../../controllers/sheetMove',\n    '../../methods/luckysheetConfigsetting',\n    '../../widgets/resize',\n    '../../vendors/Vuex',\n    '../../vendors/Vue',\n    '../../vendors/element-ui',\n    \"./chartmix\"\n], function (\n    m_util, \n    m_chartUtil,\n    m_getdata,\n    chartInfo, \n    formula, \n    m_func, \n    m_get, \n    m_location, \n    m_set, \n    m_sheetMove,\n    luckysheetConfigsetting, \n    luckysheetsizeauto,\n    Vuex,\n    Vue,\n    elementui,\n    chartmix\n) {\n    'use strict';\n    const {seriesLoadScripts, loadLinks, $$, arrayRemoveItem} = m_util;\n    const {generateRandomKey, replaceHtml} = m_chartUtil;\n    const {getdatabyselection, getcellvalue} = m_getdata;\n    const {luckysheet_getcelldata} = m_func;\n    const {getSheetIndex, getRangetxt, getvisibledatacolumn, getvisibledatarow} = m_get;\n    const {rowLocation, colLocation, mouseposition} = m_location;\n    const {setluckysheet_scroll_status} = m_set;\n    const {luckysheetMoveHighlightCell, luckysheetMoveHighlightCell2, luckysheetMoveHighlightRange, luckysheetMoveHighlightRange2, luckysheetMoveEndCell} = m_sheetMove;\n    const isEditMode = luckysheetConfigsetting.isEditMode;\n    let _rowLocation = rowLocation;\n    let _colLocation = colLocation;    // Dynamically load dependent scripts and styles\n    // Dynamically load dependent scripts and styles\n    const dependScripts = [\n//        'https://cdn.jsdelivr.net/npm/vue@2.6.11',\n//        'https://unpkg.com/vuex@3.4.0',\n        'https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.2/index.js',\n//        'https://cdn.bootcdn.net/ajax/libs/echarts/4.8.0/echarts.min.js',\n//        'expendPlugins/chart/chartmix.umd.min.js'\n    ];\n    // 'http://26.26.26.1:8000/chartmix.umd.js'\n    const dependLinks = [\n        'https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.2/theme-chalk/index.css',\n        'expendPlugins/chart/chartmix.css'\n    ];    // Initialize the chart component\n    // 'http://26.26.26.1:8000/chartmix.css'\n    // Initialize the chart component\n    function chart(data, isDemo) {\n        loadLinks(dependLinks);\n        ///seriesLoadScripts(dependScripts, null, function () {\n        setTimeout(function () {\n            const store = new Vuex.Store();\n            console.info('chartmix::', chartmix.default);\n            Vue.use(chartmix.default, { store });\n            let outDom = document.getElementsByTagName('body')[0];\n            chartmix.default.initChart(outDom, chartInfo.lang);\n            $('.chartSetting').css({\n                top: '1px',\n                bottom: '1px',\n                position: 'absolute',\n                right: '0px',\n                width: '350px',\n                background: '#fff',\n                border: '1px solid #E5E5E5',\n                'z-index': 1004,\n                'box-shadow': '0px 2px 4px rgba(0,0,0,0.2)',\n                '-webkit-box-shadow': '0px 2px 4px rgba(0,0,0,0.2)',\n                '-moz-box-shadow': '0px 2px 4px rgba(0,0,0,0.2)',\n                '-moz-user-select': 'none',\n                '-khtml-user-select': 'none',\n                '-webkit-user-select': 'none',\n                '-ms-user-select': 'none',\n                'user-select': 'none',\n                'padding-left': '30px',\n                display: 'none'\n            });\n            chartInfo.createChart = chartmix.default.createChart;\n            chartInfo.highlightChart = chartmix.default.highlightChart;\n            chartInfo.deleteChart = chartmix.default.deleteChart;\n            chartInfo.resizeChart = chartmix.default.resizeChart;\n            chartInfo.changeChartRange = chartmix.default.changeChartRange;\n            chartInfo.changeChartCellData = chartmix.default.changeChartCellData;\n            chartInfo.getChartJson = chartmix.default.getChartJson;\n            chartInfo.chart_selection = chart_selection();\n            chartInfo.chartparam.jfrefreshchartall = jfrefreshchartall;\n            chartInfo.chartparam.changeChartCellData = chartmix.default.changeChartCellData;\n            chartInfo.chartparam.renderChart = chartmix.default.renderChart;\n            chartInfo.chartparam.getChartJson = chartmix.default.getChartJson;\n            chartInfo.chartparam.insertToStore = chartmix.default.insertToStore;    // Initialize the rendering chart\n            // Initialize the rendering chart\n            for (let i = 0; i < data.length; i++) {\n                // if (data[i].status == '1') {\n                renderCharts(data[i].chart, isDemo);    // }\n            }\n            // }\n            for (let i = 0; i < data.length; i++) {\n                if (data[i].status == '1') {\n                    renderChartShow(data[i].index);\n                }\n            }    // After the chart is loaded, mark it\n            // After the chart is loaded, mark it\n            arrayRemoveItem(chartInfo.asyncLoad, 'chart');\n        },0);\n    }    // rendercharts\n    // rendercharts\n    function renderCharts(chartLists, isDemo) {\n        // no chart\n        if (chartLists == undefined) {\n            return;\n        }\n        for (let i = 0; i < chartLists.length; i++) {\n            let chart = chartLists[i];\n            if (isDemo) {\n                chartInfo.chartparam.insertToStore({\n                    chart_id: chart.chart_id,\n                    chartOptions: chart.chartOptions\n                });\n            }\n            let chart_id = chart.chart_id;\n            let chart_id_c = chart_id + '_c';\n            let modelChartShowHTML = '<div id=\"${id}\"class=\"luckysheet-modal-dialog luckysheet-modal-dialog-chart ${addclass}\"tabindex=\"0\"role=\"dialog\"aria-labelledby=\":41e\"dir=\"ltr\"><div class=\"luckysheet-modal-dialog-resize\"><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt\"data-type=\"lt\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt\"data-type=\"mt\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm\"data-type=\"lm\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm\"data-type=\"rm\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt\"data-type=\"rt\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb\"data-type=\"lb\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb\"data-type=\"mb\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb\"data-type=\"rb\"></div></div><div class=\"luckysheet-modal-dialog-controll\"><span class=\"luckysheet-modal-controll-btn luckysheet-modal-controll-update\"role=\"button\"tabindex=\"0\"aria-label=\"修改图表\"title=\"修改图表\"><i class=\"fa fa-pencil\"aria-hidden=\"true\"></i></span><span class=\"luckysheet-modal-controll-btn luckysheet-modal-controll-max\"role=\"butluckysheet_chartIns_indexton\"tabindex=\"0\"aria-label=\"最大化\"title=\"最大化\"><i class=\"fa fa-window-maximize\"aria-hidden=\"true\"></i></span><span class=\"luckysheet-modal-controll-btn luckysheet-modal-controll-del\"role=\"button\"tabindex=\"0\"aria-label=\"删除\"title=\"删除\"><i class=\"fa fa-trash\"aria-hidden=\"true\"></i></span></div><div class=\"luckysheet-modal-dialog-content\">${content}</div></div>';\n            let $t = $(replaceHtml(modelChartShowHTML, {\n                id: chart_id_c,\n                addclass: 'luckysheet-data-visualization-chart',\n                title: '图表生成',\n                content: ''\n            })).appendTo($('.luckysheet-cell-main'));\n            setChartMoveableEffect($t);\n            $(`#${ chart_id_c }`).children('.luckysheet-modal-dialog-content')[0].id = chart_id;\n            let container = document.getElementById(chart_id_c);\n            let chart_json;\n            chart_json = chartInfo.chartparam.getChartJson(chart.chart_id);\n            chartInfo.chartparam.renderChart({\n                chart_id: chart.chart_id,\n                chartOptions: chart_json\n            });\n            chartInfo.currentChart = chart_json;    //处理区域高亮框参数，当前页中，只有当前的图表的needRangShow为true,其他为false\n            //处理区域高亮框参数，当前页中，只有当前的图表的needRangShow为true,其他为false\n            showNeedRangeShow(chart_id);    // delete current chart\n            // delete current chart\n            $(`#${ chart_id }_c .luckysheet-modal-controll-del`).click(function (e) {\n                delChart(chart_id);\n            });    // edit current chart\n            // edit current chart\n            $(`#${ chart_id }_c .luckysheet-modal-controll-update`).click(function (e) {\n                showChartSettingComponent();\n            });\n            $t.children('.luckysheet-modal-dialog-content').mousedown(function (e) {\n                if (!chartInfo.chartparam.luckysheetCurrentChartMaxState) {\n                    //当前图表显示区域高亮\n                    showNeedRangeShow(chart_id);\n                }\n                e.stopPropagation();\n            });\n            $t.mousedown(function (e) {\n                // move chart\n                if (!chartInfo.chartparam.luckysheetCurrentChartMaxState) {\n                    //当前图表显示区域高亮\n                    showNeedRangeShow(chart_id);\n                    setluckysheet_scroll_status(true);    //允许拖动渲染框\n                    //允许拖动渲染框\n                    if (!$(e.target).is('.luckysheet-modal-dialog-controll') && !$(e.target).is('.luckysheet-modal-controll-btn') && !$(e.target).is('i')) {\n                        // Debounce\n                        chartInfo.chartparam.luckysheetCurrentChartMoveTimeout = setTimeout(function () {\n                            chartInfo.chartparam.luckysheetCurrentChartMove = true;\n                        }, 100);\n                    }\n                    var toffset = chartInfo.chartparam.luckysheetCurrentChartMoveObj.offset();\n                    var tpsition = chartInfo.chartparam.luckysheetCurrentChartMoveObj.position();    //luckysheetCurrentChartMoveXy: [鼠标点相对chart框的距离X方向，鼠标点相对chart框的距离Y方向，chart框相对cell-main的距离X方向，chart框相对cell-main的距离Y方向，水平滚动条的位置，垂直滚动条的位置]\n                    //luckysheetCurrentChartMoveXy: [鼠标点相对chart框的距离X方向，鼠标点相对chart框的距离Y方向，chart框相对cell-main的距离X方向，chart框相对cell-main的距离Y方向，水平滚动条的位置，垂直滚动条的位置]\n                    chartInfo.chartparam.luckysheetCurrentChartMoveXy = [\n                        e.pageX - toffset.left,\n                        e.pageY - toffset.top,\n                        tpsition.left,\n                        tpsition.top,\n                        $('#luckysheet-scrollbar-x').scrollLeft(),\n                        $('#luckysheet-scrollbar-y').scrollTop()\n                    ];\n                    chartInfo.chartparam.luckysheetCurrentChartMoveWinH = $('#luckysheet-cell-main')[0].scrollHeight;\n                    chartInfo.chartparam.luckysheetCurrentChartMoveWinW = $('#luckysheet-cell-main')[0].scrollWidth;\n                    if (!$(e.target).hasClass('luckysheet-mousedown-cancel') && $(e.target).filter(\"[class*='sp-palette']\").length == 0 && $(e.target).filter(\"[class*='sp-thumb']\").length == 0 && $(e.target).filter(\"[class*='sp-']\").length == 0) {\n                        $('#luckysheet-rightclick-menu').hide();\n                        $('#luckysheet-cols-h-hover').hide();\n                        $('#luckysheet-cols-menu-btn').hide();\n                        $('#luckysheet-rightclick-menu').hide();\n                        $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu').hide();\n                        $('body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu').hide();\n                    }\n                    e.stopPropagation();\n                }\n            }).find('.luckysheet-modal-dialog-resize-item').mousedown(function (e) {\n                if (chartInfo.chartparam.luckysheetCurrentChartActive) {\n                    chartInfo.chartparam.luckysheetCurrentChartResize = $(this).data('type');    //开始状态resize\n                    //开始状态resize\n                    var mouse = mouseposition(e.pageX, e.pageY), scrollLeft = $('#luckysheet-scrollbar-x').scrollLeft(), scrollTop = $('#luckysheet-scrollbar-y').scrollTop();\n                    var x = mouse[0] + scrollLeft;\n                    var y = mouse[1] + scrollTop;\n                    var position = chartInfo.chartparam.luckysheetCurrentChartResizeObj.position();    //参数：x,y:鼠标位置，$t.width(), $t.height(): chart框宽高， position.left + scrollLeft, position.top + scrollTop ：chart框位置 ，scrollLeft, scrollTop：滚动条位置\n                    //参数：x,y:鼠标位置，$t.width(), $t.height(): chart框宽高， position.left + scrollLeft, position.top + scrollTop ：chart框位置 ，scrollLeft, scrollTop：滚动条位置\n                    chartInfo.chartparam.luckysheetCurrentChartResizeXy = [\n                        x,\n                        y,\n                        $t.width(),\n                        $t.height(),\n                        position.left + scrollLeft,\n                        position.top + scrollTop,\n                        scrollLeft,\n                        scrollTop\n                    ];\n                    chartInfo.chartparam.luckysheetCurrentChartResizeWinH = $('#luckysheet-cell-main')[0].scrollHeight;\n                    chartInfo.chartparam.luckysheetCurrentChartResizeWinW = $('#luckysheet-cell-main')[0].scrollWidth;\n                    chartInfo.chartparam.luckysheetCurrentChart = chart_id;\n                    e.stopPropagation();\n                }\n            });\n            let width = chart.width;\n            let height = chart.height;\n            let left = chart.left;\n            let top = chart.top;\n            container.style.width = width + 'px';\n            container.style.height = height + 'px';\n            container.style.position = 'absolute';\n            container.style.background = '#fff';\n            container.style.left = left + 'px';\n            container.style.top = top + 'px';\n            container.style.zIndex = chartInfo.zIndex ? chartInfo.zIndex : 15;\n            chartInfo.zIndex++;\n        }\n    }\n    function jfrefreshchartall(flowdata1, r_st, r_ed, c_st, c_ed) {\n        let chart = chartInfo.currentChart;\n        if (!chart) {\n            return;\n        }\n        if (chart.rangeArray.length == 1) {\n            var row = chart.rangeArray[0].row;\n            var column = chart.rangeArray[0].column;    //不在范围内的不更新\n            //不在范围内的不更新\n            if (r_st > row[1] || r_ed < row[0] || c_st > column[1] || c_ed < column[0]) {\n                return;\n            }    //根据原有的范围取得数据\n            //根据原有的范围取得数据\n            var luckysheetgetcellrange = formula.getcellrange(chart.rangeTxt);\n            var sheetIndex = luckysheetgetcellrange.sheetIndex == -1 ? 0 : luckysheetgetcellrange.sheetIndex;    //sheetIndex为-1时，转化为0\n            //sheetIndex为-1时，转化为0\n            var selection = {\n                row: luckysheetgetcellrange.row,\n                column: luckysheetgetcellrange.column,\n                dataSheetIndex: sheetIndex\n            };    //数组\n            //数组\n            var getcelldata = luckysheet_getcelldata(chart.rangeTxt);\n            if (typeof getcelldata === 'object' && getcelldata.length != 0 && getcelldata.data.length != null) {\n                //getcelldata有值，且不为空数组 && getcelldata.data为二维数组\n                var chartData = getcelldata.data;\n                chartInfo.chartparam.changeChartCellData(chart.chart_id, chartData);\n            }\n        }\n    }\n    function chart_selection() {\n        return {\n            create: function () {\n                var chart_json = chartInfo.currentChart;\n                if (chart_json.rangeArray.length > 1) {\n                    return;\n                }\n                $('#luckysheet-chart-rangeShow').empty();\n                $('#luckysheet-cell-selected-boxs').hide();\n                $('#luckysheet-cell-selected-focus').hide();\n                $('#luckysheet-rows-h-selected').empty();\n                $('#luckysheet-cols-h-selected').empty();\n                $('#luckysheet-row-count-show').hide();\n                $('#luckysheet-column-count-show').hide();\n                var st_r = chart_json.rangeArray[0].row[0];\n                var st_c = chart_json.rangeArray[0].column[0];\n                var rangeSplitArray = chart_json.rangeSplitArray;    //首行是否标题\n                //首行是否标题\n                var rangeRowCheck = chart_json.rangeRowCheck;\n                if (rangeRowCheck.exits) {\n                    var chart_rowtitle_html = getRangeShowHtml('rowtitle', rangeSplitArray.rowtitle.row[0] + st_r, rangeSplitArray.rowtitle.row[1] + st_r, rangeSplitArray.rowtitle.column[0] + st_c, rangeSplitArray.rowtitle.column[1] + st_c);\n                } else {\n                    var chart_rowtitle_html = '';\n                }    //首列是否标题\n                //首列是否标题\n                var rangeColCheck = chart_json.rangeColCheck;\n                if (rangeColCheck.exits) {\n                    var chart_coltitle_html = getRangeShowHtml('coltitle', rangeSplitArray.coltitle.row[0] + st_r, rangeSplitArray.coltitle.row[1] + st_r, rangeSplitArray.coltitle.column[0] + st_c, rangeSplitArray.coltitle.column[1] + st_c);\n                } else {\n                    var chart_coltitle_html = '';\n                }    //内容块\n                //内容块\n                var chart_content_html = getRangeShowHtml('content', rangeSplitArray.content.row[0] + st_r, rangeSplitArray.content.row[1] + st_r, rangeSplitArray.content.column[0] + st_c, rangeSplitArray.content.column[1] + st_c);\n                $('#luckysheet-chart-rangeShow').append(chart_rowtitle_html + chart_coltitle_html + chart_content_html);\n                function getRangeShowHtml(type, r1, r2, c1, c2) {\n                    var visibledatarow = getvisibledatarow();\n                    var visibledatacolumn = getvisibledatacolumn();\n                    var row = visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : visibledatarow[r1 - 1];\n                    var col = visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : visibledatacolumn[c1 - 1];\n                    if (type == 'rowtitle') {\n                        var color = '#C65151';\n                    }\n                    if (type == 'coltitle') {\n                        var color = '#9667C0';\n                    }\n                    if (type == 'content') {\n                        var color = '#4970D1';\n                    }\n                    var html = '<div id=\"luckysheet-chart-rangeShow-' + type + '\" style=\"left: ' + col_pre + 'px;width: ' + (col - col_pre - 1) + 'px;top: ' + row_pre + 'px;height: ' + (row - row_pre - 1) + 'px;border: none;margin: 0;position: absolute;z-index: 14;\">' + '<div class=\"luckysheet-chart-rangeShow-move\" data-type=\"top\" style=\"height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: ' + color + ';position: absolute;left: 0;right: 0;top: -2px;z-index: 18;opacity: 0.9;cursor: move;\"></div>' + '<div class=\"luckysheet-chart-rangeShow-move\" data-type=\"right\" style=\"width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: ' + color + ';position: absolute;top: 0;bottom: 0;right: -2px;z-index: 18;opacity: 0.9;cursor: move;\"></div>' + '<div class=\"luckysheet-chart-rangeShow-move\" data-type=\"bottom\" style=\"height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: ' + color + ';position: absolute;left: 0;right: 0;bottom: -2px;z-index: 18;opacity: 0.9;cursor: move;\"></div>' + '<div class=\"luckysheet-chart-rangeShow-move\" data-type=\"left\" style=\"width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: ' + color + ';position: absolute;top: 0;bottom: 0;left: -2px;z-index: 18;opacity: 0.9;cursor: move;\"></div>' + '<div style=\"border: 2px solid #85c0fc;background: ' + color + ';position: absolute;top: 0;right: 0;bottom: 0;left: 0;z-index: 15;opacity: 0.1;\"></div>' + '<div class=\"luckysheet-chart-rangeShow-resize\" data-type=\"lt\" style=\"width: 6px;height: 6px;border: 1px solid #fff;background: ' + color + ';position: absolute;left: -3px;top: -3px;z-index: 19;cursor: se-resize;\"></div>' + '<div class=\"luckysheet-chart-rangeShow-resize\" data-type=\"rt\" style=\"width: 6px;height: 6px;border: 1px solid #fff;background: ' + color + ';position: absolute;right: -3px;top: -3px;z-index: 19;cursor: ne-resize;\"></div>' + '<div class=\"luckysheet-chart-rangeShow-resize\" data-type=\"lb\" style=\"width: 6px;height: 6px;border: 1px solid #fff;background: ' + color + ';position: absolute;left: -3px;bottom: -3px;z-index: 19;cursor: ne-resize;\"></div>' + '<div class=\"luckysheet-chart-rangeShow-resize\" data-type=\"rb\" style=\"width: 6px;height: 6px;border: 1px solid #fff;background: ' + color + ';position: absolute;right: -3px;bottom: -3px;z-index: 19;cursor: se-resize;\"></div>' + '</div>';\n                    return html;\n                }\n            },\n            rangeMove: false,\n            rangeMovexy: null,\n            rangeMoveIndex: null,\n            rangeMoveObj: null,\n            rangeMoveDraging: function (event, sheetBarHeight, statisticBarHeight) {\n                var chart_json = chartInfo.currentChart;\n                var st_r = chart_json.rangeArray[0].row[0];\n                var st_c = chart_json.rangeArray[0].column[0];\n                var rangeRowCheck = chart_json.rangeRowCheck;\n                var rangeColCheck = chart_json.rangeColCheck;\n                var rangeSplitArray = chart_json.rangeSplitArray;\n                var mouse = mouseposition(event.pageX, event.pageY);\n                var scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                var scrollTop = $('#luckysheet-cell-main').scrollTop();\n                var x = mouse[0] + scrollLeft;\n                var y = mouse[1] + scrollTop;\n                var winH = $(window).height() + scrollTop - sheetBarHeight - statisticBarHeight, winW = $(window).width() + scrollLeft;\n                var rowLocation = _rowLocation(y), row_index = rowLocation[2];\n                var colLocation = _colLocation(x), col_index = colLocation[2];\n                var visibledatarow = getvisibledatarow();\n                var visibledatacolumn = getvisibledatacolumn();\n                var $id = chartInfo.chart_selection.rangeMoveObj.attr('id');\n                if ($id == 'luckysheet-chart-rangeShow-content') {\n                    //行\n                    var row_s = chartInfo.chart_selection.rangeMoveIndex[0] - chartInfo.chart_selection.rangeMovexy[0] + row_index;\n                    if (rangeRowCheck.exits) {\n                        if (row_s < st_r + rangeRowCheck.range[1] + 1 || y < 0) {\n                            row_s = st_r + rangeRowCheck.range[1] + 1;\n                        }\n                    } else {\n                        if (row_s < 0 || y < 0) {\n                            row_s = 0;\n                        }\n                    }\n                    var row_e = rangeSplitArray.content.row[1] - rangeSplitArray.content.row[0] + row_s;\n                    if (row_e >= visibledatarow.length - 1 || y > winH) {\n                        row_s = visibledatarow.length - 1 - rangeSplitArray.content.row[1] + rangeSplitArray.content.row[0];\n                        row_e = visibledatarow.length - 1;\n                    }    //列\n                    //列\n                    var col_s = chartInfo.chart_selection.rangeMoveIndex[1] - chartInfo.chart_selection.rangeMovexy[1] + col_index;\n                    if (rangeColCheck.exits) {\n                        if (col_s < st_c + rangeColCheck.range[1] + 1 || x < 0) {\n                            col_s = st_c + rangeColCheck.range[1] + 1;\n                        }\n                    } else {\n                        if (col_s < 0 || x < 0) {\n                            col_s = 0;\n                        }\n                    }\n                    var col_e = rangeSplitArray.content.column[1] - rangeSplitArray.content.column[0] + col_s;\n                    if (col_e >= visibledatacolumn.length - 1 || x > winW) {\n                        col_s = visibledatacolumn.length - 1 - rangeSplitArray.content.column[1] + rangeSplitArray.content.column[0];\n                        col_e = visibledatacolumn.length - 1;\n                    }    //更新\n                    //更新\n                    if (rangeRowCheck.exits && rangeColCheck.exits) {\n                        chart_json.rangeArray = [{\n                                row: [\n                                    st_r,\n                                    row_e\n                                ],\n                                column: [\n                                    st_c,\n                                    col_e\n                                ]\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: [\n                                st_r,\n                                row_e\n                            ],\n                            column: [\n                                st_c,\n                                col_e\n                            ]\n                        };\n                        chart_json.rangeSplitArray.content = {\n                            row: [\n                                row_s - st_r,\n                                row_e - st_r\n                            ],\n                            column: [\n                                col_s - st_c,\n                                col_e - st_c\n                            ]\n                        };\n                        chart_json.rangeSplitArray.rowtitle = {\n                            row: chart_json.rangeSplitArray.rowtitle.row,\n                            column: [\n                                col_s - st_c,\n                                col_e - st_c\n                            ]\n                        };\n                        chart_json.rangeSplitArray.coltitle = {\n                            row: [\n                                row_s - st_r,\n                                row_e - st_r\n                            ],\n                            column: chart_json.rangeSplitArray.coltitle.column\n                        };\n                    } else if (rangeRowCheck.exits) {\n                        chart_json.rangeArray = [{\n                                row: [\n                                    st_r,\n                                    row_e\n                                ],\n                                column: [\n                                    col_s,\n                                    col_e\n                                ]\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: [\n                                st_r,\n                                row_e\n                            ],\n                            column: [\n                                col_s,\n                                col_e\n                            ]\n                        };\n                        chart_json.rangeSplitArray.content = {\n                            row: [\n                                row_s - st_r,\n                                row_e - st_r\n                            ],\n                            column: chart_json.rangeSplitArray.content.column\n                        };\n                    } else if (rangeColCheck.exits) {\n                        chart_json.rangeArray = [{\n                                row: [\n                                    row_s,\n                                    row_e\n                                ],\n                                column: [\n                                    st_c,\n                                    col_e\n                                ]\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: [\n                                row_s,\n                                row_e\n                            ],\n                            column: [\n                                st_c,\n                                col_e\n                            ]\n                        };\n                        chart_json.rangeSplitArray.content = {\n                            row: chart_json.rangeSplitArray.content.row,\n                            column: [\n                                col_s - st_c,\n                                col_e - st_c\n                            ]\n                        };\n                    } else {\n                        chart_json.rangeArray = [{\n                                row: [\n                                    row_s,\n                                    row_e\n                                ],\n                                column: [\n                                    col_s,\n                                    col_e\n                                ]\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: [\n                                row_s,\n                                row_e\n                            ],\n                            column: [\n                                col_s,\n                                col_e\n                            ]\n                        };\n                    }\n                } else if ($id == 'luckysheet-chart-rangeShow-rowtitle') {\n                    //列\n                    var col_s = chartInfo.chart_selection.rangeMoveIndex[1] - chartInfo.chart_selection.rangeMovexy[1] + col_index;\n                    if (rangeColCheck.exits) {\n                        if (col_s < st_c + rangeColCheck.range[1] + 1 || x < 0) {\n                            col_s = st_c + rangeColCheck.range[1] + 1;\n                        }\n                    } else {\n                        if (col_s < 0 || x < 0) {\n                            col_s = 0;\n                        }\n                    }\n                    var col_e = rangeSplitArray.rowtitle.column[1] - rangeSplitArray.rowtitle.column[0] + col_s;\n                    if (col_e >= visibledatacolumn.length - 1 || x > winW) {\n                        col_s = visibledatacolumn.length - 1 - rangeSplitArray.rowtitle.column[1] + rangeSplitArray.rowtitle.column[0];\n                        col_e = visibledatacolumn.length - 1;\n                    }    //更新\n                    //更新\n                    if (rangeColCheck.exits) {\n                        chart_json.rangeArray = [{\n                                row: chart_json.rangeArray[0].row,\n                                column: [\n                                    st_c,\n                                    col_e\n                                ]\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: chart_json.rangeArray[0].row,\n                            column: [\n                                st_c,\n                                col_e\n                            ]\n                        };\n                        chart_json.rangeSplitArray.rowtitle = {\n                            row: chart_json.rangeSplitArray.rowtitle.row,\n                            column: [\n                                col_s - st_c,\n                                col_e - st_c\n                            ]\n                        };\n                        chart_json.rangeSplitArray.content = {\n                            row: chart_json.rangeSplitArray.content.row,\n                            column: [\n                                col_s - st_c,\n                                col_e - st_c\n                            ]\n                        };\n                    } else {\n                        chart_json.rangeArray = [{\n                                row: chart_json.rangeArray[0].row,\n                                column: [\n                                    col_s,\n                                    col_e\n                                ]\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: chart_json.rangeArray[0].row,\n                            column: [\n                                col_s,\n                                col_e\n                            ]\n                        };\n                    }\n                } else if ($id == 'luckysheet-chart-rangeShow-coltitle') {\n                    //行\n                    var row_s = chartInfo.chart_selection.rangeMoveIndex[0] - chartInfo.chart_selection.rangeMovexy[0] + row_index;\n                    if (rangeRowCheck.exits) {\n                        if (row_s < st_r + rangeRowCheck.range[1] + 1 || y < 0) {\n                            row_s = st_r + rangeRowCheck.range[1] + 1;\n                        }\n                    } else {\n                        if (row_s < 0 || y < 0) {\n                            row_s = 0;\n                        }\n                    }    //更新\n                    //更新\n                    var row_e = rangeSplitArray.coltitle.row[1] - rangeSplitArray.coltitle.row[0] + row_s;\n                    if (row_e >= visibledatarow.length - 1 || y > winH) {\n                        row_s = visibledatarow.length - 1 - rangeSplitArray.coltitle.row[1] + rangeSplitArray.coltitle.row[0];\n                        row_e = visibledatarow.length - 1;\n                    }\n                    if (rangeRowCheck.exits) {\n                        chart_json.rangeArray = [{\n                                row: [\n                                    st_r,\n                                    row_e\n                                ],\n                                column: chart_json.rangeArray[0].column\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: [\n                                st_r,\n                                row_e\n                            ],\n                            column: chart_json.rangeArray[0].column\n                        };\n                        chart_json.rangeSplitArray.coltitle = {\n                            row: [\n                                row_s - st_r,\n                                row_e - st_r\n                            ],\n                            column: chart_json.rangeSplitArray.coltitle.column\n                        };\n                        chart_json.rangeSplitArray.content = {\n                            row: [\n                                row_s - st_r,\n                                row_e - st_r\n                            ],\n                            column: chart_json.rangeSplitArray.content.column\n                        };\n                    } else {\n                        chart_json.rangeArray = [{\n                                row: [\n                                    row_s,\n                                    row_e\n                                ],\n                                column: chart_json.rangeArray[0].column\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: [\n                                row_s,\n                                row_e\n                            ],\n                            column: chart_json.rangeArray[0].column\n                        };\n                    }\n                }\n                chartInfo.chart_selection.create();\n            },\n            rangeMoveDragged: function () {\n                chartInfo.chart_selection.rangeMove = false;\n                var updateJson = chartInfo.currentChart;\n                updateJson.rangeTxt = getRangetxt(chartInfo.currentSheetIndex, updateJson.rangeArray[0], chartInfo.currentSheetIndex);\n                updateJson.chartData = getdatabyselection(updateJson.rangeArray[0], chartInfo.currentSheetIndex);    // 渲染\n                // 渲染\n                chartInfo.changeChartRange(updateJson.chart_id, updateJson.chartData, updateJson.rangeArray, updateJson.rangeTxt);\n            },\n            rangeResize: false,\n            rangeResizexy: null,\n            rangeResizeIndex: null,\n            rangeResizeObj: null,\n            rangeResizeDraging: function (event, sheetBarHeight, statisticBarHeight) {\n                var chart_json = chartInfo.currentChart;\n                var st_r = chart_json.rangeArray[0].row[0];\n                var st_c = chart_json.rangeArray[0].column[0];\n                var rangeRowCheck = chart_json.rangeRowCheck;\n                var rangeColCheck = chart_json.rangeColCheck;\n                var rangeSplitArray = chart_json.rangeSplitArray;\n                var mouse = mouseposition(event.pageX, event.pageY);\n                var scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                var scrollTop = $('#luckysheet-cell-main').scrollTop();\n                var x = mouse[0] + scrollLeft;\n                var y = mouse[1] + scrollTop;\n                var winH = $(window).height() + scrollTop - sheetBarHeight - statisticBarHeight, winW = $(window).width() + scrollLeft;\n                var rowLocation = _rowLocation(y), row_index = rowLocation[2];\n                var colLocation = _colLocation(x), col_index = colLocation[2];\n                var visibledatarow = getvisibledatarow();\n                var visibledatacolumn = getvisibledatacolumn();\n                var $id = chartInfo.chart_selection.rangeResizeObj.attr('id');\n                if ($id == 'luckysheet-chart-rangeShow-content') {\n                    var r1, r2, c1, c2;\n                    if (chartInfo.chart_selection.rangeResize == 'lt') {\n                        r1 = chartInfo.chart_selection.rangeResizeIndex.row[0];\n                        c1 = chartInfo.chart_selection.rangeResizeIndex.column[0];\n                        r2 = chartInfo.chart_selection.rangeResizeIndex.row[1];\n                        c2 = chartInfo.chart_selection.rangeResizeIndex.column[1];\n                    } else if (chartInfo.chart_selection.rangeResize == 'lb') {\n                        r1 = chartInfo.chart_selection.rangeResizeIndex.row[1];\n                        c1 = chartInfo.chart_selection.rangeResizeIndex.column[0];\n                        r2 = chartInfo.chart_selection.rangeResizeIndex.row[0];\n                        c2 = chartInfo.chart_selection.rangeResizeIndex.column[1];\n                    } else if (chartInfo.chart_selection.rangeResize == 'rt') {\n                        r1 = chartInfo.chart_selection.rangeResizeIndex.row[0];\n                        c1 = chartInfo.chart_selection.rangeResizeIndex.column[1];\n                        r2 = chartInfo.chart_selection.rangeResizeIndex.row[1];\n                        c2 = chartInfo.chart_selection.rangeResizeIndex.column[0];\n                    } else if (chartInfo.chart_selection.rangeResize == 'rb') {\n                        r1 = chartInfo.chart_selection.rangeResizeIndex.row[1];\n                        c1 = chartInfo.chart_selection.rangeResizeIndex.column[1];\n                        r2 = chartInfo.chart_selection.rangeResizeIndex.row[0];\n                        c2 = chartInfo.chart_selection.rangeResizeIndex.column[0];\n                    }    //行\n                    //行\n                    if (rangeRowCheck.exits) {\n                        var row_s = r1 - chartInfo.chart_selection.rangeResizexy[0] + row_index;\n                        if (row_s < st_r + rangeRowCheck.range[1] + 1 || y < 0) {\n                            row_s = st_r + rangeRowCheck.range[1] + 1;\n                        } else if (row_s >= visibledatarow.length - 1 || y > winH) {\n                            row_s = visibledatarow.length - 1;\n                        }\n                    } else {\n                        var row_s = st_r - chartInfo.chart_selection.rangeResizexy[0] + row_index;\n                        if (row_s < 0 || y < 0) {\n                            row_s = 0;\n                        } else if (row_s >= visibledatarow.length - 1 || y > winH) {\n                            row_s = visibledatarow.length - 1;\n                        }\n                    }    //列\n                    //列\n                    if (rangeColCheck.exits) {\n                        var col_s = c1 - chartInfo.chart_selection.rangeResizexy[1] + col_index;\n                        if (col_s < st_c + rangeColCheck.range[1] + 1 || x < 0) {\n                            col_s = st_c + rangeColCheck.range[1] + 1;\n                        } else if (col_s >= visibledatacolumn.length - 1 || x > winW) {\n                            col_s = visibledatacolumn.length - 1;\n                        }\n                    } else {\n                        var col_s = st_c - chartInfo.chart_selection.rangeResizexy[1] + col_index;\n                        if (col_s < 0 || x < 0) {\n                            col_s = 0;\n                        } else if (col_s >= visibledatacolumn.length - 1 || x > winW) {\n                            col_s = visibledatacolumn.length - 1;\n                        }\n                    }\n                    var obj_r1, obj_r2, obj_c1, obj_c2;\n                    if (row_s > r2) {\n                        obj_r1 = r2;\n                        obj_r2 = row_s;\n                    } else {\n                        obj_r1 = row_s;\n                        obj_r2 = r2;\n                    }\n                    if (col_s > c2) {\n                        obj_c1 = c2;\n                        obj_c2 = col_s;\n                    } else {\n                        obj_c1 = col_s;\n                        obj_c2 = c2;\n                    }\n                    if (!rangeRowCheck.exits && !rangeColCheck.exits) {\n                        chart_json.rangeArray = [{\n                                row: [\n                                    obj_r1,\n                                    obj_r2\n                                ],\n                                column: [\n                                    obj_c1,\n                                    obj_c2\n                                ]\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: [\n                                obj_r1,\n                                obj_r2\n                            ],\n                            column: [\n                                obj_c1,\n                                obj_c2\n                            ]\n                        };\n                    } else {\n                        chart_json.rangeArray = [{\n                                row: [\n                                    st_r,\n                                    obj_r2\n                                ],\n                                column: [\n                                    st_c,\n                                    obj_c2\n                                ]\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: [\n                                st_r,\n                                obj_r2\n                            ],\n                            column: [\n                                st_c,\n                                obj_c2\n                            ]\n                        };\n                        chart_json.rangeSplitArray.content = {\n                            row: [\n                                obj_r1 - st_r,\n                                obj_r2 - st_r\n                            ],\n                            column: [\n                                obj_c1 - st_c,\n                                obj_c2 - st_c\n                            ]\n                        };\n                        if (rangeRowCheck.exits) {\n                            chart_json.rangeSplitArray.rowtitle = {\n                                row: chart_json.rangeSplitArray.rowtitle.row,\n                                column: [\n                                    obj_c1 - st_c,\n                                    obj_c2 - st_c\n                                ]\n                            };\n                        }\n                        if (rangeColCheck.exits) {\n                            chart_json.rangeSplitArray.coltitle = {\n                                row: [\n                                    obj_r1 - st_r,\n                                    obj_r2 - st_r\n                                ],\n                                column: chart_json.rangeSplitArray.coltitle.column\n                            };\n                        }\n                    }\n                } else if ($id == 'luckysheet-chart-rangeShow-rowtitle') {\n                    var c1, c2;\n                    if (chartInfo.chart_selection.rangeResize == 'lt' || chartInfo.chart_selection.rangeResize == 'lb') {\n                        c1 = chartInfo.chart_selection.rangeResizeIndex.column[0];\n                        c2 = chartInfo.chart_selection.rangeResizeIndex.column[1];\n                    } else if (chartInfo.chart_selection.rangeResize == 'rt' || chartInfo.chart_selection.rangeResize == 'rb') {\n                        c1 = chartInfo.chart_selection.rangeResizeIndex.column[1];\n                        c2 = chartInfo.chart_selection.rangeResizeIndex.column[0];\n                    }    //列\n                    //列\n                    if (rangeColCheck.exits) {\n                        var col_s = c1 - chartInfo.chart_selection.rangeResizexy[1] + col_index;\n                        if (col_s < st_c + rangeColCheck.range[1] + 1 || x < 0) {\n                            col_s = st_c + rangeColCheck.range[1] + 1;\n                        } else if (col_s >= visibledatacolumn.length - 1 || x > winW) {\n                            col_s = visibledatacolumn.length - 1;\n                        }\n                    } else {\n                        var col_s = st_c - chartInfo.chart_selection.rangeResizexy[1] + col_index;\n                        if (col_s < 0 || x < 0) {\n                            col_s = 0;\n                        } else if (col_s >= visibledatacolumn.length - 1 || x > winW) {\n                            col_s = visibledatacolumn.length - 1;\n                        }\n                    }\n                    var obj_c1, obj_c2;\n                    if (col_s > c2) {\n                        obj_c1 = c2;\n                        obj_c2 = col_s;\n                    } else {\n                        obj_c1 = col_s;\n                        obj_c2 = c2;\n                    }    //更新\n                    //更新\n                    if (!rangeColCheck.exits) {\n                        chart_json.rangeArray = [{\n                                row: chart_json.rangeArray[0].row,\n                                column: [\n                                    obj_c1,\n                                    obj_c2\n                                ]\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: chart_json.rangeArray[0].row,\n                            column: [\n                                obj_c1,\n                                obj_c2\n                            ]\n                        };\n                    } else {\n                        chart_json.rangeArray = [{\n                                row: chart_json.rangeArray[0].row,\n                                column: [\n                                    st_c,\n                                    obj_c2\n                                ]\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: chart_json.rangeArray[0].row,\n                            column: [\n                                st_c,\n                                obj_c2\n                            ]\n                        };\n                        chart_json.rangeSplitArray.rowtitle = {\n                            row: chart_json.rangeSplitArray.rowtitle.row,\n                            column: [\n                                obj_c1 - st_c,\n                                obj_c2 - st_c\n                            ]\n                        };\n                        chart_json.rangeSplitArray.content = {\n                            row: chart_json.rangeSplitArray.content.row,\n                            column: [\n                                obj_c1 - st_c,\n                                obj_c2 - st_c\n                            ]\n                        };\n                    }\n                } else if ($id == 'luckysheet-chart-rangeShow-coltitle') {\n                    var r1, r2;\n                    if (chartInfo.chart_selection.rangeResize == 'lt' || chartInfo.chart_selection.rangeResize == 'rt') {\n                        r1 = chartInfo.chart_selection.rangeResizeIndex.row[0];\n                        r2 = chartInfo.chart_selection.rangeResizeIndex.row[1];\n                    } else if (chartInfo.chart_selection.rangeResize == 'lb' || chartInfo.chart_selection.rangeResize == 'rb') {\n                        r1 = chartInfo.chart_selection.rangeResizeIndex.row[1];\n                        r2 = chartInfo.chart_selection.rangeResizeIndex.row[0];\n                    }    //行\n                    //行\n                    if (rangeRowCheck.exits) {\n                        var row_s = r1 - chartInfo.chart_selection.rangeResizexy[0] + row_index;\n                        if (row_s < st_r + rangeRowCheck.range[1] + 1 || y < 0) {\n                            row_s = st_r + rangeRowCheck.range[1] + 1;\n                        } else if (row_s >= visibledatarow.length - 1 || y > winH) {\n                            row_s = visibledatarow.length - 1;\n                        }\n                    } else {\n                        var row_s = st_r - chartInfo.chart_selection.rangeResizexy[0] + row_index;\n                        if (row_s < 0 || y < 0) {\n                            row_s = 0;\n                        } else if (row_s >= visibledatarow.length - 1 || y > winH) {\n                            row_s = visibledatarow.length - 1;\n                        }\n                    }\n                    var obj_r1, obj_r2;\n                    if (row_s > r2) {\n                        obj_r1 = r2;\n                        obj_r2 = row_s;\n                    } else {\n                        obj_r1 = row_s;\n                        obj_r2 = r2;\n                    }    //更新\n                    //更新\n                    if (!rangeRowCheck.exits) {\n                        chart_json.rangeArray = [{\n                                row: [\n                                    obj_r1,\n                                    obj_r2\n                                ],\n                                column: chart_json.rangeArray[0].column\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: [\n                                obj_r1,\n                                obj_r2\n                            ],\n                            column: chart_json.rangeArray[0].column\n                        };\n                    } else {\n                        chart_json.rangeArray = [{\n                                row: [\n                                    st_r,\n                                    obj_r2\n                                ],\n                                column: chart_json.rangeArray[0].column\n                            }];\n                        chart_json.rangeSplitArray.range = {\n                            row: [\n                                st_r,\n                                obj_r2\n                            ],\n                            column: chart_json.rangeArray[0].column\n                        };\n                        chart_json.rangeSplitArray.coltitle = {\n                            row: [\n                                obj_r1 - st_r,\n                                obj_r2 - st_r\n                            ],\n                            column: chart_json.rangeSplitArray.coltitle.column\n                        };\n                        chart_json.rangeSplitArray.content = {\n                            row: [\n                                obj_r1 - st_r,\n                                obj_r2 - st_r\n                            ],\n                            column: chart_json.rangeSplitArray.content.column\n                        };\n                    }\n                }\n                chartInfo.chart_selection.create();\n            },\n            rangeResizeDragged: function () {\n                chartInfo.chart_selection.rangeResize = null;\n                var updateJson = chartInfo.currentChart;\n                updateJson.rangeTxt = getRangetxt(chartInfo.currentSheetIndex, updateJson.rangeArray[0], chartInfo.currentSheetIndex);\n                updateJson.chartData = getdatabyselection(updateJson.rangeArray[0], chartInfo.currentSheetIndex);    // 渲染\n                // 渲染\n                chartInfo.changeChartRange(updateJson.chart_id, updateJson.chartData, updateJson.rangeArray, updateJson.rangeTxt);\n            }\n        };\n    }    // create chart\n    // create chart\n    function createLuckyChart(width, height, left, top) {\n        //如果只选中一个单元格，则自动填充选取\n        var jfgird_select_save = luckysheet.getluckysheet_select_save();\n        if (jfgird_select_save.length == 1 && jfgird_select_save[0].row[0] == jfgird_select_save[0].row[1] && jfgird_select_save[0].column[0] == jfgird_select_save[0].column[1]) {\n            luckysheetMoveHighlightRange2('right', 'rangeOfSelect');\n            luckysheetMoveHighlightRange2('down', 'rangeOfSelect');\n            jfgird_select_save = luckysheet.getluckysheet_select_save();\n        }    //处理右边的空白单元格，自动略过并修改选区 ---------------start\n        //处理右边的空白单元格，自动略过并修改选区 ---------------start\n        var shiftpositon_row = -1;\n        var row_ed = jfgird_select_save[0]['row'][1] - jfgird_select_save[0]['row'][0];\n        for (var r = jfgird_select_save[0]['row'][0]; r <= jfgird_select_save[0]['row'][1]; r++) {\n            for (var c = jfgird_select_save[0]['column'][0]; c <= jfgird_select_save[0]['column'][1]; c++) {\n                var value = getcellvalue(r, c, luckysheet.flowdata());    //console.log(\"value,r,c\",value,r,c);\n                //console.log(\"value,r,c\",value,r,c);\n                if (value != null && value.toString().length > 0) {\n                    shiftpositon_row = r;\n                    break;\n                }\n            }\n            if (shiftpositon_row !== -1) {\n                break;\n            }\n        }\n        if (shiftpositon_row == -1) {\n            shiftpositon_row = 0;\n        }\n        jfgird_select_save[0]['row'] = [\n            shiftpositon_row,\n            shiftpositon_row\n        ];\n        luckysheet.setluckysheet_select_save(jfgird_select_save);\n        chartInfo.luckysheet_shiftpositon = $.extend(true, {}, jfgird_select_save[0]);\n        luckysheetMoveEndCell('down', 'range', false, row_ed);\n        jfgird_select_save = luckysheet.getluckysheet_select_save();\n        var shiftpositon_col = -1;\n        var column_ed = jfgird_select_save[0]['column'][1] - jfgird_select_save[0]['column'][0];\n        for (var c = jfgird_select_save[0]['column'][0]; c <= jfgird_select_save[0]['column'][1]; c++) {\n            for (var r = jfgird_select_save[0]['row'][0]; r <= jfgird_select_save[0]['row'][1]; r++) {\n                var value = getcellvalue(r, c, luckysheet.flowdata());\n                if (value != null && value.toString().length > 0) {\n                    shiftpositon_col = c;\n                    break;\n                }\n            }\n            if (shiftpositon_col !== -1) {\n                break;\n            }\n        }\n        if (shiftpositon_col == -1) {\n            shiftpositon_col = 0;\n        }\n        jfgird_select_save[0]['column'] = [\n            shiftpositon_col,\n            shiftpositon_col\n        ];\n        luckysheet.setluckysheet_select_save(jfgird_select_save);\n        chartInfo.luckysheet_shiftpositon = $.extend(true, {}, jfgird_select_save[0]);\n        luckysheetMoveEndCell('right', 'range', false, column_ed);\n        jfgird_select_save = luckysheet.getluckysheet_select_save();\n        var rangeArray = $.extend(true, [], jfgird_select_save);\n        var rangeTxt = getRangetxt(chartInfo.currentSheetIndex, rangeArray[0], chartInfo.currentSheetIndex);\n        let chartData = getdatabyselection();\n        console.dir(chartData);\n        let chart_id = generateRandomKey('chart');\n        let chart_id_c = chart_id + '_c';\n        let modelChartShowHTML = '<div id=\"${id}\"class=\"luckysheet-modal-dialog luckysheet-modal-dialog-chart ${addclass}\"tabindex=\"0\"role=\"dialog\"aria-labelledby=\":41e\"dir=\"ltr\"><div class=\"luckysheet-modal-dialog-resize\"><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt\"data-type=\"lt\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt\"data-type=\"mt\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm\"data-type=\"lm\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm\"data-type=\"rm\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt\"data-type=\"rt\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb\"data-type=\"lb\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb\"data-type=\"mb\"></div><div class=\"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb\"data-type=\"rb\"></div></div><div class=\"luckysheet-modal-dialog-controll\"><span class=\"luckysheet-modal-controll-btn luckysheet-modal-controll-update\"role=\"button\"tabindex=\"0\"aria-label=\"修改图表\"title=\"修改图表\"><i class=\"fa fa-pencil\"aria-hidden=\"true\"></i></span><span class=\"luckysheet-modal-controll-btn luckysheet-modal-controll-max\"role=\"butluckysheet_chartIns_indexton\"tabindex=\"0\"aria-label=\"最大化\"title=\"最大化\"><i class=\"fa fa-window-maximize\"aria-hidden=\"true\"></i></span><span class=\"luckysheet-modal-controll-btn luckysheet-modal-controll-del\"role=\"button\"tabindex=\"0\"aria-label=\"删除\"title=\"删除\"><i class=\"fa fa-trash\"aria-hidden=\"true\"></i></span></div><div class=\"luckysheet-modal-dialog-content\">${content}</div></div>';\n        let $t = $(replaceHtml(modelChartShowHTML, {\n            id: chart_id_c,\n            addclass: 'luckysheet-data-visualization-chart',\n            title: '图表生成',\n            content: ''\n        })).appendTo($('.luckysheet-cell-main'));\n        let container = document.getElementById(chart_id_c);\n        let {render, chart_json} = chartInfo.createChart($(`#${ chart_id_c }`).children('.luckysheet-modal-dialog-content')[0], chartData, chart_id, rangeArray, rangeTxt);    // chartInfo.currentChart = chart_json.chartOptions\n        // chartInfo.currentChart = chart_json.chartOptions\n        console.dir(JSON.stringify(chart_json));\n        width = width ? width : 400;\n        height = height ? height : 250;\n        left = left ? left : 0;\n        top = top ? top : 0;\n        container.style.width = width + 'px';\n        container.style.height = height + 'px';\n        container.style.position = 'absolute';\n        container.style.background = '#fff';\n        container.style.left = left + 'px';\n        container.style.top = top + 'px';\n        render.style.width = '100%';\n        render.style.height = '100%';\n        container.style.zIndex = chartInfo.zIndex ? chartInfo.zIndex : 15;\n        chartInfo.zIndex++;    // insert chartinfo\n        // insert chartinfo\n        let sheetFile = chartInfo.luckysheetfile[getSheetIndex(chartInfo.currentSheetIndex)];\n        if (!sheetFile.chart) {\n            sheetFile.chart = [];\n        }\n        sheetFile.chart.push({\n            chart_id,\n            width,\n            height,\n            left,\n            top,\n            sheetIndex: sheetFile.index\n        });    //处理区域高亮框参数，当前页中，只有当前的图表的needRangShow为true,其他为false\n        //处理区域高亮框参数，当前页中，只有当前的图表的needRangShow为true,其他为false\n        showNeedRangeShow(chart_id);    // delete current chart\n        // delete current chart\n        $(`#${ chart_id }_c .luckysheet-modal-controll-del`).click(function (e) {\n            delChart(chart_id);\n        });\n        setChartMoveableEffect($t);    // edit current chart\n        // edit current chart\n        $(`#${ chart_id }_c .luckysheet-modal-controll-update`).click(function (e) {\n            showChartSettingComponent();\n        });\n        $t.children('.luckysheet-modal-dialog-content').mousedown(function (e) {\n            if (!chartInfo.chartparam.luckysheetCurrentChartMaxState) {\n                //当前图表显示区域高亮\n                showNeedRangeShow(chart_id);\n            }\n            e.stopPropagation();\n        });\n        $t.mousedown(function (e) {\n            //move chart\n            if (!chartInfo.chartparam.luckysheetCurrentChartMaxState) {\n                //当前图表显示区域高亮\n                showNeedRangeShow(chart_id);\n                setluckysheet_scroll_status(true);    //允许拖动渲染框\n                //允许拖动渲染框\n                if (!$(e.target).is('.luckysheet-modal-dialog-controll') && !$(e.target).is('.luckysheet-modal-controll-btn') && !$(e.target).is('i')) {\n                    // Debounce\n                    chartInfo.chartparam.luckysheetCurrentChartMoveTimeout = setTimeout(function () {\n                        chartInfo.chartparam.luckysheetCurrentChartMove = true;\n                    }, 100);\n                }\n                var toffset = chartInfo.chartparam.luckysheetCurrentChartMoveObj.offset();\n                var tpsition = chartInfo.chartparam.luckysheetCurrentChartMoveObj.position();    //luckysheetCurrentChartMoveXy: [鼠标点相对chart框的距离X方向，鼠标点相对chart框的距离Y方向，chart框相对cell-main的距离X方向，chart框相对cell-main的距离Y方向，水平滚动条的位置，垂直滚动条的位置]\n                //luckysheetCurrentChartMoveXy: [鼠标点相对chart框的距离X方向，鼠标点相对chart框的距离Y方向，chart框相对cell-main的距离X方向，chart框相对cell-main的距离Y方向，水平滚动条的位置，垂直滚动条的位置]\n                chartInfo.chartparam.luckysheetCurrentChartMoveXy = [\n                    e.pageX - toffset.left,\n                    e.pageY - toffset.top,\n                    tpsition.left,\n                    tpsition.top,\n                    $('#luckysheet-scrollbar-x').scrollLeft(),\n                    $('#luckysheet-scrollbar-y').scrollTop()\n                ];\n                chartInfo.chartparam.luckysheetCurrentChartMoveWinH = $('#luckysheet-cell-main')[0].scrollHeight;\n                chartInfo.chartparam.luckysheetCurrentChartMoveWinW = $('#luckysheet-cell-main')[0].scrollWidth;\n                if (!$(e.target).hasClass('luckysheet-mousedown-cancel') && $(e.target).filter(\"[class*='sp-palette']\").length == 0 && $(e.target).filter(\"[class*='sp-thumb']\").length == 0 && $(e.target).filter(\"[class*='sp-']\").length == 0) {\n                    $('#luckysheet-rightclick-menu').hide();\n                    $('#luckysheet-cols-h-hover').hide();\n                    $('#luckysheet-cols-menu-btn').hide();\n                    $('#luckysheet-rightclick-menu').hide();\n                    $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu').hide();\n                    $('body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu').hide();\n                }\n                e.stopPropagation();\n            }\n        }).find('.luckysheet-modal-dialog-resize-item').mousedown(function (e) {\n            if (chartInfo.chartparam.luckysheetCurrentChartActive) {\n                chartInfo.chartparam.luckysheetCurrentChartResize = $(this).data('type');    //开始状态resize\n                //开始状态resize\n                var mouse = mouseposition(e.pageX, e.pageY), scrollLeft = $('#luckysheet-scrollbar-x').scrollLeft(), scrollTop = $('#luckysheet-scrollbar-y').scrollTop();\n                var x = mouse[0] + scrollLeft;\n                var y = mouse[1] + scrollTop;\n                var position = chartInfo.chartparam.luckysheetCurrentChartResizeObj.position();    //参数：x,y:鼠标位置，$t.width(), $t.height(): chart框宽高， position.left + scrollLeft, position.top + scrollTop ：chart框位置 ，scrollLeft, scrollTop：滚动条位置\n                //参数：x,y:鼠标位置，$t.width(), $t.height(): chart框宽高， position.left + scrollLeft, position.top + scrollTop ：chart框位置 ，scrollLeft, scrollTop：滚动条位置\n                chartInfo.chartparam.luckysheetCurrentChartResizeXy = [\n                    x,\n                    y,\n                    $t.width(),\n                    $t.height(),\n                    position.left + scrollLeft,\n                    position.top + scrollTop,\n                    scrollLeft,\n                    scrollTop\n                ];\n                chartInfo.chartparam.luckysheetCurrentChartResizeWinH = $('#luckysheet-cell-main')[0].scrollHeight;\n                chartInfo.chartparam.luckysheetCurrentChartResizeWinW = $('#luckysheet-cell-main')[0].scrollWidth;\n                chartInfo.chartparam.luckysheetCurrentChart = chart_id;\n                e.stopPropagation();\n            }\n        });\n    }    /**\n * 设置图表可拖动区域高亮效果，鼠标经过可拖动区域时鼠标显示“十字”，不可拖动区域显示箭头\n * @param {JQuery} $container 图表的容器DIV\n */\n    /**\n * 设置图表可拖动区域高亮效果，鼠标经过可拖动区域时鼠标显示“十字”，不可拖动区域显示箭头\n * @param {JQuery} $container 图表的容器DIV\n */\n    function setChartMoveableEffect($container) {\n        $container.find('.luckysheet-modal-dialog-content').hover(function () {\n            $container.removeClass('chart-moveable');\n        }, function () {\n            $container.addClass('chart-moveable');\n        });\n        $container.hover(function () {\n            $container.addClass('chart-moveable');\n        }, function () {\n            $container.removeClass('chart-moveable');\n        });\n    }    // delete chart\n    // delete chart\n    function delChart(chart_id) {\n        // delete container\n        $(`.luckysheet-cell-main #${ chart_id }_c`).remove();    // Hide selected range\n        // Hide selected range\n        hideAllNeedRangeShow();    // delete storage\n        // delete storage\n        let sheetFile = chartInfo.luckysheetfile[getSheetIndex(chartInfo.currentSheetIndex)];\n        let index = sheetFile.chart.findIndex(item => item.chart_id == chart_id);\n        sheetFile.chart.splice(index, 1);    // api call\n        // api call\n        chartInfo.deleteChart(chart_id);\n    }    //设置某个图表的高亮区域状态为显示,处理当前页的所有图表，只取一个图表设置为显示，其他隐藏，其他页不管\n    //设置某个图表的高亮区域状态为显示,处理当前页的所有图表，只取一个图表设置为显示，其他隐藏，其他页不管\n    function showNeedRangeShow(chart_id) {\n        let chartLists = chartInfo.luckysheetfile[getSheetIndex(chartInfo.currentSheetIndex)].chart;\n        for (let chartId in chartLists) {\n            // if (chartLists[chartId].sheetIndex == chartInfo.currentSheetIndex) {\n            //当前sheet的图表先设置为false\n            chartLists[chartId].needRangeShow = false;\n            if (chartLists[chartId].chart_id == chart_id) {\n                chartLists[chartId].needRangeShow = true;\n                chartInfo.currentChart = chartInfo.getChartJson(chart_id);\n            }    // }\n        }    //操作DOM当前图表选择区域高亮\n        // }\n        //操作DOM当前图表选择区域高亮\n        selectRangeBorderShow(chart_id);\n    }    //隐藏当前sheet所有的图表高亮区域\n    //隐藏当前sheet所有的图表高亮区域\n    function hideAllNeedRangeShow() {\n        let chartLists = chartInfo.luckysheetfile[getSheetIndex(chartInfo.currentSheetIndex)].chart;\n        for (let chartId in chartLists) {\n            // if (chartLists[chartId].sheetIndex == chartInfo.currentSheetIndex) {\n            //当前sheet的图表设置为false\n            chartLists[chartId].needRangeShow = false;    // }\n        }    //操作DOM 当前图表选择区域隐藏\n        // }\n        //操作DOM 当前图表选择区域隐藏\n        selectRangeBorderHide();\n    }    //选择区域高亮\n    //选择区域高亮\n    function selectRangeBorderShow(chart_id) {\n        let $t = $('#' + chart_id + '_c');    // Highlight of data range\n        // Highlight of data range\n        chartInfo.chart_selection.create();\n        chartInfo.chartparam.luckysheetCurrentChartActive = true;\n        chartInfo.chartparam.luckysheetCurrentChartMoveObj = $t;\n        chartInfo.chartparam.luckysheetCurrentChartResizeObj = $t;\n        chartInfo.chartparam.luckysheetCurrentChart = chart_id;    //luckysheet取cell-main，后续扩展到其他的用户自定义元素\n        //luckysheet取cell-main，后续扩展到其他的用户自定义元素\n        $('#luckysheet-cell-main').find('.luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize').hide();\n        $('#luckysheet-cell-main').find('.luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll').hide();\n        $t.css('z-index', chartInfo.chartparam.luckysheetCurrentChartZIndexRank++);\n        $t.find('.luckysheet-modal-dialog-resize').show();\n        $t.find('.luckysheet-modal-dialog-controll').show();\n        if (($('.chartSetting').is(':visible') || chartInfo.chartparam.luckysheet_chart_redo_click) && chart_id != chartInfo.chartparam.luckysheetCurrentChart) {\n            // TODO: 第一次创建图表时候需要初始化数据选择框 qkSelection\n            // generator.ini(chartMixConfig)\n            $('body .luckysheet-cols-menu').hide();\n        }    // 切换到当前图表设置项\n        // 切换到当前图表设置项\n        chartInfo.currentChart = chartInfo.highlightChart(chart_id);\n    }    //选择区域高亮隐藏\n    //选择区域高亮隐藏\n    function selectRangeBorderHide(settingShow) {\n        $('#luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize, #luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll').hide();\n        $('#luckysheet-cell-main').find('.luckysheet-datavisual-selection-set div').remove();\n        chartInfo.chartparam.luckysheetCurrentChartActive = false;\n        $('#luckysheet-chart-rangeShow').empty();    //标识：是否处理设置界面\n        //标识：是否处理设置界面\n        if (!settingShow && $('.chartSetting').is(':visible') && !isEditMode()) {\n            hideChartSettingComponent();\n        }\n    }    // 显示图表设置界面\n    // 显示图表设置界面\n    function showChartSettingComponent(refresh, chart_id) {\n        if (!$('.chartSetting').is(':visible')) {\n            //隐藏设置界面\n            $('.chartSetting').show();\n            $('#luckysheet-cell-main').find('.luckysheet-datavisual-selection-set div').show();\n            chartInfo.chartparam.luckysheetCurrentChartActive = true;\n            setTimeout(function () {\n                luckysheetsizeauto();\n            }, 0);\n        }\n    }    // 隐藏图表设置界面\n    // 隐藏图表设置界面\n    function hideChartSettingComponent(refresh) {\n        if ($('.chartSetting').is(':visible')) {\n            //隐藏设置界面\n            $('.chartSetting').hide();    //.luckysheet-modal-dialog-resize为图表显示框的缩放框，.luckysheet-modal-dialog-controll为显示框右边的控制按钮\n            //.luckysheet-modal-dialog-resize为图表显示框的缩放框，.luckysheet-modal-dialog-controll为显示框右边的控制按钮\n            $('#luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize, #luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll').hide();\n            $('#luckysheet-cell-main').find('.luckysheet-datavisual-selection-set div').remove();\n            chartInfo.chartparam.luckysheetCurrentChartActive = false;\n            if (!isEditMode() && !refresh) {\n                setTimeout(function () {\n                    luckysheetsizeauto();\n                }, 0);\n            }\n        }\n    }    // 隐藏其他sheet的图表，显示当前sheet的图表 chartMix 切换sheet页显示隐藏图表\n    // 隐藏其他sheet的图表，显示当前sheet的图表 chartMix 切换sheet页显示隐藏图表\n    function renderChartShow(index) {\n        //传入index，图表显示隐藏\n        selectRangeBorderHide('true');    //隐藏数据高亮区域，随意传入一个字符串，表示不处理chartSetting界面\n        //隐藏数据高亮区域，随意传入一个字符串，表示不处理chartSetting界面\n        const luckysheetfile = chartInfo.luckysheetfile;\n        luckysheetfile.forEach(file => {\n            //切换当前页的所有图表都显示出来\n            if (file.index == index) {\n                const chartLists = file.chart || [];\n                chartLists.forEach(chart => {\n                    chart.isShow = true;\n                    $('#' + chart.chart_id + '_c').show();\n                    chartInfo.resizeChart(chart.chart_id);\n                    if (chart.needRangeShow == true) {\n                        //一个sheet页只有一个图表高亮显示,//重要！因为在store了做了存储，所以能在此处找到对应图表设置显示隐藏\n                        //操作DOM当前图表选择区域高亮\n                        chartInfo.currentChart = chartInfo.getChartJson(chart.chart_id);\n                        selectRangeBorderShow(chart.chart_id);\n                    }\n                });\n            }    // 隐藏其他页的图表\n            else\n                // 隐藏其他页的图表\n                {\n                    const chartLists = file.chart || [];\n                    chartLists.forEach(chart => {\n                        chart.isShow = false;\n                        $('#' + chart.chart_id + '_c').hide();\n                    });\n                }\n        });\n    }\n    return {\n        chart,\n        createLuckyChart,\n        hideAllNeedRangeShow,\n        renderChartShow\n    };\n});"]}