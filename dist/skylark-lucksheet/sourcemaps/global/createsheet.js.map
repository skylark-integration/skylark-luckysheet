{"version":3,"sources":["global/createsheet.js"],"names":["define","m_getdata","editor","rhchInit","formula","m_refresh","sheetmanage","Store","datagridgrowth","luckysheetrefreshgrid","colwidth","rowheight","data","cfg","active","visibledatarow","visibledatacolumn","ch_width","rh_height","zoomRatio","config","length","flowdata","webWorkerFlowDataCache","showSheet","setTimeout","restoreCache","execFunctionGroup","restoreSheetAll","currentSheetIndex"],"mappings":";;;;;;;AAAAA,QACI,YACA,WACA,aACA,YACA,YACA,6BACA,YACD,SAAUC,EAAWC,EAAQC,EAAUC,EAASC,EAAWC,EAAaC,GACvE,aACA,MAAMC,eAACA,GAAkBP,GACnBQ,sBAACA,GAAyBJ,EAChC,OAAO,SAA+BK,EAAUC,EAAWC,EAAMC,EAAKC,GACpD,MAAVA,IACAA,GAAS,GAEbP,EAAMQ,kBACNR,EAAMS,qBACNT,EAAMU,SAAW,EACjBV,EAAMW,UAAY,EAClBX,EAAMY,UAAY,EAEdZ,EAAMa,OADC,MAAPP,EACeA,KAIA,GAAfD,EAAKS,OACLd,EAAMe,SAAWd,EAAeI,EAAMD,EAAWD,GAC1CE,EAAKS,OAASV,GAAaC,EAAK,GAAGS,OAASX,EACnDH,EAAMe,SAAWd,EAAeI,EAAMD,EAAYC,EAAKS,OAAQX,EAAWE,EAAK,GAAGS,QAC3ET,EAAKS,OAASV,EACrBJ,EAAMe,SAAWd,EAAeI,EAAMD,EAAYC,EAAKS,OAAQ,GACxDT,EAAK,GAAGS,OAASX,EACxBH,EAAMe,SAAWd,EAAeI,EAAM,EAAGF,EAAWE,EAAK,GAAGS,QAE5Dd,EAAMe,SAAWV,EAErBV,EAAOqB,uBAAuBhB,EAAMe,UAEpCnB,EAASQ,EAAWD,GAChBI,IACAR,EAAYkB,YACZC,WAAW,WACPnB,EAAYoB,eACZtB,EAAQuB,oBACRrB,EAAYsB,gBAAgBrB,EAAMsB,mBAClCpB,KACD","file":"../../global/createsheet.js","sourcesContent":["define([\n    './getdata',\n    './editor',\n    './rhchInit',\n    './formula',\n    './refresh',\n    '../controllers/sheetmanage',\n    '../store'\n], function (m_getdata, editor, rhchInit, formula, m_refresh, sheetmanage, Store) {\n    'use strict';\n    const {datagridgrowth} = m_getdata;\n    const {luckysheetrefreshgrid} = m_refresh;\n    return function luckysheetcreatesheet(colwidth, rowheight, data, cfg, active) {\n        if (active == null) {\n            active = true;\n        }\n        Store.visibledatarow = [];\n        Store.visibledatacolumn = [];\n        Store.ch_width = 0;\n        Store.rh_height = 0;\n        Store.zoomRatio = 1;\n        if (cfg != null) {\n            Store.config = cfg;\n        } else {\n            Store.config = {};\n        }\n        if (data.length == 0) {\n            Store.flowdata = datagridgrowth(data, rowheight, colwidth);\n        } else if (data.length < rowheight && data[0].length < colwidth) {\n            Store.flowdata = datagridgrowth(data, rowheight - data.length, colwidth - data[0].length);\n        } else if (data.length < rowheight) {\n            Store.flowdata = datagridgrowth(data, rowheight - data.length, 0);\n        } else if (data[0].length < colwidth) {\n            Store.flowdata = datagridgrowth(data, 0, colwidth - data[0].length);\n        } else {\n            Store.flowdata = data;\n        }\n        editor.webWorkerFlowDataCache(Store.flowdata);    //worker存数据\n        //worker存数据\n        rhchInit(rowheight, colwidth);\n        if (active) {\n            sheetmanage.showSheet();\n            setTimeout(function () {\n                sheetmanage.restoreCache();\n                formula.execFunctionGroup();\n                sheetmanage.restoreSheetAll(Store.currentSheetIndex);\n                luckysheetrefreshgrid();\n            }, 1);\n        }\n    };\n});"]}