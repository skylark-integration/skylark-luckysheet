{"version":3,"sources":["global/draw.js"],"names":["define","pivotTable","conditionformat","alternateformat","luckysheetSparkline","menuButton","dataVerificationCtrl","m_constant","m_sheetSearch","m_dynamicArray","browser","m_validate","m_getRowlen","m_getdata","m_border","m_get","m_util","m_inlineString","method","Store","locale","sheetmanage","luckysheetdefaultstyle","luckysheet_CFiconsImg","luckysheetdefaultFont","luckysheet_searcharray","dynamicArrayCompute","isRealNull","isRealNum","getMeasureText","getCellTextInfo","getRealCellValue","getBorderInfoComputeRange","getSheetIndex","getObjType","chatatABC","luckysheetfontformat","isInlineStringCell","sparklinesRender","r","c","offsetX","offsetY","canvasid","ctx","flowdata","sparklines","spl","Function","temp1","x","y","render","shapeseq","shapes","pixelWidth","pixelHeight","i","length","nullCellRender","start_r","start_c","end_r","end_c","luckysheetTableContent","af_compute","cf_compute","offsetLeft","offsetTop","dynamicArray_compute","cellOverflowMap","dataset_col_st","dataset_col_ed","scrollHeight","scrollWidth","bodrder05","isMerge","checksAF","checksCF","borderfix","fillStyle","checkstatus","tc","cellsize","createHookFunction","getSheetByIndex","fillRect","value","v","fontset","font","horizonAlignPos","verticalAlignPos","luckysheetrefreshfixed","textBaseline","fillText","ps","ps_w","zoomRatio","ps_h","beginPath","moveTo","lineTo","fill","closePath","cellOverflow_colInObj","cellOverflow_colIn","colLast","cellOverflowRender","rowIndex","colIndex","stc","edc","colIn","luckysheetcurrentisPivotTable","showGridLines","lineWidth","strokeStyle","stroke","cellRender","cell","cellWidth","cellHeight","horizonAlign","verticalAlign","dataVerification","validateCellData","dv_w","dv_h","qp","cellOverflow_bd_r_render","tb","type","pos_x","pos_y","save","rect","clip","scale","measureText","textMetrics","width","oneLineTextHeight","actualBoundingBoxDescent","actualBoundingBoxAscent","verticalCellHeight","verticalAlignPos_text","verticalAlignPos_checkbox","strokeRect","checked","restore","w","space_width","h","space_height","valueType","valueLen","format","minusLen","my_gradient","createLinearGradient","addColorStop","plusLen","textInfo","l","t","values","left","top","textHeightAll","desc","drawImage","ct","fa","indexOf","cellTextRender","visibledatarow","visibledatacolumn","cellOverflow_trace","curC","traceC","traceDir","data","success","mc","start_curC","end_curC","start_traceC","end_traceC","map","col_st","col_ed","rkey","ckey","mapItem","option","rotate","translate","textLeftAll","textTopAll","Math","PI","word","inline","style","fc","txt","content","m","cancelLine","floor","startX","startY","endX","endY","fs","underLine","underLines","a","item","luckysheetDrawgridRowTitle","drawHeight","$","scrollTop","luckysheetTableContentHW","columnHeaderHeight","dataset_row_st","dataset_row_ed","preEndR","get","getContext","devicePixelRatio","clearRect","rowHeaderWidth","firstOffset","lastOffset","height","config","luckysheetDrawgridColumnTitle","drawWidth","scrollLeft","preEndC","abc","round","luckysheetDrawMain","columnOffsetCell","rowOffsetCell","mycanvas","sheetFile","clearTimeout","measureTextCacheTimeOut","fill_row_st","fill_row_ed","fill_col_st","fill_col_ed","err","cellupdate","mergeCache","borderOffset","firstcolumnlen","defaultcollen","key","margeMain","push","luckysheetfile","currentSheetIndex","getComputeMap","canvas","row_st","row_end","cellOverflowMapCache","hasCellOver","textMetricsObj","textWidthAll","trace_forward","trace_backward","trace","getCellOverflowMap","mcArr","cud","toString","margeMaindata","mainCell","rs","cs","drawPivotTable","textAlign","title","pivotTableBoundary","borderLeftRender","color","linetype","m_st","m_ed","line_st","line_ed","setLineDash","borderRightRender","borderBottomRender","borderTopRender","borderInfoCompute","bd_r","substr","bd_c","borderLeft","borderRight","borderTop","borderBottom","b","ch_width","setTimeout","measureTextCache","measureTextCellInfoCache"],"mappings":"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","file":"../../global/draw.js","sourcesContent":["define([\n    '../controllers/pivotTable',\n    '../controllers/conditionformat',\n    '../controllers/alternateformat',\n    '../controllers/sparkline',\n    '../controllers/menuButton',\n    '../controllers/dataVerificationCtrl',\n    '../controllers/constant',\n    '../controllers/sheetSearch',\n    './dynamicArray',\n    './browser',\n    './validate',\n    './getRowlen',\n    './getdata',\n    './border',\n    '../methods/get',\n    '../utils/util',\n    '../controllers/inlineString',\n    './method',\n    '../store',\n    '../locale/locale',\n    '../controllers/sheetmanage'\n], function (pivotTable, conditionformat, alternateformat, luckysheetSparkline, menuButton, dataVerificationCtrl, m_constant, m_sheetSearch, m_dynamicArray, browser, m_validate, m_getRowlen, m_getdata, m_border, m_get, m_util, m_inlineString, method, Store, locale, sheetmanage) {\n    'use strict';\n    const {luckysheetdefaultstyle, luckysheet_CFiconsImg, luckysheetdefaultFont} = m_constant;\n    const {luckysheet_searcharray} = m_sheetSearch;\n    const {dynamicArrayCompute} = m_dynamicArray;\n    const {isRealNull, isRealNum} = m_validate;\n    const {getMeasureText, getCellTextInfo} = m_getRowlen;\n    const {getRealCellValue} = m_getdata;\n    const {getBorderInfoComputeRange} = m_border;\n    const {getSheetIndex} = m_get;\n    const {getObjType, chatatABC, luckysheetfontformat} = m_util;\n    const {isInlineStringCell} = m_inlineString;\n    function luckysheetDrawgridRowTitle(scrollHeight, drawHeight, offsetTop) {\n        if (scrollHeight == null) {\n            scrollHeight = $('#luckysheet-cell-main').scrollTop();\n        }\n        if (drawHeight == null) {\n            drawHeight = Store.luckysheetTableContentHW[1];\n        }\n        if (offsetTop == null) {\n            offsetTop = Store.columnHeaderHeight;\n        }\n        let luckysheetTableContent = $('#luckysheetTableContent').get(0).getContext('2d');\n        luckysheetTableContent.save();\n        luckysheetTableContent.scale(Store.devicePixelRatio, Store.devicePixelRatio);\n        luckysheetTableContent.clearRect(0, offsetTop, Store.rowHeaderWidth - 1, drawHeight);\n        luckysheetTableContent.font = luckysheetdefaultFont();\n        luckysheetTableContent.textBaseline = luckysheetdefaultstyle.textBaseline;    //基准线 垂直居中\n        //基准线 垂直居中\n        luckysheetTableContent.fillStyle = luckysheetdefaultstyle.fillStyle;\n        let dataset_row_st, dataset_row_ed;\n        dataset_row_st = luckysheet_searcharray(Store.visibledatarow, scrollHeight);\n        dataset_row_ed = luckysheet_searcharray(Store.visibledatarow, scrollHeight + drawHeight);\n        if (dataset_row_st == -1) {\n            dataset_row_st = 0;\n        }\n        if (dataset_row_ed == -1) {\n            dataset_row_ed = Store.visibledatarow.length - 1;\n        }\n        luckysheetTableContent.save();\n        luckysheetTableContent.beginPath();\n        luckysheetTableContent.rect(0, offsetTop - 1, Store.rowHeaderWidth - 1, drawHeight - 2);\n        luckysheetTableContent.clip();\n        let end_r, start_r;\n        let bodrder05 = 0.5;    //Default 0.5\n        //Default 0.5\n        let preEndR;\n        for (let r = dataset_row_st; r <= dataset_row_ed; r++) {\n            if (r == 0) {\n                start_r = -scrollHeight - 1;\n            } else {\n                start_r = Store.visibledatarow[r - 1] - scrollHeight - 1;\n            }\n            end_r = Store.visibledatarow[r] - scrollHeight;    //若超出绘制区域终止\n                                                               // if(end_r > scrollHeight + drawHeight){\n                                                               //     break;\n                                                               // }\n            //若超出绘制区域终止\n            // if(end_r > scrollHeight + drawHeight){\n            //     break;\n            // }\n            let firstOffset = dataset_row_st == r ? -2 : 0;\n            let lastOffset = dataset_row_ed == r ? -2 : 0;    //列标题单元格渲染前触发，return false 则不渲染该单元格\n            //列标题单元格渲染前触发，return false 则不渲染该单元格\n            if (!method.createHookFunction('rowTitleCellRenderBefore', r + 1, {\n                    r: r,\n                    top: start_r + offsetTop + firstOffset,\n                    width: Store.rowHeaderWidth - 1,\n                    height: end_r - start_r + 1 + lastOffset - firstOffset\n                }, luckysheetTableContent)) {\n                continue;\n            }\n            if (Store.config['rowhidden'] != null && Store.config['rowhidden'][r] != null) {\n            } else {\n                luckysheetTableContent.fillStyle = '#ffffff';\n                luckysheetTableContent.fillRect(0, start_r + offsetTop + firstOffset, Store.rowHeaderWidth - 1, end_r - start_r + 1 + lastOffset - firstOffset);\n                luckysheetTableContent.fillStyle = '#000000';    //行标题栏序列号\n                //行标题栏序列号\n                luckysheetTableContent.save();    //save scale before draw text\n                //save scale before draw text\n                luckysheetTableContent.scale(Store.zoomRatio, Store.zoomRatio);\n                let textMetrics = getMeasureText(r + 1, luckysheetTableContent);    //luckysheetTableContent.measureText(r + 1);\n                //luckysheetTableContent.measureText(r + 1);\n                let horizonAlignPos = (Store.rowHeaderWidth - textMetrics.width) / 2;\n                let verticalAlignPos = start_r + (end_r - start_r) / 2 + offsetTop;\n                luckysheetTableContent.fillText(r + 1, horizonAlignPos / Store.zoomRatio, verticalAlignPos / Store.zoomRatio);\n                luckysheetTableContent.restore();    //restore scale after draw text\n            }    //vertical\n            //restore scale after draw text\n            //vertical\n            luckysheetTableContent.beginPath();\n            luckysheetTableContent.moveTo(Store.rowHeaderWidth - 2 + bodrder05, start_r + offsetTop - 2);\n            luckysheetTableContent.lineTo(Store.rowHeaderWidth - 2 + bodrder05, end_r + offsetTop - 2);\n            luckysheetTableContent.lineWidth = 1;\n            luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n            luckysheetTableContent.stroke();\n            luckysheetTableContent.closePath();    //行标题栏横线,horizen\n            //行标题栏横线,horizen\n            if (Store.config['rowhidden'] != null && Store.config['rowhidden'][r] == null && Store.config['rowhidden'][r + 1] != null) {\n                luckysheetTableContent.beginPath();\n                luckysheetTableContent.moveTo(-1, end_r + offsetTop - 4 + bodrder05);\n                luckysheetTableContent.lineTo(Store.rowHeaderWidth - 1, end_r + offsetTop - 4 + bodrder05);    // luckysheetTableContent.lineWidth = 1;\n                                                                                                               // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n                // luckysheetTableContent.lineWidth = 1;\n                // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n                luckysheetTableContent.closePath();\n                luckysheetTableContent.stroke();\n            } else if (Store.config['rowhidden'] == null || Store.config['rowhidden'][r] == null) {\n                luckysheetTableContent.beginPath();\n                luckysheetTableContent.moveTo(-1, end_r + offsetTop - 2 + bodrder05);\n                luckysheetTableContent.lineTo(Store.rowHeaderWidth - 1, end_r + offsetTop - 2 + bodrder05);    // luckysheetTableContent.lineWidth = 1;\n                                                                                                               // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n                // luckysheetTableContent.lineWidth = 1;\n                // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n                luckysheetTableContent.closePath();\n                luckysheetTableContent.stroke();\n            }\n            if (Store.config['rowhidden'] != null && Store.config['rowhidden'][r - 1] != null && preEndR != null) {\n                luckysheetTableContent.beginPath();\n                luckysheetTableContent.moveTo(-1, preEndR + offsetTop + bodrder05);\n                luckysheetTableContent.lineTo(Store.rowHeaderWidth - 1, preEndR + offsetTop + bodrder05);\n                luckysheetTableContent.closePath();\n                luckysheetTableContent.stroke();\n            }\n            preEndR = end_r;    //列标题单元格渲染前触发，return false 则不渲染该单元格\n            //列标题单元格渲染前触发，return false 则不渲染该单元格\n            method.createHookFunction('rowTitleCellRenderAfter', r + 1, {\n                r: r,\n                top: start_r + offsetTop + firstOffset,\n                width: Store.rowHeaderWidth - 1,\n                height: end_r - start_r + 1 + lastOffset - firstOffset\n            }, luckysheetTableContent);\n        }    //行标题栏竖线\n             // luckysheetTableContent.beginPath();\n             // luckysheetTableContent.moveTo(\n             //     (Store.rowHeaderWidth - 2 + 0.5) ,\n             //     (offsetTop - 1) \n             // );\n             // luckysheetTableContent.lineTo(\n             //     (Store.rowHeaderWidth - 2 + 0.5) ,\n             //     (Store.rh_height + offsetTop) \n             // );\n             // luckysheetTableContent.lineWidth = 1;\n             // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n             // luckysheetTableContent.closePath();\n             // luckysheetTableContent.stroke();\n             //清除canvas左上角区域 防止列标题栏序列号溢出显示\n             // luckysheetTableContent.clearRect(0, 0, Store.rowHeaderWidth , Store.columnHeaderHeight );\n             // Must be restored twice, otherwise it will be enlarged under window.devicePixelRatio = 1.5\n        //行标题栏竖线\n        // luckysheetTableContent.beginPath();\n        // luckysheetTableContent.moveTo(\n        //     (Store.rowHeaderWidth - 2 + 0.5) ,\n        //     (offsetTop - 1) \n        // );\n        // luckysheetTableContent.lineTo(\n        //     (Store.rowHeaderWidth - 2 + 0.5) ,\n        //     (Store.rh_height + offsetTop) \n        // );\n        // luckysheetTableContent.lineWidth = 1;\n        // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n        // luckysheetTableContent.closePath();\n        // luckysheetTableContent.stroke();\n        //清除canvas左上角区域 防止列标题栏序列号溢出显示\n        // luckysheetTableContent.clearRect(0, 0, Store.rowHeaderWidth , Store.columnHeaderHeight );\n        // Must be restored twice, otherwise it will be enlarged under window.devicePixelRatio = 1.5\n        luckysheetTableContent.restore();\n        luckysheetTableContent.restore();\n    }\n    function luckysheetDrawgridColumnTitle(scrollWidth, drawWidth, offsetLeft) {\n        if (scrollWidth == null) {\n            scrollWidth = $('#luckysheet-cell-main').scrollLeft();\n        }\n        if (drawWidth == null) {\n            drawWidth = Store.luckysheetTableContentHW[0];\n        }\n        if (offsetLeft == null) {\n            offsetLeft = Store.rowHeaderWidth;\n        }\n        let luckysheetTableContent = $('#luckysheetTableContent').get(0).getContext('2d');\n        luckysheetTableContent.save();\n        luckysheetTableContent.scale(Store.devicePixelRatio, Store.devicePixelRatio);\n        luckysheetTableContent.clearRect(offsetLeft, 0, drawWidth, Store.columnHeaderHeight - 1);\n        luckysheetTableContent.font = luckysheetdefaultFont();\n        luckysheetTableContent.textBaseline = luckysheetdefaultstyle.textBaseline;    //基准线 垂直居中\n        //基准线 垂直居中\n        luckysheetTableContent.fillStyle = luckysheetdefaultstyle.fillStyle;\n        let dataset_col_st, dataset_col_ed;\n        dataset_col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollWidth);\n        dataset_col_ed = luckysheet_searcharray(Store.visibledatacolumn, scrollWidth + drawWidth);\n        if (dataset_col_st == -1) {\n            dataset_col_st = 0;\n        }\n        if (dataset_col_ed == -1) {\n            dataset_col_ed = Store.visibledatacolumn.length - 1;\n        }\n        luckysheetTableContent.save();\n        luckysheetTableContent.beginPath();\n        luckysheetTableContent.rect(offsetLeft - 1, 0, drawWidth, Store.columnHeaderHeight - 1);\n        luckysheetTableContent.clip();    // console.log(offsetLeft, 0, drawWidth, Store.columnHeaderHeight -1);\n        // console.log(offsetLeft, 0, drawWidth, Store.columnHeaderHeight -1);\n        let end_c, start_c;\n        let bodrder05 = 0.5;    //Default 0.5\n        //Default 0.5\n        let preEndC;\n        for (let c = dataset_col_st; c <= dataset_col_ed; c++) {\n            if (c == 0) {\n                start_c = -scrollWidth;\n            } else {\n                start_c = Store.visibledatacolumn[c - 1] - scrollWidth;\n            }\n            end_c = Store.visibledatacolumn[c] - scrollWidth;    //若超出绘制区域终止\n                                                                 // if(end_c > scrollWidth + drawWidth+1){\n                                                                 //     break;\n                                                                 // }\n            //若超出绘制区域终止\n            // if(end_c > scrollWidth + drawWidth+1){\n            //     break;\n            // }\n            let abc = chatatABC(c);    //列标题单元格渲染前触发，return false 则不渲染该单元格\n            //列标题单元格渲染前触发，return false 则不渲染该单元格\n            if (!method.createHookFunction('columnTitleCellRenderBefore', abc, {\n                    c: c,\n                    left: start_c + offsetLeft - 1,\n                    width: end_c - start_c,\n                    height: Store.columnHeaderHeight - 1\n                }, luckysheetTableContent)) {\n                continue;\n            }\n            if (Store.config['colhidden'] != null && Store.config['colhidden'][c] != null) {\n            } else {\n                luckysheetTableContent.fillStyle = '#ffffff';\n                luckysheetTableContent.fillRect(start_c + offsetLeft - 1, 0, end_c - start_c, Store.columnHeaderHeight - 1);\n                luckysheetTableContent.fillStyle = '#000000';    //列标题栏序列号\n                //列标题栏序列号\n                luckysheetTableContent.save();    //save scale before draw text\n                //save scale before draw text\n                luckysheetTableContent.scale(Store.zoomRatio, Store.zoomRatio);\n                let textMetrics = getMeasureText(abc, luckysheetTableContent);    //luckysheetTableContent.measureText(abc);\n                //luckysheetTableContent.measureText(abc);\n                let horizonAlignPos = Math.round(start_c + (end_c - start_c) / 2 + offsetLeft - textMetrics.width / 2);\n                let verticalAlignPos = Math.round(Store.columnHeaderHeight / 2);\n                luckysheetTableContent.fillText(abc, horizonAlignPos / Store.zoomRatio, verticalAlignPos / Store.zoomRatio);\n                luckysheetTableContent.restore();    //restore scale after draw text\n            }    //列标题栏竖线 vertical\n            //restore scale after draw text\n            //列标题栏竖线 vertical\n            if (Store.config['colhidden'] != null && Store.config['colhidden'][c] == null && Store.config['colhidden'][c + 1] != null) {\n                luckysheetTableContent.beginPath();\n                luckysheetTableContent.moveTo(end_c + offsetLeft - 4 + bodrder05, 0);\n                luckysheetTableContent.lineTo(end_c + offsetLeft - 4 + bodrder05, Store.columnHeaderHeight - 2);\n                luckysheetTableContent.lineWidth = 1;\n                luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n                luckysheetTableContent.closePath();\n                luckysheetTableContent.stroke();\n            } else if (Store.config['colhidden'] == null || Store.config['colhidden'][c] == null) {\n                luckysheetTableContent.beginPath();\n                luckysheetTableContent.moveTo(end_c + offsetLeft - 2 + bodrder05, 0);\n                luckysheetTableContent.lineTo(end_c + offsetLeft - 2 + bodrder05, Store.columnHeaderHeight - 2);\n                luckysheetTableContent.lineWidth = 1;\n                luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n                luckysheetTableContent.closePath();\n                luckysheetTableContent.stroke();\n            }\n            if (Store.config['colhidden'] != null && Store.config['colhidden'][c - 1] != null && preEndC != null) {\n                luckysheetTableContent.beginPath();\n                luckysheetTableContent.moveTo(preEndC + offsetLeft + bodrder05, 0);\n                luckysheetTableContent.lineTo(preEndC + offsetLeft + bodrder05, Store.columnHeaderHeight - 2);    // luckysheetTableContent.lineWidth = 1;\n                                                                                                                  // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n                // luckysheetTableContent.lineWidth = 1;\n                // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n                luckysheetTableContent.closePath();\n                luckysheetTableContent.stroke();\n            }    //horizen\n            //horizen\n            luckysheetTableContent.beginPath();\n            luckysheetTableContent.moveTo(start_c + offsetLeft - 1, Store.columnHeaderHeight - 2 + bodrder05);\n            luckysheetTableContent.lineTo(end_c + offsetLeft - 1, Store.columnHeaderHeight - 2 + bodrder05);    // luckysheetTableContent.lineWidth = 1;\n                                                                                                                // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;        \n            // luckysheetTableContent.lineWidth = 1;\n            // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;        \n            luckysheetTableContent.stroke();\n            luckysheetTableContent.closePath();\n            preEndC = end_c;\n            method.createHookFunction('columnTitleCellRenderAfter', abc, {\n                c: c,\n                left: start_c + offsetLeft - 1,\n                width: end_c - start_c,\n                height: Store.columnHeaderHeight - 1\n            }, luckysheetTableContent);\n        }    //列标题栏横线\n             // luckysheetTableContent.beginPath();\n             // luckysheetTableContent.moveTo(\n             //     (offsetLeft - 1) ,\n             //     (Store.columnHeaderHeight - 2 + 0.5) \n             // );\n             // luckysheetTableContent.lineTo(\n             //     (Store.ch_width + offsetLeft - 2) ,\n             //     (Store.columnHeaderHeight - 2 + 0.5) \n             // );\n             // luckysheetTableContent.lineWidth = 1;\n             // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n             // luckysheetTableContent.closePath();\n             // luckysheetTableContent.stroke();\n             //清除canvas左上角区域 防止列标题栏序列号溢出显示\n             // luckysheetTableContent.clearRect(0, 0, Store.rowHeaderWidth , Store.columnHeaderHeight );\n             // Must be restored twice, otherwise it will be enlarged under window.devicePixelRatio = 1.5\n        //列标题栏横线\n        // luckysheetTableContent.beginPath();\n        // luckysheetTableContent.moveTo(\n        //     (offsetLeft - 1) ,\n        //     (Store.columnHeaderHeight - 2 + 0.5) \n        // );\n        // luckysheetTableContent.lineTo(\n        //     (Store.ch_width + offsetLeft - 2) ,\n        //     (Store.columnHeaderHeight - 2 + 0.5) \n        // );\n        // luckysheetTableContent.lineWidth = 1;\n        // luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n        // luckysheetTableContent.closePath();\n        // luckysheetTableContent.stroke();\n        //清除canvas左上角区域 防止列标题栏序列号溢出显示\n        // luckysheetTableContent.clearRect(0, 0, Store.rowHeaderWidth , Store.columnHeaderHeight );\n        // Must be restored twice, otherwise it will be enlarged under window.devicePixelRatio = 1.5\n        luckysheetTableContent.restore();\n        luckysheetTableContent.restore();\n    }\n    function luckysheetDrawMain(scrollWidth, scrollHeight, drawWidth, drawHeight, offsetLeft, offsetTop, columnOffsetCell, rowOffsetCell, mycanvas) {\n        if (Store.flowdata == null) {\n            return;\n        }\n        let sheetFile = sheetmanage.getSheetByIndex();    // console.trace();\n        // console.trace();\n        clearTimeout(Store.measureTextCacheTimeOut);    //参数未定义处理\n        //参数未定义处理\n        if (scrollWidth == null) {\n            scrollWidth = $('#luckysheet-cell-main').scrollLeft();\n        }\n        if (scrollHeight == null) {\n            scrollHeight = $('#luckysheet-cell-main').scrollTop();\n        }\n        if (drawWidth == null) {\n            drawWidth = Store.luckysheetTableContentHW[0];\n        }\n        if (drawHeight == null) {\n            drawHeight = Store.luckysheetTableContentHW[1];\n        }\n        if (offsetLeft == null) {\n            offsetLeft = Store.rowHeaderWidth;\n        }\n        if (offsetTop == null) {\n            offsetTop = Store.columnHeaderHeight;\n        }\n        if (columnOffsetCell == null) {\n            columnOffsetCell = 0;\n        }\n        if (rowOffsetCell == null) {\n            rowOffsetCell = 0;\n        }    //表格canvas\n        //表格canvas\n        let luckysheetTableContent = null;\n        if (mycanvas == null) {\n            luckysheetTableContent = $('#luckysheetTableContent').get(0).getContext('2d');\n        } else {\n            if (getObjType(mycanvas) == 'object') {\n                try {\n                    luckysheetTableContent = mycanvas.get(0).getContext('2d');\n                } catch (err) {\n                    luckysheetTableContent = mycanvas;\n                }\n            } else {\n                luckysheetTableContent = $('#' + mycanvas).get(0).getContext('2d');\n            }\n        }\n        luckysheetTableContent.save();\n        luckysheetTableContent.scale(Store.devicePixelRatio, Store.devicePixelRatio);\n        luckysheetTableContent.clearRect(0, 0, Store.luckysheetTableContentHW[0], Store.luckysheetTableContentHW[1]);    //表格渲染区域 起止行列下标\n        //表格渲染区域 起止行列下标\n        let dataset_row_st, dataset_row_ed, dataset_col_st, dataset_col_ed;\n        dataset_row_st = luckysheet_searcharray(Store.visibledatarow, scrollHeight);\n        dataset_row_ed = luckysheet_searcharray(Store.visibledatarow, scrollHeight + drawHeight);\n        if (dataset_row_st == -1) {\n            dataset_row_st = 0;\n        }\n        dataset_row_st += rowOffsetCell;\n        if (dataset_row_ed == -1) {\n            dataset_row_ed = Store.visibledatarow.length - 1;\n        }\n        dataset_row_ed += rowOffsetCell;\n        if (dataset_row_ed >= Store.visibledatarow.length) {\n            dataset_row_ed = Store.visibledatarow.length - 1;\n        }\n        dataset_col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollWidth);\n        dataset_col_ed = luckysheet_searcharray(Store.visibledatacolumn, scrollWidth + drawWidth);\n        if (dataset_col_st == -1) {\n            dataset_col_st = 0;\n        }\n        dataset_col_st += columnOffsetCell;\n        if (dataset_col_ed == -1) {\n            dataset_col_ed = Store.visibledatacolumn.length - 1;\n        }\n        dataset_col_ed += columnOffsetCell;\n        if (dataset_col_ed >= Store.visibledatacolumn.length) {\n            dataset_col_ed = Store.visibledatacolumn.length - 1;\n        }    //表格渲染区域 起止行列坐标\n        //表格渲染区域 起止行列坐标\n        let fill_row_st, fill_row_ed, fill_col_st, fill_col_ed;\n        if (dataset_row_st == 0) {\n            fill_row_st = 0;\n        } else {\n            fill_row_st = Store.visibledatarow[dataset_row_st - 1];\n        }\n        fill_row_ed = Store.visibledatarow[dataset_row_ed];\n        if (dataset_col_st == 0) {\n            fill_col_st = 0;\n        } else {\n            fill_col_st = Store.visibledatacolumn[dataset_col_st - 1];\n        }\n        fill_col_ed = Store.visibledatacolumn[dataset_col_ed];    //表格canvas 初始化处理\n        //表格canvas 初始化处理\n        luckysheetTableContent.fillStyle = '#ffffff';\n        luckysheetTableContent.fillRect(offsetLeft - 1, offsetTop - 1, fill_col_ed - scrollWidth, fill_row_ed - scrollHeight);\n        luckysheetTableContent.font = luckysheetdefaultFont();    // luckysheetTableContent.textBaseline = \"top\";\n        // luckysheetTableContent.textBaseline = \"top\";\n        luckysheetTableContent.fillStyle = luckysheetdefaultstyle.fillStyle;    //表格渲染区域 非空单元格行列 起止坐标\n        //表格渲染区域 非空单元格行列 起止坐标\n        let cellupdate = [];\n        let mergeCache = {};\n        let borderOffset = {};\n        let bodrder05 = 0.5;    //Default 0.5\n                                // 钩子函数\n        //Default 0.5\n        // 钩子函数\n        method.createHookFunction('cellAllRenderBefore', Store.flowdata, sheetFile, luckysheetTableContent);\n        for (let r = dataset_row_st; r <= dataset_row_ed; r++) {\n            let start_r;\n            if (r == 0) {\n                start_r = -scrollHeight - 1;\n            } else {\n                start_r = Store.visibledatarow[r - 1] - scrollHeight - 1;\n            }\n            let end_r = Store.visibledatarow[r] - scrollHeight;\n            if (Store.config['rowhidden'] != null && Store.config['rowhidden'][r] != null) {\n                continue;\n            }\n            for (let c = dataset_col_st; c <= dataset_col_ed; c++) {\n                let start_c;\n                if (c == 0) {\n                    start_c = -scrollWidth;\n                } else {\n                    start_c = Store.visibledatacolumn[c - 1] - scrollWidth;\n                }\n                let end_c = Store.visibledatacolumn[c] - scrollWidth;\n                if (Store.config['colhidden'] != null && Store.config['colhidden'][c] != null) {\n                    continue;\n                }\n                let firstcolumnlen = Store.defaultcollen;\n                if (Store.config['columnlen'] != null && Store.config['columnlen'][c] != null) {\n                    firstcolumnlen = Store.config['columnlen'][c];\n                }\n                if (Store.flowdata[r] != null && Store.flowdata[r][c] != null) {\n                    let value = Store.flowdata[r][c];\n                    if (getObjType(value) == 'object' && 'mc' in value) {\n                        borderOffset[r + '_' + c] = {\n                            'start_r': start_r,\n                            'start_c': start_c,\n                            'end_r': end_r,\n                            'end_c': end_c\n                        };\n                        if ('rs' in value['mc']) {\n                            let key = 'r' + r + 'c' + c;\n                            mergeCache[key] = cellupdate.length;\n                        } else {\n                            let key = 'r' + value['mc'].r + 'c' + value['mc'].c;\n                            let margeMain = cellupdate[mergeCache[key]];\n                            if (margeMain == null) {\n                                mergeCache[key] = cellupdate.length;\n                                cellupdate.push({\n                                    'r': r,\n                                    'c': c,\n                                    'start_c': start_c,\n                                    'start_r': start_r,\n                                    'end_r': end_r,\n                                    'end_c': end_c,\n                                    'firstcolumnlen': firstcolumnlen\n                                });\n                            } else {\n                                if (margeMain.c == c) {\n                                    margeMain.end_r += end_r - start_r - 1;\n                                }\n                                if (margeMain.r == r) {\n                                    margeMain.end_c += end_c - start_c;\n                                    margeMain.firstcolumnlen += firstcolumnlen;\n                                }\n                            }\n                            continue;\n                        }\n                    }\n                } else {\n                }\n                cellupdate.push({\n                    'r': r,\n                    'c': c,\n                    'start_r': start_r,\n                    'start_c': start_c,\n                    'end_r': end_r,\n                    'end_c': end_c,\n                    'firstcolumnlen': firstcolumnlen\n                });\n                borderOffset[r + '_' + c] = {\n                    'start_r': start_r,\n                    'start_c': start_c,\n                    'end_r': end_r,\n                    'end_c': end_c\n                };\n            }\n        }    //动态数组公式计算\n        //动态数组公式计算\n        let dynamicArray_compute = dynamicArrayCompute(Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['dynamicArray']);    //交替颜色计算\n        //交替颜色计算\n        let af_compute = alternateformat.getComputeMap();    //条件格式计算\n        //条件格式计算\n        let cf_compute = conditionformat.getComputeMap();    //表格渲染区域 溢出单元格配置保存\n        //表格渲染区域 溢出单元格配置保存\n        let cellOverflowMap = getCellOverflowMap(luckysheetTableContent, dataset_col_st, dataset_col_ed, dataset_row_st, dataset_row_ed);\n        let mcArr = [];\n        for (let cud = 0; cud < cellupdate.length; cud++) {\n            let item = cellupdate[cud];\n            let r = item.r, c = item.c, start_r = item.start_r, start_c = item.start_c, end_r = item.end_r, end_c = item.end_c;\n            let firstcolumnlen = item.firstcolumnlen;\n            if (Store.flowdata[r] == null) {\n                continue;\n            }    // //有值单元格渲染前\n                 // if(!method.createHookFunction(\"cellRenderBefore\", Store.flowdata[r][c], {\n                 //     r:r,\n                 //     c:c,\n                 //     \"start_r\": cellsize[1],\n                 //     \"start_c\":cellsize[0], \n                 //     \"end_r\": cellsize[3], \n                 //     \"end_c\": cellsize[2]  \n                 // }, sheetFile,luckysheetTableContent)){ continue; }\n            // //有值单元格渲染前\n            // if(!method.createHookFunction(\"cellRenderBefore\", Store.flowdata[r][c], {\n            //     r:r,\n            //     c:c,\n            //     \"start_r\": cellsize[1],\n            //     \"start_c\":cellsize[0], \n            //     \"end_r\": cellsize[3], \n            //     \"end_c\": cellsize[2]  \n            // }, sheetFile,luckysheetTableContent)){ continue; }\n            if (Store.flowdata[r][c] == null) {\n                //空单元格\n                nullCellRender(r, c, start_r, start_c, end_r, end_c, luckysheetTableContent, af_compute, cf_compute, offsetLeft, offsetTop, dynamicArray_compute, cellOverflowMap, dataset_col_st, dataset_col_ed, scrollHeight, scrollWidth, bodrder05);\n            } else {\n                let cell = Store.flowdata[r][c];\n                let value = null;\n                if (typeof cell == 'object' && 'mc' in cell) {\n                    mcArr.push(cellupdate[cud]);    // continue;\n                } else\n                    // continue;\n                    {\n                        value = getRealCellValue(r, c);\n                    }\n                if (value == null || value.toString().length == 0) {\n                    nullCellRender(r, c, start_r, start_c, end_r, end_c, luckysheetTableContent, af_compute, cf_compute, offsetLeft, offsetTop, dynamicArray_compute, cellOverflowMap, dataset_col_st, dataset_col_ed, scrollHeight, scrollWidth, bodrder05);    //sparklines渲染\n                    //sparklines渲染\n                    let borderfix = menuButton.borderfix(Store.flowdata, r, c);\n                    let cellsize = [\n                        start_c + offsetLeft + borderfix[0],\n                        start_r + offsetTop + borderfix[1],\n                        end_c - start_c - 3 + borderfix[2],\n                        end_r - start_r - 3 - 1 + borderfix[3]\n                    ];\n                    sparklinesRender(r, c, cellsize[0], cellsize[1], 'luckysheetTableContent', luckysheetTableContent);\n                } else {\n                    if (r + '_' + c in dynamicArray_compute) {\n                        //动态数组公式\n                        value = dynamicArray_compute[r + '_' + c].v;\n                    }\n                    cellRender(r, c, start_r, start_c, end_r, end_c, value, luckysheetTableContent, af_compute, cf_compute, offsetLeft, offsetTop, dynamicArray_compute, cellOverflowMap, dataset_col_st, dataset_col_ed, scrollHeight, scrollWidth, bodrder05);\n                }\n            }    // method.createHookFunction(\"cellRenderAfter\", Store.flowdata[r][c], {\n                 //     r:r,\n                 //     c:c,\n                 //     \"start_r\": start_r,\n                 //     \"start_c\": start_c, \n                 //     \"end_r\": end_r, \n                 //     \"end_c\": end_c \n                 // }, sheetFile,luckysheetTableContent)\n        }    //合并单元格再处理\n        // method.createHookFunction(\"cellRenderAfter\", Store.flowdata[r][c], {\n        //     r:r,\n        //     c:c,\n        //     \"start_r\": start_r,\n        //     \"start_c\": start_c, \n        //     \"end_r\": end_r, \n        //     \"end_c\": end_c \n        // }, sheetFile,luckysheetTableContent)\n        //合并单元格再处理\n        for (let m = 0; m < mcArr.length; m++) {\n            let item = mcArr[m];\n            let r = item.r, c = item.c, start_r = item.start_r, start_c = item.start_c, end_r = item.end_r - 1, end_c = item.end_c - 1;\n            let firstcolumnlen = item.firstcolumnlen;\n            let cell = Store.flowdata[r][c];\n            let value = null;\n            let margeMaindata = cell['mc'];\n            value = getRealCellValue(margeMaindata.r, margeMaindata.c);\n            r = margeMaindata.r;\n            c = margeMaindata.c;\n            let mainCell = Store.flowdata[r][c];\n            if (c == 0) {\n                start_c = -scrollWidth;\n            } else {\n                start_c = Store.visibledatacolumn[c - 1] - scrollWidth;\n            }\n            if (r == 0) {\n                start_r = -scrollHeight - 1;\n            } else {\n                start_r = Store.visibledatarow[r - 1] - scrollHeight - 1;\n            }\n            end_r = Store.visibledatarow[r + mainCell['mc'].rs - 1] - scrollHeight;\n            end_c = Store.visibledatacolumn[c + mainCell['mc'].cs - 1] - scrollWidth;\n            if (value == null || value.toString().length == 0) {\n                nullCellRender(r, c, start_r, start_c, end_r, end_c, luckysheetTableContent, af_compute, cf_compute, offsetLeft, offsetTop, dynamicArray_compute, cellOverflowMap, dataset_col_st, dataset_col_ed, scrollHeight, scrollWidth, bodrder05, true);    //sparklines渲染\n                //sparklines渲染\n                let borderfix = menuButton.borderfix(Store.flowdata, r, c);\n                let cellsize = [\n                    start_c + offsetLeft + borderfix[0],\n                    start_r + offsetTop + borderfix[1],\n                    end_c - start_c - 3 + borderfix[2],\n                    end_r - start_r - 3 - 1 + borderfix[3]\n                ];\n                sparklinesRender(r, c, cellsize[0], cellsize[1], 'luckysheetTableContent', luckysheetTableContent);\n            } else {\n                if (r + '_' + c in dynamicArray_compute) {\n                    //动态数组公式\n                    value = dynamicArray_compute[r + '_' + c].v;\n                }\n                cellRender(r, c, start_r, start_c, end_r, end_c, value, luckysheetTableContent, af_compute, cf_compute, offsetLeft, offsetTop, dynamicArray_compute, cellOverflowMap, dataset_col_st, dataset_col_ed, scrollHeight, scrollWidth, bodrder05, true);\n            }\n        }    //数据透视表边框渲染\n        //数据透视表边框渲染\n        for (let r = dataset_row_st; r <= dataset_row_ed; r++) {\n            let start_r;\n            if (r == 0) {\n                start_r = -scrollHeight - 1;\n            } else {\n                start_r = Store.visibledatarow[r - 1] - scrollHeight - 1;\n            }\n            let end_r = Store.visibledatarow[r] - scrollHeight;\n            for (let c = dataset_col_st; c <= dataset_col_ed; c++) {\n                let start_c;\n                if (c == 0) {\n                    start_c = -scrollWidth;\n                } else {\n                    start_c = Store.visibledatacolumn[c - 1] - scrollWidth;\n                }\n                let end_c = Store.visibledatacolumn[c] - scrollWidth;    //数据透视表\n                //数据透视表\n                if (!!Store.luckysheetcurrentisPivotTable && pivotTable.drawPivotTable) {\n                    if ((c == 0 || c == 5) && r <= 11) {\n                        luckysheetTableContent.beginPath();\n                        luckysheetTableContent.moveTo(end_c - 2 + bodrder05 + offsetLeft, start_r + offsetTop);\n                        luckysheetTableContent.lineTo(end_c - 2 + bodrder05 + offsetLeft, end_r - 2 + bodrder05 + offsetTop);\n                        luckysheetTableContent.lineWidth = 1;\n                        luckysheetTableContent.strokeStyle = '#000000';\n                        luckysheetTableContent.closePath();\n                        luckysheetTableContent.stroke();\n                    }\n                    if ((r == 2 || r == 11) && c <= 5) {\n                        luckysheetTableContent.beginPath();\n                        luckysheetTableContent.moveTo(start_c - 1 + offsetLeft, end_r - 2 + bodrder05 + offsetTop);\n                        luckysheetTableContent.lineTo(end_c - 2 + bodrder05 + offsetLeft, end_r - 2 + bodrder05 + offsetTop);\n                        luckysheetTableContent.lineWidth = 1;\n                        luckysheetTableContent.strokeStyle = '#000000';\n                        luckysheetTableContent.closePath();\n                        luckysheetTableContent.stroke();\n                    }\n                    if (r == 6 && c == 3) {\n                        luckysheetTableContent.save();\n                        luckysheetTableContent.font = 'bold 30px Arial';\n                        luckysheetTableContent.fillStyle = '#626675';\n                        luckysheetTableContent.textAlign = 'center';\n                        luckysheetTableContent.fillText(locale().pivotTable.title, start_c + (end_c - start_c) / 2 + 4 + offsetLeft, start_r + (end_r - start_r) / 2 - 1 + offsetTop);\n                        luckysheetTableContent.restore();\n                    }\n                } else if (!!Store.luckysheetcurrentisPivotTable) {\n                    if (c < pivotTable.pivotTableBoundary[1] && r < pivotTable.pivotTableBoundary[0]) {\n                        luckysheetTableContent.beginPath();\n                        luckysheetTableContent.moveTo(end_c - 2 + bodrder05 + offsetLeft, start_r + offsetTop);\n                        luckysheetTableContent.lineTo(end_c - 2 + bodrder05 + offsetLeft, end_r - 2 + bodrder05 + offsetTop);\n                        luckysheetTableContent.lineWidth = 1;\n                        luckysheetTableContent.strokeStyle = '#000000';\n                        luckysheetTableContent.closePath();\n                        luckysheetTableContent.stroke();\n                        luckysheetTableContent.beginPath();\n                        luckysheetTableContent.moveTo(start_c - 1 + offsetLeft, end_r - 2 + bodrder05 + offsetTop);\n                        luckysheetTableContent.lineTo(end_c - 2 + offsetLeft, end_r - 2 + bodrder05 + offsetTop);\n                        luckysheetTableContent.lineWidth = 1;\n                        luckysheetTableContent.strokeStyle = '#000000';\n                        luckysheetTableContent.closePath();\n                        luckysheetTableContent.stroke();\n                    }\n                }\n            }\n        }    //边框单独渲染\n        //边框单独渲染\n        if (Store.config['borderInfo'] != null && Store.config['borderInfo'].length > 0) {\n            //边框渲染\n            let borderLeftRender = function (style, color, start_r, start_c, end_r, end_c, offsetLeft, offsetTop, canvas) {\n                let linetype = style;\n                let m_st = start_c - 2 + bodrder05 + offsetLeft;\n                let m_ed = start_r + offsetTop - 1;\n                let line_st = start_c - 2 + bodrder05 + offsetLeft;\n                let line_ed = end_r - 2 + bodrder05 + offsetTop;\n                canvas.save();\n                menuButton.setLineDash(canvas, linetype, 'v', m_st, m_ed, line_st, line_ed);\n                canvas.strokeStyle = color;\n                canvas.stroke();\n                canvas.closePath();\n                canvas.restore();\n            };\n            let borderRightRender = function (style, color, start_r, start_c, end_r, end_c, offsetLeft, offsetTop, canvas) {\n                let linetype = style;\n                let m_st = end_c - 2 + bodrder05 + offsetLeft;\n                let m_ed = start_r + offsetTop - 1;\n                let line_st = end_c - 2 + bodrder05 + offsetLeft;\n                let line_ed = end_r - 2 + bodrder05 + offsetTop;\n                canvas.save();\n                menuButton.setLineDash(canvas, linetype, 'v', m_st, m_ed, line_st, line_ed);\n                canvas.strokeStyle = color;\n                canvas.stroke();\n                canvas.closePath();\n                canvas.restore();\n            };\n            let borderBottomRender = function (style, color, start_r, start_c, end_r, end_c, offsetLeft, offsetTop, canvas) {\n                let linetype = style;\n                let m_st = start_c - 2 + bodrder05 + offsetLeft;\n                let m_ed = end_r - 2 + bodrder05 + offsetTop;\n                let line_st = end_c - 2 + bodrder05 + offsetLeft;\n                let line_ed = end_r - 2 + bodrder05 + offsetTop;\n                canvas.save();\n                menuButton.setLineDash(canvas, linetype, 'h', m_st, m_ed, line_st, line_ed);\n                canvas.strokeStyle = color;\n                canvas.stroke();\n                canvas.closePath();\n                canvas.restore();\n            };\n            let borderTopRender = function (style, color, start_r, start_c, end_r, end_c, offsetLeft, offsetTop, canvas) {\n                let linetype = style;\n                let m_st = start_c - 2 + bodrder05 + offsetLeft;\n                let m_ed = start_r - 1 + bodrder05 + offsetTop;\n                let line_st = end_c - 2 + bodrder05 + offsetLeft;\n                let line_ed = start_r - 1 + bodrder05 + offsetTop;\n                canvas.save();\n                menuButton.setLineDash(canvas, linetype, 'h', m_st, m_ed, line_st, line_ed);\n                canvas.strokeStyle = color;\n                canvas.stroke();\n                canvas.closePath();\n                canvas.restore();\n            };\n            let borderInfoCompute = getBorderInfoComputeRange(dataset_row_st, dataset_row_ed, dataset_col_st, dataset_col_ed);\n            for (let x in borderInfoCompute) {\n                //let bd_r = x.split(\"_\")[0], bd_c = x.split(\"_\")[1];\n                let bd_r = x.substr(0, x.indexOf('_'));\n                let bd_c = x.substr(x.indexOf('_') + 1);    // if(bd_r < dataset_row_st || bd_r > dataset_row_ed || bd_c < dataset_col_st || bd_c > dataset_col_ed){\n                                                            //     continue;\n                                                            // }\n                // if(bd_r < dataset_row_st || bd_r > dataset_row_ed || bd_c < dataset_col_st || bd_c > dataset_col_ed){\n                //     continue;\n                // }\n                if (borderOffset[bd_r + '_' + bd_c]) {\n                    let start_r = borderOffset[bd_r + '_' + bd_c].start_r;\n                    let start_c = borderOffset[bd_r + '_' + bd_c].start_c;\n                    let end_r = borderOffset[bd_r + '_' + bd_c].end_r;\n                    let end_c = borderOffset[bd_r + '_' + bd_c].end_c;\n                    let cellOverflow_colInObj = cellOverflow_colIn(cellOverflowMap, bd_r, bd_c, dataset_col_st, dataset_col_ed);\n                    let borderLeft = borderInfoCompute[x].l;\n                    if (borderLeft != null && (!cellOverflow_colInObj.colIn || cellOverflow_colInObj.stc == bd_c)) {\n                        borderLeftRender(borderLeft.style, borderLeft.color, start_r, start_c, end_r, end_c, offsetLeft, offsetTop, luckysheetTableContent);\n                    }\n                    let borderRight = borderInfoCompute[x].r;\n                    if (borderRight != null && (!cellOverflow_colInObj.colIn || cellOverflow_colInObj.colLast)) {\n                        borderRightRender(borderRight.style, borderRight.color, start_r, start_c, end_r, end_c, offsetLeft, offsetTop, luckysheetTableContent);\n                    }\n                    let borderTop = borderInfoCompute[x].t;\n                    if (borderTop != null) {\n                        borderTopRender(borderTop.style, borderTop.color, start_r, start_c, end_r, end_c, offsetLeft, offsetTop, luckysheetTableContent);\n                    }\n                    let borderBottom = borderInfoCompute[x].b;\n                    if (borderBottom != null) {\n                        borderBottomRender(borderBottom.style, borderBottom.color, start_r, start_c, end_r, end_c, offsetLeft, offsetTop, luckysheetTableContent);\n                    }\n                }\n            }\n        }    //渲染表格时有尾列时，清除右边灰色区域，防止表格有值溢出\n        //渲染表格时有尾列时，清除右边灰色区域，防止表格有值溢出\n        if (dataset_col_ed == Store.visibledatacolumn.length - 1) {\n            luckysheetTableContent.clearRect(fill_col_ed - scrollWidth + offsetLeft - 1, offsetTop - 1, Store.ch_width - Store.visibledatacolumn[dataset_col_ed], fill_row_ed - scrollHeight);\n        }\n        luckysheetTableContent.restore();\n        Store.measureTextCacheTimeOut = setTimeout(() => {\n            Store.measureTextCache = {};\n            Store.measureTextCellInfoCache = {};\n            Store.cellOverflowMapCache = {};\n        }, 100);\n    }    //sparklines渲染\n    //sparklines渲染\n    let sparklinesRender = function (r, c, offsetX, offsetY, canvasid, ctx) {\n        if (Store.flowdata[r] == null || Store.flowdata[r][c] == null) {\n            return;\n        }\n        let sparklines = Store.flowdata[r][c].spl;\n        if (sparklines != null) {\n            if (typeof sparklines == 'string') {\n                sparklines = new Function('return ' + sparklines)();\n            }\n            if (getObjType(sparklines) == 'object') {\n                let temp1 = sparklines;\n                let x = temp1.offsetX;\n                let y = temp1.offsetY;\n                x = x == null ? 0 : x;\n                y = y == null ? 0 : y;\n                luckysheetSparkline.render(temp1.shapeseq, temp1.shapes, offsetX + x, offsetY + y, temp1.pixelWidth, temp1.pixelHeight, canvasid, ctx);\n            } else if (getObjType(sparklines) == 'array' && getObjType(sparklines[0]) == 'object') {\n                for (let i = 0; i < sparklines.length; i++) {\n                    let temp1 = sparklines[i];\n                    let x = temp1.offsetX;\n                    let y = temp1.offsetY;\n                    x = x == null ? 0 : x;\n                    y = y == null ? 0 : y;\n                    luckysheetSparkline.render(temp1.shapeseq, temp1.shapes, offsetX + x, offsetY + y, temp1.pixelWidth, temp1.pixelHeight, canvasid, ctx);\n                }\n            }\n        }\n    };    //空白单元格渲染 \n    //空白单元格渲染 \n    let nullCellRender = function (r, c, start_r, start_c, end_r, end_c, luckysheetTableContent, af_compute, cf_compute, offsetLeft, offsetTop, dynamicArray_compute, cellOverflowMap, dataset_col_st, dataset_col_ed, scrollHeight, scrollWidth, bodrder05, isMerge) {\n        let checksAF = alternateformat.checksAF(r, c, af_compute);    //交替颜色\n        //交替颜色\n        let checksCF = conditionformat.checksCF(r, c, cf_compute);    //条件格式\n        //条件格式\n        let borderfix = menuButton.borderfix(Store.flowdata, r, c);    //背景色\n        //背景色\n        let fillStyle = menuButton.checkstatus(Store.flowdata, r, c, 'bg');\n        if (checksAF != null && checksAF[1] != null) {\n            //交替颜色 \n            fillStyle = checksAF[1];\n        }\n        if (checksCF != null && checksCF['cellColor'] != null) {\n            //条件格式 \n            fillStyle = checksCF['cellColor'];\n        }\n        if (Store.flowdata[r][c] != null && Store.flowdata[r][c].tc != null) {\n            //标题色\n            fillStyle = Store.flowdata[r][c].tc;\n        }\n        if (fillStyle == null) {\n            luckysheetTableContent.fillStyle = '#FFFFFF';\n        } else {\n            luckysheetTableContent.fillStyle = fillStyle;\n        }\n        let cellsize = [\n            start_c + offsetLeft + borderfix[0],\n            start_r + offsetTop + borderfix[1],\n            end_c - start_c + borderfix[2] - (!!isMerge ? 1 : 0),\n            end_r - start_r + borderfix[3]\n        ];    //单元格渲染前，考虑到合并单元格会再次渲染一遍，统一放到这里\n        //单元格渲染前，考虑到合并单元格会再次渲染一遍，统一放到这里\n        if (!method.createHookFunction('cellRenderBefore', Store.flowdata[r][c], {\n                r: r,\n                c: c,\n                'start_r': cellsize[1],\n                'start_c': cellsize[0],\n                'end_r': cellsize[3] + cellsize[1],\n                'end_c': cellsize[2] + cellsize[0]\n            }, sheetmanage.getSheetByIndex(), luckysheetTableContent)) {\n            return;\n        }\n        luckysheetTableContent.fillRect(cellsize[0], cellsize[1], cellsize[2], cellsize[3]);\n        if (r + '_' + c in dynamicArray_compute) {\n            let value = dynamicArray_compute[r + '_' + c].v;\n            luckysheetTableContent.fillStyle = '#000000';    //文本宽度和高度\n            //文本宽度和高度\n            let fontset = luckysheetdefaultFont();\n            luckysheetTableContent.font = fontset;    //水平对齐 (默认为1，左对齐)\n            //水平对齐 (默认为1，左对齐)\n            let horizonAlignPos = start_c + 4 + offsetLeft;    //垂直对齐 (默认为2，下对齐)\n            //垂直对齐 (默认为2，下对齐)\n            let verticalFixed = browser.luckysheetrefreshfixed();\n            let verticalAlignPos = end_r + offsetTop - 2;\n            luckysheetTableContent.textBaseline = 'bottom';\n            luckysheetTableContent.fillText(value == null ? '' : value, horizonAlignPos, verticalAlignPos);\n        }    //若单元格有批注\n        //若单元格有批注\n        if (Store.flowdata[r][c] != null && Store.flowdata[r][c].ps != null) {\n            let ps_w = 8 * Store.zoomRatio, ps_h = 8 * Store.zoomRatio;\n            luckysheetTableContent.beginPath();\n            luckysheetTableContent.moveTo(end_c + offsetLeft - 1 - ps_w, start_r + offsetTop);\n            luckysheetTableContent.lineTo(end_c + offsetLeft - 1, start_r + offsetTop);\n            luckysheetTableContent.lineTo(end_c + offsetLeft - 1, start_r + offsetTop + ps_h);\n            luckysheetTableContent.fillStyle = '#FC6666';\n            luckysheetTableContent.fill();\n            luckysheetTableContent.closePath();\n        }    //此单元格 与  溢出单元格关系\n        //此单元格 与  溢出单元格关系\n        let cellOverflow_colInObj = cellOverflow_colIn(cellOverflowMap, r, c, dataset_col_st, dataset_col_ed);    //此单元格 为 溢出单元格渲染范围最后一列，绘制溢出单元格内容\n        //此单元格 为 溢出单元格渲染范围最后一列，绘制溢出单元格内容\n        if (cellOverflow_colInObj.colLast) {\n            cellOverflowRender(cellOverflow_colInObj.rowIndex, cellOverflow_colInObj.colIndex, cellOverflow_colInObj.stc, cellOverflow_colInObj.edc, luckysheetTableContent, scrollHeight, scrollWidth, offsetLeft, offsetTop, af_compute, cf_compute);\n        }    //即溢出单元格跨此单元格，此单元格不绘制右边框\n        //即溢出单元格跨此单元格，此单元格不绘制右边框\n        if (!cellOverflow_colInObj.colIn || cellOverflow_colInObj.colLast) {\n            //右边框\n            if (!Store.luckysheetcurrentisPivotTable && !fillStyle && Store.showGridLines) {\n                luckysheetTableContent.beginPath();\n                luckysheetTableContent.moveTo(end_c + offsetLeft - 2 + bodrder05, start_r + offsetTop);\n                luckysheetTableContent.lineTo(end_c + offsetLeft - 2 + bodrder05, end_r + offsetTop);\n                luckysheetTableContent.lineWidth = 1;\n                luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n                luckysheetTableContent.stroke();\n                luckysheetTableContent.closePath();\n            }\n        }    //下边框\n        //下边框\n        if (!Store.luckysheetcurrentisPivotTable && !fillStyle && Store.showGridLines) {\n            luckysheetTableContent.beginPath();\n            luckysheetTableContent.moveTo(start_c + offsetLeft - 1, end_r + offsetTop - 2 + bodrder05);\n            luckysheetTableContent.lineTo(end_c + offsetLeft - 1, end_r + offsetTop - 2 + bodrder05);\n            luckysheetTableContent.lineWidth = 1;\n            luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n            luckysheetTableContent.stroke();\n            luckysheetTableContent.closePath();\n        }    // 单元格渲染后\n        // 单元格渲染后\n        method.createHookFunction('cellRenderAfter', Store.flowdata[r][c], {\n            r: r,\n            c: c,\n            'start_r': cellsize[1],\n            'start_c': cellsize[0],\n            'end_r': cellsize[3] + cellsize[1],\n            'end_c': cellsize[2] + cellsize[0]\n        }, sheetmanage.getSheetByIndex(), luckysheetTableContent);\n    };\n    let cellRender = function (r, c, start_r, start_c, end_r, end_c, value, luckysheetTableContent, af_compute, cf_compute, offsetLeft, offsetTop, dynamicArray_compute, cellOverflowMap, dataset_col_st, dataset_col_ed, scrollHeight, scrollWidth, bodrder05, isMerge) {\n        let cell = Store.flowdata[r][c];\n        let cellWidth = end_c - start_c - 2;\n        let cellHeight = end_r - start_r - 2;\n        let space_width = 2, space_height = 2;    //宽高方向 间隙\n                                                  //水平对齐\n        //宽高方向 间隙\n        //水平对齐\n        let horizonAlign = menuButton.checkstatus(Store.flowdata, r, c, 'ht');    //垂直对齐\n        //垂直对齐\n        let verticalAlign = menuButton.checkstatus(Store.flowdata, r, c, 'vt');    //交替颜色\n        //交替颜色\n        let checksAF = alternateformat.checksAF(r, c, af_compute);    //条件格式\n        //条件格式\n        let checksCF = conditionformat.checksCF(r, c, cf_compute);    //单元格 背景颜色\n        //单元格 背景颜色\n        let fillStyle = menuButton.checkstatus(Store.flowdata, r, c, 'bg');\n        if (checksAF != null && checksAF[1] != null) {\n            //若单元格有交替颜色 背景颜色\n            fillStyle = checksAF[1];\n        }\n        if (checksCF != null && checksCF['cellColor'] != null) {\n            //若单元格有条件格式 背景颜色\n            fillStyle = checksCF['cellColor'];\n        }    // luckysheetTableContent.textBaseline = 'top';\n        // luckysheetTableContent.textBaseline = 'top';\n        if (fillStyle == null) {\n            luckysheetTableContent.fillStyle = '#FFFFFF';\n        } else {\n            luckysheetTableContent.fillStyle = fillStyle;\n        }\n        let borderfix = menuButton.borderfix(Store.flowdata, r, c);    // console.log(value, fillStyle,borderfix);\n        // console.log(value, fillStyle,borderfix);\n        let cellsize = [\n            start_c + offsetLeft + borderfix[0],\n            start_r + offsetTop + borderfix[1],\n            end_c - start_c + borderfix[2] - (!!isMerge ? 1 : 0),\n            end_r - start_r + borderfix[3]\n        ];    //单元格渲染前，考虑到合并单元格会再次渲染一遍，统一放到这里\n        //单元格渲染前，考虑到合并单元格会再次渲染一遍，统一放到这里\n        if (!method.createHookFunction('cellRenderBefore', Store.flowdata[r][c], {\n                r: r,\n                c: c,\n                'start_r': cellsize[1],\n                'start_c': cellsize[0],\n                'end_r': cellsize[3] + cellsize[1],\n                'end_c': cellsize[2] + cellsize[0]\n            }, sheetmanage.getSheetByIndex(), luckysheetTableContent)) {\n            return;\n        }\n        luckysheetTableContent.fillRect(cellsize[0], cellsize[1], cellsize[2], cellsize[3]);\n        let dataVerification = dataVerificationCtrl.dataVerification;\n        if (dataVerification != null && dataVerification[r + '_' + c] != null && !dataVerificationCtrl.validateCellData(value, dataVerification[r + '_' + c])) {\n            //单元格左上角红色小三角标示\n            let dv_w = 5 * Store.zoomRatio, dv_h = 5 * Store.zoomRatio;    //红色小三角宽高\n            //红色小三角宽高\n            luckysheetTableContent.beginPath();\n            luckysheetTableContent.moveTo(start_c + offsetLeft, start_r + offsetTop);\n            luckysheetTableContent.lineTo(start_c + offsetLeft + dv_w, start_r + offsetTop);\n            luckysheetTableContent.lineTo(start_c + offsetLeft, start_r + offsetTop + dv_h);\n            luckysheetTableContent.fillStyle = '#FC6666';\n            luckysheetTableContent.fill();\n            luckysheetTableContent.closePath();\n        }    //若单元格有批注（单元格右上角红色小三角标示）\n        //若单元格有批注（单元格右上角红色小三角标示）\n        if (cell.ps != null) {\n            let ps_w = 8 * Store.zoomRatio, ps_h = 8 * Store.zoomRatio;    //红色小三角宽高\n            //红色小三角宽高\n            luckysheetTableContent.beginPath();\n            luckysheetTableContent.moveTo(end_c + offsetLeft - ps_w, start_r + offsetTop);\n            luckysheetTableContent.lineTo(end_c + offsetLeft, start_r + offsetTop);\n            luckysheetTableContent.lineTo(end_c + offsetLeft, start_r + offsetTop + ps_h);\n            luckysheetTableContent.fillStyle = '#FC6666';\n            luckysheetTableContent.fill();\n            luckysheetTableContent.closePath();\n        }    //若单元格强制为字符串，则显示绿色小三角\n        //若单元格强制为字符串，则显示绿色小三角\n        if (cell.qp == 1 && isRealNum(cell.v)) {\n            let ps_w = 6 * Store.zoomRatio, ps_h = 6 * Store.zoomRatio;    //红色小三角宽高\n            //红色小三角宽高\n            luckysheetTableContent.beginPath();\n            luckysheetTableContent.moveTo(start_c + offsetLeft + ps_w - 1, start_r + offsetTop);\n            luckysheetTableContent.lineTo(start_c + offsetLeft - 1, start_r + offsetTop);\n            luckysheetTableContent.lineTo(start_c + offsetLeft - 1, start_r + offsetTop + ps_h);\n            luckysheetTableContent.fillStyle = '#487f1e';\n            luckysheetTableContent.fill();\n            luckysheetTableContent.closePath();\n        }    //溢出单元格\n        //溢出单元格\n        let cellOverflow_bd_r_render = true;    //溢出单元格右边框是否需要绘制\n        //溢出单元格右边框是否需要绘制\n        let cellOverflow_colInObj = cellOverflow_colIn(cellOverflowMap, r, c, dataset_col_st, dataset_col_ed);\n        if (cell.tb == '1' && cellOverflow_colInObj.colIn) {\n            //此单元格 为 溢出单元格渲染范围最后一列，绘制溢出单元格内容\n            if (cellOverflow_colInObj.colLast) {\n                cellOverflowRender(cellOverflow_colInObj.rowIndex, cellOverflow_colInObj.colIndex, cellOverflow_colInObj.stc, cellOverflow_colInObj.edc, luckysheetTableContent, scrollHeight, scrollWidth, offsetLeft, offsetTop, af_compute, cf_compute);\n            } else {\n                cellOverflow_bd_r_render = false;\n            }\n        }    //数据验证 复选框\n        else //数据验证 复选框\n        if (dataVerification != null && dataVerification[r + '_' + c] != null && dataVerification[r + '_' + c].type == 'checkbox') {\n            let pos_x = start_c + offsetLeft;\n            let pos_y = start_r + offsetTop + 1;\n            luckysheetTableContent.save();\n            luckysheetTableContent.beginPath();\n            luckysheetTableContent.rect(pos_x, pos_y, cellWidth, cellHeight);\n            luckysheetTableContent.clip();\n            luckysheetTableContent.scale(Store.zoomRatio, Store.zoomRatio);\n            let measureText = getMeasureText(value, luckysheetTableContent);\n            let textMetrics = measureText.width + 14;\n            let oneLineTextHeight = measureText.actualBoundingBoxDescent + measureText.actualBoundingBoxAscent;\n            let horizonAlignPos = pos_x + space_width;    //默认为1，左对齐\n            //默认为1，左对齐\n            if (horizonAlign == '0') {\n                //居中对齐\n                horizonAlignPos = pos_x + cellWidth / 2 - textMetrics / 2;\n            } else if (horizonAlign == '2') {\n                //右对齐\n                horizonAlignPos = pos_x + cellWidth - space_width - textMetrics;\n            }\n            let verticalCellHeight = cellHeight > oneLineTextHeight ? cellHeight : oneLineTextHeight;\n            let verticalAlignPos_text = pos_y + verticalCellHeight - space_height;    //文本垂直方向基准线\n            //文本垂直方向基准线\n            luckysheetTableContent.textBaseline = 'bottom';\n            let verticalAlignPos_checkbox = verticalAlignPos_text - 13 * Store.zoomRatio;\n            if (verticalAlign == '0') {\n                //居中对齐 \n                verticalAlignPos_text = pos_y + verticalCellHeight / 2;\n                luckysheetTableContent.textBaseline = 'middle';\n                verticalAlignPos_checkbox = verticalAlignPos_text - 6 * Store.zoomRatio;\n            } else if (verticalAlign == '1') {\n                //上对齐\n                verticalAlignPos_text = pos_y + space_height;\n                luckysheetTableContent.textBaseline = 'top';\n                verticalAlignPos_checkbox = verticalAlignPos_text + 1 * Store.zoomRatio;\n            }\n            horizonAlignPos = horizonAlignPos / Store.zoomRatio;\n            verticalAlignPos_text = verticalAlignPos_text / Store.zoomRatio;\n            verticalAlignPos_checkbox = verticalAlignPos_checkbox / Store.zoomRatio;    //复选框\n            //复选框\n            luckysheetTableContent.lineWidth = 1;\n            luckysheetTableContent.strokeStyle = '#000';\n            luckysheetTableContent.strokeRect(horizonAlignPos, verticalAlignPos_checkbox, 10, 10);\n            if (dataVerification[r + '_' + c].checked) {\n                luckysheetTableContent.beginPath();\n                luckysheetTableContent.lineTo(horizonAlignPos + 1, verticalAlignPos_checkbox + 6);\n                luckysheetTableContent.lineTo(horizonAlignPos + 4, verticalAlignPos_checkbox + 9);\n                luckysheetTableContent.lineTo(horizonAlignPos + 9, verticalAlignPos_checkbox + 2);\n                luckysheetTableContent.stroke();\n                luckysheetTableContent.closePath();\n            }    //文本\n            //文本\n            luckysheetTableContent.fillStyle = menuButton.checkstatus(Store.flowdata, r, c, 'fc');\n            luckysheetTableContent.fillText(value == null ? '' : value, horizonAlignPos + 14, verticalAlignPos_text);\n            luckysheetTableContent.restore();\n        } else {\n            //若单元格有条件格式数据条\n            if (checksCF != null && checksCF['dataBar'] != null) {\n                let x = start_c + offsetLeft + space_width;\n                let y = start_r + offsetTop + space_height;\n                let w = cellWidth - space_width * 2;\n                let h = cellHeight - space_height * 2;\n                let valueType = checksCF['dataBar']['valueType'];\n                let valueLen = checksCF['dataBar']['valueLen'];\n                let format = checksCF['dataBar']['format'];\n                if (valueType == 'minus') {\n                    //负数\n                    let minusLen = checksCF['dataBar']['minusLen'];\n                    if (format.length > 1) {\n                        //渐变\n                        let my_gradient = luckysheetTableContent.createLinearGradient(x + w * minusLen * (1 - valueLen), y, x + w * minusLen, y);\n                        my_gradient.addColorStop(0, '#ffffff');\n                        my_gradient.addColorStop(1, '#ff0000');\n                        luckysheetTableContent.fillStyle = my_gradient;\n                    } else {\n                        //单色\n                        luckysheetTableContent.fillStyle = '#ff0000';\n                    }\n                    luckysheetTableContent.fillRect(x + w * minusLen * (1 - valueLen), y, w * minusLen * valueLen, h);\n                    luckysheetTableContent.beginPath();\n                    luckysheetTableContent.moveTo(x + w * minusLen * (1 - valueLen), y);\n                    luckysheetTableContent.lineTo(x + w * minusLen * (1 - valueLen), y + h);\n                    luckysheetTableContent.lineTo(x + w * minusLen, y + h);\n                    luckysheetTableContent.lineTo(x + w * minusLen, y);\n                    luckysheetTableContent.lineTo(x + w * minusLen * (1 - valueLen), y);\n                    luckysheetTableContent.lineWidth = 1;\n                    luckysheetTableContent.strokeStyle = '#ff0000';\n                    luckysheetTableContent.stroke();\n                    luckysheetTableContent.closePath();\n                } else if (valueType == 'plus') {\n                    //正数\n                    let plusLen = checksCF['dataBar']['plusLen'];\n                    if (plusLen == 1) {\n                        if (format.length > 1) {\n                            //渐变\n                            let my_gradient = luckysheetTableContent.createLinearGradient(x, y, x + w * valueLen, y);\n                            my_gradient.addColorStop(0, format[0]);\n                            my_gradient.addColorStop(1, format[1]);\n                            luckysheetTableContent.fillStyle = my_gradient;\n                        } else {\n                            //单色\n                            luckysheetTableContent.fillStyle = format[0];\n                        }\n                        luckysheetTableContent.fillRect(x, y, w * valueLen, h);\n                        luckysheetTableContent.beginPath();\n                        luckysheetTableContent.moveTo(x, y);\n                        luckysheetTableContent.lineTo(x, y + h);\n                        luckysheetTableContent.lineTo(x + w * valueLen, y + h);\n                        luckysheetTableContent.lineTo(x + w * valueLen, y);\n                        luckysheetTableContent.lineTo(x, y);\n                        luckysheetTableContent.lineWidth = 1;\n                        luckysheetTableContent.strokeStyle = format[0];\n                        luckysheetTableContent.stroke();\n                        luckysheetTableContent.closePath();\n                    } else {\n                        let minusLen = checksCF['dataBar']['minusLen'];\n                        if (format.length > 1) {\n                            //渐变\n                            let my_gradient = luckysheetTableContent.createLinearGradient(x + w * minusLen, y, x + w * minusLen + w * plusLen * valueLen, y);\n                            my_gradient.addColorStop(0, format[0]);\n                            my_gradient.addColorStop(1, format[1]);\n                            luckysheetTableContent.fillStyle = my_gradient;\n                        } else {\n                            //单色\n                            luckysheetTableContent.fillStyle = format[0];\n                        }\n                        luckysheetTableContent.fillRect(x + w * minusLen, y, w * plusLen * valueLen, h);\n                        luckysheetTableContent.beginPath();\n                        luckysheetTableContent.moveTo(x + w * minusLen, y);\n                        luckysheetTableContent.lineTo(x + w * minusLen, y + h);\n                        luckysheetTableContent.lineTo(x + w * minusLen + w * plusLen * valueLen, y + h);\n                        luckysheetTableContent.lineTo(x + w * minusLen + w * plusLen * valueLen, y);\n                        luckysheetTableContent.lineTo(x + w * minusLen, y);\n                        luckysheetTableContent.lineWidth = 1;\n                        luckysheetTableContent.strokeStyle = format[0];\n                        luckysheetTableContent.stroke();\n                        luckysheetTableContent.closePath();\n                    }\n                }\n            }\n            let pos_x = start_c + offsetLeft;\n            let pos_y = start_r + offsetTop + 1;\n            luckysheetTableContent.save();\n            luckysheetTableContent.beginPath();\n            luckysheetTableContent.rect(pos_x, pos_y, cellWidth, cellHeight);\n            luckysheetTableContent.clip();\n            luckysheetTableContent.scale(Store.zoomRatio, Store.zoomRatio);\n            let textInfo = getCellTextInfo(cell, luckysheetTableContent, {\n                cellWidth: cellWidth,\n                cellHeight: cellHeight,\n                space_width: space_width,\n                space_height: space_height,\n                r: r,\n                c: c\n            });    //若单元格有条件格式图标集\n            //若单元格有条件格式图标集\n            if (checksCF != null && checksCF['icons'] != null && textInfo.type == 'plain') {\n                let l = checksCF['icons']['left'];\n                let t = checksCF['icons']['top'];\n                let value = textInfo.values[0];\n                let horizonAlignPos = pos_x + value.left;\n                let verticalAlignPos = pos_y + value.top - textInfo.textHeightAll;\n                if (verticalAlign == '0') {\n                    //居中对齐 \n                    verticalAlignPos = pos_y + cellHeight / 2 - textInfo.textHeightAll / 2;\n                } else if (verticalAlign == '1') {\n                    //上对齐\n                    verticalAlignPos = pos_y;\n                } else if (verticalAlign == '2') {\n                    //下对齐\n                    verticalAlignPos = verticalAlignPos - textInfo.desc;\n                }\n                verticalAlignPos = verticalAlignPos / Store.zoomRatio;\n                horizonAlignPos = horizonAlignPos / Store.zoomRatio;\n                luckysheetTableContent.drawImage(luckysheet_CFiconsImg, l * 42, t * 32, 32, 32, pos_x / Store.zoomRatio, verticalAlignPos, textInfo.textHeightAll / Store.zoomRatio, textInfo.textHeightAll / Store.zoomRatio);\n                if (horizonAlign != '0' && horizonAlign != '2') {\n                    //左对齐时 文本渲染空出一个图标的距离\n                    horizonAlignPos = horizonAlignPos + textInfo.textHeightAll / Store.zoomRatio;\n                }\n            }    //单元格 文本颜色\n            //单元格 文本颜色\n            luckysheetTableContent.fillStyle = menuButton.checkstatus(Store.flowdata, r, c, 'fc');    //若单元格有交替颜色 文本颜色\n            //若单元格有交替颜色 文本颜色\n            if (checksAF != null && checksAF[0] != null) {\n                luckysheetTableContent.fillStyle = checksAF[0];\n            }    //若单元格有条件格式 文本颜色\n            //若单元格有条件格式 文本颜色\n            if (checksCF != null && checksCF['textColor'] != null) {\n                luckysheetTableContent.fillStyle = checksCF['textColor'];\n            }    //若单元格格式为自定义数字格式（[red]） 文本颜色为红色\n            //若单元格格式为自定义数字格式（[red]） 文本颜色为红色\n            if (cell.ct && cell.ct.fa && cell.ct.fa.indexOf('[Red]') > -1 && cell.ct.t == 'n' && cell.v < 0) {\n                luckysheetTableContent.fillStyle = '#ff0000';\n            }\n            cellTextRender(textInfo, luckysheetTableContent, {\n                pos_x: pos_x,\n                pos_y: pos_y\n            });\n            luckysheetTableContent.restore();\n        }\n        if (cellOverflow_bd_r_render) {\n            //右边框\n            if (!Store.luckysheetcurrentisPivotTable && !fillStyle && Store.showGridLines) {\n                luckysheetTableContent.beginPath();\n                luckysheetTableContent.moveTo(end_c + offsetLeft - 2 + bodrder05, start_r + offsetTop);\n                luckysheetTableContent.lineTo(end_c + offsetLeft - 2 + bodrder05, end_r + offsetTop);\n                luckysheetTableContent.lineWidth = 1;\n                luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n                luckysheetTableContent.stroke();\n                luckysheetTableContent.closePath();\n            }\n        }    //下边框\n        //下边框\n        if (!Store.luckysheetcurrentisPivotTable && !fillStyle && Store.showGridLines) {\n            luckysheetTableContent.beginPath();\n            luckysheetTableContent.moveTo(start_c + offsetLeft - 1, end_r + offsetTop - 2 + bodrder05);\n            luckysheetTableContent.lineTo(end_c + offsetLeft - 1, end_r + offsetTop - 2 + bodrder05);\n            luckysheetTableContent.lineWidth = 1;\n            luckysheetTableContent.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n            luckysheetTableContent.stroke();\n            luckysheetTableContent.closePath();\n        }    // 单元格渲染后\n        // 单元格渲染后\n        method.createHookFunction('cellRenderAfter', Store.flowdata[r][c], {\n            r: r,\n            c: c,\n            'start_r': cellsize[1],\n            'start_c': cellsize[0],\n            'end_r': cellsize[3] + cellsize[1],\n            'end_c': cellsize[2] + cellsize[0]\n        }, sheetmanage.getSheetByIndex(), luckysheetTableContent);\n    };    //溢出单元格渲染\n    //溢出单元格渲染\n    let cellOverflowRender = function (r, c, stc, edc, luckysheetTableContent, scrollHeight, scrollWidth, offsetLeft, offsetTop, af_compute, cf_compute) {\n        //溢出单元格 起止行列坐标\n        let start_r;\n        if (r == 0) {\n            start_r = -scrollHeight - 1;\n        } else {\n            start_r = Store.visibledatarow[r - 1] - scrollHeight - 1;\n        }\n        let end_r = Store.visibledatarow[r] - scrollHeight;\n        let start_c;\n        if (stc == 0) {\n            start_c = -scrollWidth;\n        } else {\n            start_c = Store.visibledatacolumn[stc - 1] - scrollWidth;\n        }\n        let end_c = Store.visibledatacolumn[edc] - scrollWidth;    //\n        //\n        let cell = Store.flowdata[r][c];\n        let cellWidth = end_c - start_c - 2;\n        let cellHeight = end_r - start_r - 2;\n        let space_width = 2, space_height = 2;    //宽高方向 间隙\n        //宽高方向 间隙\n        let pos_x = start_c + offsetLeft;\n        let pos_y = start_r + offsetTop + 1;\n        let fontset = luckysheetfontformat(cell);\n        luckysheetTableContent.font = fontset;\n        luckysheetTableContent.save();\n        luckysheetTableContent.beginPath();\n        luckysheetTableContent.rect(pos_x, pos_y, cellWidth, cellHeight);\n        luckysheetTableContent.clip();\n        luckysheetTableContent.scale(Store.zoomRatio, Store.zoomRatio);\n        let textInfo = getCellTextInfo(cell, luckysheetTableContent, {\n            cellWidth: cellWidth,\n            cellHeight: cellHeight,\n            space_width: space_width,\n            space_height: space_height,\n            r: r,\n            c: c\n        });    //交替颜色\n        //交替颜色\n        let checksAF = alternateformat.checksAF(r, c, af_compute);    //条件格式\n        //条件格式\n        let checksCF = conditionformat.checksCF(r, c, cf_compute);    //单元格 文本颜色\n        //单元格 文本颜色\n        luckysheetTableContent.fillStyle = menuButton.checkstatus(Store.flowdata, r, c, 'fc');    //若单元格有交替颜色 文本颜色\n        //若单元格有交替颜色 文本颜色\n        if (checksAF != null && checksAF[0] != null) {\n            luckysheetTableContent.fillStyle = checksAF[0];\n        }    //若单元格有条件格式 文本颜色\n        //若单元格有条件格式 文本颜色\n        if (checksCF != null && checksCF['textColor'] != null) {\n            luckysheetTableContent.fillStyle = checksCF['textColor'];\n        }\n        cellTextRender(textInfo, luckysheetTableContent, {\n            pos_x: pos_x,\n            pos_y: pos_y\n        });\n        luckysheetTableContent.restore();\n    };    //获取表格渲染范围 溢出单元格 \n    //获取表格渲染范围 溢出单元格 \n    function getCellOverflowMap(canvas, col_st, col_ed, row_st, row_end) {\n        let map = {};\n        let data = Store.flowdata;\n        for (let r = row_st; r <= row_end; r++) {\n            if (data[r] == null) {\n                continue;\n            }\n            if (Store.cellOverflowMapCache[r] != null) {\n                map[r] = Store.cellOverflowMapCache[r];\n                continue;\n            }\n            let hasCellOver = false;\n            for (let c = 0; c < data[r].length; c++) {\n                let cell = data[r][c];    // if(Store.cellOverflowMapCache[r + '_' + c]!=null){\n                                          //     map[r + '_' + c] = Store.cellOverflowMapCache[r + '_' + c];\n                                          //     continue;\n                                          // }\n                // if(Store.cellOverflowMapCache[r + '_' + c]!=null){\n                //     map[r + '_' + c] = Store.cellOverflowMapCache[r + '_' + c];\n                //     continue;\n                // }\n                if (Store.config['colhidden'] != null && Store.config['colhidden'][c] != null) {\n                    continue;\n                }\n                if (cell != null && (!isRealNull(cell.v) || isInlineStringCell(cell)) && cell.mc == null && cell.tb == '1') {\n                    //水平对齐\n                    let horizonAlign = menuButton.checkstatus(data, r, c, 'ht');\n                    let textMetricsObj = getCellTextInfo(cell, canvas, {\n                        r: r,\n                        c: c\n                    });\n                    let textMetrics = 0;\n                    if (textMetricsObj != null) {\n                        textMetrics = textMetricsObj.textWidthAll;\n                    }    //canvas.measureText(value).width;\n                    //canvas.measureText(value).width;\n                    let start_c = c - 1 < 0 ? 0 : Store.visibledatacolumn[c - 1];\n                    let end_c = Store.visibledatacolumn[c];\n                    let stc, edc;\n                    if (end_c - start_c < textMetrics) {\n                        if (horizonAlign == '0') {\n                            //居中对齐\n                            let trace_forward = cellOverflow_trace(r, c, c - 1, 'forward', horizonAlign, textMetrics);\n                            let trace_backward = cellOverflow_trace(r, c, c + 1, 'backward', horizonAlign, textMetrics);\n                            if (trace_forward.success) {\n                                stc = trace_forward.c;\n                            } else {\n                                stc = trace_forward.c + 1;\n                            }\n                            if (trace_backward.success) {\n                                edc = trace_backward.c;\n                            } else {\n                                edc = trace_backward.c - 1;\n                            }\n                        } else if (horizonAlign == '1') {\n                            //左对齐\n                            let trace = cellOverflow_trace(r, c, c + 1, 'backward', horizonAlign, textMetrics);\n                            stc = c;\n                            if (trace.success) {\n                                edc = trace.c;\n                            } else {\n                                edc = trace.c - 1;\n                            }\n                        } else if (horizonAlign == '2') {\n                            //右对齐\n                            let trace = cellOverflow_trace(r, c, c - 1, 'forward', horizonAlign, textMetrics);\n                            edc = c;\n                            if (trace.success) {\n                                stc = trace.c;\n                            } else {\n                                stc = trace.c + 1;\n                            }\n                        }\n                    } else {\n                        stc = c;\n                        edc = c;\n                    }    // if(((stc >= col_st && stc <= col_ed) || (edc >= col_st && edc <= col_ed)) && stc < edc){\n                    // if(((stc >= col_st && stc <= col_ed) || (edc >= col_st && edc <= col_ed)) && stc < edc){\n                    if ((stc <= col_ed || edc >= col_st) && stc < edc) {\n                        let item = {\n                            r: r,\n                            stc: stc,\n                            edc: edc\n                        };\n                        if (map[r] == null) {\n                            map[r] = {};\n                        }\n                        map[r][c] = item;    // Store.cellOverflowMapCache[r + '_' + c] = item;\n                        // Store.cellOverflowMapCache[r + '_' + c] = item;\n                        hasCellOver = true;\n                    }\n                }\n            }\n            if (hasCellOver) {\n                Store.cellOverflowMapCache[r] = map[r];\n            }\n        }\n        return map;\n    }\n    function cellOverflow_trace(r, curC, traceC, traceDir, horizonAlign, textMetrics) {\n        let data = Store.flowdata;    //追溯单元格列超出数组范围 则追溯终止\n        //追溯单元格列超出数组范围 则追溯终止\n        if (traceDir == 'forward' && traceC < 0) {\n            return {\n                success: false,\n                r: r,\n                c: traceC\n            };\n        }\n        if (traceDir == 'backward' && traceC > data[r].length - 1) {\n            return {\n                success: false,\n                r: r,\n                c: traceC\n            };\n        }    //追溯单元格是 非空单元格或合并单元格 则追溯终止\n        //追溯单元格是 非空单元格或合并单元格 则追溯终止\n        let cell = data[r][traceC];\n        if (cell != null && (!isRealNull(cell.v) || cell.mc != null)) {\n            return {\n                success: false,\n                r: r,\n                c: traceC\n            };\n        }\n        let start_curC = curC - 1 < 0 ? 0 : Store.visibledatacolumn[curC - 1];\n        let end_curC = Store.visibledatacolumn[curC];\n        let w = textMetrics - (end_curC - start_curC);\n        if (horizonAlign == '0') {\n            //居中对齐\n            start_curC -= w / 2;\n            end_curC += w / 2;\n        } else if (horizonAlign == '1') {\n            //左对齐\n            end_curC += w;\n        } else if (horizonAlign == '2') {\n            //右对齐\n            start_curC -= w;\n        }\n        let start_traceC = traceC - 1 < 0 ? 0 : Store.visibledatacolumn[traceC - 1];\n        let end_traceC = Store.visibledatacolumn[traceC];\n        if (traceDir == 'forward') {\n            if (start_curC < start_traceC) {\n                return cellOverflow_trace(r, curC, traceC - 1, traceDir, horizonAlign, textMetrics);\n            } else if (start_curC < end_traceC) {\n                return {\n                    success: true,\n                    r: r,\n                    c: traceC\n                };\n            } else {\n                return {\n                    success: false,\n                    r: r,\n                    c: traceC\n                };\n            }\n        }\n        if (traceDir == 'backward') {\n            if (end_curC > end_traceC) {\n                return cellOverflow_trace(r, curC, traceC + 1, traceDir, horizonAlign, textMetrics);\n            } else if (end_curC > start_traceC) {\n                return {\n                    success: true,\n                    r: r,\n                    c: traceC\n                };\n            } else {\n                return {\n                    success: false,\n                    r: r,\n                    c: traceC\n                };\n            }\n        }\n    }\n    function cellOverflow_colIn(map, r, c, col_st, col_ed) {\n        let colIn = false,\n            //此单元格 是否在 某个溢出单元格的渲染范围\n            colLast = false,\n            //此单元格 是否是 某个溢出单元格的渲染范围的最后一列\n            rowIndex,\n            //溢出单元格 行下标 \n            colIndex,\n            //溢出单元格 列下标\n            stc, edc;\n        for (let rkey in map) {\n            for (let ckey in map[rkey]) {\n                rowIndex = rkey;\n                colIndex = ckey;    // rowIndex = key.substr(0, key.indexOf('_'));\n                                    // colIndex = key.substr(key.indexOf('_') + 1);\n                // rowIndex = key.substr(0, key.indexOf('_'));\n                // colIndex = key.substr(key.indexOf('_') + 1);\n                let mapItem = map[rkey][ckey];\n                stc = mapItem.stc;\n                edc = mapItem.edc;\n                if (rowIndex == r) {\n                    if (c >= stc && c <= edc) {\n                        colIn = true;\n                        if (c == edc || c == col_ed) {\n                            colLast = true;\n                            break;\n                        }\n                    }\n                }\n            }\n            if (colLast) {\n                break;\n            }\n        }\n        return {\n            colIn: colIn,\n            colLast: colLast,\n            rowIndex: rowIndex,\n            colIndex: colIndex,\n            stc: stc,\n            edc: edc\n        };\n    }\n    function cellTextRender(textInfo, ctx, option) {\n        if (textInfo == null) {\n            return;\n        }\n        let values = textInfo.values;\n        let pos_x = option.pos_x, pos_y = option.pos_y;\n        if (values == null) {\n            return;\n        }    // console.log(textInfo, pos_x, pos_y, values[0].width, values[0].left, ctx);\n             // for(let i=0;i<values.length;i++){\n             //     let word = values[i];\n             //     ctx.font = word.style;\n             //     ctx.fillText(word.content, (pos_x + word.left)/Store.zoomRatio, (pos_y+word.top)/Store.zoomRatio);\n             // }\n             // ctx.fillStyle = \"rgba(255,255,0,0.2)\";\n             // ctx.fillRect((pos_x + values[0].left)/Store.zoomRatio, (pos_y+values[0].top-values[0].asc)/Store.zoomRatio, textInfo.textWidthAll, textInfo.textHeightAll)\n        // console.log(textInfo, pos_x, pos_y, values[0].width, values[0].left, ctx);\n        // for(let i=0;i<values.length;i++){\n        //     let word = values[i];\n        //     ctx.font = word.style;\n        //     ctx.fillText(word.content, (pos_x + word.left)/Store.zoomRatio, (pos_y+word.top)/Store.zoomRatio);\n        // }\n        // ctx.fillStyle = \"rgba(255,255,0,0.2)\";\n        // ctx.fillRect((pos_x + values[0].left)/Store.zoomRatio, (pos_y+values[0].top-values[0].asc)/Store.zoomRatio, textInfo.textWidthAll, textInfo.textHeightAll)\n        if (textInfo.rotate != 0 && textInfo.type != 'verticalWrap') {\n            ctx.save();\n            ctx.translate((pos_x + textInfo.textLeftAll) / Store.zoomRatio, (pos_y + textInfo.textTopAll) / Store.zoomRatio);\n            ctx.rotate(-textInfo.rotate * Math.PI / 180);\n            ctx.translate(-(textInfo.textLeftAll + pos_x) / Store.zoomRatio, -(pos_y + textInfo.textTopAll) / Store.zoomRatio);\n        }    // ctx.fillStyle = \"rgb(0,0,0)\";\n        // ctx.fillStyle = \"rgb(0,0,0)\";\n        for (let i = 0; i < values.length; i++) {\n            let word = values[i];\n            if (word.inline === true && word.style != null) {\n                ctx.font = word.style.fontset;\n                ctx.fillStyle = word.style.fc;\n            } else {\n                ctx.font = word.style;\n            }    // 暂时未排查到word.content第一次会是object，先做下判断来渲染，后续找到问题再复原\n            // 暂时未排查到word.content第一次会是object，先做下判断来渲染，后续找到问题再复原\n            let txt = typeof word.content === 'object' ? word.content.m : word.content;\n            ctx.fillText(txt, (pos_x + word.left) / Store.zoomRatio, (pos_y + word.top) / Store.zoomRatio);\n            if (word.cancelLine != null) {\n                let c = word.cancelLine;\n                ctx.beginPath();\n                ctx.moveTo(Math.floor((pos_x + c.startX) / Store.zoomRatio) + 0.5, Math.floor((pos_y + c.startY) / Store.zoomRatio) + 0.5);\n                ctx.lineTo(Math.floor((pos_x + c.endX) / Store.zoomRatio) + 0.5, Math.floor((pos_y + c.endY) / Store.zoomRatio) + 0.5);\n                ctx.lineWidth = Math.floor(c.fs / 9);\n                ctx.strokeStyle = ctx.fillStyle;\n                ctx.stroke();\n                ctx.closePath();\n            }\n            if (word.underLine != null) {\n                let underLines = word.underLine;\n                for (let a = 0; a < underLines.length; a++) {\n                    let item = underLines[a];\n                    ctx.beginPath();\n                    ctx.moveTo(Math.floor((pos_x + item.startX) / Store.zoomRatio) + 0.5, Math.floor((pos_y + item.startY) / Store.zoomRatio));\n                    ctx.lineTo(Math.floor((pos_x + item.endX) / Store.zoomRatio) + 0.5, Math.floor((pos_y + item.endY) / Store.zoomRatio) + 0.5);\n                    ctx.lineWidth = Math.floor(item.fs / 9);\n                    ctx.strokeStyle = ctx.fillStyle;\n                    ctx.stroke();\n                    ctx.closePath();\n                }\n            }\n        }    // ctx.fillStyle = \"rgba(0,0,0,0.2)\";\n             // ctx.fillRect((pos_x + values[0].left)/Store.zoomRatio, (pos_y+values[0].top-values[0].asc)/Store.zoomRatio, textInfo.textWidthAll, textInfo.textHeightAll)\n             // ctx.fillStyle = \"rgba(255,0,0,1)\";\n             // ctx.fillRect(pos_x+textInfo.textLeftAll-2, pos_y+textInfo.textTopAll-2, 4,4);\n        // ctx.fillStyle = \"rgba(0,0,0,0.2)\";\n        // ctx.fillRect((pos_x + values[0].left)/Store.zoomRatio, (pos_y+values[0].top-values[0].asc)/Store.zoomRatio, textInfo.textWidthAll, textInfo.textHeightAll)\n        // ctx.fillStyle = \"rgba(255,0,0,1)\";\n        // ctx.fillRect(pos_x+textInfo.textLeftAll-2, pos_y+textInfo.textTopAll-2, 4,4);\n        if (textInfo.rotate != 0 && textInfo.type != 'verticalWrap') {\n            ctx.restore();\n        }\n    }\n    return {\n        luckysheetDrawgridRowTitle,\n        luckysheetDrawgridColumnTitle,\n        luckysheetDrawMain\n    };\n});"]}