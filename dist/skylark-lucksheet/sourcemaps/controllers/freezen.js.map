{"version":3,"sources":["controllers/freezen.js"],"names":["define","m_freezen_methods","m_get","m_sheetSearch","m_select","m_filter","cells","luckysheetPostil","luckysheetDropCell","m_location","Store","locale","getSheetIndex","luckysheet_searcharray","selectHightlightShow","createFilterOptions","rowLocationByIndex","colLocationByIndex","luckysheetFreezen","Object","assign","freezenHorizontalHTML","freezenVerticalHTML","windowHeight","windowWidth","cancelFreezenVertical","sheetIndex","locale_freezen","freezen","$","html","freezenColumn","freezenverticaldata","isvertical","is","hide","currentSheetIndex","currentSheet","luckysheetfile","vertical","frozen","saveParam","k","createFreezenVertical","left","_this","this","initialVertical","append","find","hover","parent","addClass","removeClass","mousedown","verticalmovestate","verticalmoveposition","position","width","css","gridheight","height","cursor","top","end","scrollLeft","dataset_col_st","visibledatacolumn","rowHeaderWidth","cutVolumn","saveFreezen","freezeHTML","freezenCancel","show","scrollFreezen","row","column","row_focus","luckysheet_select_save","column_focus","freezen_colindex","offset","length","console","log","setTimeout","freezenhorizontaldata","freezen_rowindex","scrollTop","visibledatarow","cancelFreezenHorizontal","default","ishorizontal","horizontal","createFreezenHorizontal","initialHorizontal","horizontalmovestate","horizontalmoveposition","gridwidth","dataset_row_st","columnHeaderHeight","createAssistCanvas","removeAssistCanvas","freezen_horizon_px","freezen_horizon_ed","freezen_horizon_scrollTop","freezen_vertical_px","freezen_vertical_ed","freezen_vertical_scrollTop","drawWidth","luckysheetTableContentHW","drawHeight","createCanvas","scrollAdapt","id","appendTo","attr","Math","ceil","devicePixelRatio","user-select","postion","z-index","pointer-events","not","remove","scrollAdaptOfselect","chart","scrollAdaptOfchart","scrollAdaptOfpostil","scrollAdaptOfdpicon","scrollAdaptOffilteroptions","empty","freezenTop","offTop","freezenLeft","offLeft","s","obj","extend","r1","r2","row_pre","top_move","height_move","rangeshow","eq","c1","c2","col","col_pre","left_move","width_move","rf","cf","row_f","row_pre_f","col_f","col_pre_f","margeset","mergeborer","flowdata","focuscell","each","i","e","x","$canvas_width","$canvas_height","height_diff","width_diff","size","visibility","r","split","c","postil","ps","toX","toY","postil_left","postil_top","postil_width","defaultWidth","postil_height","defaultHeight","getArrowCanvasSize","show2","buildPs","row_index","col_index","copy_r","copyRange","copy_c","apply_r","applyRange","apply_c","offsetRow","offsetColumn","freezen_top","data","filter_select","onScrollFreezen","luckysheetFreezens"],"mappings":"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","file":"../../controllers/freezen.js","sourcesContent":["define([\n    '../methods/freezen_methods',\n    '../methods/get',\n    '../methods/sheetSearch',\n    '../widgets/select',\n    './filter',\n    '../methods/cells',\n    './postil',\n    './dropCell',\n    '../methods/location',\n    '../store',\n    '../locale/locale'\n], function (m_freezen_methods,m_get, m_sheetSearch, m_select, m_filter, cells, luckysheetPostil, luckysheetDropCell, m_location, Store, locale) {\n    'use strict';\n    const {getSheetIndex} = m_get;\n    const {luckysheet_searcharray} = m_sheetSearch;\n    const {selectHightlightShow} = m_select;\n    const {createFilterOptions} = m_filter;\n    const {rowLocationByIndex, colLocationByIndex} = m_location;\n    const luckysheetFreezen = Object.assign(m_freezen_methods,{\n        freezenHorizontalHTML: '<div id=\"luckysheet-freezebar-horizontal\" class=\"luckysheet-freezebar\" tabindex=\"0\"><div class=\"luckysheet-freezebar-handle luckysheet-freezebar-horizontal-handle\" ><div class=\"luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-title\" ></div><div class=\"luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-bar\" ></div></div><div class=\"luckysheet-freezebar-drop luckysheet-freezebar-horizontal-drop\" ><div class=\"luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-title\" ></div><div class=\"luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-bar\" >&nbsp;</div></div></div>',\n        freezenVerticalHTML: '<div id=\"luckysheet-freezebar-vertical\" class=\"luckysheet-freezebar\" tabindex=\"0\"><div class=\"luckysheet-freezebar-handle luckysheet-freezebar-vertical-handle\" ><div class=\"luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-title\" ></div><div class=\"luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-bar\" ></div></div><div class=\"luckysheet-freezebar-drop luckysheet-freezebar-vertical-drop\" ><div class=\"luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-title\" ></div><div class=\"luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-bar\" >&nbsp;</div></div></div>',\n\n        windowHeight: null,\n        windowWidth: null,\n\n        cancelFreezenVertical: function (sheetIndex) {\n            let _this = this;\n            const _locale = locale();\n            const locale_freezen = _locale.freezen;\n            $('#luckysheet-freezen-btn-vertical').html('<i class=\"fa fa-indent\"></i> ' + locale_freezen.freezenColumn);\n            Store.freezenverticaldata = null;\n            let isvertical = $('#luckysheet-freezebar-vertical').is(':visible');\n            $('#luckysheet-freezebar-vertical').hide();\n            if (sheetIndex == null) {\n                sheetIndex = Store.currentSheetIndex;\n            }\n            let currentSheet = Store.luckysheetfile[getSheetIndex(sheetIndex)];\n            if (currentSheet.freezen != null) {\n                currentSheet.freezen.vertical = null;\n            }\n            if (currentSheet.frozen != null && isvertical) {\n                Store.saveParam('all', sheetIndex, currentSheet.frozen, { 'k': 'frozen' });\n            }\n        },\n        createFreezenVertical: function (freezenverticaldata, left) {\n            let _this = this;\n            if (_this.initialVertical) {\n                _this.initialVertical = false;\n                $('#luckysheet-grid-window-1').append(_this.freezenVerticalHTML);\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-drop').hover(function () {\n                    $(this).parent().addClass('luckysheet-freezebar-hover');\n                }, function () {\n                    $(this).parent().removeClass('luckysheet-freezebar-hover');\n                });\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-drop').mousedown(function () {\n                    _this.verticalmovestate = true;\n                    _this.verticalmoveposition = $(this).position().left;\n                    _this.windowWidth = $('#luckysheet-grid-window-1').width();\n                    $(this).parent().addClass('luckysheet-freezebar-active');\n                    $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-handle').css('cursor', '-webkit-grabbing');\n                });\n                let gridheight = $('#luckysheet-grid-window-1').height();\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-handle').css({\n                    'height': gridheight - 10,\n                    'width': '4px',\n                    'cursor': '-webkit-grab',\n                    'top': '0px'\n                }).end().find('.luckysheet-freezebar-vertical-drop').css({\n                    'height': gridheight - 10,\n                    'width': '4px',\n                    'top': '0px',\n                    'cursor': '-webkit-grab'\n                });\n            }\n            if (freezenverticaldata == null) {\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let dataset_col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollLeft);\n                if (dataset_col_st == -1) {\n                    dataset_col_st = 0;\n                }\n                left = Store.visibledatacolumn[dataset_col_st] - 2 - scrollLeft + Store.rowHeaderWidth;\n                freezenverticaldata = [\n                    Store.visibledatacolumn[dataset_col_st],\n                    dataset_col_st + 1,\n                    scrollLeft,\n                    _this.cutVolumn(Store.visibledatacolumn, dataset_col_st + 1),\n                    left\n                ];\n                _this.saveFreezen(null, null, freezenverticaldata, left);\n            }\n            Store.freezenverticaldata = freezenverticaldata; \n            // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"luckysheet-icon-img-container iconfont luckysheet-iconfont-dongjie1\"></i> '+locale().freezen.freezenCancel);\n            // 解决freeze 不垂直居中的问题\n            const freezeHTML = `\n            <div class=\"luckysheet-toolbar-button-outer-box luckysheet-inline-block\"\n            style=\"user-select: none;\">\n                <div class=\"luckysheet-toolbar-button-inner-box luckysheet-inline-block\"\n                style=\"user-select: none;\">\n                    <div class=\"luckysheet-icon luckysheet-inline-block \" style=\"user-select: none;\">\n                        <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1\"\n                        style=\"user-select: none;\">\n                        </div>\n                    </div>\n                    <div class=\"luckysheet-toolbar-menu-button-caption luckysheet-inline-block\"\n                    style=\"user-select: none;\">\n                        ${ locale().freezen.freezenCancel }\n                    </div>\n                </div>\n            </div>\n        `;\n            $('#luckysheet-freezen-btn-horizontal').html(freezeHTML);\n            $('#luckysheet-freezebar-vertical').show().find('.luckysheet-freezebar-vertical-handle').css({ 'left': left }).end().find('.luckysheet-freezebar-vertical-drop').css({ 'left': left });\n        },\n\n        scrollFreezen: function () {\n            let _this = this;\n            let row;\n            let row_focus = Store.luckysheet_select_save[0]['row_focus'];\n            if (row_focus == Store.luckysheet_select_save[0]['row'][0]) {\n                row = Store.luckysheet_select_save[0]['row'][1];\n            } else if (row_focus == Store.luckysheet_select_save[0]['row'][1]) {\n                row = Store.luckysheet_select_save[0]['row'][0];\n            }\n            let column;\n            let column_focus = Store.luckysheet_select_save[0]['column_focus'];\n            if (column_focus == Store.luckysheet_select_save[0]['column'][0]) {\n                column = Store.luckysheet_select_save[0]['column'][1];\n            } else if (column_focus == Store.luckysheet_select_save[0]['column'][1]) {\n                column = Store.luckysheet_select_save[0]['column'][0];\n            }\n            if (Store.freezenverticaldata != null) {\n                let freezen_colindex = Store.freezenverticaldata[1];\n                let offset = luckysheet_searcharray(Store.freezenverticaldata[3], $('#luckysheet-cell-main').scrollLeft());\n                let top = Store.freezenverticaldata[4];\n                freezen_colindex += offset;\n                if (column >= Store.visibledatacolumn.length) {\n                    column = Store.visibledatacolumn.length - 1;\n                }\n                if (freezen_colindex >= Store.visibledatacolumn.length) {\n                    freezen_colindex = Store.visibledatacolumn.length - 1;\n                }\n                let column_px = Store.visibledatacolumn[column], freezen_px = Store.visibledatacolumn[freezen_colindex];\n                if (column_px <= freezen_px + top) {\n                    console.log(1111);\n                    setTimeout(function () {\n                        $('#luckysheet-scrollbar-x').scrollLeft(0);\n                    }, 100);\n                }\n            }\n            if (Store.freezenhorizontaldata != null) {\n                let freezen_rowindex = Store.freezenhorizontaldata[1];\n                let offset = luckysheet_searcharray(Store.freezenhorizontaldata[3], $('#luckysheet-cell-main').scrollTop());\n                let left = Store.freezenhorizontaldata[4];\n                freezen_rowindex += offset;\n                if (row >= Store.visibledatarow.length) {\n                    row = Store.visibledatarow.length - 1;\n                }\n                if (freezen_rowindex >= Store.visibledatarow.length) {\n                    freezen_rowindex = Store.visibledatarow.length - 1;\n                }\n                let row_px = Store.visibledatarow[row], freezen_px = Store.visibledatarow[freezen_rowindex];\n                if (row_px <= freezen_px + left) {\n                    setTimeout(function () {\n                        $('#luckysheet-scrollbar-y').scrollTop(0);\n                    }, 100);\n                }\n            }\n        },\n        cancelFreezenHorizontal: function (sheetIndex) {\n            let _this = this;    // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"luckysheet-icon-img-container iconfont luckysheet-iconfont-dongjie1\"></i> '+locale().freezen.default);\n                                 // 解决freeze 不垂直居中的问题\n            // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"luckysheet-icon-img-container iconfont luckysheet-iconfont-dongjie1\"></i> '+locale().freezen.default);\n            // 解决freeze 不垂直居中的问题\n            const freezeHTML = `\n            <div class=\"luckysheet-toolbar-button-outer-box luckysheet-inline-block\"\n            style=\"user-select: none;\">\n                <div class=\"luckysheet-toolbar-button-inner-box luckysheet-inline-block\"\n                style=\"user-select: none;\">\n                    <div class=\"luckysheet-icon luckysheet-inline-block \" style=\"user-select: none;\">\n                        <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1\"\n                        style=\"user-select: none;\">\n                        </div>\n                    </div>\n                    <div class=\"luckysheet-toolbar-menu-button-caption luckysheet-inline-block\"\n                    style=\"user-select: none;\">\n                        ${ locale().freezen.default }\n                    </div>\n                </div>\n            </div>\n        `;\n            $('#luckysheet-freezen-btn-horizontal').html(freezeHTML);\n            Store.freezenhorizontaldata = null;\n            let ishorizontal = $('#luckysheet-freezebar-horizontal').is(':visible');\n            $('#luckysheet-freezebar-horizontal').hide();\n            if (sheetIndex == null) {\n                sheetIndex = Store.currentSheetIndex;\n            }\n            let currentSheet = Store.luckysheetfile[getSheetIndex(sheetIndex)];\n            if (currentSheet.freezen != null) {\n                currentSheet.freezen.horizontal = null;\n            }\n            if (currentSheet.frozen != null && ishorizontal) {\n                Store.saveParam('all', sheetIndex, currentSheet.frozen, { 'k': 'frozen' });\n            }\n        },\n        createFreezenHorizontal: function (freezenhorizontaldata, top) {\n            let _this = this;\n            if (_this.initialHorizontal) {\n                _this.initialHorizontal = false;\n                $('#luckysheet-grid-window-1').append(_this.freezenHorizontalHTML);\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-drop').hover(function () {\n                    $(this).parent().addClass('luckysheet-freezebar-hover');\n                }, function () {\n                    $(this).parent().removeClass('luckysheet-freezebar-hover');\n                });\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-drop').mousedown(function () {\n                    _this.horizontalmovestate = true;\n                    _this.horizontalmoveposition = $(this).position().top;\n                    _this.windowHeight = $('#luckysheet-grid-window-1').height();\n                    $(this).parent().addClass('luckysheet-freezebar-active');\n                    $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-handle').css('cursor', '-webkit-grabbing');\n                });\n                let gridwidth = $('#luckysheet-grid-window-1').width();\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-handle').css({\n                    'width': gridwidth - 10,\n                    'height': '4px',\n                    'cursor': '-webkit-grab',\n                    'left': '0px'\n                }).end().find('.luckysheet-freezebar-horizontal-drop').css({\n                    'width': gridwidth - 10,\n                    'height': '4px',\n                    'left': '0px',\n                    'cursor': '-webkit-grab'\n                });\n            }\n            if (freezenhorizontaldata == null) {\n                let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let dataset_row_st = luckysheet_searcharray(Store.visibledatarow, scrollTop);\n                if (dataset_row_st == -1) {\n                    dataset_row_st = 0;\n                }\n                top = Store.visibledatarow[dataset_row_st] - 2 - scrollTop + Store.columnHeaderHeight;\n                freezenhorizontaldata = [\n                    Store.visibledatarow[dataset_row_st],\n                    dataset_row_st + 1,\n                    scrollTop,\n                    _this.cutVolumn(Store.visibledatarow, dataset_row_st + 1),\n                    top\n                ];\n                _this.saveFreezen(freezenhorizontaldata, top, null, null);\n            }\n            Store.freezenhorizontaldata = freezenhorizontaldata; \n            // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"fa fa-list-alt\"></i> '+locale().freezen.freezenCancel);\n            // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"luckysheet-icon-img-container iconfont luckysheet-iconfont-dongjie1\"></i> '+locale().freezen.freezenCancel);\n            const freezeHTML = `\n            <div class=\"luckysheet-toolbar-button-outer-box luckysheet-inline-block\"\n            style=\"user-select: none;\">\n                <div class=\"luckysheet-toolbar-button-inner-box luckysheet-inline-block\"\n                style=\"user-select: none;\">\n                    <div class=\"luckysheet-icon luckysheet-inline-block \" style=\"user-select: none;\">\n                        <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1\"\n                        style=\"user-select: none;\">\n                        </div>\n                    </div>\n                    <div class=\"luckysheet-toolbar-menu-button-caption luckysheet-inline-block\"\n                    style=\"user-select: none;\">\n                        ${ locale().freezen.freezenCancel }\n                    </div>\n                </div>\n            </div>\n        `;\n            $('#luckysheet-freezen-btn-horizontal').html(freezeHTML);\n            $('#luckysheet-freezebar-horizontal').show().find('.luckysheet-freezebar-horizontal-handle').css({ 'top': top }).end().find('.luckysheet-freezebar-horizontal-drop').css({ 'top': top });\n        },\n        createAssistCanvas: function () {\n            let _this = this;\n            _this.removeAssistCanvas();\n            if (Store.freezenverticaldata != null || Store.freezenhorizontaldata != null) {\n                let freezen_horizon_px, freezen_horizon_ed, freezen_horizon_scrollTop;\n                let freezen_vertical_px, freezen_vertical_ed, freezen_vertical_scrollTop;\n                let drawWidth = Store.luckysheetTableContentHW[0], drawHeight = Store.luckysheetTableContentHW[1];    //双向freezen\n                //双向freezen\n                if (Store.freezenverticaldata != null && Store.freezenhorizontaldata != null) {\n                    freezen_horizon_px = Store.freezenhorizontaldata[0];\n                    freezen_horizon_ed = Store.freezenhorizontaldata[1];\n                    freezen_horizon_scrollTop = Store.freezenhorizontaldata[2];\n                    freezen_vertical_px = Store.freezenverticaldata[0];\n                    freezen_vertical_ed = Store.freezenverticaldata[1];\n                    freezen_vertical_scrollTop = Store.freezenverticaldata[2];    //3\n                    //3\n                    _this.createCanvas('freezen_3', freezen_vertical_px - freezen_vertical_scrollTop, freezen_horizon_px - freezen_horizon_scrollTop + 1, Store.rowHeaderWidth - 1, Store.columnHeaderHeight - 1);    //4\n                    //4\n                    _this.createCanvas('freezen_4', drawWidth - freezen_vertical_px + freezen_vertical_scrollTop, freezen_horizon_px - freezen_horizon_scrollTop + 1, freezen_vertical_px - freezen_vertical_scrollTop + Store.rowHeaderWidth - 1, Store.columnHeaderHeight - 1);    //7\n                    //7\n                    _this.createCanvas('freezen_7', freezen_vertical_px - freezen_vertical_scrollTop, drawHeight - freezen_horizon_px + freezen_horizon_scrollTop - Store.columnHeaderHeight, Store.rowHeaderWidth - 1, freezen_horizon_px - freezen_horizon_scrollTop + Store.columnHeaderHeight - 1);\n                }    //水平freezen\n                else //水平freezen\n                if (Store.freezenhorizontaldata != null) {\n                    freezen_horizon_px = Store.freezenhorizontaldata[0];\n                    freezen_horizon_ed = Store.freezenhorizontaldata[1];\n                    freezen_horizon_scrollTop = Store.freezenhorizontaldata[2];\n                    _this.createCanvas('freezen_h', drawWidth, freezen_horizon_px - freezen_horizon_scrollTop + 1, Store.rowHeaderWidth - 1, Store.columnHeaderHeight - 1);\n                }    //垂直freezen\n                else //垂直freezen\n                if (Store.freezenverticaldata != null) {\n                    freezen_vertical_px = Store.freezenverticaldata[0];\n                    freezen_vertical_ed = Store.freezenverticaldata[1];\n                    freezen_vertical_scrollTop = Store.freezenverticaldata[2];\n                    _this.createCanvas('freezen_v', freezen_vertical_px - freezen_vertical_scrollTop, drawHeight, Store.rowHeaderWidth - 1, Store.columnHeaderHeight - 1);\n                }\n                _this.scrollAdapt();\n            }\n        },\n        createCanvas: function (id, width, height, left, top) {\n            let c = $('<canvas/>').appendTo('#luckysheet-grid-window-1').attr({\n                'id': id,\n                'width': Math.ceil(width * Store.devicePixelRatio),\n                'height': Math.ceil(height * Store.devicePixelRatio)\n            }).css({\n                'user-select': 'none',\n                'postion': 'absolute',\n                'left': left,\n                'top': top,\n                'width': width,\n                'height': height,\n                'z-index': 10,\n                'pointer-events': 'none'\n            });\n        },\n        removeAssistCanvas: function () {\n            $('#luckysheet-grid-window-1 > canvas').not($('#luckysheetTableContent')).remove();\n            $('#luckysheet-cell-selected').css('z-index', 15);\n        },\n        scrollAdapt: function () {\n            let _this = this;    //有冻结时 选区框 滚动适应\n            //有冻结时 选区框 滚动适应\n            if (Store.luckysheet_select_save != null && Store.luckysheet_select_save.length > 0) {\n                _this.scrollAdaptOfselect();\n            }    //有冻结时 图表框 滚动适应\n            //有冻结时 图表框 滚动适应\n            if ($('#luckysheet-cell-main .luckysheet-data-visualization-chart').length > 0) {\n                // 当前sheet有图表才需要滚动适应\n                const chart = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['chart'];\n                if (chart != null && chart.length > 0) {\n                    _this.scrollAdaptOfchart();\n                }\n            }    //有冻结时 批注框 滚动适应\n            //有冻结时 批注框 滚动适应\n            if ($('#luckysheet-postil-showBoxs .luckysheet-postil-show').length > 0) {\n                _this.scrollAdaptOfpostil();\n            }    //有冻结时 下拉选区图标 滚动适应\n            //有冻结时 下拉选区图标 滚动适应\n            if ($('#luckysheet-dropCell-icon').length > 0) {\n                _this.scrollAdaptOfdpicon();\n            }    //有冻结时 筛选下拉按钮 滚动适应\n            //有冻结时 筛选下拉按钮 滚动适应\n            if ($('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').length > 0) {\n                _this.scrollAdaptOffilteroptions();\n            }\n        },\n        scrollAdaptOfselect: function () {\n            let _this = this;\n            if ($('#luckysheet-row-count-show').is(':visible')) {\n                $('#luckysheet-row-count-show').hide();\n            }\n            if ($('#luckysheet-column-count-show').is(':visible')) {\n                $('#luckysheet-column-count-show').hide();\n            }\n            $('#luckysheet-rows-h-selected').empty();\n            $('#luckysheet-cols-h-selected').empty();\n            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            if (Store.freezenhorizontaldata != null && Store.freezenverticaldata != null) {\n                let freezenTop = Store.freezenhorizontaldata[0];\n                let freezen_rowindex = Store.freezenhorizontaldata[1];\n                let offTop = scrollTop - Store.freezenhorizontaldata[2];\n                let freezenLeft = Store.freezenverticaldata[0];\n                let freezen_colindex = Store.freezenverticaldata[1];\n                let offLeft = scrollLeft - Store.freezenverticaldata[2];\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let obj = $.extend(true, {}, Store.luckysheet_select_save[s]);\n                    let r1 = obj.row[0], r2 = obj.row[1];\n                    let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                    let top_move = row_pre;\n                    let height_move = row - row_pre - 1;\n                    let rangeshow = true;\n                    if (r1 >= freezen_rowindex) {\n                        //原选区在冻结区外\n                        if (top_move + height_move < freezenTop + offTop) {\n                            rangeshow = false;\n                        } else if (top_move < freezenTop + offTop) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': freezenTop + offTop,\n                                'height': height_move - (freezenTop + offTop - top_move)\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move,\n                                'height': height_move\n                            });\n                        }\n                    } else if (r2 >= freezen_rowindex) {\n                        //原选区有一部分在冻结区内\n                        if (top_move + height_move < freezenTop + offTop) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move + offTop,\n                                'height': freezenTop - top_move\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move + offTop,\n                                'height': height_move - offTop\n                            });\n                        }\n                    } else {\n                        //原选区在冻结区内\n                        $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css('top', top_move + offTop);\n                    }\n                    let c1 = obj.column[0], c2 = obj.column[1];\n                    let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                    let left_move = col_pre;\n                    let width_move = col - col_pre - 1;\n                    if (c1 >= freezen_colindex) {\n                        //原选区在冻结区外\n                        if (left_move + width_move < freezenLeft + offLeft) {\n                            rangeshow = false;\n                        } else if (left_move < freezenLeft + offLeft) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': freezenLeft + offLeft,\n                                'width': width_move - (freezenLeft + offLeft - left_move)\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move,\n                                'width': width_move\n                            });\n                        }\n                    } else if (c2 >= freezen_colindex) {\n                        //原选区有一部分在冻结区内\n                        if (left_move + width_move < freezenLeft + offLeft) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move + offLeft,\n                                'width': freezenLeft - left_move\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move + offLeft,\n                                'width': width_move - offLeft\n                            });\n                        }\n                    } else {\n                        //原选区在冻结区内\n                        $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css('left', left_move + offLeft);\n                    }\n                    if (!rangeshow) {\n                        $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).hide();\n                    }\n                    if (s == Store.luckysheet_select_save.length - 1) {\n                        let rf = obj.row_focus == null ? r1 : obj.row_focus;\n                        let cf = obj.column_focus == null ? c1 : obj.column_focus;\n                        let row_f = Store.visibledatarow[rf], row_pre_f = rf - 1 == -1 ? 0 : Store.visibledatarow[rf - 1];\n                        let col_f = Store.visibledatacolumn[cf], col_pre_f = cf - 1 == -1 ? 0 : Store.visibledatacolumn[cf - 1];\n                        let margeset = cells.mergeborer(Store.flowdata, rf, cf);\n                        if (!!margeset) {\n                            row_f = margeset.row[1];\n                            row_pre_f = margeset.row[0];\n                            col_f = margeset.column[1];\n                            col_pre_f = margeset.column[0];\n                        }\n                        let top = row_pre_f;\n                        let height = row_f - row_pre_f - 1;\n                        let left = col_pre_f;\n                        let width = col_f - col_pre_f - 1;\n                        let focuscell = true;\n                        if (top >= freezenTop) {\n                            if (top + height < freezenTop + offTop) {\n                                focuscell = false;\n                            } else if (top < freezenTop + offTop) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': freezenTop + offTop,\n                                    'height': height - (freezenTop + offTop - top)\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top,\n                                    'height': height\n                                });\n                            }\n                        } else if (top + height >= freezenTop) {\n                            if (top + height < freezenTop + offTop) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top + offTop,\n                                    'height': freezenTop - top\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top + offTop,\n                                    'height': height - offTop\n                                });\n                            }\n                        } else {\n                            $('#luckysheet-cell-selected-focus').show().css('top', top + offTop);\n                        }\n                        if (left >= freezenLeft) {\n                            if (left + width < freezenLeft + offLeft) {\n                                focuscell = false;\n                            } else if (left < freezenLeft + offLeft) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': freezenLeft + offLeft,\n                                    'width': width - (freezenLeft + offLeft - left)\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left,\n                                    'width': width\n                                });\n                            }\n                        } else if (left + width >= freezenLeft) {\n                            if (left + width < freezenLeft + offLeft) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left + offLeft,\n                                    'width': freezenLeft - left\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left + offLeft,\n                                    'width': width - offLeft\n                                });\n                            }\n                        } else {\n                            $('#luckysheet-cell-selected-focus').show().css('left', left + offLeft);\n                        }\n                        if (!focuscell) {\n                            $('#luckysheet-cell-selected-focus').hide();\n                        }\n                    }\n                }\n            } else if (Store.freezenhorizontaldata != null) {\n                let freezenTop = Store.freezenhorizontaldata[0];\n                let freezen_rowindex = Store.freezenhorizontaldata[1];\n                let offTop = scrollTop - Store.freezenhorizontaldata[2];\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let obj = $.extend(true, {}, Store.luckysheet_select_save[s]);\n                    let r1 = obj.row[0], r2 = obj.row[1];\n                    let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                    let top_move = row_pre;\n                    let height_move = row - row_pre - 1;\n                    if (r1 >= freezen_rowindex) {\n                        //原选区在冻结区外\n                        if (top_move + height_move < freezenTop + offTop) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).hide();\n                        } else if (top_move < freezenTop + offTop) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': freezenTop + offTop,\n                                'height': height_move - (freezenTop + offTop - top_move)\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move,\n                                'height': height_move\n                            });\n                        }\n                    } else if (r2 >= freezen_rowindex) {\n                        //原选区有一部分在冻结区内\n                        if (top_move + height_move < freezenTop + offTop) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move + offTop,\n                                'height': freezenTop - top_move\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move + offTop,\n                                'height': height_move - offTop\n                            });\n                        }\n                    } else {\n                        //原选区在冻结区内\n                        $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css('top', top_move + offTop);\n                    }\n                    if (s == Store.luckysheet_select_save.length - 1) {\n                        let rf = obj.row_focus == null ? r1 : obj.row_focus;\n                        let cf = obj.column_focus == null ? obj.column[0] : obj.column_focus;\n                        let row_f = Store.visibledatarow[rf], row_pre_f = rf - 1 == -1 ? 0 : Store.visibledatarow[rf - 1];\n                        let margeset = cells.mergeborer(Store.flowdata, rf, cf);\n                        if (!!margeset) {\n                            row_f = margeset.row[1];\n                            row_pre_f = margeset.row[0];\n                        }\n                        let top = row_pre_f;\n                        let height = row_f - row_pre_f - 1;\n                        if (top >= freezenTop) {\n                            if (top + height < freezenTop + offTop) {\n                                $('#luckysheet-cell-selected-focus').hide();\n                            } else if (top < freezenTop + offTop) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': freezenTop + offTop,\n                                    'height': height - (freezenTop + offTop - top)\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top,\n                                    'height': height\n                                });\n                            }\n                        } else if (top + height >= freezenTop) {\n                            if (top + height < freezenTop + offTop) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top + offTop,\n                                    'height': freezenTop - top\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top + offTop,\n                                    'height': height - offTop\n                                });\n                            }\n                        } else {\n                            $('#luckysheet-cell-selected-focus').show().css('top', top + offTop);\n                        }\n                    }\n                }\n            } else if (Store.freezenverticaldata != null) {\n                let freezenLeft = Store.freezenverticaldata[0];\n                let freezen_colindex = Store.freezenverticaldata[1];\n                let offLeft = scrollLeft - Store.freezenverticaldata[2];\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let obj = $.extend(true, {}, Store.luckysheet_select_save[s]);\n                    let c1 = obj.column[0], c2 = obj.column[1];\n                    let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                    let left_move = col_pre;\n                    let width_move = col - col_pre - 1;\n                    if (c1 >= freezen_colindex) {\n                        //原选区在冻结区外\n                        if (left_move + width_move < freezenLeft + offLeft) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).hide();\n                        } else if (left_move < freezenLeft + offLeft) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': freezenLeft + offLeft,\n                                'width': width_move - (freezenLeft + offLeft - left_move)\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move,\n                                'width': width_move\n                            });\n                        }\n                    } else if (c2 >= freezen_colindex) {\n                        //原选区有一部分在冻结区内\n                        if (left_move + width_move < freezenLeft + offLeft) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move + offLeft,\n                                'width': freezenLeft - left_move\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move + offLeft,\n                                'width': width_move - offLeft\n                            });\n                        }\n                    } else {\n                        //原选区在冻结区内\n                        $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css('left', left_move + offLeft);\n                    }\n                    if (s == Store.luckysheet_select_save.length - 1) {\n                        let rf = obj.row_focus == null ? obj.row[0] : obj.row_focus;\n                        let cf = obj.column_focus == null ? c1 : obj.column_focus;\n                        let col_f = Store.visibledatacolumn[cf], col_pre_f = cf - 1 == -1 ? 0 : Store.visibledatacolumn[cf - 1];\n                        let margeset = cells.mergeborer(Store.flowdata, rf, cf);\n                        if (!!margeset) {\n                            col_f = margeset.column[1];\n                            col_pre_f = margeset.column[0];\n                        }\n                        let left = col_pre_f;\n                        let width = col_f - col_pre_f - 1;\n                        if (left >= freezenLeft) {\n                            if (left + width < freezenLeft + offLeft) {\n                                $('#luckysheet-cell-selected-focus').hide();\n                            } else if (left < freezenLeft + offLeft) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': freezenLeft + offLeft,\n                                    'width': width - (freezenLeft + offLeft - left)\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left,\n                                    'width': width\n                                });\n                            }\n                        } else if (left + width >= freezenLeft) {\n                            if (left + width < freezenLeft + offLeft) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left + offLeft,\n                                    'width': freezenLeft - left\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left + offLeft,\n                                    'width': width - offLeft\n                                });\n                            }\n                        } else {\n                            $('#luckysheet-cell-selected-focus').show().css('left', left + offLeft);\n                        }\n                    }\n                }\n            } else {\n                selectHightlightShow();\n            }\n        },\n        scrollAdaptOfchart: function () {\n            let _this = this;\n            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            if (Store.freezenhorizontaldata != null && Store.freezenverticaldata != null) {\n                let freezenTop = Store.freezenhorizontaldata[0] - Store.freezenhorizontaldata[2];\n                let freezenLeft = Store.freezenverticaldata[0] - Store.freezenverticaldata[2];\n                $('#luckysheet-cell-main .luckysheet-data-visualization-chart').each(function (i, e) {\n                    let x = $(e).position();\n                    let width = $(e).width();\n                    let height = $(e).height();\n                    let $canvas_width = $(e).find('canvas').width();\n                    let $canvas_height = $(e).find('canvas').height();\n                    let height_diff = $canvas_height - height;\n                    let width_diff = $canvas_width - width;\n                    if (x.top - height_diff < freezenTop) {\n                        let size = freezenTop - (x.top - height_diff);\n                        if (size > $canvas_height + 40 + 2) {\n                            $(e).css('visibility', 'hidden');\n                        } else {\n                            $(e).css({\n                                'top': freezenTop + scrollTop,\n                                'height': $canvas_height - size,\n                                'visibility': 'visible'\n                            });\n                            $(e).find('canvas').css('top', -size);\n                        }\n                    } else {\n                        $(e).css({\n                            'top': x.top - height_diff + scrollTop,\n                            'height': $canvas_height,\n                            'visibility': 'visible'\n                        });\n                        $(e).find('canvas').css('top', 0);\n                    }\n                    if (x.left - width_diff < freezenLeft) {\n                        let size = freezenLeft - (x.left - width_diff);\n                        if (size > $canvas_width + 20 + 2) {\n                            $(e).css('visibility', 'hidden');\n                        } else {\n                            $(e).css({\n                                'left': freezenLeft + scrollLeft,\n                                'width': $canvas_width - size,\n                                'visibility': 'visible'\n                            });\n                            $(e).find('canvas').css('left', -size);\n                        }\n                    } else {\n                        $(e).css({\n                            'left': x.left - width_diff + scrollLeft,\n                            'width': $canvas_width,\n                            'visibility': 'visible'\n                        });\n                        $(e).find('canvas').css('left', 0);\n                    }\n                });\n            } else if (Store.freezenhorizontaldata != null) {\n                let freezenTop = Store.freezenhorizontaldata[0] - Store.freezenhorizontaldata[2];\n                $('#luckysheet-cell-main .luckysheet-data-visualization-chart').each(function (i, e) {\n                    let x = $(e).position();\n                    let height = $(e).height();\n                    let $canvas_height = $(e).find('canvas').height();\n                    let height_diff = $canvas_height - height;\n                    if (x.top - height_diff < freezenTop) {\n                        let size = freezenTop - (x.top - height_diff);\n                        if (size > $canvas_height + 40 + 2) {\n                            $(e).css('visibility', 'hidden');\n                        } else {\n                            $(e).css({\n                                'top': freezenTop + scrollTop,\n                                'height': $canvas_height - size,\n                                'visibility': 'visible'\n                            });\n                            $(e).find('canvas').css('top', -size);\n                        }\n                    } else {\n                        $(e).css({\n                            'top': x.top - height_diff + scrollTop,\n                            'height': $canvas_height,\n                            'visibility': 'visible'\n                        });\n                        $(e).find('canvas').css('top', 0);\n                    }\n                });\n            } else if (Store.freezenverticaldata != null) {\n                let freezenLeft = Store.freezenverticaldata[0] - Store.freezenverticaldata[2];\n                $('#luckysheet-cell-main .luckysheet-data-visualization-chart').each(function (i, e) {\n                    let x = $(e).position();\n                    let width = $(e).width();\n                    let $canvas_width = $(e).find('canvas').width();\n                    let width_diff = $canvas_width - width;\n                    if (x.left - width_diff < freezenLeft) {\n                        let size = freezenLeft - (x.left - width_diff);\n                        if (size > $canvas_width + 20 + 2) {\n                            $(e).css('visibility', 'hidden');\n                        } else {\n                            $(e).css({\n                                'left': freezenLeft + scrollLeft,\n                                'width': $canvas_width - size,\n                                'visibility': 'visible'\n                            });\n                            $(e).find('canvas').css('left', -size);\n                        }\n                    } else {\n                        $(e).css({\n                            'left': x.left - width_diff + scrollLeft,\n                            'width': $canvas_width,\n                            'visibility': 'visible'\n                        });\n                        $(e).find('canvas').css('left', 0);\n                    }\n                });\n            } else {\n                $('#luckysheet-cell-main .luckysheet-data-visualization-chart').each(function (i, e) {\n                    let x = $(e).position();\n                    let width = $(e).width();\n                    let height = $(e).height();\n                    let $canvas_width = $(e).find('canvas').width();\n                    let $canvas_height = $(e).find('canvas').height();\n                    let height_diff = $canvas_height - height;\n                    let width_diff = $canvas_width - width;\n                    $(e).css({\n                        'top': x.top - height_diff + scrollTop,\n                        'height': $canvas_height,\n                        'left': x.left - width_diff + scrollLeft,\n                        'width': $canvas_width,\n                        'visibility': 'visible'\n                    });\n                    $(e).find('canvas').css({\n                        'top': 0,\n                        'left': 0\n                    });\n                });\n            }\n        },\n        scrollAdaptOfpostil: function () {\n            let _this = this;\n            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            if (Store.freezenhorizontaldata != null && Store.freezenverticaldata != null) {\n                let freezenTop = Store.freezenhorizontaldata[0];\n                let freezenLeft = Store.freezenverticaldata[0];\n                let offTop = scrollTop - Store.freezenhorizontaldata[2];\n                let offLeft = scrollLeft - Store.freezenverticaldata[2];\n                $('#luckysheet-postil-showBoxs .luckysheet-postil-show').each(function (i, e) {\n                    let id = $(e).attr('id');\n                    let r = id.split('luckysheet-postil-show_')[1].split('_')[0];\n                    let c = id.split('luckysheet-postil-show_')[1].split('_')[1];\n                    let postil = Store.flowdata[r][c].ps;\n                    let row = Store.visibledatarow[r], row_pre = r - 1 == -1 ? 0 : Store.visibledatarow[r - 1];\n                    let col = Store.visibledatacolumn[c], col_pre = c - 1 == -1 ? 0 : Store.visibledatacolumn[c - 1];\n                    let margeset = cells.mergeborer(Store.flowdata, r, c);\n                    if (!!margeset) {\n                        row = margeset.row[1];\n                        row_pre = margeset.row[0];\n                        col = margeset.column[1];\n                        col_pre = margeset.column[0];\n                    }\n                    let toX = col;\n                    let toY = row_pre;\n                    let postil_left = postil['left'] == null ? toX + 18 : postil['left'];\n                    let postil_top = postil['top'] == null ? toY - 18 : postil['top'];\n                    let postil_width = postil['width'] == null ? luckysheetPostil.defaultWidth : postil['width'];\n                    let postil_height = postil['height'] == null ? luckysheetPostil.defaultHeight : postil['height'];\n                    if (postil_top < 0) {\n                        postil_top = 2;\n                    }\n                    let size = luckysheetPostil.getArrowCanvasSize(postil_left, postil_top, toX, toY);\n                    let show = true;\n                    let show2 = true;\n                    if (r >= Store.freezenhorizontaldata[1]) {\n                        if (postil_top + postil_height < freezenTop) {\n                            $(e).show().find('.luckysheet-postil-show-main').css('top', postil_top + offTop);\n                            $(e).show().find('.arrowCanvas').css('top', size[1] + offTop);\n                        } else {\n                            if (postil_top < freezenTop + offTop) {\n                                if (postil_top + postil_height <= freezenTop + offTop) {\n                                    show = false;\n                                } else {\n                                    $(e).show().find('.luckysheet-postil-show-main').css({\n                                        'top': freezenTop + offTop,\n                                        'height': postil_height - (freezenTop + offTop - postil_top)\n                                    });\n                                    $(e).show().find('.formulaInputFocus').css('margin-top', -(freezenTop + offTop - postil_top));\n                                    $(e).show().find('.arrowCanvas').hide();\n                                    show2 = false;\n                                }\n                            } else {\n                                $(e).show().find('.luckysheet-postil-show-main').css({\n                                    'top': postil_top,\n                                    'height': postil_height\n                                });\n                                $(e).show().find('.formulaInputFocus').css('margin-top', 0);\n                                $(e).show().find('.arrowCanvas').css('top', size[1]);    // luckysheetPostil.buildPs(r, c, postil);\n                            }\n                        }\n                    } else\n                        // luckysheetPostil.buildPs(r, c, postil);\n                        {\n                            $(e).show().find('.luckysheet-postil-show-main').css('top', postil_top + offTop);\n                            $(e).show().find('.arrowCanvas').css('top', size[1] + offTop);\n                        }\n                    if (c >= Store.freezenverticaldata[1]) {\n                        if (postil_left + postil_width < freezenLeft) {\n                            $(e).show().find('.luckysheet-postil-show-main').css('left', postil_left + offLeft);\n                            $(e).show().find('.arrowCanvas').css('left', size[0] + offLeft);\n                        } else {\n                            if (postil_left < freezenLeft + offLeft) {\n                                if (postil_left + postil_width <= freezenLeft + offLeft) {\n                                    show = false;\n                                } else {\n                                    $(e).show().find('.luckysheet-postil-show-main').css({\n                                        'left': freezenLeft + offLeft,\n                                        'width': postil_width - (freezenLeft + offLeft - postil_left)\n                                    });\n                                    $(e).show().find('.formulaInputFocus').css('margin-left', -(freezenLeft + offLeft - postil_left));\n                                    $(e).show().find('.arrowCanvas').hide();\n                                    show2 = false;\n                                }\n                            } else {\n                                $(e).show().find('.luckysheet-postil-show-main').css({\n                                    'left': postil_left,\n                                    'width': postil_width\n                                });\n                                $(e).show().find('.formulaInputFocus').css('margin-left', 0);\n                                $(e).show().find('.arrowCanvas').css('left', size[0]);    // luckysheetPostil.buildPs(r, c, postil);\n                            }\n                        }\n                    } else\n                        // luckysheetPostil.buildPs(r, c, postil);\n                        {\n                            $(e).show().find('.luckysheet-postil-show-main').css('left', postil_left + offLeft);\n                            $(e).show().find('.arrowCanvas').css('left', size[0] + offLeft);\n                        }\n                    if (!show) {\n                        $(e).hide();\n                    }\n                    if (show && show2) {\n                        $(e).show().find('.arrowCanvas').show();\n                    }\n                });\n            } else if (Store.freezenhorizontaldata != null) {\n                let freezenTop = Store.freezenhorizontaldata[0];\n                let offTop = scrollTop - Store.freezenhorizontaldata[2];\n                $('#luckysheet-postil-showBoxs .luckysheet-postil-show').each(function (i, e) {\n                    let id = $(e).attr('id');\n                    let r = id.split('luckysheet-postil-show_')[1].split('_')[0];\n                    let c = id.split('luckysheet-postil-show_')[1].split('_')[1];\n                    let postil = Store.flowdata[r][c].ps;\n                    let row = Store.visibledatarow[r], row_pre = r - 1 == -1 ? 0 : Store.visibledatarow[r - 1];\n                    let col = Store.visibledatacolumn[c], col_pre = c - 1 == -1 ? 0 : Store.visibledatacolumn[c - 1];\n                    let margeset = cells.mergeborer(Store.flowdata, r, c);\n                    if (!!margeset) {\n                        row = margeset.row[1];\n                        row_pre = margeset.row[0];\n                        col = margeset.column[1];\n                        col_pre = margeset.column[0];\n                    }\n                    let toX = col;\n                    let toY = row_pre;\n                    let postil_left = postil['left'] == null ? toX + 18 : postil['left'];\n                    let postil_top = postil['top'] == null ? toY - 18 : postil['top'];\n                    let postil_width = postil['width'] == null ? luckysheetPostil.defaultWidth : postil['width'];\n                    let postil_height = postil['height'] == null ? luckysheetPostil.defaultHeight : postil['height'];\n                    if (postil_top < 0) {\n                        postil_top = 2;\n                    }\n                    let size = luckysheetPostil.getArrowCanvasSize(postil_left, postil_top, toX, toY);\n                    if (r >= Store.freezenhorizontaldata[1]) {\n                        if (postil_top + postil_height < freezenTop) {\n                            $(e).show().find('.luckysheet-postil-show-main').css('top', postil_top + offTop);\n                            $(e).show().find('.arrowCanvas').css('top', size[1] + offTop);\n                        } else {\n                            if (postil_top < freezenTop + offTop) {\n                                if (postil_top + postil_height <= freezenTop + offTop) {\n                                    $(e).hide();\n                                } else {\n                                    $(e).show().find('.luckysheet-postil-show-main').css({\n                                        'top': freezenTop + offTop,\n                                        'height': postil_height - (freezenTop + offTop - postil_top)\n                                    });\n                                    $(e).show().find('.formulaInputFocus').css('margin-top', -(freezenTop + offTop - postil_top));\n                                    $(e).show().find('.arrowCanvas').hide();\n                                }\n                            } else {\n                                luckysheetPostil.buildPs(r, c, postil);\n                            }\n                        }\n                    } else {\n                        $(e).show().find('.luckysheet-postil-show-main').css('top', postil_top + offTop);\n                        $(e).show().find('.arrowCanvas').css('top', size[1] + offTop);\n                    }\n                });\n            } else if (Store.freezenverticaldata != null) {\n                let freezenLeft = Store.freezenverticaldata[0];\n                let offLeft = scrollLeft - Store.freezenverticaldata[2];\n                $('#luckysheet-postil-showBoxs .luckysheet-postil-show').each(function (i, e) {\n                    let id = $(e).attr('id');\n                    let r = id.split('luckysheet-postil-show_')[1].split('_')[0];\n                    let c = id.split('luckysheet-postil-show_')[1].split('_')[1];\n                    let postil = Store.flowdata[r][c].ps;\n                    let row = Store.visibledatarow[r], row_pre = r - 1 == -1 ? 0 : Store.visibledatarow[r - 1];\n                    let col = Store.visibledatacolumn[c], col_pre = c - 1 == -1 ? 0 : Store.visibledatacolumn[c - 1];\n                    let margeset = cells.mergeborer(Store.flowdata, r, c);\n                    if (!!margeset) {\n                        row = margeset.row[1];\n                        row_pre = margeset.row[0];\n                        col = margeset.column[1];\n                        col_pre = margeset.column[0];\n                    }\n                    let toX = col;\n                    let toY = row_pre;\n                    let postil_left = postil['left'] == null ? toX + 18 : postil['left'];\n                    let postil_top = postil['top'] == null ? toY - 18 : postil['top'];\n                    let postil_width = postil['width'] == null ? luckysheetPostil.defaultWidth : postil['width'];\n                    let postil_height = postil['height'] == null ? luckysheetPostil.defaultHeight : postil['height'];\n                    if (postil_top < 0) {\n                        postil_top = 2;\n                    }\n                    let size = luckysheetPostil.getArrowCanvasSize(postil_left, postil_top, toX, toY);\n                    if (c >= Store.freezenverticaldata[1]) {\n                        if (postil_left + postil_width < freezenLeft) {\n                            $(e).show().find('.luckysheet-postil-show-main').css('left', postil_left + offLeft);\n                            $(e).show().find('.arrowCanvas').css('left', size[0] + offLeft);\n                        } else {\n                            if (postil_left < freezenLeft + offLeft) {\n                                if (postil_left + postil_width <= freezenLeft + offLeft) {\n                                    $(e).hide();\n                                } else {\n                                    $(e).show().find('.luckysheet-postil-show-main').css({\n                                        'left': freezenLeft + offLeft,\n                                        'width': postil_width - (freezenLeft + offLeft - postil_left)\n                                    });\n                                    $(e).show().find('.formulaInputFocus').css('margin-left', -(freezenLeft + offLeft - postil_left));\n                                    $(e).show().find('.arrowCanvas').hide();\n                                }\n                            } else {\n                                luckysheetPostil.buildPs(r, c, postil);\n                            }\n                        }\n                    } else {\n                        $(e).show().find('.luckysheet-postil-show-main').css('left', postil_left + offLeft);\n                        $(e).show().find('.arrowCanvas').css('left', size[0] + offLeft);\n                    }\n                });\n            } else {\n                $('#luckysheet-postil-showBoxs .luckysheet-postil-show').each(function (i, e) {\n                    let id = $(e).attr('id');\n                    let r = id.split('luckysheet-postil-show_')[1].split('_')[0];\n                    let c = id.split('luckysheet-postil-show_')[1].split('_')[1];\n                    let postil = Store.flowdata[r][c].ps;\n                    luckysheetPostil.buildPs(r, c, postil);\n                });\n            }\n        },\n        scrollAdaptOfdpicon: function () {\n            let _this = this;\n            let copy_r = luckysheetDropCell.copyRange['row'][1], copy_c = luckysheetDropCell.copyRange['column'][1];\n            let apply_r = luckysheetDropCell.applyRange['row'][1], apply_c = luckysheetDropCell.applyRange['column'][1];\n            let row_index, col_index;\n            if (apply_r >= copy_r && apply_c >= copy_c) {\n                row_index = apply_r;\n                col_index = apply_c;\n            } else {\n                row_index = copy_r;\n                col_index = copy_c;\n            }\n            if (Store.freezenhorizontaldata != null && Store.freezenverticaldata != null) {\n                let freezen_rowindex = Store.freezenhorizontaldata[1];\n                let offsetRow = luckysheet_searcharray(Store.freezenhorizontaldata[3], $('#luckysheet-cell-main').scrollTop() - Store.freezenhorizontaldata[2]);\n                let freezen_colindex = Store.freezenverticaldata[1];\n                let offsetColumn = luckysheet_searcharray(Store.freezenverticaldata[3], $('#luckysheet-cell-main').scrollLeft() - Store.freezenverticaldata[2]);\n                if (row_index >= freezen_rowindex && col_index >= freezen_colindex) {\n                    if (row_index < freezen_rowindex + offsetRow - 1 || col_index < freezen_colindex + offsetColumn - 1) {\n                        $('#luckysheet-dropCell-icon').hide();\n                    } else {\n                        $('#luckysheet-dropCell-icon').show();\n                    }\n                } else if (row_index >= freezen_rowindex) {\n                    if (row_index < freezen_rowindex + offsetRow - 1) {\n                        $('#luckysheet-dropCell-icon').hide();\n                    } else {\n                        let col = colLocationByIndex(col_index + offsetColumn)[1];\n                        $('#luckysheet-dropCell-icon').show().css('left', col);\n                    }\n                } else if (col_index >= freezen_colindex) {\n                    if (col_index < freezen_colindex + offsetColumn - 1) {\n                        $('#luckysheet-dropCell-icon').hide();\n                    } else {\n                        let row = rowLocationByIndex(row_index + offsetRow)[1];\n                        $('#luckysheet-dropCell-icon').show().css('top', row);\n                    }\n                } else {\n                    let row = rowLocationByIndex(row_index + offsetRow)[1], col = colLocationByIndex(col_index + offsetColumn)[1];\n                    $('#luckysheet-dropCell-icon').show().css({\n                        'left': col,\n                        'top': row\n                    });\n                }\n            } else if (Store.freezenhorizontaldata != null) {\n                let freezen_rowindex = Store.freezenhorizontaldata[1];\n                let offsetRow = luckysheet_searcharray(Store.freezenhorizontaldata[3], $('#luckysheet-cell-main').scrollTop() - Store.freezenhorizontaldata[2]);\n                if (row_index >= freezen_rowindex) {\n                    if (row_index < freezen_rowindex + offsetRow - 1) {\n                        $('#luckysheet-dropCell-icon').hide();\n                    } else {\n                        $('#luckysheet-dropCell-icon').show();\n                    }\n                } else {\n                    let row = rowLocationByIndex(row_index + offsetRow)[1];\n                    $('#luckysheet-dropCell-icon').show().css('top', row);\n                }\n            } else if (Store.freezenverticaldata != null) {\n                let freezen_colindex = Store.freezenverticaldata[1];\n                let offsetColumn = luckysheet_searcharray(Store.freezenverticaldata[3], $('#luckysheet-cell-main').scrollLeft() - Store.freezenverticaldata[2]);\n                if (col_index >= freezen_colindex) {\n                    if (col_index < freezen_colindex + offsetColumn - 1) {\n                        $('#luckysheet-dropCell-icon').hide();\n                    } else {\n                        $('#luckysheet-dropCell-icon').show();\n                    }\n                } else {\n                    let col = colLocationByIndex(col_index + offsetColumn)[1];\n                    $('#luckysheet-dropCell-icon').show().css('left', col);\n                }\n            } else {\n                let row = rowLocationByIndex(row_index)[1], col = colLocationByIndex(col_index)[1];\n                $('#luckysheet-dropCell-icon').show().css({\n                    'left': col,\n                    'top': row\n                });\n            }\n        },\n        scrollAdaptOffilteroptions: function () {\n            let _this = this;\n            if (Store.freezenhorizontaldata != null && Store.freezenverticaldata != null) {\n                let freezen_rowindex = Store.freezenhorizontaldata[1];\n                let freezen_top = Store.freezenhorizontaldata[0] + $('#luckysheet-cell-main').scrollTop();\n                let freezen_colindex = Store.freezenverticaldata[1];\n                let offsetColumn = luckysheet_searcharray(Store.freezenverticaldata[3], $('#luckysheet-cell-main').scrollLeft() - Store.freezenverticaldata[2]);\n                $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').each(function (i, e) {\n                    let row_index = $(e).data('str');\n                    let top = row_index - 1 == -1 ? 0 : Store.visibledatarow[row_index - 1];\n                    let col_index = $(e).data('cindex');\n                    if (row_index >= freezen_rowindex && col_index >= freezen_colindex) {\n                        if (top < freezen_top || col_index < freezen_colindex + offsetColumn) {\n                            $(e).hide();\n                        } else {\n                            $(e).show();\n                        }\n                    } else if (row_index >= freezen_rowindex) {\n                        if (top < freezen_top) {\n                            $(e).hide();\n                        } else {\n                            let left = Store.visibledatacolumn[col_index + offsetColumn] - 20;\n                            $(e).show().css('left', left);\n                        }\n                    } else if (col_index >= freezen_colindex) {\n                        if (col_index < freezen_colindex + offsetColumn) {\n                            $(e).hide();\n                        } else {\n                            $(e).show().css('top', top + $('#luckysheet-cell-main').scrollTop());\n                        }\n                    } else {\n                        let left = Store.visibledatacolumn[col_index + offsetColumn] - 20;\n                        $(e).show().css({\n                            'left': left,\n                            'top': top + $('#luckysheet-cell-main').scrollTop()\n                        });\n                    }\n                });\n            } else if (Store.freezenhorizontaldata != null) {\n                let freezen_rowindex = Store.freezenhorizontaldata[1];\n                let freezen_top = Store.freezenhorizontaldata[0] + $('#luckysheet-cell-main').scrollTop();\n                $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').each(function (i, e) {\n                    let row_index = $(e).data('str');\n                    let top = row_index - 1 == -1 ? 0 : Store.visibledatarow[row_index - 1];\n                    if (row_index >= freezen_rowindex) {\n                        if (top < freezen_top) {\n                            $(e).hide();\n                        } else {\n                            $(e).show();\n                        }\n                    } else {\n                        $(e).show().css('top', top + $('#luckysheet-cell-main').scrollTop());\n                    }\n                });\n            } else if (Store.freezenverticaldata != null) {\n                let freezen_colindex = Store.freezenverticaldata[1];\n                let offsetColumn = luckysheet_searcharray(Store.freezenverticaldata[3], $('#luckysheet-cell-main').scrollLeft() - Store.freezenverticaldata[2]);\n                $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').each(function (i, e) {\n                    let col_index = $(e).data('cindex');\n                    if (col_index >= freezen_colindex) {\n                        if (col_index < freezen_colindex + offsetColumn) {\n                            $(e).hide();\n                        } else {\n                            $(e).show();\n                        }\n                    } else {\n                        let left = Store.visibledatacolumn[col_index + offsetColumn] - 20;\n                        $(e).show().css('left', left);\n                    }\n                });\n            } else {\n                $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex).empty();\n                createFilterOptions(Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].filter_select);\n            }\n        }\n    });\n\n    Store.onScrollFreezen = function() {\n        luckysheetFreezens.scrollFreezen();\n    };\n    return luckysheetFreezen;\n});"]}