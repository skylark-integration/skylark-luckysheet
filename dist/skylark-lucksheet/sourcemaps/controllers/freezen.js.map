{"version":3,"sources":["controllers/freezen.js"],"names":["define","m_get","m_sheetSearch","m_select","m_filter","server","menuButton","luckysheetPostil","luckysheetDropCell","m_location","Store","locale","getSheetIndex","luckysheet_searcharray","selectHightlightShow","createFilterOptions","rowLocationByIndex","colLocationByIndex","luckysheetFreezen","freezenHorizontalHTML","freezenVerticalHTML","initialHorizontal","initialVertical","horizontalmovestate","horizontalmoveposition","verticalmovestate","verticalmoveposition","windowHeight","windowWidth","freezenhorizontaldata","freezenverticaldata","cutVolumn","arr","cutindex","pre","slice","length","cancelFreezenVertical","sheetIndex","locale_freezen","freezen","$","html","freezenColumn","this","isvertical","is","hide","currentSheetIndex","currentSheet","luckysheetfile","vertical","frozen","saveParam","k","createFreezenVertical","left","_this","append","find","hover","parent","addClass","removeClass","mousedown","position","width","css","gridheight","height","cursor","top","end","scrollLeft","dataset_col_st","visibledatacolumn","rowHeaderWidth","saveFreezen","freezeHTML","freezenCancel","show","horizontal","initialFreezen","frozenTofreezen","createFreezenHorizontal","cancelFreezenHorizontal","createAssistCanvas","changeFreezenIndex","originindex","type","freezen_colindex","offset","freezen_rowindex","visibledatarow","scrollTop","scrollFreezen","row","column","row_focus","luckysheet_select_save","column_focus","console","log","setTimeout","default","ishorizontal","gridwidth","dataset_row_st","columnHeaderHeight","removeAssistCanvas","freezen_horizon_px","freezen_horizon_ed","freezen_horizon_scrollTop","freezen_vertical_px","freezen_vertical_ed","freezen_vertical_scrollTop","drawWidth","luckysheetTableContentHW","drawHeight","createCanvas","scrollAdapt","id","appendTo","attr","Math","ceil","devicePixelRatio","user-select","postion","z-index","pointer-events","not","remove","scrollAdaptOfselect","chart","scrollAdaptOfchart","scrollAdaptOfpostil","scrollAdaptOfdpicon","scrollAdaptOffilteroptions","empty","freezenTop","offTop","freezenLeft","offLeft","s","obj","extend","r1","r2","row_pre","top_move","height_move","rangeshow","eq","c1","c2","col","col_pre","left_move","width_move","rf","cf","row_f","row_pre_f","col_f","col_pre_f","margeset","mergeborer","flowdata","focuscell","each","i","e","x","$canvas_width","$canvas_height","height_diff","width_diff","size","visibility","r","split","c","postil","ps","toX","toY","postil_left","postil_top","postil_width","defaultWidth","postil_height","defaultHeight","getArrowCanvasSize","show2","buildPs","row_index","col_index","copy_r","copyRange","copy_c","apply_r","applyRange","apply_c","offsetRow","offsetColumn","freezen_top","data","filter_select","saveFrozen","operate","order","focus","select_save","range","freezenRow","freezenRC","freezenRowRange","freezenColumnRange","freezenRCRange","file","row_st","col_st"],"mappings":"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","file":"../../controllers/freezen.js","sourcesContent":["define([\n    '../methods/get',\n    './sheetSearch',\n    './select',\n    './filter',\n    './server',\n    './menuButton',\n    './postil',\n    './dropCell',\n    '../global/location',\n    '../store',\n    '../locale/locale'\n], function (m_get, m_sheetSearch, m_select, m_filter, server, menuButton, luckysheetPostil, luckysheetDropCell, m_location, Store, locale) {\n    'use strict';\n    const {getSheetIndex} = m_get;\n    const {luckysheet_searcharray} = m_sheetSearch;\n    const {selectHightlightShow} = m_select;\n    const {createFilterOptions} = m_filter;\n    const {rowLocationByIndex, colLocationByIndex} = m_location;\n    const luckysheetFreezen = {\n        freezenHorizontalHTML: '<div id=\"luckysheet-freezebar-horizontal\" class=\"luckysheet-freezebar\" tabindex=\"0\"><div class=\"luckysheet-freezebar-handle luckysheet-freezebar-horizontal-handle\" ><div class=\"luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-title\" ></div><div class=\"luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-bar\" ></div></div><div class=\"luckysheet-freezebar-drop luckysheet-freezebar-horizontal-drop\" ><div class=\"luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-title\" ></div><div class=\"luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-bar\" >&nbsp;</div></div></div>',\n        freezenVerticalHTML: '<div id=\"luckysheet-freezebar-vertical\" class=\"luckysheet-freezebar\" tabindex=\"0\"><div class=\"luckysheet-freezebar-handle luckysheet-freezebar-vertical-handle\" ><div class=\"luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-title\" ></div><div class=\"luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-bar\" ></div></div><div class=\"luckysheet-freezebar-drop luckysheet-freezebar-vertical-drop\" ><div class=\"luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-title\" ></div><div class=\"luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-bar\" >&nbsp;</div></div></div>',\n        initialHorizontal: true,\n        initialVertical: true,\n        horizontalmovestate: false,\n        horizontalmoveposition: null,\n        verticalmovestate: false,\n        verticalmoveposition: null,\n        windowHeight: null,\n        windowWidth: null,\n        freezenhorizontaldata: null,\n        freezenverticaldata: null,\n        cutVolumn: function (arr, cutindex) {\n            if (cutindex <= 0) {\n                return arr;\n            }\n            let pre = arr.slice(0, cutindex);\n            let premax = pre[pre.length - 1];\n            let ret = arr.slice(cutindex);    // for (let i = 0; i < ret.length; i++) {\n                                              //     ret[i] -= premax;\n                                              // }\n            // for (let i = 0; i < ret.length; i++) {\n            //     ret[i] -= premax;\n            // }\n            return ret;\n        },\n        cancelFreezenVertical: function (sheetIndex) {\n            let _this = this;\n            const _locale = locale();\n            const locale_freezen = _locale.freezen;\n            $('#luckysheet-freezen-btn-vertical').html('<i class=\"fa fa-indent\"></i> ' + locale_freezen.freezenColumn);\n            _this.freezenverticaldata = null;\n            let isvertical = $('#luckysheet-freezebar-vertical').is(':visible');\n            $('#luckysheet-freezebar-vertical').hide();\n            if (sheetIndex == null) {\n                sheetIndex = Store.currentSheetIndex;\n            }\n            let currentSheet = Store.luckysheetfile[getSheetIndex(sheetIndex)];\n            if (currentSheet.freezen != null) {\n                currentSheet.freezen.vertical = null;\n            }\n            if (currentSheet.frozen != null && isvertical) {\n                server.saveParam('all', sheetIndex, currentSheet.frozen, { 'k': 'frozen' });\n            }\n        },\n        createFreezenVertical: function (freezenverticaldata, left) {\n            let _this = this;\n            if (_this.initialVertical) {\n                _this.initialVertical = false;\n                $('#luckysheet-grid-window-1').append(_this.freezenVerticalHTML);\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-drop').hover(function () {\n                    $(this).parent().addClass('luckysheet-freezebar-hover');\n                }, function () {\n                    $(this).parent().removeClass('luckysheet-freezebar-hover');\n                });\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-drop').mousedown(function () {\n                    _this.verticalmovestate = true;\n                    _this.verticalmoveposition = $(this).position().left;\n                    _this.windowWidth = $('#luckysheet-grid-window-1').width();\n                    $(this).parent().addClass('luckysheet-freezebar-active');\n                    $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-handle').css('cursor', '-webkit-grabbing');\n                });\n                let gridheight = $('#luckysheet-grid-window-1').height();\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-handle').css({\n                    'height': gridheight - 10,\n                    'width': '4px',\n                    'cursor': '-webkit-grab',\n                    'top': '0px'\n                }).end().find('.luckysheet-freezebar-vertical-drop').css({\n                    'height': gridheight - 10,\n                    'width': '4px',\n                    'top': '0px',\n                    'cursor': '-webkit-grab'\n                });\n            }\n            if (freezenverticaldata == null) {\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let dataset_col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollLeft);\n                if (dataset_col_st == -1) {\n                    dataset_col_st = 0;\n                }\n                left = Store.visibledatacolumn[dataset_col_st] - 2 - scrollLeft + Store.rowHeaderWidth;\n                freezenverticaldata = [\n                    Store.visibledatacolumn[dataset_col_st],\n                    dataset_col_st + 1,\n                    scrollLeft,\n                    _this.cutVolumn(Store.visibledatacolumn, dataset_col_st + 1),\n                    left\n                ];\n                _this.saveFreezen(null, null, freezenverticaldata, left);\n            }\n            _this.freezenverticaldata = freezenverticaldata;    // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"luckysheet-icon-img-container iconfont luckysheet-iconfont-dongjie1\"></i> '+locale().freezen.freezenCancel);\n                                                                // 解决freeze 不垂直居中的问题\n            // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"luckysheet-icon-img-container iconfont luckysheet-iconfont-dongjie1\"></i> '+locale().freezen.freezenCancel);\n            // 解决freeze 不垂直居中的问题\n            const freezeHTML = `\n            <div class=\"luckysheet-toolbar-button-outer-box luckysheet-inline-block\"\n            style=\"user-select: none;\">\n                <div class=\"luckysheet-toolbar-button-inner-box luckysheet-inline-block\"\n                style=\"user-select: none;\">\n                    <div class=\"luckysheet-icon luckysheet-inline-block \" style=\"user-select: none;\">\n                        <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1\"\n                        style=\"user-select: none;\">\n                        </div>\n                    </div>\n                    <div class=\"luckysheet-toolbar-menu-button-caption luckysheet-inline-block\"\n                    style=\"user-select: none;\">\n                        ${ locale().freezen.freezenCancel }\n                    </div>\n                </div>\n            </div>\n        `;\n            $('#luckysheet-freezen-btn-horizontal').html(freezeHTML);\n            $('#luckysheet-freezebar-vertical').show().find('.luckysheet-freezebar-vertical-handle').css({ 'left': left }).end().find('.luckysheet-freezebar-vertical-drop').css({ 'left': left });\n        },\n        saveFreezen: function (freezenhorizontaldata, top, freezenverticaldata, left) {\n            let currentSheet = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            if (currentSheet.freezen == null) {\n                currentSheet.freezen = {};\n            }\n            if (freezenhorizontaldata != null) {\n                if (currentSheet.freezen.horizontal == null) {\n                    currentSheet.freezen.horizontal = {};\n                }\n                currentSheet.freezen.horizontal.freezenhorizontaldata = freezenhorizontaldata;\n                currentSheet.freezen.horizontal.top = top;\n            }\n            if (freezenverticaldata != null) {\n                if (currentSheet.freezen.vertical == null) {\n                    currentSheet.freezen.vertical = {};\n                }\n                currentSheet.freezen.vertical.freezenverticaldata = freezenverticaldata;\n                currentSheet.freezen.vertical.left = left;\n            }    // if(currentSheet.freezen != null){\n                 //     server.saveParam(\"all\", Store.currentSheetIndex, currentSheet.freezen, { \"k\": \"freezen\" });\n                 // }\n                 // use new property frozen\n            // if(currentSheet.freezen != null){\n            //     server.saveParam(\"all\", Store.currentSheetIndex, currentSheet.freezen, { \"k\": \"freezen\" });\n            // }\n            // use new property frozen\n            if (currentSheet.frozen != null) {\n                server.saveParam('all', Store.currentSheetIndex, currentSheet.frozen, { 'k': 'frozen' });\n            }\n        },\n        initialFreezen: function (sheetIndex) {\n            let _this = this;    // when init ,we get frozen, but here, we need freezen,so tranform it\n            // when init ,we get frozen, but here, we need freezen,so tranform it\n            _this.frozenTofreezen();\n            let currentSheet = Store.luckysheetfile[getSheetIndex(sheetIndex)];\n            if (currentSheet.freezen != null && currentSheet.freezen.horizontal != null && currentSheet.freezen.horizontal.freezenhorizontaldata != null) {\n                _this.createFreezenHorizontal(currentSheet.freezen.horizontal.freezenhorizontaldata, currentSheet.freezen.horizontal.top);\n            } else {\n                _this.cancelFreezenHorizontal(sheetIndex);\n            }\n            if (currentSheet.freezen != null && currentSheet.freezen.vertical != null && currentSheet.freezen.vertical.freezenverticaldata != null) {\n                _this.createFreezenVertical(currentSheet.freezen.vertical.freezenverticaldata, currentSheet.freezen.vertical.left);\n            } else {\n                _this.cancelFreezenVertical(sheetIndex);\n            }\n            _this.createAssistCanvas();\n        },\n        changeFreezenIndex: function (originindex, type) {\n            let _this = this;\n            if (type == 'v' && _this.freezenverticaldata != null) {\n                let freezen_colindex = _this.freezenverticaldata[1];\n                let offset = luckysheet_searcharray(Store.visibledatacolumn, $('#luckysheet-cell-main').scrollLeft());\n                if (originindex - offset < freezen_colindex) {\n                    originindex = originindex - offset;\n                }\n            } else if (type == 'h' && _this.freezenhorizontaldata != null) {\n                let freezen_rowindex = _this.freezenhorizontaldata[1];\n                let offset = luckysheet_searcharray(Store.visibledatarow, $('#luckysheet-cell-main').scrollTop());\n                if (originindex - offset < freezen_rowindex) {\n                    originindex = originindex - offset;\n                }\n            }\n            return originindex;\n        },\n        scrollFreezen: function () {\n            let _this = this;\n            let row;\n            let row_focus = Store.luckysheet_select_save[0]['row_focus'];\n            if (row_focus == Store.luckysheet_select_save[0]['row'][0]) {\n                row = Store.luckysheet_select_save[0]['row'][1];\n            } else if (row_focus == Store.luckysheet_select_save[0]['row'][1]) {\n                row = Store.luckysheet_select_save[0]['row'][0];\n            }\n            let column;\n            let column_focus = Store.luckysheet_select_save[0]['column_focus'];\n            if (column_focus == Store.luckysheet_select_save[0]['column'][0]) {\n                column = Store.luckysheet_select_save[0]['column'][1];\n            } else if (column_focus == Store.luckysheet_select_save[0]['column'][1]) {\n                column = Store.luckysheet_select_save[0]['column'][0];\n            }\n            if (_this.freezenverticaldata != null) {\n                let freezen_colindex = _this.freezenverticaldata[1];\n                let offset = luckysheet_searcharray(_this.freezenverticaldata[3], $('#luckysheet-cell-main').scrollLeft());\n                let top = _this.freezenverticaldata[4];\n                freezen_colindex += offset;\n                if (column >= Store.visibledatacolumn.length) {\n                    column = Store.visibledatacolumn.length - 1;\n                }\n                if (freezen_colindex >= Store.visibledatacolumn.length) {\n                    freezen_colindex = Store.visibledatacolumn.length - 1;\n                }\n                let column_px = Store.visibledatacolumn[column], freezen_px = Store.visibledatacolumn[freezen_colindex];\n                if (column_px <= freezen_px + top) {\n                    console.log(1111);\n                    setTimeout(function () {\n                        $('#luckysheet-scrollbar-x').scrollLeft(0);\n                    }, 100);\n                }\n            }\n            if (_this.freezenhorizontaldata != null) {\n                let freezen_rowindex = _this.freezenhorizontaldata[1];\n                let offset = luckysheet_searcharray(_this.freezenhorizontaldata[3], $('#luckysheet-cell-main').scrollTop());\n                let left = _this.freezenhorizontaldata[4];\n                freezen_rowindex += offset;\n                if (row >= Store.visibledatarow.length) {\n                    row = Store.visibledatarow.length - 1;\n                }\n                if (freezen_rowindex >= Store.visibledatarow.length) {\n                    freezen_rowindex = Store.visibledatarow.length - 1;\n                }\n                let row_px = Store.visibledatarow[row], freezen_px = Store.visibledatarow[freezen_rowindex];\n                if (row_px <= freezen_px + left) {\n                    setTimeout(function () {\n                        $('#luckysheet-scrollbar-y').scrollTop(0);\n                    }, 100);\n                }\n            }\n        },\n        cancelFreezenHorizontal: function (sheetIndex) {\n            let _this = this;    // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"luckysheet-icon-img-container iconfont luckysheet-iconfont-dongjie1\"></i> '+locale().freezen.default);\n                                 // 解决freeze 不垂直居中的问题\n            // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"luckysheet-icon-img-container iconfont luckysheet-iconfont-dongjie1\"></i> '+locale().freezen.default);\n            // 解决freeze 不垂直居中的问题\n            const freezeHTML = `\n            <div class=\"luckysheet-toolbar-button-outer-box luckysheet-inline-block\"\n            style=\"user-select: none;\">\n                <div class=\"luckysheet-toolbar-button-inner-box luckysheet-inline-block\"\n                style=\"user-select: none;\">\n                    <div class=\"luckysheet-icon luckysheet-inline-block \" style=\"user-select: none;\">\n                        <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1\"\n                        style=\"user-select: none;\">\n                        </div>\n                    </div>\n                    <div class=\"luckysheet-toolbar-menu-button-caption luckysheet-inline-block\"\n                    style=\"user-select: none;\">\n                        ${ locale().freezen.default }\n                    </div>\n                </div>\n            </div>\n        `;\n            $('#luckysheet-freezen-btn-horizontal').html(freezeHTML);\n            _this.freezenhorizontaldata = null;\n            let ishorizontal = $('#luckysheet-freezebar-horizontal').is(':visible');\n            $('#luckysheet-freezebar-horizontal').hide();\n            if (sheetIndex == null) {\n                sheetIndex = Store.currentSheetIndex;\n            }\n            let currentSheet = Store.luckysheetfile[getSheetIndex(sheetIndex)];\n            if (currentSheet.freezen != null) {\n                currentSheet.freezen.horizontal = null;\n            }\n            if (currentSheet.frozen != null && ishorizontal) {\n                server.saveParam('all', sheetIndex, currentSheet.frozen, { 'k': 'frozen' });\n            }\n        },\n        createFreezenHorizontal: function (freezenhorizontaldata, top) {\n            let _this = this;\n            if (_this.initialHorizontal) {\n                _this.initialHorizontal = false;\n                $('#luckysheet-grid-window-1').append(_this.freezenHorizontalHTML);\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-drop').hover(function () {\n                    $(this).parent().addClass('luckysheet-freezebar-hover');\n                }, function () {\n                    $(this).parent().removeClass('luckysheet-freezebar-hover');\n                });\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-drop').mousedown(function () {\n                    _this.horizontalmovestate = true;\n                    _this.horizontalmoveposition = $(this).position().top;\n                    _this.windowHeight = $('#luckysheet-grid-window-1').height();\n                    $(this).parent().addClass('luckysheet-freezebar-active');\n                    $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-handle').css('cursor', '-webkit-grabbing');\n                });\n                let gridwidth = $('#luckysheet-grid-window-1').width();\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-handle').css({\n                    'width': gridwidth - 10,\n                    'height': '4px',\n                    'cursor': '-webkit-grab',\n                    'left': '0px'\n                }).end().find('.luckysheet-freezebar-horizontal-drop').css({\n                    'width': gridwidth - 10,\n                    'height': '4px',\n                    'left': '0px',\n                    'cursor': '-webkit-grab'\n                });\n            }\n            if (freezenhorizontaldata == null) {\n                let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let dataset_row_st = luckysheet_searcharray(Store.visibledatarow, scrollTop);\n                if (dataset_row_st == -1) {\n                    dataset_row_st = 0;\n                }\n                top = Store.visibledatarow[dataset_row_st] - 2 - scrollTop + Store.columnHeaderHeight;\n                freezenhorizontaldata = [\n                    Store.visibledatarow[dataset_row_st],\n                    dataset_row_st + 1,\n                    scrollTop,\n                    _this.cutVolumn(Store.visibledatarow, dataset_row_st + 1),\n                    top\n                ];\n                _this.saveFreezen(freezenhorizontaldata, top, null, null);\n            }\n            _this.freezenhorizontaldata = freezenhorizontaldata;    // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"fa fa-list-alt\"></i> '+locale().freezen.freezenCancel);\n                                                                    // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"luckysheet-icon-img-container iconfont luckysheet-iconfont-dongjie1\"></i> '+locale().freezen.freezenCancel);\n            // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"fa fa-list-alt\"></i> '+locale().freezen.freezenCancel);\n            // $(\"#luckysheet-freezen-btn-horizontal\").html('<i class=\"luckysheet-icon-img-container iconfont luckysheet-iconfont-dongjie1\"></i> '+locale().freezen.freezenCancel);\n            const freezeHTML = `\n            <div class=\"luckysheet-toolbar-button-outer-box luckysheet-inline-block\"\n            style=\"user-select: none;\">\n                <div class=\"luckysheet-toolbar-button-inner-box luckysheet-inline-block\"\n                style=\"user-select: none;\">\n                    <div class=\"luckysheet-icon luckysheet-inline-block \" style=\"user-select: none;\">\n                        <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1\"\n                        style=\"user-select: none;\">\n                        </div>\n                    </div>\n                    <div class=\"luckysheet-toolbar-menu-button-caption luckysheet-inline-block\"\n                    style=\"user-select: none;\">\n                        ${ locale().freezen.freezenCancel }\n                    </div>\n                </div>\n            </div>\n        `;\n            $('#luckysheet-freezen-btn-horizontal').html(freezeHTML);\n            $('#luckysheet-freezebar-horizontal').show().find('.luckysheet-freezebar-horizontal-handle').css({ 'top': top }).end().find('.luckysheet-freezebar-horizontal-drop').css({ 'top': top });\n        },\n        createAssistCanvas: function () {\n            let _this = this;\n            _this.removeAssistCanvas();\n            if (_this.freezenverticaldata != null || _this.freezenhorizontaldata != null) {\n                let freezen_horizon_px, freezen_horizon_ed, freezen_horizon_scrollTop;\n                let freezen_vertical_px, freezen_vertical_ed, freezen_vertical_scrollTop;\n                let drawWidth = Store.luckysheetTableContentHW[0], drawHeight = Store.luckysheetTableContentHW[1];    //双向freezen\n                //双向freezen\n                if (_this.freezenverticaldata != null && _this.freezenhorizontaldata != null) {\n                    freezen_horizon_px = _this.freezenhorizontaldata[0];\n                    freezen_horizon_ed = _this.freezenhorizontaldata[1];\n                    freezen_horizon_scrollTop = _this.freezenhorizontaldata[2];\n                    freezen_vertical_px = _this.freezenverticaldata[0];\n                    freezen_vertical_ed = _this.freezenverticaldata[1];\n                    freezen_vertical_scrollTop = _this.freezenverticaldata[2];    //3\n                    //3\n                    _this.createCanvas('freezen_3', freezen_vertical_px - freezen_vertical_scrollTop, freezen_horizon_px - freezen_horizon_scrollTop + 1, Store.rowHeaderWidth - 1, Store.columnHeaderHeight - 1);    //4\n                    //4\n                    _this.createCanvas('freezen_4', drawWidth - freezen_vertical_px + freezen_vertical_scrollTop, freezen_horizon_px - freezen_horizon_scrollTop + 1, freezen_vertical_px - freezen_vertical_scrollTop + Store.rowHeaderWidth - 1, Store.columnHeaderHeight - 1);    //7\n                    //7\n                    _this.createCanvas('freezen_7', freezen_vertical_px - freezen_vertical_scrollTop, drawHeight - freezen_horizon_px + freezen_horizon_scrollTop - Store.columnHeaderHeight, Store.rowHeaderWidth - 1, freezen_horizon_px - freezen_horizon_scrollTop + Store.columnHeaderHeight - 1);\n                }    //水平freezen\n                else //水平freezen\n                if (_this.freezenhorizontaldata != null) {\n                    freezen_horizon_px = _this.freezenhorizontaldata[0];\n                    freezen_horizon_ed = _this.freezenhorizontaldata[1];\n                    freezen_horizon_scrollTop = _this.freezenhorizontaldata[2];\n                    _this.createCanvas('freezen_h', drawWidth, freezen_horizon_px - freezen_horizon_scrollTop + 1, Store.rowHeaderWidth - 1, Store.columnHeaderHeight - 1);\n                }    //垂直freezen\n                else //垂直freezen\n                if (_this.freezenverticaldata != null) {\n                    freezen_vertical_px = _this.freezenverticaldata[0];\n                    freezen_vertical_ed = _this.freezenverticaldata[1];\n                    freezen_vertical_scrollTop = _this.freezenverticaldata[2];\n                    _this.createCanvas('freezen_v', freezen_vertical_px - freezen_vertical_scrollTop, drawHeight, Store.rowHeaderWidth - 1, Store.columnHeaderHeight - 1);\n                }\n                _this.scrollAdapt();\n            }\n        },\n        createCanvas: function (id, width, height, left, top) {\n            let c = $('<canvas/>').appendTo('#luckysheet-grid-window-1').attr({\n                'id': id,\n                'width': Math.ceil(width * Store.devicePixelRatio),\n                'height': Math.ceil(height * Store.devicePixelRatio)\n            }).css({\n                'user-select': 'none',\n                'postion': 'absolute',\n                'left': left,\n                'top': top,\n                'width': width,\n                'height': height,\n                'z-index': 10,\n                'pointer-events': 'none'\n            });\n        },\n        removeAssistCanvas: function () {\n            $('#luckysheet-grid-window-1 > canvas').not($('#luckysheetTableContent')).remove();\n            $('#luckysheet-cell-selected').css('z-index', 15);\n        },\n        scrollAdapt: function () {\n            let _this = this;    //有冻结时 选区框 滚动适应\n            //有冻结时 选区框 滚动适应\n            if (Store.luckysheet_select_save != null && Store.luckysheet_select_save.length > 0) {\n                _this.scrollAdaptOfselect();\n            }    //有冻结时 图表框 滚动适应\n            //有冻结时 图表框 滚动适应\n            if ($('#luckysheet-cell-main .luckysheet-data-visualization-chart').length > 0) {\n                // 当前sheet有图表才需要滚动适应\n                const chart = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['chart'];\n                if (chart != null && chart.length > 0) {\n                    _this.scrollAdaptOfchart();\n                }\n            }    //有冻结时 批注框 滚动适应\n            //有冻结时 批注框 滚动适应\n            if ($('#luckysheet-postil-showBoxs .luckysheet-postil-show').length > 0) {\n                _this.scrollAdaptOfpostil();\n            }    //有冻结时 下拉选区图标 滚动适应\n            //有冻结时 下拉选区图标 滚动适应\n            if ($('#luckysheet-dropCell-icon').length > 0) {\n                _this.scrollAdaptOfdpicon();\n            }    //有冻结时 筛选下拉按钮 滚动适应\n            //有冻结时 筛选下拉按钮 滚动适应\n            if ($('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').length > 0) {\n                _this.scrollAdaptOffilteroptions();\n            }\n        },\n        scrollAdaptOfselect: function () {\n            let _this = this;\n            if ($('#luckysheet-row-count-show').is(':visible')) {\n                $('#luckysheet-row-count-show').hide();\n            }\n            if ($('#luckysheet-column-count-show').is(':visible')) {\n                $('#luckysheet-column-count-show').hide();\n            }\n            $('#luckysheet-rows-h-selected').empty();\n            $('#luckysheet-cols-h-selected').empty();\n            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            if (_this.freezenhorizontaldata != null && _this.freezenverticaldata != null) {\n                let freezenTop = _this.freezenhorizontaldata[0];\n                let freezen_rowindex = _this.freezenhorizontaldata[1];\n                let offTop = scrollTop - _this.freezenhorizontaldata[2];\n                let freezenLeft = _this.freezenverticaldata[0];\n                let freezen_colindex = _this.freezenverticaldata[1];\n                let offLeft = scrollLeft - _this.freezenverticaldata[2];\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let obj = $.extend(true, {}, Store.luckysheet_select_save[s]);\n                    let r1 = obj.row[0], r2 = obj.row[1];\n                    let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                    let top_move = row_pre;\n                    let height_move = row - row_pre - 1;\n                    let rangeshow = true;\n                    if (r1 >= freezen_rowindex) {\n                        //原选区在冻结区外\n                        if (top_move + height_move < freezenTop + offTop) {\n                            rangeshow = false;\n                        } else if (top_move < freezenTop + offTop) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': freezenTop + offTop,\n                                'height': height_move - (freezenTop + offTop - top_move)\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move,\n                                'height': height_move\n                            });\n                        }\n                    } else if (r2 >= freezen_rowindex) {\n                        //原选区有一部分在冻结区内\n                        if (top_move + height_move < freezenTop + offTop) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move + offTop,\n                                'height': freezenTop - top_move\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move + offTop,\n                                'height': height_move - offTop\n                            });\n                        }\n                    } else {\n                        //原选区在冻结区内\n                        $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css('top', top_move + offTop);\n                    }\n                    let c1 = obj.column[0], c2 = obj.column[1];\n                    let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                    let left_move = col_pre;\n                    let width_move = col - col_pre - 1;\n                    if (c1 >= freezen_colindex) {\n                        //原选区在冻结区外\n                        if (left_move + width_move < freezenLeft + offLeft) {\n                            rangeshow = false;\n                        } else if (left_move < freezenLeft + offLeft) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': freezenLeft + offLeft,\n                                'width': width_move - (freezenLeft + offLeft - left_move)\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move,\n                                'width': width_move\n                            });\n                        }\n                    } else if (c2 >= freezen_colindex) {\n                        //原选区有一部分在冻结区内\n                        if (left_move + width_move < freezenLeft + offLeft) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move + offLeft,\n                                'width': freezenLeft - left_move\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move + offLeft,\n                                'width': width_move - offLeft\n                            });\n                        }\n                    } else {\n                        //原选区在冻结区内\n                        $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css('left', left_move + offLeft);\n                    }\n                    if (!rangeshow) {\n                        $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).hide();\n                    }\n                    if (s == Store.luckysheet_select_save.length - 1) {\n                        let rf = obj.row_focus == null ? r1 : obj.row_focus;\n                        let cf = obj.column_focus == null ? c1 : obj.column_focus;\n                        let row_f = Store.visibledatarow[rf], row_pre_f = rf - 1 == -1 ? 0 : Store.visibledatarow[rf - 1];\n                        let col_f = Store.visibledatacolumn[cf], col_pre_f = cf - 1 == -1 ? 0 : Store.visibledatacolumn[cf - 1];\n                        let margeset = menuButton.mergeborer(Store.flowdata, rf, cf);\n                        if (!!margeset) {\n                            row_f = margeset.row[1];\n                            row_pre_f = margeset.row[0];\n                            col_f = margeset.column[1];\n                            col_pre_f = margeset.column[0];\n                        }\n                        let top = row_pre_f;\n                        let height = row_f - row_pre_f - 1;\n                        let left = col_pre_f;\n                        let width = col_f - col_pre_f - 1;\n                        let focuscell = true;\n                        if (top >= freezenTop) {\n                            if (top + height < freezenTop + offTop) {\n                                focuscell = false;\n                            } else if (top < freezenTop + offTop) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': freezenTop + offTop,\n                                    'height': height - (freezenTop + offTop - top)\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top,\n                                    'height': height\n                                });\n                            }\n                        } else if (top + height >= freezenTop) {\n                            if (top + height < freezenTop + offTop) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top + offTop,\n                                    'height': freezenTop - top\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top + offTop,\n                                    'height': height - offTop\n                                });\n                            }\n                        } else {\n                            $('#luckysheet-cell-selected-focus').show().css('top', top + offTop);\n                        }\n                        if (left >= freezenLeft) {\n                            if (left + width < freezenLeft + offLeft) {\n                                focuscell = false;\n                            } else if (left < freezenLeft + offLeft) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': freezenLeft + offLeft,\n                                    'width': width - (freezenLeft + offLeft - left)\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left,\n                                    'width': width\n                                });\n                            }\n                        } else if (left + width >= freezenLeft) {\n                            if (left + width < freezenLeft + offLeft) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left + offLeft,\n                                    'width': freezenLeft - left\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left + offLeft,\n                                    'width': width - offLeft\n                                });\n                            }\n                        } else {\n                            $('#luckysheet-cell-selected-focus').show().css('left', left + offLeft);\n                        }\n                        if (!focuscell) {\n                            $('#luckysheet-cell-selected-focus').hide();\n                        }\n                    }\n                }\n            } else if (_this.freezenhorizontaldata != null) {\n                let freezenTop = _this.freezenhorizontaldata[0];\n                let freezen_rowindex = _this.freezenhorizontaldata[1];\n                let offTop = scrollTop - _this.freezenhorizontaldata[2];\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let obj = $.extend(true, {}, Store.luckysheet_select_save[s]);\n                    let r1 = obj.row[0], r2 = obj.row[1];\n                    let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                    let top_move = row_pre;\n                    let height_move = row - row_pre - 1;\n                    if (r1 >= freezen_rowindex) {\n                        //原选区在冻结区外\n                        if (top_move + height_move < freezenTop + offTop) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).hide();\n                        } else if (top_move < freezenTop + offTop) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': freezenTop + offTop,\n                                'height': height_move - (freezenTop + offTop - top_move)\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move,\n                                'height': height_move\n                            });\n                        }\n                    } else if (r2 >= freezen_rowindex) {\n                        //原选区有一部分在冻结区内\n                        if (top_move + height_move < freezenTop + offTop) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move + offTop,\n                                'height': freezenTop - top_move\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'top': top_move + offTop,\n                                'height': height_move - offTop\n                            });\n                        }\n                    } else {\n                        //原选区在冻结区内\n                        $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css('top', top_move + offTop);\n                    }\n                    if (s == Store.luckysheet_select_save.length - 1) {\n                        let rf = obj.row_focus == null ? r1 : obj.row_focus;\n                        let cf = obj.column_focus == null ? obj.column[0] : obj.column_focus;\n                        let row_f = Store.visibledatarow[rf], row_pre_f = rf - 1 == -1 ? 0 : Store.visibledatarow[rf - 1];\n                        let margeset = menuButton.mergeborer(Store.flowdata, rf, cf);\n                        if (!!margeset) {\n                            row_f = margeset.row[1];\n                            row_pre_f = margeset.row[0];\n                        }\n                        let top = row_pre_f;\n                        let height = row_f - row_pre_f - 1;\n                        if (top >= freezenTop) {\n                            if (top + height < freezenTop + offTop) {\n                                $('#luckysheet-cell-selected-focus').hide();\n                            } else if (top < freezenTop + offTop) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': freezenTop + offTop,\n                                    'height': height - (freezenTop + offTop - top)\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top,\n                                    'height': height\n                                });\n                            }\n                        } else if (top + height >= freezenTop) {\n                            if (top + height < freezenTop + offTop) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top + offTop,\n                                    'height': freezenTop - top\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'top': top + offTop,\n                                    'height': height - offTop\n                                });\n                            }\n                        } else {\n                            $('#luckysheet-cell-selected-focus').show().css('top', top + offTop);\n                        }\n                    }\n                }\n            } else if (_this.freezenverticaldata != null) {\n                let freezenLeft = _this.freezenverticaldata[0];\n                let freezen_colindex = _this.freezenverticaldata[1];\n                let offLeft = scrollLeft - _this.freezenverticaldata[2];\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let obj = $.extend(true, {}, Store.luckysheet_select_save[s]);\n                    let c1 = obj.column[0], c2 = obj.column[1];\n                    let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                    let left_move = col_pre;\n                    let width_move = col - col_pre - 1;\n                    if (c1 >= freezen_colindex) {\n                        //原选区在冻结区外\n                        if (left_move + width_move < freezenLeft + offLeft) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).hide();\n                        } else if (left_move < freezenLeft + offLeft) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': freezenLeft + offLeft,\n                                'width': width_move - (freezenLeft + offLeft - left_move)\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move,\n                                'width': width_move\n                            });\n                        }\n                    } else if (c2 >= freezen_colindex) {\n                        //原选区有一部分在冻结区内\n                        if (left_move + width_move < freezenLeft + offLeft) {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move + offLeft,\n                                'width': freezenLeft - left_move\n                            });\n                        } else {\n                            $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css({\n                                'left': left_move + offLeft,\n                                'width': width_move - offLeft\n                            });\n                        }\n                    } else {\n                        //原选区在冻结区内\n                        $('#luckysheet-cell-selected-boxs').find('.luckysheet-cell-selected').eq(s).show().css('left', left_move + offLeft);\n                    }\n                    if (s == Store.luckysheet_select_save.length - 1) {\n                        let rf = obj.row_focus == null ? obj.row[0] : obj.row_focus;\n                        let cf = obj.column_focus == null ? c1 : obj.column_focus;\n                        let col_f = Store.visibledatacolumn[cf], col_pre_f = cf - 1 == -1 ? 0 : Store.visibledatacolumn[cf - 1];\n                        let margeset = menuButton.mergeborer(Store.flowdata, rf, cf);\n                        if (!!margeset) {\n                            col_f = margeset.column[1];\n                            col_pre_f = margeset.column[0];\n                        }\n                        let left = col_pre_f;\n                        let width = col_f - col_pre_f - 1;\n                        if (left >= freezenLeft) {\n                            if (left + width < freezenLeft + offLeft) {\n                                $('#luckysheet-cell-selected-focus').hide();\n                            } else if (left < freezenLeft + offLeft) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': freezenLeft + offLeft,\n                                    'width': width - (freezenLeft + offLeft - left)\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left,\n                                    'width': width\n                                });\n                            }\n                        } else if (left + width >= freezenLeft) {\n                            if (left + width < freezenLeft + offLeft) {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left + offLeft,\n                                    'width': freezenLeft - left\n                                });\n                            } else {\n                                $('#luckysheet-cell-selected-focus').show().css({\n                                    'left': left + offLeft,\n                                    'width': width - offLeft\n                                });\n                            }\n                        } else {\n                            $('#luckysheet-cell-selected-focus').show().css('left', left + offLeft);\n                        }\n                    }\n                }\n            } else {\n                selectHightlightShow();\n            }\n        },\n        scrollAdaptOfchart: function () {\n            let _this = this;\n            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            if (_this.freezenhorizontaldata != null && _this.freezenverticaldata != null) {\n                let freezenTop = _this.freezenhorizontaldata[0] - _this.freezenhorizontaldata[2];\n                let freezenLeft = _this.freezenverticaldata[0] - _this.freezenverticaldata[2];\n                $('#luckysheet-cell-main .luckysheet-data-visualization-chart').each(function (i, e) {\n                    let x = $(e).position();\n                    let width = $(e).width();\n                    let height = $(e).height();\n                    let $canvas_width = $(e).find('canvas').width();\n                    let $canvas_height = $(e).find('canvas').height();\n                    let height_diff = $canvas_height - height;\n                    let width_diff = $canvas_width - width;\n                    if (x.top - height_diff < freezenTop) {\n                        let size = freezenTop - (x.top - height_diff);\n                        if (size > $canvas_height + 40 + 2) {\n                            $(e).css('visibility', 'hidden');\n                        } else {\n                            $(e).css({\n                                'top': freezenTop + scrollTop,\n                                'height': $canvas_height - size,\n                                'visibility': 'visible'\n                            });\n                            $(e).find('canvas').css('top', -size);\n                        }\n                    } else {\n                        $(e).css({\n                            'top': x.top - height_diff + scrollTop,\n                            'height': $canvas_height,\n                            'visibility': 'visible'\n                        });\n                        $(e).find('canvas').css('top', 0);\n                    }\n                    if (x.left - width_diff < freezenLeft) {\n                        let size = freezenLeft - (x.left - width_diff);\n                        if (size > $canvas_width + 20 + 2) {\n                            $(e).css('visibility', 'hidden');\n                        } else {\n                            $(e).css({\n                                'left': freezenLeft + scrollLeft,\n                                'width': $canvas_width - size,\n                                'visibility': 'visible'\n                            });\n                            $(e).find('canvas').css('left', -size);\n                        }\n                    } else {\n                        $(e).css({\n                            'left': x.left - width_diff + scrollLeft,\n                            'width': $canvas_width,\n                            'visibility': 'visible'\n                        });\n                        $(e).find('canvas').css('left', 0);\n                    }\n                });\n            } else if (_this.freezenhorizontaldata != null) {\n                let freezenTop = _this.freezenhorizontaldata[0] - _this.freezenhorizontaldata[2];\n                $('#luckysheet-cell-main .luckysheet-data-visualization-chart').each(function (i, e) {\n                    let x = $(e).position();\n                    let height = $(e).height();\n                    let $canvas_height = $(e).find('canvas').height();\n                    let height_diff = $canvas_height - height;\n                    if (x.top - height_diff < freezenTop) {\n                        let size = freezenTop - (x.top - height_diff);\n                        if (size > $canvas_height + 40 + 2) {\n                            $(e).css('visibility', 'hidden');\n                        } else {\n                            $(e).css({\n                                'top': freezenTop + scrollTop,\n                                'height': $canvas_height - size,\n                                'visibility': 'visible'\n                            });\n                            $(e).find('canvas').css('top', -size);\n                        }\n                    } else {\n                        $(e).css({\n                            'top': x.top - height_diff + scrollTop,\n                            'height': $canvas_height,\n                            'visibility': 'visible'\n                        });\n                        $(e).find('canvas').css('top', 0);\n                    }\n                });\n            } else if (_this.freezenverticaldata != null) {\n                let freezenLeft = _this.freezenverticaldata[0] - _this.freezenverticaldata[2];\n                $('#luckysheet-cell-main .luckysheet-data-visualization-chart').each(function (i, e) {\n                    let x = $(e).position();\n                    let width = $(e).width();\n                    let $canvas_width = $(e).find('canvas').width();\n                    let width_diff = $canvas_width - width;\n                    if (x.left - width_diff < freezenLeft) {\n                        let size = freezenLeft - (x.left - width_diff);\n                        if (size > $canvas_width + 20 + 2) {\n                            $(e).css('visibility', 'hidden');\n                        } else {\n                            $(e).css({\n                                'left': freezenLeft + scrollLeft,\n                                'width': $canvas_width - size,\n                                'visibility': 'visible'\n                            });\n                            $(e).find('canvas').css('left', -size);\n                        }\n                    } else {\n                        $(e).css({\n                            'left': x.left - width_diff + scrollLeft,\n                            'width': $canvas_width,\n                            'visibility': 'visible'\n                        });\n                        $(e).find('canvas').css('left', 0);\n                    }\n                });\n            } else {\n                $('#luckysheet-cell-main .luckysheet-data-visualization-chart').each(function (i, e) {\n                    let x = $(e).position();\n                    let width = $(e).width();\n                    let height = $(e).height();\n                    let $canvas_width = $(e).find('canvas').width();\n                    let $canvas_height = $(e).find('canvas').height();\n                    let height_diff = $canvas_height - height;\n                    let width_diff = $canvas_width - width;\n                    $(e).css({\n                        'top': x.top - height_diff + scrollTop,\n                        'height': $canvas_height,\n                        'left': x.left - width_diff + scrollLeft,\n                        'width': $canvas_width,\n                        'visibility': 'visible'\n                    });\n                    $(e).find('canvas').css({\n                        'top': 0,\n                        'left': 0\n                    });\n                });\n            }\n        },\n        scrollAdaptOfpostil: function () {\n            let _this = this;\n            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            if (_this.freezenhorizontaldata != null && _this.freezenverticaldata != null) {\n                let freezenTop = _this.freezenhorizontaldata[0];\n                let freezenLeft = _this.freezenverticaldata[0];\n                let offTop = scrollTop - _this.freezenhorizontaldata[2];\n                let offLeft = scrollLeft - _this.freezenverticaldata[2];\n                $('#luckysheet-postil-showBoxs .luckysheet-postil-show').each(function (i, e) {\n                    let id = $(e).attr('id');\n                    let r = id.split('luckysheet-postil-show_')[1].split('_')[0];\n                    let c = id.split('luckysheet-postil-show_')[1].split('_')[1];\n                    let postil = Store.flowdata[r][c].ps;\n                    let row = Store.visibledatarow[r], row_pre = r - 1 == -1 ? 0 : Store.visibledatarow[r - 1];\n                    let col = Store.visibledatacolumn[c], col_pre = c - 1 == -1 ? 0 : Store.visibledatacolumn[c - 1];\n                    let margeset = menuButton.mergeborer(Store.flowdata, r, c);\n                    if (!!margeset) {\n                        row = margeset.row[1];\n                        row_pre = margeset.row[0];\n                        col = margeset.column[1];\n                        col_pre = margeset.column[0];\n                    }\n                    let toX = col;\n                    let toY = row_pre;\n                    let postil_left = postil['left'] == null ? toX + 18 : postil['left'];\n                    let postil_top = postil['top'] == null ? toY - 18 : postil['top'];\n                    let postil_width = postil['width'] == null ? luckysheetPostil.defaultWidth : postil['width'];\n                    let postil_height = postil['height'] == null ? luckysheetPostil.defaultHeight : postil['height'];\n                    if (postil_top < 0) {\n                        postil_top = 2;\n                    }\n                    let size = luckysheetPostil.getArrowCanvasSize(postil_left, postil_top, toX, toY);\n                    let show = true;\n                    let show2 = true;\n                    if (r >= _this.freezenhorizontaldata[1]) {\n                        if (postil_top + postil_height < freezenTop) {\n                            $(e).show().find('.luckysheet-postil-show-main').css('top', postil_top + offTop);\n                            $(e).show().find('.arrowCanvas').css('top', size[1] + offTop);\n                        } else {\n                            if (postil_top < freezenTop + offTop) {\n                                if (postil_top + postil_height <= freezenTop + offTop) {\n                                    show = false;\n                                } else {\n                                    $(e).show().find('.luckysheet-postil-show-main').css({\n                                        'top': freezenTop + offTop,\n                                        'height': postil_height - (freezenTop + offTop - postil_top)\n                                    });\n                                    $(e).show().find('.formulaInputFocus').css('margin-top', -(freezenTop + offTop - postil_top));\n                                    $(e).show().find('.arrowCanvas').hide();\n                                    show2 = false;\n                                }\n                            } else {\n                                $(e).show().find('.luckysheet-postil-show-main').css({\n                                    'top': postil_top,\n                                    'height': postil_height\n                                });\n                                $(e).show().find('.formulaInputFocus').css('margin-top', 0);\n                                $(e).show().find('.arrowCanvas').css('top', size[1]);    // luckysheetPostil.buildPs(r, c, postil);\n                            }\n                        }\n                    } else\n                        // luckysheetPostil.buildPs(r, c, postil);\n                        {\n                            $(e).show().find('.luckysheet-postil-show-main').css('top', postil_top + offTop);\n                            $(e).show().find('.arrowCanvas').css('top', size[1] + offTop);\n                        }\n                    if (c >= _this.freezenverticaldata[1]) {\n                        if (postil_left + postil_width < freezenLeft) {\n                            $(e).show().find('.luckysheet-postil-show-main').css('left', postil_left + offLeft);\n                            $(e).show().find('.arrowCanvas').css('left', size[0] + offLeft);\n                        } else {\n                            if (postil_left < freezenLeft + offLeft) {\n                                if (postil_left + postil_width <= freezenLeft + offLeft) {\n                                    show = false;\n                                } else {\n                                    $(e).show().find('.luckysheet-postil-show-main').css({\n                                        'left': freezenLeft + offLeft,\n                                        'width': postil_width - (freezenLeft + offLeft - postil_left)\n                                    });\n                                    $(e).show().find('.formulaInputFocus').css('margin-left', -(freezenLeft + offLeft - postil_left));\n                                    $(e).show().find('.arrowCanvas').hide();\n                                    show2 = false;\n                                }\n                            } else {\n                                $(e).show().find('.luckysheet-postil-show-main').css({\n                                    'left': postil_left,\n                                    'width': postil_width\n                                });\n                                $(e).show().find('.formulaInputFocus').css('margin-left', 0);\n                                $(e).show().find('.arrowCanvas').css('left', size[0]);    // luckysheetPostil.buildPs(r, c, postil);\n                            }\n                        }\n                    } else\n                        // luckysheetPostil.buildPs(r, c, postil);\n                        {\n                            $(e).show().find('.luckysheet-postil-show-main').css('left', postil_left + offLeft);\n                            $(e).show().find('.arrowCanvas').css('left', size[0] + offLeft);\n                        }\n                    if (!show) {\n                        $(e).hide();\n                    }\n                    if (show && show2) {\n                        $(e).show().find('.arrowCanvas').show();\n                    }\n                });\n            } else if (_this.freezenhorizontaldata != null) {\n                let freezenTop = _this.freezenhorizontaldata[0];\n                let offTop = scrollTop - _this.freezenhorizontaldata[2];\n                $('#luckysheet-postil-showBoxs .luckysheet-postil-show').each(function (i, e) {\n                    let id = $(e).attr('id');\n                    let r = id.split('luckysheet-postil-show_')[1].split('_')[0];\n                    let c = id.split('luckysheet-postil-show_')[1].split('_')[1];\n                    let postil = Store.flowdata[r][c].ps;\n                    let row = Store.visibledatarow[r], row_pre = r - 1 == -1 ? 0 : Store.visibledatarow[r - 1];\n                    let col = Store.visibledatacolumn[c], col_pre = c - 1 == -1 ? 0 : Store.visibledatacolumn[c - 1];\n                    let margeset = menuButton.mergeborer(Store.flowdata, r, c);\n                    if (!!margeset) {\n                        row = margeset.row[1];\n                        row_pre = margeset.row[0];\n                        col = margeset.column[1];\n                        col_pre = margeset.column[0];\n                    }\n                    let toX = col;\n                    let toY = row_pre;\n                    let postil_left = postil['left'] == null ? toX + 18 : postil['left'];\n                    let postil_top = postil['top'] == null ? toY - 18 : postil['top'];\n                    let postil_width = postil['width'] == null ? luckysheetPostil.defaultWidth : postil['width'];\n                    let postil_height = postil['height'] == null ? luckysheetPostil.defaultHeight : postil['height'];\n                    if (postil_top < 0) {\n                        postil_top = 2;\n                    }\n                    let size = luckysheetPostil.getArrowCanvasSize(postil_left, postil_top, toX, toY);\n                    if (r >= _this.freezenhorizontaldata[1]) {\n                        if (postil_top + postil_height < freezenTop) {\n                            $(e).show().find('.luckysheet-postil-show-main').css('top', postil_top + offTop);\n                            $(e).show().find('.arrowCanvas').css('top', size[1] + offTop);\n                        } else {\n                            if (postil_top < freezenTop + offTop) {\n                                if (postil_top + postil_height <= freezenTop + offTop) {\n                                    $(e).hide();\n                                } else {\n                                    $(e).show().find('.luckysheet-postil-show-main').css({\n                                        'top': freezenTop + offTop,\n                                        'height': postil_height - (freezenTop + offTop - postil_top)\n                                    });\n                                    $(e).show().find('.formulaInputFocus').css('margin-top', -(freezenTop + offTop - postil_top));\n                                    $(e).show().find('.arrowCanvas').hide();\n                                }\n                            } else {\n                                luckysheetPostil.buildPs(r, c, postil);\n                            }\n                        }\n                    } else {\n                        $(e).show().find('.luckysheet-postil-show-main').css('top', postil_top + offTop);\n                        $(e).show().find('.arrowCanvas').css('top', size[1] + offTop);\n                    }\n                });\n            } else if (_this.freezenverticaldata != null) {\n                let freezenLeft = _this.freezenverticaldata[0];\n                let offLeft = scrollLeft - _this.freezenverticaldata[2];\n                $('#luckysheet-postil-showBoxs .luckysheet-postil-show').each(function (i, e) {\n                    let id = $(e).attr('id');\n                    let r = id.split('luckysheet-postil-show_')[1].split('_')[0];\n                    let c = id.split('luckysheet-postil-show_')[1].split('_')[1];\n                    let postil = Store.flowdata[r][c].ps;\n                    let row = Store.visibledatarow[r], row_pre = r - 1 == -1 ? 0 : Store.visibledatarow[r - 1];\n                    let col = Store.visibledatacolumn[c], col_pre = c - 1 == -1 ? 0 : Store.visibledatacolumn[c - 1];\n                    let margeset = menuButton.mergeborer(Store.flowdata, r, c);\n                    if (!!margeset) {\n                        row = margeset.row[1];\n                        row_pre = margeset.row[0];\n                        col = margeset.column[1];\n                        col_pre = margeset.column[0];\n                    }\n                    let toX = col;\n                    let toY = row_pre;\n                    let postil_left = postil['left'] == null ? toX + 18 : postil['left'];\n                    let postil_top = postil['top'] == null ? toY - 18 : postil['top'];\n                    let postil_width = postil['width'] == null ? luckysheetPostil.defaultWidth : postil['width'];\n                    let postil_height = postil['height'] == null ? luckysheetPostil.defaultHeight : postil['height'];\n                    if (postil_top < 0) {\n                        postil_top = 2;\n                    }\n                    let size = luckysheetPostil.getArrowCanvasSize(postil_left, postil_top, toX, toY);\n                    if (c >= _this.freezenverticaldata[1]) {\n                        if (postil_left + postil_width < freezenLeft) {\n                            $(e).show().find('.luckysheet-postil-show-main').css('left', postil_left + offLeft);\n                            $(e).show().find('.arrowCanvas').css('left', size[0] + offLeft);\n                        } else {\n                            if (postil_left < freezenLeft + offLeft) {\n                                if (postil_left + postil_width <= freezenLeft + offLeft) {\n                                    $(e).hide();\n                                } else {\n                                    $(e).show().find('.luckysheet-postil-show-main').css({\n                                        'left': freezenLeft + offLeft,\n                                        'width': postil_width - (freezenLeft + offLeft - postil_left)\n                                    });\n                                    $(e).show().find('.formulaInputFocus').css('margin-left', -(freezenLeft + offLeft - postil_left));\n                                    $(e).show().find('.arrowCanvas').hide();\n                                }\n                            } else {\n                                luckysheetPostil.buildPs(r, c, postil);\n                            }\n                        }\n                    } else {\n                        $(e).show().find('.luckysheet-postil-show-main').css('left', postil_left + offLeft);\n                        $(e).show().find('.arrowCanvas').css('left', size[0] + offLeft);\n                    }\n                });\n            } else {\n                $('#luckysheet-postil-showBoxs .luckysheet-postil-show').each(function (i, e) {\n                    let id = $(e).attr('id');\n                    let r = id.split('luckysheet-postil-show_')[1].split('_')[0];\n                    let c = id.split('luckysheet-postil-show_')[1].split('_')[1];\n                    let postil = Store.flowdata[r][c].ps;\n                    luckysheetPostil.buildPs(r, c, postil);\n                });\n            }\n        },\n        scrollAdaptOfdpicon: function () {\n            let _this = this;\n            let copy_r = luckysheetDropCell.copyRange['row'][1], copy_c = luckysheetDropCell.copyRange['column'][1];\n            let apply_r = luckysheetDropCell.applyRange['row'][1], apply_c = luckysheetDropCell.applyRange['column'][1];\n            let row_index, col_index;\n            if (apply_r >= copy_r && apply_c >= copy_c) {\n                row_index = apply_r;\n                col_index = apply_c;\n            } else {\n                row_index = copy_r;\n                col_index = copy_c;\n            }\n            if (_this.freezenhorizontaldata != null && _this.freezenverticaldata != null) {\n                let freezen_rowindex = _this.freezenhorizontaldata[1];\n                let offsetRow = luckysheet_searcharray(_this.freezenhorizontaldata[3], $('#luckysheet-cell-main').scrollTop() - _this.freezenhorizontaldata[2]);\n                let freezen_colindex = _this.freezenverticaldata[1];\n                let offsetColumn = luckysheet_searcharray(_this.freezenverticaldata[3], $('#luckysheet-cell-main').scrollLeft() - _this.freezenverticaldata[2]);\n                if (row_index >= freezen_rowindex && col_index >= freezen_colindex) {\n                    if (row_index < freezen_rowindex + offsetRow - 1 || col_index < freezen_colindex + offsetColumn - 1) {\n                        $('#luckysheet-dropCell-icon').hide();\n                    } else {\n                        $('#luckysheet-dropCell-icon').show();\n                    }\n                } else if (row_index >= freezen_rowindex) {\n                    if (row_index < freezen_rowindex + offsetRow - 1) {\n                        $('#luckysheet-dropCell-icon').hide();\n                    } else {\n                        let col = colLocationByIndex(col_index + offsetColumn)[1];\n                        $('#luckysheet-dropCell-icon').show().css('left', col);\n                    }\n                } else if (col_index >= freezen_colindex) {\n                    if (col_index < freezen_colindex + offsetColumn - 1) {\n                        $('#luckysheet-dropCell-icon').hide();\n                    } else {\n                        let row = rowLocationByIndex(row_index + offsetRow)[1];\n                        $('#luckysheet-dropCell-icon').show().css('top', row);\n                    }\n                } else {\n                    let row = rowLocationByIndex(row_index + offsetRow)[1], col = colLocationByIndex(col_index + offsetColumn)[1];\n                    $('#luckysheet-dropCell-icon').show().css({\n                        'left': col,\n                        'top': row\n                    });\n                }\n            } else if (_this.freezenhorizontaldata != null) {\n                let freezen_rowindex = _this.freezenhorizontaldata[1];\n                let offsetRow = luckysheet_searcharray(_this.freezenhorizontaldata[3], $('#luckysheet-cell-main').scrollTop() - _this.freezenhorizontaldata[2]);\n                if (row_index >= freezen_rowindex) {\n                    if (row_index < freezen_rowindex + offsetRow - 1) {\n                        $('#luckysheet-dropCell-icon').hide();\n                    } else {\n                        $('#luckysheet-dropCell-icon').show();\n                    }\n                } else {\n                    let row = rowLocationByIndex(row_index + offsetRow)[1];\n                    $('#luckysheet-dropCell-icon').show().css('top', row);\n                }\n            } else if (_this.freezenverticaldata != null) {\n                let freezen_colindex = _this.freezenverticaldata[1];\n                let offsetColumn = luckysheet_searcharray(_this.freezenverticaldata[3], $('#luckysheet-cell-main').scrollLeft() - _this.freezenverticaldata[2]);\n                if (col_index >= freezen_colindex) {\n                    if (col_index < freezen_colindex + offsetColumn - 1) {\n                        $('#luckysheet-dropCell-icon').hide();\n                    } else {\n                        $('#luckysheet-dropCell-icon').show();\n                    }\n                } else {\n                    let col = colLocationByIndex(col_index + offsetColumn)[1];\n                    $('#luckysheet-dropCell-icon').show().css('left', col);\n                }\n            } else {\n                let row = rowLocationByIndex(row_index)[1], col = colLocationByIndex(col_index)[1];\n                $('#luckysheet-dropCell-icon').show().css({\n                    'left': col,\n                    'top': row\n                });\n            }\n        },\n        scrollAdaptOffilteroptions: function () {\n            let _this = this;\n            if (_this.freezenhorizontaldata != null && _this.freezenverticaldata != null) {\n                let freezen_rowindex = _this.freezenhorizontaldata[1];\n                let freezen_top = _this.freezenhorizontaldata[0] + $('#luckysheet-cell-main').scrollTop();\n                let freezen_colindex = _this.freezenverticaldata[1];\n                let offsetColumn = luckysheet_searcharray(_this.freezenverticaldata[3], $('#luckysheet-cell-main').scrollLeft() - _this.freezenverticaldata[2]);\n                $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').each(function (i, e) {\n                    let row_index = $(e).data('str');\n                    let top = row_index - 1 == -1 ? 0 : Store.visibledatarow[row_index - 1];\n                    let col_index = $(e).data('cindex');\n                    if (row_index >= freezen_rowindex && col_index >= freezen_colindex) {\n                        if (top < freezen_top || col_index < freezen_colindex + offsetColumn) {\n                            $(e).hide();\n                        } else {\n                            $(e).show();\n                        }\n                    } else if (row_index >= freezen_rowindex) {\n                        if (top < freezen_top) {\n                            $(e).hide();\n                        } else {\n                            let left = Store.visibledatacolumn[col_index + offsetColumn] - 20;\n                            $(e).show().css('left', left);\n                        }\n                    } else if (col_index >= freezen_colindex) {\n                        if (col_index < freezen_colindex + offsetColumn) {\n                            $(e).hide();\n                        } else {\n                            $(e).show().css('top', top + $('#luckysheet-cell-main').scrollTop());\n                        }\n                    } else {\n                        let left = Store.visibledatacolumn[col_index + offsetColumn] - 20;\n                        $(e).show().css({\n                            'left': left,\n                            'top': top + $('#luckysheet-cell-main').scrollTop()\n                        });\n                    }\n                });\n            } else if (_this.freezenhorizontaldata != null) {\n                let freezen_rowindex = _this.freezenhorizontaldata[1];\n                let freezen_top = _this.freezenhorizontaldata[0] + $('#luckysheet-cell-main').scrollTop();\n                $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').each(function (i, e) {\n                    let row_index = $(e).data('str');\n                    let top = row_index - 1 == -1 ? 0 : Store.visibledatarow[row_index - 1];\n                    if (row_index >= freezen_rowindex) {\n                        if (top < freezen_top) {\n                            $(e).hide();\n                        } else {\n                            $(e).show();\n                        }\n                    } else {\n                        $(e).show().css('top', top + $('#luckysheet-cell-main').scrollTop());\n                    }\n                });\n            } else if (_this.freezenverticaldata != null) {\n                let freezen_colindex = _this.freezenverticaldata[1];\n                let offsetColumn = luckysheet_searcharray(_this.freezenverticaldata[3], $('#luckysheet-cell-main').scrollLeft() - _this.freezenverticaldata[2]);\n                $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').each(function (i, e) {\n                    let col_index = $(e).data('cindex');\n                    if (col_index >= freezen_colindex) {\n                        if (col_index < freezen_colindex + offsetColumn) {\n                            $(e).hide();\n                        } else {\n                            $(e).show();\n                        }\n                    } else {\n                        let left = Store.visibledatacolumn[col_index + offsetColumn] - 20;\n                        $(e).show().css('left', left);\n                    }\n                });\n            } else {\n                $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex).empty();\n                createFilterOptions(Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].filter_select);\n            }\n        },\n        /**\n     * \n     * @param {string} operate  \"freezenRow\"/ \"freezenColumn\"......\n     * @param {Number | String} order 工作表索引；默认值为当前工作表索引\n     * @param {Object} focus 冻结选区时的focus单元格行列值构成的对象；格式为{ row_focus:0, column_focus:0 }\n     */\n        saveFrozen: function (operate, order, focus = {}) {\n            if (order == null) {\n                order = getSheetIndex(Store.currentSheetIndex);\n            }    // New configuration attribute of sheet: frozen, which stores more semantic configuration for initialization and transmission to the backend. freezenhorizontaldata is still used as local data\n            // New configuration attribute of sheet: frozen, which stores more semantic configuration for initialization and transmission to the backend. freezenhorizontaldata is still used as local data\n            const select_save = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n            const row_focus = select_save['row_focus'] == null ? select_save['row'][0] : select_save['row_focus'];\n            const column_focus = select_save['column_focus'] == null ? select_save['column'][0] : select_save['column_focus'];\n            const range = {\n                row_focus: focus.row_focus || row_focus,\n                column_focus: focus.column_focus || column_focus\n            };\n            const frozen = {\n                'freezenRow': { type: 'row' },\n                'freezenColumn': { type: 'column' },\n                'freezenRC': { type: 'both' },\n                'freezenRowRange': {\n                    type: 'rangeRow',\n                    range: range\n                },\n                'freezenColumnRange': {\n                    type: 'rangeColumn',\n                    range: range\n                },\n                'freezenRCRange': {\n                    type: 'rangeBoth',\n                    range: range\n                },\n                'freezenCancel': { type: 'cancel' }\n            };    // store frozen\n            // store frozen\n            Store.luckysheetfile[order]['frozen'] = frozen[operate];\n        },\n        frozenTofreezen: function () {\n            // get frozen type\n            let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            const frozen = file['frozen'];\n            if (frozen == null) {\n                return;\n            }\n            let freezen = null;    // transform to freezen\n            // transform to freezen\n            if (frozen.type === 'row') {\n                let scrollTop = 0;\n                let row_st = luckysheet_searcharray(Store.visibledatarow, scrollTop);\n                if (row_st == -1) {\n                    row_st = 0;\n                }\n                let top = Store.visibledatarow[row_st] - 2 - scrollTop + Store.columnHeaderHeight;\n                let freezenhorizontaldata = [\n                    Store.visibledatarow[row_st],\n                    row_st + 1,\n                    scrollTop,\n                    luckysheetFreezen.cutVolumn(Store.visibledatarow, row_st + 1),\n                    top\n                ];\n                freezen = {\n                    horizontal: {\n                        freezenhorizontaldata: freezenhorizontaldata,\n                        top: top\n                    }\n                };\n            } else if (frozen.type === 'column') {\n                let scrollLeft = 0;\n                let col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollLeft);\n                if (col_st == -1) {\n                    col_st = 0;\n                }\n                let left = Store.visibledatacolumn[col_st] - 2 - scrollLeft + Store.rowHeaderWidth;\n                let freezenverticaldata = [\n                    Store.visibledatacolumn[col_st],\n                    col_st + 1,\n                    scrollLeft,\n                    luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_st + 1),\n                    left\n                ];\n                freezen = {\n                    vertical: {\n                        freezenverticaldata: freezenverticaldata,\n                        left: left\n                    }\n                };\n            } else if (frozen.type === 'both') {\n                let scrollTop = 0;\n                let row_st = luckysheet_searcharray(Store.visibledatarow, scrollTop);\n                if (row_st == -1) {\n                    row_st = 0;\n                }\n                let top = Store.visibledatarow[row_st] - 2 - scrollTop + Store.columnHeaderHeight;\n                let freezenhorizontaldata = [\n                    Store.visibledatarow[row_st],\n                    row_st + 1,\n                    scrollTop,\n                    luckysheetFreezen.cutVolumn(Store.visibledatarow, row_st + 1),\n                    top\n                ];\n                let scrollLeft = 0;\n                let col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollLeft);\n                if (col_st == -1) {\n                    col_st = 0;\n                }\n                let left = Store.visibledatacolumn[col_st] - 2 - scrollLeft + Store.rowHeaderWidth;\n                let freezenverticaldata = [\n                    Store.visibledatacolumn[col_st],\n                    col_st + 1,\n                    scrollLeft,\n                    luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_st + 1),\n                    left\n                ];\n                freezen = {\n                    horizontal: {\n                        freezenhorizontaldata: freezenhorizontaldata,\n                        top: top\n                    },\n                    vertical: {\n                        freezenverticaldata: freezenverticaldata,\n                        left: left\n                    }\n                };\n            } else if (frozen.type === 'rangeRow') {\n                let scrollTop = 0;\n                let row_st = luckysheet_searcharray(Store.visibledatarow, scrollTop);\n                let row_focus = frozen.range['row_focus'];\n                if (row_focus > row_st) {\n                    row_st = row_focus;\n                }\n                if (row_st == -1) {\n                    row_st = 0;\n                }\n                let top = Store.visibledatarow[row_st] - 2 - scrollTop + Store.columnHeaderHeight;\n                let freezenhorizontaldata = [\n                    Store.visibledatarow[row_st],\n                    row_st + 1,\n                    scrollTop,\n                    luckysheetFreezen.cutVolumn(Store.visibledatarow, row_st + 1),\n                    top\n                ];\n                freezen = {\n                    horizontal: {\n                        freezenhorizontaldata: freezenhorizontaldata,\n                        top: top\n                    }\n                };\n            } else if (frozen.type === 'rangeColumn') {\n                let scrollLeft = 0;\n                let col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollLeft);\n                let column_focus = frozen.range['column_focus'];\n                if (column_focus > col_st) {\n                    col_st = column_focus;\n                }\n                if (col_st == -1) {\n                    col_st = 0;\n                }\n                let left = Store.visibledatacolumn[col_st] - 2 - scrollLeft + Store.rowHeaderWidth;\n                let freezenverticaldata = [\n                    Store.visibledatacolumn[col_st],\n                    col_st + 1,\n                    scrollLeft,\n                    luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_st + 1),\n                    left\n                ];\n                freezen = {\n                    vertical: {\n                        freezenverticaldata: freezenverticaldata,\n                        left: left\n                    }\n                };\n            } else if (frozen.type === 'rangeBoth') {\n                let scrollTop = 0;\n                let row_st = luckysheet_searcharray(Store.visibledatarow, scrollTop);\n                let row_focus = frozen.range['row_focus'];\n                if (row_focus > row_st) {\n                    row_st = row_focus;\n                }\n                if (row_st == -1) {\n                    row_st = 0;\n                }\n                let top = Store.visibledatarow[row_st] - 2 - scrollTop + Store.columnHeaderHeight;\n                let freezenhorizontaldata = [\n                    Store.visibledatarow[row_st],\n                    row_st + 1,\n                    scrollTop,\n                    luckysheetFreezen.cutVolumn(Store.visibledatarow, row_st + 1),\n                    top\n                ];\n                let scrollLeft = 0;\n                let col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollLeft);\n                let column_focus = frozen.range['column_focus'];\n                if (column_focus > col_st) {\n                    col_st = column_focus;\n                }\n                if (col_st == -1) {\n                    col_st = 0;\n                }\n                let left = Store.visibledatacolumn[col_st] - 2 - scrollLeft + Store.rowHeaderWidth;\n                let freezenverticaldata = [\n                    Store.visibledatacolumn[col_st],\n                    col_st + 1,\n                    scrollLeft,\n                    luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_st + 1),\n                    left\n                ];\n                freezen = {\n                    horizontal: {\n                        freezenhorizontaldata: freezenhorizontaldata,\n                        top: top\n                    },\n                    vertical: {\n                        freezenverticaldata: freezenverticaldata,\n                        left: left\n                    }\n                };\n            } else if (frozen.type === 'cancel') {\n                freezen = {\n                    horizontal: null,\n                    vertical: null\n                };\n            }\n            file['freezen'] = freezen;\n        }\n    };\n    return luckysheetFreezen;\n});"]}