{"version":3,"sources":["controllers/sheetBar.js"],"names":["define","sheetmanage","server","m_constant","m_util","m_get","m_validate","formula","cleargridelement","tooltip","m_cursorPos","locale","Store","luckysheetConfigsetting","m_api","sheetselectlistitemHTML","sheetselectlistHTML","keycode","replaceHtml","mouseclickposition","getSheetIndex","isEditMode","selectTextDom","pagerInit","isInitialSheetConfig","luckysheetcurrentSheetitem","jfdbclicklagTimeout","oldSheetFileName","showsheetconfigmenu","_locale","locale_toolbar","toolbar","$","spectrum","showPalette","preferredFormat","clickoutFiresChange","showInitial","showInput","flat","hideAfterPaletteSelect","showSelectionPalette","maxPaletteSize","cancelText","sheetconfig","chooseText","togglePaletteMoreText","toolMore","togglePaletteLessText","toolLess","clearText","noColorSelectedText","palette","change","color","this","toHexString","oldcolor","find","length","css","remove","append","index","currentSheetIndex","luckysheetfile","saveParam","k","clearjfundo","redo","type","jfundo","jfredo","push","click","parent","addClass","config","sheetRightClickConfig","Object","values","every","ele","setTimeout","offset","left","width","top","luckysheetsheetrightclick","$t","$cur","e","clearTimeout","hasClass","attr","rangestart","rangedrag_column_start","rangedrag_row_start","israngeseleciton","setCaretPosition","rangeSetValueTo","get","text","createRangeHightlight","end","prepend","getSheetName","rangetosheet","show","parseInt","z-index","updatecell","luckysheetCellUpdate","removeAttr","removeClass","changeSheet","data","hide","which","closest","initialSheetBar","locale_sheetconfig","on","target","$item","luckysheet_sheet_move_status","luckysheet_sheet_move_data","widthlist","each","i","outerWidth","curindex","x","pageX","curleft","activeobject","cursorobject","$itemclone","clone","after","position","opacity","cursor","transition","keepHighLightBox","luckysheetsheetnameeditor","allowEdit","compositionFlag","limitSheetNameLength","maxLength","defaultSheetNameMaxLength","substring","range","window","getSelection","selectAllChildren","collapseToEnd","alert","sheetNamecannotIsEmptyError","focus","txt","oldtxt","charAt","test","sheetNameSpecCharError","name","tipNameRepeat","info","sheetArrowShowAndHide","kcode","keyCode","ENTER","prevAll","insertBefore","eq","reOrderAllSheet","nextAll","insertAfter","noMoreSheet","confirm","confirmDelete","redoDelete","deleteSheet","copySheet","setSheetHide","noHide","addNewSheet","locationSheet","sheetscrollani","sheetscrollstart","sheetscrollend","$c","scrollLeft","clearInterval","setInterval","initialOpenSheet","html","item","f","icon","style","container","chartEditNoOpt","setSheetShow","bottom","height","pager"],"mappings":";;;;;;;AAAAA,QACI,gBACA,WACA,aACA,gBACA,iBACA,qBACA,oBACA,6BACA,oBACA,sBACA,mBACA,WACA,4BACA,iBACD,SAAUC,EAAaC,EAAQC,EAAYC,EAAQC,EAAOC,EAAYC,EAASC,EAAkBC,EAASC,EAAaC,EAAQC,EAAOC,EAAyBC,GAC9J,aACA,MAAMC,wBAACA,EAAuBC,oBAAEA,EAAmBC,QAAEA,GAAWd,GAC1De,YAACA,EAAWC,mBAAEA,GAAsBf,GACpCgB,cAACA,GAAiBf,GAClBgB,WAACA,GAAcf,GACfgB,cAACA,GAAiBZ,GAClBa,UAACA,GAAaT,EAGpB,IAAIU,GAAuB,EAAOC,EAA6B,KAAMC,EAAsB,KAAMC,EAAmB,GACpH,SAASC,IACL,IAAKJ,EAAsB,CACvBA,GAAuB,EACvB,MAAMK,EAAUlB,IAChB,IAAImB,EAAiBD,EAAQE,QAC7BC,EAAE,iCAAiCC,UAC/BC,aAAa,EACbC,gBAAiB,MACjBC,qBAAqB,EACrBC,aAAa,EACbC,WAAW,EACXC,MAAM,EACNC,wBAAwB,EACxBC,sBAAsB,EACtBC,eAAgB,GAChBC,WAAYd,EAAQe,YAAYD,WAChCE,WAAYhB,EAAQe,YAAYC,WAChCC,sBAAuBhB,EAAeiB,SACtCC,sBAAuBlB,EAAemB,SACtCC,UAAWpB,EAAeoB,UAC1BC,oBAAqBrB,EAAeqB,oBACpCC,UAEQ,eACA,kBACA,qBACA,qBACA,qBACA,uBAGA,iBACA,iBACA,mBACA,mBACA,iBACA,mBACA,oBACA,iBACA,mBACA,qBAGA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,uBAGA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,uBAGA,mBACA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,qBACA,uBAGA,kBACA,iBACA,oBACA,oBACA,oBACA,oBACA,oBACA,oBACA,oBACA,sBAGA,iBACA,iBACA,kBACA,kBACA,kBACA,kBACA,mBACA,iBACA,kBACA,oBAGA,UACA,UACA,UACA,UACA,UA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","file":"../../controllers/sheetBar.js","sourcesContent":["define([\n    './sheetmanage',\n    './server',\n    './constant',\n    '../utils/util',\n    '../methods/get',\n    '../global/validate',\n    '../global/formula',\n    '../global/cleargridelement',\n    '../global/tooltip',\n    '../global/cursorPos',\n    '../locale/locale',\n    '../store',\n    './luckysheetConfigsetting',\n    '../global/api'\n], function (sheetmanage, server, m_constant, m_util, m_get, m_validate, formula, cleargridelement, tooltip, m_cursorPos, locale, Store, luckysheetConfigsetting, m_api) {\n    'use strict';\n    const {sheetselectlistitemHTML, sheetselectlistHTML, keycode} = m_constant;\n    const {replaceHtml, mouseclickposition} = m_util;\n    const {getSheetIndex} = m_get;\n    const {isEditMode} = m_validate;\n    const {selectTextDom} = m_cursorPos;\n    const {pagerInit} = m_api;\n    selectTextDom;\n    //表格底部名称栏区域 相关事件（增、删、改、隐藏显示、颜色等等）\n    let isInitialSheetConfig = false, luckysheetcurrentSheetitem = null, jfdbclicklagTimeout = null, oldSheetFileName = '';\n    function showsheetconfigmenu() {\n        if (!isInitialSheetConfig) {\n            isInitialSheetConfig = true;\n            const _locale = locale();\n            let locale_toolbar = _locale.toolbar;\n            $('#luckysheetsheetconfigcolorur').spectrum({\n                showPalette: true,\n                preferredFormat: 'hex',\n                clickoutFiresChange: false,\n                showInitial: true,\n                showInput: true,\n                flat: true,\n                hideAfterPaletteSelect: false,\n                showSelectionPalette: true,\n                maxPaletteSize: 10,\n                cancelText: _locale.sheetconfig.cancelText,\n                chooseText: _locale.sheetconfig.chooseText,\n                togglePaletteMoreText: locale_toolbar.toolMore,\n                togglePaletteLessText: locale_toolbar.toolLess,\n                clearText: locale_toolbar.clearText,\n                noColorSelectedText: locale_toolbar.noColorSelectedText,\n                palette: [\n                    [\n                        'rgb(0, 0, 0)',\n                        'rgb(67, 67, 67)',\n                        'rgb(102, 102, 102)',\n                        'rgb(204, 204, 204)',\n                        'rgb(217, 217, 217)',\n                        'rgb(255, 255, 255)'\n                    ],\n                    [\n                        'rgb(152, 0, 0)',\n                        'rgb(255, 0, 0)',\n                        'rgb(255, 153, 0)',\n                        'rgb(255, 255, 0)',\n                        'rgb(0, 255, 0)',\n                        'rgb(0, 255, 255)',\n                        'rgb(74, 134, 232)',\n                        'rgb(0, 0, 255)',\n                        'rgb(153, 0, 255)',\n                        'rgb(255, 0, 255)'\n                    ],\n                    [\n                        'rgb(230, 184, 175)',\n                        'rgb(244, 204, 204)',\n                        'rgb(252, 229, 205)',\n                        'rgb(255, 242, 204)',\n                        'rgb(217, 234, 211)',\n                        'rgb(208, 224, 227)',\n                        'rgb(201, 218, 248)',\n                        'rgb(207, 226, 243)',\n                        'rgb(217, 210, 233)',\n                        'rgb(234, 209, 220)'\n                    ],\n                    [\n                        'rgb(221, 126, 107)',\n                        'rgb(234, 153, 153)',\n                        'rgb(249, 203, 156)',\n                        'rgb(255, 229, 153)',\n                        'rgb(182, 215, 168)',\n                        'rgb(162, 196, 201)',\n                        'rgb(164, 194, 244)',\n                        'rgb(159, 197, 232)',\n                        'rgb(180, 167, 214)',\n                        'rgb(213, 166, 189)'\n                    ],\n                    [\n                        'rgb(204, 65, 37)',\n                        'rgb(224, 102, 102)',\n                        'rgb(246, 178, 107)',\n                        'rgb(255, 217, 102)',\n                        'rgb(147, 196, 125)',\n                        'rgb(118, 165, 175)',\n                        'rgb(109, 158, 235)',\n                        'rgb(111, 168, 220)',\n                        'rgb(142, 124, 195)',\n                        'rgb(194, 123, 160)'\n                    ],\n                    [\n                        'rgb(166, 28, 0)',\n                        'rgb(204, 0, 0)',\n                        'rgb(230, 145, 56)',\n                        'rgb(241, 194, 50)',\n                        'rgb(106, 168, 79)',\n                        'rgb(69, 129, 142)',\n                        'rgb(60, 120, 216)',\n                        'rgb(61, 133, 198)',\n                        'rgb(103, 78, 167)',\n                        'rgb(166, 77, 121)'\n                    ],\n                    [\n                        'rgb(91, 15, 0)',\n                        'rgb(102, 0, 0)',\n                        'rgb(120, 63, 4)',\n                        'rgb(127, 96, 0)',\n                        'rgb(39, 78, 19)',\n                        'rgb(12, 52, 61)',\n                        'rgb(28, 69, 135)',\n                        'rgb(7, 55, 99)',\n                        'rgb(32, 18, 77)',\n                        'rgb(76, 17, 48)'\n                    ],\n                    [\n                        '#c1232b',\n                        '#27727b',\n                        '#fcce10',\n                        '#e87c25',\n                        '#b5c334',\n                        '#fe8463',\n                        '#9bca63',\n                        '#fad860',\n                        '#f3a43b',\n                        '#60c0dd',\n                        '#d7504b',\n                        '#c6e579',\n                        '#f4e001',\n                        '#f0805a',\n                        '#26c0c0',\n                        '#c12e34',\n                        '#e6b600',\n                        '#0098d9',\n                        '#2b821d',\n                        '#005eaa',\n                        '#339ca8',\n                        '#cda819',\n                        '#32a487',\n                        '#3fb1e3',\n                        '#6be6c1',\n                        '#626c91',\n                        '#a0a7e6',\n                        '#c4ebad',\n                        '#96dee8'\n                    ]\n                ],\n                change: function (color) {\n                    let $input = $(this);\n                    if (color != null) {\n                        color = color.toHexString();\n                    } else {\n                        color = 'rgb(0, 0, 0)';\n                    }\n                    let oldcolor = null;\n                    if (luckysheetcurrentSheetitem.find('.luckysheet-sheets-item-color').length > 0) {\n                        oldcolor = luckysheetcurrentSheetitem.find('.luckysheet-sheets-item-color').css('background-color');\n                    }\n                    luckysheetcurrentSheetitem.find('.luckysheet-sheets-item-color').remove();\n                    luckysheetcurrentSheetitem.append('<div class=\"luckysheet-sheets-item-color\" style=\" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: ' + color + ';\"></div>');\n                    let index = getSheetIndex(Store.currentSheetIndex);\n                    Store.luckysheetfile[index].color = color;\n                    server.saveParam('all', Store.currentSheetIndex, color, { 'k': 'color' });\n                    if (Store.clearjfundo) {\n                        let redo = {};\n                        redo['type'] = 'sheetColor';\n                        redo['sheetIndex'] = Store.currentSheetIndex;\n                        redo['oldcolor'] = oldcolor;\n                        redo['color'] = color;\n                        Store.jfundo.length = 0;\n                        Store.jfredo.push(redo);\n                    }\n                }\n            });\n            $('#luckysheetsheetconfigcolorreset').click(function () {\n                let oldcolor = null;\n                if (luckysheetcurrentSheetitem.find('.luckysheet-sheets-item-color').length > 0) {\n                    oldcolor = luckysheetcurrentSheetitem.find('.luckysheet-sheets-item-color').css('background-color');\n                }\n                luckysheetcurrentSheetitem.find('.luckysheet-sheets-item-color').remove();\n                let index = getSheetIndex(Store.currentSheetIndex);\n                Store.luckysheetfile[index].color = null;\n                server.saveParam('all', Store.currentSheetIndex, null, { 'k': 'color' });\n                if (Store.clearjfundo) {\n                    let redo = {};\n                    redo['type'] = 'sheetColor';\n                    redo['sheetIndex'] = Store.currentSheetIndex;\n                    redo['oldcolor'] = oldcolor;\n                    redo['color'] = null;\n                    Store.jfundo.length = 0;\n                    Store.jfredo.push(redo);\n                }\n            });\n        }\n        let index = getSheetIndex(Store.currentSheetIndex);\n        if (Store.luckysheetfile[index].color != null && Store.luckysheetfile[index].color.length > 0) {\n            $('#luckysheetsheetconfigcolorur').spectrum('set', Store.luckysheetfile[index].color);\n        }\n        $('#luckysheetsheetconfigcolorur').parent().find('span, div, button, input, a').addClass('luckysheet-mousedown-cancel');    // 如果全部按钮设置了隐藏，则不显示\n        // 如果全部按钮设置了隐藏，则不显示\n        const config = luckysheetConfigsetting.sheetRightClickConfig;    // if(!config.delete && !config.copy && !config.rename && !config.color && !config.hide && !config.move){\n        // if(!config.delete && !config.copy && !config.rename && !config.color && !config.hide && !config.move){\n        if (Object.values(config).every(ele => !ele)) {\n            return;\n        }\n        setTimeout(function () {\n            mouseclickposition($('#luckysheet-rightclick-sheet-menu'), luckysheetcurrentSheetitem.offset().left + luckysheetcurrentSheetitem.width(), luckysheetcurrentSheetitem.offset().top - 18, 'leftbottom');\n        }, 1);\n    }\n    let luckysheetsheetrightclick = function ($t, $cur, e) {\n        clearTimeout(jfdbclicklagTimeout);\n        if ($cur.hasClass('luckysheet-sheets-item-name') && $cur.attr('contenteditable') == 'true') {\n            return;\n        }\n        if (formula.rangestart || formula.rangedrag_column_start || formula.rangedrag_row_start || formula.israngeseleciton()) {\n            setTimeout(function () {\n                formula.setCaretPosition(formula.rangeSetValueTo.get(0), 0, formula.rangeSetValueTo.text().length);\n                formula.createRangeHightlight();\n                $('#luckysheet-input-box-index').find('.luckysheet-input-box-index-sheettxt').remove().end().prepend(\"<span class='luckysheet-input-box-index-sheettxt'>\" + sheetmanage.getSheetName(formula.rangetosheet) + '!</span>').show();\n                $('#luckysheet-input-box-index').css({\n                    'left': $('#luckysheet-input-box').css('left'),\n                    'top': parseInt($('#luckysheet-input-box').css('top')) - 20 + 'px',\n                    'z-index': $('#luckysheet-input-box').css('z-index')\n                });\n            }, 1);\n        } else {\n            //保存正在编辑的单元格内容\n            if (parseInt($('#luckysheet-input-box').css('top')) > 0) {\n                formula.updatecell(Store.luckysheetCellUpdate[0], Store.luckysheetCellUpdate[1]);\n            }\n            $('#luckysheet-input-box').removeAttr('style');\n            $('#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight').remove();\n        }\n        $('#luckysheet-sheet-area div.luckysheet-sheets-item').removeClass('luckysheet-sheets-item-active');\n        $t.addClass('luckysheet-sheets-item-active');\n        cleargridelement(e);\n        sheetmanage.changeSheet($t.data('index'));\n        $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n        if ($cur.hasClass('luckysheet-sheets-item-menu') || $cur.hasClass('fa-sort-desc') || e.which == '3') {\n            luckysheetcurrentSheetitem = $cur.closest('.luckysheet-sheets-item');\n            showsheetconfigmenu();\n        }\n    };\n    function initialSheetBar() {\n        const _locale = locale();\n        const locale_sheetconfig = _locale.sheetconfig;\n        $('#luckysheet-sheet-area').on('mousedown', 'div.luckysheet-sheets-item', function (e) {\n            if (isEditMode()) {\n                // alert(\"非编辑模式下不允许该操作！\");\n                return;\n            }\n            let $t = $(this), $cur = $(e.target), $item = $cur.closest('.luckysheet-sheets-item');\n            if (e.which == '3') {\n                luckysheetsheetrightclick($t, $cur, e);\n                luckysheetcurrentSheetitem = $item;\n                showsheetconfigmenu();\n                return;\n            }\n            if ($item.hasClass('luckysheet-sheets-item-active') && $item.find('.luckysheet-sheets-item-name').attr('contenteditable') == 'false') {\n                jfdbclicklagTimeout = setTimeout(function () {\n                    Store.luckysheet_sheet_move_status = true;\n                    Store.luckysheet_sheet_move_data = {};\n                    Store.luckysheet_sheet_move_data.widthlist = [];\n                    $('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').each(function (i) {\n                        if (i == 0) {\n                            Store.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth()));\n                        } else {\n                            Store.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth()) + Store.luckysheet_sheet_move_data.widthlist[i - 1]);\n                        }\n                    });\n                    Store.luckysheet_sheet_move_data.curindex = $('#luckysheet-sheet-area div.luckysheet-sheets-item').index($item);\n                    let x = e.pageX;\n                    Store.luckysheet_sheet_move_data.curleft = x - $item.offset().left;\n                    Store.luckysheet_sheet_move_data.pageX = x;\n                    Store.luckysheet_sheet_move_data.activeobject = $item;\n                    Store.luckysheet_sheet_move_data.cursorobject = $cur;\n                    let $itemclone = $item.clone().css('visibility', 'hidden').attr('id', 'luckysheet-sheets-item-clone');\n                    $item.after($itemclone);\n                    $item.css({\n                        'position': 'absolute',\n                        'opacity': 0.8,\n                        'cursor': 'move',\n                        'transition': 'initial',\n                        'z-index': 10\n                    });\n                }, 200);\n            }\n        }).on('click', 'div.luckysheet-sheets-item', function (e) {\n            if (isEditMode()) {\n                // alert(\"非编辑模式下不允许该操作！\");\n                return;\n            }\n            let $t = $(this), $cur = $(e.target);\n            luckysheetsheetrightclick($t, $cur, e);\n            server.keepHighLightBox();\n        });\n        let luckysheetsheetnameeditor = function ($t) {\n            if (Store.allowEdit === false) {\n                return;\n            }\n            $t.attr('contenteditable', 'true').addClass('luckysheet-mousedown-cancel').data('oldtxt', $t.text());\n            setTimeout(function () {\n                selectTextDom($t.get(0));\n            }, 1);\n        };\n        $('#luckysheet-sheet-area').on('dblclick', 'span.luckysheet-sheets-item-name', function (e) {\n            luckysheetsheetnameeditor($(this));\n        });\n        let compositionFlag = true;\n        $('#luckysheet-sheet-area').on('compositionstart', 'span.luckysheet-sheets-item-name', () => compositionFlag = false);\n        $('#luckysheet-sheet-area').on('compositionend', 'span.luckysheet-sheets-item-name', () => compositionFlag = true);\n        $('#luckysheet-sheet-area').on('input', 'span.luckysheet-sheets-item-name', function () {\n            if (Store.allowEdit === false) {\n                return;\n            }\n            if (Store.limitSheetNameLength === false) {\n                return;\n            }\n            let maxLength = Store.defaultSheetNameMaxLength;\n            if (maxLength === 0) {\n                return;\n            }\n            setTimeout(() => {\n                if (compositionFlag) {\n                    if ($(this).text().length >= maxLength) {\n                        /* 检查：值是否越界 */\n                        setTimeout(() => {\n                            $(this).text($(this).text().substring(0, maxLength));\n                            let range = window.getSelection();\n                            range.selectAllChildren(this);\n                            range.collapseToEnd();\n                        }, 0);\n                    }\n                }\n            }, 0);\n        });\n        $('#luckysheet-sheet-area').on('blur', 'span.luckysheet-sheets-item-name', function (e) {\n            if (Store.allowEdit === false) {\n                return;\n            }\n            if (0 === $(this).text().length) {\n                alert(locale_sheetconfig.sheetNamecannotIsEmptyError);\n                setTimeout(() => {\n                    $(this).text(oldSheetFileName);\n                    luckysheetsheetnameeditor($(this));\n                    $(this).focus();\n                }, 1);\n                return;\n            }\n            let $t = $(this);\n            let txt = $t.text(), oldtxt = $t.data('oldtxt');\n            if (txt.length > 31 || txt.charAt(0) == \"'\" || txt.charAt(txt.length - 1) == \"'\" || /[：\\:\\\\\\/？\\?\\*\\[\\]]+/.test(txt)) {\n                alert(locale_sheetconfig.sheetNameSpecCharError);\n                setTimeout(() => {\n                    luckysheetsheetnameeditor($(this));\n                    $(this).focus();\n                }, 1);\n                return;\n            }\n            let index = getSheetIndex(Store.currentSheetIndex);\n            for (let i = 0; i < Store.luckysheetfile.length; i++) {\n                if (index != i && Store.luckysheetfile[i].name == txt) {\n                    if (isEditMode()) {\n                        alert(locale_sheetconfig.tipNameRepeat);\n                    } else {\n                        tooltip.info('', locale_sheetconfig.tipNameRepeat);\n                    }\n                    $t.text(oldtxt).attr('contenteditable', 'false');\n                    return;\n                }\n            }\n            sheetmanage.sheetArrowShowAndHide();\n            Store.luckysheetfile[index].name = txt;\n            server.saveParam('all', Store.currentSheetIndex, txt, { 'k': 'name' });\n            $t.attr('contenteditable', 'false').removeClass('luckysheet-mousedown-cancel');\n            if (Store.clearjfundo) {\n                let redo = {};\n                redo['type'] = 'sheetName';\n                redo['sheetIndex'] = Store.currentSheetIndex;\n                redo['oldtxt'] = oldtxt;\n                redo['txt'] = txt;\n                Store.jfundo.length = 0;\n                Store.jfredo.push(redo);\n            }\n        });\n        $('#luckysheet-sheet-area').on('keydown', 'span.luckysheet-sheets-item-name', function (e) {\n            if (Store.allowEdit === false) {\n                return;\n            }\n            let kcode = e.keyCode;\n            let $t = $(this);\n            if (kcode == keycode.ENTER) {\n                let index = getSheetIndex(Store.currentSheetIndex);\n                oldSheetFileName = Store.luckysheetfile[index].name || oldSheetFileName;\n                Store.luckysheetfile[index].name = $t.text();\n                $t.attr('contenteditable', 'false');\n            }\n        });\n        $('#luckysheetsheetconfigrename').click(function () {\n            luckysheetsheetnameeditor(luckysheetcurrentSheetitem.find('span.luckysheet-sheets-item-name'));\n            $('#luckysheet-input-box').removeAttr('style');\n            $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n        });\n        $('#luckysheetsheetconfigshow').click(function () {\n            $('#luckysheet-sheets-m').click();\n            $('#luckysheet-input-box').removeAttr('style');\n            $('#luckysheet-rightclick-sheet-menu').hide();\n        });\n        $('#luckysheetsheetconfigmoveleft').click(function () {\n            if (luckysheetcurrentSheetitem.prevAll(':visible').length > 0) {\n                luckysheetcurrentSheetitem.insertBefore(luckysheetcurrentSheetitem.prevAll(':visible').eq(0));\n                sheetmanage.reOrderAllSheet();\n            }\n            $('#luckysheet-input-box').removeAttr('style');\n            $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n        });\n        $('#luckysheetsheetconfigmoveright').click(function () {\n            if (luckysheetcurrentSheetitem.nextAll(':visible').length > 0) {\n                luckysheetcurrentSheetitem.insertAfter(luckysheetcurrentSheetitem.nextAll(':visible').eq(0));\n                sheetmanage.reOrderAllSheet();\n            }\n            $('#luckysheet-input-box').removeAttr('style');\n            $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n        });\n        $('#luckysheetsheetconfigdelete').click(function (e) {\n            $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n            if ($('#luckysheet-sheet-container-c .luckysheet-sheets-item:visible').length <= 1) {\n                if (isEditMode()) {\n                    alert(locale_sheetconfig.noMoreSheet);\n                } else {\n                    tooltip.info(locale_sheetconfig.noMoreSheet, '');\n                }\n                return;\n            }\n            let index = getSheetIndex(Store.currentSheetIndex);\n            tooltip.confirm(locale_sheetconfig.confirmDelete + '\\u3010' + Store.luckysheetfile[index].name + '\\u3011\\uFF1F', \"<span style='color:#9e9e9e;font-size:12px;'>\" + locale_sheetconfig.redoDelete + '</span>', function () {\n                sheetmanage.deleteSheet(luckysheetcurrentSheetitem.data('index'));\n            }, null);\n            $('#luckysheet-input-box').removeAttr('style');\n        });\n        $('#luckysheetsheetconfigcopy').click(function (e) {\n            sheetmanage.copySheet(luckysheetcurrentSheetitem.data('index'), e);\n            $('#luckysheet-input-box').removeAttr('style');\n            $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n        });\n        $('#luckysheetsheetconfighide').click(function () {\n            if ($('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').length == 1) {\n                if (isEditMode()) {\n                    alert(locale_sheetconfig.noHide);\n                } else {\n                    tooltip.info('', locale_sheetconfig.noHide);\n                }\n                return;\n            }\n            sheetmanage.setSheetHide(luckysheetcurrentSheetitem.data('index'));\n            $('#luckysheet-input-box').removeAttr('style');\n            $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n        });\n        $('#luckysheet-sheets-add').click(function (e) {\n            //保存正在编辑的单元格内容\n            if (parseInt($('#luckysheet-input-box').css('top')) > 0) {\n                formula.updatecell(Store.luckysheetCellUpdate[0], Store.luckysheetCellUpdate[1]);\n            }\n            sheetmanage.addNewSheet(e);\n            sheetmanage.locationSheet();\n            $('#luckysheet-input-box').removeAttr('style');\n        });\n        let sheetscrollani = null, sheetscrollstart = 0, sheetscrollend = 0, sheetscrollstep = 150;\n        $('#luckysheet-sheets-leftscroll').click(function () {\n            let $c = $('#luckysheet-sheet-container-c');\n            sheetscrollstart = $c.scrollLeft();\n            sheetscrollend = $c.scrollLeft() - sheetscrollstep;\n            if (sheetscrollend <= 0) {\n                $('#luckysheet-sheet-container .docs-sheet-fade-left').hide();\n            }\n            $('#luckysheet-sheet-container .docs-sheet-fade-right').show();\n            clearInterval(sheetscrollani);\n            sheetscrollani = setInterval(function () {\n                sheetscrollstart -= 4;\n                $c.scrollLeft(sheetscrollstart);\n                if (sheetscrollstart <= sheetscrollend) {\n                    clearInterval(sheetscrollani);\n                }\n            }, 1);\n        });\n        $('#luckysheet-sheets-rightscroll').click(function () {\n            let $c = $('#luckysheet-sheet-container-c');\n            sheetscrollstart = $c.scrollLeft();\n            sheetscrollend = $c.scrollLeft() + sheetscrollstep;\n            if (sheetscrollstart > 0) {\n                $('#luckysheet-sheet-container .docs-sheet-fade-right').hide();\n            }\n            $('#luckysheet-sheet-container .docs-sheet-fade-left').show();\n            clearInterval(sheetscrollani);\n            sheetscrollani = setInterval(function () {\n                sheetscrollstart += 4;\n                $c.scrollLeft(sheetscrollstart);\n                if (sheetscrollstart >= sheetscrollend) {\n                    clearInterval(sheetscrollani);\n                }\n            }, 1);\n        });\n        let initialOpenSheet = true;\n        $('#luckysheet-sheets-m').click(function (e) {\n            //保存正在编辑的单元格内容\n            if (parseInt($('#luckysheet-input-box').css('top')) > 0) {\n                formula.updatecell(Store.luckysheetCellUpdate[0], Store.luckysheetCellUpdate[1]);\n            }\n            $('#luckysheet-sheet-list').html('');\n            let item = '';\n            for (let i = 0; i < Store.luckysheetfile.length; i++) {\n                let f = Store.luckysheetfile[i], icon = '', style = '';\n                if (f['status'] == 1) {\n                    icon = '<i class=\"fa fa-check\" aria-hidden=\"true\"></i>';\n                }\n                if (f['hide'] == 1) {\n                    icon = '<i class=\"fa fa-low-vision\" aria-hidden=\"true\"></i>';\n                    style += 'color:#BBBBBB;';\n                }\n                if (f['color'] != null && f['color'].length > 0) {\n                    style += 'border-right:4px solid ' + f['color'] + ';';\n                }\n                item += replaceHtml(sheetselectlistitemHTML, {\n                    'index': f['index'],\n                    'name': f['name'],\n                    'icon': icon,\n                    'style': style\n                });\n            }\n            if (initialOpenSheet) {\n                $('#' + Store.container).append(replaceHtml(sheetselectlistHTML, { 'item': item }));\n                $('#luckysheet-sheet-list').on('click', '.luckysheet-cols-menuitem', function (e) {\n                    if (isEditMode()) {\n                        // tooltip.info(\"提示\", \"图表编辑模式下不允许该操作！\");\n                        alert(locale_sheetconfig.chartEditNoOpt);\n                        return;\n                    }\n                    let $item = $(this), index = $item.data('index');\n                    if ($item.data('index') != Store.currentSheetIndex) {\n                        sheetmanage.setSheetShow(index);\n                        sheetmanage.locationSheet();\n                    }\n                    server.keepHighLightBox();\n                });\n                initialOpenSheet = false;\n            } else {\n                $('#luckysheet-sheet-list').html(item);\n            }\n            let $t = $('#luckysheet-sheet-list');\n            let left = $(this).offset().left - $('#' + Store.container).offset().left;\n            let bottom = $(this).height() + $('#luckysheet-sta-content').height() + 12;\n            $t.css({\n                left: left + 'px',\n                bottom: bottom + 'px'\n            }).show();\n            $('#luckysheet-input-box').removeAttr('style');\n        });    // 初始化分页器\n        // 初始化分页器\n        if (luckysheetConfigsetting.pager) {\n            pagerInit(luckysheetConfigsetting.pager);\n        }\n    }\n    return { initialSheetBar: initialSheetBar };\n});"]}