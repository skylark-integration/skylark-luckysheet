{"version":3,"sources":["controllers/controlHistory.js"],"names":["define","sheetmanage","pivotTable","conditionformat","luckysheetPostil","imageCtrl","dataVerificationCtrl","hyperlinkCtrl","m_zoom","m_filter","formula","json","cleargridelement","m_get","Store","m_select","luckysheetConfigsetting","zoomRefreshView","zoomNumberDomBind","createFilter","createFilterOptions","labelFilterOptionState","getSheetIndex","selectHightlightShow","formulaHistoryHanddler","ctr","type","data","curdata","s","range","length","st_r","row","ed_r","st_c","column","ed_c","r","c","f","delFunctionGroup","sheetIndex","insertUpdateFunctionGroup","redo","e","jfredo","pop","jfundo","push","clearjfundo","hasSheet","currentSheetIndex","changeSheet","allParam","cfg","config","RowlChange","cdformat","dataVerification","dynamicArray","refreshGrid","source","curData","curConfig","curCdformat","curDataVerification","t","target","refreshGrid_pastcut","refreshRange","luckysheetfile","ctrlType","saveParam","k","images","$","extend","allImagesShow","refreshGrid_rhcw","flowdata","refreshGridAll","ctrlValue","ctrlValue1","restore","direction","index","refreshGrid_adRC","calc","filterObj","cf","af","freezen","hyperlink","refreshGrid_deleteCell","ctrl","execFunctionGroup","filter_save","each","i","$top","this","item","optiongroups","optionstate","rowhidden","caljs","cindex","filter","filter_select","hide","eq","hasKey","rowhidenPre","remove","allowUpdate","getCellData","initialPivotManage","refreshPivotTable","deleteSheet","removeAttr","copyindex","isDupName","name","createSheetbydata","oldtxt","find","html","color","oldcolor","luckysheetcurrentSheetitem","append","ref","currentDataVerification","historyDataVerification","refOfCheckbox","currentHyperlink","historyHyperlink","historyRules","refresh","rc","split","ps","buildPs","zoomRatio","luckysheet_select_save","refreshMenuButtonFocus","newCtr","createHookFunction","undo","curDynamicArray","curconfig","curImages","currange","rrefreshGridAll","curCalc","curFilterObj","curCf","curAf","curFreezen","curHyperlink","val","text","filterchage","pivotTablecur","sheetconfig","copySheet","order","txt","currentRules","setTimeout","luckysheetrefreshgrid","curZoomRatio"],"mappings":"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","file":"../../controllers/controlHistory.js","sourcesContent":["define([\n    './sheetmanage',\n    './pivotTable',\n    './conditionformat',\n    './postil',\n    '../widgets/imageCtrl',\n    '../widgets/dataVerificationCtrl',\n    '../widgets/hyperlinkCtrl',\n    './zoom',\n    './filter',\n    './formula',\n    '../methods/json',\n    '../widgets/cleargridelement',\n    '../methods/get',\n    '../store',\n    '../widgets/select',\n    '../methods/luckysheetConfigsetting'\n], function (sheetmanage, pivotTable, conditionformat, luckysheetPostil, imageCtrl, dataVerificationCtrl, hyperlinkCtrl, m_zoom, m_filter, formula, json, cleargridelement, m_get, Store, m_select, luckysheetConfigsetting) {\n    'use strict';\n    const {zoomRefreshView, zoomNumberDomBind} = m_zoom;\n    const {createFilter, createFilterOptions, labelFilterOptionState} = m_filter;\n    const {getSheetIndex} = m_get;\n    const {selectHightlightShow} = m_select;\n    ///const {refreshMenuButtonFocus} = m_api; //TODO\n    function formulaHistoryHanddler(ctr, type = 'redo') {\n        if (ctr == null) {\n            return;\n        }\n        let data = ctr.data;\n        if (type == 'undo') {\n            data = ctr.curdata;\n        }\n        for (let s = 0; s < ctr.range.length; s++) {\n            let st_r = ctr.range[s].row[0];\n            let ed_r = ctr.range[s].row[1];\n            let st_c = ctr.range[s].column[0];\n            let ed_c = ctr.range[s].column[1];\n            for (let r = st_r; r < ed_r + 1; r++) {\n                for (let c = st_c; c < ed_c + 1; c++) {\n                    if (r > data.length - 1) {\n                        break;\n                    }    // formula.execFunctionExist.push({ \"r\": r, \"c\": c, \"i\": ctr.sheetIndex });\n                    // formula.execFunctionExist.push({ \"r\": r, \"c\": c, \"i\": ctr.sheetIndex });\n                    if (data[r][c] == null || data[r][c].f == null || data[r][c].f == '') {\n                        formula.delFunctionGroup(r, c, ctr.sheetIndex);\n                    } else if (data[r][c] != null && data[r][c].f != null && data[r][c].f.length > 0) {\n                        formula.insertUpdateFunctionGroup(r, c, ctr.sheetIndex);\n                    }\n                }\n            }\n        }\n    }\n    const controlHistory = {\n        redo: function (e) {\n            if (Store.jfredo.length == 0) {\n                return;\n            }\n            let ctr = Store.jfredo.pop();\n            Store.jfundo.push(ctr);\n            Store.clearjfundo = false;\n            if (Store.hasSheet(ctr.sheetIndex) && Store.currentSheetIndex != ctr.sheetIndex) {\n                Store.changeSheet(ctr.sheetIndex);\n            }    // formula.execFunctionExist = [];\n            // formula.execFunctionExist = [];\n            if (ctr.type == 'datachange') {\n                //如果有单元格为null,则对应公式应该删除\n                formulaHistoryHanddler(ctr);\n                let allParam = {\n                    'cfg': ctr.config,\n                    'RowlChange': ctr.RowlChange,\n                    'cdformat': ctr.cdformat,\n                    'dataVerification': ctr.dataVerification,\n                    'dynamicArray': ctr.dynamicArray\n                };\n                ///jfrefreshgrid(ctr.data, ctr.range, allParam);    // formula.execFunctionGroup(null, null, null, null, ctr.data);//取之前的数据\n                Store.refreshGrid(ctr.data,ctr.range,allParam);\n            } else // formula.execFunctionGroup(null, null, null, null, ctr.data);//取之前的数据\n            if (ctr.type == 'pasteCut') {\n                let s = {\n                    'sheetIndex': ctr.source['sheetIndex'],\n                    'data': ctr.source['curData'],\n                    'curData': ctr.source['data'],\n                    'config': ctr.source['curConfig'],\n                    'curConfig': ctr.source['config'],\n                    'cdformat': ctr.source['curCdformat'],\n                    'curCdformat': ctr.source['cdformat'],\n                    'dataVerification': ctr.source['curDataVerification'],\n                    'curDataVerification': ctr.source['dataVerification'],\n                    'range': ctr.source['range']\n                };\n                let t = {\n                    'sheetIndex': ctr.target['sheetIndex'],\n                    'data': ctr.target['curData'],\n                    'curData': ctr.target['data'],\n                    'config': ctr.target['curConfig'],\n                    'curConfig': ctr.target['config'],\n                    'cdformat': ctr.target['curCdformat'],\n                    'curCdformat': ctr.target['cdformat'],\n                    'dataVerification': ctr.target['curDataVerification'],\n                    'curDataVerification': ctr.target['dataVerification'],\n                    'range': ctr.target['range']\n                };\n                ///jfrefreshgrid_pastcut(s, t, ctr.RowlChange);\n                Store.refreshGrid_pastcut(s, t, ctr.RowlChange);\n            } else if (ctr.type == 'rangechange') {\n                //如果有单元格为null,则对应公式应该删除\n                formulaHistoryHanddler(ctr);\n                ///jfrefreshrange(ctr.data, ctr.range, ctr.cdformat); \n                Store.refreshRange(ctr.data, ctr.range, ctr.cdformat);\n            } else // formula.execFunctionGroup(null, null, null, null, ctr.data);//取之前的数据\n            if (ctr.type == 'resize') {\n                Store.config = ctr.config;\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].config = Store.config;\n                if (ctr.ctrlType == 'resizeR') {\n                    Store.saveParam('cg', ctr.sheetIndex, ctr.config['rowlen'], { 'k': 'rowlen' });\n                } else if (ctr.ctrlType == 'resizeC') {\n                    Store.saveParam('cg', ctr.sheetIndex, ctr.config['columnlen'], { 'k': 'columnlen' });\n                }\n                let images = $.extend(true, {}, ctr.images);\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].images = images;\n                Store.saveParam('all', ctr.sheetIndex, images, { 'k': 'images' });\n                imageCtrl.images = images;\n                imageCtrl.allImagesShow();\n                ///jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                Store.refreshGrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            } else if (ctr.type == 'cellRowChange') {\n               /// jfrefreshgridall(ctr.data[0].length, ctr.data.length, ctr.data, ctr.config, ctr.range, ctr.ctrlType, ctr.ctrlValue, ctr.cdformat);\n               Store.refreshGridAll(ctr.data[0].length, ctr.data.length, ctr.data, ctr.config, ctr.range, ctr.ctrlType, ctr.ctrlValue, ctr.cdformat);\n            } else if (ctr.type == 'extend') {\n                ///jfrefreshgridall(ctr.data[0].length, ctr.data.length, ctr.data, ctr.config, ctr.range, 'dele', ctr.ctrlValue);\n                Store.refreshGridAll(ctr.data[0].length, ctr.data.length, ctr.data, ctr.config, ctr.range, 'dele', ctr.ctrlValue);\n            } else if (ctr.type == 'dele') {\n                let ctrlValue1 = $.extend(true, {}, ctr.ctrlValue);\n                ctrlValue1.restore = true;\n                ///jfrefreshgridall(ctr.data[0].length, ctr.data.length, ctr.data, ctr.config, ctr.range, 'extend', ctrlValue1);\n                Store.refreshGridAll(ctr.data[0].length, ctr.data.length, ctr.data, ctr.config, ctr.range, 'extend', ctrlValue1);\n            } else if (ctr.type == 'addRC') {\n                //增加行列撤销操作\n                let ctrlValue = $.extend(true, {}, ctr.ctrlValue);\n                if (ctrlValue.direction == 'rightbottom') {\n                    ctrlValue.index = ctrlValue.index + 1;\n                }\n                ///jfrefreshgrid_adRC(ctr.data, ctr.config, 'delRC', ctrlValue, ctr.calc, ctr.filterObj, ctr.cf, ctr.af, ctr.freezen, ctr.dataVerification, ctr.hyperlink);\n                Store.refreshGrid_adRC(ctr.data, ctr.config, 'delRC', ctrlValue, ctr.calc, ctr.filterObj, ctr.cf, ctr.af, ctr.freezen, ctr.dataVerification, ctr.hyperlink);\n            } else if (ctr.type == 'delRC') {\n                //删除行列撤销操作\n                let ctrlValue = $.extend(true, {}, ctr.ctrlValue);\n                ctrlValue.restore = true;\n                ctrlValue.direction = 'lefttop';\n                ///jfrefreshgrid_adRC(ctr.data, ctr.config, 'addRC', ctrlValue, ctr.calc, ctr.filterObj, ctr.cf, ctr.af, ctr.freezen, ctr.dataVerification, ctr.hyperlink);\n                Store.refreshGrid_adRC(ctr.data, ctr.config, 'addRC', ctrlValue, ctr.calc, ctr.filterObj, ctr.cf, ctr.af, ctr.freezen, ctr.dataVerification, ctr.hyperlink);\n            } else if (ctr.type == 'deleteCell') {\n                //删除单元格撤销操作\n                ///jfrefreshgrid_deleteCell(ctr.data, ctr.config, ctr.ctrl, ctr.calc, ctr.filterObj, ctr.cf, ctr.dataVerification, ctr.hyperlink);\n                Store.refreshGrid_deleteCell(ctr.data, ctr.config, ctr.ctrl, ctr.calc, ctr.filterObj, ctr.cf, ctr.dataVerification, ctr.hyperlink);\n            } else if (ctr.type == 'showHidRows') {\n                // 隐藏、显示行 撤销操作\n                //config\n                Store.config = ctr.config;\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].config = ctr.config;\n                Store.saveParam('cg', ctr.sheetIndex, ctr.config['rowhidden'], { 'k': 'rowhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                ///jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                Store.refreshGrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            } else if (ctr.type == 'showHidCols') {\n                // 隐藏、显示列 撤销操作\n                //config\n                Store.config = ctr.config;\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].config = ctr.config;\n                Store.saveParam('cg', ctr.sheetIndex, ctr.config['colhidden'], { 'k': 'colhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                ///jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                Store.refreshGrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            } else if (ctr.type == 'datachangeAll') {\n                formula.execFunctionGroup();\n                ///jfrefreshgridall(ctr.data[0].length, ctr.data.length, ctr.data, null, ctr.range, 'datachangeAll', ctr.ctrlValue);\n                Store.refreshGridAll(ctr.data[0].length, ctr.data.length, ctr.data, null, ctr.range, 'datachangeAll', ctr.ctrlValue);\n            } else if (ctr.type == 'datachangeAll_filter_clear') {\n                createFilterOptions(ctr.filter_save);\n                $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').each(function (i) {\n                    let $top = $(this);\n                    let item = ctr.optiongroups[i];\n                    labelFilterOptionState($top, item.optionstate, item.rowhidden, item.caljs, false, item.st_r, item.ed_r, item.cindex, item.st_c, item.ed_c);\n                });\n                Store.saveParam('fsr', Store.currentSheetIndex, {\n                    'filter': ctr.optiongroups,\n                    'filter_select': ctr.filter_save\n                });    //config\n                //config\n                Store.config = ctr.config;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                if (Store.config['rowhidden'] == null) {\n                    Store.config['rowhidden'] = {};\n                }\n                Store.saveParam('cg', Store.currentSheetIndex, Store.config['rowhidden'], { 'k': 'rowhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                ///jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                Store.refreshGrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                $('#luckysheet-filter-menu, #luckysheet-filter-submenu').hide();\n            } else if (ctr.type == 'datachangeAll_filter') {\n                let $top = $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').eq(ctr['optionsindex']);\n                let st_r = $top.data('str'), ed_r = $top.data('edr'), cindex = $top.data('cindex'), st_c = $top.data('stc'), ed_c = $top.data('edc');\n                labelFilterOptionState($top, json.hasKey(ctr.rowhidenPre), ctr.rowhidenPre, ctr.caljs, true, st_r, ed_r, cindex, st_c, ed_c);    //config\n                //config\n                Store.config = ctr.config;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                if (Store.config['rowhidden'] == null) {\n                    Store.config['rowhidden'] = {};\n                }\n                Store.saveParam('cg', Store.currentSheetIndex, Store.config['rowhidden'], { 'k': 'rowhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                ///jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                Store.refreshGrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                $('#luckysheet-filter-menu, #luckysheet-filter-submenu').hide();\n            } else if (ctr.type == 'filtershow') {\n                $('#luckysheet-filter-selected-sheet' + ctr.sheetIndex + ', #luckysheet-filter-options-sheet' + ctr.sheetIndex).remove();\n                if (Store.allowUpdate) {\n                    Store.saveParam('all', ctr.sheetIndex, null, { 'k': 'filter_select' });\n                }\n            } else if (ctr.type == 'pivotTable_change') {\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].pivotTable = ctr.pivotTable;\n                pivotTable.getCellData(ctr.sheetIndex);\n                pivotTable.initialPivotManage(true);\n                pivotTable.refreshPivotTable();\n            } else if (ctr.type == 'addSheet') {\n                sheetmanage.deleteSheet(ctr.index);\n                Store.changeSheet(ctr.currentSheetIndex);\n                $('#luckysheet-input-box').removeAttr('style');\n                $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n            } else if (ctr.type == 'copySheet') {\n                sheetmanage.deleteSheet(ctr.index);\n                Store.changeSheet(ctr.copyindex);\n            } else if (ctr.type == 'deleteSheet') {\n                let isDupName = false;\n                for (let i = 0; i < Store.luckysheetfile.length; i++) {\n                    if (Store.luckysheetfile[i].name == ctr.name) {\n                        isDupName = true;\n                    }\n                }\n                if (!isDupName) {\n                    sheetmanage.createSheetbydata(ctr, 'isrenew');\n                    $('#luckysheet-input-box').removeAttr('style');\n                    $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n                }\n            } else if (ctr.type == 'sheetName') {\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].name = ctr.oldtxt;\n                $('#luckysheet-sheets-item' + ctr.sheetIndex).find('.luckysheet-sheets-item-name').html(ctr.oldtxt);\n                Store.saveParam('all', ctr.sheetIndex, ctr.oldtxt, { 'k': 'name' });\n            } else if (ctr.type == 'sheetColor') {\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].color = ctr.oldcolor;\n                let luckysheetcurrentSheetitem = $('#luckysheet-sheets-item' + ctr.sheetIndex);\n                luckysheetcurrentSheetitem.find('.luckysheet-sheets-item-color').remove();\n                if (ctr.oldcolor != null) {\n                    luckysheetcurrentSheetitem.append('<div class=\"luckysheet-sheets-item-color\" style=\" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: ' + ctr.oldcolor + ';\"></div>');\n                }\n                Store.saveParam('all', ctr.sheetIndex, ctr.oldcolor, { 'k': 'color' });\n            } else if (ctr.type == 'mergeChange') {\n                let allParam = { 'cfg': ctr.config };\n                ///jfrefreshgrid(ctr.data, ctr.range, allParam);\n                Store.refreshGrid(ctr.data, ctr.range, allParam);\n            } else if (ctr.type == 'updateDataVerification') {\n                dataVerificationCtrl.ref(ctr.currentDataVerification, ctr.historyDataVerification, ctr.sheetIndex);\n            } else if (ctr.type == 'updateDataVerificationOfCheckbox') {\n                dataVerificationCtrl.refOfCheckbox(ctr.currentDataVerification, ctr.historyDataVerification, ctr.sheetIndex, ctr.data, ctr.range);\n            } else if (ctr.type == 'updateHyperlink') {\n                hyperlinkCtrl.ref(ctr.currentHyperlink, ctr.historyHyperlink, ctr.sheetIndex, ctr.data, ctr.range);\n            } else if (ctr.type == 'updateCF') {\n                let historyRules = ctr['data']['historyRules'];\n                for (let i = 0; i < historyRules.length; i++) {\n                    //条件规则\n                    let sheetIndex = historyRules[i]['sheetIndex'];\n                    Store.luckysheetfile[getSheetIndex(sheetIndex)]['luckysheet_conditionformat_save'] = historyRules[i]['luckysheet_conditionformat_save'];\n                    if (Store.allowUpdate) {\n                        Store.saveParam('all', sheetIndex, historyRules[i]['luckysheet_conditionformat_save'], { 'k': 'luckysheet_conditionformat_save' });\n                    }\n                }    //刷新一次表格\n                //刷新一次表格\n                conditionformat.ref();\n            } else if (ctr.type == 'updateAF') {\n                let historyRules = ctr['data']['historyRules'];\n                let index = getSheetIndex(ctr['sheetIndex']);\n                Store.luckysheetfile[index]['luckysheet_alternateformat_save'] = $.extend(true, [], historyRules);\n                ///setTimeout(function () {\n                ///    luckysheetrefreshgrid();\n                ///}, 1);\n                Store.refresh();\n            } else if (ctr.type == 'borderChange') {\n                if (ctr.config['borderInfo'] == null) {\n                    Store.saveParam('cg', ctr.sheetIndex, [], { 'k': 'borderInfo' });\n                } else {\n                    Store.saveParam('cg', ctr.sheetIndex, ctr.config['borderInfo'], { 'k': 'borderInfo' });\n                }\n                Store.config = ctr.config;\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].config = Store.config;\n                ///setTimeout(function () {\n                ///    luckysheetrefreshgrid();\n                ///}, 1);\n                Store.refresh();\n            } else if (ctr.type == 'postil') {\n                luckysheetPostil.ref(ctr.data, ctr.rc);\n                for (let i = 0; i < ctr.rc.length; i++) {\n                    let r = ctr.rc[i].split('_')[0];\n                    let c = ctr.rc[i].split('_')[1];\n                    if (ctr.data[r][c] != null && ctr.data[r][c].ps != null) {\n                        luckysheetPostil.buildPs(r, c, ctr.data[r][c].ps);\n                    } else {\n                        luckysheetPostil.buildPs(r, c, null);\n                    }\n                }\n            } else if (ctr.type == 'imageCtrl') {\n                imageCtrl.images = $.extend(true, {}, ctr.images);\n                imageCtrl.allImagesShow();\n                imageCtrl.ref();\n            } else if (ctr.type == 'zoomChange') {\n                Store.zoomRatio = ctr.zoomRatio;\n                Store.saveParam('all', ctr.currentSheetIndex, ctr.zoomRatio, { 'k': 'zoomRatio' });\n                zoomNumberDomBind();\n                zoomRefreshView();\n            }\n            cleargridelement(e);\n            if (ctr.range) {\n                Store.luckysheet_select_save = ctr.range;\n                selectHightlightShow();\n            }\n            Store.clearjfundo = true;    /* 刷新当前状态栏 */\n            /* 刷新当前状态栏 */\n            refreshMenuButtonFocus();    // 撤销的时候curdata 跟 data 数据要调换一下\n            // 撤销的时候curdata 跟 data 数据要调换一下\n            let newCtr = {\n                ...ctr,\n                ...{\n                    data: ctr.curdata,\n                    curdata: ctr.data\n                }\n            };    // 钩子函数\n            // 钩子函数\n            luckysheetConfigsetting.createHookFunction('updated', newCtr);\n        },\n        undo: function () {\n            if (Store.jfundo.length == 0) {\n                return;\n            }\n            let ctr = Store.jfundo.pop();\n            Store.jfredo.push(ctr);\n            Store.clearjfundo = false;\n            if (Store.hasSheet(ctr.sheetIndex) && Store.currentSheetIndex != ctr.sheetIndex) {\n                Store.changeSheet(ctr.sheetIndex);\n            }\n            if (ctr.type == 'datachange') {\n                formula.execFunctionGroup();\n                let allParam = {\n                    'cfg': ctr.curConfig,\n                    'RowlChange': ctr.RowlChange,\n                    'cdformat': ctr.curCdformat,\n                    'dataVerification': ctr.curDataVerification,\n                    'dynamicArray': ctr.curDynamicArray\n                };\n                formulaHistoryHanddler(ctr, 'undo');\n                ///jfrefreshgrid(ctr.curdata, ctr.range, allParam);\n                Store.refreshGrid(ctr.curdata, ctr.range, allParam);\n            } else if (ctr.type == 'pasteCut') {\n                ///jfrefreshgrid_pastcut(ctr.source, ctr.target, ctr.RowlChange);\n                ///jfrefreshgrid_pastcut(ctr.source, ctr.target, ctr.RowlChange);\n                Store.refreshGrid_pastcut(ctr.source, ctr.target, ctr.RowlChange);\n            } else if (ctr.type == 'rangechange') {\n                // formula.execFunctionGroup();\n                formulaHistoryHanddler(ctr, 'undo');\n                ///jfrefreshrange(ctr.curdata, ctr.range, ctr.curCdformat);\n                Store.refreshRange(ctr.curdata, ctr.range, ctr.curCdformat);\n            } else if (ctr.type == 'resize') {\n                Store.config = ctr.curconfig;\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].config = Store.config;\n                if (ctr.ctrlType == 'resizeR') {\n                    Store.saveParam('cg', ctr.sheetIndex, ctr.curconfig['rowlen'], { 'k': 'rowlen' });\n                } else if (ctr.ctrlType == 'resizeC') {\n                    Store.saveParam('cg', ctr.sheetIndex, ctr.curconfig['columnlen'], { 'k': 'columnlen' });\n                }\n                let images = $.extend(true, {}, ctr.curImages);\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].images = images;\n                Store.saveParam('all', ctr.sheetIndex, images, { 'k': 'images' });\n                imageCtrl.images = images;\n                imageCtrl.allImagesShow();\n                ///jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                Store.refreshGrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            } else if (ctr.type == 'cellRowChange') {\n                ///jfrefreshgridall(ctr.curdata[0].length, ctr.curdata.length, ctr.curdata, ctr.curconfig, ctr.currange, ctr.ctrlType, ctr.ctrlValue, ctr.curCdformat);\n                Store.refreshGridAll(ctr.curdata[0].length, ctr.curdata.length, ctr.curdata, ctr.curconfig, ctr.currange, ctr.ctrlType, ctr.ctrlValue, ctr.curCdformat);\n            } else if (ctr.type == 'extend') {\n                ///jfrefreshgridall(ctr.curdata[0].length, ctr.curdata.length, ctr.curdata, ctr.curconfig, ctr.currange, ctr.ctrlType, ctr.ctrlValue);\n                Store.rrefreshGridAll(ctr.curdata[0].length, ctr.curdata.length, ctr.curdata, ctr.curconfig, ctr.currange, ctr.ctrlType, ctr.ctrlValue);\n            } else if (ctr.type == 'dele') {\n                let ctrlValue1 = $.extend(true, {}, ctr.ctrlValue);\n                ctrlValue1.restore = true;\n                ///jfrefreshgridall(ctr.curdata[0].length, ctr.curdata.length, ctr.curdata, ctr.curconfig, ctr.currange, ctr.ctrlType, ctr.ctrlValue);\n                Store.rrefreshGridAll(ctr.curdata[0].length, ctr.curdata.length, ctr.curdata, ctr.curconfig, ctr.currange, ctr.ctrlType, ctr.ctrlValue);\n            } else if (ctr.type == 'addRC') {\n                //增加行列重做操作\n                ///jfrefreshgrid_adRC(ctr.curData, ctr.curConfig, 'addRC', ctr.ctrlValue, ctr.curCalc, ctr.curFilterObj, ctr.curCf, ctr.curAf, ctr.curFreezen, ctr.curDataVerification, ctr.curHyperlink);\n                Store.refreshGrid_adRC(ctr.curData, ctr.curConfig, 'addRC', ctr.ctrlValue, ctr.curCalc, ctr.curFilterObj, ctr.curCf, ctr.curAf, ctr.curFreezen, ctr.curDataVerification, ctr.curHyperlink);\n            } else if (ctr.type == 'delRC') {\n                //删除行列重做操作\n                ///jfrefreshgrid_adRC(ctr.curData, ctr.curConfig, 'delRC', ctr.ctrlValue, ctr.curCalc, ctr.curFilterObj, ctr.curCf, ctr.curAf, ctr.curFreezen, ctr.curDataVerification, ctr.curHyperlink);\n                Store.refreshGrid_adRC(ctr.curData, ctr.curConfig, 'delRC', ctr.ctrlValue, ctr.curCalc, ctr.curFilterObj, ctr.curCf, ctr.curAf, ctr.curFreezen, ctr.curDataVerification, ctr.curHyperlink);\n            } else if (ctr.type == 'deleteCell') {\n                //删除单元格重做操作\n                ///jfrefreshgrid_deleteCell(ctr.curData, ctr.curConfig, ctr.ctrl, ctr.curCalc, ctr.curFilterObj, ctr.curCf, ctr.curDataVerification, ctr.curHyperlink);\n                Store.refreshGrid_deleteCell(ctr.curData, ctr.curConfig, ctr.ctrl, ctr.curCalc, ctr.curFilterObj, ctr.curCf, ctr.curDataVerification, ctr.curHyperlink);\n            } else if (ctr.type == 'showHidRows') {\n                // 隐藏、显示行 重做操作\n                //config\n                Store.config = ctr.curconfig;\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].config = ctr.curconfig;\n                Store.saveParam('cg', ctr.sheetIndex, ctr.curconfig['rowhidden'], { 'k': 'rowhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                ///jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                Store.refreshGrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            } else if (ctr.type == 'showHidCols') {\n                // 隐藏、显示列 重做操作\n                //config\n                Store.config = ctr.curconfig;\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].config = ctr.curconfig;\n                Store.saveParam('cg', ctr.sheetIndex, ctr.curconfig['colhidden'], { 'k': 'colhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                ///jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                Store.refreshGrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            } else if (ctr.type == 'datachangeAll') {\n                formula.execFunctionGroup();\n                ///jfrefreshgridall(ctr.curdata[0].length, ctr.curdata.length, ctr.curdata, null, ctr.currange, 'datachangeAll', ctr.ctrlValue);\n                Store.refreshGridAll(ctr.curdata[0].length, ctr.curdata.length, ctr.curdata, null, ctr.currange, 'datachangeAll', ctr.ctrlValue);\n            } else if (ctr.type == 'datachangeAll_filter_clear') {\n                Store.saveParam('fsc', Store.currentSheetIndex, null);    //config\n                //config\n                Store.config = ctr.curconfig;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                Store.saveParam('cg', Store.currentSheetIndex, {}, { 'k': 'rowhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                ///jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                Store.refreshGrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                $('#luckysheet-filter-menu .luckysheet-filter-selected-input').hide().find('input').val();\n                $('#luckysheet-filter-selected span').data('type', '0').data('type', null).text('无');\n                $('#luckysheet-filter-selected-sheet' + Store.currentSheetIndex + ', #luckysheet-filter-options-sheet' + Store.currentSheetIndex).remove();\n                $('#luckysheet-filter-menu, #luckysheet-filter-submenu').hide();\n            } else if (ctr.type == 'datachangeAll_filter') {\n                let $top = $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').eq(ctr['optionsindex']);\n                let st_r = $top.data('str'), ed_r = $top.data('edr'), cindex = $top.data('cindex'), st_c = $top.data('stc'), ed_c = $top.data('edc');\n                labelFilterOptionState($top, json.hasKey(ctr.rowhidden), ctr.rowhidden, ctr.caljs, true, st_r, ed_r, cindex, st_c, ed_c);    //config\n                //config\n                Store.config = ctr.curconfig;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                Store.saveParam('cg', Store.currentSheetIndex, Store.config['rowhidden'], { 'k': 'rowhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                ///jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                Store.refreshGrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n                $('#luckysheet-filter-menu, #luckysheet-filter-submenu').hide();\n            } else if (ctr.type == 'filtershow') {\n                Store.luckysheet_select_save = [ctr.filter_save];\n                Store.filterchage = false;\n                createFilter();\n                Store.filterchage = true;\n                Store.saveParam('all', ctr.sheetIndex, ctr.filter_save, { 'k': 'filter_select' });\n            } else if (ctr.type == 'pivotTable_change') {\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].pivotTable = ctr.pivotTablecur;\n                pivotTable.getCellData(ctr.sheetIndex);\n                pivotTable.initialPivotManage(true);\n                pivotTable.refreshPivotTable();\n            } else if (ctr.type == 'addSheet') {\n                sheetmanage.createSheetbydata(ctr.sheetconfig);\n                $('#luckysheet-input-box').removeAttr('style');\n                $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n            } else if (ctr.type == 'copySheet') {\n                sheetmanage.copySheet(ctr.copyindex);\n            } else if (ctr.type == 'deleteSheet') {\n                sheetmanage.deleteSheet(ctr.index);\n                if (ctr.order == 0) {\n                    Store.changeSheet(Store.luckysheetfile[0].index);\n                } else {\n                    Store.changeSheet(Store.luckysheetfile[ctr.order - 1].index);\n                }\n                $('#luckysheet-input-box').removeAttr('style');\n                $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n            } else if (ctr.type == 'sheetName') {\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].name = ctr.txt;\n                $('#luckysheet-sheets-item' + ctr.sheetIndex).find('.luckysheet-sheets-item-name').html(ctr.txt);\n                Store.saveParam('all', ctr.sheetIndex, ctr.txt, { 'k': 'name' });\n            } else if (ctr.type == 'sheetColor') {\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].color = ctr.color;\n                let luckysheetcurrentSheetitem = $('#luckysheet-sheets-item' + ctr.sheetIndex);\n                luckysheetcurrentSheetitem.find('.luckysheet-sheets-item-color').remove();\n                if (ctr.color != null) {\n                    luckysheetcurrentSheetitem.append('<div class=\"luckysheet-sheets-item-color\" style=\" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: ' + ctr.color + ';\"></div>');\n                }\n                Store.saveParam('all', ctr.sheetIndex, ctr.color, { 'k': 'color' });\n            } else if (ctr.type == 'mergeChange') {\n                let allParam = { 'cfg': ctr.curConfig };\n                ///jfrefreshgrid(ctr.curData, ctr.range, allParam);\n                Store.refreshGrid(ctr.curData, ctr.range, allParam);\n            } else if (ctr.type == 'updateDataVerification') {\n                dataVerificationCtrl.ref(ctr.historyDataVerification, ctr.currentDataVerification, ctr.sheetIndex);\n            } else if (ctr.type == 'updateDataVerificationOfCheckbox') {\n                dataVerificationCtrl.refOfCheckbox(ctr.historyDataVerification, ctr.currentDataVerification, ctr.sheetIndex, ctr.curData, ctr.range);\n            } else if (ctr.type == 'updateHyperlink') {\n                hyperlinkCtrl.ref(ctr.historyHyperlink, ctr.currentHyperlink, ctr.sheetIndex, ctr.curData, ctr.range);\n            } else if (ctr.type == 'updateCF') {\n                let currentRules = ctr['data']['currentRules'];\n                for (let i = 0; i < currentRules.length; i++) {\n                    //条件规则\n                    let sheetIndex = currentRules[i]['sheetIndex'];\n                    Store.luckysheetfile[getSheetIndex(sheetIndex)]['luckysheet_conditionformat_save'] = currentRules[i]['luckysheet_conditionformat_save'];\n                    if (Store.allowUpdate) {\n                        Store.saveParam('all', sheetIndex, currentRules[i]['luckysheet_conditionformat_save'], { 'k': 'luckysheet_conditionformat_save' });\n                    }\n                }    //刷新一次表格\n                //刷新一次表格\n                conditionformat.ref();\n            } else if (ctr.type == 'updateAF') {\n                let currentRules = ctr['data']['currentRules'];\n                let index = getSheetIndex(ctr['sheetIndex']);\n                Store.luckysheetfile[index]['luckysheet_alternateformat_save'] = $.extend(true, [], currentRules);\n                ///setTimeout(function () {\n                ///    luckysheetrefreshgrid();\n                ///}, 1);\n                Store.refresh();\n            } else if (ctr.type == 'borderChange') {\n                Store.saveParam('cg', ctr.sheetIndex, ctr.curconfig['borderInfo'], { 'k': 'borderInfo' });\n                Store.config = ctr.curconfig;\n                Store.luckysheetfile[getSheetIndex(ctr.sheetIndex)].config = Store.config;\n                setTimeout(function () {\n                    luckysheetrefreshgrid();\n                }, 1);\n            } else if (ctr.type == 'postil') {\n                luckysheetPostil.ref(ctr.curdata, ctr.rc);\n                for (let i = 0; i < ctr.rc.length; i++) {\n                    let r = ctr.rc[i].split('_')[0];\n                    let c = ctr.rc[i].split('_')[1];\n                    if (ctr.curdata[r][c] != null && ctr.curdata[r][c].ps != null) {\n                        luckysheetPostil.buildPs(r, c, ctr.curdata[r][c].ps);\n                    } else {\n                        luckysheetPostil.buildPs(r, c, null);\n                    }\n                }\n            } else if (ctr.type == 'imageCtrl') {\n                imageCtrl.images = $.extend(true, {}, ctr.curImages);\n                imageCtrl.allImagesShow();\n                imageCtrl.ref();\n            } else if (ctr.type == 'zoomChange') {\n                Store.zoomRatio = ctr.curZoomRatio;\n                Store.saveParam('all', ctr.currentSheetIndex, ctr.curZoomRatio, { 'k': 'zoomRatio' });\n                zoomNumberDomBind();\n                zoomRefreshView();\n            }\n            if (ctr.range) {\n                Store.luckysheet_select_save = ctr.range;\n                selectHightlightShow();\n            }\n            Store.clearjfundo = true;    /* 刷新当前状态栏 */\n            /* 刷新当前状态栏 */\n            refreshMenuButtonFocus();\n        }\n    };\n    return controlHistory;\n});"]}