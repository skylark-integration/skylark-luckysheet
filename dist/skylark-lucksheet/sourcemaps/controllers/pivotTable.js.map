{"version":3,"sources":["controllers/pivotTable.js"],"names":["define","m_get","m_util","m_getdata","m_datecontroll","m_format","m_validate","pivotTable_methods","m_sort","tooltip","cleargridelement","luckysheetArray","analysis","m_select","luckysheetConfigsetting","m_sheetSearch","m_constant","sheets","luckysheetsizeauto","m_protection","Store","locale","numeral","getSheetIndex","getRangetxt","replaceHtml","getObjType","ABCatNum","numFormat","numfloatlen","showrightclickmenu","mouseclickposition","getdatabyselectionD","getcellvalue","datagridgrowth","isdatetime","diff","isdatatypemulti","isdatatype","genarate","update","isRealNull","isEditMode","orderbydata1D","selectHightlightShow","luckysheet_searcharray","modelHTML","filtermenuHTML","filtersubmenuHTML","pivottableconfigHTML","pivottablesumHTML","luckysheetPivotTableHTML","checkProtectionAuthorityNormal","Object","assign","showvaluecolrow","_this","this","$","length","show","showType","prop","addClass","removeClass","hide","resetOrderby","obj","orderby","index","find","each","data","luckysheetsliderlistclearfilter","$filter","$t","parent","cindex","rowhidden","d","origindata","setDatatojsfile","newdata","i","push","concat","celldata","refreshPivotTable","luckysheetsliderlistitemfilter","locale_filter","filter","toffset","offset","$menu","winH","window","height","width","JSON","parse","val","next","text","filiterInputNone","byconditiontype","$input","eq","empty","html","filiterMoreDataTip","rowhiddenother","not","get","rh","r","setTimeout","dvmap","dvmap_uncheck","vmap","vmap_uncheck","cell","ct","t","v","y","split","m","item","stringify","yearHtml","ysum","monthHtml","mT2","msum","dayHtml","mT","dT","dayL","Number","filiterMonthText","filiterYearText","unshift","vmapKeys","keys","x","dataHtml","valueBlank","top","join","left","createPivotTable","e","allowEdit","datasheetindex","currentSheetIndex","locale_pivotTable","pivotTable","alert","errorNotAllowEdit","luckysheet_select_save","info","errorNotAllowMulti","row","column","errorSelectRange","select_save","extend","addNewSheet","getCellData","initialPivotManage","changePivotTable","pivotDataSheetIndex","luckysheetfile","errorIsDamage","isRefreshCanvas","redo","deepCopyFlowData","flowdata","storePivotTableParam","ret","dataHandler","values","nulldata","addr","addc","rlen","clen","c","value","getPivotTableData","clearjfundo","jfundo","jfredo","refreshGridAll","undefined","refreshGrid","pivotclick","row_index","col_index","file","isPivotTable","slider","isRangeClick","isPivotRange","is","css","columnarr","rowarr","filterarr","valuesarr","showtype","pivotDatas","saveParam","pivotSheetIndex","k","restore","_locale","locale_button","button","initial","append","click","id","addclass","title","titleSelectionDataRange","content","titleDataRange","botton","confirm","cancel","menuid","remove","checkboxradio","icon","change","hidefilersubmenu","mouseover","clearTimeout","document","off","on","attr","removeAttr","parents","yearDayAllCheck","monthDayAllCheck","$p","hasClass","slideToggle","event","toString","day","siblings","month","indexOf","slideUp","slideDown","winW","menuW","mheight","stopPropagation","myh","outerHeight","myw","outerWidth","winw","winh","scrollLeft","scrollTop","jgridCurrentPivotInput","luckysheet_pivotTable_select_state","$item","target","closest","order","stastic","option","replace","sumtype","type","pivot_data_type","name","getSumTypeName","filterdata","caljs","value1","valuelen","substr","parseInt","parseFloat","min","max","value2","year","itemV","filterDateFormatTip","fmt","$top","changeSheet","trim","toUpperCase","val1","sheettxt","rangetxt","sheetIndex","errorNotAllowPivotData","errorSelectionRange","col","$cur","movestate","movesave","containerid","mousemove","moveitemposition","h","background","color","border","pageX","pageY","$container","curtop","position","mouseleave","mouseup","itemHTML","clone","nameindex","valueStatisticsSUM","valueStatisticsCOUNTA","ni","last","after","before","$seleted","$column","$row","columnitem","rowitem","errorIncreaseRange","selecteditem","selecteditemIndex","selecteditemtest","selecteditemNullIndex","titleColumn","dataother","style","filterparm","itemset","selected","caljsset","titleAddColumn","titleMoveColumn","titleClearColumnFilter","titleFilterColumn","otherset","pivot_select_save","drillDown","a","b","rowArr","j","isEqual"],"mappings":";;;;;;;AAAAA,QACI,iBACA,gBACA,qBACA,0BACA,oBACA,sBACA,gCACA,0BACA,qBACA,8BACA,mBACA,sBACA,oBACA,qCACA,yBACA,sBACA,oBACA,oBACA,gCACA,WACA,mBACA,sBACD,SAAUC,EAAOC,EAAQC,EAAWC,EAAgBC,EAAUC,EAAYC,EAAmBC,EAAQC,EAASC,EAAkBC,EAAiBC,EAAUC,EAASC,EAAyBC,EAAeC,EAAYC,EAAQC,EAAqBC,EAAcC,EAAOC,EAAQC,GACjR,aACA,MAAMC,cAACA,EAAaC,YAAEA,GAAevB,GAC/BwB,YAACA,EAAWC,WAAEA,EAAUC,SAAEA,EAAQC,UAAEA,EAASC,YAAEA,EAAWC,mBAAEA,EAAkBC,mBAAEA,GAAsB7B,GACtG8B,oBAACA,EAAmBC,aAAEA,EAAYC,eAAEA,GAAkB/B,GACtDgC,WAACA,EAAUC,KAAEA,EAAIC,gBAAEA,EAAeC,WAAEA,GAAclC,GAClDmC,SAACA,EAAQC,OAAEA,GAAUnC,GACrBoC,WAACA,GAAcnC,EACfoC,EAAa5B,EAAwB4B,YACrCC,cAACA,GAAiBnC,GAClBoC,qBAACA,GAAwB/B,GACzBgC,uBAACA,GAA0B9B,GAC3B+B,UAACA,EAASC,eAAEA,EAAcC,kBAAEA,EAAiBC,qBAAEA,EAAoBC,kBAAEA,EAAiBC,yBAAEA,GAA4BnC,GACpHoC,+BAACA,GAAkCjC,EAupDzC,OAtpDmBkC,OAAOC,OAAO/C,GAC7BgD,gBAAiB,WACb,IAAIC,EAAQC,KACRC,EAAE,qFAAqFC,QAAU,GACjGD,EAAE,wCAAwCE,OACpB,UAAlBJ,EAAMK,UACNH,EAAE,oCAAoCI,KAAK,WAAW,GACtDJ,EAAE,qFAAqFK,SAAS,mBAChGL,EAAE,qCAAqCI,KAAK,WAAW,GACvDJ,EAAE,sFAAsFM,YAAY,qBAEpGN,EAAE,qCAAqCI,KAAK,WAAW,GACvDJ,EAAE,sFAAsFK,SAAS,mBACjGL,EAAE,oCAAoCI,KAAK,WAAW,GACtDJ,EAAE,qFAAqFM,YAAY,qBAGvGN,EAAE,wCAAwCO,QAGlDC,aAAc,SAAUC,GACpB,IAAIC,EAAUV,EAAE,qFAAqFW,MAAMF,GAC3GT,EAAE,+EAA+EY,KAAK,+CAA+CC,KAAK,WAClIb,EAAED,MAAMe,KAAK,YAAcJ,GAC3BV,EAAED,MAAMe,KAAK,UAAW,WAIpCC,gCAAiC,SAAUC,GACvC,IACIC,EAAKD,EAAQE,SACbC,EAASF,EAAGH,KAAK,SACjBM,KAA+BC,EAHvBtB,KAGiCuB,WAC7CL,EAAGH,KAAK,YAAa,IAAIF,KAAK,yCAAyCL,OAJ3DR,KAKNwB,gBAAgB,cAAgBJ,GAL1BpB,KAMNwB,gBAAgB,YAAa,KAAMJ,GACzC,IAAIK,KACJ,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAEpB,OAAQwB,IACN,MAAhBL,EAAUK,IAGdD,EAAQE,QAAQC,OAAON,EAAEI,KAZjB1B,KAcN6B,SAAWJ,EAdLzB,KAeN8B,oBACN7B,EAAE,2EAA2EO,QAEjFuB,+BAAgC,SAAUd,GAEtC,MACMe,EADUpE,IACcqE,OAC9B,IAAIf,EAAKD,EAAQE,SAAUe,EAAUhB,EAAGiB,SAAUC,EAAQnC,EAAE,qCAAsCoC,EAAOpC,EAAEqC,QAAQC,SAC/GnB,GADgInB,EAAEqC,QAAQE,QACjItB,EAAGH,KAAK,UACjBM,EAAYH,EAAGH,KAAK,aACP,MAAbM,GAAkC,IAAbA,EACrBA,KACgC,UAAzBpD,EAAWoD,KAClBA,EAAYoB,KAAKC,MAAMrB,IAE3BpB,EAAE,8BAA8BO,OAChCP,EAAE,2EAA2EO,OAC7EP,EAAE,8CAA8C0C,IAAI,IACpD1C,EAAE,4CAA4C2C,OAAOpC,OACrDP,EAAE,wCAAwC2C,OAAOzC,OACjDiC,EAAMrB,KAAK,QAASK,GACpBnB,EAAE,iFAAiFO,OAAOK,KAAK,SAAS8B,MACxG1C,EAAE,8CAA8Cc,KAAK,OAAQ,KAAKA,KAAK,OAAQ,MAAM8B,KAAKb,EAAcc,kBACxG,IAAIC,EAAkB7B,EAAGH,KAAK,mBAE9B,GADAd,EAAE,8CAA8Cc,KAAK,QAASG,EAAGH,KAAK,qBAAqBA,KAAK,OAAQgC,GAAiBF,KAAK3B,EAAGH,KAAK,oBAC/G,KAAnBgC,EAAwB,CACxB,IAAIC,EAAS/C,EAAE,kFAAkFE,OAAOU,KAAK,SAC7GmC,EAAOC,GAAG,GAAGN,IAAIzB,EAAGH,KAAK,sBACzBiC,EAAOC,GAAG,GAAGN,IAAIzB,EAAGH,KAAK,0BACC,KAAnBgC,GACP9C,EAAE,iFAAiFgD,GAAG,GAAG9C,OAAOU,KAAK,SAAS8B,IAAIzB,EAAGH,KAAK,sBAE9Hd,EAAE,+CAA+CiD,QAAQC,KAAK,wIAA0InB,EAAcoB,mBAAqB,iBAC3O,IAAIC,KAEJpD,EAAE,sFAAsFqD,IAAIpC,EAAGqC,IAAI,IAAIzC,KAAK,WACxG,IAAkB0C,EAATvD,EAAED,MAAee,KAAK,aAC/B,GAAU,MAANyC,GAAoB,IAANA,EACd,OAAO,EAEW,UAAlBvF,EAAWuF,KACXA,EAAKf,KAAKC,MAAMc,IAEpB,IAAK,IAAIC,KAAKD,EACVH,EAAeI,GAAK,IAG5B,IAAI1C,EA3CQf,KA2CKuB,WACjBmC,WAAW,WAEP,IAAIC,KACAC,KAEAC,KACAC,KACJ,IAAK,IAAIL,EAAI,EAAGA,EAAI1C,EAAKb,OAAQuD,IAAK,CAClC,GAAIA,KAAKJ,EACL,SAEJ,GAAe,MAAXtC,EAAK0C,GACL,SAEJ,IAAIM,EAAOhD,EAAK0C,GAAGrC,GACnB,GAAY,MAAR2C,GAA2B,MAAXA,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAAU,CAErD,IAAIC,EAAInF,EAAO,aAAcgF,EAAKG,GAC9BC,EAAID,EAAEE,MAAM,KAAK,GACjBC,EAAIH,EAAEE,MAAM,KAAK,GACjB9C,EAAI4C,EAAEE,MAAM,KAAK,GACfD,KAAKR,IACPA,EAAMQ,OAEJE,KAAKV,EAAMQ,KACbR,EAAMQ,GAAGE,OAEP/C,KAAKqC,EAAMQ,GAAGE,KAChBV,EAAMQ,GAAGE,GAAG/C,GAAK,GAErBqC,EAAMQ,GAAGE,GAAG/C,KACRmC,KAAKpC,IACLuC,EAAcO,GAAK,EACnBP,EAAcS,GAAK,EACnBT,EAActC,GAAK,OAEpB,CACH,IAAI4C,EAAGG,EACK,MAARN,GAAgB/E,EAAW+E,EAAKG,IAChCA,EAAI,KACJG,EAAI,OAEJH,EAAIH,EAAKG,EACTG,EAAIN,EAAKM,GAEPH,KAAKL,IACPA,EAAKK,OAEHG,KAAKR,EAAKK,KACZL,EAAKK,GAAGG,GAAK,GAEjBR,EAAKK,GAAGG,KACJZ,KAAKpC,IACLyC,EAAaI,EAAI,QAAUG,GAAK,IAK5C,IAAIC,KACJ,GAAI7B,KAAK8B,UAAUZ,GAAOzD,OAAS,EAC/B,IAAK,IAAIiE,KAAKR,EAAO,CACjB,IA6CIa,EA7CAC,EAAO,EACPC,EAAY,GAChB,IAAK,IAAIL,KAAKV,EAAMQ,GAAI,CACpB,IA4BIQ,EA5BAC,EAAO,EACPC,EAAU,GACd,IAAK,IAAIvD,KAAKqC,EAAMQ,GAAGE,GAAI,CACvB,IAGIS,EAOAC,EAVAC,EAAOrB,EAAMQ,GAAGE,GAAG/C,GACvBsD,GAAQI,EAIJF,EADAG,OAAOZ,GAAK,GACP,IAAMY,OAAOZ,GAEbA,EAKLU,EADAE,OAAO3D,GAAK,GACP,IAAM2D,OAAO3D,GAEbA,EAILuD,GADAV,KAAKP,GAAiBS,KAAKT,GAAiBtC,KAAKsC,EACtC,6EAA+EO,EAAI,IAAMW,EAAK,IAAMC,EAAK,4GAAwHzD,EAAI,6DAAoE0D,EAAO,kBAEhT,4EAA8Eb,EAAI,IAAMW,EAAK,IAAMC,EAAK,8HAA0IzD,EAAI,6DAAoE0D,EAAO,kBAGpVP,GAAQG,EAIJD,EADAM,OAAOZ,GAAK,GACN,IAAMY,OAAOZ,GAEbA,EAINK,GADAP,KAAKP,GAAiBS,KAAKT,EACd,iIAAwIO,EAAI,IAAMQ,EAAM,4LAA6MN,EAASrC,EAAckD,iBAAmB,6DAAoEN,EAAO,mEAA+EC,EAAU,eAEnjB,gIAAuIV,EAAI,IAAMQ,EAAM,8MAA+NN,EAASrC,EAAckD,iBAAmB,6DAAoEN,EAAO,mEAA+EC,EAAU,eAMrlBL,EADAL,KAAKP,EACM,+HAAsIO,EAAI,4LAA6MA,EAASnC,EAAcmD,gBAAkB,6DAAoEV,EAAO,qEAAiFC,EAAY,eAExiB,8HAAqIP,EAAI,8MAA+NA,EAASnC,EAAcmD,gBAAkB,6DAAoEV,EAAO,qEAAiFC,EAAY,eAExkBJ,EAAKc,QAAQZ,GAGrB,GAAI/B,KAAK8B,UAAUV,GAAM3D,OAAS,EAAG,CACjC,IAAImF,EAAWzF,OAAO0F,KAAKzB,GAC3BwB,EAAWnG,EAAcmG,GAAU,GACnC,IAAK,IAAI3D,EAAI,EAAGA,EAAI2D,EAASnF,OAAQwB,IAAK,CACtC,IAAIwC,EAAImB,EAAS3D,GACjB,IAAK,IAAI6D,KAAK1B,EAAKK,GAAI,CACnB,IAAIrB,EAOA2C,EALA3C,EADAqB,EAAI,QAAUqB,GAAK,gBACZvD,EAAcyD,WAEdF,EAKPC,EADAtB,EAAI,QAAUqB,KAAKzB,EACR,uFAA0FI,EAAI,QAAUqB,EAAK,YAAcA,EAAI,4GAAwH1C,EAAO,6DAAoEgB,EAAKK,GAAGqB,GAAK,kBAE/U,sFAAyFrB,EAAI,QAAUqB,EAAK,YAAcA,EAAI,8HAA0I1C,EAAO,6DAAoEgB,EAAKK,GAAGqB,GAAK,kBAE/WjB,EAAK3C,KAAK6D,KAItBvF,EAAE,+CAA+CkD,KAAK,uEAAyEd,EAAOH,EAAQwD,IAAM,KAAO,0CAA4CpB,EAAKqB,KAAK,IAAM,WACxN,GACHtH,EAAmB+D,EAAOF,EAAQ0D,KAAO,IAAK1D,EAAQwD,MAG1DG,iBAAkB,SAAUC,GACxB,GAAI7G,MAAoC,IAApBtB,EAAMoI,UACtB,OAEJ,IACIC,EAAiBrI,EAAMsI,kBAC3B,MACMC,EADUtI,IACkBuI,WAClC,GAAIlH,IAEA,YADAmH,MAAMF,EAAkBG,mBAG5B,GAAI1I,EAAM2I,uBAAuBpG,OAAS,EAEtC,YADAlD,EAAQuJ,KAAK,GAAIL,EAAkBM,oBAGvC,GAA2C,GAAvC7I,EAAM2I,uBAAuBpG,QAAevC,EAAM2I,uBAAuB,GAAGG,IAAI,IAAM9I,EAAM2I,uBAAuB,GAAGG,IAAI,IAAM9I,EAAM2I,uBAAuB,GAAGI,OAAO,IAAM/I,EAAM2I,uBAAuB,GAAGI,OAAO,GAEpN,YADA1J,EAAQuJ,KAAK,GAAIL,EAAkBS,kBAGvC,IAAIC,EAAc3G,EAAE4G,QAAO,KAAUlJ,EAAM2I,uBAAuB,IAClE9I,EAAOsJ,YAAYhB,GAAG,GAjBV9F,KAkBN+G,YAAYpJ,EAAMsI,kBAAmBD,EAAgBY,GAlB/C5G,KAmBNwB,gBAAgB,oBAAqBoF,GAnB/B5G,KAoBNwB,gBAAgB,sBAAuBwE,GApBjChG,KAqBNgH,sBAEVC,iBAAkB,SAAUrG,GAExB,MACMsF,EADUtI,IACkBuI,WAClC,IAAIe,EAAsBvJ,EAAMwJ,eAAerJ,EAAc8C,IAAQuF,WAAWe,oBAEhD,MADDpJ,EAAcoJ,IAJjClH,KASN+G,YAAYnG,GATNZ,KAUNgH,oBAAmB,GAVbhH,KAWN8B,qBALF9E,EAAQuJ,KAAKL,EAAkBkB,cAAe,KAQtDtF,kBAAmB,SAAUuF,GAAkB,GAC3C,IAAItH,EAAQC,KACRsH,KACJA,EAAiB,WAAIxK,EACrBwK,EAAW,KAAI3J,EAAM4J,iBAAiB5J,EAAM6J,UAE5CzH,EAAM0H,uBACN,IAAIC,EAAM3H,EAAM4H,YAAY5H,EAAM2G,OAAQ3G,EAAM0G,IAAK1G,EAAM6H,OAAQ7H,EAAMK,SAAUL,EAAM8B,UACzF9B,EAAMyB,gBAAgB,aAAckG,GACpC,IAAIpG,EAAIrB,EAAE4G,QAAO,KAAUrJ,EAAOqK,UAC9B9G,EAAOO,EACPwG,EAAO,EAAGC,EAAO,EACrB,GAAkB,GAAdL,EAAIxH,OACJH,EAAMyB,gBAAgB,kBAAkB,GACxCzB,EAAMyB,gBAAgB,sBAClB,GACA,QAED,CACHzB,EAAMyB,gBAAgB,kBAAkB,GACxCzB,EAAMyB,gBAAgB,sBAClBkG,EAAIxH,OACJwH,EAAI,GAAGxH,SAEX,IAAI8H,EAAON,EAAIxH,OAAQ+H,EAAOP,EAAI,GAAGxH,OACrC4H,EAAOE,EAAO1G,EAAEpB,OAChB6H,EAAOE,EAAO3G,EAAE,GAAGpB,OACnBa,EAAOtC,EAAe6C,EAAGwG,EAAO,GAAIC,EAAO,IAAI,GAC/C,IAAK,IAAItE,EAAI,EAAGA,EAAIuE,EAAMvE,IAAK,CAC3B,IAAI8B,KAAO3D,OAAOb,EAAK0C,IACvB,IAAK,IAAIyE,EAAI,EAAGA,EAAID,EAAMC,IAAK,CAC3B,IAAIC,EAAQ,GACE,MAAVT,EAAIjE,IAA2B,MAAbiE,EAAIjE,GAAGyE,KACzBC,EAAQ3J,EAAaiF,EAAGyE,EAAGR,IAE/BnC,EAAE2C,GAAKC,EAEXpH,EAAK0C,GAAK8B,GAGlB+B,EAAW,KAAI,oBACfA,EAAc,QAAIrH,EAAE4G,QAAO,KAAU9F,GACrCuG,EAAiB,WAAI3J,EAAMsI,kBAC3B,IAAIE,EAAapG,EAAMqI,oBACvBd,EAAoB,cAAInB,EACpBxI,EAAM0K,cACN1K,EAAM2K,OAAOpI,OAAS,EACtBvC,EAAM4K,OAAO5G,KAAK2F,IAEtBrK,IACAU,EAAM0K,aAAc,EAChBP,EAAO,GAAKC,EAAO,EAEnBpK,EAAM6K,eAAezH,EAAK,GAAGb,OAAQa,EAAKb,OAAQa,EAAM,KAAMpD,EAAM2I,uBAAwB,qBAAiBmC,OAAWA,EAAWpB,IAGnI1J,EAAM+K,YAAY3H,EAAMpD,EAAM2I,0BAA4B,KAAMe,GAChElI,KAEJxB,EAAM0K,aAAc,GAExBM,WAAY,SAAUC,EAAWC,EAAWjI,GAC3B,MAATA,IACAA,EAAQjD,EAAMsI,mBAElB,IAAI6C,EAAOnL,EAAMwJ,eAAerJ,EAAc8C,IAC9C,IAAKkI,EAAKC,aACN,OAEJ,IAAI7B,EAAsB4B,EAAK3C,WAAWe,oBAE1C,GAAgC,MADDpJ,EAAcoJ,GAEzC,OAEJ,IAAI8B,EAAS/I,EAAE,yCACXgJ,EAAejJ,KAAKkJ,aAAaN,EAAWC,GAChD,GAAII,GAAgBD,EAAOG,GAAG,WAAY,CACtC,IAAKxJ,EAA+BiB,EAAO,wBAAwB,GAE/D,OAEJoI,EAAO7I,OACP1C,IACAwC,EAAE,2BAA2BmJ,IAAI,gBAAiB,UAC1CH,GAAgBD,EAAOG,GAAG,cAClCH,EAAOxI,OACP/C,IACAwC,EAAE,2BAA2BmJ,IAAI,gBAAiB,MAG1D3B,qBAAsB,WAClB,IACI4B,KAAgBC,KAAaC,KAAgBC,KACjDvJ,EAAE,sFAAsFa,KAAK,WACzF,IAAIwD,KACJA,EAAY,MAAIrE,EAAED,MAAMe,KAAK,SAC7BuD,EAAW,KAAIrE,EAAED,MAAMe,KAAK,QAC5BuD,EAAe,SAAIrE,EAAED,MAAMa,KAAK,mDAAmDgC,OACnF0G,EAAU5H,KAAK2C,KAEnBrE,EAAE,mFAAmFa,KAAK,WACtF,IAAIwD,KACJA,EAAY,MAAIrE,EAAED,MAAMe,KAAK,SAC7BuD,EAAW,KAAIrE,EAAED,MAAMe,KAAK,QAC5BuD,EAAe,SAAIrE,EAAED,MAAMa,KAAK,mDAAmDgC,OACnFyB,EAAY,MAAIrE,EAAED,MAAMe,KAAK,SAC7BuD,EAAc,QAAIrE,EAAED,MAAMe,KAAK,WAC/BuD,EAAc,QAAIrE,EAAED,MAAMe,KAAK,WAC/BuI,EAAO3H,KAAK2C,KAEhBrE,EAAE,sFAAsFa,KAAK,WACzF,IAAIwD,KACJA,EAAY,MAAIrE,EAAED,MAAMe,KAAK,SAC7BuD,EAAW,KAAIrE,EAAED,MAAMe,KAAK,QAC5BuD,EAAe,SAAIrE,EAAED,MAAMa,KAAK,mDAAmDgC,OACnFyB,EAAY,MAAIrE,EAAED,MAAMe,KAAK,SAC7BuD,EAAc,QAAIrE,EAAED,MAAMe,KAAK,WAC/BuD,EAAc,QAAIrE,EAAED,MAAMe,KAAK,WAC/BsI,EAAU1H,KAAK2C,KAEnBrE,EAAE,qFAAqFa,KAAK,WACxF,IAAIwD,KACJA,EAAY,MAAIrE,EAAED,MAAMe,KAAK,SAC7BuD,EAAW,KAAIrE,EAAED,MAAMe,KAAK,QAC5BuD,EAAe,SAAIrE,EAAED,MAAMa,KAAK,mDAAmDgC,OACnFyB,EAAc,QAAIrE,EAAED,MAAMe,KAAK,WAC/BuD,EAAgB,UAAIrE,EAAED,MAAMe,KAAK,aACjCyI,EAAU7H,KAAK2C,KApCPtE,KAsCNwB,gBAAgB,SAAU6H,GAtCpBrJ,KAuCNwB,gBAAgB,MAAO8H,GAvCjBtJ,KAwCNwB,gBAAgB,SAAU+H,GAxCpBvJ,KAyCNwB,gBAAgB,SAAUgI,GAChC,IAAIC,EAAWxJ,EAAE,uFAAuF0C,MA1C5F3C,KA2CNwB,gBAAgB,WAAwB,KAAZiI,EAAkB,MAAQ,UAC5D,IAAItD,EA5CQnG,KA4CWoI,2BAChBjC,EAAWuD,WAClB/L,EAAMgM,UAAU,MA9CJ3J,KA8CiB4J,gBAAiBzD,GAAc0D,EAAK,gBAErE7C,mBAAoB,SAAU8C,GAC1B,IAAI/J,EAAQC,KACZ,MAAM+J,EAAUnM,IACVsI,EAAoB6D,EAAQ5D,WAC5B6D,EAAgBD,EAAQE,OACxBjI,EAAgB+H,EAAQ9H,OAC9B,GAAIlC,EAAMmK,QAAS,CACfnK,EAAMmK,SAAU,EAChBjK,EAAE,QAAQkK,OAAOzK,KACjBO,EAAE,yCAAyCmK,MAAM,WAC7CnK,EAAE,yCAAyCO,OAC3C/C,MAEJwC,EAAE,QAAQkK,OAAOnM,EAAYqB,GACzBgL,GAAM,uCACNC,SAAY,uCACZC,MAASrE,EAAkBsE,wBAC3BC,QAAW,4LAA8LvE,EAAkBwE,eAAiB,kBAAoBxE,EAAkBwE,eAAiB,KACnSC,OAAU,gFAAkFX,EAAcY,QAAU,uEAAyEZ,EAAca,OAAS,eAExN5K,EAAE,QAAQkK,OAAOnM,EAAYsB,KAAoBwL,OAAU,sBAC3D7K,EAAE,QAAQkK,OAAOnM,EAAYuB,KAAuBuL,OAAU,sBAC9D7K,EAAE,QAAQkK,OAAO3K,KACjBS,EAAE,QAAQkK,OAAO1K,KACjBQ,EAAE,4CAA4C8K,SAC9C9K,EAAE,6CAA6C2C,OAAOmI,SACtD9K,EAAE,6CAA6C8K,SAC/C9K,EAAE,8CAA8C2C,OAAOmI,SACvD9K,EAAE,8CAA8C8K,SAChD9K,EAAE,uEAAuE+K,eAAgBC,MAAM,IAASC,OAAO,WAC3GnL,EAAM+B,sBAEV,IAAIqJ,EAAmB,KACvBlL,EAAE,qCAAqCmL,UAAU,WAC7CC,aAAaF,GACbA,EAAmBzH,WAAW,WAC1BzD,EAAE,wCAAwCO,QAC3C,OAGPP,EAAEqL,UAAUC,IAAI,2BAA2BC,GAAG,0BAA2B,uDAAwD,WAC3F,QAA9BvL,EAAED,MAAMyL,KAAK,eACbxL,EAAED,MAAMyL,KAAK,aAAc,SAC3BxL,EAAED,MAAMa,KAAK,0BAA0B6K,WAAW,aAElDzL,EAAED,MAAMyL,KAAK,aAAc,QAC3BxL,EAAED,MAAMa,KAAK,0BAA0BR,KAAK,WAAW,MAG/DJ,EAAEqL,UAAUC,IAAI,2BAA2BC,GAAG,0BAA2B,oDAAqD,WACxF,QAA9BvL,EAAED,MAAMyL,KAAK,eACbxL,EAAED,MAAMyL,KAAK,aAAc,SAC3BxL,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,UAAU4K,KAAK,aAAc,SAC9DxL,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,QAAQ4K,KAAK,aAAc,SAC5DxL,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,0BAA0B6K,WAAW,aAEtEzL,EAAED,MAAMyL,KAAK,aAAc,QAC3BxL,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,UAAU4K,KAAK,aAAc,QAC9DxL,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,QAAQ4K,KAAK,aAAc,QAC5DxL,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,0BAA0BR,KAAK,WAAW,MAGnFJ,EAAEqL,UAAUC,IAAI,2BAA2BC,GAAG,0BAA2B,qDAAsD,WAEzF,QAA9BvL,EAAED,MAAMyL,KAAK,eACbxL,EAAED,MAAMyL,KAAK,aAAc,SAC3BxL,EAAED,MAAM2L,QAAQ,aAAa9K,KAAK,QAAQ4K,KAAK,aAAc,SAC7DxL,EAAED,MAAM2L,QAAQ,aAAa9K,KAAK,0BAA0B6K,WAAW,aAEvEzL,EAAED,MAAMyL,KAAK,aAAc,QAC3BxL,EAAED,MAAM2L,QAAQ,aAAa9K,KAAK,QAAQ4K,KAAK,aAAc,QAC7DxL,EAAED,MAAM2L,QAAQ,aAAa9K,KAAK,0BAA0BR,KAAK,WAAW,IAGhF,IAAIuL,GAAkB,EACP3L,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,QACvCC,KAAK,SAAUY,EAAGoE,GACQ,QAA3B7F,EAAE6F,GAAG2F,KAAK,gBAEVG,GAAkB,KAGtBA,GACA3L,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,SAAS4K,KAAK,aAAc,QAC7DxL,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,gCAAgCR,KAAK,WAAW,KAEjFJ,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,SAAS4K,KAAK,aAAc,SAC7DxL,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,gCAAgC6K,WAAW,cAGpFzL,EAAEqL,UAAUC,IAAI,2BAA2BC,GAAG,0BAA2B,mDAAoD,WACvF,QAA9BvL,EAAED,MAAMyL,KAAK,eACbxL,EAAED,MAAMyL,KAAK,aAAc,SAC3BxL,EAAED,MAAMa,KAAK,0BAA0B6K,WAAW,aAElDzL,EAAED,MAAMyL,KAAK,aAAc,QAC3BxL,EAAED,MAAMa,KAAK,0BAA0BR,KAAK,WAAW,IAG3D,IAAIwL,GAAmB,EACP5L,EAAED,MAAM2L,QAAQ,aAAa9K,KAAK,QACxCC,KAAK,SAAUY,EAAGoE,GACO,QAA3B7F,EAAE6F,GAAG2F,KAAK,gBAEVI,GAAmB,KAGvBA,GACA5L,EAAED,MAAM2L,QAAQ,aAAa9K,KAAK,UAAU4K,KAAK,aAAc,QAC/DxL,EAAED,MAAM2L,QAAQ,aAAa9K,KAAK,iCAAiCR,KAAK,WAAW,KAEnFJ,EAAED,MAAM2L,QAAQ,aAAa9K,KAAK,UAAU4K,KAAK,aAAc,SAC/DxL,EAAED,MAAM2L,QAAQ,aAAa9K,KAAK,iCAAiC6K,WAAW,YAGlF,IAAIE,GAAkB,EACP3L,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,QACvCC,KAAK,SAAUY,EAAGoE,GACQ,QAA3B7F,EAAE6F,GAAG2F,KAAK,gBAEVG,GAAkB,KAGtBA,GACA3L,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,SAAS4K,KAAK,aAAc,QAC7DxL,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,gCAAgCR,KAAK,WAAW,KAEjFJ,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,SAAS4K,KAAK,aAAc,SAC7DxL,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,gCAAgC6K,WAAW,cAIpFzL,EAAEqL,UAAUC,IAAI,8BAA8BC,GAAG,6BAA8B,uEAAwE,WACnJ,IAAIM,EAAK7L,EAAED,MAAM2L,QAAQ,gCACrBG,EAAGC,SAAS,SACZ9L,EAAED,MAAM2L,QAAQ,YAAY9K,KAAK,cAAcmL,cAE/CF,EAAGC,SAAS,UACZ9L,EAAED,MAAM2L,QAAQ,aAAa9K,KAAK,YAAYmL,gBAItD/L,EAAE,gDAAgDmK,MAAM,WACpDnK,EAAE,+EAA+EI,KAAK,WAAW,GACjGJ,EAAE,+EAA+E0L,QAAQ,gCAAgCF,KAAK,aAAc,UAGhJxL,EAAE,mDAAmDmK,MAAM,WAC1CnK,EAAE,+EACRa,KAAK,SAAUY,EAAGoE,GACjB7F,EAAE6F,GAAGqD,GAAG,aACRlJ,EAAE6F,GAAG4F,WAAW,WAChBzL,EAAE6F,GAAG6F,QAAQ,gCAAgCF,KAAK,aAAc,WAEhExL,EAAE6F,GAAGzF,KAAK,WAAW,GACrBJ,EAAE6F,GAAG6F,QAAQ,gCAAgCF,KAAK,aAAc,WAI3DxL,EAAE,kEACRa,KAAK,SAAUF,EAAOqL,GACzB,IAAIJ,GAAmB,EACP5L,EAAEgM,GAAOpL,KAAK,+BACpBC,KAAK,SAAUY,EAAGoE,GACpB7F,EAAE6F,GAAGqD,GAAG,cAER0C,GAAmB,KAGvBA,GACA5L,EAAEgM,GAAOpL,KAAK,iCAAiCR,KAAK,WAAW,GAC/DJ,EAAEgM,GAAOR,KAAK,aAAc,UAE5BxL,EAAEgM,GAAOpL,KAAK,iCAAiC6K,WAAW,WAC1DzL,EAAEgM,GAAOR,KAAK,aAAc,YAIxBxL,EAAE,iEACRa,KAAK,SAAUF,EAAOqL,GACxB,IAAIL,GAAkB,EACP3L,EAAEgM,GAAOpL,KAAK,+BACpBC,KAAK,SAAUY,EAAGoE,GACnB7F,EAAE6F,GAAGqD,GAAG,cAERyC,GAAkB,KAGtBA,GACA3L,EAAEgM,GAAOpL,KAAK,gCAAgCR,KAAK,WAAW,GAC9DJ,EAAEgM,GAAOR,KAAK,aAAc,UAE5BxL,EAAEgM,GAAOpL,KAAK,gCAAgC6K,WAAW,WACzDzL,EAAEgM,GAAOR,KAAK,aAAc,cAKxCxL,EAAE,kDAAkDmK,MAAM,WACtDnK,EAAE,+EAA+EyL,WAAW,WAC5FzL,EAAE,+EAA+E0L,QAAQ,gCAAgCF,KAAK,aAAc,WAGhJxL,EAAE,8CAA8CuL,GAAG,uBAAwB,WACvE,IAAItH,EAAIjE,EAAED,MAAM2C,MAAMuJ,WAEtB,GADAjM,EAAE,qFAAqFE,OAC9E,IAAL+D,EAAS,CACIjE,EAAE,+EACRa,KAAK,SAAUY,EAAGoE,GACrB,IAAIgG,EAAK7L,EAAE6F,GAAG6F,QAAQ,gCACtB,GAAIG,EAAGC,SAAS,OAAQ,CAEpB,IAAII,EAAMlM,EAAE6F,GAAGsG,SAAS,SAASvJ,OAAOqJ,WACpCG,EAAQpM,EAAE6F,GAAG6F,QAAQ,aAAa9K,KAAK,gBAAgBgC,OAAOqJ,WAGlE,IAAyB,IAFdjM,EAAE6F,GAAG6F,QAAQ,YAAY9K,KAAK,eAAegC,OAAOqJ,WAC5C,IAAMG,EAAQ,IAAMF,GAC7BG,QAAQpI,GAAU,CACxBjE,EAAE6F,GAAG6F,QAAQ,QAAQnL,OAGG,GADRP,EAAE6F,GAAG6F,QAAQ,YAAY9K,KAAK,gBAChCX,QACVD,EAAE6F,GAAG6F,QAAQ,aAAa9K,KAAK,UAAUL,OAItB,GADRP,EAAE6F,GAAG6F,QAAQ,cAAc9K,KAAK,gBAClCX,QACTD,EAAE6F,GAAG6F,QAAQ,YAAY9K,KAAK,SAASL,QAInD,GAAIsL,EAAGC,SAAS,WAAY,EAGC,GADb9L,EAAE6F,GAAGsG,SAAS,SAASvJ,OAAOqJ,WAChCI,QAAQpI,IACdjE,EAAE6F,GAAG6F,QAAQ,YAAYnL,aAM7CP,EAAE,kFAAkFmK,MAAM,WACtF,IAAIlJ,EAAKjB,EAAED,MACXkB,EAAG0B,OAAOoJ,YAAY,KACtBtI,WAAW,WACc,2CAAjBxC,EAAGuK,KAAK,OAAsDxL,EAAE,4CAA4C2C,OAAOuG,GAAG,aAClHlJ,EAAE,8CAA8C4C,QAAUb,EAAcc,kBACxE7C,EAAE,wCAAwC2C,OAAO2J,QAAQ,KAG7DrL,EAAGiI,GAAGlJ,EAAE,8CACJA,EAAE,4CAA4C2C,OAAOuG,GAAG,YAAclJ,EAAE,wCAAwC2C,OAAOuG,GAAG,YAC1HlJ,EAAE,wCAAwC2C,OAAO4J,UAAU,MAGpE,OAGPvM,EAAE,uCAAuCmK,MAAM,WAC3CnK,EAAE,2EAA2EO,SAEjFP,EAAE,yCAAyCmK,MAAM,WAC7C,IAAkBlI,EAATjC,EAAED,MAAoBmC,SAAUC,EAAQnC,EAAE,wCACnDmC,EAAM5B,OACN,IAAI6B,EAAOpC,EAAEqC,QAAQC,SAAUkK,EAAOxM,EAAEqC,QAAQE,QAC5CkK,EAAQtK,EAAMI,QACdkD,GAD+BtD,EAAMG,SAC/BL,EAAQwD,KAAKE,EAAO1D,EAAQ0D,KAAM+G,EAAUtK,EAAOH,EAAQwD,IAAM,GACvExD,EAAQ0D,KAAO8G,EAAQD,IACvB7G,EAAO1D,EAAQ0D,KAAO8G,GAEtBxK,EAAQwD,IAAMrD,EAAO,KACrBqD,EAAMrD,EAAOH,EAAQwD,KACX,IACNA,EAAM,GAEViH,EAAUzK,EAAQwD,IAAM,IAE5BtD,EAAMgH,KACF1D,IAAOA,EACPE,KAAQA,EACRrD,OAAUoK,IACXxM,OACHkL,aAAaF,KAGjBlL,EAAE,wCAAwCmL,UAAU,WAChDC,aAAaF,KACdtK,KAAK,6BAA6BuJ,MAAM,SAAUtE,GACjD7F,EAAE,8CAA8CkD,KAAKlD,EAAED,MAAMa,KAAK,qCAAqCgC,QAAQ9B,KAAK,QAASd,EAAED,MAAMe,KAAK,UAC1Id,EAAE,iFAAiFO,OACvD,KAAxBP,EAAED,MAAMe,KAAK,SACbd,EAAE,8CAA8Cc,KAAK,OAAQ,KAC7Dd,EAAE,kFAAkFE,QACrD,KAAxBF,EAAED,MAAMe,KAAK,QACpBd,EAAE,8CAA8Cc,KAAK,OAAQ,MAE7Dd,EAAE,8CAA8Cc,KAAK,OAAQ,KAC7Dd,EAAE,iFAAiFgD,GAAG,GAAG9C,OAEvD,aAA9BF,EAAED,MAAMyL,KAAK,eAA8D,gBAA9BxL,EAAED,MAAMyL,KAAK,eAAiE,gBAA9BxL,EAAED,MAAMyL,KAAK,cAC1GxL,EAAE,uFAAuFI,KAAK,OAAQ,QAEtGJ,EAAE,uFAAuFI,KAAK,OAAQ,SAG9GJ,EAAE,wCAAwC2C,OAAO2J,UACjDtM,EAAE,wCAAwCO,SAE9CP,EAAE,4CAA4CuL,GAAG,QAAS,uCAAwC,SAAU1F,GAGxG,OAFA/F,EAAMgC,+BAA+B9B,EAAED,OACvC8F,EAAE8G,mBACK,IAEX3M,EAAE,4CAA4CuL,GAAG,QAAS,yCAA0C,SAAU1F,GAG1G,OAFA/F,EAAMiB,gCAAgCf,EAAED,MAAM4C,QAC9CkD,EAAE8G,mBACK,IAEX3M,EAAE,+CAA+CmK,MAAM,WACnDnK,EAAE,yCAAyCO,OAC3C/C,IACA,IAAIyD,EAAKjB,EAAE,yCAA0C4M,EAAM3L,EAAG4L,cAAeC,EAAM7L,EAAG8L,aAClFC,EAAOhN,EAAEqC,QAAQE,QAAS0K,EAAOjN,EAAEqC,QAAQC,SAC3C4K,EAAalN,EAAEqL,UAAU6B,aAAcC,EAAYnN,EAAEqL,UAAU8B,YACnEnN,EAAE,yCAAyCmJ,KACvCxD,MAASqH,EAAOE,EAAaJ,GAAO,EACpCrH,KAAQwH,EAAOE,EAAYP,GAAO,IACnC1M,OACHJ,EAAMsN,uBAAyBpN,EAAE,uCAAuCkD,OACxElD,EAAE,gDAAgD0C,IAAI5C,EAAMsN,wBAC5DtN,EAAMuN,oCAAqC,IAG/CrN,EAAE,wCAAwCmK,MAAM,WAC5CnK,EAAE,kFAAkFO,OACpFP,EAAE,sFAAsFc,KAAK,YAAa,IAC1Gd,EAAE,2EAA2EO,OAC7EP,EAAE,iFAAiFO,OAAOK,KAAK,SAAS8B,MACxG1C,EAAE,8CAA8Cc,KAAK,OAAQ,KAAKA,KAAK,OAAQ,MAAM8B,KAAKb,EAAcc,kBACxG/C,EAAMyB,gBAAgB,aAAc,MACpCzB,EAAM8B,SAAW9B,EAAMwB,WACvBxB,EAAM+B,sBAEV7B,EAAE,+EAA+EuL,GAAG,QAAS,mDAAoD,SAAU1F,GACvJ,IAAsByH,EAAbtN,EAAE6F,EAAE0H,QAAoBC,QAAQ,+CAAgDrM,EAASmM,EAAMxM,KAAK,SAAUmB,EAAUqL,EAAMpL,SACnIuL,EAAQH,EAAMxM,KAAK,SAAUJ,EAAU4M,EAAMxM,KAAK,WAAY4M,EAAUJ,EAAMxM,KAAK,WAC1E,MAAT2M,IACAA,EAAQ,WAEZ,IAAIE,EAAS,wBAA0BL,EAAM1M,KAAK,mDAAmDE,KAAK,QAAU,YAgBpH,OAfAd,EAAE,qFAAqFa,KAAK,SAAUY,GAClGkM,GAAU,kBAAoBlM,EAAI,KAAOzB,EAAED,MAAMa,KAAK,mDAAmDgC,OAAS,cAEtH5C,EAAE,gDAAgDiD,QAAQC,KAAKyK,GAChD,MAAXjN,IACAA,EAAU,QAEC,MAAXgN,IACAA,EAAU,KAEd1N,EAAE,8CAA8C0C,IAAI+K,GAAO3M,KAAK,QAASK,GACzEnB,EAAE,gDAAgD0C,IAAIhC,GAASI,KAAK,QAASK,GAC7EnB,EAAE,gDAAgD0C,IAAIgL,GAAS5M,KAAK,QAASK,GAC7E9C,EAAmB2B,EAAE,wCAAyCiC,EAAQ0D,KAAO2H,EAAMP,aAAc9K,EAAQwD,IAAM,GAAI,eACnHI,EAAE8G,mBACK,IAEX3M,EAAE,wIAAwIiL,OAAO,WAC7I,IAAIhK,EAAKjB,EAAED,MAAOoB,EAASF,EAAGH,KAAK,SACnCd,EAAE,+EAA+EY,KAAK,+CAA+CC,KAAK,WAClIb,EAAED,MAAMe,KAAK,UAAYK,GACzBnB,EAAED,MAAMe,KAAKG,EAAGuK,KAAK,MAAMoC,QAAQ,uCAAwC,IAAK3M,EAAGyB,SAG3F5C,EAAM+B,sBAEV7B,EAAE,yCAAyCuL,GAAG,QAAS,mDAAoD,SAAU1F,GACjH,IAAsByH,EAAbtN,EAAE6F,EAAE0H,QAAoBC,QAAQ,+CAAgDrM,EAASmM,EAAMxM,KAAK,SAAUmB,EAAUqL,EAAMpL,SAAU2L,EAAUP,EAAMxM,KAAK,WAClKgN,EAAOhO,EAAMiO,gBAAgB5M,EAAO8K,YACzB,MAAX4B,IAEIA,EADQ,OAARC,EACU,MAEA,UAGlB,IAAI3L,EAAQnC,EAAE,gDAMd,OALAmC,EAAMvB,KAAK,6BAA6BL,OACxC4B,EAAMvB,KAAK,sCAAwCiN,EAAU,gCAAgC1E,IAAI,UAAW,UAC5GhH,EAAMrB,KAAK,OAAQwM,GACnBjP,EAAmB8D,EAAOF,EAAQ0D,KAAO2H,EAAMP,aAAc9K,EAAQwD,IAAM,GAAI,eAC/EI,EAAE8G,mBACK,IAEX3M,EAAE,0EAA0EmK,MAAM,WAC9E,IAAImD,EAAQtN,EAAE,gDAAgDc,KAAK,QAC/D+M,EAAU7N,EAAED,MAAMyL,KAAK,WAC3B8B,EAAMxM,KAAK,UAAWd,EAAED,MAAMyL,KAAK,YACnC,IAAIwC,EAAOlO,EAAMmO,eAAeJ,GAAW,IAAMP,EAAMxM,KAAK,QAC5DwM,EAAM9B,KAAK,QAASwC,GAAMpN,KAAK,mDAAmDsC,KAAK8K,GACvFhO,EAAE,gDAAgDO,OAClDT,EAAM+B,sBAEV7B,EAAE,0CAA0CuL,GAAG,QAAS,mDAAoD,SAAU1F,GAClH,IAAsB1E,EAAbnB,EAAE6F,EAAE0H,QAAqBC,QAAQ,+CAA+C1M,KAAK,SAG9F,OAFAhB,EAAMgC,+BAA+B9B,EAAE,sFAAsFgD,GAAG7B,GAAQP,KAAK,wCAC7IiF,EAAE8G,mBACK,IAGX3M,EAAE,wCAAwCmK,MAAM,WAC5C,IACIhJ,EADQnB,EAAE,qCACKc,KAAK,SACpBsC,KAEJpD,EAAE,sFAAsFa,KAAK,WACzF,IAAII,EAAKjB,EAAED,MAAOwD,EAAKtC,EAAGH,KAAK,aAC/B,GAAIG,EAAGH,KAAK,UAAYK,EAAQ,CAC5B,GAAU,MAANoC,GAAoB,IAANA,EACd,OAAO,EAEW,UAAlBvF,EAAWuF,KACXA,EAAKf,KAAKC,MAAMc,IAEpB,IAAK,IAAIC,KAAKD,EACVH,EAAeI,GAAK,KAIhC,IAAInC,EAAIvB,EAAMwB,WACV4M,KACA9M,KACA+M,KACJ,GAAInO,EAAE,4CAA4C2C,OAAOuG,GAAG,aAAelJ,EAAE,wCAAwC2C,OAAOuG,GAAG,YAA+E,QAAjElJ,EAAE,8CAA8Cc,KAAK,SAAoB,CAClN,IAAIG,EAAKjB,EAAE,8CACP8N,EAAO7M,EAAGH,KAAK,QAASoH,EAAQjH,EAAGH,KAAK,SAG5C,GAFAqN,EAAa,MAAIjG,EACjBiG,EAAY,KAAIlN,EAAG2B,OACP,KAARkL,EACAK,EAAY,KAAI,SACb,GAAY,KAARL,EAAa,CACpB,IAAI/K,EAAS/C,EAAE,wFACfmO,EAAY,KAAI,IAChBA,EAAc,OAAIpL,EAAOC,GAAG,GAAGN,MAC/ByL,EAAc,OAAIpL,EAAOC,GAAG,GAAGN,WAE/ByL,EAAY,KAAI,IAChBA,EAAc,OAAInO,EAAE,iFAAiFgD,GAAG,GAAGpC,KAAK,SAAS8B,MAE7H,IAAK,IAAIc,EAAI,EAAGA,EAAInC,EAAEpB,OAAQuD,IAAK,CAC/B,GAAIA,KAAKJ,EACL,SAEJ,GAAY,MAAR/B,EAAEmC,GACF,SAEJ,IAAIM,EAAOzC,EAAEmC,GAAGrC,GAChB,GAAa,YAAT+G,EAEY,MAARpE,GAAiB/E,EAAW+E,EAAKG,KACjC7C,EAAUoC,GAAK,QAEhB,GAAa,cAAT0E,GAEK,MAARpE,GAAgB/E,EAAW+E,EAAKG,MAChC7C,EAAUoC,GAAK,QAEhB,GAAa,eAAT0E,EAAwB,CAE/B,IAAIkG,EAASD,EAAc,OACf,MAARrK,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,GAEgB,GAA3BM,EAAKM,EAAEiI,QAAQ+B,KACfhN,EAAUoC,GAAK,QAGpB,GAAa,kBAAT0E,EAA2B,CAElC,IAAIkG,EAASD,EAAc,OACf,MAARrK,GAAgB/E,EAAW+E,EAAKG,IAE5BH,EAAKM,EAAEiI,QAAQ+B,IAAW,IAC1BhN,EAAUoC,GAAK,QAGpB,GAAa,aAAT0E,EAAsB,CAE7B,IAAIkG,EAASD,EAAc,OAAGE,EAAWD,EAAOnO,OACpC,MAAR6D,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EAEXM,EAAKM,EAAEkK,OAAO,EAAGD,IAAaD,IAC9BhN,EAAUoC,GAAK,QAGpB,GAAa,WAAT0E,EAAoB,CAE3B,IAAIkG,EAASD,EAAc,OAAGE,EAAWD,EAAOnO,OACpC,MAAR6D,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,GAEX6K,EAAWvK,EAAKM,EAAEnE,QAAU6D,EAAKM,EAAEkK,OAAOxK,EAAKM,EAAEnE,OAASoO,EAAUA,IAAaD,KACjFhN,EAAUoC,GAAK,QAGpB,GAAa,aAAT0E,EAAsB,CAE7B,IAAIkG,EAASD,EAAc,OACf,MAARrK,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EAEXM,EAAKM,GAAKgK,IACVhN,EAAUoC,GAAK,QAGpB,GAAa,aAAT0E,EAAsB,CAE7B,IAAIkG,EAASvP,EAASsP,EAAc,QAAG,GAC3B,MAARrK,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EACG,MAAXM,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAC9BuK,SAASzK,EAAKG,IAAMmK,IACpBhN,EAAUoC,GAAK,GAGnBpC,EAAUoC,GAAK,OAEhB,GAAa,gBAAT0E,EAAyB,CAEhC,IAAIkG,EAASvP,EAASsP,EAAc,QAAG,GAC3B,MAARrK,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EACG,MAAXM,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAC9BuK,SAASzK,EAAKG,IAAMmK,IACpBhN,EAAUoC,GAAK,GAGnBpC,EAAUoC,GAAK,OAEhB,GAAa,gBAAT0E,EAAyB,CAEhC,IAAIkG,EAASvP,EAASsP,EAAc,QAAG,GAC3B,MAARrK,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EACG,MAAXM,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAC9BuK,SAASzK,EAAKG,IAAMmK,IACpBhN,EAAUoC,GAAK,GAGnBpC,EAAUoC,GAAK,OAEhB,GAAa,YAAT0E,EAAqB,CAE5B,IAAIkG,EAASI,WAAWL,EAAc,QAC1B,MAARrK,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EACG,MAAXM,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAC9BF,EAAKG,GAAKmK,IACVhN,EAAUoC,GAAK,GAGnBpC,EAAUoC,GAAK,OAEhB,GAAa,iBAAT0E,EAA0B,CAEjC,IAAIkG,EAASI,WAAWL,EAAc,QAC1B,MAARrK,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EACG,MAAXM,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAC9BF,EAAKG,EAAImK,IACThN,EAAUoC,GAAK,GAGnBpC,EAAUoC,GAAK,OAEhB,GAAa,YAAT0E,EAAqB,CAE5B,IAAIkG,EAASI,WAAWL,EAAc,QAC1B,MAARrK,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EACG,MAAXM,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAC9BF,EAAKG,GAAKmK,IACVhN,EAAUoC,GAAK,GAGnBpC,EAAUoC,GAAK,OAEhB,GAAa,iBAAT0E,EAA0B,CAEjC,IAAIkG,EAASI,WAAWL,EAAc,QAC1B,MAARrK,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EACG,MAAXM,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAC9BF,EAAKG,EAAImK,IACThN,EAAUoC,GAAK,GAGnBpC,EAAUoC,GAAK,OAEhB,GAAa,SAAT0E,EAAkB,CAEzB,IAAIkG,EAASI,WAAWL,EAAc,QAC1B,MAARrK,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EACG,MAAXM,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAC9BF,EAAKG,GAAKmK,IACVhN,EAAUoC,GAAK,GAGnBpC,EAAUoC,GAAK,OAEhB,GAAa,WAAT0E,EAAoB,CAE3B,IAAIkG,EAASI,WAAWL,EAAc,QAC1B,MAARrK,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EACG,MAAXM,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAC9BF,EAAKG,GAAKmK,IACVhN,EAAUoC,GAAK,GAGnBpC,EAAUoC,GAAK,OAEhB,GAAa,WAAT0E,EAAoB,CAE3B,IACIuG,EAAKC,EADLN,EAASI,WAAWL,EAAc,QAAIQ,EAASH,WAAWL,EAAc,QAExEC,EAASO,GACTF,EAAML,EACNM,EAAMC,IAEND,EAAMN,EACNK,EAAME,GAEE,MAAR7K,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EACG,MAAXM,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,GAC9BF,EAAKG,EAAIwK,GAAO3K,EAAKG,EAAIyK,KACzBtN,EAAUoC,GAAK,GAGnBpC,EAAUoC,GAAK,OAEhB,GAAa,aAAT0E,EAAsB,CAE7B,IACIuG,EAAKC,EADLN,EAASI,WAAWL,EAAc,QAAIQ,EAASH,WAAWL,EAAc,QAExEC,EAASO,GACTF,EAAML,EACNM,EAAMC,IAEND,EAAMN,EACNK,EAAME,GAEE,MAAR7K,GAAgB/E,EAAW+E,EAAKG,GAChC7C,EAAUoC,GAAK,EACG,MAAXM,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAC9BF,EAAKG,GAAKwK,GAAO3K,EAAKG,GAAKyK,IAC3BtN,EAAUoC,GAAK,GAGnBpC,EAAUoC,GAAK,QAIxB,CACHxD,EAAE,+EAA+Ea,KAAK,SAAUY,EAAGoE,GAC/F,GAAI7F,EAAE6F,GAAGqD,GAAG,aAAelJ,EAAE6F,GAAGqD,GAAG,YAC/B,OAAO,EAEX,GAAIlJ,EAAE6F,GAAG2H,QAAQ,QAAQvN,OAAS,EAAG,CACjC,IAAIiM,EAAMlM,EAAE6F,GAAGsG,SAAS,SAASvJ,OAC7BoC,OAAOkH,GAAO,KACdA,EAAM,IAAMA,GAEhB,IAAIE,EAAQpM,EAAE6F,GAAG2H,QAAQ,aAAa5M,KAAK,gBAAgBgC,OAAOgL,QAAQ7L,EAAckD,iBAAkB,IACtGD,OAAOoH,GAAS,KAChBA,EAAQ,IAAMA,GAElB,IAAIwC,EAAO5O,EAAE6F,GAAG2H,QAAQ,YAAY5M,KAAK,eAAegC,OAAOgL,QAAQ7L,EAAcmD,gBAAiB,IAClG2J,EAAQ9M,EAAc+M,oBAAsB,QAAUF,EAAO,IAAMxC,EAAQ,IAAMF,EACrFgC,EAAWW,GAAS,IAExB,GAAI7O,EAAE6F,GAAG2H,QAAQ,YAAYvN,OAAS,EAAG,CACrC,IAAI4O,EAAQ7O,EAAE6F,GAAG2H,QAAQ,YAAY1M,KAAK,UAC1CoN,EAAWW,GAAS,OAG5B,IAAK,IAAIrL,EAAI,EAAGA,EAAInC,EAAEpB,OAAQuD,IAAK,CAC/B,GAAIA,KAAKJ,EACL,SAEJ,GAAY,MAAR/B,EAAEmC,GACF,SAEJ,IACI0E,EADApE,EAAOzC,EAAEmC,GAAGrC,GAEhB,GAAY,MAAR2C,GAAgB/E,EAAW+E,EAAKG,GAChCiE,EAAQ,qBACL,GAAe,MAAXpE,EAAKC,IAA2B,KAAbD,EAAKC,GAAGC,EAAU,CAC5C,IAAI+K,EAAMjQ,EAAO,aAAcgF,EAAKG,GACpCiE,EAAQnG,EAAc+M,oBAAsB,QAAUC,OAEtD7G,EAAQpE,EAAKG,EAAI,QAAUH,EAAKM,EAEhC8D,KAASgG,IACT9M,EAAUoC,GAAK,IAI3B,IAAIwL,EAAOhP,EAAE,sFAAsFgD,GAAG7B,GAClGnB,EAAE,+FAA+FC,OAASD,EAAE,uFAAuFC,QAAUD,EAAE,8CAA8C0C,MAAMzC,OAAS,GAAKD,EAAE,4CAA4C2C,OAAOuG,GAAG,aAAelJ,EAAE,wCAAwC2C,OAAOuG,GAAG,YAA+E,QAAjElJ,EAAE,8CAA8Cc,KAAK,UAC/ckO,EAAKlO,KAAK,YAAa0B,KAAK8B,UAAUlD,IAAYR,KAAK,yCAAyCV,OAChGJ,EAAMyB,gBAAgB,YAAaH,EAAWD,GACjC,MAATgN,IACAa,EAAKlO,KAAK,mBAAoBqN,EAAa,OAAGrN,KAAK,kBAAmBqN,EAAY,MAAGrN,KAAK,kBAAmBqN,EAAY,MAClG,MAAnBA,EAAc,QACda,EAAKlO,KAAK,oBAAqBqN,EAAc,QAE1B,MAAnBA,EAAc,QACda,EAAKlO,KAAK,oBAAqBqN,EAAc,QAEjDrO,EAAMyB,gBAAgB,QAAS4M,EAAOhN,MAG1C6N,EAAKlO,KAAK,YAAa,IAAIF,KAAK,yCAAyCL,OACzET,EAAMyB,gBAAgB,YAAa,KAAMJ,IAE7C,IAAIK,KACJ,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAEpB,OAAQwB,IACtBA,KAAKL,GAAaK,KAAK2B,GAG3B5B,EAAQE,QAAQC,OAAON,EAAEI,KAE7B3B,EAAM8B,SAAWJ,EACjB1B,EAAM+B,oBACN7B,EAAE,2EAA2EO,OAC7EvD,MAEJgD,EAAE,iJAAiJmK,MAAM,WACrJnK,EAAE,yCAAyCE,OAC3C1C,IACAwC,EAAE,kEAAkEE,OACpEF,EAAE,yCAAyCO,OAC3C7C,EAAMuR,YAAYnP,EAAM6J,iBACxB7J,EAAMuN,oCAAqC,EAC3CrQ,MAEJgD,EAAE,4CAA4CmK,MAAM,WAChD,IAAIpH,EAAS/C,EAAE,gDAAiD0C,EAAMK,EAAOL,MAC7E,GAA0B,GAAtB1C,EAAEkP,KAAKxM,GAAKzC,QAAeD,EAAEkP,KAAKxM,GAAKyM,eAAiBrP,EAAMsN,uBAAuB+B,cAGrF,OAFApM,EAAOL,IAAI5C,EAAMsN,6BACjBpN,EAAE,qEAAqEmK,QAEpE,CACH,IAAIiF,EAAO1M,EAAIyB,MAAM,KACjBkL,EAAW,GAAIC,EAAW,GAAIC,GAAc,EAChD,GAAIH,EAAKnP,OAAS,EAAG,CACjBoP,EAAWD,EAAK,GAChBE,EAAWF,EAAK,GAChB,IAAK,IAAI3N,KAAK/D,EAAMwJ,eAChB,GAAImI,GAAY3R,EAAMwJ,eAAezF,GAAGuM,KAAM,CAC1CuB,EAAa7R,EAAMwJ,eAAezF,GAAGd,MACrC,OAGW,GAAf4O,IACAA,EAAa,OAEd,CACH,IAAI5O,EAAQ9C,EAAcH,EAAMsI,mBAChCqJ,EAAW3R,EAAMwJ,eAAevG,GAAOqN,KACvCuB,EAAa7R,EAAMwJ,eAAevG,GAAOA,MACzC2O,EAAWF,EAAK,GAEpB,GAAI1R,EAAMwJ,eAAerJ,EAAc0R,IAAazG,aAOhD,OANI9J,IACAmH,MAAMF,EAAkBuJ,wBAExBzS,EAAQuJ,KAAK,GAAIL,EAAkBuJ,6BAEvCzM,EAAOL,IAAI5C,EAAMsN,wBAGrB,IAA8B,GAA1BkC,EAASjD,QAAQ,KAOjB,OANIrN,IACAmH,MAAMF,EAAkBwJ,qBAExB1S,EAAQuJ,KAAK,GAAIL,EAAkBwJ,0BAEvC1M,EAAOL,IAAI5C,EAAMsN,wBAGrBkC,EAAWA,EAASnL,MAAM,KAC1B,IAAIqC,KAAUkJ,KAGd,GAFAlJ,EAAI,GAAK+H,SAASe,EAAS,GAAG1B,QAAQ,UAAW,KAAO,EACxDpH,EAAI,GAAK+H,SAASe,EAAS,GAAG1B,QAAQ,UAAW,KAAO,EACpDpH,EAAI,GAAKA,EAAI,GAOb,OANIxH,IACAmH,MAAMF,EAAkBwJ,qBAExB1S,EAAQuJ,KAAK,GAAIL,EAAkBwJ,0BAEvC1M,EAAOL,IAAI5C,EAAMsN,wBAKrB,GAFAsC,EAAI,GAAKzR,EAASqR,EAAS,GAAG1B,QAAQ,aAAc,KACpD8B,EAAI,GAAKzR,EAASqR,EAAS,GAAG1B,QAAQ,aAAc,KAChD8B,EAAI,GAAKA,EAAI,GAOb,OANI1Q,IACAmH,MAAMF,EAAkBwJ,qBAExB1S,EAAQuJ,KAAKL,EAAkBwJ,0BAEnC1M,EAAOL,IAAI5C,EAAMsN,wBAGrB1P,EAAMuR,YAAYnP,EAAM6J,iBACxB7J,EAAMyB,gBAAgB,qBAClBiF,IAAOA,EACPC,OAAUiJ,IAEd5P,EAAMyB,gBAAgB,sBAAuBgO,GAC7CzP,EAAMgH,YAAYhH,EAAM6J,gBAAiB4F,GACrC/I,IAAOA,EACPC,OAAUiJ,IAEd5P,EAAMiH,qBACN/G,EAAE,uCAAuCkD,KAAKR,GAC9C1C,EAAE,yCAAyCE,OAC3CF,EAAE,yCAAyCO,OAC3CT,EAAMuN,oCAAqC,EAC3CvN,EAAM+B,oBACNrE,IACAR,OAGRgD,EAAE,yCAAyCuL,GAAG,YAAa,qFAAsF,SAAU1F,GACvJ,IAAI8J,EAAO3P,EAAE6F,EAAE0H,QACfzN,EAAM8P,WAAY,EAClB9P,EAAM+P,SAASpP,IAAMkP,EAAKzO,SAC1BpB,EAAM+P,SAAS7B,KAAO2B,EAAK7O,KAAK,QAChChB,EAAM+P,SAASC,YAAcH,EAAKzO,SAASA,SAASsK,KAAK,MACzD1L,EAAM+P,SAASlP,MAAQgP,EAAK7O,KAAK,SAC6B,GAA1Dd,EAAE,8CAA8CC,QAChDD,EAAE,QAAQkK,OAAO,uDAAyDpK,EAAM+P,SAAS7B,KAAO,UAEpGlO,EAAM+P,SAAStN,MAAQvC,EAAE,8CAA8C+M,aACvEjN,EAAM+P,SAASvN,OAAStC,EAAE,8CAA8C6M,cACxE7M,EAAE,wMAAwMmJ,IAAI,SAAU,aAE5NnJ,EAAE,8JAA8J+P,UAAU,SAAUlK,GAChL,GAAI/F,EAAM8P,UAAW,CACoB,GAAjC9P,EAAMkQ,iBAAiB/P,SACvBH,EAAMkQ,kBAAoB,GAC1BhQ,EAAED,MAAMa,KAAK,+CAA+CC,KAAK,SAAUY,GACvE,IAAkBwO,EAATjQ,EAAED,MAAc8M,cACzB/M,EAAMkQ,iBAAiBtO,KAAK5B,EAAMkQ,iBAAiBvO,GAAKwO,EAAI,KAEhEjQ,EAAED,MAAMmK,OAAO,mLAEnBlK,EAAE,8CAA8CmJ,KAC5C+G,WAAc,UACdC,MAAS,OACTC,OAAU,sBAENpE,MAAMqE,MAAd,IAAqBnM,EAAI8H,MAAMsE,MAAOC,EAAavQ,EAAED,MACjDyQ,EAAStM,EAAIqM,EAAWrO,SAASuD,IAAM8K,EAAWpD,YAClDsD,EAAW3Q,EAAMkQ,iBACjBrH,EAAYxJ,EAAuBsR,EAAUD,IAC/B,GAAd7H,EACA3I,EAAE,8CAA8CmJ,KAAM1D,IAAOgL,EAASA,EAASxQ,OAAS,KACjFuQ,EAASC,EAAS9H,EAAY,IAAM8H,EAAS9H,GAAa8H,EAAS9H,EAAY,IAAM,EAC5F3I,EAAE,8CAA8CmJ,KAAM1D,IAAOgL,EAAS9H,KAEtE3I,EAAE,8CAA8CmJ,KAAM1D,IAAOgL,EAAS9H,EAAY,QAG3F+H,WAAW,WACN5Q,EAAM8P,YACN5P,EAAE,8CAA8CmJ,KAC5C+G,WAAc,OACdC,MAAS,OACTC,OAAU,oBAEdtQ,EAAMkQ,oBACNhQ,EAAE,8CAA8C8K,YAErD6F,QAAQ,SAAU9K,GACjB,GAAI/F,EAAM8P,UAAW,CACjB,IACIgB,EADA3P,EAAKjB,EAAED,MAEX,GAAID,EAAM+P,SAASC,aAAe7O,EAAGuK,KAAK,MACtCoF,EAAW9Q,EAAM+P,SAASpP,IAAIoQ,YAC3B,CACH,IAAI7C,EAAOlO,EAAM+P,SAAS7B,KAAMH,EAAU,GAAIiD,EAAY,GAC1D,GAAqB,wCAAjB7P,EAAGuK,KAAK,MAAiD,CAE7C,OADD1L,EAAMiO,gBAAgBjO,EAAM+P,SAASlP,MAAMsL,aAElD+B,EAAO/H,EAAkB8K,mBAAqB,IAAM/C,EACpDH,EAAU,qBACViD,EAAY,uBAEZ9C,EAAO/H,EAAkB+K,sBAAwB,IAAMhD,EACvDH,EAAU,wBACViD,EAAY,sBAEhB9Q,EAAE,yCAAyCY,KAAK,+CAA+CC,KAAK,WAChG,GAAIb,EAAED,MAAMa,KAAK,mDAAmDgC,QAAUoL,EAAM,CAChF,IAAIiD,EAAKzC,WAAWxO,EAAED,MAAMe,KAAK,cAAgB,EAGjD,OAFAkN,GAAciD,EAAGhF,WACjBjM,EAAED,MAAMe,KAAK,YAAamQ,IACnB,KAInBL,EAAW,eAAiB5C,EAAO,wDAA0D8C,EAAY,IAAMjD,EAAU,gBAAkB/N,EAAM+P,SAASlP,MAAQ,gBAAkBb,EAAM+P,SAAS7B,KAAO,iEAAmE8C,EAAY,IAAMjD,EAAU,gBAAkB/N,EAAM+P,SAASlP,MAAQ,gBAAkBb,EAAM+P,SAAS7B,KAAO,KAAOA,EAAO,oIAEpYhC,MAAMqE,MAAd,IAAqBnM,EAAI8H,MAAMsE,MAAOC,EAAavQ,EAAED,MACjDyQ,EAAStM,EAAIqM,EAAWrO,SAASuD,IAAM8K,EAAWpD,YAClDsD,EAAW3Q,EAAMkQ,iBACjBrH,EAAYxJ,EAAuBsR,EAAUD,IACf,2CAA9B1Q,EAAM+P,SAASC,aAA0F,wCAA9BhQ,EAAM+P,SAASC,aAAyDhQ,EAAM+P,SAASC,aAAe7O,EAAGuK,KAAK,QACzLxL,EAAE,uHAAuHY,KAAK,+CAA+CC,KAAK,WAC1Kb,EAAED,MAAMe,KAAK,UAAYhB,EAAM+P,SAASlP,OACxCX,EAAED,MAAM+K,YAIF,GAAdnC,EACqE,GAAjE1H,EAAGL,KAAK,+CAA+CX,OACvDgB,EAAGiJ,OAAO0G,GAEV3P,EAAGL,KAAK,+CAA+CsQ,OAAOC,MAAMP,GAEjEJ,EAASC,EAAS9H,EAAY,IAAM8H,EAAS9H,GAAa8H,EAAS9H,EAAY,IAAM,EAC5F1H,EAAGL,KAAK,+CAA+CoC,GAAG2F,EAAY,GAAGwI,MAAMP,GAE/E3P,EAAGL,KAAK,+CAA+CoC,GAAG2F,EAAY,GAAGyI,OAAOR,GAElD,2CAA9B9Q,EAAM+P,SAASC,aACsB,wCAA9BhQ,EAAM+P,SAASC,aAAyDhQ,EAAM+P,SAASC,aAAe7O,EAAGuK,KAAK,OAErH1L,EAAM+P,SAASpP,IAAIqK,SAEvB9K,EAAE,4CAA4CY,KAAK,6CAA6CC,KAAK,WACjG,IAAIwQ,EAAWrR,EAAED,MAAMa,KAAK,yCACxBZ,EAAED,MAAMe,KAAK,UAAYhB,EAAM+P,SAASlP,OAAsC,GAA7B0Q,EAASzQ,KAAK,KAAKX,QACpEoR,EAASnH,OAAO,6DAGxBpK,EAAM+B,oBACN7B,EAAE,8CAA8C8K,SAChDhL,EAAM8P,WAAY,EAClB5P,EAAE,wMAAwMmJ,IAAI,SAAU,WACxNrJ,EAAMkQ,oBACNhQ,EAAE,8CAA8C8K,SAChDhL,EAAMD,kBACNgG,EAAE8G,qBAGV3M,EAAE,4CAA4CuL,GAAG,QAAS,wCAAyC,WAC/F,IAAItK,EAAKjB,EAAED,MAAOuN,EAAQrM,EAAGC,SAAUP,EAAQ2M,EAAMxM,KAAK,SAAUkN,EAAOV,EAAMxM,KAAK,QACtF,GAA2B,GAAvBG,EAAGL,KAAK,KAAKX,OAAa,CAE1B,IAAoD2Q,EACpD,GAFA3P,EAAGiJ,OAAO,2DAEE,OADDpK,EAAMiO,gBAAgBpN,EAAMsL,YAEnC2E,EAAW,eAAiB5C,EAAO,0GAA4GrN,EAAQ,gBAAkBqN,EAAO,mHAAqHrN,EAAQ,gBAAkBqN,EAAO,QAAUA,EAAO,oIACvVhO,EAAE,yCAAyCkK,OAAO0G,OAC/C,CACHA,EAAW,eAAiB5C,EAAO,oEAAsErN,EAAQ,gBAAkBqN,EAAO,6EAA+ErN,EAAQ,gBAAkBqN,EAAO,KAAOA,EAAO,oIACxQ,IAAIsD,EAAUtR,EAAE,0CAA2CuR,EAAOvR,EAAE,uCAChEwR,EAAaF,EAAQ1Q,KAAK,+CAAgD6Q,EAAUF,EAAK3Q,KAAK,+CAC9F4Q,EAAWvR,OAAS,EACpBqR,EAAQpH,OAAO0G,GACRa,EAAQxR,OAAS,EACxBsR,EAAKrH,OAAO0G,GAEZU,EAAQpH,OAAO0G,SAIvB3P,EAAGL,KAAK,KAAKkK,SACb9K,EAAE,8JAA8JY,KAAK,+CAA+CC,KAAK,WACjNb,EAAED,MAAMe,KAAK,UAAYH,IACU,wCAA/BX,EAAED,MAAMmB,SAASsK,KAAK,OACtB1L,EAAMU,aAAaR,EAAED,OAEzBC,EAAED,MAAM+K,YAIpBhL,EAAM+B,oBACN/B,EAAMD,oBAEVG,EAAE,2CAA2CmK,MAAM,WAC/CnK,EAAE,8JAA8JY,KAAK,+CAA+CC,KAAK,WACrNb,EAAED,MAAM+K,WAEZ9K,EAAE,4CAA4CY,KAAK,6CAA6CC,KAAK,WACjGb,EAAED,MAAMa,KAAK,yCAAyCA,KAAK,KAAKkK,WAEpEhL,EAAM+B,oBACN/B,EAAMD,oBAGC,MAAXgK,IACAA,GAAU,GAEV/J,EAAM8B,SAAS3B,QAAU,GAAKH,EAAM8B,SAAS,GAAG3B,QAAU,IACtDjB,IACAmH,MAAMF,EAAkByL,oBAExB3U,EAAQuJ,KAAK,GAAIL,EAAkByL,qBAG3C,IAAIC,EAAe,GAAIC,EAAoB,EAAGC,KAAuBC,EAAwB,EAC7F,IAAK,IAAIrQ,EAAI,EAAGA,EAAI3B,EAAM8B,SAAS,GAAG3B,OAAQwB,IAAK,CAC/C,IAAIuM,EAMQ,OAJRA,EADElO,EAAM8B,SAAS,GAAGH,IAAQ3B,EAAM8B,SAAS,GAAGH,GAAM,EAC7C3B,EAAM8B,SAAS,GAAGH,GAAM,EAExBlD,EAAa,EAAGkD,EAAG3B,EAAM8B,aAGhCoM,EAAOA,EAAK/B,YAEJ,MAAR+B,GAAkD,GAAlChO,EAAEkP,KAAKlB,EAAK/B,YAAYhM,SACxC+N,EAAO/H,EAAkB8L,YAAc,IAAMD,GAEjDA,IACI9D,KAAQ6D,IACR7D,GAAc4D,OACFC,IACR7D,GAAc4D,OACFC,IACR7D,GAAc4D,KAI1BC,EAAiB7D,GAAQ,EACzB,IAAIgE,EAAY,GAAIC,EAAQ,GAC5B,GAAIpI,GAA+B,MAApB/J,EAAMoS,YACqB,MAAlCpS,EAAMoS,WAAWzQ,EAAEwK,YAAqB,CACxC,IAAIkG,EAAUrS,EAAMoS,WAAWzQ,EAAEwK,YAOjC,GANyB,MAArBkG,EAAQ/Q,YACR4Q,GAAa,mBAAqBxP,KAAK8B,UAAU6N,EAAQ/Q,WAAa,KAElD,MAApB+Q,EAAQC,WACRJ,GAAa,kBAAoBxP,KAAK8B,UAAU6N,EAAQC,UAAY,KAEnD,MAAjBD,EAAQhE,MAAe,CACvB,IAAIkE,EAAWF,EAAQhE,MACD,MAAlBkE,EAASnK,QACT8J,GAAa,0BAA4BK,EAASnK,MAAQ,KAEzC,MAAjBmK,EAASvE,OACTkE,GAAa,yBAA2BK,EAASvE,KAAO,KAEvC,MAAjBuE,EAASzP,OACToP,GAAa,yBAA2BK,EAASzP,KAAO,KAErC,MAAnByP,EAASjE,SACT4D,GAAa,2BAA6BK,EAASjE,OAAS,KAEzC,MAAnBiE,EAAS1D,SACTqD,GAAa,2BAA6BK,EAAS1D,OAAS,MAKxEqD,EAAU/R,OAAS,IACnBgS,EAAQ,kBAEZN,GAAgB,yDAA2DK,EAAY,gBAAkBvQ,EAAI,gBAAkBuM,EAAO,iBAAmB/H,EAAkBqM,eAAiB,+EAAiFrM,EAAkBsM,gBAAkB,8CAAgDP,EAAY,gBAAkBvQ,EAAI,gBAAkBuM,EAAO,KAAOA,EAAO,qBAAuB/H,EAAkBuM,uBAAyB,yDAA2DP,EAAQ,gJAAkJhM,EAAkBwM,kBAAoB,8GAO3uB,GALAzS,EAAE,4CAA4CkD,KAAKyO,GACnD3R,EAAE,wCAAwCO,OAC1CP,EAAE,oCAAoCI,KAAK,WAAW,GACtDJ,EAAE,qCAAqCI,KAAK,WAAW,GACvDJ,EAAE,8JAA8JiD,QAC5J4G,EAAS,CACT,GAAoB,MAAhB/J,EAAMkC,QAAkBlC,EAAMkC,OAAO/B,OAAS,EAC9C,IAAK,IAAIwB,EAAI,EAAGA,EAAI3B,EAAMkC,OAAO/B,OAAQwB,IAAK,CAC1C,IAAI4C,EAAOvE,EAAMkC,OAAOP,GACpBmP,EAAW,eAAiB5C,KAAO,oEAAsE3J,EAAK1D,MAAQ,gBAAkB0D,EAAK2J,KAAO,6EAA+E3J,EAAK1D,MAAQ,gBAAkB0D,EAAK2J,KAAO,KAAO3J,EAAK2J,KAAO,oIACrShO,EAAE,0CAA0CkK,OAAO0G,GACnD,IAAIS,EAAWrR,EAAE,sFAAsFgD,GAAGqB,EAAK1D,OAAOC,KAAK,yCAC1F,GAA7ByQ,EAASzQ,KAAK,KAAKX,QACnBoR,EAASnH,OAAO,2DAI5B,GAAiB,MAAbpK,EAAM0G,KAAe1G,EAAM0G,IAAIvG,OAAS,EACxC,IAAK,IAAIwB,EAAI,EAAGA,EAAI3B,EAAM0G,IAAIvG,OAAQwB,IAAK,CACvC,IAAI4C,EAAOvE,EAAM0G,IAAI/E,GACjBiR,EAAW,GACG,MAAdrO,EAAKoJ,QACLiF,GAAY,iBAAmBrO,EAAKoJ,MAAQ,KAE5B,MAAhBpJ,EAAK3D,UACLgS,GAAY,mBAAqBrO,EAAK3D,QAAU,KAElC,MAAd2D,EAAKoJ,QACLiF,GAAY,mBAAqBrO,EAAKqJ,QAAU,KAEpD,IAAIkD,EAAW,eAAiB5C,KAAO,wDAA0D0E,EAAW,gBAAkBrO,EAAK1D,MAAQ,gBAAkB0D,EAAK2J,KAAO,iEAAmE0E,EAAW,gBAAkBrO,EAAK1D,MAAQ,gBAAkB0D,EAAK2J,KAAO,KAAO3J,EAAK2J,KAAO,oIACvUhO,EAAE,uCAAuCkK,OAAO0G,GAChD,IAAIS,EAAWrR,EAAE,sFAAsFgD,GAAGqB,EAAK1D,OAAOC,KAAK,yCAC1F,GAA7ByQ,EAASzQ,KAAK,KAAKX,QACnBoR,EAASnH,OAAO,2DAI5B,GAAoB,MAAhBpK,EAAM2G,QAAkB3G,EAAM2G,OAAOxG,OAAS,EAC9C,IAAK,IAAIwB,EAAI,EAAGA,EAAI3B,EAAM2G,OAAOxG,OAAQwB,IAAK,CAC1C,IAAI4C,EAAOvE,EAAM2G,OAAOhF,GACpBiR,EAAW,GACG,MAAdrO,EAAKoJ,QACLiF,GAAY,iBAAmBrO,EAAKoJ,MAAQ,KAE5B,MAAhBpJ,EAAK3D,UACLgS,GAAY,mBAAqBrO,EAAK3D,QAAU,KAElC,MAAd2D,EAAKoJ,QACLiF,GAAY,mBAAqBrO,EAAKqJ,QAAU,KAEpD,IAAIkD,EAAW,eAAiB5C,KAAO,wDAA0D0E,EAAW,gBAAkBrO,EAAK1D,MAAQ,gBAAkB0D,EAAK2J,KAAO,iEAAmE0E,EAAW,gBAAkBrO,EAAK1D,MAAQ,gBAAkB0D,EAAK2J,KAAO,KAAO3J,EAAK2J,KAAO,oIACvUhO,EAAE,0CAA0CkK,OAAO0G,GACnD,IAAIS,EAAWrR,EAAE,sFAAsFgD,GAAGqB,EAAK1D,OAAOC,KAAK,yCAC1F,GAA7ByQ,EAASzQ,KAAK,KAAKX,QACnBoR,EAASnH,OAAO,2DAI5B,GAAoB,MAAhBpK,EAAM6H,QAAkB7H,EAAM6H,OAAO1H,OAAS,EAAG,CACjD,IAAK,IAAIwB,EAAI,EAAGA,EAAI3B,EAAM6H,OAAO1H,OAAQwB,IAAK,CAC1C,IAAI4C,EAAOvE,EAAM6H,OAAOlG,GACpBiR,EAAW,GACK,MAAhBrO,EAAKwJ,UACL6E,GAAY,mBAAqBrO,EAAKwJ,QAAU,KAE9B,MAAlBxJ,EAAKyM,YACL4B,GAAY,qBAAuBrO,EAAKyM,UAAY,KAExD,IAAIF,EAAW,eAAiB5C,KAAO,wDAA0D0E,EAAW,gBAAkBrO,EAAK1D,MAAQ,gBAAkB0D,EAAK2J,KAAO,iEAAmE0E,EAAW,gBAAkBrO,EAAK1D,MAAQ,gBAAkB0D,EAAK2J,KAAO,KAAOlO,EAAMmO,eAAe5J,EAAKwJ,SAAW,IAAMxJ,EAAK2J,KAAO,oIAClXhO,EAAE,yCAAyCkK,OAAO0G,GAClD,IAAIS,EAAWrR,EAAE,sFAAsFgD,GAAGqB,EAAK1D,OAAOC,KAAK,yCAC1F,GAA7ByQ,EAASzQ,KAAK,KAAKX,QACnBoR,EAASnH,OAAO,2DAGpBpK,EAAM6H,OAAO1H,QAAU,IACvBD,EAAE,wCAAwCE,OACpB,UAAlBJ,EAAMK,UACNH,EAAE,oCAAoCI,KAAK,WAAW,GACtDJ,EAAE,qFAAqFK,SAAS,mBAChGL,EAAE,qCAAqCI,KAAK,WAAW,GACvDJ,EAAE,sFAAsFM,YAAY,qBAEpGN,EAAE,qCAAqCI,KAAK,WAAW,GACvDJ,EAAE,sFAAsFK,SAAS,mBACjGL,EAAE,oCAAoCI,KAAK,WAAW,GACtDJ,EAAE,qFAAqFM,YAAY,sBAKnHN,EAAE,uCAAuCkD,KAAKpF,EAAYgC,EAAMmH,oBAAqBnH,EAAM6S,oBAC3F3S,EAAE,yCAAyCE,OAC3C1C,GAAmB,IAEvBoV,UAAW,SAAUjK,EAAWC,GAC5B,IAAKlJ,EAA+BhC,EAAMsI,kBAAmB,wBACzD,OAEJ,IAAIlG,EAAQC,KAERsB,GADOvB,EAAM2J,WAAWd,GAAWC,GAC/B5I,EAAE4G,QAAO,KAAUrJ,EAAOqK,WAClC,MAAMkC,EAAUnM,IACVoE,EAAgB+H,EAAQ9H,OACxBiE,EAAoB6D,EAAQ5D,WAClC,IAAI4L,EAAwB,EAC5B,IAAK,IAAIrQ,EAAI,EAAGA,EAAI3B,EAAM8B,SAAS,GAAG3B,OAAQwB,IAAK,CAC/C,IAAIuM,EAMQ,OAJRA,EADElO,EAAM8B,SAAS,GAAGH,IAAQ3B,EAAM8B,SAAS,GAAGH,GAAM,EAC7C3B,EAAM8B,SAAS,GAAGH,GAAM,EAExBlD,EAAa,EAAGkD,EAAG3B,EAAM8B,aAGhCoM,EAAOA,EAAK/B,YAEJ,MAAR+B,GAAkD,GAAlChO,EAAEkP,KAAKlB,EAAK/B,YAAYhM,SACxC+N,EAAO/H,EAAkB8L,YAAc,IAAMD,GAEjDA,IACAzQ,EAAE,GAAGI,GAAKuM,EAEd,IAAIvN,KAEJ,GAAiB,MAAbX,EAAM0G,KAAe1G,EAAM0G,IAAIvG,OAAS,EACxC,IAAK,IAAI4S,EAAI,EAAGA,EAAI/S,EAAM0G,IAAIvG,OAAQ4S,IAClCpS,EAAIX,EAAM0G,IAAIqM,GAAU,OAAK/S,EAAM2J,WAAWd,GAAWkK,GAIjE,GAAoB,MAAhB/S,EAAM2G,QAAkB3G,EAAM2G,OAAOxG,OAAS,EAC9C,IAAK,IAAI6S,EAAI,EAAGA,EAAIhT,EAAM2G,OAAOxG,OAAQ6S,IACrCrS,EAAIX,EAAM2G,OAAOqM,GAAU,OAAKhT,EAAM2J,WAAWqJ,GAAGlK,GAG5D,IAAImK,KACJ,IAAK,IAAIC,EAAI,EAAGA,EAAIlT,EAAM8B,SAAS3B,OAAQ+S,IAAK,CAC5C,IAAIC,GAAU,EACd,IAAK,IAAI3N,KAAK7E,EAAK,CACf,IAAIyH,EAWJ,IAJIA,EADS,OAJTA,EADEpI,EAAM8B,SAASoR,GAAG1N,IAAQxF,EAAM8B,SAASoR,GAAG1N,GAAM,EAC5CxF,EAAM8B,SAASoR,GAAG1N,GAAM,EAExB/G,EAAayU,EAAG1N,EAAGxF,EAAM8B,WAGzBsG,EAAM+D,WAENlK,EAAcyD,aAEb/E,EAAI6E,GAAI,CACjB2N,GAAU,EACV,OAGJA,GACAF,EAAOrR,KAAKsR,GAGpB,IAAK,IAAIxP,EAAI,EAAGA,EAAIuP,EAAO9S,OAAQuD,IAC/B,IAAK,IAAIyE,EAAI,EAAGA,EAAInI,EAAM8B,SAAS,GAAG3B,OAAQgI,IAAK,CAC/C,IAAIC,EAOAA,EADS,OAJTA,EADEpI,EAAM8B,SAASmR,EAAOvP,IAAIyE,IAAQnI,EAAM8B,SAASmR,EAAOvP,IAAIyE,GAAM,EAC5DnI,EAAM8B,SAASmR,EAAOvP,IAAIyE,GAAM,EAEhC1J,EAAawU,EAAOvP,GAAIyE,EAAGnI,EAAM8B,WAGjCsG,EAAM+D,WAEN,GAEZ5K,EAAEmC,EAAI,GAAGyE,GAAKC,EAGtBxK,EAAM2I,yBACEG,KACI,EACAuM,EAAO9S,QAEXwG,QACI,EACA3G,EAAM8B,SAAS,GAAG3B,OAAS,KAGvCvC,EAAM0K,aAAc,EAEpB1K,EAAM+K,YAAYpH,EAAG3D,EAAM2I,wBAC3BnH,IACAxB,EAAM0K,aAAc","file":"../../controllers/pivotTable.js","sourcesContent":["define([\n    '../methods/get',\n    '../utils/util',\n    '../methods/getdata',\n    '../methods/datecontroll',\n    '../methods/format',\n    '../methods/validate',\n    \"../methods/pivotTable_methods\",\n    '../methods/sort_methods',\n    '../widgets/tooltip',\n    '../widgets/cleargridelement',\n    '../methods/array',\n    '../methods/analysis',\n    '../widgets/select',\n    '../methods/luckysheetConfigsetting',\n    '../methods/sheetSearch',\n    '../widgets/constant',\n    '../methods/sheets',\n    '../widgets/resize',\n    '../methods/protection_methods',\n    '../store',\n    '../locale/locale',\n    '../vendors/numeral'\n], function (m_get, m_util, m_getdata, m_datecontroll, m_format, m_validate, pivotTable_methods,m_sort, tooltip, cleargridelement, luckysheetArray, analysis, m_select,luckysheetConfigsetting, m_sheetSearch, m_constant, sheets, luckysheetsizeauto,  m_protection, Store, locale, numeral) {\n    'use strict';\n    const {getSheetIndex, getRangetxt} = m_get;\n    const {replaceHtml, getObjType, ABCatNum, numFormat, numfloatlen, showrightclickmenu, mouseclickposition} = m_util;\n    const {getdatabyselectionD, getcellvalue, datagridgrowth} = m_getdata;\n    const {isdatetime, diff, isdatatypemulti, isdatatype} = m_datecontroll;\n    const {genarate, update} = m_format;\n    const {isRealNull} = m_validate;\n    const isEditMode = luckysheetConfigsetting.isEditMode;\n    const {orderbydata1D} = m_sort;\n    const {selectHightlightShow} = m_select;\n    const {luckysheet_searcharray} = m_sheetSearch;\n    const {modelHTML, filtermenuHTML, filtersubmenuHTML, pivottableconfigHTML, pivottablesumHTML, luckysheetPivotTableHTML} = m_constant;\n    const {checkProtectionAuthorityNormal} = m_protection;\n    const pivotTable = Object.assign(pivotTable_methods,{\n        showvaluecolrow: function () {\n            let _this = this;\n            if ($('#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item').length >= 2) {\n                $('#luckysheetpivottablevaluecolrowshow').show();\n                if (_this.showType == 'column') {\n                    $('#luckysheetpivottablevaluecolrow').prop('checked', true);\n                    $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']\").addClass('ui-state-active');\n                    $('#luckysheetpivottablevaluecolrow1').prop('checked', false);\n                    $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']\").removeClass('ui-state-active');\n                } else {\n                    $('#luckysheetpivottablevaluecolrow1').prop('checked', true);\n                    $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']\").addClass('ui-state-active');\n                    $('#luckysheetpivottablevaluecolrow').prop('checked', false);\n                    $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']\").removeClass('ui-state-active');\n                }\n            } else {\n                $('#luckysheetpivottablevaluecolrowshow').hide();\n            }\n        },\n        resetOrderby: function (obj) {\n            let orderby = $('#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item').index(obj);\n            $('#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                if ($(this).data('orderby') == orderby) {\n                    $(this).data('orderby', 'self');\n                }\n            });\n        },\n        luckysheetsliderlistclearfilter: function ($filter) {\n            let _this = this;\n            let $t = $filter.parent();\n            let cindex = $t.data('index');\n            let rowhidden = {}, selected = {}, d = _this.origindata, filterdata = {};\n            $t.data('rowhidden', '').find('.luckysheet-slider-list-item-filtered').hide();\n            _this.setDatatojsfile('selected', {}, cindex);\n            _this.setDatatojsfile('rowhidden', null, cindex);\n            let newdata = [];\n            for (let i = 0; i < d.length; i++) {\n                if (rowhidden[i] != null) {\n                    continue;\n                }\n                newdata.push([].concat(d[i]));\n            }\n            _this.celldata = newdata;\n            _this.refreshPivotTable();\n            $('#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu').hide();\n        },\n        luckysheetsliderlistitemfilter: function ($filter) {\n            let _this = this;\n            const _locale = locale();\n            const locale_filter = _locale.filter;\n            let $t = $filter.parent(), toffset = $t.offset(), $menu = $('#luckysheet-pivotTableFilter-menu'), winH = $(window).height(), winW = $(window).width();\n            let cindex = $t.data('index');\n            let rowhidden = $t.data('rowhidden');\n            if (rowhidden == null || rowhidden == '') {\n                rowhidden = {};\n            } else if (getObjType(rowhidden) == 'string') {\n                rowhidden = JSON.parse(rowhidden);\n            }\n            $('body .luckysheet-cols-menu').hide();\n            $('#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu').hide();\n            $('#luckysheet-pivotTableFilter-byvalue-input').val('');\n            $('#luckysheet-pivotTableFilter-bycondition').next().hide();\n            $('#luckysheet-pivotTableFilter-byvalue').next().show();\n            $menu.data('index', cindex);\n            $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').hide().find('input').val();\n            $('#luckysheet-pivotTableFilter-selected span').data('type', '0').data('type', null).text(locale_filter.filiterInputNone);\n            let byconditiontype = $t.data('byconditiontype');\n            $('#luckysheet-pivotTableFilter-selected span').data('value', $t.data('byconditionvalue')).data('type', byconditiontype).text($t.data('byconditiontext'));\n            if (byconditiontype == '2') {\n                let $input = $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2').show().find('input');\n                $input.eq(0).val($t.data('byconditionvalue1'));\n                $input.eq(1).val($t.data('byconditionvalue2'));\n            } else if (byconditiontype == '1') {\n                $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').eq(0).show().find('input').val($t.data('byconditionvalue1'));\n            }\n            $('#luckysheet-pivotTableFilter-byvalue-select').empty().html('<div style=\"width:100%;text-align:center;position:relative;top:45%;font-size: 14px;\"> <div class=\"luckysheetLoaderGif\"> </div> <span>' + locale_filter.filiterMoreDataTip + '</span></div>');\n            let rowhiddenother = {};    //其它筛选列的隐藏行\n            //其它筛选列的隐藏行\n            $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').not($t.get(0)).each(function () {\n                let $t = $(this), rh = $t.data('rowhidden');\n                if (rh == null || rh == '') {\n                    return true;\n                }\n                if (getObjType(rh) == 'string') {\n                    rh = JSON.parse(rh);\n                }\n                for (let r in rh) {\n                    rowhiddenother[r] = 0;\n                }\n            });\n            let data = _this.origindata;\n            setTimeout(function () {\n                //日期值\n                let dvmap = {};\n                let dvmap_uncheck = {};    //除日期以外的值\n                //除日期以外的值\n                let vmap = {};\n                let vmap_uncheck = {};\n                for (let r = 1; r < data.length; r++) {\n                    if (r in rowhiddenother) {\n                        continue;\n                    }\n                    if (data[r] == null) {\n                        continue;\n                    }\n                    let cell = data[r][cindex];\n                    if (cell != null && cell.ct != null && cell.ct.t == 'd') {\n                        //单元格是日期\n                        let v = update('YYYY-MM-DD', cell.v);\n                        let y = v.split('-')[0];\n                        let m = v.split('-')[1];\n                        let d = v.split('-')[2];\n                        if (!(y in dvmap)) {\n                            dvmap[y] = {};\n                        }\n                        if (!(m in dvmap[y])) {\n                            dvmap[y][m] = {};\n                        }\n                        if (!(d in dvmap[y][m])) {\n                            dvmap[y][m][d] = 0;\n                        }\n                        dvmap[y][m][d]++;\n                        if (r in rowhidden) {\n                            dvmap_uncheck[y] = 0;\n                            dvmap_uncheck[m] = 0;\n                            dvmap_uncheck[d] = 0;\n                        }\n                    } else {\n                        let v, m;\n                        if (cell == null || isRealNull(cell.v)) {\n                            v = null;\n                            m = null;\n                        } else {\n                            v = cell.v;\n                            m = cell.m;\n                        }\n                        if (!(v in vmap)) {\n                            vmap[v] = {};\n                        }\n                        if (!(m in vmap[v])) {\n                            vmap[v][m] = 0;\n                        }\n                        vmap[v][m]++;\n                        if (r in rowhidden) {\n                            vmap_uncheck[v + '#$$$#' + m] = 0;\n                        }\n                    }\n                }    //遍历数据加到页面\n                //遍历数据加到页面\n                let item = [];\n                if (JSON.stringify(dvmap).length > 2) {\n                    for (let y in dvmap) {\n                        let ysum = 0;\n                        let monthHtml = '';\n                        for (let m in dvmap[y]) {\n                            let msum = 0;\n                            let dayHtml = '';\n                            for (let d in dvmap[y][m]) {\n                                let dayL = dvmap[y][m][d];\n                                msum += dayL;    //月 小于 10\n                                //月 小于 10\n                                let mT;\n                                if (Number(m) < 10) {\n                                    mT = '0' + Number(m);\n                                } else {\n                                    mT = m;\n                                }    //日 小于 10\n                                //日 小于 10\n                                let dT;\n                                if (Number(d) < 10) {\n                                    dT = '0' + Number(d);\n                                } else {\n                                    dT = d;\n                                }    //日是否选中状态\n                                //日是否选中状态\n                                if (y in dvmap_uncheck && m in dvmap_uncheck && d in dvmap_uncheck) {\n                                    dayHtml += '<div class=\"day luckysheet-mousedown-cancel cf\" data-check=\"false\" title=\"' + y + '-' + mT + '-' + dT + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + d + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + dayL + ' )</span>' + '</div>';\n                                } else {\n                                    dayHtml += '<div class=\"day luckysheet-mousedown-cancel cf\" data-check=\"true\" title=\"' + y + '-' + mT + '-' + dT + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + d + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + dayL + ' )</span>' + '</div>';\n                                }\n                            }\n                            ysum += msum;    //月 小于 10\n                            //月 小于 10\n                            let mT2;\n                            if (Number(m) < 10) {\n                                mT2 = '0' + Number(m);\n                            } else {\n                                mT2 = m;\n                            }    //月是否选中状态\n                            //月是否选中状态\n                            if (y in dvmap_uncheck && m in dvmap_uncheck) {\n                                monthHtml += '<div class=\"monthBox luckysheet-mousedown-cancel\">' + '<div class=\"month luckysheet-mousedown-cancel cf\" data-check=\"false\" title=\"' + y + '-' + mT2 + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + m + '' + locale_filter.filiterMonthText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + msum + ' )</span>' + '</div>' + '<div class=\"dayList luckysheet-mousedown-cancel\">' + dayHtml + '</div>' + '</div>';\n                            } else {\n                                monthHtml += '<div class=\"monthBox luckysheet-mousedown-cancel\">' + '<div class=\"month luckysheet-mousedown-cancel cf\" data-check=\"true\" title=\"' + y + '-' + mT2 + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + m + '' + locale_filter.filiterMonthText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + msum + ' )</span>' + '</div>' + '<div class=\"dayList luckysheet-mousedown-cancel\">' + dayHtml + '</div>' + '</div>';\n                            }\n                        }    //年是否选中状态\n                        //年是否选中状态\n                        let yearHtml;\n                        if (y in dvmap_uncheck) {\n                            yearHtml = '<div class=\"yearBox luckysheet-mousedown-cancel\">' + '<div class=\"year luckysheet-mousedown-cancel cf\" data-check=\"false\" title=\"' + y + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + y + '' + locale_filter.filiterYearText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + ysum + ' )</span>' + '</div>' + '<div class=\"monthList luckysheet-mousedown-cancel\">' + monthHtml + '</div>' + '</div>';\n                        } else {\n                            yearHtml = '<div class=\"yearBox luckysheet-mousedown-cancel\">' + '<div class=\"year luckysheet-mousedown-cancel cf\" data-check=\"true\" title=\"' + y + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + y + '' + locale_filter.filiterYearText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + ysum + ' )</span>' + '</div>' + '<div class=\"monthList luckysheet-mousedown-cancel\">' + monthHtml + '</div>' + '</div>';\n                        }\n                        item.unshift(yearHtml);\n                    }\n                }\n                if (JSON.stringify(vmap).length > 2) {\n                    let vmapKeys = Object.keys(vmap);\n                    vmapKeys = orderbydata1D(vmapKeys, true);\n                    for (let i = 0; i < vmapKeys.length; i++) {\n                        let v = vmapKeys[i];\n                        for (let x in vmap[v]) {\n                            let text;\n                            if (v + '#$$$#' + x == 'null#$$$#null') {\n                                text = locale_filter.valueBlank;\n                            } else {\n                                text = x;\n                            }    //是否选中状态\n                            //是否选中状态\n                            let dataHtml;\n                            if (v + '#$$$#' + x in vmap_uncheck) {\n                                dataHtml = '<div class=\"textBox luckysheet-mousedown-cancel cf\" data-check=\"false\" data-filter=\"' + (v + '#$$$#' + x) + '\" title=\"' + x + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + text + '</label>' + '<span class=\"luckysheet-mousedown-cancel count\">( ' + vmap[v][x] + ' )</span>' + '</div>';\n                            } else {\n                                dataHtml = '<div class=\"textBox luckysheet-mousedown-cancel cf\" data-check=\"true\" data-filter=\"' + (v + '#$$$#' + x) + '\" title=\"' + x + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + text + '</label>' + '<span class=\"luckysheet-mousedown-cancel count\">( ' + vmap[v][x] + ' )</span>' + '</div>';\n                            }\n                            item.push(dataHtml);\n                        }\n                    }\n                }\n                $('#luckysheet-pivotTableFilter-byvalue-select').html(\"<div class='ListBox luckysheet-mousedown-cancel' style='max-height:\" + (winH - toffset.top - 350) + \"px;overflow-y:auto;overflow-x:hidden;'>\" + item.join('') + '</div>');\n            }, 1);\n            showrightclickmenu($menu, toffset.left - 250, toffset.top);\n        },\n\n        createPivotTable: function (e) {\n            if (isEditMode() || Store.allowEdit === false) {\n                return;\n            }\n            let _this = this;\n            let datasheetindex = Store.currentSheetIndex;\n            const _locale = locale();\n            const locale_pivotTable = _locale.pivotTable;\n            if (isEditMode()) {\n                alert(locale_pivotTable.errorNotAllowEdit);\n                return;\n            }\n            if (Store.luckysheet_select_save.length > 1) {\n                tooltip.info('', locale_pivotTable.errorNotAllowMulti);\n                return;\n            }\n            if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1] || Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                tooltip.info('', locale_pivotTable.errorSelectRange);\n                return;\n            }\n            let select_save = $.extend(true, {}, Store.luckysheet_select_save[0]);\n            sheets.addNewSheet(e, true); //TODO:lwf\n            _this.getCellData(Store.currentSheetIndex, datasheetindex, select_save);\n            _this.setDatatojsfile('pivot_select_save', select_save);\n            _this.setDatatojsfile('pivotDataSheetIndex', datasheetindex);\n            _this.initialPivotManage();\n        },\n        changePivotTable: function (index) {\n            let _this = this;\n            const _locale = locale();\n            const locale_pivotTable = _locale.pivotTable;\n            let pivotDataSheetIndex = Store.luckysheetfile[getSheetIndex(index)].pivotTable.pivotDataSheetIndex;\n            let real_pivotDataSheetIndex = getSheetIndex(pivotDataSheetIndex);\n            if (real_pivotDataSheetIndex == null) {\n                tooltip.info(locale_pivotTable.errorIsDamage, '');\n                return;\n            }\n            _this.getCellData(index);\n            _this.initialPivotManage(true);\n            _this.refreshPivotTable();    //初始化在一个普通sheet页，从此普通sheet页切换到数据透视表页时，需要刷新下数据，否则还是旧数据\n        },\n        //初始化在一个普通sheet页，从此普通sheet页切换到数据透视表页时，需要刷新下数据，否则还是旧数据\n        refreshPivotTable: function (isRefreshCanvas = true) {\n            let _this = this;\n            let redo = {};\n            redo['pivotTable'] = pivotTable_methods;\n            redo['data'] = Store.deepCopyFlowData(Store.flowdata);    //取数据\n            //取数据\n            _this.storePivotTableParam();\n            let ret = _this.dataHandler(_this.column, _this.row, _this.values, _this.showType, _this.celldata);\n            _this.setDatatojsfile('pivotDatas', ret);\n            let d = $.extend(true, [], sheets.nulldata);\n            let data = d;\n            let addr = 0, addc = 0;\n            if (ret.length == 0) {\n                _this.setDatatojsfile('drawPivotTable', true);\n                _this.setDatatojsfile('pivotTableBoundary', [\n                    12,\n                    6\n                ]);\n            } else {\n                _this.setDatatojsfile('drawPivotTable', false);\n                _this.setDatatojsfile('pivotTableBoundary', [\n                    ret.length,\n                    ret[0].length\n                ]);\n                let rlen = ret.length, clen = ret[0].length;\n                addr = rlen - d.length;\n                addc = clen - d[0].length;\n                data = datagridgrowth(d, addr + 20, addc + 10, true);\n                for (let r = 0; r < rlen; r++) {\n                    let x = [].concat(data[r]);\n                    for (let c = 0; c < clen; c++) {\n                        let value = '';\n                        if (ret[r] != null && ret[r][c] != null) {\n                            value = getcellvalue(r, c, ret);\n                        }\n                        x[c] = value;\n                    }\n                    data[r] = x;\n                }\n            }\n            redo['type'] = 'pivotTable_change';\n            redo['curdata'] = $.extend(true, [], data);\n            redo['sheetIndex'] = Store.currentSheetIndex;\n            let pivotTable = _this.getPivotTableData();\n            redo['pivotTablecur'] = pivotTable;\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                Store.jfredo.push(redo);\n            }\n            cleargridelement();\n            Store.clearjfundo = false;\n            if (addr > 0 || addc > 0) {\n                ///jfrefreshgridall(data[0].length, data.length, data, null, Store.luckysheet_select_save, 'datachangeAll', undefined, undefined, isRefreshCanvas);\n                Store.refreshGridAll(data[0].length, data.length, data, null, Store.luckysheet_select_save, 'datachangeAll', undefined, undefined, isRefreshCanvas);\n            } else {\n                ///jfrefreshgrid(data, Store.luckysheet_select_save, {}, null, isRefreshCanvas);\n                Store.refreshGrid(data, Store.luckysheet_select_save, {}, null, isRefreshCanvas);\n                selectHightlightShow();\n            }\n            Store.clearjfundo = true;\n        },\n        pivotclick: function (row_index, col_index, index) {\n            if (index == null) {\n                index = Store.currentSheetIndex;\n            }\n            let file = Store.luckysheetfile[getSheetIndex(index)];\n            if (!file.isPivotTable) {\n                return;\n            }\n            let pivotDataSheetIndex = file.pivotTable.pivotDataSheetIndex;\n            let real_pivotDataSheetIndex = getSheetIndex(pivotDataSheetIndex);\n            if (real_pivotDataSheetIndex == null) {\n                return;\n            }\n            let slider = $('#luckysheet-modal-dialog-slider-pivot');\n            let isRangeClick = this.isPivotRange(row_index, col_index);\n            if (isRangeClick && slider.is(':hidden')) {\n                if (!checkProtectionAuthorityNormal(index, 'usePivotTablereports', false)) {\n                    // Store.luckysheet_select_status = false;\n                    return;\n                }\n                slider.show();\n                luckysheetsizeauto();\n                $('#luckysheet-sta-content').css('padding-right', 260);\n            } else if (!isRangeClick && slider.is(':visible')) {\n                slider.hide();\n                luckysheetsizeauto();\n                $('#luckysheet-sta-content').css('padding-right', 10);\n            }\n        },\n        storePivotTableParam: function () {\n            let _this = this;\n            let columnarr = [], rowarr = [], filterarr = [], valuesarr = [];\n            $('#luckysheet-modal-dialog-config-filter .luckysheet-modal-dialog-slider-config-item').each(function () {\n                let item = {};\n                item['index'] = $(this).data('index');\n                item['name'] = $(this).data('name');\n                item['fullname'] = $(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text();\n                filterarr.push(item);\n            });\n            $('#luckysheet-modal-dialog-config-row .luckysheet-modal-dialog-slider-config-item').each(function () {\n                let item = {};\n                item['index'] = $(this).data('index');\n                item['name'] = $(this).data('name');\n                item['fullname'] = $(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text();\n                item['order'] = $(this).data('order');\n                item['orderby'] = $(this).data('orderby');\n                item['stastic'] = $(this).data('stastic');\n                rowarr.push(item);\n            });\n            $('#luckysheet-modal-dialog-config-column .luckysheet-modal-dialog-slider-config-item').each(function () {\n                let item = {};\n                item['index'] = $(this).data('index');\n                item['name'] = $(this).data('name');\n                item['fullname'] = $(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text();\n                item['order'] = $(this).data('order');\n                item['orderby'] = $(this).data('orderby');\n                item['stastic'] = $(this).data('stastic');\n                columnarr.push(item);\n            });\n            $('#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item').each(function () {\n                let item = {};\n                item['index'] = $(this).data('index');\n                item['name'] = $(this).data('name');\n                item['fullname'] = $(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text();\n                item['sumtype'] = $(this).data('sumtype');\n                item['nameindex'] = $(this).data('nameindex');\n                valuesarr.push(item);\n            });\n            _this.setDatatojsfile('column', columnarr);\n            _this.setDatatojsfile('row', rowarr);\n            _this.setDatatojsfile('filter', filterarr);\n            _this.setDatatojsfile('values', valuesarr);\n            let showtype = $('#luckysheetpivottablevaluecolrow:checked, #luckysheetpivottablevaluecolrow1:checked').val();\n            _this.setDatatojsfile('showType', showtype == '0' ? 'row' : 'column');\n            let pivotTable = _this.getPivotTableData();\n            delete pivotTable.pivotDatas;\n            Store.saveParam('all', _this.pivotSheetIndex, pivotTable, { 'k': 'pivotTable' });\n        },\n        initialPivotManage: function (restore) {\n            let _this = this;\n            const _locale = locale();\n            const locale_pivotTable = _locale.pivotTable;\n            const locale_button = _locale.button;\n            const locale_filter = _locale.filter;\n            if (_this.initial) {\n                _this.initial = false;\n                $('body').append(luckysheetPivotTableHTML());\n                $('#luckysheet-modal-dialog-slider-close').click(function () {\n                    $('#luckysheet-modal-dialog-slider-pivot').hide();\n                    luckysheetsizeauto();\n                });\n                $('body').append(replaceHtml(modelHTML, {\n                    'id': 'luckysheet-data-pivotTable-selection',\n                    'addclass': 'luckysheet-data-pivotTable-selection',\n                    'title': locale_pivotTable.titleSelectionDataRange,\n                    'content': '<input id=\"luckysheet-pivotTable-range-selection-input\" class=\"luckysheet-datavisual-range-container\" style=\"font-size: 14px;padding:5px;max-width:none;\" spellcheck=\"false\" aria-label=\"' + locale_pivotTable.titleDataRange + '\" placeholder=\"' + locale_pivotTable.titleDataRange + '\">',\n                    'botton': '<button id=\"luckysheet-pivotTable-selection-confirm\" class=\"btn btn-primary\">' + locale_button.confirm + '</button><button class=\"btn btn-default luckysheet-model-close-btn\">' + locale_button.cancel + '</button>'\n                }));\n                $('body').append(replaceHtml(filtermenuHTML(), { 'menuid': 'pivotTableFilter' }));\n                $('body').append(replaceHtml(filtersubmenuHTML(), { 'menuid': 'pivotTableFilter' }));\n                $('body').append(pivottableconfigHTML());\n                $('body').append(pivottablesumHTML());\n                $('#luckysheet-pivotTableFilter-orderby-asc').remove();\n                $('#luckysheet-pivotTableFilter-orderby-desc').next().remove();\n                $('#luckysheet-pivotTableFilter-orderby-desc').remove();\n                $('#luckysheet-pivotTableFilter-orderby-color').next().remove();\n                $('#luckysheet-pivotTableFilter-orderby-color').remove();\n                $('#luckysheetpivottablevaluecolrow, #luckysheetpivottablevaluecolrow1').checkboxradio({ icon: false }).change(function () {\n                    _this.refreshPivotTable();\n                });\n                let hidefilersubmenu = null;\n                $('#luckysheet-pivotTableFilter-menu').mouseover(function () {\n                    clearTimeout(hidefilersubmenu);\n                    hidefilersubmenu = setTimeout(function () {\n                        $('#luckysheet-pivotTableFilter-submenu').hide();\n                    }, 500);\n                });    //点击复选框\n                //点击复选框\n                $(document).off('click.ptFilterCheckbox1').on('click.ptFilterCheckbox1', '#luckysheet-pivotTableFilter-byvalue-select .textBox', function () {\n                    if ($(this).attr('data-check') == 'true') {\n                        $(this).attr('data-check', 'false');\n                        $(this).find(\"input[type='checkbox']\").removeAttr('checked');\n                    } else {\n                        $(this).attr('data-check', 'true');\n                        $(this).find(\"input[type='checkbox']\").prop('checked', true);\n                    }\n                });\n                $(document).off('click.ptFilterCheckbox2').on('click.ptFilterCheckbox2', '#luckysheet-pivotTableFilter-byvalue-select .year', function () {\n                    if ($(this).attr('data-check') == 'true') {\n                        $(this).attr('data-check', 'false');\n                        $(this).parents('.yearBox').find('.month').attr('data-check', 'false');\n                        $(this).parents('.yearBox').find('.day').attr('data-check', 'false');\n                        $(this).parents('.yearBox').find(\"input[type='checkbox']\").removeAttr('checked');\n                    } else {\n                        $(this).attr('data-check', 'true');\n                        $(this).parents('.yearBox').find('.month').attr('data-check', 'true');\n                        $(this).parents('.yearBox').find('.day').attr('data-check', 'true');\n                        $(this).parents('.yearBox').find(\"input[type='checkbox']\").prop('checked', true);\n                    }\n                });\n                $(document).off('click.ptFilterCheckbox3').on('click.ptFilterCheckbox3', '#luckysheet-pivotTableFilter-byvalue-select .month', function () {\n                    //月份 对应的 天\n                    if ($(this).attr('data-check') == 'true') {\n                        $(this).attr('data-check', 'false');\n                        $(this).parents('.monthBox').find('.day').attr('data-check', 'false');\n                        $(this).parents('.monthBox').find(\"input[type='checkbox']\").removeAttr('checked');\n                    } else {\n                        $(this).attr('data-check', 'true');\n                        $(this).parents('.monthBox').find('.day').attr('data-check', 'true');\n                        $(this).parents('.monthBox').find(\"input[type='checkbox']\").prop('checked', true);\n                    }    //月份 对应的 年份\n                    //月份 对应的 年份\n                    let yearDayAllCheck = true;\n                    let $yearDay = $(this).parents('.yearBox').find('.day');\n                    $yearDay.each(function (i, e) {\n                        if ($(e).attr('data-check') == 'true') {\n                        } else {\n                            yearDayAllCheck = false;\n                        }\n                    });\n                    if (yearDayAllCheck) {\n                        $(this).parents('.yearBox').find('.year').attr('data-check', 'true');\n                        $(this).parents('.yearBox').find(\".year input[type='checkbox']\").prop('checked', true);\n                    } else {\n                        $(this).parents('.yearBox').find('.year').attr('data-check', 'false');\n                        $(this).parents('.yearBox').find(\".year input[type='checkbox']\").removeAttr('checked');\n                    }\n                });\n                $(document).off('click.ptFilterCheckbox4').on('click.ptFilterCheckbox4', '#luckysheet-pivotTableFilter-byvalue-select .day', function () {\n                    if ($(this).attr('data-check') == 'true') {\n                        $(this).attr('data-check', 'false');\n                        $(this).find(\"input[type='checkbox']\").removeAttr('checked');\n                    } else {\n                        $(this).attr('data-check', 'true');\n                        $(this).find(\"input[type='checkbox']\").prop('checked', true);\n                    }    //天 对应的 月份\n                    //天 对应的 月份\n                    let monthDayAllCheck = true;\n                    let $monthDay = $(this).parents('.monthBox').find('.day');\n                    $monthDay.each(function (i, e) {\n                        if ($(e).attr('data-check') == 'true') {\n                        } else {\n                            monthDayAllCheck = false;\n                        }\n                    });\n                    if (monthDayAllCheck) {\n                        $(this).parents('.monthBox').find('.month').attr('data-check', 'true');\n                        $(this).parents('.monthBox').find(\".month input[type='checkbox']\").prop('checked', true);\n                    } else {\n                        $(this).parents('.monthBox').find('.month').attr('data-check', 'false');\n                        $(this).parents('.monthBox').find(\".month input[type='checkbox']\").removeAttr('checked');\n                    }    //天 对应的 年份\n                    //天 对应的 年份\n                    let yearDayAllCheck = true;\n                    let $yearDay = $(this).parents('.yearBox').find('.day');\n                    $yearDay.each(function (i, e) {\n                        if ($(e).attr('data-check') == 'true') {\n                        } else {\n                            yearDayAllCheck = false;\n                        }\n                    });\n                    if (yearDayAllCheck) {\n                        $(this).parents('.yearBox').find('.year').attr('data-check', 'true');\n                        $(this).parents('.yearBox').find(\".year input[type='checkbox']\").prop('checked', true);\n                    } else {\n                        $(this).parents('.yearBox').find('.year').attr('data-check', 'false');\n                        $(this).parents('.yearBox').find(\".year input[type='checkbox']\").removeAttr('checked');\n                    }\n                });    //日期 三级下拉显示\n                //日期 三级下拉显示\n                $(document).off('click.ptFilterYearDropdown').on('click.ptFilterYearDropdown', '#luckysheet-pivotTableFilter-byvalue-select .yearBox .fa-caret-right', function () {\n                    let $p = $(this).parents('.luckysheet-mousedown-cancel');\n                    if ($p.hasClass('year')) {\n                        $(this).parents('.yearBox').find('.monthList').slideToggle();\n                    }\n                    if ($p.hasClass('month')) {\n                        $(this).parents('.monthBox').find('.dayList').slideToggle();\n                    }\n                });    //全选\n                //全选\n                $('#luckysheet-pivotTableFilter-byvalue-btn-all').click(function () {\n                    $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\").prop('checked', true);\n                    $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\").parents('.luckysheet-mousedown-cancel').attr('data-check', 'true');\n                });    //反选\n                //反选\n                $('#luckysheet-pivotTableFilter-byvalue-btn-contra').click(function () {\n                    let $input = $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\");\n                    $input.each(function (i, e) {\n                        if ($(e).is(':checked')) {\n                            $(e).removeAttr('checked');\n                            $(e).parents('.luckysheet-mousedown-cancel').attr('data-check', 'false');\n                        } else {\n                            $(e).prop('checked', true);\n                            $(e).parents('.luckysheet-mousedown-cancel').attr('data-check', 'true');\n                        }\n                    });    //天 对应的 月份\n                    //天 对应的 月份\n                    let $month = $('#luckysheet-pivotTableFilter-byvalue-select .ListBox .monthBox');\n                    $month.each(function (index, event) {\n                        let monthDayAllCheck = true;\n                        let $monthDay = $(event).find(\".day input[type='checkbox']\");\n                        $monthDay.each(function (i, e) {\n                            if ($(e).is(':checked')) {\n                            } else {\n                                monthDayAllCheck = false;\n                            }\n                        });\n                        if (monthDayAllCheck) {\n                            $(event).find(\".month input[type='checkbox']\").prop('checked', true);\n                            $(event).attr('data-check', 'true');\n                        } else {\n                            $(event).find(\".month input[type='checkbox']\").removeAttr('checked');\n                            $(event).attr('data-check', 'false');\n                        }\n                    });    //天 对应的 年份\n                    //天 对应的 年份\n                    let $year = $('#luckysheet-pivotTableFilter-byvalue-select .ListBox .yearBox');\n                    $year.each(function (index, event) {\n                        let yearDayAllCheck = true;\n                        let $yearDay = $(event).find(\".day input[type='checkbox']\");\n                        $yearDay.each(function (i, e) {\n                            if ($(e).is(':checked')) {\n                            } else {\n                                yearDayAllCheck = false;\n                            }\n                        });\n                        if (yearDayAllCheck) {\n                            $(event).find(\".year input[type='checkbox']\").prop('checked', true);\n                            $(event).attr('data-check', 'true');\n                        } else {\n                            $(event).find(\".year input[type='checkbox']\").removeAttr('checked');\n                            $(event).attr('data-check', 'false');\n                        }\n                    });\n                });    //清除\n                //清除\n                $('#luckysheet-pivotTableFilter-byvalue-btn-clear').click(function () {\n                    $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\").removeAttr('checked');\n                    $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\").parents('.luckysheet-mousedown-cancel').attr('data-check', 'false');\n                });    //按照值进行筛选\n                //按照值进行筛选\n                $('#luckysheet-pivotTableFilter-byvalue-input').on('input propertychange', function () {\n                    let v = $(this).val().toString();\n                    $('#luckysheet-pivotTableFilter-byvalue-select .ListBox .luckysheet-mousedown-cancel').show();\n                    if (v != '') {\n                        let $check = $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\");\n                        $check.each(function (i, e) {\n                            let $p = $(e).parents('.luckysheet-mousedown-cancel');\n                            if ($p.hasClass('day')) {\n                                //日期\n                                let day = $(e).siblings('label').text().toString();\n                                let month = $(e).parents('.monthBox').find('.month label').text().toString();\n                                let year = $(e).parents('.yearBox').find('.year label').text().toString();\n                                let itemV = year + '-' + month + '-' + day;\n                                if (itemV.indexOf(v) == -1) {\n                                    $(e).parents('.day').hide();    //天 对应的 月份\n                                    //天 对应的 月份\n                                    let $monthDay = $(e).parents('.dayList').find('.day:visible');\n                                    if ($monthDay.length == 0) {\n                                        $(e).parents('.monthBox').find('.month').hide();\n                                    }    //天 对应的 年份\n                                    //天 对应的 年份\n                                    let $yearDay = $(e).parents('.monthList').find('.day:visible');\n                                    if ($yearDay.length == 0) {\n                                        $(e).parents('.yearBox').find('.year').hide();\n                                    }\n                                }\n                            }\n                            if ($p.hasClass('textBox')) {\n                                //其它\n                                let itemV = $(e).siblings('label').text().toString();\n                                if (itemV.indexOf(v) == -1) {\n                                    $(e).parents('.textBox').hide();\n                                }\n                            }\n                        });\n                    }\n                });\n                $('#luckysheet-pivotTableFilter-bycondition, #luckysheet-pivotTableFilter-byvalue').click(function () {\n                    let $t = $(this);\n                    $t.next().slideToggle(200);\n                    setTimeout(function () {\n                        if ($t.attr('id') == 'luckysheet-pivotTableFilter-bycondition' && $('#luckysheet-pivotTableFilter-bycondition').next().is(':visible')) {\n                            if ($('#luckysheet-pivotTableFilter-selected span').text() != locale_filter.filiterInputNone) {\n                                $('#luckysheet-pivotTableFilter-byvalue').next().slideUp(200);\n                            }\n                        }\n                        if ($t.is($('#luckysheet-pivotTableFilter-bycondition'))) {\n                            if ($('#luckysheet-pivotTableFilter-bycondition').next().is(':hidden') && $('#luckysheet-pivotTableFilter-byvalue').next().is(':hidden')) {\n                                $('#luckysheet-pivotTableFilter-byvalue').next().slideDown(200);\n                            }\n                        }\n                    }, 300);\n                });    //取消按钮\n                //取消按钮\n                $('#luckysheet-pivotTableFilter-cancel').click(function () {\n                    $('#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu').hide();\n                });\n                $('#luckysheet-pivotTableFilter-selected').click(function () {\n                    let $t = $(this), toffset = $t.offset(), $menu = $('#luckysheet-pivotTableFilter-submenu');\n                    $menu.hide();\n                    let winH = $(window).height(), winW = $(window).width();\n                    let menuW = $menu.width(), menuH = $menu.height();\n                    let top = toffset.top, left = toffset.left, mheight = winH - toffset.top - 20;\n                    if (toffset.left + menuW > winW) {\n                        left = toffset.left - menuW;\n                    }\n                    if (toffset.top > winH / 2) {\n                        top = winH - toffset.top;\n                        if (top < 0) {\n                            top = 0;\n                        }\n                        mheight = toffset.top - 20;\n                    }\n                    $menu.css({\n                        'top': top,\n                        'left': left,\n                        'height': mheight\n                    }).show();\n                    clearTimeout(hidefilersubmenu);\n                });    //按条件过滤\n                //按条件过滤\n                $('#luckysheet-pivotTableFilter-submenu').mouseover(function () {\n                    clearTimeout(hidefilersubmenu);\n                }).find('.luckysheet-cols-menuitem').click(function (e) {\n                    $('#luckysheet-pivotTableFilter-selected span').html($(this).find('.luckysheet-cols-menuitem-content').text()).data('value', $(this).data('value'));\n                    $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').hide();\n                    if ($(this).data('type') == '2') {\n                        $('#luckysheet-pivotTableFilter-selected span').data('type', '2');\n                        $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2').show();\n                    } else if ($(this).data('type') == '0') {\n                        $('#luckysheet-pivotTableFilter-selected span').data('type', '0');\n                    } else {\n                        $('#luckysheet-pivotTableFilter-selected span').data('type', '1');\n                        $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').eq(0).show();    //若是日期 改变input type类型为date\n                        //若是日期 改变input type类型为date\n                        if ($(this).attr('data-value') == 'dateequal' || $(this).attr('data-value') == 'datelessthan' || $(this).attr('data-value') == 'datemorethan') {\n                            $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input').prop('type', 'date');\n                        } else {\n                            $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input').prop('type', 'text');\n                        }\n                    }\n                    $('#luckysheet-pivotTableFilter-byvalue').next().slideUp();\n                    $('#luckysheet-pivotTableFilter-submenu').hide();\n                });\n                $('#luckysheet-modal-dialog-pivotTable-list').on('click', ' .luckysheet-slider-list-item-filter', function (e) {\n                    _this.luckysheetsliderlistitemfilter($(this));\n                    e.stopPropagation();\n                    return false;\n                });\n                $('#luckysheet-modal-dialog-pivotTable-list').on('click', ' .luckysheet-slider-list-item-filtered', function (e) {\n                    _this.luckysheetsliderlistclearfilter($(this).next());\n                    e.stopPropagation();\n                    return false;\n                });\n                $('#luckysheet-dialog-pivotTable-range-seleted').click(function () {\n                    $('#luckysheet-modal-dialog-slider-pivot').hide();\n                    luckysheetsizeauto();\n                    let $t = $('#luckysheet-data-pivotTable-selection'), myh = $t.outerHeight(), myw = $t.outerWidth();\n                    let winw = $(window).width(), winh = $(window).height();\n                    let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n                    $('#luckysheet-data-pivotTable-selection').css({\n                        'left': (winw + scrollLeft - myw) / 2,\n                        'top': (winh + scrollTop - myh) / 4\n                    }).show();\n                    _this.jgridCurrentPivotInput = $('#luckysheet-dialog-pivotTable-range').html();\n                    $('#luckysheet-pivotTable-range-selection-input').val(_this.jgridCurrentPivotInput);\n                    _this.luckysheet_pivotTable_select_state = true;\n                });    //清除筛选按钮\n                //清除筛选按钮\n                $('#luckysheet-pivotTableFilter-initial').click(function () {\n                    $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-slider-list-item-filtered').hide();\n                    $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').data('rowhidden', '');\n                    $('#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu').hide();\n                    $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').hide().find('input').val();\n                    $('#luckysheet-pivotTableFilter-selected span').data('type', '0').data('type', null).text(locale_filter.filiterInputNone);\n                    _this.setDatatojsfile('filterparm', null);\n                    _this.celldata = _this.origindata;\n                    _this.refreshPivotTable();\n                });\n                $('#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column').on('click', '.luckysheet-modal-dialog-slider-config-item-icon', function (e) {\n                    let $t = $(e.target), $item = $t.closest('.luckysheet-modal-dialog-slider-config-item'), cindex = $item.data('index'), toffset = $item.offset();\n                    let order = $item.data('order'), orderby = $item.data('orderby'), stastic = $item.data('stastic');\n                    if (order == null) {\n                        order = 'default';\n                    }\n                    let option = '<option value=\"self\">' + $item.find('.luckysheet-modal-dialog-slider-config-item-txt').data('name') + '</option>';\n                    $('#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item').each(function (i) {\n                        option += '<option value=\"' + i + '\">' + $(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text() + '</option>';\n                    });\n                    $('#luckysheet-pivotTable-config-option-orderby').empty().html(option);\n                    if (orderby == null) {\n                        orderby = 'self';\n                    }\n                    if (stastic == null) {\n                        stastic = '1';\n                    }\n                    $('#luckysheet-pivotTable-config-option-order').val(order).data('index', cindex);\n                    $('#luckysheet-pivotTable-config-option-orderby').val(orderby).data('index', cindex);\n                    $('#luckysheet-pivotTable-config-option-stastic').val(stastic).data('index', cindex);\n                    mouseclickposition($('#luckysheet-pivotTable-config-option'), toffset.left + $item.outerWidth(), toffset.top - 13, 'rightbottom');\n                    e.stopPropagation();\n                    return false;\n                });\n                $('#luckysheet-pivotTable-config-option-order,#luckysheet-pivotTable-config-option-orderby,#luckysheet-pivotTable-config-option-stastic').change(function () {\n                    let $t = $(this), cindex = $t.data('index');\n                    $('#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                        if ($(this).data('index') == cindex) {\n                            $(this).data($t.attr('id').replace('luckysheet-pivotTable-config-option-', ''), $t.val());\n                        }\n                    });\n                    _this.refreshPivotTable();\n                });\n                $('#luckysheet-modal-dialog-config-value').on('click', '.luckysheet-modal-dialog-slider-config-item-icon', function (e) {\n                    let $t = $(e.target), $item = $t.closest('.luckysheet-modal-dialog-slider-config-item'), cindex = $item.data('index'), toffset = $item.offset(), sumtype = $item.data('sumtype');\n                    let type = _this.pivot_data_type[cindex.toString()];\n                    if (sumtype == null) {\n                        if (type == 'num') {\n                            sumtype = 'SUM';\n                        } else {\n                            sumtype = 'COUNTA';\n                        }\n                    }\n                    let $menu = $('#luckysheet-pivotTable-config-option-sumtype');\n                    $menu.find('.luckysheet-submenu-arrow').hide();\n                    $menu.find(\".luckysheet-cols-menuitem[sumtype='\" + sumtype + \"'] .luckysheet-submenu-arrow\").css('display', 'inline');\n                    $menu.data('item', $item);\n                    mouseclickposition($menu, toffset.left + $item.outerWidth(), toffset.top - 13, 'rightbottom');\n                    e.stopPropagation();\n                    return false;\n                });\n                $('#luckysheet-pivotTable-config-option-sumtype .luckysheet-cols-menuitem').click(function () {\n                    let $item = $('#luckysheet-pivotTable-config-option-sumtype').data('item');\n                    let sumtype = $(this).attr('sumtype');\n                    $item.data('sumtype', $(this).attr('sumtype'));\n                    let name = _this.getSumTypeName(sumtype) + ':' + $item.data('name');\n                    $item.attr('title', name).find('.luckysheet-modal-dialog-slider-config-item-txt').html(name);\n                    $('#luckysheet-pivotTable-config-option-sumtype').hide();\n                    _this.refreshPivotTable();\n                });\n                $('#luckysheet-modal-dialog-config-filter').on('click', '.luckysheet-modal-dialog-slider-config-item-icon', function (e) {\n                    let $t = $(e.target), cindex = $t.closest('.luckysheet-modal-dialog-slider-config-item').data('index');\n                    _this.luckysheetsliderlistitemfilter($('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(cindex).find('.luckysheet-slider-list-item-filter'));\n                    e.stopPropagation();\n                    return false;\n                });    //确认按钮\n                //确认按钮\n                $('#luckysheet-pivotTableFilter-confirm').click(function () {\n                    let $menu = $('#luckysheet-pivotTableFilter-menu');\n                    let cindex = $menu.data('index');\n                    let rowhiddenother = {};    //其它筛选列的隐藏行\n                    //其它筛选列的隐藏行\n                    $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').each(function () {\n                        let $t = $(this), rh = $t.data('rowhidden');\n                        if ($t.data('index') != cindex) {\n                            if (rh == null || rh == '') {\n                                return true;\n                            }\n                            if (getObjType(rh) == 'string') {\n                                rh = JSON.parse(rh);\n                            }\n                            for (let r in rh) {\n                                rowhiddenother[r] = 0;\n                            }\n                        }\n                    });\n                    let d = _this.origindata;\n                    let filterdata = {};\n                    let rowhidden = {};\n                    let caljs = {};\n                    if ($('#luckysheet-pivotTableFilter-bycondition').next().is(':visible') && $('#luckysheet-pivotTableFilter-byvalue').next().is(':hidden') && $('#luckysheet-pivotTableFilter-selected span').data('value') != 'null') {\n                        let $t = $('#luckysheet-pivotTableFilter-selected span');\n                        let type = $t.data('type'), value = $t.data('value');\n                        caljs['value'] = value;\n                        caljs['text'] = $t.text();\n                        if (type == '0') {\n                            caljs['type'] = '0';\n                        } else if (type == '2') {\n                            let $input = $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2 input');\n                            caljs['type'] = '2';\n                            caljs['value1'] = $input.eq(0).val();\n                            caljs['value2'] = $input.eq(1).val();\n                        } else {\n                            caljs['type'] = '1';\n                            caljs['value1'] = $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').eq(0).find('input').val();\n                        }\n                        for (let r = 1; r < d.length; r++) {\n                            if (r in rowhiddenother) {\n                                continue;\n                            }\n                            if (d[r] == null) {\n                                continue;\n                            }\n                            let cell = d[r][cindex];\n                            if (value == 'cellnull') {\n                                //单元格为空\n                                if (cell != null && !isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'cellnonull') {\n                                //单元格有数据\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'textinclude') {\n                                //文本包含 \n                                let value1 = caljs['value1'];\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else {\n                                    if (cell.m.indexOf(value1) == -1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                }\n                            } else if (value == 'textnotinclude') {\n                                //文本不包含\n                                let value1 = caljs['value1'];\n                                if (cell == null || isRealNull(cell.v)) {\n                                } else {\n                                    if (cell.m.indexOf(value1) > -1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                }\n                            } else if (value == 'textstart') {\n                                //文本开头为\n                                let value1 = caljs['value1'], valuelen = value1.length;\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else {\n                                    if (cell.m.substr(0, valuelen) != value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                }\n                            } else if (value == 'textend') {\n                                //文本结尾为\n                                let value1 = caljs['value1'], valuelen = value1.length;\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else {\n                                    if (valuelen > cell.m.length || cell.m.substr(cell.m.length - valuelen, valuelen) != value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                }\n                            } else if (value == 'textequal') {\n                                //文本等于\n                                let value1 = caljs['value1'];\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else {\n                                    if (cell.m != value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                }\n                            } else if (value == 'dateequal') {\n                                //日期等于\n                                let value1 = genarate(caljs['value1'])[2];\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'd') {\n                                    if (parseInt(cell.v) != value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'datelessthan') {\n                                //日期早于\n                                let value1 = genarate(caljs['value1'])[2];\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'd') {\n                                    if (parseInt(cell.v) >= value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'datemorethan') {\n                                //日期晚于\n                                let value1 = genarate(caljs['value1'])[2];\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'd') {\n                                    if (parseInt(cell.v) <= value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'morethan') {\n                                //大于\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v <= value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'moreequalthan') {\n                                //大于等于\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v < value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'lessthan') {\n                                //小于\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v >= value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'lessequalthan') {\n                                //小于等于\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v > value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'equal') {\n                                //等于\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v != value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'noequal') {\n                                //不等于\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v == value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'include') {\n                                //介于\n                                let value1 = parseFloat(caljs['value1']), value2 = parseFloat(caljs['value2']);\n                                let min, max;\n                                if (value1 < value2) {\n                                    min = value1;\n                                    max = value2;\n                                } else {\n                                    max = value1;\n                                    min = value2;\n                                }\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v < min || cell.v > max) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'noinclude') {\n                                //不在其中\n                                let value1 = parseFloat(caljs['value1']), value2 = parseFloat(caljs['value2']);\n                                let min, max;\n                                if (value1 < value2) {\n                                    min = value1;\n                                    max = value2;\n                                } else {\n                                    max = value1;\n                                    min = value2;\n                                }\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v >= min && cell.v <= max) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            }\n                        }\n                    } else {\n                        $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\").each(function (i, e) {\n                            if ($(e).is(':visible') && $(e).is(':checked')) {\n                                return true;\n                            }\n                            if ($(e).closest('.day').length > 0) {\n                                let day = $(e).siblings('label').text();\n                                if (Number(day) < 10) {\n                                    day = '0' + day;\n                                }\n                                let month = $(e).closest('.monthBox').find('.month label').text().replace(locale_filter.filiterMonthText, '');\n                                if (Number(month) < 10) {\n                                    month = '0' + month;\n                                }\n                                let year = $(e).closest('.yearBox').find('.year label').text().replace(locale_filter.filiterYearText, '');\n                                let itemV = locale_filter.filterDateFormatTip + '#$$$#' + year + '-' + month + '-' + day;\n                                filterdata[itemV] = '1';\n                            }\n                            if ($(e).closest('.textBox').length > 0) {\n                                let itemV = $(e).closest('.textBox').data('filter');\n                                filterdata[itemV] = '1';\n                            }\n                        });\n                        for (let r = 1; r < d.length; r++) {\n                            if (r in rowhiddenother) {\n                                continue;\n                            }\n                            if (d[r] == null) {\n                                continue;\n                            }\n                            let cell = d[r][cindex];\n                            let value;\n                            if (cell == null || isRealNull(cell.v)) {\n                                value = 'null#$$$#null';\n                            } else if (cell.ct != null && cell.ct.t == 'd') {\n                                let fmt = update('YYYY-MM-DD', cell.v);\n                                value = locale_filter.filterDateFormatTip + '#$$$#' + fmt;\n                            } else {\n                                value = cell.v + '#$$$#' + cell.m;\n                            }\n                            if (value in filterdata) {\n                                rowhidden[r] = 0;\n                            }\n                        }\n                    }\n                    let $top = $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(cindex);\n                    if ($(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible:checked\").length < $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible\").length || $('#luckysheet-pivotTableFilter-byvalue-input').val().length > 0 || $('#luckysheet-pivotTableFilter-bycondition').next().is(':visible') && $('#luckysheet-pivotTableFilter-byvalue').next().is(':hidden') && $('#luckysheet-pivotTableFilter-selected span').data('value') != 'null') {\n                        $top.data('rowhidden', JSON.stringify(rowhidden)).find('.luckysheet-slider-list-item-filtered').show();\n                        _this.setDatatojsfile('rowhidden', rowhidden, cindex);\n                        if (caljs != null) {\n                            $top.data('byconditionvalue', caljs['value']).data('byconditiontype', caljs['type']).data('byconditiontext', caljs['text']);\n                            if (caljs['value1'] != null) {\n                                $top.data('byconditionvalue1', caljs['value1']);\n                            }\n                            if (caljs['value2'] != null) {\n                                $top.data('byconditionvalue2', caljs['value2']);\n                            }\n                            _this.setDatatojsfile('caljs', caljs, cindex);\n                        }\n                    } else {\n                        $top.data('rowhidden', '').find('.luckysheet-slider-list-item-filtered').hide();\n                        _this.setDatatojsfile('rowhidden', null, cindex);\n                    }\n                    let newdata = [];\n                    for (let i = 0; i < d.length; i++) {\n                        if (i in rowhidden || i in rowhiddenother) {\n                            continue;\n                        }\n                        newdata.push([].concat(d[i]));\n                    }\n                    _this.celldata = newdata;\n                    _this.refreshPivotTable();\n                    $('#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu').hide();\n                    cleargridelement();\n                });\n                $('#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn, #luckysheet-data-pivotTable-selection .luckysheet-modal-dialog-title-close').click(function () {\n                    $('#luckysheet-modal-dialog-slider-pivot').show();\n                    luckysheetsizeauto();\n                    $('#luckysheet-cell-main .luckysheet-pivotTable-selection-set div').show();\n                    $('#luckysheet-data-pivotTable-selection').hide();\n                    Store.changeSheet(_this.pivotSheetIndex);\n                    _this.luckysheet_pivotTable_select_state = false;\n                    cleargridelement();\n                });\n                $('#luckysheet-pivotTable-selection-confirm').click(function () {\n                    let $input = $('#luckysheet-pivotTable-range-selection-input'), val = $input.val();\n                    if ($.trim(val).length == 0 || $.trim(val).toUpperCase() == _this.jgridCurrentPivotInput.toUpperCase()) {\n                        $input.val(_this.jgridCurrentPivotInput);\n                        $('#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn').click();\n                        return;\n                    } else {\n                        let val1 = val.split('!');\n                        let sheettxt = '', rangetxt = '', sheetIndex = -1;\n                        if (val1.length > 1) {\n                            sheettxt = val1[0];\n                            rangetxt = val1[1];\n                            for (let i in Store.luckysheetfile) {\n                                if (sheettxt == Store.luckysheetfile[i].name) {\n                                    sheetIndex = Store.luckysheetfile[i].index;\n                                    break;\n                                }\n                            }\n                            if (sheetIndex == -1) {\n                                sheetIndex = 0;\n                            }\n                        } else {\n                            let index = getSheetIndex(Store.currentSheetIndex);\n                            sheettxt = Store.luckysheetfile[index].name;\n                            sheetIndex = Store.luckysheetfile[index].index;\n                            rangetxt = val1[0];\n                        }\n                        if (Store.luckysheetfile[getSheetIndex(sheetIndex)].isPivotTable) {\n                            if (isEditMode()) {\n                                alert(locale_pivotTable.errorNotAllowPivotData);\n                            } else {\n                                tooltip.info('', locale_pivotTable.errorNotAllowPivotData);\n                            }\n                            $input.val(_this.jgridCurrentPivotInput);\n                            return;\n                        }\n                        if (rangetxt.indexOf(':') == -1) {\n                            if (isEditMode()) {\n                                alert(locale_pivotTable.errorSelectionRange);\n                            } else {\n                                tooltip.info('', locale_pivotTable.errorSelectionRange);\n                            }\n                            $input.val(_this.jgridCurrentPivotInput);\n                            return;\n                        }\n                        rangetxt = rangetxt.split(':');\n                        let row = [], col = [];\n                        row[0] = parseInt(rangetxt[0].replace(/[^0-9]/g, '')) - 1;\n                        row[1] = parseInt(rangetxt[1].replace(/[^0-9]/g, '')) - 1;\n                        if (row[0] > row[1]) {\n                            if (isEditMode()) {\n                                alert(locale_pivotTable.errorSelectionRange);\n                            } else {\n                                tooltip.info('', locale_pivotTable.errorSelectionRange);\n                            }\n                            $input.val(_this.jgridCurrentPivotInput);\n                            return;\n                        }\n                        col[0] = ABCatNum(rangetxt[0].replace(/[^A-Za-z]/g, ''));\n                        col[1] = ABCatNum(rangetxt[1].replace(/[^A-Za-z]/g, ''));\n                        if (col[0] > col[1]) {\n                            if (isEditMode()) {\n                                alert(locale_pivotTable.errorSelectionRange);\n                            } else {\n                                tooltip.info(locale_pivotTable.errorSelectionRange);\n                            }\n                            $input.val(_this.jgridCurrentPivotInput);\n                            return;\n                        }\n                        Store.changeSheet(_this.pivotSheetIndex);\n                        _this.setDatatojsfile('pivot_select_save', {\n                            'row': row,\n                            'column': col\n                        });\n                        _this.setDatatojsfile('pivotDataSheetIndex', sheetIndex);\n                        _this.getCellData(_this.pivotSheetIndex, sheetIndex, {\n                            'row': row,\n                            'column': col\n                        });\n                        _this.initialPivotManage();\n                        $('#luckysheet-dialog-pivotTable-range').html(val);\n                        $('#luckysheet-modal-dialog-slider-pivot').show();\n                        $('#luckysheet-data-pivotTable-selection').hide();\n                        _this.luckysheet_pivotTable_select_state = false;\n                        _this.refreshPivotTable();\n                        luckysheetsizeauto();\n                        cleargridelement();\n                    }\n                });\n                $('#luckysheet-modal-dialog-slider-pivot').on('mousedown', '.luckysheet-slider-list-item-name, .luckysheet-modal-dialog-slider-config-item-txt', function (e) {\n                    let $cur = $(e.target);\n                    _this.movestate = true;\n                    _this.movesave.obj = $cur.parent();\n                    _this.movesave.name = $cur.data('name');\n                    _this.movesave.containerid = $cur.parent().parent().attr('id');\n                    _this.movesave.index = $cur.data('index');\n                    if ($('#luckysheet-modal-dialog-slider-pivot-move').length == 0) {\n                        $('body').append('<div id=\"luckysheet-modal-dialog-slider-pivot-move\">' + _this.movesave.name + '</div>');\n                    }\n                    _this.movesave.width = $('#luckysheet-modal-dialog-slider-pivot-move').outerWidth();\n                    _this.movesave.height = $('#luckysheet-modal-dialog-slider-pivot-move').outerHeight();\n                    $('#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').css('cursor', 'default');\n                });\n                $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').mousemove(function (e) {\n                    if (_this.movestate) {\n                        if (_this.moveitemposition.length == 0) {\n                            _this.moveitemposition = [0];\n                            $(this).find('.luckysheet-modal-dialog-slider-config-item').each(function (i) {\n                                let $t = $(this), h = $t.outerHeight();\n                                _this.moveitemposition.push(_this.moveitemposition[i] + h + 2);\n                            });\n                            $(this).append('<div id=\"luckysheet-modal-dialog-config-order-help\" style=\"position:absolute;height:3px;width:100%;background:#007ACC;z-index:1;pointer-events: none;user-select:none;\"></div>');\n                        }\n                        $('#luckysheet-modal-dialog-slider-pivot-move').css({\n                            'background': '#FD8585',\n                            'color': '#fff',\n                            'border': '1px solid #FD7070'\n                        });\n                        let x = event.pageX, y = event.pageY, $container = $(this);\n                        let curtop = y - $container.offset().top + $container.scrollTop();\n                        let position = _this.moveitemposition;\n                        let row_index = luckysheet_searcharray(position, curtop);\n                        if (row_index == -1) {\n                            $('#luckysheet-modal-dialog-config-order-help').css({ 'top': position[position.length - 1] });\n                        } else if (curtop - position[row_index - 1] > (position[row_index] - position[row_index - 1]) / 2) {\n                            $('#luckysheet-modal-dialog-config-order-help').css({ 'top': position[row_index] });\n                        } else {\n                            $('#luckysheet-modal-dialog-config-order-help').css({ 'top': position[row_index - 1] });\n                        }\n                    }\n                }).mouseleave(function () {\n                    if (_this.movestate) {\n                        $('#luckysheet-modal-dialog-slider-pivot-move').css({\n                            'background': '#fff',\n                            'color': '#000',\n                            'border': '1px dotted #000'\n                        });\n                        _this.moveitemposition = [];\n                        $('#luckysheet-modal-dialog-config-order-help').remove();\n                    }\n                }).mouseup(function (e) {\n                    if (_this.movestate) {\n                        let $t = $(this);\n                        let itemHTML;\n                        if (_this.movesave.containerid == $t.attr('id')) {\n                            itemHTML = _this.movesave.obj.clone();\n                        } else {\n                            let name = _this.movesave.name, sumtype = '', nameindex = '';\n                            if ($t.attr('id') == 'luckysheet-modal-dialog-config-value') {\n                                let type = _this.pivot_data_type[_this.movesave.index.toString()];\n                                if (type == 'num') {\n                                    name = locale_pivotTable.valueStatisticsSUM + ':' + name;\n                                    sumtype = \"data-sumtype='SUM'\";\n                                    nameindex = \"data-nameindex='0'\";\n                                } else {\n                                    name = locale_pivotTable.valueStatisticsCOUNTA + ':' + name;\n                                    sumtype = \"data-sumtype='COUNTA'\";\n                                    nameindex = \"data-nameindex='0'\";\n                                }\n                                $('#luckysheet-modal-dialog-config-value').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                                    if ($(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text() == name) {\n                                        let ni = parseFloat($(this).data('nameindex')) + 1;\n                                        name = name + ni.toString();\n                                        $(this).data('nameindex', ni);\n                                        return false;\n                                    }\n                                });\n                            }\n                            itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" ' + nameindex + ' ' + sumtype + ' data-index=\"' + _this.movesave.index + '\" data-name=\"' + _this.movesave.name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" ' + nameindex + ' ' + sumtype + ' data-index=\"' + _this.movesave.index + '\" data-name=\"' + _this.movesave.name + '\">' + name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                        }\n                        let x = event.pageX, y = event.pageY, $container = $(this);\n                        let curtop = y - $container.offset().top + $container.scrollTop();\n                        let position = _this.moveitemposition;\n                        let row_index = luckysheet_searcharray(position, curtop);\n                        if (_this.movesave.containerid == 'luckysheet-modal-dialog-pivotTable-list' || _this.movesave.containerid == 'luckysheet-modal-dialog-config-value' && _this.movesave.containerid != $t.attr('id')) {\n                            $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                                if ($(this).data('index') == _this.movesave.index) {\n                                    $(this).remove();\n                                }\n                            });\n                        }\n                        if (row_index == -1) {\n                            if ($t.find('.luckysheet-modal-dialog-slider-config-item').length == 0) {\n                                $t.append(itemHTML);\n                            } else {\n                                $t.find('.luckysheet-modal-dialog-slider-config-item').last().after(itemHTML);\n                            }\n                        } else if (curtop - position[row_index - 1] > (position[row_index] - position[row_index - 1]) / 2) {\n                            $t.find('.luckysheet-modal-dialog-slider-config-item').eq(row_index - 1).after(itemHTML);\n                        } else {\n                            $t.find('.luckysheet-modal-dialog-slider-config-item').eq(row_index - 1).before(itemHTML);\n                        }\n                        if (_this.movesave.containerid == 'luckysheet-modal-dialog-pivotTable-list') {\n                        } else if (_this.movesave.containerid == 'luckysheet-modal-dialog-config-value' && _this.movesave.containerid != $t.attr('id')) {\n                        } else {\n                            _this.movesave.obj.remove();\n                        }\n                        $('#luckysheet-modal-dialog-pivotTable-list').find('.luckysheet-modal-dialog-slider-list-item').each(function () {\n                            let $seleted = $(this).find('.luckysheet-slider-list-item-selected');\n                            if ($(this).data('index') == _this.movesave.index && $seleted.find('i').length == 0) {\n                                $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                            }\n                        });\n                        _this.refreshPivotTable();\n                        $('#luckysheet-modal-dialog-slider-pivot-move').remove();\n                        _this.movestate = false;\n                        $('#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').css('cursor', 'default');\n                        _this.moveitemposition = [];\n                        $('#luckysheet-modal-dialog-config-order-help').remove();\n                        _this.showvaluecolrow();\n                        e.stopPropagation();\n                    }\n                });\n                $('#luckysheet-modal-dialog-pivotTable-list').on('click', '.luckysheet-slider-list-item-selected', function () {\n                    let $t = $(this), $item = $t.parent(), index = $item.data('index'), name = $item.data('name');\n                    if ($t.find('i').length == 0) {\n                        $t.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                        let type = _this.pivot_data_type[index.toString()], itemHTML;\n                        if (type == 'num') {\n                            itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" data-nameindex=\"0\" data-sumtype=\"SUM\" data-index=\"' + index + '\" data-name=\"' + name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" data-nameindex=\"0\" data-sumtype=\"SUM\" data-index=\"' + index + '\" data-name=\"' + name + '\">求和:' + name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                            $('#luckysheet-modal-dialog-config-value').append(itemHTML);\n                        } else {\n                            itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" data-index=\"' + index + '\" data-name=\"' + name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" data-index=\"' + index + '\" data-name=\"' + name + '\">' + name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                            let $column = $('#luckysheet-modal-dialog-config-column'), $row = $('#luckysheet-modal-dialog-config-row');\n                            let columnitem = $column.find('.luckysheet-modal-dialog-slider-config-item'), rowitem = $row.find('.luckysheet-modal-dialog-slider-config-item');\n                            if (columnitem.length < 2) {\n                                $column.append(itemHTML);\n                            } else if (rowitem.length < 2) {\n                                $row.append(itemHTML);\n                            } else {\n                                $column.append(itemHTML);\n                            }\n                        }\n                    } else {\n                        $t.find('i').remove();\n                        $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                            if ($(this).data('index') == index) {\n                                if ($(this).parent().attr('id') == 'luckysheet-modal-dialog-config-value') {\n                                    _this.resetOrderby($(this));\n                                }\n                                $(this).remove();\n                            }\n                        });\n                    }\n                    _this.refreshPivotTable();\n                    _this.showvaluecolrow();\n                });\n                $('#luckysheet-dialog-pivotTable-clearitem').click(function () {\n                    $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                        $(this).remove();\n                    });\n                    $('#luckysheet-modal-dialog-pivotTable-list').find('.luckysheet-modal-dialog-slider-list-item').each(function () {\n                        $(this).find('.luckysheet-slider-list-item-selected').find('i').remove();\n                    });\n                    _this.refreshPivotTable();\n                    _this.showvaluecolrow();\n                });\n            }\n            if (restore == null) {\n                restore = false;\n            }\n            if (_this.celldata.length <= 1 && _this.celldata[0].length <= 1) {\n                if (isEditMode()) {\n                    alert(locale_pivotTable.errorIncreaseRange);\n                } else {\n                    tooltip.info('', locale_pivotTable.errorIncreaseRange);\n                }\n            }\n            let selecteditem = '', selecteditemIndex = 1, selecteditemtest = {}, selecteditemNullIndex = 1;\n            for (let i = 0; i < _this.celldata[0].length; i++) {\n                let name;\n                if (!!_this.celldata[0][i] && !!_this.celldata[0][i]['m']) {\n                    name = _this.celldata[0][i]['m'];\n                } else {\n                    name = getcellvalue(0, i, _this.celldata);\n                }\n                if (name != null) {\n                    name = name.toString();\n                }\n                if (name == null || $.trim(name.toString()).length == 0) {\n                    name = locale_pivotTable.titleColumn + ' ' + selecteditemNullIndex;\n                }\n                selecteditemNullIndex++;\n                if (name in selecteditemtest) {\n                    name = name + selecteditemIndex++;\n                    if (name in selecteditemtest) {\n                        name = name + selecteditemIndex++;\n                        if (name in selecteditemtest) {\n                            name = name + selecteditemIndex++;\n                        }\n                    }\n                }\n                selecteditemtest[name] = 1;\n                let dataother = '', style = '';\n                if (restore && _this.filterparm != null) {\n                    if (_this.filterparm[i.toString()] != null) {\n                        let itemset = _this.filterparm[i.toString()];\n                        if (itemset.rowhidden != null) {\n                            dataother += \"data-rowhidden='\" + JSON.stringify(itemset.rowhidden) + \"'\";\n                        }\n                        if (itemset.selected != null) {\n                            dataother += \"data-selected='\" + JSON.stringify(itemset.selected) + \"'\";\n                        }\n                        if (itemset.caljs != null) {\n                            let caljsset = itemset.caljs;\n                            if (caljsset.value != null) {\n                                dataother += \"data-byconditionvalue='\" + caljsset.value + \"'\";\n                            }\n                            if (caljsset.type != null) {\n                                dataother += \"data-byconditiontype='\" + caljsset.type + \"'\";\n                            }\n                            if (caljsset.text != null) {\n                                dataother += \"data-byconditiontext='\" + caljsset.text + \"'\";\n                            }\n                            if (caljsset.value1 != null) {\n                                dataother += \"data-byconditionvalue1='\" + caljsset.value1 + \"'\";\n                            }\n                            if (caljsset.value2 != null) {\n                                dataother += \"data-byconditionvalue2='\" + caljsset.value2 + \"'\";\n                            }\n                        }\n                    }\n                }\n                if (dataother.length > 0) {\n                    style = 'display:block;';\n                }\n                selecteditem += '<div class=\"luckysheet-modal-dialog-slider-list-item\" ' + dataother + ' data-index=\"' + i + '\" data-name=\"' + name + '\"><div title=\"' + locale_pivotTable.titleAddColumn + '\" class=\"luckysheet-slider-list-item-selected\"><div></div></div><div title=\"' + locale_pivotTable.titleMoveColumn + '\" class=\"luckysheet-slider-list-item-name\" ' + dataother + ' data-index=\"' + i + '\" data-name=\"' + name + '\">' + name + '</div><div title=\"' + locale_pivotTable.titleClearColumnFilter + '\" class=\"luckysheet-slider-list-item-filtered\" style=\"' + style + '\"><i class=\"fa fa-filter luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i><i class=\"fa fa-times\" aria-hidden=\"true\"></i></div><div title=\"' + locale_pivotTable.titleFilterColumn + '\" class=\"luckysheet-slider-list-item-filter\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n            }\n            $('#luckysheet-modal-dialog-pivotTable-list').html(selecteditem);\n            $('#luckysheetpivottablevaluecolrowshow').hide();\n            $('#luckysheetpivottablevaluecolrow').prop('checked', true);\n            $('#luckysheetpivottablevaluecolrow1').prop('checked', false);\n            $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').empty();\n            if (restore) {\n                if (_this.filter != null && _this.filter.length > 0) {\n                    for (let i = 0; i < _this.filter.length; i++) {\n                        let item = _this.filter[i];\n                        let itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" data-index=\"' + item.index + '\" data-name=\"' + item.name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" data-index=\"' + item.index + '\" data-name=\"' + item.name + '\">' + item.name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                        $('#luckysheet-modal-dialog-config-filter').append(itemHTML);\n                        let $seleted = $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(item.index).find('.luckysheet-slider-list-item-selected');\n                        if ($seleted.find('i').length == 0) {\n                            $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                        }\n                    }\n                }\n                if (_this.row != null && _this.row.length > 0) {\n                    for (let i = 0; i < _this.row.length; i++) {\n                        let item = _this.row[i];\n                        let otherset = '';\n                        if (item.order != null) {\n                            otherset += \"data-order = '\" + item.order + \"'\";\n                        }\n                        if (item.orderby != null) {\n                            otherset += \"data-orderby = '\" + item.orderby + \"'\";\n                        }\n                        if (item.order != null) {\n                            otherset += \"data-stastic = '\" + item.stastic + \"'\";\n                        }\n                        let itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\">' + item.name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                        $('#luckysheet-modal-dialog-config-row').append(itemHTML);\n                        let $seleted = $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(item.index).find('.luckysheet-slider-list-item-selected');\n                        if ($seleted.find('i').length == 0) {\n                            $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                        }\n                    }\n                }\n                if (_this.column != null && _this.column.length > 0) {\n                    for (let i = 0; i < _this.column.length; i++) {\n                        let item = _this.column[i];\n                        let otherset = '';\n                        if (item.order != null) {\n                            otherset += \"data-order = '\" + item.order + \"'\";\n                        }\n                        if (item.orderby != null) {\n                            otherset += \"data-orderby = '\" + item.orderby + \"'\";\n                        }\n                        if (item.order != null) {\n                            otherset += \"data-stastic = '\" + item.stastic + \"'\";\n                        }\n                        let itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\">' + item.name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                        $('#luckysheet-modal-dialog-config-column').append(itemHTML);\n                        let $seleted = $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(item.index).find('.luckysheet-slider-list-item-selected');\n                        if ($seleted.find('i').length == 0) {\n                            $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                        }\n                    }\n                }\n                if (_this.values != null && _this.values.length > 0) {\n                    for (let i = 0; i < _this.values.length; i++) {\n                        let item = _this.values[i];\n                        let otherset = '';\n                        if (item.sumtype != null) {\n                            otherset += \"data-sumtype = '\" + item.sumtype + \"'\";\n                        }\n                        if (item.nameindex != null) {\n                            otherset += \"data-nameindex = '\" + item.nameindex + \"'\";\n                        }\n                        let itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\">' + _this.getSumTypeName(item.sumtype) + ':' + item.name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                        $('#luckysheet-modal-dialog-config-value').append(itemHTML);\n                        let $seleted = $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(item.index).find('.luckysheet-slider-list-item-selected');\n                        if ($seleted.find('i').length == 0) {\n                            $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                        }\n                    }\n                    if (_this.values.length >= 2) {\n                        $('#luckysheetpivottablevaluecolrowshow').show();\n                        if (_this.showType == 'column') {\n                            $('#luckysheetpivottablevaluecolrow').prop('checked', true);\n                            $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']\").addClass('ui-state-active');\n                            $('#luckysheetpivottablevaluecolrow1').prop('checked', false);\n                            $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']\").removeClass('ui-state-active');\n                        } else {\n                            $('#luckysheetpivottablevaluecolrow1').prop('checked', true);\n                            $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']\").addClass('ui-state-active');\n                            $('#luckysheetpivottablevaluecolrow').prop('checked', false);\n                            $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']\").removeClass('ui-state-active');\n                        }\n                    }\n                }\n            }\n            $('#luckysheet-dialog-pivotTable-range').html(getRangetxt(_this.pivotDataSheetIndex, _this.pivot_select_save));\n            $('#luckysheet-modal-dialog-slider-pivot').show();\n            luckysheetsizeauto(false);\n        },\n        drillDown: function (row_index, col_index) {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'usePivotTablereports')) {\n                return;\n            }\n            let _this = this;\n            let cell = _this.pivotDatas[row_index][col_index];\n            let d = $.extend(true, [], sheets.nulldata);\n            const _locale = locale();\n            const locale_filter = _locale.filter;\n            const locale_pivotTable = _locale.pivotTable;\n            let selecteditemNullIndex = 1;\n            for (let i = 0; i < _this.celldata[0].length; i++) {\n                let name;\n                if (!!_this.celldata[0][i] && !!_this.celldata[0][i]['m']) {\n                    name = _this.celldata[0][i]['m'];\n                } else {\n                    name = getcellvalue(0, i, _this.celldata);\n                }\n                if (name != null) {\n                    name = name.toString();\n                }\n                if (name == null || $.trim(name.toString()).length == 0) {\n                    name = locale_pivotTable.titleColumn + ' ' + selecteditemNullIndex;\n                }\n                selecteditemNullIndex++;\n                d[0][i] = name;\n            }\n            let obj = {};    //行\n            //行\n            if (_this.row != null && _this.row.length > 0) {\n                for (let a = 0; a < _this.row.length; a++) {\n                    obj[_this.row[a]['index']] = _this.pivotDatas[row_index][a];\n                }\n            }    //列\n            //列\n            if (_this.column != null && _this.column.length > 0) {\n                for (let b = 0; b < _this.column.length; b++) {\n                    obj[_this.column[b]['index']] = _this.pivotDatas[b][col_index];\n                }\n            }\n            let rowArr = [];\n            for (let j = 1; j < _this.celldata.length; j++) {\n                let isEqual = true;\n                for (let x in obj) {\n                    let value;\n                    if (!!_this.celldata[j][x] && !!_this.celldata[j][x]['m']) {\n                        value = _this.celldata[j][x]['m'];\n                    } else {\n                        value = getcellvalue(j, x, _this.celldata);\n                    }\n                    if (value != null) {\n                        value = value.toString();\n                    } else {\n                        value = locale_filter.valueBlank;\n                    }\n                    if (value != obj[x]) {\n                        isEqual = false;\n                        break;\n                    }\n                }\n                if (isEqual) {\n                    rowArr.push(j);\n                }\n            }\n            for (let r = 0; r < rowArr.length; r++) {\n                for (let c = 0; c < _this.celldata[0].length; c++) {\n                    let value;\n                    if (!!_this.celldata[rowArr[r]][c] && !!_this.celldata[rowArr[r]][c]['m']) {\n                        value = _this.celldata[rowArr[r]][c]['m'];\n                    } else {\n                        value = getcellvalue(rowArr[r], c, _this.celldata);\n                    }\n                    if (value != null) {\n                        value = value.toString();\n                    } else {\n                        value = '';\n                    }\n                    d[r + 1][c] = value;\n                }\n            }\n            Store.luckysheet_select_save = [{\n                    'row': [\n                        0,\n                        rowArr.length\n                    ],\n                    'column': [\n                        0,\n                        _this.celldata[0].length - 1\n                    ]\n                }];\n            Store.clearjfundo = false;\n            ///jfrefreshgrid(d, Store.luckysheet_select_save);\n            Store.refreshGrid(d, Store.luckysheet_select_save);\n            selectHightlightShow();\n            Store.clearjfundo = true;\n        }\n    });\n    return pivotTable;\n});"]}