{"version":3,"sources":["controllers/pivotTable.js"],"names":["define","m_get","m_util","m_getdata","m_datecontroll","m_format","m_validate","m_sort","m_refresh","tooltip","editor","cleargridelement","luckysheetArray","analysis","m_select","m_sheetSearch","m_constant","sheetmanage","luckysheetsizeauto","server","m_protection","Store","locale","numeral","getSheetIndex","getRangetxt","replaceHtml","getObjType","ABCatNum","numFormat","numfloatlen","showrightclickmenu","mouseclickposition","getdatabyselectionD","getcellvalue","datagridgrowth","isdatetime","diff","isdatatypemulti","isdatatype","genarate","update","isRealNull","isEditMode","orderbydata1D","jfrefreshgrid","jfrefreshgridall","selectHightlightShow","luckysheet_searcharray","modelHTML","filtermenuHTML","filtersubmenuHTML","pivottableconfigHTML","pivottablesumHTML","luckysheetPivotTableHTML","checkProtectionAuthorityNormal","pivotDatas","pivotSheetIndex","pivotDataSheetIndex","celldata","origindata","getCellData","cursheetindex","datasheetindex","data_select_save","sheetIndex","_this","this","currentSheetIndex","realIndex","luckysheetfile","pivotTable","Function","column","row","values","filter","showType","filterparm","drawPivotTable","pivotTableBoundary","pivot_select_save","luckysheet_select_save","pivotrealIndex","otherfile","buildGridData","data","rowhidden","f","h","$","extend","newdata","i","length","push","concat","pivot_data_type","c","type","toString","selected","caljs","initial","luckysheet_pivotTable_select_state","jgridCurrentPivotInput","movestate","moveitemposition","movesave","showvaluecolrow","show","prop","addClass","removeClass","hide","resetOrderby","obj","orderby","index","find","each","luckysheetsliderlistclearfilter","$filter","$t","parent","cindex","d","setDatatojsfile","refreshPivotTable","luckysheetsliderlistitemfilter","locale_filter","toffset","offset","$menu","winH","window","height","width","JSON","parse","val","next","text","filiterInputNone","byconditiontype","$input","eq","empty","html","filiterMoreDataTip","rowhiddenother","not","get","rh","r","setTimeout","dvmap","dvmap_uncheck","vmap","vmap_uncheck","cell","ct","t","v","y","split","m","item","stringify","yearHtml","ysum","monthHtml","mT2","msum","dayHtml","mT","dT","dayL","Number","filiterMonthText","filiterYearText","unshift","vmapKeys","Object","keys","x","dataHtml","valueBlank","top","join","left","getSumTypeName","name","locale_pivotTable","valueStatisticsSUM","valueStatisticsCOUNT","valueStatisticsCOUNTA","valueStatisticsCOUNTUNIQUE","valueStatisticsAVERAGE","valueStatisticsMAX","valueStatisticsMIN","valueStatisticsMEDIAN","valueStatisticsPRODUCT","valueStatisticsSTDEV","valueStatisticsSTDEVP","valueStatisticslet","valueStatisticsVARP","attr","value","createPivotTable","e","allowEdit","alert","errorNotAllowEdit","info","errorNotAllowMulti","errorSelectRange","select_save","addNewSheet","initialPivotManage","changePivotTable","errorIsDamage","isRefreshCanvas","redo","deepCopyFlowData","flowdata","storePivotTableParam","ret","dataHandler","nulldata","addr","addc","rlen","clen","getPivotTableData","clearjfundo","jfundo","jfredo","undefined","pivotclick","row_index","col_index","file","isPivotTable","slider","isRangeClick","isPivotRange","is","css","luckysheetcurrentisPivotTable","columnarr","rowarr","filterarr","valuesarr","showtype","saveParam","k","dataindex","addValuesToTitle","titles","rowLen","colLen","retdata","fullname","Array","Math","floor","restore","_locale","locale_button","button","append","click","id","addclass","title","titleSelectionDataRange","content","titleDataRange","botton","confirm","cancel","menuid","remove","checkboxradio","icon","change","hidefilersubmenu","mouseover","clearTimeout","document","off","on","removeAttr","parents","yearDayAllCheck","monthDayAllCheck","$p","hasClass","slideToggle","event","day","siblings","month","indexOf","slideUp","slideDown","winW","menuW","mheight","stopPropagation","myh","outerHeight","myw","outerWidth","winw","winh","scrollLeft","scrollTop","$item","target","closest","order","stastic","option","replace","sumtype","filterdata","value1","valuelen","substr","parseInt","parseFloat","min","max","value2","year","itemV","filterDateFormatTip","fmt","$top","changeSheetExec","trim","toUpperCase","val1","sheettxt","rangetxt","errorNotAllowPivotData","errorSelectionRange","col","$cur","containerid","mousemove","background","color","border","pageX","pageY","$container","curtop","position","mouseleave","mouseup","itemHTML","clone","nameindex","ni","last","after","before","$seleted","$column","$row","columnitem","rowitem","errorIncreaseRange","selecteditem","selecteditemIndex","selecteditemtest","selecteditemNullIndex","titleColumn","dataother","style","itemset","caljsset","titleAddColumn","titleMoveColumn","titleClearColumnFilter","titleFilterColumn","otherset","getComposeArray","getnameArray","field","c_value","getTitleFromGroup","group","config","dataposition","orderbygroup","generategrouparraymain","stackset","alllength","alllengthInital","a","children","orderbygroupchildren","splice","childrens","isAsc","s","result","isNaN","localeCompare","sort","generategroupaddstatic","arr","stasticarr","valueSum","issum","generategrouparray","level","addStatisticsData","valueobj","indicator","d_value","count","Infinity","counta","countunique","countuniquedata","sum","digitaldata","acc","num","newAcc","datarowtitle","datarowtitlegroup","datarowposition","datacoltitle","datacoltitlegroup","datacolposition","rowtitle","rowtitlename","coltitle","coltitlename","curentLevelobj_row","curentLevelarr_row","curentLevelobj_col","curentLevelarr_col","coltitle_c","rowtitle_c","slice","json","numArr","b","numLen","numindex","mean","STDEV","STDEVP","let","VARP","datacoltitle_index","transpose","valuenslen","rowOver","colOver","drt","prefix","suffix","dct","titleRow","newRetdata","drillDown","rowArr","j","isEqual"],"mappings":"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","file":"../../controllers/pivotTable.js","sourcesContent":["define([\n    '../methods/get',\n    '../utils/util',\n    '../global/getdata',\n    '../global/datecontroll',\n    '../global/format',\n    '../global/validate',\n    '../global/sort',\n    '../global/refresh',\n    '../global/tooltip',\n    '../global/editor',\n    '../global/cleargridelement',\n    '../global/array',\n    '../global/analysis',\n    './select',\n    './sheetSearch',\n    './constant',\n    './sheetmanage',\n    './resize',\n    './server',\n    './protection',\n    '../store',\n    '../locale/locale',\n    '../vendors/numeral'\n], function (m_get, m_util, m_getdata, m_datecontroll, m_format, m_validate, m_sort, m_refresh, tooltip, editor, cleargridelement, luckysheetArray, analysis, m_select, m_sheetSearch, m_constant, sheetmanage, luckysheetsizeauto, server, m_protection, Store, locale, numeral) {\n    'use strict';\n    const {getSheetIndex, getRangetxt} = m_get;\n    const {replaceHtml, getObjType, ABCatNum, numFormat, numfloatlen, showrightclickmenu, mouseclickposition} = m_util;\n    const {getdatabyselectionD, getcellvalue, datagridgrowth} = m_getdata;\n    const {isdatetime, diff, isdatatypemulti, isdatatype} = m_datecontroll;\n    const {genarate, update} = m_format;\n    const {isRealNull, isEditMode} = m_validate;\n    const {orderbydata1D} = m_sort;\n    const {jfrefreshgrid, jfrefreshgridall} = m_refresh;\n    const {selectHightlightShow} = m_select;\n    const {luckysheet_searcharray} = m_sheetSearch;\n    const {modelHTML, filtermenuHTML, filtersubmenuHTML, pivottableconfigHTML, pivottablesumHTML, luckysheetPivotTableHTML} = m_constant;\n    const {checkProtectionAuthorityNormal} = m_protection;\n    const pivotTable = {\n        pivotDatas: null,\n        pivotSheetIndex: 0,\n        pivotDataSheetIndex: 0,\n        celldata: null,\n        origindata: null,\n        getCellData: function (cursheetindex, datasheetindex, data_select_save) {\n            let _this = this;\n            let sheetIndex;\n            if (cursheetindex != null) {\n                sheetIndex = cursheetindex;\n            } else {\n                sheetIndex = Store.currentSheetIndex;\n            }\n            let realIndex = getSheetIndex(sheetIndex);\n            if (getObjType(Store.luckysheetfile[realIndex].pivotTable) != 'object') {\n                Store.luckysheetfile[realIndex].pivotTable = new Function('return ' + Store.luckysheetfile[realIndex].pivotTable)();\n            }\n            if (Store.luckysheetfile[realIndex].pivotTable != null) {\n                _this.column = Store.luckysheetfile[realIndex].pivotTable.column;\n                _this.row = Store.luckysheetfile[realIndex].pivotTable.row;\n                _this.values = Store.luckysheetfile[realIndex].pivotTable.values;\n                _this.filter = Store.luckysheetfile[realIndex].pivotTable.filter;\n                _this.showType = Store.luckysheetfile[realIndex].pivotTable.showType;\n                _this.filterparm = Store.luckysheetfile[realIndex].pivotTable.filterparm;\n                if (Store.luckysheetfile[realIndex].pivotTable.drawPivotTable != null) {\n                    _this.drawPivotTable = Store.luckysheetfile[realIndex].pivotTable.drawPivotTable;\n                } else {\n                    _this.drawPivotTable = true;\n                }\n                if (Store.luckysheetfile[realIndex].pivotTable.pivotTableBoundary != null) {\n                    _this.pivotTableBoundary = Store.luckysheetfile[realIndex].pivotTable.pivotTableBoundary;\n                } else {\n                    _this.pivotTableBoundary = [\n                        12,\n                        6\n                    ];\n                }\n                if (data_select_save != null) {\n                    _this.pivot_select_save = data_select_save;\n                } else {\n                    _this.pivot_select_save = Store.luckysheetfile[realIndex].pivotTable.pivot_select_save;\n                }\n                if (datasheetindex != null) {\n                    _this.pivotDataSheetIndex = datasheetindex;\n                } else {\n                    _this.pivotDataSheetIndex = Store.luckysheetfile[realIndex].pivotTable.pivotDataSheetIndex;\n                }\n            } else {\n                _this.column = null;\n                _this.row = null;\n                _this.values = null;\n                _this.filter = null;\n                _this.showType = null;\n                _this.filterparm = null;\n                _this.drawPivotTable = true;\n                _this.pivotTableBoundary = [\n                    12,\n                    6\n                ];\n                if (data_select_save != null) {\n                    _this.pivot_select_save = data_select_save;\n                } else {\n                    _this.pivot_select_save = Store.luckysheet_select_save;\n                }\n                if (datasheetindex != null) {\n                    _this.pivotDataSheetIndex = datasheetindex;\n                } else {\n                    _this.pivotDataSheetIndex = sheetIndex;\n                }\n            }\n            let pivotrealIndex = getSheetIndex(_this.pivotDataSheetIndex);\n            let otherfile = Store.luckysheetfile[pivotrealIndex];\n            if (otherfile['data'] == null) {\n                otherfile['data'] = sheetmanage.buildGridData(otherfile);\n            }\n            _this.origindata = getdatabyselectionD(otherfile.data, _this.pivot_select_save);\n            let rowhidden = {};\n            if (_this.filterparm != null) {\n                for (let f in _this.filterparm) {\n                    // rowhidden\n                    for (let h in _this.filterparm[f]) {\n                        if (h === 'rowhidden' && _this.filterparm[f][h] != null) {\n                            rowhidden = $.extend(true, rowhidden, _this.filterparm[f][h]);\n                        }\n                    }\n                }\n            }\n            _this.rowhidden = rowhidden;\n            _this.pivotSheetIndex = sheetIndex;\n            let newdata = [];\n            for (let i = 0; i < _this.origindata.length; i++) {\n                if (_this.rowhidden != null && _this.rowhidden[i] != null) {\n                    continue;\n                }\n                newdata.push([].concat(_this.origindata[i]));\n            }\n            _this.celldata = newdata;\n            _this.pivot_data_type = {};\n            for (let c = 0; c < _this.celldata[1].length; c++) {\n                let type = isdatatype(_this.celldata[1][c]);\n                _this.pivot_data_type[c.toString()] = type;\n            }\n        },\n        pivot_data_type: {},\n        pivot_select_save: null,\n        column: null,\n        row: null,\n        values: null,\n        filter: null,\n        showType: null,\n        rowhidden: null,\n        selected: null,\n        caljs: null,\n        initial: true,\n        filterparm: null,\n        luckysheet_pivotTable_select_state: false,\n        jgridCurrentPivotInput: null,\n        movestate: false,\n        moveitemposition: [],\n        movesave: {},\n        showvaluecolrow: function () {\n            let _this = this;\n            if ($('#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item').length >= 2) {\n                $('#luckysheetpivottablevaluecolrowshow').show();\n                if (_this.showType == 'column') {\n                    $('#luckysheetpivottablevaluecolrow').prop('checked', true);\n                    $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']\").addClass('ui-state-active');\n                    $('#luckysheetpivottablevaluecolrow1').prop('checked', false);\n                    $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']\").removeClass('ui-state-active');\n                } else {\n                    $('#luckysheetpivottablevaluecolrow1').prop('checked', true);\n                    $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']\").addClass('ui-state-active');\n                    $('#luckysheetpivottablevaluecolrow').prop('checked', false);\n                    $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']\").removeClass('ui-state-active');\n                }\n            } else {\n                $('#luckysheetpivottablevaluecolrowshow').hide();\n            }\n        },\n        resetOrderby: function (obj) {\n            let orderby = $('#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item').index(obj);\n            $('#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                if ($(this).data('orderby') == orderby) {\n                    $(this).data('orderby', 'self');\n                }\n            });\n        },\n        luckysheetsliderlistclearfilter: function ($filter) {\n            let _this = this;\n            let $t = $filter.parent();\n            let cindex = $t.data('index');\n            let rowhidden = {}, selected = {}, d = _this.origindata, filterdata = {};\n            $t.data('rowhidden', '').find('.luckysheet-slider-list-item-filtered').hide();\n            _this.setDatatojsfile('selected', {}, cindex);\n            _this.setDatatojsfile('rowhidden', null, cindex);\n            let newdata = [];\n            for (let i = 0; i < d.length; i++) {\n                if (rowhidden[i] != null) {\n                    continue;\n                }\n                newdata.push([].concat(d[i]));\n            }\n            _this.celldata = newdata;\n            _this.refreshPivotTable();\n            $('#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu').hide();\n        },\n        luckysheetsliderlistitemfilter: function ($filter) {\n            let _this = this;\n            const _locale = locale();\n            const locale_filter = _locale.filter;\n            let $t = $filter.parent(), toffset = $t.offset(), $menu = $('#luckysheet-pivotTableFilter-menu'), winH = $(window).height(), winW = $(window).width();\n            let cindex = $t.data('index');\n            let rowhidden = $t.data('rowhidden');\n            if (rowhidden == null || rowhidden == '') {\n                rowhidden = {};\n            } else if (getObjType(rowhidden) == 'string') {\n                rowhidden = JSON.parse(rowhidden);\n            }\n            $('body .luckysheet-cols-menu').hide();\n            $('#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu').hide();\n            $('#luckysheet-pivotTableFilter-byvalue-input').val('');\n            $('#luckysheet-pivotTableFilter-bycondition').next().hide();\n            $('#luckysheet-pivotTableFilter-byvalue').next().show();\n            $menu.data('index', cindex);\n            $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').hide().find('input').val();\n            $('#luckysheet-pivotTableFilter-selected span').data('type', '0').data('type', null).text(locale_filter.filiterInputNone);\n            let byconditiontype = $t.data('byconditiontype');\n            $('#luckysheet-pivotTableFilter-selected span').data('value', $t.data('byconditionvalue')).data('type', byconditiontype).text($t.data('byconditiontext'));\n            if (byconditiontype == '2') {\n                let $input = $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2').show().find('input');\n                $input.eq(0).val($t.data('byconditionvalue1'));\n                $input.eq(1).val($t.data('byconditionvalue2'));\n            } else if (byconditiontype == '1') {\n                $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').eq(0).show().find('input').val($t.data('byconditionvalue1'));\n            }\n            $('#luckysheet-pivotTableFilter-byvalue-select').empty().html('<div style=\"width:100%;text-align:center;position:relative;top:45%;font-size: 14px;\"> <div class=\"luckysheetLoaderGif\"> </div> <span>' + locale_filter.filiterMoreDataTip + '</span></div>');\n            let rowhiddenother = {};    //\n            //\n            $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').not($t.get(0)).each(function () {\n                let $t = $(this), rh = $t.data('rowhidden');\n                if (rh == null || rh == '') {\n                    return true;\n                }\n                if (getObjType(rh) == 'string') {\n                    rh = JSON.parse(rh);\n                }\n                for (let r in rh) {\n                    rowhiddenother[r] = 0;\n                }\n            });\n            let data = _this.origindata;\n            setTimeout(function () {\n                //\n                let dvmap = {};\n                let dvmap_uncheck = {};    //\n                //\n                let vmap = {};\n                let vmap_uncheck = {};\n                for (let r = 1; r < data.length; r++) {\n                    if (r in rowhiddenother) {\n                        continue;\n                    }\n                    if (data[r] == null) {\n                        continue;\n                    }\n                    let cell = data[r][cindex];\n                    if (cell != null && cell.ct != null && cell.ct.t == 'd') {\n                        //\n                        let v = update('YYYY-MM-DD', cell.v);\n                        let y = v.split('-')[0];\n                        let m = v.split('-')[1];\n                        let d = v.split('-')[2];\n                        if (!(y in dvmap)) {\n                            dvmap[y] = {};\n                        }\n                        if (!(m in dvmap[y])) {\n                            dvmap[y][m] = {};\n                        }\n                        if (!(d in dvmap[y][m])) {\n                            dvmap[y][m][d] = 0;\n                        }\n                        dvmap[y][m][d]++;\n                        if (r in rowhidden) {\n                            dvmap_uncheck[y] = 0;\n                            dvmap_uncheck[m] = 0;\n                            dvmap_uncheck[d] = 0;\n                        }\n                    } else {\n                        let v, m;\n                        if (cell == null || isRealNull(cell.v)) {\n                            v = null;\n                            m = null;\n                        } else {\n                            v = cell.v;\n                            m = cell.m;\n                        }\n                        if (!(v in vmap)) {\n                            vmap[v] = {};\n                        }\n                        if (!(m in vmap[v])) {\n                            vmap[v][m] = 0;\n                        }\n                        vmap[v][m]++;\n                        if (r in rowhidden) {\n                            vmap_uncheck[v + '#$$$#' + m] = 0;\n                        }\n                    }\n                }    //\n                //\n                let item = [];\n                if (JSON.stringify(dvmap).length > 2) {\n                    for (let y in dvmap) {\n                        let ysum = 0;\n                        let monthHtml = '';\n                        for (let m in dvmap[y]) {\n                            let msum = 0;\n                            let dayHtml = '';\n                            for (let d in dvmap[y][m]) {\n                                let dayL = dvmap[y][m][d];\n                                msum += dayL;    //  10\n                                //  10\n                                let mT;\n                                if (Number(m) < 10) {\n                                    mT = '0' + Number(m);\n                                } else {\n                                    mT = m;\n                                }    //  10\n                                //  10\n                                let dT;\n                                if (Number(d) < 10) {\n                                    dT = '0' + Number(d);\n                                } else {\n                                    dT = d;\n                                }    //\n                                //\n                                if (y in dvmap_uncheck && m in dvmap_uncheck && d in dvmap_uncheck) {\n                                    dayHtml += '<div class=\"day luckysheet-mousedown-cancel cf\" data-check=\"false\" title=\"' + y + '-' + mT + '-' + dT + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + d + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + dayL + ' )</span>' + '</div>';\n                                } else {\n                                    dayHtml += '<div class=\"day luckysheet-mousedown-cancel cf\" data-check=\"true\" title=\"' + y + '-' + mT + '-' + dT + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + d + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + dayL + ' )</span>' + '</div>';\n                                }\n                            }\n                            ysum += msum;    //  10\n                            //  10\n                            let mT2;\n                            if (Number(m) < 10) {\n                                mT2 = '0' + Number(m);\n                            } else {\n                                mT2 = m;\n                            }    //\n                            //\n                            if (y in dvmap_uncheck && m in dvmap_uncheck) {\n                                monthHtml += '<div class=\"monthBox luckysheet-mousedown-cancel\">' + '<div class=\"month luckysheet-mousedown-cancel cf\" data-check=\"false\" title=\"' + y + '-' + mT2 + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + m + '' + locale_filter.filiterMonthText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + msum + ' )</span>' + '</div>' + '<div class=\"dayList luckysheet-mousedown-cancel\">' + dayHtml + '</div>' + '</div>';\n                            } else {\n                                monthHtml += '<div class=\"monthBox luckysheet-mousedown-cancel\">' + '<div class=\"month luckysheet-mousedown-cancel cf\" data-check=\"true\" title=\"' + y + '-' + mT2 + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + m + '' + locale_filter.filiterMonthText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + msum + ' )</span>' + '</div>' + '<div class=\"dayList luckysheet-mousedown-cancel\">' + dayHtml + '</div>' + '</div>';\n                            }\n                        }    //\n                        //\n                        let yearHtml;\n                        if (y in dvmap_uncheck) {\n                            yearHtml = '<div class=\"yearBox luckysheet-mousedown-cancel\">' + '<div class=\"year luckysheet-mousedown-cancel cf\" data-check=\"false\" title=\"' + y + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + y + '' + locale_filter.filiterYearText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + ysum + ' )</span>' + '</div>' + '<div class=\"monthList luckysheet-mousedown-cancel\">' + monthHtml + '</div>' + '</div>';\n                        } else {\n                            yearHtml = '<div class=\"yearBox luckysheet-mousedown-cancel\">' + '<div class=\"year luckysheet-mousedown-cancel cf\" data-check=\"true\" title=\"' + y + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + y + '' + locale_filter.filiterYearText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + ysum + ' )</span>' + '</div>' + '<div class=\"monthList luckysheet-mousedown-cancel\">' + monthHtml + '</div>' + '</div>';\n                        }\n                        item.unshift(yearHtml);\n                    }\n                }\n                if (JSON.stringify(vmap).length > 2) {\n                    let vmapKeys = Object.keys(vmap);\n                    vmapKeys = orderbydata1D(vmapKeys, true);\n                    for (let i = 0; i < vmapKeys.length; i++) {\n                        let v = vmapKeys[i];\n                        for (let x in vmap[v]) {\n                            let text;\n                            if (v + '#$$$#' + x == 'null#$$$#null') {\n                                text = locale_filter.valueBlank;\n                            } else {\n                                text = x;\n                            }    //\n                            //\n                            let dataHtml;\n                            if (v + '#$$$#' + x in vmap_uncheck) {\n                                dataHtml = '<div class=\"textBox luckysheet-mousedown-cancel cf\" data-check=\"false\" data-filter=\"' + (v + '#$$$#' + x) + '\" title=\"' + x + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + text + '</label>' + '<span class=\"luckysheet-mousedown-cancel count\">( ' + vmap[v][x] + ' )</span>' + '</div>';\n                            } else {\n                                dataHtml = '<div class=\"textBox luckysheet-mousedown-cancel cf\" data-check=\"true\" data-filter=\"' + (v + '#$$$#' + x) + '\" title=\"' + x + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + text + '</label>' + '<span class=\"luckysheet-mousedown-cancel count\">( ' + vmap[v][x] + ' )</span>' + '</div>';\n                            }\n                            item.push(dataHtml);\n                        }\n                    }\n                }\n                $('#luckysheet-pivotTableFilter-byvalue-select').html(\"<div class='ListBox luckysheet-mousedown-cancel' style='max-height:\" + (winH - toffset.top - 350) + \"px;overflow-y:auto;overflow-x:hidden;'>\" + item.join('') + '</div>');\n            }, 1);\n            showrightclickmenu($menu, toffset.left - 250, toffset.top);\n        },\n        getSumTypeName: function (type) {\n            let name = '';\n            const _locale = locale();\n            const locale_pivotTable = _locale.pivotTable;\n            if (type == 'SUM') {\n                name = locale_pivotTable.valueStatisticsSUM;\n            } else if (type == 'COUNT') {\n                name = locale_pivotTable.valueStatisticsCOUNT;\n            } else if (type == 'COUNTA') {\n                name = locale_pivotTable.valueStatisticsCOUNTA;\n            } else if (type == 'COUNTUNIQUE') {\n                name = locale_pivotTable.valueStatisticsCOUNTUNIQUE;\n            } else if (type == 'AVERAGE') {\n                name = locale_pivotTable.valueStatisticsAVERAGE;\n            } else if (type == 'MAX') {\n                name = locale_pivotTable.valueStatisticsMAX;\n            } else if (type == 'MIN') {\n                name = locale_pivotTable.valueStatisticsMIN;\n            } else if (type == 'MEDIAN') {\n                name = locale_pivotTable.valueStatisticsMEDIAN;\n            } else if (type == 'PRODUCT') {\n                name = locale_pivotTable.valueStatisticsPRODUCT;\n            } else if (type == 'STDEV') {\n                name = locale_pivotTable.valueStatisticsSTDEV;\n            } else if (type == 'STDEVP') {\n                name = locale_pivotTable.valueStatisticsSTDEVP;\n            } else if (type == 'let') {\n                name = locale_pivotTable.valueStatisticslet;\n            } else if (type == 'VARP') {\n                name = locale_pivotTable.valueStatisticsVARP;\n            }\n            return name;\n        },\n        setDatatojsfile: function (attr, value, cindex) {\n            let _this = this;\n            let index = getSheetIndex(_this.pivotSheetIndex);\n            if (Store.luckysheetfile[index]['pivotTable'] == null) {\n                Store.luckysheetfile[index]['pivotTable'] = {};\n            }\n            if (cindex == null) {\n                Store.luckysheetfile[index]['pivotTable'][attr] = value;\n                _this[attr] = value;\n            } else {\n                if (Store.luckysheetfile[index]['pivotTable']['filterparm'] == null) {\n                    Store.luckysheetfile[index]['pivotTable']['filterparm'] = {};\n                }\n                if (Store.luckysheetfile[index]['pivotTable']['filterparm'][cindex.toString()] == null) {\n                    Store.luckysheetfile[index]['pivotTable']['filterparm'][cindex.toString()] = {};\n                }\n                Store.luckysheetfile[index]['pivotTable']['filterparm'][cindex.toString()][attr] = value;\n                if (_this['filterparm'] == null) {\n                    _this['filterparm'] = {};\n                }\n                if (_this['filterparm'][cindex.toString()] == null) {\n                    _this['filterparm'][cindex.toString()] = {};\n                }\n                _this['filterparm'][cindex.toString()][attr] = value;\n            }\n        },\n        createPivotTable: function (e) {\n            if (isEditMode() || Store.allowEdit === false) {\n                return;\n            }\n            let _this = this;\n            let datasheetindex = Store.currentSheetIndex;\n            const _locale = locale();\n            const locale_pivotTable = _locale.pivotTable;\n            if (isEditMode()) {\n                alert(locale_pivotTable.errorNotAllowEdit);\n                return;\n            }\n            if (Store.luckysheet_select_save.length > 1) {\n                tooltip.info('', locale_pivotTable.errorNotAllowMulti);\n                return;\n            }\n            if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1] || Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                tooltip.info('', locale_pivotTable.errorSelectRange);\n                return;\n            }\n            let select_save = $.extend(true, {}, Store.luckysheet_select_save[0]);\n            sheetmanage.addNewSheet(e, true);\n            _this.getCellData(Store.currentSheetIndex, datasheetindex, select_save);\n            _this.setDatatojsfile('pivot_select_save', select_save);\n            _this.setDatatojsfile('pivotDataSheetIndex', datasheetindex);\n            _this.initialPivotManage();\n        },\n        changePivotTable: function (index) {\n            let _this = this;\n            const _locale = locale();\n            const locale_pivotTable = _locale.pivotTable;\n            let pivotDataSheetIndex = Store.luckysheetfile[getSheetIndex(index)].pivotTable.pivotDataSheetIndex;\n            let real_pivotDataSheetIndex = getSheetIndex(pivotDataSheetIndex);\n            if (real_pivotDataSheetIndex == null) {\n                tooltip.info(locale_pivotTable.errorIsDamage, '');\n                return;\n            }\n            _this.getCellData(index);\n            _this.initialPivotManage(true);\n            _this.refreshPivotTable();    //sheetsheet\n        },\n        //sheetsheet\n        refreshPivotTable: function (isRefreshCanvas = true) {\n            let _this = this;\n            let redo = {};\n            redo['pivotTable'] = pivotTable;\n            redo['data'] = editor.deepCopyFlowData(Store.flowdata);    //\n            //\n            _this.storePivotTableParam();\n            let ret = _this.dataHandler(_this.column, _this.row, _this.values, _this.showType, _this.celldata);\n            _this.setDatatojsfile('pivotDatas', ret);\n            let d = $.extend(true, [], sheetmanage.nulldata);\n            let data = d;\n            let addr = 0, addc = 0;\n            if (ret.length == 0) {\n                _this.setDatatojsfile('drawPivotTable', true);\n                _this.setDatatojsfile('pivotTableBoundary', [\n                    12,\n                    6\n                ]);\n            } else {\n                _this.setDatatojsfile('drawPivotTable', false);\n                _this.setDatatojsfile('pivotTableBoundary', [\n                    ret.length,\n                    ret[0].length\n                ]);\n                let rlen = ret.length, clen = ret[0].length;\n                addr = rlen - d.length;\n                addc = clen - d[0].length;\n                data = datagridgrowth(d, addr + 20, addc + 10, true);\n                for (let r = 0; r < rlen; r++) {\n                    let x = [].concat(data[r]);\n                    for (let c = 0; c < clen; c++) {\n                        let value = '';\n                        if (ret[r] != null && ret[r][c] != null) {\n                            value = getcellvalue(r, c, ret);\n                        }\n                        x[c] = value;\n                    }\n                    data[r] = x;\n                }\n            }\n            redo['type'] = 'pivotTable_change';\n            redo['curdata'] = $.extend(true, [], data);\n            redo['sheetIndex'] = Store.currentSheetIndex;\n            let pivotTable = _this.getPivotTableData();\n            redo['pivotTablecur'] = pivotTable;\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                Store.jfredo.push(redo);\n            }\n            cleargridelement();\n            Store.clearjfundo = false;\n            if (addr > 0 || addc > 0) {\n                jfrefreshgridall(data[0].length, data.length, data, null, Store.luckysheet_select_save, 'datachangeAll', undefined, undefined, isRefreshCanvas);\n            } else {\n                jfrefreshgrid(data, Store.luckysheet_select_save, {}, null, isRefreshCanvas);\n                selectHightlightShow();\n            }\n            Store.clearjfundo = true;\n        },\n        drawPivotTable: true,\n        pivotTableBoundary: [\n            12,\n            6\n        ],\n        pivotclick: function (row_index, col_index, index) {\n            if (index == null) {\n                index = Store.currentSheetIndex;\n            }\n            let file = Store.luckysheetfile[getSheetIndex(index)];\n            if (!file.isPivotTable) {\n                return;\n            }\n            let pivotDataSheetIndex = file.pivotTable.pivotDataSheetIndex;\n            let real_pivotDataSheetIndex = getSheetIndex(pivotDataSheetIndex);\n            if (real_pivotDataSheetIndex == null) {\n                return;\n            }\n            let slider = $('#luckysheet-modal-dialog-slider-pivot');\n            let isRangeClick = this.isPivotRange(row_index, col_index);\n            if (isRangeClick && slider.is(':hidden')) {\n                if (!checkProtectionAuthorityNormal(index, 'usePivotTablereports', false)) {\n                    // Store.luckysheet_select_status = false;\n                    return;\n                }\n                slider.show();\n                luckysheetsizeauto();\n                $('#luckysheet-sta-content').css('padding-right', 260);\n            } else if (!isRangeClick && slider.is(':visible')) {\n                slider.hide();\n                luckysheetsizeauto();\n                $('#luckysheet-sta-content').css('padding-right', 10);\n            }\n        },\n        isPivotRange: function (row_index, col_index) {\n            let _this = this;\n            if (!!Store.luckysheetcurrentisPivotTable) {\n                if (row_index < _this.pivotTableBoundary[0] && col_index < _this.pivotTableBoundary[1]) {\n                    return true;\n                } else {\n                    return false;\n                }\n            }\n        },\n        storePivotTableParam: function () {\n            let _this = this;\n            let columnarr = [], rowarr = [], filterarr = [], valuesarr = [];\n            $('#luckysheet-modal-dialog-config-filter .luckysheet-modal-dialog-slider-config-item').each(function () {\n                let item = {};\n                item['index'] = $(this).data('index');\n                item['name'] = $(this).data('name');\n                item['fullname'] = $(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text();\n                filterarr.push(item);\n            });\n            $('#luckysheet-modal-dialog-config-row .luckysheet-modal-dialog-slider-config-item').each(function () {\n                let item = {};\n                item['index'] = $(this).data('index');\n                item['name'] = $(this).data('name');\n                item['fullname'] = $(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text();\n                item['order'] = $(this).data('order');\n                item['orderby'] = $(this).data('orderby');\n                item['stastic'] = $(this).data('stastic');\n                rowarr.push(item);\n            });\n            $('#luckysheet-modal-dialog-config-column .luckysheet-modal-dialog-slider-config-item').each(function () {\n                let item = {};\n                item['index'] = $(this).data('index');\n                item['name'] = $(this).data('name');\n                item['fullname'] = $(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text();\n                item['order'] = $(this).data('order');\n                item['orderby'] = $(this).data('orderby');\n                item['stastic'] = $(this).data('stastic');\n                columnarr.push(item);\n            });\n            $('#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item').each(function () {\n                let item = {};\n                item['index'] = $(this).data('index');\n                item['name'] = $(this).data('name');\n                item['fullname'] = $(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text();\n                item['sumtype'] = $(this).data('sumtype');\n                item['nameindex'] = $(this).data('nameindex');\n                valuesarr.push(item);\n            });\n            _this.setDatatojsfile('column', columnarr);\n            _this.setDatatojsfile('row', rowarr);\n            _this.setDatatojsfile('filter', filterarr);\n            _this.setDatatojsfile('values', valuesarr);\n            let showtype = $('#luckysheetpivottablevaluecolrow:checked, #luckysheetpivottablevaluecolrow1:checked').val();\n            _this.setDatatojsfile('showType', showtype == '0' ? 'row' : 'column');\n            let pivotTable = _this.getPivotTableData();\n            delete pivotTable.pivotDatas;\n            server.saveParam('all', _this.pivotSheetIndex, pivotTable, { 'k': 'pivotTable' });\n        },\n        getPivotTableData: function (dataindex) {\n            if (dataindex == null) {\n                dataindex = this.pivotSheetIndex;\n            }\n            let index = getSheetIndex(dataindex);\n            let pivotTable = Store.luckysheetfile[index]['pivotTable'];\n            if (getObjType(pivotTable) == 'object') {\n                pivotTable = $.extend(true, {}, Store.luckysheetfile[index]['pivotTable']);\n            } else {\n                pivotTable = new Function('return ' + pivotTable)();\n            }\n            return pivotTable;\n        },\n        addValuesToTitle: function (titles, values) {\n            let rowLen = titles.length * values.length, colLen = titles[0].length + 1;\n            let retdata = [];\n            if (titles.length == 0 && values.length > 0) {\n                for (let v = 0; v < values.length; v++) {\n                    retdata.push(values[v].fullname);\n                }\n                return retdata;\n            }\n            if (values.length == 0 && titles.length > 0) {\n                return titles;\n            }\n            for (let r = 0; r < rowLen; r++) {\n                retdata[r] = new Array(colLen);\n                for (let c = 0; c < colLen - 1; c++) {\n                    retdata[r][c] = titles[Math.floor(r / values.length)][c];\n                }\n                retdata[r][colLen - 1] = values[r % values.length].fullname;\n            }\n            return retdata;\n        },\n        initialPivotManage: function (restore) {\n            let _this = this;\n            const _locale = locale();\n            const locale_pivotTable = _locale.pivotTable;\n            const locale_button = _locale.button;\n            const locale_filter = _locale.filter;\n            if (_this.initial) {\n                _this.initial = false;\n                $('body').append(luckysheetPivotTableHTML());\n                $('#luckysheet-modal-dialog-slider-close').click(function () {\n                    $('#luckysheet-modal-dialog-slider-pivot').hide();\n                    luckysheetsizeauto();\n                });\n                $('body').append(replaceHtml(modelHTML, {\n                    'id': 'luckysheet-data-pivotTable-selection',\n                    'addclass': 'luckysheet-data-pivotTable-selection',\n                    'title': locale_pivotTable.titleSelectionDataRange,\n                    'content': '<input id=\"luckysheet-pivotTable-range-selection-input\" class=\"luckysheet-datavisual-range-container\" style=\"font-size: 14px;padding:5px;max-width:none;\" spellcheck=\"false\" aria-label=\"' + locale_pivotTable.titleDataRange + '\" placeholder=\"' + locale_pivotTable.titleDataRange + '\">',\n                    'botton': '<button id=\"luckysheet-pivotTable-selection-confirm\" class=\"btn btn-primary\">' + locale_button.confirm + '</button><button class=\"btn btn-default luckysheet-model-close-btn\">' + locale_button.cancel + '</button>'\n                }));\n                $('body').append(replaceHtml(filtermenuHTML(), { 'menuid': 'pivotTableFilter' }));\n                $('body').append(replaceHtml(filtersubmenuHTML(), { 'menuid': 'pivotTableFilter' }));\n                $('body').append(pivottableconfigHTML());\n                $('body').append(pivottablesumHTML());\n                $('#luckysheet-pivotTableFilter-orderby-asc').remove();\n                $('#luckysheet-pivotTableFilter-orderby-desc').next().remove();\n                $('#luckysheet-pivotTableFilter-orderby-desc').remove();\n                $('#luckysheet-pivotTableFilter-orderby-color').next().remove();\n                $('#luckysheet-pivotTableFilter-orderby-color').remove();\n                $('#luckysheetpivottablevaluecolrow, #luckysheetpivottablevaluecolrow1').checkboxradio({ icon: false }).change(function () {\n                    _this.refreshPivotTable();\n                });\n                let hidefilersubmenu = null;\n                $('#luckysheet-pivotTableFilter-menu').mouseover(function () {\n                    clearTimeout(hidefilersubmenu);\n                    hidefilersubmenu = setTimeout(function () {\n                        $('#luckysheet-pivotTableFilter-submenu').hide();\n                    }, 500);\n                });    //\n                //\n                $(document).off('click.ptFilterCheckbox1').on('click.ptFilterCheckbox1', '#luckysheet-pivotTableFilter-byvalue-select .textBox', function () {\n                    if ($(this).attr('data-check') == 'true') {\n                        $(this).attr('data-check', 'false');\n                        $(this).find(\"input[type='checkbox']\").removeAttr('checked');\n                    } else {\n                        $(this).attr('data-check', 'true');\n                        $(this).find(\"input[type='checkbox']\").prop('checked', true);\n                    }\n                });\n                $(document).off('click.ptFilterCheckbox2').on('click.ptFilterCheckbox2', '#luckysheet-pivotTableFilter-byvalue-select .year', function () {\n                    if ($(this).attr('data-check') == 'true') {\n                        $(this).attr('data-check', 'false');\n                        $(this).parents('.yearBox').find('.month').attr('data-check', 'false');\n                        $(this).parents('.yearBox').find('.day').attr('data-check', 'false');\n                        $(this).parents('.yearBox').find(\"input[type='checkbox']\").removeAttr('checked');\n                    } else {\n                        $(this).attr('data-check', 'true');\n                        $(this).parents('.yearBox').find('.month').attr('data-check', 'true');\n                        $(this).parents('.yearBox').find('.day').attr('data-check', 'true');\n                        $(this).parents('.yearBox').find(\"input[type='checkbox']\").prop('checked', true);\n                    }\n                });\n                $(document).off('click.ptFilterCheckbox3').on('click.ptFilterCheckbox3', '#luckysheet-pivotTableFilter-byvalue-select .month', function () {\n                    //  \n                    if ($(this).attr('data-check') == 'true') {\n                        $(this).attr('data-check', 'false');\n                        $(this).parents('.monthBox').find('.day').attr('data-check', 'false');\n                        $(this).parents('.monthBox').find(\"input[type='checkbox']\").removeAttr('checked');\n                    } else {\n                        $(this).attr('data-check', 'true');\n                        $(this).parents('.monthBox').find('.day').attr('data-check', 'true');\n                        $(this).parents('.monthBox').find(\"input[type='checkbox']\").prop('checked', true);\n                    }    //  \n                    //  \n                    let yearDayAllCheck = true;\n                    let $yearDay = $(this).parents('.yearBox').find('.day');\n                    $yearDay.each(function (i, e) {\n                        if ($(e).attr('data-check') == 'true') {\n                        } else {\n                            yearDayAllCheck = false;\n                        }\n                    });\n                    if (yearDayAllCheck) {\n                        $(this).parents('.yearBox').find('.year').attr('data-check', 'true');\n                        $(this).parents('.yearBox').find(\".year input[type='checkbox']\").prop('checked', true);\n                    } else {\n                        $(this).parents('.yearBox').find('.year').attr('data-check', 'false');\n                        $(this).parents('.yearBox').find(\".year input[type='checkbox']\").removeAttr('checked');\n                    }\n                });\n                $(document).off('click.ptFilterCheckbox4').on('click.ptFilterCheckbox4', '#luckysheet-pivotTableFilter-byvalue-select .day', function () {\n                    if ($(this).attr('data-check') == 'true') {\n                        $(this).attr('data-check', 'false');\n                        $(this).find(\"input[type='checkbox']\").removeAttr('checked');\n                    } else {\n                        $(this).attr('data-check', 'true');\n                        $(this).find(\"input[type='checkbox']\").prop('checked', true);\n                    }    //  \n                    //  \n                    let monthDayAllCheck = true;\n                    let $monthDay = $(this).parents('.monthBox').find('.day');\n                    $monthDay.each(function (i, e) {\n                        if ($(e).attr('data-check') == 'true') {\n                        } else {\n                            monthDayAllCheck = false;\n                        }\n                    });\n                    if (monthDayAllCheck) {\n                        $(this).parents('.monthBox').find('.month').attr('data-check', 'true');\n                        $(this).parents('.monthBox').find(\".month input[type='checkbox']\").prop('checked', true);\n                    } else {\n                        $(this).parents('.monthBox').find('.month').attr('data-check', 'false');\n                        $(this).parents('.monthBox').find(\".month input[type='checkbox']\").removeAttr('checked');\n                    }    //  \n                    //  \n                    let yearDayAllCheck = true;\n                    let $yearDay = $(this).parents('.yearBox').find('.day');\n                    $yearDay.each(function (i, e) {\n                        if ($(e).attr('data-check') == 'true') {\n                        } else {\n                            yearDayAllCheck = false;\n                        }\n                    });\n                    if (yearDayAllCheck) {\n                        $(this).parents('.yearBox').find('.year').attr('data-check', 'true');\n                        $(this).parents('.yearBox').find(\".year input[type='checkbox']\").prop('checked', true);\n                    } else {\n                        $(this).parents('.yearBox').find('.year').attr('data-check', 'false');\n                        $(this).parents('.yearBox').find(\".year input[type='checkbox']\").removeAttr('checked');\n                    }\n                });    // \n                // \n                $(document).off('click.ptFilterYearDropdown').on('click.ptFilterYearDropdown', '#luckysheet-pivotTableFilter-byvalue-select .yearBox .fa-caret-right', function () {\n                    let $p = $(this).parents('.luckysheet-mousedown-cancel');\n                    if ($p.hasClass('year')) {\n                        $(this).parents('.yearBox').find('.monthList').slideToggle();\n                    }\n                    if ($p.hasClass('month')) {\n                        $(this).parents('.monthBox').find('.dayList').slideToggle();\n                    }\n                });    //\n                //\n                $('#luckysheet-pivotTableFilter-byvalue-btn-all').click(function () {\n                    $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\").prop('checked', true);\n                    $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\").parents('.luckysheet-mousedown-cancel').attr('data-check', 'true');\n                });    //\n                //\n                $('#luckysheet-pivotTableFilter-byvalue-btn-contra').click(function () {\n                    let $input = $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\");\n                    $input.each(function (i, e) {\n                        if ($(e).is(':checked')) {\n                            $(e).removeAttr('checked');\n                            $(e).parents('.luckysheet-mousedown-cancel').attr('data-check', 'false');\n                        } else {\n                            $(e).prop('checked', true);\n                            $(e).parents('.luckysheet-mousedown-cancel').attr('data-check', 'true');\n                        }\n                    });    //  \n                    //  \n                    let $month = $('#luckysheet-pivotTableFilter-byvalue-select .ListBox .monthBox');\n                    $month.each(function (index, event) {\n                        let monthDayAllCheck = true;\n                        let $monthDay = $(event).find(\".day input[type='checkbox']\");\n                        $monthDay.each(function (i, e) {\n                            if ($(e).is(':checked')) {\n                            } else {\n                                monthDayAllCheck = false;\n                            }\n                        });\n                        if (monthDayAllCheck) {\n                            $(event).find(\".month input[type='checkbox']\").prop('checked', true);\n                            $(event).attr('data-check', 'true');\n                        } else {\n                            $(event).find(\".month input[type='checkbox']\").removeAttr('checked');\n                            $(event).attr('data-check', 'false');\n                        }\n                    });    //  \n                    //  \n                    let $year = $('#luckysheet-pivotTableFilter-byvalue-select .ListBox .yearBox');\n                    $year.each(function (index, event) {\n                        let yearDayAllCheck = true;\n                        let $yearDay = $(event).find(\".day input[type='checkbox']\");\n                        $yearDay.each(function (i, e) {\n                            if ($(e).is(':checked')) {\n                            } else {\n                                yearDayAllCheck = false;\n                            }\n                        });\n                        if (yearDayAllCheck) {\n                            $(event).find(\".year input[type='checkbox']\").prop('checked', true);\n                            $(event).attr('data-check', 'true');\n                        } else {\n                            $(event).find(\".year input[type='checkbox']\").removeAttr('checked');\n                            $(event).attr('data-check', 'false');\n                        }\n                    });\n                });    //\n                //\n                $('#luckysheet-pivotTableFilter-byvalue-btn-clear').click(function () {\n                    $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\").removeAttr('checked');\n                    $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\").parents('.luckysheet-mousedown-cancel').attr('data-check', 'false');\n                });    //\n                //\n                $('#luckysheet-pivotTableFilter-byvalue-input').on('input propertychange', function () {\n                    let v = $(this).val().toString();\n                    $('#luckysheet-pivotTableFilter-byvalue-select .ListBox .luckysheet-mousedown-cancel').show();\n                    if (v != '') {\n                        let $check = $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\");\n                        $check.each(function (i, e) {\n                            let $p = $(e).parents('.luckysheet-mousedown-cancel');\n                            if ($p.hasClass('day')) {\n                                //\n                                let day = $(e).siblings('label').text().toString();\n                                let month = $(e).parents('.monthBox').find('.month label').text().toString();\n                                let year = $(e).parents('.yearBox').find('.year label').text().toString();\n                                let itemV = year + '-' + month + '-' + day;\n                                if (itemV.indexOf(v) == -1) {\n                                    $(e).parents('.day').hide();    //  \n                                    //  \n                                    let $monthDay = $(e).parents('.dayList').find('.day:visible');\n                                    if ($monthDay.length == 0) {\n                                        $(e).parents('.monthBox').find('.month').hide();\n                                    }    //  \n                                    //  \n                                    let $yearDay = $(e).parents('.monthList').find('.day:visible');\n                                    if ($yearDay.length == 0) {\n                                        $(e).parents('.yearBox').find('.year').hide();\n                                    }\n                                }\n                            }\n                            if ($p.hasClass('textBox')) {\n                                //\n                                let itemV = $(e).siblings('label').text().toString();\n                                if (itemV.indexOf(v) == -1) {\n                                    $(e).parents('.textBox').hide();\n                                }\n                            }\n                        });\n                    }\n                });\n                $('#luckysheet-pivotTableFilter-bycondition, #luckysheet-pivotTableFilter-byvalue').click(function () {\n                    let $t = $(this);\n                    $t.next().slideToggle(200);\n                    setTimeout(function () {\n                        if ($t.attr('id') == 'luckysheet-pivotTableFilter-bycondition' && $('#luckysheet-pivotTableFilter-bycondition').next().is(':visible')) {\n                            if ($('#luckysheet-pivotTableFilter-selected span').text() != locale_filter.filiterInputNone) {\n                                $('#luckysheet-pivotTableFilter-byvalue').next().slideUp(200);\n                            }\n                        }\n                        if ($t.is($('#luckysheet-pivotTableFilter-bycondition'))) {\n                            if ($('#luckysheet-pivotTableFilter-bycondition').next().is(':hidden') && $('#luckysheet-pivotTableFilter-byvalue').next().is(':hidden')) {\n                                $('#luckysheet-pivotTableFilter-byvalue').next().slideDown(200);\n                            }\n                        }\n                    }, 300);\n                });    //\n                //\n                $('#luckysheet-pivotTableFilter-cancel').click(function () {\n                    $('#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu').hide();\n                });\n                $('#luckysheet-pivotTableFilter-selected').click(function () {\n                    let $t = $(this), toffset = $t.offset(), $menu = $('#luckysheet-pivotTableFilter-submenu');\n                    $menu.hide();\n                    let winH = $(window).height(), winW = $(window).width();\n                    let menuW = $menu.width(), menuH = $menu.height();\n                    let top = toffset.top, left = toffset.left, mheight = winH - toffset.top - 20;\n                    if (toffset.left + menuW > winW) {\n                        left = toffset.left - menuW;\n                    }\n                    if (toffset.top > winH / 2) {\n                        top = winH - toffset.top;\n                        if (top < 0) {\n                            top = 0;\n                        }\n                        mheight = toffset.top - 20;\n                    }\n                    $menu.css({\n                        'top': top,\n                        'left': left,\n                        'height': mheight\n                    }).show();\n                    clearTimeout(hidefilersubmenu);\n                });    //\n                //\n                $('#luckysheet-pivotTableFilter-submenu').mouseover(function () {\n                    clearTimeout(hidefilersubmenu);\n                }).find('.luckysheet-cols-menuitem').click(function (e) {\n                    $('#luckysheet-pivotTableFilter-selected span').html($(this).find('.luckysheet-cols-menuitem-content').text()).data('value', $(this).data('value'));\n                    $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').hide();\n                    if ($(this).data('type') == '2') {\n                        $('#luckysheet-pivotTableFilter-selected span').data('type', '2');\n                        $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2').show();\n                    } else if ($(this).data('type') == '0') {\n                        $('#luckysheet-pivotTableFilter-selected span').data('type', '0');\n                    } else {\n                        $('#luckysheet-pivotTableFilter-selected span').data('type', '1');\n                        $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').eq(0).show();    // input typedate\n                        // input typedate\n                        if ($(this).attr('data-value') == 'dateequal' || $(this).attr('data-value') == 'datelessthan' || $(this).attr('data-value') == 'datemorethan') {\n                            $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input').prop('type', 'date');\n                        } else {\n                            $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input').prop('type', 'text');\n                        }\n                    }\n                    $('#luckysheet-pivotTableFilter-byvalue').next().slideUp();\n                    $('#luckysheet-pivotTableFilter-submenu').hide();\n                });\n                $('#luckysheet-modal-dialog-pivotTable-list').on('click', ' .luckysheet-slider-list-item-filter', function (e) {\n                    _this.luckysheetsliderlistitemfilter($(this));\n                    e.stopPropagation();\n                    return false;\n                });\n                $('#luckysheet-modal-dialog-pivotTable-list').on('click', ' .luckysheet-slider-list-item-filtered', function (e) {\n                    _this.luckysheetsliderlistclearfilter($(this).next());\n                    e.stopPropagation();\n                    return false;\n                });\n                $('#luckysheet-dialog-pivotTable-range-seleted').click(function () {\n                    $('#luckysheet-modal-dialog-slider-pivot').hide();\n                    luckysheetsizeauto();\n                    let $t = $('#luckysheet-data-pivotTable-selection'), myh = $t.outerHeight(), myw = $t.outerWidth();\n                    let winw = $(window).width(), winh = $(window).height();\n                    let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n                    $('#luckysheet-data-pivotTable-selection').css({\n                        'left': (winw + scrollLeft - myw) / 2,\n                        'top': (winh + scrollTop - myh) / 4\n                    }).show();\n                    _this.jgridCurrentPivotInput = $('#luckysheet-dialog-pivotTable-range').html();\n                    $('#luckysheet-pivotTable-range-selection-input').val(_this.jgridCurrentPivotInput);\n                    _this.luckysheet_pivotTable_select_state = true;\n                });    //\n                //\n                $('#luckysheet-pivotTableFilter-initial').click(function () {\n                    $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-slider-list-item-filtered').hide();\n                    $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').data('rowhidden', '');\n                    $('#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu').hide();\n                    $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').hide().find('input').val();\n                    $('#luckysheet-pivotTableFilter-selected span').data('type', '0').data('type', null).text(locale_filter.filiterInputNone);\n                    _this.setDatatojsfile('filterparm', null);\n                    _this.celldata = _this.origindata;\n                    _this.refreshPivotTable();\n                });\n                $('#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column').on('click', '.luckysheet-modal-dialog-slider-config-item-icon', function (e) {\n                    let $t = $(e.target), $item = $t.closest('.luckysheet-modal-dialog-slider-config-item'), cindex = $item.data('index'), toffset = $item.offset();\n                    let order = $item.data('order'), orderby = $item.data('orderby'), stastic = $item.data('stastic');\n                    if (order == null) {\n                        order = 'default';\n                    }\n                    let option = '<option value=\"self\">' + $item.find('.luckysheet-modal-dialog-slider-config-item-txt').data('name') + '</option>';\n                    $('#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item').each(function (i) {\n                        option += '<option value=\"' + i + '\">' + $(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text() + '</option>';\n                    });\n                    $('#luckysheet-pivotTable-config-option-orderby').empty().html(option);\n                    if (orderby == null) {\n                        orderby = 'self';\n                    }\n                    if (stastic == null) {\n                        stastic = '1';\n                    }\n                    $('#luckysheet-pivotTable-config-option-order').val(order).data('index', cindex);\n                    $('#luckysheet-pivotTable-config-option-orderby').val(orderby).data('index', cindex);\n                    $('#luckysheet-pivotTable-config-option-stastic').val(stastic).data('index', cindex);\n                    mouseclickposition($('#luckysheet-pivotTable-config-option'), toffset.left + $item.outerWidth(), toffset.top - 13, 'rightbottom');\n                    e.stopPropagation();\n                    return false;\n                });\n                $('#luckysheet-pivotTable-config-option-order,#luckysheet-pivotTable-config-option-orderby,#luckysheet-pivotTable-config-option-stastic').change(function () {\n                    let $t = $(this), cindex = $t.data('index');\n                    $('#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                        if ($(this).data('index') == cindex) {\n                            $(this).data($t.attr('id').replace('luckysheet-pivotTable-config-option-', ''), $t.val());\n                        }\n                    });\n                    _this.refreshPivotTable();\n                });\n                $('#luckysheet-modal-dialog-config-value').on('click', '.luckysheet-modal-dialog-slider-config-item-icon', function (e) {\n                    let $t = $(e.target), $item = $t.closest('.luckysheet-modal-dialog-slider-config-item'), cindex = $item.data('index'), toffset = $item.offset(), sumtype = $item.data('sumtype');\n                    let type = _this.pivot_data_type[cindex.toString()];\n                    if (sumtype == null) {\n                        if (type == 'num') {\n                            sumtype = 'SUM';\n                        } else {\n                            sumtype = 'COUNTA';\n                        }\n                    }\n                    let $menu = $('#luckysheet-pivotTable-config-option-sumtype');\n                    $menu.find('.luckysheet-submenu-arrow').hide();\n                    $menu.find(\".luckysheet-cols-menuitem[sumtype='\" + sumtype + \"'] .luckysheet-submenu-arrow\").css('display', 'inline');\n                    $menu.data('item', $item);\n                    mouseclickposition($menu, toffset.left + $item.outerWidth(), toffset.top - 13, 'rightbottom');\n                    e.stopPropagation();\n                    return false;\n                });\n                $('#luckysheet-pivotTable-config-option-sumtype .luckysheet-cols-menuitem').click(function () {\n                    let $item = $('#luckysheet-pivotTable-config-option-sumtype').data('item');\n                    let sumtype = $(this).attr('sumtype');\n                    $item.data('sumtype', $(this).attr('sumtype'));\n                    let name = _this.getSumTypeName(sumtype) + ':' + $item.data('name');\n                    $item.attr('title', name).find('.luckysheet-modal-dialog-slider-config-item-txt').html(name);\n                    $('#luckysheet-pivotTable-config-option-sumtype').hide();\n                    _this.refreshPivotTable();\n                });\n                $('#luckysheet-modal-dialog-config-filter').on('click', '.luckysheet-modal-dialog-slider-config-item-icon', function (e) {\n                    let $t = $(e.target), cindex = $t.closest('.luckysheet-modal-dialog-slider-config-item').data('index');\n                    _this.luckysheetsliderlistitemfilter($('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(cindex).find('.luckysheet-slider-list-item-filter'));\n                    e.stopPropagation();\n                    return false;\n                });    //\n                //\n                $('#luckysheet-pivotTableFilter-confirm').click(function () {\n                    let $menu = $('#luckysheet-pivotTableFilter-menu');\n                    let cindex = $menu.data('index');\n                    let rowhiddenother = {};    //\n                    //\n                    $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').each(function () {\n                        let $t = $(this), rh = $t.data('rowhidden');\n                        if ($t.data('index') != cindex) {\n                            if (rh == null || rh == '') {\n                                return true;\n                            }\n                            if (getObjType(rh) == 'string') {\n                                rh = JSON.parse(rh);\n                            }\n                            for (let r in rh) {\n                                rowhiddenother[r] = 0;\n                            }\n                        }\n                    });\n                    let d = _this.origindata;\n                    let filterdata = {};\n                    let rowhidden = {};\n                    let caljs = {};\n                    if ($('#luckysheet-pivotTableFilter-bycondition').next().is(':visible') && $('#luckysheet-pivotTableFilter-byvalue').next().is(':hidden') && $('#luckysheet-pivotTableFilter-selected span').data('value') != 'null') {\n                        let $t = $('#luckysheet-pivotTableFilter-selected span');\n                        let type = $t.data('type'), value = $t.data('value');\n                        caljs['value'] = value;\n                        caljs['text'] = $t.text();\n                        if (type == '0') {\n                            caljs['type'] = '0';\n                        } else if (type == '2') {\n                            let $input = $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2 input');\n                            caljs['type'] = '2';\n                            caljs['value1'] = $input.eq(0).val();\n                            caljs['value2'] = $input.eq(1).val();\n                        } else {\n                            caljs['type'] = '1';\n                            caljs['value1'] = $('#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input').eq(0).find('input').val();\n                        }\n                        for (let r = 1; r < d.length; r++) {\n                            if (r in rowhiddenother) {\n                                continue;\n                            }\n                            if (d[r] == null) {\n                                continue;\n                            }\n                            let cell = d[r][cindex];\n                            if (value == 'cellnull') {\n                                //\n                                if (cell != null && !isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'cellnonull') {\n                                //\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'textinclude') {\n                                // \n                                let value1 = caljs['value1'];\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else {\n                                    if (cell.m.indexOf(value1) == -1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                }\n                            } else if (value == 'textnotinclude') {\n                                //\n                                let value1 = caljs['value1'];\n                                if (cell == null || isRealNull(cell.v)) {\n                                } else {\n                                    if (cell.m.indexOf(value1) > -1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                }\n                            } else if (value == 'textstart') {\n                                //\n                                let value1 = caljs['value1'], valuelen = value1.length;\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else {\n                                    if (cell.m.substr(0, valuelen) != value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                }\n                            } else if (value == 'textend') {\n                                //\n                                let value1 = caljs['value1'], valuelen = value1.length;\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else {\n                                    if (valuelen > cell.m.length || cell.m.substr(cell.m.length - valuelen, valuelen) != value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                }\n                            } else if (value == 'textequal') {\n                                //\n                                let value1 = caljs['value1'];\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else {\n                                    if (cell.m != value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                }\n                            } else if (value == 'dateequal') {\n                                //\n                                let value1 = genarate(caljs['value1'])[2];\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'd') {\n                                    if (parseInt(cell.v) != value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'datelessthan') {\n                                //\n                                let value1 = genarate(caljs['value1'])[2];\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'd') {\n                                    if (parseInt(cell.v) >= value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'datemorethan') {\n                                //\n                                let value1 = genarate(caljs['value1'])[2];\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'd') {\n                                    if (parseInt(cell.v) <= value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'morethan') {\n                                //\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v <= value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'moreequalthan') {\n                                //\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v < value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'lessthan') {\n                                //\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v >= value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'lessequalthan') {\n                                //\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v > value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'equal') {\n                                //\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v != value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'noequal') {\n                                //\n                                let value1 = parseFloat(caljs['value1']);\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v == value1) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'include') {\n                                //\n                                let value1 = parseFloat(caljs['value1']), value2 = parseFloat(caljs['value2']);\n                                let min, max;\n                                if (value1 < value2) {\n                                    min = value1;\n                                    max = value2;\n                                } else {\n                                    max = value1;\n                                    min = value2;\n                                }\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v < min || cell.v > max) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            } else if (value == 'noinclude') {\n                                //\n                                let value1 = parseFloat(caljs['value1']), value2 = parseFloat(caljs['value2']);\n                                let min, max;\n                                if (value1 < value2) {\n                                    min = value1;\n                                    max = value2;\n                                } else {\n                                    max = value1;\n                                    min = value2;\n                                }\n                                if (cell == null || isRealNull(cell.v)) {\n                                    rowhidden[r] = 0;\n                                } else if (cell.ct != null && cell.ct.t == 'n') {\n                                    if (cell.v >= min && cell.v <= max) {\n                                        rowhidden[r] = 0;\n                                    }\n                                } else {\n                                    rowhidden[r] = 0;\n                                }\n                            }\n                        }\n                    } else {\n                        $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']\").each(function (i, e) {\n                            if ($(e).is(':visible') && $(e).is(':checked')) {\n                                return true;\n                            }\n                            if ($(e).closest('.day').length > 0) {\n                                let day = $(e).siblings('label').text();\n                                if (Number(day) < 10) {\n                                    day = '0' + day;\n                                }\n                                let month = $(e).closest('.monthBox').find('.month label').text().replace(locale_filter.filiterMonthText, '');\n                                if (Number(month) < 10) {\n                                    month = '0' + month;\n                                }\n                                let year = $(e).closest('.yearBox').find('.year label').text().replace(locale_filter.filiterYearText, '');\n                                let itemV = locale_filter.filterDateFormatTip + '#$$$#' + year + '-' + month + '-' + day;\n                                filterdata[itemV] = '1';\n                            }\n                            if ($(e).closest('.textBox').length > 0) {\n                                let itemV = $(e).closest('.textBox').data('filter');\n                                filterdata[itemV] = '1';\n                            }\n                        });\n                        for (let r = 1; r < d.length; r++) {\n                            if (r in rowhiddenother) {\n                                continue;\n                            }\n                            if (d[r] == null) {\n                                continue;\n                            }\n                            let cell = d[r][cindex];\n                            let value;\n                            if (cell == null || isRealNull(cell.v)) {\n                                value = 'null#$$$#null';\n                            } else if (cell.ct != null && cell.ct.t == 'd') {\n                                let fmt = update('YYYY-MM-DD', cell.v);\n                                value = locale_filter.filterDateFormatTip + '#$$$#' + fmt;\n                            } else {\n                                value = cell.v + '#$$$#' + cell.m;\n                            }\n                            if (value in filterdata) {\n                                rowhidden[r] = 0;\n                            }\n                        }\n                    }\n                    let $top = $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(cindex);\n                    if ($(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible:checked\").length < $(\"#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible\").length || $('#luckysheet-pivotTableFilter-byvalue-input').val().length > 0 || $('#luckysheet-pivotTableFilter-bycondition').next().is(':visible') && $('#luckysheet-pivotTableFilter-byvalue').next().is(':hidden') && $('#luckysheet-pivotTableFilter-selected span').data('value') != 'null') {\n                        $top.data('rowhidden', JSON.stringify(rowhidden)).find('.luckysheet-slider-list-item-filtered').show();\n                        _this.setDatatojsfile('rowhidden', rowhidden, cindex);\n                        if (caljs != null) {\n                            $top.data('byconditionvalue', caljs['value']).data('byconditiontype', caljs['type']).data('byconditiontext', caljs['text']);\n                            if (caljs['value1'] != null) {\n                                $top.data('byconditionvalue1', caljs['value1']);\n                            }\n                            if (caljs['value2'] != null) {\n                                $top.data('byconditionvalue2', caljs['value2']);\n                            }\n                            _this.setDatatojsfile('caljs', caljs, cindex);\n                        }\n                    } else {\n                        $top.data('rowhidden', '').find('.luckysheet-slider-list-item-filtered').hide();\n                        _this.setDatatojsfile('rowhidden', null, cindex);\n                    }\n                    let newdata = [];\n                    for (let i = 0; i < d.length; i++) {\n                        if (i in rowhidden || i in rowhiddenother) {\n                            continue;\n                        }\n                        newdata.push([].concat(d[i]));\n                    }\n                    _this.celldata = newdata;\n                    _this.refreshPivotTable();\n                    $('#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu').hide();\n                    cleargridelement();\n                });\n                $('#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn, #luckysheet-data-pivotTable-selection .luckysheet-modal-dialog-title-close').click(function () {\n                    $('#luckysheet-modal-dialog-slider-pivot').show();\n                    luckysheetsizeauto();\n                    $('#luckysheet-cell-main .luckysheet-pivotTable-selection-set div').show();\n                    $('#luckysheet-data-pivotTable-selection').hide();\n                    sheetmanage.changeSheetExec(_this.pivotSheetIndex);\n                    _this.luckysheet_pivotTable_select_state = false;\n                    cleargridelement();\n                });\n                $('#luckysheet-pivotTable-selection-confirm').click(function () {\n                    let $input = $('#luckysheet-pivotTable-range-selection-input'), val = $input.val();\n                    if ($.trim(val).length == 0 || $.trim(val).toUpperCase() == _this.jgridCurrentPivotInput.toUpperCase()) {\n                        $input.val(_this.jgridCurrentPivotInput);\n                        $('#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn').click();\n                        return;\n                    } else {\n                        let val1 = val.split('!');\n                        let sheettxt = '', rangetxt = '', sheetIndex = -1;\n                        if (val1.length > 1) {\n                            sheettxt = val1[0];\n                            rangetxt = val1[1];\n                            for (let i in Store.luckysheetfile) {\n                                if (sheettxt == Store.luckysheetfile[i].name) {\n                                    sheetIndex = Store.luckysheetfile[i].index;\n                                    break;\n                                }\n                            }\n                            if (sheetIndex == -1) {\n                                sheetIndex = 0;\n                            }\n                        } else {\n                            let index = getSheetIndex(Store.currentSheetIndex);\n                            sheettxt = Store.luckysheetfile[index].name;\n                            sheetIndex = Store.luckysheetfile[index].index;\n                            rangetxt = val1[0];\n                        }\n                        if (Store.luckysheetfile[getSheetIndex(sheetIndex)].isPivotTable) {\n                            if (isEditMode()) {\n                                alert(locale_pivotTable.errorNotAllowPivotData);\n                            } else {\n                                tooltip.info('', locale_pivotTable.errorNotAllowPivotData);\n                            }\n                            $input.val(_this.jgridCurrentPivotInput);\n                            return;\n                        }\n                        if (rangetxt.indexOf(':') == -1) {\n                            if (isEditMode()) {\n                                alert(locale_pivotTable.errorSelectionRange);\n                            } else {\n                                tooltip.info('', locale_pivotTable.errorSelectionRange);\n                            }\n                            $input.val(_this.jgridCurrentPivotInput);\n                            return;\n                        }\n                        rangetxt = rangetxt.split(':');\n                        let row = [], col = [];\n                        row[0] = parseInt(rangetxt[0].replace(/[^0-9]/g, '')) - 1;\n                        row[1] = parseInt(rangetxt[1].replace(/[^0-9]/g, '')) - 1;\n                        if (row[0] > row[1]) {\n                            if (isEditMode()) {\n                                alert(locale_pivotTable.errorSelectionRange);\n                            } else {\n                                tooltip.info('', locale_pivotTable.errorSelectionRange);\n                            }\n                            $input.val(_this.jgridCurrentPivotInput);\n                            return;\n                        }\n                        col[0] = ABCatNum(rangetxt[0].replace(/[^A-Za-z]/g, ''));\n                        col[1] = ABCatNum(rangetxt[1].replace(/[^A-Za-z]/g, ''));\n                        if (col[0] > col[1]) {\n                            if (isEditMode()) {\n                                alert(locale_pivotTable.errorSelectionRange);\n                            } else {\n                                tooltip.info(locale_pivotTable.errorSelectionRange);\n                            }\n                            $input.val(_this.jgridCurrentPivotInput);\n                            return;\n                        }\n                        sheetmanage.changeSheetExec(_this.pivotSheetIndex);\n                        _this.setDatatojsfile('pivot_select_save', {\n                            'row': row,\n                            'column': col\n                        });\n                        _this.setDatatojsfile('pivotDataSheetIndex', sheetIndex);\n                        _this.getCellData(_this.pivotSheetIndex, sheetIndex, {\n                            'row': row,\n                            'column': col\n                        });\n                        _this.initialPivotManage();\n                        $('#luckysheet-dialog-pivotTable-range').html(val);\n                        $('#luckysheet-modal-dialog-slider-pivot').show();\n                        $('#luckysheet-data-pivotTable-selection').hide();\n                        _this.luckysheet_pivotTable_select_state = false;\n                        _this.refreshPivotTable();\n                        luckysheetsizeauto();\n                        cleargridelement();\n                    }\n                });\n                $('#luckysheet-modal-dialog-slider-pivot').on('mousedown', '.luckysheet-slider-list-item-name, .luckysheet-modal-dialog-slider-config-item-txt', function (e) {\n                    let $cur = $(e.target);\n                    _this.movestate = true;\n                    _this.movesave.obj = $cur.parent();\n                    _this.movesave.name = $cur.data('name');\n                    _this.movesave.containerid = $cur.parent().parent().attr('id');\n                    _this.movesave.index = $cur.data('index');\n                    if ($('#luckysheet-modal-dialog-slider-pivot-move').length == 0) {\n                        $('body').append('<div id=\"luckysheet-modal-dialog-slider-pivot-move\">' + _this.movesave.name + '</div>');\n                    }\n                    _this.movesave.width = $('#luckysheet-modal-dialog-slider-pivot-move').outerWidth();\n                    _this.movesave.height = $('#luckysheet-modal-dialog-slider-pivot-move').outerHeight();\n                    $('#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').css('cursor', 'default');\n                });\n                $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').mousemove(function (e) {\n                    if (_this.movestate) {\n                        if (_this.moveitemposition.length == 0) {\n                            _this.moveitemposition = [0];\n                            $(this).find('.luckysheet-modal-dialog-slider-config-item').each(function (i) {\n                                let $t = $(this), h = $t.outerHeight();\n                                _this.moveitemposition.push(_this.moveitemposition[i] + h + 2);\n                            });\n                            $(this).append('<div id=\"luckysheet-modal-dialog-config-order-help\" style=\"position:absolute;height:3px;width:100%;background:#007ACC;z-index:1;pointer-events: none;user-select:none;\"></div>');\n                        }\n                        $('#luckysheet-modal-dialog-slider-pivot-move').css({\n                            'background': '#FD8585',\n                            'color': '#fff',\n                            'border': '1px solid #FD7070'\n                        });\n                        let x = event.pageX, y = event.pageY, $container = $(this);\n                        let curtop = y - $container.offset().top + $container.scrollTop();\n                        let position = _this.moveitemposition;\n                        let row_index = luckysheet_searcharray(position, curtop);\n                        if (row_index == -1) {\n                            $('#luckysheet-modal-dialog-config-order-help').css({ 'top': position[position.length - 1] });\n                        } else if (curtop - position[row_index - 1] > (position[row_index] - position[row_index - 1]) / 2) {\n                            $('#luckysheet-modal-dialog-config-order-help').css({ 'top': position[row_index] });\n                        } else {\n                            $('#luckysheet-modal-dialog-config-order-help').css({ 'top': position[row_index - 1] });\n                        }\n                    }\n                }).mouseleave(function () {\n                    if (_this.movestate) {\n                        $('#luckysheet-modal-dialog-slider-pivot-move').css({\n                            'background': '#fff',\n                            'color': '#000',\n                            'border': '1px dotted #000'\n                        });\n                        _this.moveitemposition = [];\n                        $('#luckysheet-modal-dialog-config-order-help').remove();\n                    }\n                }).mouseup(function (e) {\n                    if (_this.movestate) {\n                        let $t = $(this);\n                        let itemHTML;\n                        if (_this.movesave.containerid == $t.attr('id')) {\n                            itemHTML = _this.movesave.obj.clone();\n                        } else {\n                            let name = _this.movesave.name, sumtype = '', nameindex = '';\n                            if ($t.attr('id') == 'luckysheet-modal-dialog-config-value') {\n                                let type = _this.pivot_data_type[_this.movesave.index.toString()];\n                                if (type == 'num') {\n                                    name = locale_pivotTable.valueStatisticsSUM + ':' + name;\n                                    sumtype = \"data-sumtype='SUM'\";\n                                    nameindex = \"data-nameindex='0'\";\n                                } else {\n                                    name = locale_pivotTable.valueStatisticsCOUNTA + ':' + name;\n                                    sumtype = \"data-sumtype='COUNTA'\";\n                                    nameindex = \"data-nameindex='0'\";\n                                }\n                                $('#luckysheet-modal-dialog-config-value').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                                    if ($(this).find('.luckysheet-modal-dialog-slider-config-item-txt').text() == name) {\n                                        let ni = parseFloat($(this).data('nameindex')) + 1;\n                                        name = name + ni.toString();\n                                        $(this).data('nameindex', ni);\n                                        return false;\n                                    }\n                                });\n                            }\n                            itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" ' + nameindex + ' ' + sumtype + ' data-index=\"' + _this.movesave.index + '\" data-name=\"' + _this.movesave.name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" ' + nameindex + ' ' + sumtype + ' data-index=\"' + _this.movesave.index + '\" data-name=\"' + _this.movesave.name + '\">' + name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                        }\n                        let x = event.pageX, y = event.pageY, $container = $(this);\n                        let curtop = y - $container.offset().top + $container.scrollTop();\n                        let position = _this.moveitemposition;\n                        let row_index = luckysheet_searcharray(position, curtop);\n                        if (_this.movesave.containerid == 'luckysheet-modal-dialog-pivotTable-list' || _this.movesave.containerid == 'luckysheet-modal-dialog-config-value' && _this.movesave.containerid != $t.attr('id')) {\n                            $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                                if ($(this).data('index') == _this.movesave.index) {\n                                    $(this).remove();\n                                }\n                            });\n                        }\n                        if (row_index == -1) {\n                            if ($t.find('.luckysheet-modal-dialog-slider-config-item').length == 0) {\n                                $t.append(itemHTML);\n                            } else {\n                                $t.find('.luckysheet-modal-dialog-slider-config-item').last().after(itemHTML);\n                            }\n                        } else if (curtop - position[row_index - 1] > (position[row_index] - position[row_index - 1]) / 2) {\n                            $t.find('.luckysheet-modal-dialog-slider-config-item').eq(row_index - 1).after(itemHTML);\n                        } else {\n                            $t.find('.luckysheet-modal-dialog-slider-config-item').eq(row_index - 1).before(itemHTML);\n                        }\n                        if (_this.movesave.containerid == 'luckysheet-modal-dialog-pivotTable-list') {\n                        } else if (_this.movesave.containerid == 'luckysheet-modal-dialog-config-value' && _this.movesave.containerid != $t.attr('id')) {\n                        } else {\n                            _this.movesave.obj.remove();\n                        }\n                        $('#luckysheet-modal-dialog-pivotTable-list').find('.luckysheet-modal-dialog-slider-list-item').each(function () {\n                            let $seleted = $(this).find('.luckysheet-slider-list-item-selected');\n                            if ($(this).data('index') == _this.movesave.index && $seleted.find('i').length == 0) {\n                                $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                            }\n                        });\n                        _this.refreshPivotTable();\n                        $('#luckysheet-modal-dialog-slider-pivot-move').remove();\n                        _this.movestate = false;\n                        $('#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').css('cursor', 'default');\n                        _this.moveitemposition = [];\n                        $('#luckysheet-modal-dialog-config-order-help').remove();\n                        _this.showvaluecolrow();\n                        e.stopPropagation();\n                    }\n                });\n                $('#luckysheet-modal-dialog-pivotTable-list').on('click', '.luckysheet-slider-list-item-selected', function () {\n                    let $t = $(this), $item = $t.parent(), index = $item.data('index'), name = $item.data('name');\n                    if ($t.find('i').length == 0) {\n                        $t.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                        let type = _this.pivot_data_type[index.toString()], itemHTML;\n                        if (type == 'num') {\n                            itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" data-nameindex=\"0\" data-sumtype=\"SUM\" data-index=\"' + index + '\" data-name=\"' + name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" data-nameindex=\"0\" data-sumtype=\"SUM\" data-index=\"' + index + '\" data-name=\"' + name + '\">:' + name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                            $('#luckysheet-modal-dialog-config-value').append(itemHTML);\n                        } else {\n                            itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" data-index=\"' + index + '\" data-name=\"' + name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" data-index=\"' + index + '\" data-name=\"' + name + '\">' + name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                            let $column = $('#luckysheet-modal-dialog-config-column'), $row = $('#luckysheet-modal-dialog-config-row');\n                            let columnitem = $column.find('.luckysheet-modal-dialog-slider-config-item'), rowitem = $row.find('.luckysheet-modal-dialog-slider-config-item');\n                            if (columnitem.length < 2) {\n                                $column.append(itemHTML);\n                            } else if (rowitem.length < 2) {\n                                $row.append(itemHTML);\n                            } else {\n                                $column.append(itemHTML);\n                            }\n                        }\n                    } else {\n                        $t.find('i').remove();\n                        $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                            if ($(this).data('index') == index) {\n                                if ($(this).parent().attr('id') == 'luckysheet-modal-dialog-config-value') {\n                                    _this.resetOrderby($(this));\n                                }\n                                $(this).remove();\n                            }\n                        });\n                    }\n                    _this.refreshPivotTable();\n                    _this.showvaluecolrow();\n                });\n                $('#luckysheet-dialog-pivotTable-clearitem').click(function () {\n                    $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                        $(this).remove();\n                    });\n                    $('#luckysheet-modal-dialog-pivotTable-list').find('.luckysheet-modal-dialog-slider-list-item').each(function () {\n                        $(this).find('.luckysheet-slider-list-item-selected').find('i').remove();\n                    });\n                    _this.refreshPivotTable();\n                    _this.showvaluecolrow();\n                });\n            }\n            if (restore == null) {\n                restore = false;\n            }\n            if (_this.celldata.length <= 1 && _this.celldata[0].length <= 1) {\n                if (isEditMode()) {\n                    alert(locale_pivotTable.errorIncreaseRange);\n                } else {\n                    tooltip.info('', locale_pivotTable.errorIncreaseRange);\n                }\n            }\n            let selecteditem = '', selecteditemIndex = 1, selecteditemtest = {}, selecteditemNullIndex = 1;\n            for (let i = 0; i < _this.celldata[0].length; i++) {\n                let name;\n                if (!!_this.celldata[0][i] && !!_this.celldata[0][i]['m']) {\n                    name = _this.celldata[0][i]['m'];\n                } else {\n                    name = getcellvalue(0, i, _this.celldata);\n                }\n                if (name != null) {\n                    name = name.toString();\n                }\n                if (name == null || $.trim(name.toString()).length == 0) {\n                    name = locale_pivotTable.titleColumn + ' ' + selecteditemNullIndex;\n                }\n                selecteditemNullIndex++;\n                if (name in selecteditemtest) {\n                    name = name + selecteditemIndex++;\n                    if (name in selecteditemtest) {\n                        name = name + selecteditemIndex++;\n                        if (name in selecteditemtest) {\n                            name = name + selecteditemIndex++;\n                        }\n                    }\n                }\n                selecteditemtest[name] = 1;\n                let dataother = '', style = '';\n                if (restore && _this.filterparm != null) {\n                    if (_this.filterparm[i.toString()] != null) {\n                        let itemset = _this.filterparm[i.toString()];\n                        if (itemset.rowhidden != null) {\n                            dataother += \"data-rowhidden='\" + JSON.stringify(itemset.rowhidden) + \"'\";\n                        }\n                        if (itemset.selected != null) {\n                            dataother += \"data-selected='\" + JSON.stringify(itemset.selected) + \"'\";\n                        }\n                        if (itemset.caljs != null) {\n                            let caljsset = itemset.caljs;\n                            if (caljsset.value != null) {\n                                dataother += \"data-byconditionvalue='\" + caljsset.value + \"'\";\n                            }\n                            if (caljsset.type != null) {\n                                dataother += \"data-byconditiontype='\" + caljsset.type + \"'\";\n                            }\n                            if (caljsset.text != null) {\n                                dataother += \"data-byconditiontext='\" + caljsset.text + \"'\";\n                            }\n                            if (caljsset.value1 != null) {\n                                dataother += \"data-byconditionvalue1='\" + caljsset.value1 + \"'\";\n                            }\n                            if (caljsset.value2 != null) {\n                                dataother += \"data-byconditionvalue2='\" + caljsset.value2 + \"'\";\n                            }\n                        }\n                    }\n                }\n                if (dataother.length > 0) {\n                    style = 'display:block;';\n                }\n                selecteditem += '<div class=\"luckysheet-modal-dialog-slider-list-item\" ' + dataother + ' data-index=\"' + i + '\" data-name=\"' + name + '\"><div title=\"' + locale_pivotTable.titleAddColumn + '\" class=\"luckysheet-slider-list-item-selected\"><div></div></div><div title=\"' + locale_pivotTable.titleMoveColumn + '\" class=\"luckysheet-slider-list-item-name\" ' + dataother + ' data-index=\"' + i + '\" data-name=\"' + name + '\">' + name + '</div><div title=\"' + locale_pivotTable.titleClearColumnFilter + '\" class=\"luckysheet-slider-list-item-filtered\" style=\"' + style + '\"><i class=\"fa fa-filter luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i><i class=\"fa fa-times\" aria-hidden=\"true\"></i></div><div title=\"' + locale_pivotTable.titleFilterColumn + '\" class=\"luckysheet-slider-list-item-filter\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n            }\n            $('#luckysheet-modal-dialog-pivotTable-list').html(selecteditem);\n            $('#luckysheetpivottablevaluecolrowshow').hide();\n            $('#luckysheetpivottablevaluecolrow').prop('checked', true);\n            $('#luckysheetpivottablevaluecolrow1').prop('checked', false);\n            $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').empty();\n            if (restore) {\n                if (_this.filter != null && _this.filter.length > 0) {\n                    for (let i = 0; i < _this.filter.length; i++) {\n                        let item = _this.filter[i];\n                        let itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" data-index=\"' + item.index + '\" data-name=\"' + item.name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" data-index=\"' + item.index + '\" data-name=\"' + item.name + '\">' + item.name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                        $('#luckysheet-modal-dialog-config-filter').append(itemHTML);\n                        let $seleted = $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(item.index).find('.luckysheet-slider-list-item-selected');\n                        if ($seleted.find('i').length == 0) {\n                            $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                        }\n                    }\n                }\n                if (_this.row != null && _this.row.length > 0) {\n                    for (let i = 0; i < _this.row.length; i++) {\n                        let item = _this.row[i];\n                        let otherset = '';\n                        if (item.order != null) {\n                            otherset += \"data-order = '\" + item.order + \"'\";\n                        }\n                        if (item.orderby != null) {\n                            otherset += \"data-orderby = '\" + item.orderby + \"'\";\n                        }\n                        if (item.order != null) {\n                            otherset += \"data-stastic = '\" + item.stastic + \"'\";\n                        }\n                        let itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\">' + item.name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                        $('#luckysheet-modal-dialog-config-row').append(itemHTML);\n                        let $seleted = $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(item.index).find('.luckysheet-slider-list-item-selected');\n                        if ($seleted.find('i').length == 0) {\n                            $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                        }\n                    }\n                }\n                if (_this.column != null && _this.column.length > 0) {\n                    for (let i = 0; i < _this.column.length; i++) {\n                        let item = _this.column[i];\n                        let otherset = '';\n                        if (item.order != null) {\n                            otherset += \"data-order = '\" + item.order + \"'\";\n                        }\n                        if (item.orderby != null) {\n                            otherset += \"data-orderby = '\" + item.orderby + \"'\";\n                        }\n                        if (item.order != null) {\n                            otherset += \"data-stastic = '\" + item.stastic + \"'\";\n                        }\n                        let itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\">' + item.name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                        $('#luckysheet-modal-dialog-config-column').append(itemHTML);\n                        let $seleted = $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(item.index).find('.luckysheet-slider-list-item-selected');\n                        if ($seleted.find('i').length == 0) {\n                            $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                        }\n                    }\n                }\n                if (_this.values != null && _this.values.length > 0) {\n                    for (let i = 0; i < _this.values.length; i++) {\n                        let item = _this.values[i];\n                        let otherset = '';\n                        if (item.sumtype != null) {\n                            otherset += \"data-sumtype = '\" + item.sumtype + \"'\";\n                        }\n                        if (item.nameindex != null) {\n                            otherset += \"data-nameindex = '\" + item.nameindex + \"'\";\n                        }\n                        let itemHTML = '<div title=\"' + name + '\" class=\"luckysheet-modal-dialog-slider-config-item\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\"><div class=\"luckysheet-modal-dialog-slider-config-item-txt\" ' + otherset + ' data-index=\"' + item.index + '\" data-name=\"' + item.name + '\">' + _this.getSumTypeName(item.sumtype) + ':' + item.name + '</div><div class=\"luckysheet-modal-dialog-slider-config-item-icon\"><i class=\"fa fa-sort-desc\" aria-hidden=\"true\"></i></div></div>';\n                        $('#luckysheet-modal-dialog-config-value').append(itemHTML);\n                        let $seleted = $('#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item').eq(item.index).find('.luckysheet-slider-list-item-selected');\n                        if ($seleted.find('i').length == 0) {\n                            $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                        }\n                    }\n                    if (_this.values.length >= 2) {\n                        $('#luckysheetpivottablevaluecolrowshow').show();\n                        if (_this.showType == 'column') {\n                            $('#luckysheetpivottablevaluecolrow').prop('checked', true);\n                            $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']\").addClass('ui-state-active');\n                            $('#luckysheetpivottablevaluecolrow1').prop('checked', false);\n                            $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']\").removeClass('ui-state-active');\n                        } else {\n                            $('#luckysheetpivottablevaluecolrow1').prop('checked', true);\n                            $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']\").addClass('ui-state-active');\n                            $('#luckysheetpivottablevaluecolrow').prop('checked', false);\n                            $(\"#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']\").removeClass('ui-state-active');\n                        }\n                    }\n                }\n            }\n            $('#luckysheet-dialog-pivotTable-range').html(getRangetxt(_this.pivotDataSheetIndex, _this.pivot_select_save));\n            $('#luckysheet-modal-dialog-slider-pivot').show();\n            luckysheetsizeauto(false);\n        },\n        getComposeArray: function (data) {\n            if (data.length == 0) {\n                return [];\n            }\n            let ret = [];\n            for (let i = 0; i < data.length; i++) {\n                let name = '';\n                for (let x = 0; x <= i; x++) {\n                    if (!!data[x] && !!data[x]['m']) {\n                        name += data[x]['m'];\n                    } else {\n                        name += getcellvalue(x, null, data);\n                    }\n                }\n                ret.push(name);\n            }\n            return ret;\n        },\n        getnameArray: function (data, field) {\n            if (data.length == 0) {\n                return [];\n            }\n            if (field.length == 0) {\n                return [];\n            }\n            let ret = [];\n            for (let i = 0; i < field.length; i++) {\n                let c_value;\n                if (!!data[field[i].index] && !!data[field[i].index]['m']) {\n                    c_value = data[field[i].index]['m'];\n                } else {\n                    c_value = getcellvalue(field[i].index, null, data);\n                }\n                ret.push(c_value);\n            }\n            return ret;\n        },\n        getTitleFromGroup: function (group, config, dataposition) {\n            let _this = this;\n            let orderbygroup = _this.orderbygroup(group, config, dataposition);\n            return _this.generategrouparraymain(orderbygroup, config);\n        },\n        orderbygroup: function (group, config, dataposition) {\n            let _this = this;\n            let stackset = [];\n            if (group.length == 0) {\n                return [];\n            }\n            stackset = group;\n            let d = null, alllength = stackset.length, alllengthInital = stackset.length, a = 0;\n            while (alllength != 0) {\n                d = stackset[a++];\n                alllength--;\n                if (d.children != null && d.children.length > 0) {\n                    d.children = _this.orderbygroupchildren(d.children, config[d.index].orderby, config[d.index].order, dataposition);\n                    for (let i = 0; i < d.children.length; i++) {\n                        stackset.push(d.children[i]);\n                        alllength++;\n                    }\n                }\n            }\n            return group.splice(0, alllengthInital);\n        },\n        orderbygroupchildren: function (childrens, orderby, order, dataposition) {\n            if (childrens.length == 0) {\n                return [];\n            }\n            let isAsc = false;\n            if (order == null || order == 'asc') {\n                isAsc = true;\n            }\n            const _locale = locale();\n            const locale_filter = _locale.filter;\n            let a = function (x, y) {\n                let f = null, s = null;\n                if (orderby == 'self' || orderby == null) {\n                    if (x.name == null) {\n                        f = locale_filter.valueBlank;\n                    } else {\n                        f = x.name.toString();\n                    }\n                    if (y.name == null) {\n                        s = locale_filter.valueBlank;\n                    } else {\n                        s = y.name.toString();\n                    }\n                    if (isdatetime(f) && isdatetime(s)) {\n                        return diff(f, s);\n                    }\n                } else {\n                    f = parseFloat(dataposition[x.orderby].result);\n                    s = parseFloat(dataposition[y.orderby].result);\n                }\n                if (!isNaN(f) && !isNaN(s)) {\n                    return numeral(f).value() - numeral(s).value();\n                } else if (isNaN(f) && isNaN(s)) {\n                    return f.localeCompare(s);\n                } else if (isNaN(f)) {\n                    return 1;\n                } else if (isNaN(s)) {\n                    return -1;\n                }\n            };\n            let d = function (x, y) {\n                let f = null, s = null;\n                if (orderby == 'self' || orderby == null) {\n                    if (x.name == null) {\n                        f = locale_filter.valueBlank;\n                    } else {\n                        f = x.name.toString();\n                    }\n                    if (y.name == null) {\n                        s = locale_filter.valueBlank;\n                    } else {\n                        s = y.name.toString();\n                    }\n                    if (isdatetime(f) && isdatetime(s)) {\n                        return diff(f, s);\n                    }\n                } else {\n                    f = parseFloat(dataposition[x.orderby].result);\n                    s = parseFloat(dataposition[y.orderby].result);\n                }\n                if (!isNaN(f) && !isNaN(s)) {\n                    return numeral(s).value() - numeral(f).value();\n                } else if (isNaN(f) && isNaN(s)) {\n                    return s.localeCompare(f);\n                } else if (isNaN(f)) {\n                    return -1;\n                } else if (isNaN(s)) {\n                    return 1;\n                }\n            };\n            if (isAsc) {\n                return childrens.sort(a);\n            } else {\n                return childrens.sort(d);\n            }\n        },\n        generategroupaddstatic: function (arr, name) {\n            let stasticarr = [];\n            const _locale = locale();\n            const locale_pivotTable = _locale.pivotTable;\n            for (let a = 0; a < arr[0].length; a++) {\n                if (a == 0) {\n                    if (name == locale_pivotTable.valueSum) {\n                        stasticarr.push(name);\n                    } else {\n                        stasticarr.push({\n                            'name': name,\n                            'issum': true\n                        });\n                    }\n                } else {\n                    stasticarr.push('');\n                }\n            }\n            return stasticarr;\n        },\n        generategrouparraymain: function (group, config) {\n            let _this = this;    //\n            //\n            let ret = [];\n            for (let i = 0; i < group.length; i++) {\n                let name = group[i].name;\n                let arr = _this.generategrouparray(group[i].children, config, 1);\n                if (config[0].stastic == '1' || config[0].stastic == null) {\n                    arr.push(_this.generategroupaddstatic(arr, name));\n                }\n                ret = ret.concat(arr);\n            }\n            return ret;\n        },\n        generategrouparray: function (group, config, level) {\n            let _this = this;\n            let ret = [];\n            for (let i = 0; i < group.length; i++) {\n                let name = group[i].name;\n                let arr;\n                if (group[i].children == 0 || group[i].children.length == 0) {\n                    arr = [name];\n                    ret.push(arr);\n                } else {\n                    arr = _this.generategrouparray(group[i].children, config, level + 1);\n                    for (let a = 0; a < arr.length; a++) {\n                        arr[a].unshift(name);\n                    }\n                    if (config[level].stastic == '1' || config[level].stastic == null) {\n                        arr.push(_this.generategroupaddstatic(arr, name));\n                    }\n                    ret = ret.concat(arr);\n                }\n            }\n            return ret;\n        },\n        addStatisticsData: function (dataposition, valueobj, indicator, d_value) {\n            if (dataposition[indicator] == null) {\n                dataposition[indicator] = {\n                    'data': [],\n                    'count': 0,\n                    'max': -Infinity,\n                    'min': Infinity,\n                    'counta': 0,\n                    'countunique': 0,\n                    'countuniquedata': {},\n                    'sum': 0,\n                    'digitaldata': [],\n                    'sumtype': valueobj.sumtype,\n                    'index': valueobj.index,\n                    'name': valueobj.fullname,\n                    'acc': 0\n                };\n            }\n            if (isdatatypemulti(d_value)['num'] === true) {\n                let num = numFormat(d_value);\n                dataposition[indicator]['digitaldata'].push(num);\n                dataposition[indicator]['count'] += 1;\n                dataposition[indicator]['sum'] += num;\n                if (num > dataposition[indicator]['max']) {\n                    dataposition[indicator]['max'] = num;\n                }\n                if (num < dataposition[indicator]['min']) {\n                    dataposition[indicator]['min'] = num;\n                }\n                let newAcc = numfloatlen(num);\n                if (newAcc > dataposition[indicator]['acc']) {\n                    dataposition[indicator]['acc'] = newAcc;\n                }\n            }\n            if (d_value != '') {\n                dataposition[indicator]['data'].push(d_value);\n                dataposition[indicator]['counta'] += 1;\n                if (!(d_value in dataposition[indicator]['countuniquedata'])) {\n                    dataposition[indicator]['countuniquedata'][d_value] = 1;\n                    dataposition[indicator]['countunique'] += 1;\n                }\n            }\n        },\n        dataHandler: function (column, row, values, showType, celldata) {\n            //column:[{\"index\":1, name:\"1\", \"order\":\"asc\", \"orderby\":\"self/0/1/2\", \"stastic\":\"0/1\"}]\n            //row:[{\"index\":1, name:\"3\", \"order\":\"asc\", \"orderby\":\"self/0/1/2\", \"stastic\":\"0/1\"}]\n            //values:[{\"index\":1, \"sumtype\":\"SUM/COUNT/COUNTA/COUNTUNIQUE/AVERAGE/MAX/MIN/MEDIAN/PRODUCT/STDEV/STDEVP/let/VARP\", \"name\":\":fyc\"}]\n            let _this = this;\n            const _locale = locale();\n            const locale_filter = _locale.filter;\n            const locale_pivotTable = _locale.pivotTable;\n            if (showType == null) {\n                showType = 'column';\n            }\n            if (column.length == 0 && row.length == 0 && values.length == 0 || celldata.length == 0) {\n                _this.pivotDatas = [];\n                return [];\n            }    //\n            //\n            let dataposition = {}, data = celldata, datarowtitle = [], datarowtitlegroup = [], datarowposition = {}, datarowposition_i = 0, datacoltitle = [], datacoltitlegroup = [], datacolposition = {}, datacolposition_i = 0;\n            for (let i = 1; i < data.length; i++) {\n                let d = data[i];\n                let groupbyrowtxt = '', groupbycoltxt = '', rowtxt = '', rowtitle = [], rowtitlename = [], coltxt = '', coltitle = [], coltitlename = [];    //[\"\", \"\", \"\"]  [\"\", \"\", \"\"]\n                //[\"\", \"\", \"\"]  [\"\", \"\", \"\"]\n                rowtitlename = _this.getnameArray(d, row);\n                coltitlename = _this.getnameArray(d, column);\n                rowtitle = _this.getComposeArray(rowtitlename);\n                coltitle = _this.getComposeArray(coltitlename);\n                if (rowtitle.length > 0) {\n                    rowtitle.unshift(locale_pivotTable.valueSum);\n                }\n                if (coltitle.length > 0) {\n                    coltitle.unshift(locale_pivotTable.valueSum);\n                }\n                let curentLevelobj_row = datarowposition, curentLevelarr_row = datarowtitlegroup;\n                for (let r = 0; r < rowtitle.length; r++) {\n                    let item = rowtitle[r], name = r == 0 ? locale_pivotTable.valueSum : rowtitlename[r - 1];    //\n                    //\n                    if (curentLevelobj_row[r.toString()] != null && curentLevelobj_row[r.toString()][item] != null) {\n                        //\n                        curentLevelarr_row = curentLevelarr_row[curentLevelobj_row[r.toString()][item]].children;\n                    } else {\n                        let orderby = r == 0 ? 'self' : row[r - 1].orderby == 'self' || row[r - 1].orderby == null ? item : showType == 'column' ? item + values[parseInt(row[r - 1].orderby)].fullname : item + locale_pivotTable.valueSum;\n                        if (name == null) {\n                            name = locale_filter.valueBlank;\n                        }\n                        curentLevelarr_row.push({\n                            'name': name,\n                            'fullname': item,\n                            'index': r,\n                            'orderby': orderby,\n                            'children': []\n                        });\n                        if (curentLevelobj_row[r.toString()] == null) {\n                            curentLevelobj_row[r.toString()] = {};\n                        }\n                        if (curentLevelobj_row[r.toString()][item] == null) {\n                            curentLevelobj_row[r.toString()][item] = curentLevelarr_row.length - 1;\n                        }\n                        curentLevelarr_row = curentLevelarr_row[curentLevelarr_row.length - 1].children;\n                    }\n                }\n                let curentLevelobj_col = datacolposition, curentLevelarr_col = datacoltitlegroup;\n                for (let r = 0; r < coltitle.length; r++) {\n                    let item = coltitle[r], name = r == 0 ? locale_pivotTable.valueSum : coltitlename[r - 1];\n                    if (curentLevelobj_col[r.toString()] != null && curentLevelobj_col[r.toString()][item] != null) {\n                        curentLevelarr_col = curentLevelarr_col[curentLevelobj_col[r.toString()][item]].children;\n                    } else {\n                        let orderby = r == 0 ? 'self' : column[r - 1].orderby == 'self' || column[r - 1].orderby == null ? item : showType == 'column' ? locale_pivotTable.valueSum + item : values[parseInt(column[r - 1].orderby)].fullname + item;\n                        if (name == null) {\n                            name = locale_filter.valueBlank;\n                        }\n                        curentLevelarr_col.push({\n                            'name': name,\n                            'fullname': item,\n                            'index': r,\n                            'orderby': orderby,\n                            'children': []\n                        });\n                        if (curentLevelobj_col[r.toString()] == null) {\n                            curentLevelobj_col[r.toString()] = {};\n                        }\n                        if (curentLevelobj_col[r.toString()][item] == null) {\n                            curentLevelobj_col[r.toString()][item] = curentLevelarr_col.length - 1;\n                        }\n                        curentLevelarr_col = curentLevelarr_col[curentLevelarr_col.length - 1].children;\n                    }\n                }\n                let v_str = '';\n                for (let v = 0; v < values.length; v++) {\n                    let d_value = getcellvalue(values[v].index, null, d);\n                    let coltitle_c = [].concat(coltitle), rowtitle_c = [].concat(rowtitle);\n                    if (showType == 'column') {\n                        if (coltitle_c.length > 0) {\n                            coltitle_c.push('');\n                            coltitle_c = coltitle_c.join(values[v].fullname + '|||').split('|||').slice(0, coltitle_c.length - 1);\n                        } else {\n                            coltitle_c.push(values[v].fullname);\n                        }\n                    } else {\n                        if (rowtitle_c.length > 0) {\n                            rowtitle_c.push('');\n                            rowtitle_c = rowtitle_c.join(values[v].fullname + '|||').split('|||').slice(0, rowtitle_c.length - 1);\n                        } else {\n                            rowtitle_c.push(values[v].fullname);\n                        }\n                    }\n                    if (coltitle_c.length == 0) {\n                        coltitle_c.push('');\n                    }\n                    if (rowtitle_c.length == 0) {\n                        rowtitle_c.push('');\n                    }\n                    for (let r = 0; r < rowtitle_c.length; r++) {\n                        for (let c = 0; c < coltitle_c.length; c++) {\n                            let indicator = rowtitle_c[r] + coltitle_c[c];\n                            _this.addStatisticsData(dataposition, values[v], indicator, d_value);\n                        }\n                    }\n                }\n            }    //\n                 //SUM/COUNT/COUNTA/COUNTUNIQUE/AVERAGE/MAX/MIN/MEDIAN/PRODUCT/STDEV/STDEVP/let/VARP\n            //\n            //SUM/COUNT/COUNTA/COUNTUNIQUE/AVERAGE/MAX/MIN/MEDIAN/PRODUCT/STDEV/STDEVP/let/VARP\n            for (let indicator in dataposition) {\n                let json = dataposition[indicator];\n                if (json.sumtype == 'SUM') {\n                    json.result = json.sum;\n                } else if (json.sumtype == 'COUNT') {\n                    json.result = json.count;\n                } else if (json.sumtype == 'COUNTA') {\n                    json.result = json.counta;\n                } else if (json.sumtype == 'COUNTUNIQUE') {\n                    json.result = json.countunique;\n                } else if (json.sumtype == 'AVERAGE') {\n                    json.result = numFormat(json.sum / json.count);\n                } else if (json.sumtype == 'MAX') {\n                    json.result = json.max;\n                } else if (json.sumtype == 'MIN') {\n                    json.result = json.min;\n                } else if (json.sumtype == 'MEDIAN') {\n                    let numArr = json.digitaldata.sort(function (a, b) {\n                        return a - b;\n                    });\n                    let numLen = numArr.length;\n                    let numindex = parseInt(numLen / 2);\n                    if (numLen % 2 == 0) {\n                        json.result = (numArr[numindex - 1] + numArr[numindex]) / 2;\n                    } else {\n                        json.result = numArr[numindex];\n                    }\n                } else if (json.sumtype == 'PRODUCT') {\n                    json.result = new Function('return ' + json.digitaldata.join('*'))();\n                } else if (json.sumtype == 'STDEV') {\n                    let mean = json.sum / json.count;\n                    json.result = analysis.STDEV(mean, json.digitaldata);\n                } else if (json.sumtype == 'STDEVP') {\n                    let mean = json.sum / json.count;\n                    json.result = analysis.STDEVP(mean, json.digitaldata);\n                } else if (json.sumtype == 'let') {\n                    let mean = json.sum / json.count;\n                    json.result = analysis.let(mean, json.digitaldata);\n                } else if (json.sumtype == 'VARP') {\n                    let mean = json.sum / json.count;\n                    json.result = analysis.VARP(mean, json.digitaldata);\n                }\n                let newAcc = numfloatlen(json.result);\n                if (newAcc > json.acc) {\n                    json.acc = newAcc;\n                }\n                json.result = numFormat(json.result, json.acc);\n            }\n            datarowtitle = _this.getTitleFromGroup(datarowtitlegroup, row, dataposition);\n            datacoltitle = _this.getTitleFromGroup(datacoltitlegroup, column, dataposition);    ///\n            ///\n            if (showType == 'column') {\n                if (datacoltitle.length > 0 && datacoltitle[0].length > 0) {\n                    datacoltitle = _this.addValuesToTitle(datacoltitle, values);\n                } else {\n                    for (let v = 0; v < values.length; v++) {\n                        datacoltitle.push([values[v].fullname]);\n                    }\n                }\n            } else {\n                if (datarowtitle.length > 0 && datarowtitle[0].length > 0) {\n                    datarowtitle = _this.addValuesToTitle(datarowtitle, values);\n                } else {\n                    for (let v = 0; v < values.length; v++) {\n                        datarowtitle.push([values[v].fullname]);\n                    }\n                }\n            }\n            let datacoltitle_index = datacoltitle;\n            datacoltitle = luckysheetArray.transpose(datacoltitle, false);\n            let valuenslen = values.length == 0 ? 0 : 1;\n            let rowLen = (datacoltitle.length == 0 ? valuenslen : datacoltitle.length) + (datarowtitle.length == 0 ? valuenslen : datarowtitle.length), colLen = (datacoltitle.length == 0 ? valuenslen : datacoltitle[0].length) + (datarowtitle.length == 0 ? valuenslen : datarowtitle[0].length);\n            let rowOver = datacoltitle.length, colOver = datarowtitle.length == 0 ? 0 : datarowtitle[0].length;\n            let retdata = [];\n            for (let r = 0; r < rowLen; r++) {\n                retdata[r] = new Array(colLen);\n                for (let c = 0; c < colLen; c++) {\n                    let drt = datarowtitle[r - rowOver];\n                    if (r < rowOver && c < colOver) {\n                        //\n                        retdata[r][c] = '';\n                    } else if (r < rowOver && c >= colOver) {\n                        //\n                        if (datacoltitle[r] != null) {\n                            if (getObjType(datacoltitle[r][c - colOver]) == 'object') {\n                                retdata[r][c] = datacoltitle[r][c - colOver].name + locale_pivotTable.valueSum;\n                            } else {\n                                retdata[r][c] = datacoltitle[r][c - colOver];\n                            }\n                        } else {\n                            retdata[r][c] = '';\n                        }\n                    } else if (r >= rowOver && c < colOver) {\n                        //\n                        if (drt != null) {\n                            if (getObjType(drt[c]) == 'object') {\n                                retdata[r][c] = drt[c].name + locale_pivotTable.valueSum;\n                            } else {\n                                retdata[r][c] = drt[c];\n                            }\n                        } else {\n                            retdata[r][c] = '';\n                        }\n                    } else {\n                        //\n                        let prefix = '';\n                        if (drt != null) {\n                            if (!(drt instanceof Array) || drt.length == 1) {\n                                if (drt instanceof Array) {\n                                    prefix = drt[0];\n                                } else {\n                                    prefix = drt;\n                                }\n                            } else {\n                                for (let x = 0; x < drt.length; x++) {\n                                    if (getObjType(drt[x]) == 'object') {\n                                        prefix += drt[x].name;\n                                    } else {\n                                        prefix += drt[x];\n                                    }\n                                }\n                            }\n                        }\n                        let suffix = '';\n                        let dct = datacoltitle_index[c - colOver];\n                        if (dct != null) {\n                            if (!(dct instanceof Array) || dct.length == 1) {\n                                if (dct instanceof Array) {\n                                    suffix = dct[0];\n                                } else {\n                                    suffix = dct;\n                                }\n                            } else {\n                                for (let x = 0; x < dct.length; x++) {\n                                    if (getObjType(dct[x]) == 'object') {\n                                        suffix += dct[x].name;\n                                    } else {\n                                        suffix += dct[x];\n                                    }\n                                }\n                            }\n                        }\n                        let indicator = prefix;\n                        if (prefix != '' && suffix != '') {\n                            indicator = prefix + suffix;\n                        } else if (prefix == '') {\n                            indicator = suffix;\n                        }\n                        if (dataposition[indicator] == null) {\n                            retdata[r][c] = '';\n                        } else {\n                            retdata[r][c] = dataposition[indicator].result;\n                        }\n                    }\n                }\n            }\n            if (values.length == 1 && column.length > 0 && row.length > 0) {\n                retdata[0][0] = values[0].fullname;\n                retdata.splice(column.length, 1);\n            } else if (values.length == 1 && column.length > 0) {\n                // 0: (6) [\"English\", \"foreign language\", \"mathematics\", \"science\", \"Sum\", undefined]\n                // 1: (6) [\"CountA:score\", \"CountA:score\", \"CountA:score\", \"CountA:score\", \"CountA:score\", undefined]\n                // 2: (6) [3, 3, 3, 3, 12, \"\"]\n                //The above format does not meet viewing habits,Process retdata into the correct format\n                let titleRow = retdata.splice(column.length, 1);\n                let newRetdata = [];\n                for (let r = 0; r < retdata.length; r++) {\n                    let row = [];\n                    if (r == retdata.length - 1) {\n                        row.push(titleRow[0][0]);\n                    } else {\n                        row.push('');\n                    }\n                    for (let c = 0; c < retdata[r].length - 1; c++) {\n                        row.push(retdata[r][c]);\n                    }\n                    newRetdata.push(row);\n                }\n                retdata = newRetdata;\n            }\n            _this.pivotDatas = retdata;\n            return retdata;\n        },\n        drillDown: function (row_index, col_index) {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'usePivotTablereports')) {\n                return;\n            }\n            let _this = this;\n            let cell = _this.pivotDatas[row_index][col_index];\n            let d = $.extend(true, [], sheetmanage.nulldata);\n            const _locale = locale();\n            const locale_filter = _locale.filter;\n            const locale_pivotTable = _locale.pivotTable;\n            let selecteditemNullIndex = 1;\n            for (let i = 0; i < _this.celldata[0].length; i++) {\n                let name;\n                if (!!_this.celldata[0][i] && !!_this.celldata[0][i]['m']) {\n                    name = _this.celldata[0][i]['m'];\n                } else {\n                    name = getcellvalue(0, i, _this.celldata);\n                }\n                if (name != null) {\n                    name = name.toString();\n                }\n                if (name == null || $.trim(name.toString()).length == 0) {\n                    name = locale_pivotTable.titleColumn + ' ' + selecteditemNullIndex;\n                }\n                selecteditemNullIndex++;\n                d[0][i] = name;\n            }\n            let obj = {};    //\n            //\n            if (_this.row != null && _this.row.length > 0) {\n                for (let a = 0; a < _this.row.length; a++) {\n                    obj[_this.row[a]['index']] = _this.pivotDatas[row_index][a];\n                }\n            }    //\n            //\n            if (_this.column != null && _this.column.length > 0) {\n                for (let b = 0; b < _this.column.length; b++) {\n                    obj[_this.column[b]['index']] = _this.pivotDatas[b][col_index];\n                }\n            }\n            let rowArr = [];\n            for (let j = 1; j < _this.celldata.length; j++) {\n                let isEqual = true;\n                for (let x in obj) {\n                    let value;\n                    if (!!_this.celldata[j][x] && !!_this.celldata[j][x]['m']) {\n                        value = _this.celldata[j][x]['m'];\n                    } else {\n                        value = getcellvalue(j, x, _this.celldata);\n                    }\n                    if (value != null) {\n                        value = value.toString();\n                    } else {\n                        value = locale_filter.valueBlank;\n                    }\n                    if (value != obj[x]) {\n                        isEqual = false;\n                        break;\n                    }\n                }\n                if (isEqual) {\n                    rowArr.push(j);\n                }\n            }\n            for (let r = 0; r < rowArr.length; r++) {\n                for (let c = 0; c < _this.celldata[0].length; c++) {\n                    let value;\n                    if (!!_this.celldata[rowArr[r]][c] && !!_this.celldata[rowArr[r]][c]['m']) {\n                        value = _this.celldata[rowArr[r]][c]['m'];\n                    } else {\n                        value = getcellvalue(rowArr[r], c, _this.celldata);\n                    }\n                    if (value != null) {\n                        value = value.toString();\n                    } else {\n                        value = '';\n                    }\n                    d[r + 1][c] = value;\n                }\n            }\n            Store.luckysheet_select_save = [{\n                    'row': [\n                        0,\n                        rowArr.length\n                    ],\n                    'column': [\n                        0,\n                        _this.celldata[0].length - 1\n                    ]\n                }];\n            Store.clearjfundo = false;\n            jfrefreshgrid(d, Store.luckysheet_select_save);\n            selectHightlightShow();\n            Store.clearjfundo = true;\n        }\n    };\n    return pivotTable;\n});"]}