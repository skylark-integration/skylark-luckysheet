{"version":3,"sources":["controllers/handler.js"],"names":["define","mobileinit","luckysheetConfigsetting","luckysheetFreezen","pivotTable","luckysheetDropCell","luckysheetPostil","imageCtrl","hyperlinkCtrl","dataVerificationCtrl","menuButton","conditionformat","alternateformat","ifFormulaGenerator","sheetmanage","m_updateCell","m_sheetSearch","luckysheetsizeauto","m_sheetMove","m_select","selection","controlHistory","splitColumn","m_cursorPos","m_constant","m_protection","m_cellFormat","m_util","m_get","m_location","m_getRowlen","m_validate","m_count","cells","browser","formula","m_extend","luckysheetscrollevent","m_getdata","tooltip","m_format","method","m_border","m_draw","locale","Store","m_plugin","luckysheetupdateCell","luckysheet_searcharray","luckysheetMoveHighlightCell","selectHightlightShow","selectIsOverlap","selectionCopyShow","luckysheet_count_show","selectHelpboxFill","hideMenuByCancel","luckysheetdefaultstyle","checkProtectionLockedRangeList","checkProtectionAllSelected","checkProtectionSelectLockedOrUnLockedCells","checkProtectionNotEnable","checkProtectionAuthorityNormal","openCellFormatModel","replaceHtml","getObjType","chatatABC","ArrayUnique","showrightclickmenu","luckysheetactiveCell","luckysheetContainerFocus","$$","getSheetIndex","getRangetxt","rowLocation","colLocation","mouseposition","rowlenByRange","isRealNull","hasPartMC","isEditMode","countfunc","luckysheetextendtable","getdatabyselection","datagridgrowth","genarate","getBorderInfoCompute","luckysheetDrawMain","createLuckyChart","hideAllNeedRangeShow","detectOS","mobilecheck","Date","now","getTime","vendors","i","length","window","requestAnimationFrame","vp","cancelAnimationFrame","test","navigator","userAgent","lastTime","callback","nextTime","Math","max","setTimeout","clearTimeout","$","mousewheel","event","delta","scrollNum","deltaFactor","scrollLeft","this","deltaY","deltaX","preventDefault","scroll","_locale","locale_drag","drag","locale_info","info","mousewheelArrayUniqueTimeout","scrollTop","visibledatacolumn_c","visibledatacolumn","visibledatarow_c","visibledatarow","freezenhorizontaldata","freezenverticaldata","visibledatacolumn_unique","visibledatarow_unique","row_st","rowscroll","row_ed","step","round","zoomRatio","resize","document","getElementById","container","mouseup","e","inputMenuButtonFocus","target","mousedown","hasClass","$showEle","undefined","forEach","ele","id","replace","cooperativeEdit","usernameTimeout","style","display","hideUsername","find","css","end","removeActivePs","is","cancelActiveImgItem","mouse","pageX","pageY","cellmainWidth","cellMainSrollBarSize","cellmainHeight","x","y","sheetFile","getSheetByIndex","luckysheetTableContent","get","getContext","row_location","row","row_pre","row_index","col_location","col","col_pre","col_index","row_index_ed","col_index_ed","margeset","mergeborer","flowdata","column","createHookFunction","r","c","start_r","start_c","end_r","end_c","cellFocus","which","hide","isright","s","luckysheet_select_save","dd","fireMousedown","hyperlink","luckysheet_scroll_status","$input","parseInt","rangestart","rangedrag_column_start","rangedrag_row_start","israngeseleciton","rowseleted","columnseleted","left","width","top","height","shiftKey","last","func_selectedrange","row_focus","column_focus","changeparam","mergeMoveMain","ctrlKey","text","vText","lastWord","substr","functionHTMLGenerate","getSelection","currSelection","functionRangeIndex","anchorNode","parent","index","anchorOffset","textRange","createRange","html","canceFunctionrangeSelected","createRangeHightlight","rangeHightlightselected","left_move","width_move","top_move","height_move","rangeSetValue","show","$editor","rangechangeindex","data_parm_index","closest","$span","setCaretPosition","updatecell","luckysheetCellUpdate","luckysheet_select_status","currentSheetIndex","selectStatus","selectRange","push","range","getTxtByRange","val","rangetosheet","luckysheetfile","name","singleRangeFocus","click","extend","luckysheet_pivotTable_select_state","menuButtonFocus","fucntionboxshow","scrollAdaptOfselect","saveParam","rangefocus","pivotclick","allowEdit","obj_s","cellRightClickConfig","copy","copyAs","paste","insertColumn","deleteColumn","hideColumn","columnWidth","clear","matrix","sort","filter","chart","image","link","data","cellFormat","luckysheetRightHeadClickIs","rightclick","right","luckysheet_cols_menu_status","cfg","config","first_collen","defaultcollen","isSame","c1","c2","insertRow","deleteRow","hideRow","rowHeight","bottom","first_rowlen","defaultrowlen","r1","r2","deleteCell","dblclick","isPivotRange","values","showType","pivotDatas","addNewSheet","drillDown","luckysheetPaintModelOn","cancelPaintModel","addEventListener","stopPropagation","files","dataTransfer","type","indexOf","render","FileReader","readAsDataURL","onload","src","result","inserImg","hook","cellDragStop","handleCellDragStopEvent","on","overshow","jfautoscrollTimeout","sheetMousemove","moveState","functionResizeStatus","horizontalmoveState","horizontalmovestate","verticalmoveState","verticalmovestate","pivotTableMoveState","movestate","sheetMoveStatus","luckysheet_sheet_move_status","scrollStatus","rowsSelectedStatus","luckysheet_rows_selected_status","colsSelectedStatus","luckysheet_cols_selected_status","cellSelectedMove","luckysheet_cell_selected_move","cellSelectedExtend","luckysheet_cell_selected_extend","colsChangeSize","luckysheet_cols_change_size","rowsChangeSize","luckysheet_rows_change_size","chartMove","chartparam","luckysheetCurrentChartMove","chartResize","luckysheetCurrentChartResize","rangeResize","rangeMove","movepx","functionResizeData","mpx","calculatebarHeight","winh","background","cursor","functionResizeTimeout","columnHeaderHeight","windowHeight","cutVolumn","saveFreezen","rowHeaderWidth","windowWidth","movesave","abs","luckysheet_sheet_move_data","winW","curleft","offset","activeobject","widthlist","cursorobject","curindex","insertAfter","eq","insertBefore","each","outerWidth","luckysheet_model_move_state","winH","myh","luckysheet_model_move_obj","myw","luckysheet_model_xy","countfuncTimeout","mouseRender","stop","sleft","scrollFreezen","rangedrag","rangedrag_row","rangedrag_column","sheetBarHeight","statisticBarHeight","row_index_original","luckysheet_cell_selected_move_index","col_index_original","row_s","row_e","col_s","col_e","luckysheet_cell_selected_extend_index","luckysheet_cols_change_size_start","luckysheet_rows_change_size_start","luckysheetCurrentChartMoveObj","luckysheetCurrentChartMoveXy","luckysheetCurrentChartMoveWinH","luckysheetCurrentChartMoveWinW","scrollAdapt","toffset","tpsition","position","luckysheetCurrentChartResizeObj","topchange","luckysheetCurrentChartResizeXy","leftchange","luckysheetCurrentChartResizeWinW","luckysheetCurrentChartResizeWinH","resizedata","resizeChart","luckysheetCurrentChart","move","imgItem","images","currentImgId","isFixedPos","moveXY","minTop","maxTop","currentWinH","minLeft","maxLeft","currentWinW","infobarHeight","toolbarHeight","resizeXY","scaleX","crop","scaleY","defaultWidth","default","defaultHeight","offsetLeft","offsetTop","background-size","background-position","cropChange","cropChangeXY","fixedLeft","fixedTop","background-image","cropChangeObj","currentObj","outerHeight","rangeResizeDraging","rangeResizeObj","rangeResizexy","rangeResizeWinW","rangeResizeWinH","ch_width","rh_height","rangeMoveDraging","rangeMovexy","rangeMoveObj","chart_selection","sheetMouseup","pasteHandlerOfPaintModel","luckysheet_copy_save","luckysheetPaintSingle","removeAttr","removeClass","cancelFreezenHorizontal","createAssistCanvas","luckysheetrefreshgrid","cancelFreezenVertical","remove","containerid","resetOrderby","obj","showvaluecolrow","$seleted","append","refreshPivotTable","reOrderAllSheet","luckysheetCurrentChartMoveTimeout","luckysheetInsertChartTosheetChange","myTop","myLeft","scrollLeft1","scrollTop1","chart_id","attr","jfredo","sheetIndex","myHeight","myWidth","myWidth1","myHeight1","rangeResizeDragged","moveImgItem","resizeImgItem","cropChangeImgItem","ps_id","ps_r","split","ps_c","d","deepCopyFlowData","rc","ps","value","ref","isshow","buildPs","addClass","editPs","size","changeRowIndex","changeRowSelected","select","row_select","some","ceil","moveChangeSize","clearjfundo","jfundo","ctrlType","curconfig","curImages","k","allImagesShow","refreshGrid_rhcw","firstcolumnlen","changeColumnIndex","changeColumnSelected","column_select","refresh","rangeMoveDragged","alert","noMerge","borderInfoCompute","RowlChange","cell","borderInfo","bd_rangeType","rangeType","bd_range","bd_emptyRange","j","concat","CFSplitRange","bd_r","bd_c","offsetMC","bd_obj","l","t","b","mc","rf","cf","cdformat","cdformat_cellrange","cellrange","emptyRange","allParam","refreshGrid","copyRange","typeItemHide","applyType","applyRange","direction","affectPivot","hasMc","update","createIcon","luckysheet_cell_selected_extend_time","r0","c0","dropCellState","cell1","cell2","v","isNaN","tipInputNumber","tipInputNumberLimit","has_PartMC","noPartMerge","luckysheet_conditionformat_save","hasCF","cf_compute","getComputeMap","label","checksCF","noMulti","isSameRow","str_r","isSameCol","str_c","createPivotTable","locale_screenshot","screenshot","screenshotTipNoSelection","screenshotTipTitle","screenshotTipHasMulti","screenshotTipHasMerge","scrollHeight","scrollWidth","st_r","ed_r","st_c","ed_c","newCanvas","devicePixelRatio","ctx_newCanvas","beginPath","moveTo","lineTo","lineWidth","strokeStyle","stroke","closePath","Image","url","toDataURL","maxHeight","screenshotTipSuccess","dataURI","binStr","atob","len","arr","Uint8Array","charCodeAt","clickHandler","blob","Blob","element","createElement","setAttribute","URL","createObjectURL","screenshotImageName","body","appendChild","revokeObjectURL","href","removeAttribute","removeEventListener","removeChild","locale_splitText","splitText","tipNoMulti","createDialog","init","tipNoMultiColumn","file","currentTarget","trim","freezen","freezenCancel","saveFrozen","createFreezenHorizontal","createFreezenVertical","hidden","webkitHidden","msHidden","iscopyself","console","log","redo","undo","parents","dontupdate","open","myFolderUrl","chart_json","currentChart","$id","rangeArray","rangeSplitArray","content","rangeMoveIndex","rowtitle","coltitle","rangeRowCheck","exits","rangeColCheck","rangeResizeIndex","initialMenuButton","offsetWidth","offsetHeight","isPasteAction","blur","clipboardData","originalEvent","txtdata","getData","isEqual","cpDataArr","reg","RegExp","reg2","regArr","match","cpRowArr","reg2Arr","cpValue","copy_r1","copy_r2","copy_c1","copy_c2","copy_index","rs","ct","fa","m","locale_fontjson","fontjson","luckysheet_paste_iscut","pasteHandlerOfCutPaste","clearcopy","pasteHandlerOfCopyPaste","pasteImgItem","Array","colLen","colspan","$td","txt","mask","bg","bl","it","ffs","toLowerCase","ff","fs","floor","fc","ht","vt","rowspan","r_ab","c_ab","rp","cp","bt","color","borderconfig","getQKBorder","bb","br","first","cs","luckysheet_selection_range","pasteHandler","empty","execCommand","enablePage","queryExps","pageInfo","reportId","fields","mobile","frezon","currentPage","pageUrl","totalPage","addDataAjax","pageIndex","pageInfoFull","total"],"mappings":"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","file":"../../controllers/handler.js","sourcesContent":["define([\n    './mobile',\n    '../methods/luckysheetConfigsetting',\n    './freezen',\n    './pivotTable',\n    './dropCell',\n    './postil',\n    '../widgets/imageCtrl',\n    '../widgets/hyperlinkCtrl',\n    '../widgets/dataVerificationCtrl',\n    './menuButton',\n    './conditionformat',\n    './alternateformat',\n    './ifFormulaGenerator',\n    './sheetmanage',\n    './updateCell',\n    '../methods/sheetSearch',\n    '../widgets/resize',\n    './sheetMove',\n    '../widgets/select',\n    './selection',\n    './controlHistory',\n    './splitColumn',\n    '../widgets/cursorPos',\n    '../widgets/constant',\n    '../methods/protection_methods',\n    './cellFormat',\n    '../utils/util',\n    '../methods/get',\n    '../methods/location',\n    '../methods/getRowlen',\n    '../methods/validate',\n    '../methods/count',\n    '../methods/cells',\n    '../utils/browser',\n    './formula',\n    '../widgets/extend',\n    './scroll',\n    '../methods/getdata',\n    '../widgets/tooltip',\n    '../methods/format',\n    '../widgets/method',\n    '../methods/border',\n    '../widgets/draw',\n    '../locale/locale',\n    '../store',\n    '../expendPlugins/chart/plugin'\n], function (mobileinit, luckysheetConfigsetting, luckysheetFreezen, pivotTable, luckysheetDropCell, luckysheetPostil, imageCtrl, hyperlinkCtrl, dataVerificationCtrl, menuButton, conditionformat, alternateformat, ifFormulaGenerator, sheetmanage,  m_updateCell, m_sheetSearch, luckysheetsizeauto, m_sheetMove, m_select, selection, controlHistory, splitColumn, m_cursorPos, m_constant, m_protection, m_cellFormat, m_util, m_get, m_location, m_getRowlen, m_validate, m_count,cells, browser, formula, m_extend, luckysheetscrollevent,  m_getdata, tooltip, m_format, method, m_border, m_draw, locale, Store, m_plugin) {\n    'use strict';\n    const {luckysheetupdateCell} = m_updateCell;\n    const {luckysheet_searcharray} = m_sheetSearch;\n    const {luckysheetMoveHighlightCell} = m_sheetMove;\n    const {selectHightlightShow, selectIsOverlap, selectionCopyShow, luckysheet_count_show, selectHelpboxFill} = m_select;\n    const {hideMenuByCancel} = m_cursorPos;\n    const {luckysheetdefaultstyle} = m_constant;\n    const {checkProtectionLockedRangeList, checkProtectionAllSelected, checkProtectionSelectLockedOrUnLockedCells, checkProtectionNotEnable, checkProtectionAuthorityNormal} = m_protection;\n    const {openCellFormatModel} = m_cellFormat;\n    const {replaceHtml, getObjType, chatatABC, ArrayUnique, showrightclickmenu, luckysheetactiveCell, luckysheetContainerFocus, $$} = m_util;\n    const {getSheetIndex, getRangetxt} = m_get;\n    const {rowLocation, colLocation, mouseposition} = m_location;\n    const {rowlenByRange} = m_getRowlen;\n    const {isRealNull, hasPartMC} = m_validate;\n    const {isEditMode} = luckysheetConfigsetting;\n    const {countfunc} = m_count;\n    const {luckysheetextendtable} = m_extend;\n    const {getdatabyselection, datagridgrowth} = m_getdata;\n    const {genarate} = m_format;\n    const {getBorderInfoCompute} = m_border;\n    const {luckysheetDrawMain} = m_draw;\n    const {createLuckyChart, hideAllNeedRangeShow} = m_plugin;\n    //, columeflowset, rowflowset\n    return function luckysheetHandler() {\n        const os = browser.detectOS(), isMobile = browser.mobilecheck();    //移动端\n        //移动端\n        if (isMobile) {\n            mobileinit();\n        }\n        if (!Date.now)\n            Date.now = function () {\n                return new Date().getTime();\n            };\n        //requestAnimationFrame method\n        (function () {\n            'use strict';\n            var vendors = [\n                'webkit',\n                'moz'\n            ];\n            for (var i = 0; i < vendors.length && !window.requestAnimationFrame; ++i) {\n                var vp = vendors[i];\n                window.requestAnimationFrame = window[vp + 'RequestAnimationFrame'];\n                window.cancelAnimationFrame = window[vp + 'CancelAnimationFrame'] || window[vp + 'CancelRequestAnimationFrame'];\n            }\n            if (/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)    // iOS6 is buggy\n|| // iOS6 is buggy\n                !window.requestAnimationFrame || !window.cancelAnimationFrame) {\n                var lastTime = 0;\n                window.requestAnimationFrame = function (callback) {\n                    var now = Date.now();\n                    var nextTime = Math.max(lastTime + 16, now);\n                    return setTimeout(function () {\n                        callback(lastTime = nextTime);\n                    }, nextTime - now);\n                };\n                window.cancelAnimationFrame = clearTimeout;\n            }\n        }());\n        $('#luckysheet-sheet-container-c').mousewheel(function (event, delta) {\n            let scrollNum = event.deltaFactor < 40 ? 1 : event.deltaFactor < 80 ? 2 : 3;\n            let scrollLeft = $(this).scrollLeft();\n            if (event.deltaY != 0) {\n                if (event.deltaY < 0) {\n                    scrollLeft = scrollLeft + 10 * scrollNum;\n                } else {\n                    scrollLeft = scrollLeft - 10 * scrollNum;\n                }\n            } else if (event.deltaX != 0) {\n                if (event.deltaX > 0) {\n                    scrollLeft = scrollLeft + 10 * scrollNum;\n                } else {\n                    scrollLeft = scrollLeft - 10 * scrollNum;\n                }\n            }\n            $(this).scrollLeft(scrollLeft);\n            event.preventDefault();\n        });    //滚动监听\n        //滚动监听\n        $('#luckysheet-cell-main').scroll(function () {\n        }).mousewheel(function (event, delta) {\n            event.preventDefault();\n        });\n        const _locale = locale();\n        const locale_drag = _locale.drag;\n        const locale_info = _locale.info;\n        let prev, mousewheelArrayUniqueTimeout;\n        $('#luckysheet-grid-window-1').mousewheel(function (event, delta) {\n            let scrollLeft = $('#luckysheet-scrollbar-x').scrollLeft(), scrollTop = $('#luckysheet-scrollbar-y').scrollTop();\n            let visibledatacolumn_c = Store.visibledatacolumn, visibledatarow_c = Store.visibledatarow;\n            if (Store.freezenhorizontaldata != null) {\n                visibledatarow_c = Store.freezenhorizontaldata[3];\n            }\n            if (Store.freezenverticaldata != null) {\n                visibledatacolumn_c = Store.freezenverticaldata[3];\n            }\n            clearTimeout(mousewheelArrayUniqueTimeout);    // if(Store.visibledatacolumn.length!=visibledatacolumn_c.length){\n            // if(Store.visibledatacolumn.length!=visibledatacolumn_c.length){\n            if (Store.visibledatacolumn_unique != null) {\n                visibledatacolumn_c = Store.visibledatacolumn_unique;\n            } else {\n                visibledatacolumn_c = ArrayUnique(visibledatacolumn_c);\n                Store.visibledatacolumn_unique = visibledatacolumn_c;\n            }    // }\n                 // if(Store.visibledatarow.length!=visibledatarow_c.length){\n            // }\n            // if(Store.visibledatarow.length!=visibledatarow_c.length){\n            if (Store.visibledatarow_unique != null) {\n                visibledatarow_c = Store.visibledatarow_unique;\n            } else {\n                visibledatarow_c = ArrayUnique(visibledatarow_c);\n                Store.visibledatarow_unique = visibledatarow_c;\n            }    // }\n                 // visibledatacolumn_c = ArrayUnique(visibledatacolumn_c);\n                 // visibledatarow_c = ArrayUnique(visibledatarow_c);\n            // }\n            // visibledatacolumn_c = ArrayUnique(visibledatacolumn_c);\n            // visibledatarow_c = ArrayUnique(visibledatarow_c);\n            let col_st = luckysheet_searcharray(visibledatacolumn_c, scrollLeft);\n            let row_st = luckysheet_searcharray(visibledatarow_c, scrollTop);\n            if (Store.freezenhorizontaldata != null) {\n                row_st = luckysheet_searcharray(visibledatarow_c, scrollTop + Store.freezenhorizontaldata[0]);\n            }\n            let colscroll = 0;\n            let rowscroll = 0;\n            let scrollNum = event.deltaFactor < 40 ? 1 : event.deltaFactor < 80 ? 2 : 3;    //一次滚动三行或三列\n            //一次滚动三行或三列\n            if (event.deltaY != 0) {\n                let row_ed, step = Math.round(scrollNum / Store.zoomRatio);\n                step = step < 1 ? 1 : step;\n                if (event.deltaY < 0) {\n                    row_ed = row_st + step;\n                    if (row_ed >= visibledatarow_c.length) {\n                        row_ed = visibledatarow_c.length - 1;\n                    }\n                } else {\n                    row_ed = row_st - step;\n                    if (row_ed < 0) {\n                        row_ed = 0;\n                    }\n                }\n                rowscroll = row_ed == 0 ? 0 : visibledatarow_c[row_ed - 1];\n                if (Store.freezenhorizontaldata != null) {\n                    rowscroll -= Store.freezenhorizontaldata[0];\n                }\n                $('#luckysheet-scrollbar-y').scrollTop(rowscroll);\n            } else if (event.deltaX != 0) {\n                let col_ed;    // if((isMac && event.deltaX >0 ) || (!isMac && event.deltaX < 0)){\n                // if((isMac && event.deltaX >0 ) || (!isMac && event.deltaX < 0)){\n                if (event.deltaX > 0) {\n                    scrollLeft = scrollLeft + 20 * Store.zoomRatio;    // if(col_ed >= visibledatacolumn_c.length){\n                                                                       //     col_ed = visibledatacolumn_c.length - 1;\n                                                                       // }\n                } else\n                    // if(col_ed >= visibledatacolumn_c.length){\n                    //     col_ed = visibledatacolumn_c.length - 1;\n                    // }\n                    {\n                        scrollLeft = scrollLeft - 20 * Store.zoomRatio;    // if(col_ed < 0){\n                                                                           //     col_ed = 0;\n                                                                           // }\n                    }    // colscroll = col_ed == 0 ? 0 : visibledatacolumn_c[col_ed - 1];\n                // if(col_ed < 0){\n                //     col_ed = 0;\n                // }\n                // colscroll = col_ed == 0 ? 0 : visibledatacolumn_c[col_ed - 1];\n                $('#luckysheet-scrollbar-x').scrollLeft(scrollLeft);\n            }\n            mousewheelArrayUniqueTimeout = setTimeout(() => {\n                Store.visibledatacolumn_unique = null;\n                Store.visibledatarow_unique = null;\n            }, 500);\n        });\n        $('#luckysheet-scrollbar-x').scroll(function () {\n            // setTimeout(function(){\n            luckysheetscrollevent();    // },10); \n        }).mousewheel(function (event, delta) {\n            event.preventDefault();\n        });\n        $('#luckysheet-scrollbar-y').scroll(function () {\n            // setTimeout(function(){\n            luckysheetscrollevent();    // },10);\n        }).mousewheel(function (event, delta) {\n            event.preventDefault();\n        });    //页面resize\n        //页面resize\n        $(window).resize(function () {\n            let luckysheetDocument = document.getElementById(Store.container);\n            if (luckysheetDocument) {\n                luckysheetsizeauto();\n            }\n        });\n        $('#luckysheet-rich-text-editor').mouseup(function (e) {\n            menuButton.inputMenuButtonFocus(e.target);\n        });    //表格mousedown\n        //表格mousedown\n        $('#luckysheet-cell-main, #luckysheetTableContent').mousedown(function (event) {\n            if ($(event.target).hasClass('luckysheet-mousedown-cancel')) {\n                return;\n            }    // 协同编辑其他用户不在操作的时候，用户名框隐藏\n            // 协同编辑其他用户不在操作的时候，用户名框隐藏\n            hideUsername();\n            $('#luckysheet-cell-selected').find('.luckysheet-cs-fillhandle').css('cursor', 'default').end().find('.luckysheet-cs-draghandle').css('cursor', 'default');\n            $('#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0').css('cursor', 'default');    //有批注在编辑时\n            //有批注在编辑时\n            luckysheetPostil.removeActivePs();    //图片 active/cropping\n            //图片 active/cropping\n            if ($('#luckysheet-modal-dialog-activeImage').is(':visible') || $('#luckysheet-modal-dialog-cropping').is(':visible')) {\n                imageCtrl.cancelActiveImgItem();\n            }    //luckysheetautoadjustmousedown = 1;\n            //luckysheetautoadjustmousedown = 1;\n            let mouse = mouseposition(event.pageX, event.pageY);\n            if (mouse[0] >= Store.cellmainWidth - Store.cellMainSrollBarSize || mouse[1] >= Store.cellmainHeight - Store.cellMainSrollBarSize) {\n                return;\n            }\n            let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n            let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n            if (Store.freezenverticaldata != null && mouse[0] < Store.freezenverticaldata[0] - Store.freezenverticaldata[2]) {\n                x = mouse[0] + Store.freezenverticaldata[2];\n            }\n            if (Store.freezenhorizontaldata != null && mouse[1] < Store.freezenhorizontaldata[0] - Store.freezenhorizontaldata[2]) {\n                y = mouse[1] + Store.freezenhorizontaldata[2];\n            }\n            let sheetFile = sheetmanage.getSheetByIndex();\n            let luckysheetTableContent = $('#luckysheetTableContent').get(0).getContext('2d');\n            let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n            let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n            let row_index_ed = row_index, col_index_ed = col_index;\n            let margeset = cells.mergeborer(Store.flowdata, row_index, col_index);\n            if (!!margeset) {\n                row = margeset.row[1];\n                row_pre = margeset.row[0];\n                row_index = margeset.row[2];\n                row_index_ed = margeset.row[3];\n                col = margeset.column[1];\n                col_pre = margeset.column[0];\n                col_index = margeset.column[2];\n                col_index_ed = margeset.column[3];\n            }    //单元格单击之前\n            //单元格单击之前\n            if (!luckysheetConfigsetting.createHookFunction('cellMousedownBefore', Store.flowdata[row_index][col_index], {\n                    r: row_index,\n                    c: col_index,\n                    'start_r': row_pre,\n                    'start_c': col_pre,\n                    'end_r': row,\n                    'end_c': col\n                }, sheetFile, luckysheetTableContent)) {\n                return;\n            }    //数据验证 单元格聚焦\n            //数据验证 单元格聚焦\n            dataVerificationCtrl.cellFocus(row_index, col_index, true);    //若点击单元格部分不在视图内\n            //若点击单元格部分不在视图内\n            if (col_pre < $('#luckysheet-cell-main').scrollLeft()) {\n                $('#luckysheet-scrollbar-x').scrollLeft(col_pre);\n            }\n            if (row_pre < $('#luckysheet-cell-main').scrollTop()) {\n                $('#luckysheet-scrollbar-y').scrollTop(row_pre);\n            }    //mousedown是右键\n            //mousedown是右键\n            if (event.which == '3') {\n                $('#luckysheet-dataVerification-showHintBox').hide();\n                let isright = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    if (Store.luckysheet_select_save[s]['row'] != null && (row_index >= Store.luckysheet_select_save[s]['row'][0] && row_index <= Store.luckysheet_select_save[s]['row'][1] && col_index >= Store.luckysheet_select_save[s]['column'][0] && col_index <= Store.luckysheet_select_save[s]['column'][1])) {\n                        isright = true;\n                        break;\n                    }\n                }\n                if (isright) {\n                    return;\n                }\n            }    //单元格数据下钻\n            //单元格数据下钻\n            if (Store.flowdata[row_index] != null && Store.flowdata[row_index][col_index] != null && Store.flowdata[row_index][col_index].dd != null) {\n                if (luckysheetConfigsetting.fireMousedown != null && getObjType(luckysheetConfigsetting.fireMousedown) == 'function') {\n                    luckysheetConfigsetting.fireMousedown(Store.flowdata[row_index][col_index].dd);\n                    return;\n                }\n            }    //链接 单元格聚焦\n            //链接 单元格聚焦\n            if (hyperlinkCtrl.hyperlink && hyperlinkCtrl.hyperlink[row_index + '_' + col_index] && event.which != '3') {\n                hyperlinkCtrl.cellFocus(row_index, col_index);\n                return;\n            }\n            Store.luckysheet_scroll_status = true;    //公式相关\n            //公式相关\n            let $input = $('#luckysheet-input-box');\n            if (parseInt($input.css('top')) > 0) {\n                if (formula.rangestart || formula.rangedrag_column_start || formula.rangedrag_row_start || formula.israngeseleciton()) {\n                    //公式选区\n                    let rowseleted = [\n                        row_index,\n                        row_index_ed\n                    ];\n                    let columnseleted = [\n                        col_index,\n                        col_index_ed\n                    ];\n                    let left = col_pre;\n                    let width = col - col_pre - 1;\n                    let top = row_pre;\n                    let height = row - row_pre - 1;\n                    if (event.shiftKey) {\n                        let last = formula.func_selectedrange;\n                        let top = 0, height = 0, rowseleted = [];\n                        if (last.top > row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            if (last.row[1] > last.row_focus) {\n                                last.row[1] = last.row_focus;\n                            }\n                            rowseleted = [\n                                row_index,\n                                last.row[1]\n                            ];\n                        } else if (last.top == row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            rowseleted = [\n                                row_index,\n                                last.row[0]\n                            ];\n                        } else {\n                            top = last.top;\n                            height = row - last.top - 1;\n                            if (last.row[0] < last.row_focus) {\n                                last.row[0] = last.row_focus;\n                            }\n                            rowseleted = [\n                                last.row[0],\n                                row_index\n                            ];\n                        }\n                        let left = 0, width = 0, columnseleted = [];\n                        if (last.left > col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            if (last.column[1] > last.column_focus) {\n                                last.column[1] = last.column_focus;\n                            }\n                            columnseleted = [\n                                col_index,\n                                last.column[1]\n                            ];\n                        } else if (last.left == col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            columnseleted = [\n                                col_index,\n                                last.column[0]\n                            ];\n                        } else {\n                            left = last.left;\n                            width = col - last.left - 1;\n                            if (last.column[0] < last.column_focus) {\n                                last.column[0] = last.column_focus;\n                            }\n                            columnseleted = [\n                                last.column[0],\n                                col_index\n                            ];\n                        }\n                        let changeparam = cells.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                        if (changeparam != null) {\n                            columnseleted = changeparam[0];\n                            rowseleted = changeparam[1];\n                            top = changeparam[2];\n                            height = changeparam[3];\n                            left = changeparam[4];\n                            width = changeparam[5];\n                        }\n                        luckysheet_count_show(left, top, width, height, rowseleted, columnseleted);\n                        last['row'] = rowseleted;\n                        last['column'] = columnseleted;\n                        last['left_move'] = left;\n                        last['width_move'] = width;\n                        last['top_move'] = top;\n                        last['height_move'] = height;\n                        formula.func_selectedrange = last;\n                    } else if (event.ctrlKey && $('#luckysheet-rich-text-editor').find('span').last().text() != ',') {\n                        //按住ctrl 选择选区时  先处理上一个选区\n                        let vText = $('#luckysheet-rich-text-editor').text();\n                        if (vText.length > 0) {\n                            let lastWord = vText.substr(vText.length - 1, 1);\n                            if (lastWord != ',' && lastWord != '=' && lastWord != '(') {\n                                vText += ',';\n                            }\n                        }\n                        if (vText.length > 0 && vText.substr(0, 1) == '=') {\n                            vText = formula.functionHTMLGenerate(vText);\n                            if (window.getSelection) {\n                                // all browsers, except IE before version 9\n                                let currSelection = window.getSelection();\n                                formula.functionRangeIndex = [\n                                    $(currSelection.anchorNode).parent().index(),\n                                    currSelection.anchorOffset\n                                ];\n                            } else {\n                                // Internet Explorer before version 9\n                                let textRange = document.selection.createRange();\n                                formula.functionRangeIndex = textRange;\n                            }\n                            $('#luckysheet-rich-text-editor').html(vText);\n                            formula.canceFunctionrangeSelected();\n                            formula.createRangeHightlight();\n                        }\n                        formula.rangestart = false;\n                        formula.rangedrag_column_start = false;\n                        formula.rangedrag_row_start = false;\n                        $('#luckysheet-functionbox-cell').html(vText);\n                        formula.rangeHightlightselected($('#luckysheet-rich-text-editor'));    //再进行 选区的选择\n                        //再进行 选区的选择\n                        formula.israngeseleciton();\n                        formula.func_selectedrange = {\n                            'left': left,\n                            'width': width,\n                            'top': top,\n                            'height': height,\n                            'left_move': left,\n                            'width_move': width,\n                            'top_move': top,\n                            'height_move': height,\n                            'row': rowseleted,\n                            'column': columnseleted,\n                            'row_focus': row_index,\n                            'column_focus': col_index\n                        };\n                    } else {\n                        formula.func_selectedrange = {\n                            'left': left,\n                            'width': width,\n                            'top': top,\n                            'height': height,\n                            'left_move': left,\n                            'width_move': width,\n                            'top_move': top,\n                            'height_move': height,\n                            'row': rowseleted,\n                            'column': columnseleted,\n                            'row_focus': row_index,\n                            'column_focus': col_index\n                        };\n                    }\n                    formula.rangeSetValue({\n                        'row': rowseleted,\n                        'column': columnseleted\n                    });\n                    formula.rangestart = true;\n                    formula.rangedrag_column_start = false;\n                    formula.rangedrag_row_start = false;\n                    $('#luckysheet-formula-functionrange-select').css({\n                        'left': left,\n                        'width': width,\n                        'top': top,\n                        'height': height\n                    }).show();\n                    $('#luckysheet-formula-help-c').hide();\n                    luckysheet_count_show(left, top, width, height, rowseleted, columnseleted);\n                    setTimeout(function () {\n                        let currSelection = window.getSelection();\n                        let anchorOffset = currSelection.anchorNode;\n                        let $editor;\n                        if ($('#luckysheet-search-formula-parm').is(':visible') || $('#luckysheet-search-formula-parm-select').is(':visible')) {\n                            $editor = $('#luckysheet-rich-text-editor');\n                            formula.rangechangeindex = formula.data_parm_index;\n                        } else {\n                            $editor = $(anchorOffset).closest('div');\n                        }\n                        let $span = $editor.find(\"span[rangeindex='\" + formula.rangechangeindex + \"']\");\n                        formula.setCaretPosition($span.get(0), 0, $span.html().length);\n                    }, 1);\n                    return;\n                } else {\n                    formula.updatecell(Store.luckysheetCellUpdate[0], Store.luckysheetCellUpdate[1]);\n                    Store.luckysheet_select_status = true;\n                    if ($('#luckysheet-info').is(':visible')) {\n                        Store.luckysheet_select_status = false;\n                    }\n                }\n            } else {\n                if (checkProtectionSelectLockedOrUnLockedCells(row_index, col_index, Store.currentSheetIndex)) {\n                    Store.luckysheet_select_status = true;\n                }\n            }    //条件格式 应用范围可选择多个单元格\n            //条件格式 应用范围可选择多个单元格\n            if ($('#luckysheet-multiRange-dialog').is(':visible')) {\n                conditionformat.selectStatus = true;\n                Store.luckysheet_select_status = false;\n                if (event.shiftKey) {\n                    let last = conditionformat.selectRange[conditionformat.selectRange.length - 1];\n                    let top = 0, height = 0, rowseleted = [];\n                    if (last.top > row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        if (last.row[1] > last.row_focus) {\n                            last.row[1] = last.row_focus;\n                        }\n                        rowseleted = [\n                            row_index,\n                            last.row[1]\n                        ];\n                    } else if (last.top == row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        rowseleted = [\n                            row_index,\n                            last.row[0]\n                        ];\n                    } else {\n                        top = last.top;\n                        height = row - last.top - 1;\n                        if (last.row[0] < last.row_focus) {\n                            last.row[0] = last.row_focus;\n                        }\n                        rowseleted = [\n                            last.row[0],\n                            row_index\n                        ];\n                    }\n                    let left = 0, width = 0, columnseleted = [];\n                    if (last.left > col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        if (last.column[1] > last.column_focus) {\n                            last.column[1] = last.column_focus;\n                        }\n                        columnseleted = [\n                            col_index,\n                            last.column[1]\n                        ];\n                    } else if (last.left == col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        columnseleted = [\n                            col_index,\n                            last.column[0]\n                        ];\n                    } else {\n                        left = last.left;\n                        width = col - last.left - 1;\n                        if (last.column[0] < last.column_focus) {\n                            last.column[0] = last.column_focus;\n                        }\n                        columnseleted = [\n                            last.column[0],\n                            col_index\n                        ];\n                    }\n                    let changeparam = cells.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                    if (changeparam != null) {\n                        columnseleted = changeparam[0];\n                        rowseleted = changeparam[1];\n                        top = changeparam[2];\n                        height = changeparam[3];\n                        left = changeparam[4];\n                        width = changeparam[5];\n                    }\n                    last['row'] = rowseleted;\n                    last['column'] = columnseleted;\n                    last['left_move'] = left;\n                    last['width_move'] = width;\n                    last['top_move'] = top;\n                    last['height_move'] = height;\n                    conditionformat.selectRange[conditionformat.selectRange.length - 1] = last;\n                } else if (event.ctrlKey) {\n                    conditionformat.selectRange.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            row_index,\n                            row_index_ed\n                        ],\n                        'column': [\n                            col_index,\n                            col_index_ed\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': col_index\n                    });\n                } else {\n                    conditionformat.selectRange = [];\n                    conditionformat.selectRange.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            row_index,\n                            row_index_ed\n                        ],\n                        'column': [\n                            col_index,\n                            col_index_ed\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': col_index\n                    });\n                }\n                selectionCopyShow(conditionformat.selectRange);\n                let range = conditionformat.getTxtByRange(conditionformat.selectRange);\n                $('#luckysheet-multiRange-dialog input').val(range);\n                return;\n            } else {\n                conditionformat.selectStatus = false;\n                conditionformat.selectRange = [];\n            }    //条件格式 条件值只能选择单个单元格\n            //条件格式 条件值只能选择单个单元格\n            if ($('#luckysheet-singleRange-dialog').is(':visible')) {\n                Store.luckysheet_select_status = false;\n                selectionCopyShow([{\n                        'row': [\n                            row_index,\n                            row_index\n                        ],\n                        'column': [\n                            col_index,\n                            col_index\n                        ]\n                    }]);\n                let range = getRangetxt(Store.currentSheetIndex, {\n                    'row': [\n                        row_index,\n                        row_index\n                    ],\n                    'column': [\n                        col_index,\n                        col_index\n                    ]\n                }, Store.currentSheetIndex);\n                $('#luckysheet-singleRange-dialog input').val(range);\n                return;\n            }    //数据验证 单元格范围选择\n            //数据验证 单元格范围选择\n            if ($('#luckysheet-dataVerificationRange-dialog').is(':visible')) {\n                dataVerificationCtrl.selectStatus = true;\n                Store.luckysheet_select_status = false;\n                if (event.shiftKey) {\n                    let last = dataVerificationCtrl.selectRange[dataVerificationCtrl.selectRange.length - 1];\n                    let top = 0, height = 0, rowseleted = [];\n                    if (last.top > row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        if (last.row[1] > last.row_focus) {\n                            last.row[1] = last.row_focus;\n                        }\n                        rowseleted = [\n                            row_index,\n                            last.row[1]\n                        ];\n                    } else if (last.top == row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        rowseleted = [\n                            row_index,\n                            last.row[0]\n                        ];\n                    } else {\n                        top = last.top;\n                        height = row - last.top - 1;\n                        if (last.row[0] < last.row_focus) {\n                            last.row[0] = last.row_focus;\n                        }\n                        rowseleted = [\n                            last.row[0],\n                            row_index\n                        ];\n                    }\n                    let left = 0, width = 0, columnseleted = [];\n                    if (last.left > col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        if (last.column[1] > last.column_focus) {\n                            last.column[1] = last.column_focus;\n                        }\n                        columnseleted = [\n                            col_index,\n                            last.column[1]\n                        ];\n                    } else if (last.left == col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        columnseleted = [\n                            col_index,\n                            last.column[0]\n                        ];\n                    } else {\n                        left = last.left;\n                        width = col - last.left - 1;\n                        if (last.column[0] < last.column_focus) {\n                            last.column[0] = last.column_focus;\n                        }\n                        columnseleted = [\n                            last.column[0],\n                            col_index\n                        ];\n                    }\n                    let changeparam = cells.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                    if (changeparam != null) {\n                        columnseleted = changeparam[0];\n                        rowseleted = changeparam[1];\n                        top = changeparam[2];\n                        height = changeparam[3];\n                        left = changeparam[4];\n                        width = changeparam[5];\n                    }\n                    last['row'] = rowseleted;\n                    last['column'] = columnseleted;\n                    last['left_move'] = left;\n                    last['width_move'] = width;\n                    last['top_move'] = top;\n                    last['height_move'] = height;\n                    dataVerificationCtrl.selectRange[dataVerificationCtrl.selectRange.length - 1] = last;\n                } else {\n                    dataVerificationCtrl.selectRange = [];\n                    dataVerificationCtrl.selectRange.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            row_index,\n                            row_index_ed\n                        ],\n                        'column': [\n                            col_index,\n                            col_index_ed\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': col_index\n                    });\n                }\n                selectionCopyShow(dataVerificationCtrl.selectRange);\n                let range = dataVerificationCtrl.getTxtByRange(dataVerificationCtrl.selectRange);\n                if (formula.rangetosheet != Store.currentSheetIndex) {\n                    range = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].name + '!' + range;\n                }\n                $('#luckysheet-dataVerificationRange-dialog input').val(range);\n                return;\n            } else {\n                dataVerificationCtrl.selectStatus = false;\n                dataVerificationCtrl.selectRange = [];\n            }    //if公式生成器\n            //if公式生成器\n            if (ifFormulaGenerator.singleRangeFocus) {\n                $('#luckysheet-ifFormulaGenerator-dialog .singRange').click();\n            }\n            if ($('#luckysheet-ifFormulaGenerator-singleRange-dialog').is(':visible')) {\n                //选择单个单元格\n                Store.luckysheet_select_status = false;\n                formula.rangestart = false;\n                $('#luckysheet-formula-functionrange-select').css({\n                    'left': col_pre,\n                    'width': col - col_pre - 1,\n                    'top': row_pre,\n                    'height': row - row_pre - 1\n                }).show();\n                $('#luckysheet-formula-help-c').hide();\n                let range = getRangetxt(Store.currentSheetIndex, {\n                    'row': [\n                        row_index,\n                        row_index\n                    ],\n                    'column': [\n                        col_index,\n                        col_index\n                    ]\n                }, Store.currentSheetIndex);\n                $('#luckysheet-ifFormulaGenerator-singleRange-dialog input').val(range);\n                return;\n            }\n            if ($('#luckysheet-ifFormulaGenerator-multiRange-dialog').is(':visible')) {\n                //选择范围\n                Store.luckysheet_select_status = false;\n                formula.func_selectedrange = {\n                    'left': col_pre,\n                    'width': col - col_pre - 1,\n                    'top': row_pre,\n                    'height': row - row_pre - 1,\n                    'left_move': col_pre,\n                    'width_move': col - col_pre - 1,\n                    'top_move': row_pre,\n                    'height_move': row - row_pre - 1,\n                    'row': [\n                        row_index,\n                        row_index\n                    ],\n                    'column': [\n                        col_index,\n                        col_index\n                    ],\n                    'row_focus': row_index,\n                    'column_focus': col_index\n                };\n                formula.rangestart = true;\n                $('#luckysheet-formula-functionrange-select').css({\n                    'left': col_pre,\n                    'width': col - col_pre - 1,\n                    'top': row_pre,\n                    'height': row - row_pre - 1\n                }).show();\n                $('#luckysheet-formula-help-c').hide();\n                let range = getRangetxt(Store.currentSheetIndex, {\n                    'row': [\n                        row_index,\n                        row_index\n                    ],\n                    'column': [\n                        col_index,\n                        col_index\n                    ]\n                }, Store.currentSheetIndex);\n                $('#luckysheet-ifFormulaGenerator-multiRange-dialog input').val(range);\n                $('#luckysheet-row-count-show').hide();\n                $('#luckysheet-column-count-show').hide();\n                return;\n            }\n            if (Store.luckysheet_select_status) {\n                if (event.shiftKey) {\n                    //按住shift点击，选择范围\n                    let last = $.extend(true, {}, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]);    //选区最后一个\n                    //选区最后一个\n                    let top = 0, height = 0, rowseleted = [];\n                    if (last.top > row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        if (last.row[1] > last.row_focus) {\n                            last.row[1] = last.row_focus;\n                        }\n                        rowseleted = [\n                            row_index,\n                            last.row[1]\n                        ];\n                    } else if (last.top == row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        rowseleted = [\n                            row_index,\n                            last.row[0]\n                        ];\n                    } else {\n                        top = last.top;\n                        height = row - last.top - 1;\n                        if (last.row[0] < last.row_focus) {\n                            last.row[0] = last.row_focus;\n                        }\n                        rowseleted = [\n                            last.row[0],\n                            row_index\n                        ];\n                    }\n                    let left = 0, width = 0, columnseleted = [];\n                    if (last.left > col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        if (last.column[1] > last.column_focus) {\n                            last.column[1] = last.column_focus;\n                        }\n                        columnseleted = [\n                            col_index,\n                            last.column[1]\n                        ];\n                    } else if (last.left == col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        columnseleted = [\n                            col_index,\n                            last.column[0]\n                        ];\n                    } else {\n                        left = last.left;\n                        width = col - last.left - 1;\n                        if (last.column[0] < last.column_focus) {\n                            last.column[0] = last.column_focus;\n                        }\n                        columnseleted = [\n                            last.column[0],\n                            col_index\n                        ];\n                    }\n                    let changeparam = cells.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                    if (changeparam != null) {\n                        columnseleted = changeparam[0];\n                        rowseleted = changeparam[1];\n                        top = changeparam[2];\n                        height = changeparam[3];\n                        left = changeparam[4];\n                        width = changeparam[5];\n                    }\n                    last['row'] = rowseleted;\n                    last['column'] = columnseleted;\n                    last['left_move'] = left;\n                    last['width_move'] = width;\n                    last['top_move'] = top;\n                    last['height_move'] = height;\n                    Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1] = last;    //交替颜色选择范围\n                    //交替颜色选择范围\n                    if ($('#luckysheet-alternateformat-rangeDialog').is(':visible')) {\n                        $('#luckysheet-alternateformat-rangeDialog input').val(getRangetxt(Store.currentSheetIndex, Store.luckysheet_select_save));\n                    }\n                    if (pivotTable.luckysheet_pivotTable_select_state) {\n                        $('#luckysheet-pivotTable-range-selection-input').val(Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].name + '!' + chatatABC(Store.luckysheet_select_save[0]['column'][0]) + (Store.luckysheet_select_save[0]['row'][0] + 1) + ':' + chatatABC(Store.luckysheet_select_save[0]['column'][1]) + (Store.luckysheet_select_save[0]['row'][1] + 1));\n                    }\n                } else if (event.ctrlKey) {\n                    //选区添加\n                    Store.luckysheet_select_save.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            row_index,\n                            row_index_ed\n                        ],\n                        'column': [\n                            col_index,\n                            col_index_ed\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': col_index\n                    });\n                } else {\n                    Store.luckysheet_select_save.length = 0;\n                    Store.luckysheet_select_save.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            row_index,\n                            row_index_ed\n                        ],\n                        'column': [\n                            col_index,\n                            col_index_ed\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': col_index\n                    });    //单元格格式icon对应\n                    //单元格格式icon对应\n                    menuButton.menuButtonFocus(Store.flowdata, row_index, col_index);    //函数公式显示栏\n                    //函数公式显示栏\n                    formula.fucntionboxshow(row_index, col_index);\n                }\n                selectHightlightShow();\n                if (Store.freezenhorizontaldata != null || Store.freezenverticaldata != null) {\n                    luckysheetFreezen.scrollAdaptOfselect();\n                }\n                if (!browser.mobilecheck()) {\n                    //非移动端聚焦输入框\n                    luckysheetactiveCell();\n                }    //允许编辑后的后台更新时\n                //允许编辑后的后台更新时\n                Store.saveParam('mv', Store.currentSheetIndex, Store.luckysheet_select_save);\n            }    //交替颜色\n            //交替颜色\n            if (alternateformat.rangefocus) {\n                alternateformat.rangefocus = false;\n                $('#luckysheet-alternateformat-range .fa-table').click();\n            }\n            $('#luckysheet-row-count-show, #luckysheet-column-count-show').hide();\n            if (!isEditMode()) {\n                //chartMix 隐藏当前页的数据选择区域高亮\n                hideAllNeedRangeShow();\n            }    // selectHelpboxFill();\n                 //数据透视表\n            // selectHelpboxFill();\n            //数据透视表\n            pivotTable.pivotclick(row_index, col_index, Store.currentSheetIndex);\n            luckysheetContainerFocus();\n            luckysheetConfigsetting.createHookFunction('cellMousedown', Store.flowdata[row_index][col_index], {\n                r: row_index,\n                c: col_index,\n                'start_r': row_pre,\n                'start_c': col_pre,\n                'end_r': row,\n                'end_c': col\n            }, sheetFile, luckysheetTableContent);    //$(\"#luckysheet-cols-h-c .luckysheet-cols-h-cells-c .luckysheet-cols-h-cells-clip .luckysheet-cols-h-cell-sel\").removeClass(\"luckysheet-cols-h-cell-sel\").addClass(\"luckysheet-cols-h-cell-nosel\");\n                                                      //$(\"#luckysheet-rows-h .luckysheet-rows-h-cells .luckysheet-rows-h-cells-c .luckysheet-rows-h-cells-clip .luckysheet-rows-h-cell-sel\").removeClass(\"luckysheet-rows-h-cell-sel\").addClass(\"luckysheet-rows-h-cell-nosel\");\n                                                      //$(\"#luckysheet-cols-h-c .luckysheet-cols-h-cells-c .luckysheet-cols-h-cells-clip .luckysheet-cols-h-cell-nosel\").eq(col_index).removeClass(\"luckysheet-cols-h-cell-nosel\").addClass(\"luckysheet-cols-h-cell-sel\");\n                                                      //$(\"#luckysheet-rows-h .luckysheet-rows-h-cells .luckysheet-rows-h-cells-c .luckysheet-rows-h-cells-clip .luckysheet-rows-h-cell-nosel\").eq(row_index).removeClass(\"luckysheet-rows-h-cell-nosel\").addClass(\"luckysheet-rows-h-cell-sel\");\n                                                      //event.stopImmediatePropagation();\n        }).mouseup(function (event) {\n            if (event.which == '3') {\n                //禁止前台编辑(只可 框选单元格、滚动查看表格)\n                if (!Store.allowEdit) {\n                    return;\n                }\n                if (isEditMode()) {\n                    //非编辑模式下禁止右键功能框\n                    return;\n                }\n                let x = event.pageX;\n                let y = event.pageY;\n                let data = Store.flowdata;\n                let obj_s = Store.luckysheet_select_save[0];\n                const cellRightClickConfig = luckysheetConfigsetting.cellRightClickConfig;\n                $('#luckysheet-cols-rows-data').show();\n                $('#luckysheet-cols-rows-handleincell').show();\n                $('#luckysheet-cols-rows-add, #luckysheet-cols-rows-shift').hide();\n                $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'block';\n                $$('#luckysheet-cols-rows-handleincell .luckysheet-menuseparator').style.display = 'block';\n                if (obj_s['row'] != null && obj_s['row'][0] == 0 && obj_s['row'][1] == Store.flowdata.length - 1) {\n                    // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste && !cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth && !cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                        return;\n                    }\n                    Store.luckysheetRightHeadClickIs = 'column';\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word').text(locale().rightclick.column);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size').text(locale().rightclick.width);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left').text(locale().rightclick.left);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right').text(locale().rightclick.right);\n                    $('#luckysheet-cols-rows-add').show();    // $(\"#luckysheet-cols-rows-data\").show();\n                    // $(\"#luckysheet-cols-rows-data\").show();\n                    $('#luckysheet-cols-rows-shift').hide();\n                    $('#luckysheet-cols-rows-handleincell').hide();\n                    Store.luckysheet_cols_menu_status = true;\n                    $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'block';    // 自定义右键菜单：向左向右增加列，删除列，隐藏显示列，设置列宽\n                    // 自定义右键菜单：向左向右增加列，删除列，隐藏显示列，设置列宽\n                    $$('#luckysheet-top-left-add-selected').style.display = cellRightClickConfig.insertColumn ? 'block' : 'none';\n                    $$('#luckysheet-bottom-right-add-selected').style.display = cellRightClickConfig.insertColumn ? 'block' : 'none';\n                    $$('#luckysheet-del-selected').style.display = cellRightClickConfig.deleteColumn ? 'block' : 'none';\n                    $$('#luckysheet-hide-selected').style.display = cellRightClickConfig.hideColumn ? 'block' : 'none';\n                    $$('#luckysheet-show-selected').style.display = cellRightClickConfig.hideColumn ? 'block' : 'none';\n                    $$('#luckysheet-column-row-width-selected').style.display = cellRightClickConfig.columnWidth ? 'block' : 'none';    // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste) {\n                        $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                        if (!cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth) {\n                            $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                        }\n                    }    // 2.当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                    // 2.当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                    if (!cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth) {\n                        $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                    }    //列宽默认值\n                    //列宽默认值\n                    let cfg = $.extend(true, {}, Store.config);\n                    if (cfg['columnlen'] == null) {\n                        cfg['columnlen'] = {};\n                    }\n                    let first_collen = cfg['columnlen'][Store.luckysheet_select_save[0].column[0]] == null ? Store.defaultcollen : cfg['columnlen'][Store.luckysheet_select_save[0].column[0]];\n                    let isSame = true;\n                    for (let i = 0; i < Store.luckysheet_select_save.length; i++) {\n                        let s = Store.luckysheet_select_save[i];\n                        let c1 = s.column[0], c2 = s.column[1];\n                        for (let c = c1; c <= c2; c++) {\n                            let collen = cfg['columnlen'][c] == null ? Store.defaultcollen : cfg['columnlen'][c];\n                            if (collen != first_collen) {\n                                isSame = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (isSame) {\n                        $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val(first_collen);\n                    } else {\n                        $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val('');\n                    }\n                } else if (obj_s['column'] != null && obj_s['column'][0] == 0 && obj_s['column'][1] == Store.flowdata[0].length - 1) {\n                    // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste && !cellRightClickConfig.insertRow && !cellRightClickConfig.deleteRow && !cellRightClickConfig.hideRow && !cellRightClickConfig.rowHeight && !cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                        return;\n                    }\n                    Store.luckysheetRightHeadClickIs = 'row';\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word').text(locale().rightclick.row);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size').text(locale().rightclick.height);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left').text(locale().rightclick.top);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right').text(locale().rightclick.bottom);\n                    $('#luckysheet-cols-rows-add').show();    // $(\"#luckysheet-cols-rows-data\").show();\n                    // $(\"#luckysheet-cols-rows-data\").show();\n                    $('#luckysheet-cols-rows-shift').hide();\n                    $('#luckysheet-cols-rows-handleincell').hide();\n                    Store.luckysheet_cols_menu_status = true;\n                    $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'block';    // 自定义右键菜单：向上向下增加行，删除行，隐藏显示行，设置行高\n                    // 自定义右键菜单：向上向下增加行，删除行，隐藏显示行，设置行高\n                    $$('#luckysheet-top-left-add-selected').style.display = cellRightClickConfig.insertRow ? 'block' : 'none';\n                    $$('#luckysheet-bottom-right-add-selected').style.display = cellRightClickConfig.insertRow ? 'block' : 'none';\n                    $$('#luckysheet-del-selected').style.display = cellRightClickConfig.deleteRow ? 'block' : 'none';\n                    $$('#luckysheet-hide-selected').style.display = cellRightClickConfig.hideRow ? 'block' : 'none';\n                    $$('#luckysheet-show-selected').style.display = cellRightClickConfig.hideRow ? 'block' : 'none';\n                    $$('#luckysheet-column-row-width-selected').style.display = cellRightClickConfig.rowHeight ? 'block' : 'none';    // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste) {\n                        $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                        if (!cellRightClickConfig.insertRow && !cellRightClickConfig.deleteRow && !cellRightClickConfig.hideRow && !cellRightClickConfig.rowHeight) {\n                            $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                        }\n                    }    // 2. 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                    // 2. 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                    if (!cellRightClickConfig.insertRow && !cellRightClickConfig.deleteRow && !cellRightClickConfig.hideRow && !cellRightClickConfig.rowHeight) {\n                        $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                    }    //行高默认值\n                    //行高默认值\n                    let cfg = $.extend(true, {}, Store.config);\n                    if (cfg['rowlen'] == null) {\n                        cfg['rowlen'] = {};\n                    }\n                    let first_rowlen = cfg['rowlen'][Store.luckysheet_select_save[0].row[0]] == null ? Store.defaultrowlen : cfg['rowlen'][Store.luckysheet_select_save[0].row[0]];\n                    let isSame = true;\n                    for (let i = 0; i < Store.luckysheet_select_save.length; i++) {\n                        let s = Store.luckysheet_select_save[i];\n                        let r1 = s.row[0], r2 = s.row[1];\n                        for (let r = r1; r <= r2; r++) {\n                            let rowlen = cfg['rowlen'][r] == null ? Store.defaultrowlen : cfg['rowlen'][r];\n                            if (rowlen != first_rowlen) {\n                                isSame = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (isSame) {\n                        $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val(first_rowlen);\n                    } else {\n                        $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val('');\n                    }\n                } else {\n                    // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste && !cellRightClickConfig.insertRow && !cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteRow && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.deleteCell && !cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                        return;\n                    }    // 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    // 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste) {\n                        $$('#luckysheet-cols-rows-handleincell .luckysheet-menuseparator').style.display = 'none';\n                        if (!cellRightClickConfig.insertRow && !cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteRow && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.deleteCell) {\n                            $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                        }\n                    }\n                    if (!cellRightClickConfig.insertRow && !cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteRow && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.deleteCell) {\n                        $$('#luckysheet-cols-rows-handleincell .luckysheet-menuseparator').style.display = 'none';\n                    }\n                }    // 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                // 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                if (!cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                    $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                }\n                showrightclickmenu($('#luckysheet-rightclick-menu'), x, y);\n            }    // 备注：在mousedown中发送光标信息会漏处理部分(选区)范围\n            // 备注：在mousedown中发送光标信息会漏处理部分(选区)范围\n            Store.saveParam('mv', Store.currentSheetIndex, Store.luckysheet_select_save);\n        }).dblclick(function (event) {\n            if ($(event.target).hasClass('luckysheet-mousedown-cancel')) {\n                return;\n            }    //禁止前台编辑(只可 框选单元格、滚动查看表格)\n            //禁止前台编辑(只可 框选单元格、滚动查看表格)\n            if (!Store.allowEdit) {\n                return;\n            }\n            if (parseInt($('#luckysheet-input-box').css('top')) > 0) {\n                return;\n            }\n            let mouse = mouseposition(event.pageX, event.pageY);\n            if (mouse[0] >= Store.cellmainWidth - Store.cellMainSrollBarSize || mouse[1] >= Store.cellmainHeight - Store.cellMainSrollBarSize) {\n                return;\n            }\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft(), scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let x = mouse[0] + scrollLeft;\n            let y = mouse[1] + scrollTop;\n            if (Store.freezenverticaldata != null && mouse[0] < Store.freezenverticaldata[0] - Store.freezenverticaldata[2]) {\n                x = mouse[0] + Store.freezenverticaldata[2];\n            }\n            if (Store.freezenhorizontaldata != null && mouse[1] < Store.freezenhorizontaldata[0] - Store.freezenhorizontaldata[2]) {\n                y = mouse[1] + Store.freezenhorizontaldata[2];\n            }\n            let row_location = rowLocation(y), row_index = row_location[2];\n            let col_location = colLocation(x), col_index = col_location[2];\n            let margeset = cells.mergeborer(Store.flowdata, row_index, col_index);\n            if (!!margeset) {\n                row_index = margeset.row[2];\n                col_index = margeset.column[2];\n            }\n            if (pivotTable.isPivotRange(row_index, col_index)) {\n                //数据透视表没有 任何数据\n                if ((pivotTable.filter == null || pivotTable.filter.length == 0) && (pivotTable.row == null || pivotTable.row.length == 0) && (pivotTable.column == null || pivotTable.column.length == 0) && (pivotTable.values == null || pivotTable.values.length == 0)) {\n                    return;\n                }    //数据透视表没有 数值数据\n                //数据透视表没有 数值数据\n                if (pivotTable.values == null || pivotTable.values.length == 0) {\n                    return;\n                }    //点击位置不是 数值数据 所在区域\n                //点击位置不是 数值数据 所在区域\n                if (row_index == 0 || col_index == 0) {\n                    return;\n                }\n                if (pivotTable.column != null && pivotTable.column.length > 0) {\n                    if (pivotTable.values.length >= 2 && pivotTable.showType == 'column') {\n                        if (row_index <= pivotTable.column.length || col_index >= pivotTable.pivotDatas[0].length - pivotTable.values.length) {\n                            return;\n                        }\n                    } else {\n                        if (row_index <= pivotTable.column.length - 1 || col_index >= pivotTable.pivotDatas[0].length - 1) {\n                            return;\n                        }\n                    }\n                }\n                if (pivotTable.row != null && pivotTable.row.length > 0) {\n                    if (pivotTable.values.length >= 2 && pivotTable.showType == 'row') {\n                        if (col_index <= pivotTable.row.length || row_index >= pivotTable.pivotDatas.length - pivotTable.values.length) {\n                            return;\n                        }\n                    } else {\n                        if (col_index <= pivotTable.row.length - 1 || row_index >= pivotTable.pivotDatas.length - 1) {\n                            return;\n                        }\n                    }\n                }\n                sheetmanage.addNewSheet(event);\n                pivotTable.drillDown(row_index, col_index);\n                return;\n            }\n            if ($('#luckysheet-search-formula-parm').is(':visible') || $('#luckysheet-search-formula-parm-select').is(':visible')) {\n                //公式参数栏显示\n                $('#luckysheet-cell-selected').hide();\n            } else if ($('#luckysheet-conditionformat-dialog').is(':visible') || $('#luckysheet-administerRule-dialog').is(':visible') || $('#luckysheet-newConditionRule-dialog').is(':visible') || $('#luckysheet-editorConditionRule-dialog').is(':visible') || $('#luckysheet-singleRange-dialog').is(':visible') || $('#luckysheet-multiRange-dialog').is(':visible')) {\n                //条件格式\n                return;\n            } else if ($('#luckysheet-modal-dialog-slider-alternateformat').is(':visible') || $('#luckysheet-alternateformat-rangeDialog').is(':visible')) {\n                //交替颜色\n                return;\n            } else {\n                if (menuButton.luckysheetPaintModelOn) {\n                    menuButton.cancelPaintModel();\n                }    // 检查当前坐标和焦点坐标是否一致，如果不一致那么进行修正\n                // 检查当前坐标和焦点坐标是否一致，如果不一致那么进行修正\n                let column_focus = Store.luckysheet_select_save[0]['column_focus'];\n                let row_focus = Store.luckysheet_select_save[0]['row_focus'];\n                if (column_focus !== col_index || row_focus !== row_index) {\n                    row_index = row_focus;\n                    col_index = column_focus;\n                }\n                ;\n                luckysheetupdateCell(row_index, col_index, Store.flowdata);    /* 设置选区高亮 */\n                /* 设置选区高亮 */\n                selectHightlightShow();\n            }\n        });    //监听拖拽 \n        //监听拖拽 \n        document.getElementById('luckysheet-cell-main').addEventListener('drop', function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            let files = e.dataTransfer.files;    //拖拽插入图片\n            //拖拽插入图片\n            if (files.length == 1 && files[0].type.indexOf('image') > -1) {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects')) {\n                    return;\n                }\n                let render = new FileReader();\n                render.readAsDataURL(files[0]);\n                render.onload = function (event) {\n                    let src = event.target.result;\n                    imageCtrl.inserImg(src);\n                };\n            }\n            handleCellDragStopEvent(e);\n        }, false);\n        document.getElementById('luckysheet-cell-main').addEventListener('dragover', function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n        }, false);    /**\n     * 处理单元格上鼠标拖拽停止事件\n     * @param {DragEvent} event \n     */\n        /**\n     * 处理单元格上鼠标拖拽停止事件\n     * @param {DragEvent} event \n     */\n        function handleCellDragStopEvent(event) {\n            if (luckysheetConfigsetting && luckysheetConfigsetting.hook && luckysheetConfigsetting.hook.cellDragStop) {\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let margeset = cells.mergeborer(Store.flowdata, row_index, col_index);\n                if (!!margeset) {\n                    row = margeset.row[1];\n                    row_pre = margeset.row[0];\n                    row_index = margeset.row[2];\n                    col = margeset.column[1];\n                    col_pre = margeset.column[0];\n                    col_index = margeset.column[2];\n                }\n                let sheetFile = sheetmanage.getSheetByIndex();\n                let luckysheetTableContent = $('#luckysheetTableContent').get(0).getContext('2d');\n                luckysheetConfigsetting.createHookFunction('cellDragStop', Store.flowdata[row_index][col_index], {\n                    r: row_index,\n                    c: col_index,\n                    'start_r': row_pre,\n                    'start_c': col_pre,\n                    'end_r': row,\n                    'end_c': col\n                }, sheetFile, luckysheetTableContent, event);\n            }\n        }    //表格mousemove\n        //表格mousemove\n        $(document).on('mousemove.luckysheetEvent', function (event) {\n            luckysheetPostil.overshow(event);    //有批注显示\n            //有批注显示\n            hyperlinkCtrl.overshow(event);    //链接提示显示\n            //链接提示显示\n            window.cancelAnimationFrame(Store.jfautoscrollTimeout);\n            if (luckysheetConfigsetting && luckysheetConfigsetting.hook && luckysheetConfigsetting.hook.sheetMousemove) {\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let margeset = cells.mergeborer(Store.flowdata, row_index, col_index);\n                if (!!margeset) {\n                    row = margeset.row[1];\n                    row_pre = margeset.row[0];\n                    row_index = margeset.row[2];\n                    col = margeset.column[1];\n                    col_pre = margeset.column[0];\n                    col_index = margeset.column[2];\n                }    // if(Store.flowdata[row_index] && Store.flowdata[row_index][col_index]){\n                // if(Store.flowdata[row_index] && Store.flowdata[row_index][col_index]){\n                let sheetFile = sheetmanage.getSheetByIndex();\n                let moveState = {\n                    functionResizeStatus: formula.functionResizeStatus,\n                    horizontalmoveState: !!luckysheetFreezen.horizontalmovestate,\n                    verticalmoveState: !!luckysheetFreezen.verticalmovestate,\n                    pivotTableMoveState: !!pivotTable && pivotTable.movestate,\n                    sheetMoveStatus: Store.luckysheet_sheet_move_status,\n                    scrollStatus: !!Store.luckysheet_scroll_status,\n                    selectStatus: !!Store.luckysheet_select_status,\n                    rowsSelectedStatus: !!Store.luckysheet_rows_selected_status,\n                    colsSelectedStatus: !!Store.luckysheet_cols_selected_status,\n                    cellSelectedMove: !!Store.luckysheet_cell_selected_move,\n                    cellSelectedExtend: !!Store.luckysheet_cell_selected_extend,\n                    colsChangeSize: !!Store.luckysheet_cols_change_size,\n                    rowsChangeSize: !!Store.luckysheet_rows_change_size,\n                    chartMove: !!Store.chartparam.luckysheetCurrentChartMove,\n                    chartResize: !!Store.chartparam.luckysheetCurrentChartResize,\n                    rangeResize: !!formula.rangeResize,\n                    rangeMove: !!formula.rangeMove\n                };\n                let luckysheetTableContent = $('#luckysheetTableContent').get(0).getContext('2d');\n                if (Store.flowdata && Store.flowdata[row_index]) {\n                    luckysheetConfigsetting.createHookFunction('sheetMousemove', Store.flowdata[row_index][col_index], {\n                        r: row_index,\n                        c: col_index,\n                        'start_r': row_pre,\n                        'start_c': col_pre,\n                        'end_r': row,\n                        'end_c': col\n                    }, sheetFile, moveState, luckysheetTableContent);\n                }    // }\n            }\n            // }\n            if (formula.functionResizeStatus) {\n                let y = event.pageY;\n                let movepx = y - formula.functionResizeData.y;\n                let mpx = formula.functionResizeData.calculatebarHeight + movepx;\n                let winh = Math.round($(window).height() / 2);\n                if (mpx <= 28) {\n                    if (mpx <= 20) {\n                        return;\n                    }\n                    mpx = 28;\n                } else if (mpx >= winh) {\n                    if (mpx >= winh + 8) {\n                        return;\n                    }\n                    mpx = winh;\n                }\n                Store.calculatebarHeight = mpx;\n                $('#luckysheet-wa-calculate').css('height', Store.calculatebarHeight - 2);\n                $('#luckysheet-wa-calculate-size').css({\n                    'background': '#5e5e5e',\n                    'cursor': 'ns-resize'\n                });\n                clearTimeout(formula.functionResizeTimeout);\n                formula.functionResizeTimeout = setTimeout(function () {\n                    luckysheetsizeauto();\n                }, 15);\n            } else if (!!luckysheetFreezen.horizontalmovestate) {\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let x = mouse[0] + scrollLeft;\n                let y = mouse[1] + scrollTop;\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let top = mouse[1] + Store.columnHeaderHeight;\n                if (top < Store.columnHeaderHeight) {\n                    top = Store.columnHeaderHeight;\n                }\n                if (top > luckysheetFreezen.windowHeight - 4) {\n                    top = luckysheetFreezen.windowHeight - 4;\n                }\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-handle').css({ 'top': top });\n                if (top + scrollTop - Store.columnHeaderHeight >= row_pre + (row - row_pre) / 2) {\n                    top = row - 2 - scrollTop + Store.columnHeaderHeight;\n                    Store.freezenhorizontaldata = [\n                        row,\n                        row_index + 1,\n                        scrollTop,\n                        luckysheetFreezen.cutVolumn(Store.visibledatarow, row_index + 1),\n                        top\n                    ];\n                } else {\n                    top = row_pre - 2 - scrollTop + Store.columnHeaderHeight;\n                    Store.freezenhorizontaldata = [\n                        row_pre,\n                        row_index,\n                        scrollTop,\n                        luckysheetFreezen.cutVolumn(Store.visibledatarow, row_index),\n                        top\n                    ];\n                }\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-drop').css({ 'top': top });\n                luckysheetFreezen.saveFreezen(Store.freezenhorizontaldata, top, null, null);\n            } else if (!!luckysheetFreezen.verticalmovestate) {\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let x = mouse[0] + scrollLeft;\n                let y = mouse[1] + scrollTop;\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let left = mouse[0] + Store.rowHeaderWidth;\n                if (left < Store.rowHeaderWidth) {\n                    left = Store.rowHeaderWidth;\n                }\n                if (left > luckysheetFreezen.windowWidth - 4) {\n                    left = luckysheetFreezen.windowWidth - 4;\n                }\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-handle').css({ 'left': left });\n                if (left + scrollLeft - Store.rowHeaderWidth >= col_pre + (col - col_pre) / 2) {\n                    left = col - 2 - scrollLeft + Store.rowHeaderWidth;\n                    Store.freezenverticaldata = [\n                        col,\n                        col_index + 1,\n                        scrollLeft,\n                        luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_index + 1),\n                        left\n                    ];\n                } else {\n                    left = col_pre - 2 - scrollLeft + Store.rowHeaderWidth;\n                    Store.freezenverticaldata = [\n                        col_pre,\n                        col_index,\n                        scrollLeft,\n                        luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_index),\n                        left\n                    ];\n                }\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-drop').css({ 'left': left });\n                luckysheetFreezen.saveFreezen(null, null, Store.freezenverticaldata, left);\n                luckysheetsizeauto();    //调节选区时下部单元格溢出\n            } else //调节选区时下部单元格溢出\n            if (!!pivotTable && pivotTable.movestate) {\n                let x = event.pageX, y = event.pageY;\n                $('#luckysheet-modal-dialog-slider-pivot-move').css({\n                    'left': x - pivotTable.movesave.width / 2,\n                    'top': y - pivotTable.movesave.height\n                });\n            } else if (Store.luckysheet_sheet_move_status) {\n                let scrollLeft = $('#luckysheet-sheet-container-c').scrollLeft();\n                let x = event.pageX + scrollLeft;\n                if (Math.abs(event.pageX - Store.luckysheet_sheet_move_data.pageX) < 3) {\n                    return;\n                }\n                let winW = $('#luckysheet-sheet-container').width();\n                let left = x - Store.luckysheet_sheet_move_data.curleft - $('#luckysheet-sheet-container').offset().left;\n                Store.luckysheet_sheet_move_data.activeobject.css({ 'left': left });\n                let row_index = luckysheet_searcharray(Store.luckysheet_sheet_move_data.widthlist, left + Store.luckysheet_sheet_move_data.curleft);\n                Store.luckysheet_sheet_move_data.cursorobject.css({ 'cursor': 'move' });\n                if (left - scrollLeft <= 6) {\n                    $('#luckysheet-sheets-leftscroll').click();\n                }\n                if (left - scrollLeft >= winW - 40) {\n                    $('#luckysheet-sheets-rightscroll').click();\n                }\n                if (row_index != Store.luckysheet_sheet_move_data.curindex) {\n                    if (row_index == -1 && left > 0) {\n                        row_index = Store.luckysheet_sheet_move_data.widthlist.length - 1;\n                        $('#luckysheet-sheets-item-clone').insertAfter($('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').eq(row_index));\n                    } else if (row_index == -1 && left <= 0) {\n                        $('#luckysheet-sheets-item-clone').insertBefore($('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').eq(0));\n                    } else {\n                        $('#luckysheet-sheets-item-clone').insertAfter($('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').eq(row_index));\n                    }\n                    Store.luckysheet_sheet_move_data.widthlist = [];\n                    $('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').each(function (i) {\n                        if (i == 0) {\n                            Store.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth()));\n                        } else {\n                            Store.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth()) + Store.luckysheet_sheet_move_data.widthlist[i - 1]);\n                        }\n                    });\n                    Store.luckysheet_sheet_move_data.curindex = $('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').index($('#luckysheet-sheets-item-clone'));\n                }\n            } else if (Store.luckysheet_model_move_state) {\n                let scrollTop = $(document).scrollTop(), scrollLeft = $(document).scrollLeft();\n                let y = event.pageY + scrollTop, x = event.pageX + scrollLeft;\n                let winH = $(window).height(), winW = $(window).width();\n                let myh = Store.luckysheet_model_move_obj.height(), myw = Store.luckysheet_model_move_obj.width();\n                let top = y - Store.luckysheet_model_xy[1], left = x - Store.luckysheet_model_xy[0];\n                if (top < 0) {\n                    top = 0;\n                }\n                if (top + myh + 62 > winH) {\n                    top = winH - myh - 62;\n                }\n                if (left < 0) {\n                    left = 0;\n                }\n                if (left + myw + 86 > winW) {\n                    left = winW - myw - 86;\n                }\n                Store.luckysheet_model_move_obj.css({\n                    'top': top,\n                    'left': left\n                });\n                event.preventDefault();\n            } else if (!!Store.luckysheet_scroll_status || !!Store.luckysheet_select_status || !!Store.luckysheet_rows_selected_status || !!Store.luckysheet_cols_selected_status || !!Store.luckysheet_cell_selected_move || !!Store.luckysheet_cell_selected_extend || !!Store.luckysheet_cols_change_size || !!Store.luckysheet_rows_change_size || !!Store.chartparam.luckysheetCurrentChartMove || !!Store.chartparam.luckysheetCurrentChartResize || !!formula.rangeResize || !!formula.rangeMove) {\n                if (Store.luckysheet_select_status) {\n                    clearTimeout(Store.countfuncTimeout);\n                    Store.countfuncTimeout = setTimeout(function () {\n                        countfunc();\n                    }, 500);\n                }\n                function mouseRender() {\n                    if (Store.luckysheet_scroll_status && !Store.luckysheet_cols_change_size && !Store.luckysheet_rows_change_size) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let left = $('#luckysheet-scrollbar-x').scrollLeft(), top = $('#luckysheet-scrollbar-y').scrollTop();\n                        let x = mouse[0];\n                        let y = mouse[1];\n                        let winH = $('#luckysheet-cell-main').height() - 20 * Store.zoomRatio, winW = $('#luckysheet-cell-main').width() - 60 * Store.zoomRatio;\n                        if (y < 0 || y > winH) {\n                            let stop;\n                            if (y < 0) {\n                                stop = top + y / 2;\n                            } else {\n                                stop = top + (y - winH) / 2;\n                            }\n                            $('#luckysheet-scrollbar-y').scrollTop(stop);\n                        }\n                        if (x < 0 || x > winW) {\n                            let sleft;\n                            if (x < 0) {\n                                sleft = left + x / 2;\n                            } else {\n                                sleft = left + (x - winW) / 2;\n                            }\n                            $('#luckysheet-scrollbar-x').scrollLeft(sleft);\n                        }\n                    }\n                    if (Store.luckysheet_select_status) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        if (!checkProtectionSelectLockedOrUnLockedCells(row_index, col_index, Store.currentSheetIndex)) {\n                            // Store.luckysheet_select_status = false;\n                            return;\n                        }\n                        let last = $.extend(true, {}, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]);\n                        let top = 0, height = 0, rowseleted = [];\n                        if (last.top > row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            if (last.row[1] > last.row_focus) {\n                                last.row[1] = last.row_focus;\n                            }\n                            rowseleted = [\n                                row_index,\n                                last.row[1]\n                            ];\n                        } else if (last.top == row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            rowseleted = [\n                                row_index,\n                                last.row[0]\n                            ];\n                        } else {\n                            top = last.top;\n                            height = row - last.top - 1;\n                            if (last.row[0] < last.row_focus) {\n                                last.row[0] = last.row_focus;\n                            }\n                            rowseleted = [\n                                last.row[0],\n                                row_index\n                            ];\n                        }\n                        let left = 0, width = 0, columnseleted = [];\n                        if (last.left > col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            if (last.column[1] > last.column_focus) {\n                                last.column[1] = last.column_focus;\n                            }\n                            columnseleted = [\n                                col_index,\n                                last.column[1]\n                            ];\n                        } else if (last.left == col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            columnseleted = [\n                                col_index,\n                                last.column[0]\n                            ];\n                        } else {\n                            left = last.left;\n                            width = col - last.left - 1;\n                            if (last.column[0] < last.column_focus) {\n                                last.column[0] = last.column_focus;\n                            }\n                            columnseleted = [\n                                last.column[0],\n                                col_index\n                            ];\n                        }\n                        let changeparam = cells.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                        if (changeparam != null) {\n                            columnseleted = changeparam[0];\n                            rowseleted = changeparam[1];\n                            top = changeparam[2];\n                            height = changeparam[3];\n                            left = changeparam[4];\n                            width = changeparam[5];\n                        }\n                        last['row'] = rowseleted;\n                        last['column'] = columnseleted;\n                        last['left_move'] = left;\n                        last['width_move'] = width;\n                        last['top_move'] = top;\n                        last['height_move'] = height;\n                        Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1] = last;\n                        selectHightlightShow();\n                        luckysheetFreezen.scrollFreezen();    // selectHelpboxFill();\n                                                              //交替颜色选择范围\n                        // selectHelpboxFill();\n                        //交替颜色选择范围\n                        if ($('#luckysheet-alternateformat-rangeDialog').is(':visible')) {\n                            $('#luckysheet-alternateformat-rangeDialog input').val(getRangetxt(Store.currentSheetIndex, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]));\n                        }\n                        if (pivotTable.luckysheet_pivotTable_select_state) {\n                            $('#luckysheet-pivotTable-range-selection-input').val(Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].name + '!' + chatatABC(Store.luckysheet_select_save[0]['column'][0]) + (Store.luckysheet_select_save[0]['row'][0] + 1) + ':' + chatatABC(Store.luckysheet_select_save[0]['column'][1]) + (Store.luckysheet_select_save[0]['row'][1] + 1));\n                        }\n                    } else if (conditionformat.selectStatus) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        let last = conditionformat.selectRange[conditionformat.selectRange.length - 1];\n                        let top = 0, height = 0, rowseleted = [];\n                        if (last.top > row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            if (last.row[1] > last.row_focus) {\n                                last.row[1] = last.row_focus;\n                            }\n                            rowseleted = [\n                                row_index,\n                                last.row[1]\n                            ];\n                        } else if (last.top == row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            rowseleted = [\n                                row_index,\n                                last.row[0]\n                            ];\n                        } else {\n                            top = last.top;\n                            height = row - last.top - 1;\n                            if (last.row[0] < last.row_focus) {\n                                last.row[0] = last.row_focus;\n                            }\n                            rowseleted = [\n                                last.row[0],\n                                row_index\n                            ];\n                        }\n                        let left = 0, width = 0, columnseleted = [];\n                        if (last.left > col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            if (last.column[1] > last.column_focus) {\n                                last.column[1] = last.column_focus;\n                            }\n                            columnseleted = [\n                                col_index,\n                                last.column[1]\n                            ];\n                        } else if (last.left == col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            columnseleted = [\n                                col_index,\n                                last.column[0]\n                            ];\n                        } else {\n                            left = last.left;\n                            width = col - last.left - 1;\n                            if (last.column[0] < last.column_focus) {\n                                last.column[0] = last.column_focus;\n                            }\n                            columnseleted = [\n                                last.column[0],\n                                col_index\n                            ];\n                        }\n                        let changeparam = cells.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                        if (changeparam != null) {\n                            columnseleted = changeparam[0];\n                            rowseleted = changeparam[1];\n                            top = changeparam[2];\n                            height = changeparam[3];\n                            left = changeparam[4];\n                            width = changeparam[5];\n                        }\n                        last['row'] = rowseleted;\n                        last['column'] = columnseleted;\n                        last['left_move'] = left;\n                        last['width_move'] = width;\n                        last['top_move'] = top;\n                        last['height_move'] = height;\n                        conditionformat.selectRange[conditionformat.selectRange.length - 1] = last;\n                        selectionCopyShow(conditionformat.selectRange);\n                        let range = conditionformat.getTxtByRange(conditionformat.selectRange);\n                        $('#luckysheet-multiRange-dialog input').val(range);\n                    } else if (dataVerificationCtrl.selectStatus) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        let last = dataVerificationCtrl.selectRange[dataVerificationCtrl.selectRange.length - 1];\n                        let top = 0, height = 0, rowseleted = [];\n                        if (last.top > row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            if (last.row[1] > last.row_focus) {\n                                last.row[1] = last.row_focus;\n                            }\n                            rowseleted = [\n                                row_index,\n                                last.row[1]\n                            ];\n                        } else if (last.top == row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            rowseleted = [\n                                row_index,\n                                last.row[0]\n                            ];\n                        } else {\n                            top = last.top;\n                            height = row - last.top - 1;\n                            if (last.row[0] < last.row_focus) {\n                                last.row[0] = last.row_focus;\n                            }\n                            rowseleted = [\n                                last.row[0],\n                                row_index\n                            ];\n                        }\n                        let left = 0, width = 0, columnseleted = [];\n                        if (last.left > col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            if (last.column[1] > last.column_focus) {\n                                last.column[1] = last.column_focus;\n                            }\n                            columnseleted = [\n                                col_index,\n                                last.column[1]\n                            ];\n                        } else if (last.left == col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            columnseleted = [\n                                col_index,\n                                last.column[0]\n                            ];\n                        } else {\n                            left = last.left;\n                            width = col - last.left - 1;\n                            if (last.column[0] < last.column_focus) {\n                                last.column[0] = last.column_focus;\n                            }\n                            columnseleted = [\n                                last.column[0],\n                                col_index\n                            ];\n                        }\n                        let changeparam = cells.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                        if (changeparam != null) {\n                            columnseleted = changeparam[0];\n                            rowseleted = changeparam[1];\n                            top = changeparam[2];\n                            height = changeparam[3];\n                            left = changeparam[4];\n                            width = changeparam[5];\n                        }\n                        last['row'] = rowseleted;\n                        last['column'] = columnseleted;\n                        last['left_move'] = left;\n                        last['width_move'] = width;\n                        last['top_move'] = top;\n                        last['height_move'] = height;\n                        dataVerificationCtrl.selectRange[dataVerificationCtrl.selectRange.length - 1] = last;\n                        selectionCopyShow(dataVerificationCtrl.selectRange);\n                        let range = dataVerificationCtrl.getTxtByRange(dataVerificationCtrl.selectRange);\n                        if (formula.rangetosheet != Store.currentSheetIndex) {\n                            range = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].name + '!' + range;\n                        }\n                        $('#luckysheet-dataVerificationRange-dialog input').val(range);\n                    } else if (formula.rangestart) {\n                        formula.rangedrag(event);\n                    } else if (formula.rangedrag_row_start) {\n                        formula.rangedrag_row(event);\n                    } else if (formula.rangedrag_column_start) {\n                        formula.rangedrag_column(event);\n                    } else if (Store.luckysheet_rows_selected_status) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let y = mouse[1] + $('#luckysheet-rows-h').scrollTop();\n                        if (y < 0) {\n                            return false;\n                        }\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_index = Store.visibledatacolumn.length - 1, col = Store.visibledatacolumn[col_index], col_pre = 0;\n                        let last = $.extend(true, {}, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]);\n                        let top = 0, height = 0, rowseleted = [];\n                        if (last.top > row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            if (last.row[1] > last.row_focus) {\n                                last.row[1] = last.row_focus;\n                            }\n                            rowseleted = [\n                                row_index,\n                                last.row[1]\n                            ];\n                        } else if (last.top == row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            rowseleted = [\n                                row_index,\n                                last.row[0]\n                            ];\n                        } else {\n                            top = last.top;\n                            height = row - last.top - 1;\n                            if (last.row[0] < last.row_focus) {\n                                last.row[0] = last.row_focus;\n                            }\n                            rowseleted = [\n                                last.row[0],\n                                row_index\n                            ];\n                        }\n                        last['row'] = rowseleted;\n                        last['top_move'] = top;\n                        last['height_move'] = height;\n                        Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1] = last;\n                        selectHightlightShow();\n                        clearTimeout(Store.countfuncTimeout);\n                        Store.countfuncTimeout = setTimeout(function () {\n                            countfunc();\n                        }, 500);\n                    } else if (Store.luckysheet_cols_selected_status) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cols-h-c').scrollLeft();\n                        if (x < 0) {\n                            return false;\n                        }\n                        let row_index = Store.visibledatarow.length - 1, row = Store.visibledatarow[row_index], row_pre = 0;\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        let last = $.extend(true, {}, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]);\n                        let left = 0, width = 0, columnseleted = [];\n                        if (last.left > col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            if (last.column[1] > last.column_focus) {\n                                last.column[1] = last.column_focus;\n                            }\n                            columnseleted = [\n                                col_index,\n                                last.column[1]\n                            ];\n                        } else if (last.left == col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            columnseleted = [\n                                col_index,\n                                last.column[0]\n                            ];\n                        } else {\n                            left = last.left;\n                            width = col - last.left - 1;\n                            if (last.column[0] < last.column_focus) {\n                                last.column[0] = last.column_focus;\n                            }\n                            columnseleted = [\n                                last.column[0],\n                                col_index\n                            ];\n                        }\n                        last['column'] = columnseleted;\n                        last['left_move'] = left;\n                        last['width_move'] = width;\n                        Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1] = last;\n                        selectHightlightShow();\n                        clearTimeout(Store.countfuncTimeout);\n                        Store.countfuncTimeout = setTimeout(function () {\n                            countfunc();\n                        }, 500);\n                    } else if (Store.luckysheet_cell_selected_move) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                        let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                        let x = mouse[0] + scrollLeft;\n                        let y = mouse[1] + scrollTop;\n                        let winH = $(window).height() + scrollTop - Store.sheetBarHeight - Store.statisticBarHeight, winW = $(window).width() + scrollLeft;\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        let row_index_original = Store.luckysheet_cell_selected_move_index[0], col_index_original = Store.luckysheet_cell_selected_move_index[1];\n                        let row_s = Store.luckysheet_select_save[0]['row'][0] - row_index_original + row_index, row_e = Store.luckysheet_select_save[0]['row'][1] - row_index_original + row_index;\n                        let col_s = Store.luckysheet_select_save[0]['column'][0] - col_index_original + col_index, col_e = Store.luckysheet_select_save[0]['column'][1] - col_index_original + col_index;\n                        if (row_s < 0 || y < 0) {\n                            row_s = 0;\n                            row_e = Store.luckysheet_select_save[0]['row'][1] - Store.luckysheet_select_save[0]['row'][0];\n                        }\n                        if (col_s < 0 || x < 0) {\n                            col_s = 0;\n                            col_e = Store.luckysheet_select_save[0]['column'][1] - Store.luckysheet_select_save[0]['column'][0];\n                        }\n                        if (row_e >= Store.visibledatarow[Store.visibledatarow.length - 1] || y > winH) {\n                            row_s = Store.visibledatarow.length - 1 - Store.luckysheet_select_save[0]['row'][1] + Store.luckysheet_select_save[0]['row'][0];\n                            row_e = Store.visibledatarow.length - 1;\n                        }\n                        if (col_e >= Store.visibledatacolumn[Store.visibledatacolumn.length - 1] || x > winW) {\n                            col_s = Store.visibledatacolumn.length - 1 - Store.luckysheet_select_save[0]['column'][1] + Store.luckysheet_select_save[0]['column'][0];\n                            col_e = Store.visibledatacolumn.length - 1;\n                        }\n                        col_pre = col_s - 1 == -1 ? 0 : Store.visibledatacolumn[col_s - 1];\n                        col = Store.visibledatacolumn[col_e];\n                        row_pre = row_s - 1 == -1 ? 0 : Store.visibledatarow[row_s - 1];\n                        row = Store.visibledatarow[row_e];\n                        $('#luckysheet-cell-selected-move').css({\n                            'left': col_pre,\n                            'width': col - col_pre - 2,\n                            'top': row_pre,\n                            'height': row - row_pre - 2,\n                            'display': 'block'\n                        });\n                    } else if (Store.luckysheet_cell_selected_extend) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let scrollLeft = $('#luckysheet-cell-main').scrollLeft() - 5;\n                        let scrollTop = $('#luckysheet-cell-main').scrollTop() - 5;\n                        let x = mouse[0] + scrollLeft;\n                        let y = mouse[1] + scrollTop;\n                        let winH = $(window).height() + scrollTop - Store.sheetBarHeight - Store.statisticBarHeight, winW = $(window).width() + scrollLeft;\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        let row_index_original = Store.luckysheet_cell_selected_extend_index[0], col_index_original = Store.luckysheet_cell_selected_extend_index[1];\n                        let row_s = Store.luckysheet_select_save[0]['row'][0], row_e = Store.luckysheet_select_save[0]['row'][1];\n                        let col_s = Store.luckysheet_select_save[0]['column'][0], col_e = Store.luckysheet_select_save[0]['column'][1];\n                        if (row_s < 0 || y < 0) {\n                            row_s = 0;\n                            row_e = Store.luckysheet_select_save[0]['row'][1] - Store.luckysheet_select_save[0]['row'][0];\n                        }\n                        if (col_s < 0 || x < 0) {\n                            col_s = 0;\n                            col_e = Store.luckysheet_select_save[0]['column'][1] - Store.luckysheet_select_save[0]['column'][0];\n                        }\n                        if (row_e >= Store.visibledatarow[Store.visibledatarow.length - 1] || y > winH) {\n                            row_s = Store.visibledatarow.length - 1 - Store.luckysheet_select_save[0]['row'][1] + Store.luckysheet_select_save[0]['row'][0];\n                            row_e = Store.visibledatarow.length - 1;\n                        }\n                        if (col_e >= Store.visibledatacolumn[Store.visibledatacolumn.length - 1] || x > winW) {\n                            col_s = Store.visibledatacolumn.length - 1 - Store.luckysheet_select_save[0]['column'][1] + Store.luckysheet_select_save[0]['column'][0];\n                            col_e = Store.visibledatacolumn.length - 1;\n                        }\n                        let top = Store.luckysheet_select_save[0].top_move, height = Store.luckysheet_select_save[0].height_move;\n                        let left = Store.luckysheet_select_save[0].left_move, width = Store.luckysheet_select_save[0].width_move;\n                        if (Math.abs(row_index_original - row_index) > Math.abs(col_index_original - col_index)) {\n                            if (!(row_index >= row_s && row_index <= row_e)) {\n                                if (Store.luckysheet_select_save[0].top_move >= row_pre) {\n                                    top = row_pre;\n                                    height = Store.luckysheet_select_save[0].top_move + Store.luckysheet_select_save[0].height_move - row_pre;\n                                } else {\n                                    top = Store.luckysheet_select_save[0].top_move;\n                                    height = row - Store.luckysheet_select_save[0].top_move - 1;\n                                }\n                            }\n                        } else {\n                            if (!(col_index >= col_s && col_index <= col_e)) {\n                                if (Store.luckysheet_select_save[0].left_move >= col_pre) {\n                                    left = col_pre;\n                                    width = Store.luckysheet_select_save[0].left_move + Store.luckysheet_select_save[0].width_move - col_pre;\n                                } else {\n                                    left = Store.luckysheet_select_save[0].left_move;\n                                    width = col - Store.luckysheet_select_save[0].left_move - 1;\n                                }\n                            }\n                        }\n                        $('#luckysheet-cell-selected-extend').css({\n                            'left': left,\n                            'width': width,\n                            'top': top,\n                            'height': height,\n                            'display': 'block'\n                        });\n                    } else if (Store.luckysheet_cols_change_size) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let scrollLeft = $('#luckysheet-cols-h-c').scrollLeft();\n                        let x = mouse[0] + scrollLeft;\n                        let winW = $(window).width();\n                        let row_index = Store.visibledatarow.length - 1, row = Store.visibledatarow[row_index], row_pre = 0;\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        if (x + 3 - Store.luckysheet_cols_change_size_start[0] > 30 && x < winW + scrollLeft - 100) {\n                            $('#luckysheet-change-size-line').css({ 'left': x });\n                            $('#luckysheet-cols-change-size').css({ 'left': x - 2 });\n                        }\n                    } else if (Store.luckysheet_rows_change_size) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let scrollTop = $('#luckysheet-rows-h').scrollTop();\n                        let y = mouse[1] + scrollTop;\n                        let winH = $(window).height();\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        if (y + 3 - Store.luckysheet_rows_change_size_start[0] > 19 && y < winH + scrollTop - 200) {\n                            $('#luckysheet-change-size-line').css({ 'top': y });\n                            $('#luckysheet-rows-change-size').css({ 'top': y });\n                        }\n                    }    // chart move\n                    else // chart move\n                    if (!!Store.chartparam.luckysheetCurrentChartMove) {\n                        const mouse = mouseposition(event.pageX, event.pageY);\n                        const x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        const y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        const myh = Store.chartparam.luckysheetCurrentChartMoveObj.height(), myw = Store.chartparam.luckysheetCurrentChartMoveObj.width();\n                        let top = y - Store.chartparam.luckysheetCurrentChartMoveXy[1], left = x - Store.chartparam.luckysheetCurrentChartMoveXy[0];\n                        if (top < 0) {\n                            top = 0;\n                        }\n                        if (top + myh + 42 + 6 > Store.chartparam.luckysheetCurrentChartMoveWinH) {\n                            top = Store.chartparam.luckysheetCurrentChartMoveWinH - myh - 42 - 6;\n                        }\n                        if (left < 0) {\n                            left = 0;\n                        }\n                        if (left + myw + 22 + 36 > Store.chartparam.luckysheetCurrentChartMoveWinW) {\n                            left = Store.chartparam.luckysheetCurrentChartMoveWinW - myw - 22 - 36;\n                        }\n                        Store.chartparam.luckysheetCurrentChartMoveObj.css({\n                            'top': top,\n                            'left': left\n                        });\n                        if (Store.freezenhorizontaldata != null || Store.freezenverticaldata != null) {\n                            luckysheetFreezen.scrollAdapt();\n                            const toffset = Store.chartparam.luckysheetCurrentChartMoveObj.offset();\n                            const tpsition = Store.chartparam.luckysheetCurrentChartMoveObj.position();\n                            Store.chartparam.luckysheetCurrentChartMoveXy = [\n                                event.pageX - toffset.left,\n                                event.pageY - toffset.top,\n                                tpsition.left,\n                                tpsition.top,\n                                $('#luckysheet-scrollbar-x').scrollLeft(),\n                                $('#luckysheet-scrollbar-y').scrollTop()\n                            ];\n                        }\n                    }    // chart resize\n                    else // chart resize\n                    if (!!Store.chartparam.luckysheetCurrentChartResize) {\n                        const scrollTop = $('#luckysheet-cell-main').scrollTop(), scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                        const mouse = mouseposition(event.pageX, event.pageY);\n                        const x = mouse[0] + scrollLeft;\n                        const y = mouse[1] + scrollTop;\n                        if (x < 0 || y < 0) {\n                            return false;\n                        }\n                        const myh = Store.chartparam.luckysheetCurrentChartResizeObj.height(), myw = Store.chartparam.luckysheetCurrentChartResizeObj.width();\n                        const topchange = y - Store.chartparam.luckysheetCurrentChartResizeXy[1], leftchange = x - Store.chartparam.luckysheetCurrentChartResizeXy[0];\n                        let top = Store.chartparam.luckysheetCurrentChartResizeXy[5], height = Store.chartparam.luckysheetCurrentChartResizeXy[3], left = Store.chartparam.luckysheetCurrentChartResizeXy[4], width = Store.chartparam.luckysheetCurrentChartResizeXy[2];\n                        if (Store.chartparam.luckysheetCurrentChartResize == 'lm' || Store.chartparam.luckysheetCurrentChartResize == 'lt' || Store.chartparam.luckysheetCurrentChartResize == 'lb') {\n                            left = x;\n                            width = Store.chartparam.luckysheetCurrentChartResizeXy[2] - leftchange;\n                            if (left > Store.chartparam.luckysheetCurrentChartResizeXy[2] + Store.chartparam.luckysheetCurrentChartResizeXy[4] - 60) {\n                                left = Store.chartparam.luckysheetCurrentChartResizeXy[2] + Store.chartparam.luckysheetCurrentChartResizeXy[4] - 60;\n                                width = Store.chartparam.luckysheetCurrentChartResizeXy[2] - (Store.chartparam.luckysheetCurrentChartResizeXy[2] + Store.chartparam.luckysheetCurrentChartResizeXy[4] - 60 - Store.chartparam.luckysheetCurrentChartResizeXy[0]);\n                            } else if (left <= 0) {\n                                left = 0;\n                                width = Store.chartparam.luckysheetCurrentChartResizeXy[2] + Store.chartparam.luckysheetCurrentChartResizeXy[0];\n                            }\n                        }\n                        if (Store.chartparam.luckysheetCurrentChartResize == 'rm' || Store.chartparam.luckysheetCurrentChartResize == 'rt' || Store.chartparam.luckysheetCurrentChartResize == 'rb') {\n                            width = Store.chartparam.luckysheetCurrentChartResizeXy[2] + leftchange;\n                            if (width < 60) {\n                                width = 60;\n                            } else if (width >= Store.chartparam.luckysheetCurrentChartResizeWinW - Store.chartparam.luckysheetCurrentChartResizeXy[4] - 22 - 36) {\n                                width = Store.chartparam.luckysheetCurrentChartResizeWinW - Store.chartparam.luckysheetCurrentChartResizeXy[4] - 22 - 36;\n                            }\n                        }\n                        if (Store.chartparam.luckysheetCurrentChartResize == 'mt' || Store.chartparam.luckysheetCurrentChartResize == 'lt' || Store.chartparam.luckysheetCurrentChartResize == 'rt') {\n                            top = y;\n                            height = Store.chartparam.luckysheetCurrentChartResizeXy[3] - topchange;\n                            if (top > Store.chartparam.luckysheetCurrentChartResizeXy[3] + Store.chartparam.luckysheetCurrentChartResizeXy[5] - 60) {\n                                top = Store.chartparam.luckysheetCurrentChartResizeXy[3] + Store.chartparam.luckysheetCurrentChartResizeXy[5] - 60;\n                                height = Store.chartparam.luckysheetCurrentChartResizeXy[3] - (Store.chartparam.luckysheetCurrentChartResizeXy[3] + Store.chartparam.luckysheetCurrentChartResizeXy[5] - 60 - Store.chartparam.luckysheetCurrentChartResizeXy[1]);\n                            } else if (top <= 0) {\n                                top = 0;\n                                height = Store.chartparam.luckysheetCurrentChartResizeXy[3] + Store.chartparam.luckysheetCurrentChartResizeXy[1];\n                            }\n                        }\n                        if (Store.chartparam.luckysheetCurrentChartResize == 'mb' || Store.chartparam.luckysheetCurrentChartResize == 'lb' || Store.chartparam.luckysheetCurrentChartResize == 'rb') {\n                            height = Store.chartparam.luckysheetCurrentChartResizeXy[3] + topchange;\n                            if (height < 60) {\n                                height = 60;\n                            } else if (height >= Store.chartparam.luckysheetCurrentChartResizeWinH - Store.chartparam.luckysheetCurrentChartResizeXy[5] - 42 - 6) {\n                                height = Store.chartparam.luckysheetCurrentChartResizeWinH - Store.chartparam.luckysheetCurrentChartResizeXy[5] - 42 - 6;\n                            }\n                        }\n                        const resizedata = {\n                            'top': top,\n                            'left': left,\n                            'height': height,\n                            'width': width\n                        };\n                        Store.chartparam.luckysheetCurrentChartResizeObj.css(resizedata);    // resize chart\n                        // resize chart\n                        Store.resizeChart(Store.chartparam.luckysheetCurrentChart);\n                    }    //image move\n                    else //image move\n                    if (imageCtrl.move) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        let imgItem = imageCtrl.images[imageCtrl.currentImgId];\n                        if (imgItem.isFixedPos) {\n                            x = event.pageX;\n                            y = event.pageY;\n                        }\n                        let myh = $('#luckysheet-modal-dialog-activeImage').height(), myw = $('#luckysheet-modal-dialog-activeImage').width();\n                        let top = y - imageCtrl.moveXY[1], left = x - imageCtrl.moveXY[0];\n                        let minTop = 0, maxTop = imageCtrl.currentWinH - myh - 42 - 6, minLeft = 0, maxLeft = imageCtrl.currentWinW - myw - 22 - 36;\n                        if (imgItem.isFixedPos) {\n                            minTop = Store.infobarHeight + Store.toolbarHeight + Store.calculatebarHeight + Store.columnHeaderHeight;\n                            maxTop = minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - myh;\n                            minLeft = Store.rowHeaderWidth;\n                            maxLeft = minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - myw;\n                        }\n                        if (top < minTop) {\n                            top = minTop;\n                        }\n                        if (top > maxTop) {\n                            top = maxTop;\n                        }\n                        if (left < minLeft) {\n                            left = minLeft;\n                        }\n                        if (left > maxLeft) {\n                            left = maxLeft;\n                        }\n                        $('#luckysheet-modal-dialog-activeImage').css({\n                            'left': left,\n                            'top': top\n                        });\n                    }    //image resize\n                    else //image resize\n                    if (!!imageCtrl.resize) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                        let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                        let x = mouse[0] + scrollLeft;\n                        let y = mouse[1] + scrollTop;\n                        if (x < 0 || y < 0) {\n                            return false;\n                        }\n                        let resizeXY = imageCtrl.resizeXY;\n                        let topchange = y - resizeXY[1], leftchange = x - resizeXY[0];\n                        let top = resizeXY[5], height = resizeXY[3], left = resizeXY[4], width = resizeXY[2];\n                        let resize = imageCtrl.resize;\n                        let imgItem = imageCtrl.images[imageCtrl.currentImgId];\n                        if (imgItem.isFixedPos) {\n                            let minTop = Store.infobarHeight + Store.toolbarHeight + Store.calculatebarHeight + Store.columnHeaderHeight;\n                            let minLeft = Store.rowHeaderWidth;\n                            if (resize == 'lt') {\n                                //左上\n                                left = resizeXY[4] - resizeXY[6] + leftchange;\n                                if (left < minLeft) {\n                                    left = minLeft;\n                                }\n                                if (left > resizeXY[4] - resizeXY[6] + resizeXY[2] - 1) {\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - 1;\n                                }\n                                width = resizeXY[4] - resizeXY[6] + resizeXY[2] - left;\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[5] - resizeXY[7] + resizeXY[3] - height;\n                                if (top < minTop) {\n                                    top = minTop;\n                                    height = resizeXY[5] - resizeXY[7] + resizeXY[3] - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - width;\n                                }\n                                if (top > resizeXY[5] - resizeXY[7] + resizeXY[3] - 1) {\n                                    top = resizeXY[5] - resizeXY[7] + resizeXY[3] - 1;\n                                    height = resizeXY[5] - resizeXY[7] + resizeXY[3] - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - width;\n                                }\n                            } else if (resize == 'lm') {\n                                //左中\n                                left = resizeXY[4] - resizeXY[6] + leftchange;\n                                if (left < minLeft) {\n                                    left = minLeft;\n                                }\n                                if (left > resizeXY[4] - resizeXY[6] + resizeXY[2] - 1) {\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - 1;\n                                }\n                                width = resizeXY[4] - resizeXY[6] + resizeXY[2] - left;\n                                top = resizeXY[5] - resizeXY[7];\n                                height = resizeXY[3];\n                            } else if (resize == 'lb') {\n                                //左下\n                                left = resizeXY[4] - resizeXY[6] + leftchange;\n                                if (left < minLeft) {\n                                    left = minLeft;\n                                }\n                                if (left > resizeXY[4] - resizeXY[6] + resizeXY[2] - 1) {\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - 1;\n                                }\n                                width = resizeXY[4] - resizeXY[6] + resizeXY[2] - left;\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[5] - resizeXY[7];\n                                if (height < 1) {\n                                    height = 1;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - width;\n                                }\n                                if (height > minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top) {\n                                    height = minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - width;\n                                }\n                            } else if (resize == 'rt') {\n                                //右上\n                                left = resizeXY[4] - resizeXY[6];\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                }\n                                if (width > minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left) {\n                                    width = minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left;\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[5] - resizeXY[7] + resizeXY[3] - height;\n                                if (top < minTop) {\n                                    top = minTop;\n                                    height = resizeXY[5] - resizeXY[7] + resizeXY[3] - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                                if (top > resizeXY[5] - resizeXY[7] + resizeXY[3] - 1) {\n                                    top = resizeXY[5] - resizeXY[7] + resizeXY[3] - 1;\n                                    height = resizeXY[5] - resizeXY[7] + resizeXY[3] - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                            } else if (resize == 'rm') {\n                                //右中\n                                left = resizeXY[4] - resizeXY[6];\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                }\n                                if (width > minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left) {\n                                    width = minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left;\n                                }\n                                top = resizeXY[5] - resizeXY[7];\n                                height = resizeXY[3];\n                            } else if (resize == 'rb') {\n                                //右下\n                                left = resizeXY[4] - resizeXY[6];\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                }\n                                if (width > minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left) {\n                                    width = minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left;\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[5] - resizeXY[7];\n                                if (height < 1) {\n                                    height = 1;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                                if (height > minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top) {\n                                    height = minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                            } else if (resize == 'mt') {\n                                //中上\n                                left = resizeXY[4] - resizeXY[6];\n                                width = resizeXY[2];\n                                top = resizeXY[5] - resizeXY[7] + topchange;\n                                if (top < minTop) {\n                                    top = minTop;\n                                }\n                                if (top > resizeXY[5] - resizeXY[7] + resizeXY[3] - 1) {\n                                    top = resizeXY[5] - resizeXY[7] + resizeXY[3] - 1;\n                                }\n                                height = resizeXY[5] - resizeXY[7] + resizeXY[3] - top;\n                            } else if (resize == 'mb') {\n                                //中下\n                                left = resizeXY[4] - resizeXY[6];\n                                width = resizeXY[2];\n                                top = resizeXY[5] - resizeXY[7];\n                                height = resizeXY[3] + topchange;\n                                if (height < 1) {\n                                    height = 1;\n                                }\n                                if (height > minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top) {\n                                    height = minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top;\n                                }\n                            }\n                        } else {\n                            if (resize == 'lt') {\n                                //左上\n                                left = x;\n                                width = resizeXY[2] - leftchange;\n                                if (left > resizeXY[2] + resizeXY[4] - 1) {\n                                    left = resizeXY[2] + resizeXY[4] - 1;\n                                    width = resizeXY[2] + resizeXY[0] - (resizeXY[2] + resizeXY[4] - 1);\n                                } else if (left <= 0) {\n                                    left = 0;\n                                    width = resizeXY[2] + resizeXY[0];\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[3] + resizeXY[1] - height;\n                                if (top > resizeXY[3] + resizeXY[5] - 1) {\n                                    top = resizeXY[3] + resizeXY[5] - 1;\n                                    height = resizeXY[3] + resizeXY[1] - (resizeXY[3] + resizeXY[5] - 1);\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[2] + resizeXY[0] - width;\n                                } else if (top <= 0) {\n                                    top = 0;\n                                    height = resizeXY[3] + resizeXY[1];\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[2] + resizeXY[0] - width;\n                                }\n                            } else if (resize == 'lm') {\n                                //左中\n                                left = x;\n                                width = resizeXY[2] - leftchange;\n                                if (left > resizeXY[2] + resizeXY[4] - 1) {\n                                    left = resizeXY[2] + resizeXY[4] - 1;\n                                    width = resizeXY[2] + resizeXY[0] - (resizeXY[2] + resizeXY[4] - 1);\n                                } else if (left <= 0) {\n                                    left = 0;\n                                    width = resizeXY[2] + resizeXY[0];\n                                }\n                            } else if (resize == 'lb') {\n                                //左下\n                                left = x;\n                                width = resizeXY[2] - leftchange;\n                                if (left > resizeXY[2] + resizeXY[4] - 1) {\n                                    left = resizeXY[2] + resizeXY[4] - 1;\n                                    width = resizeXY[2] + resizeXY[0] - (resizeXY[2] + resizeXY[4] - 1);\n                                } else if (left <= 0) {\n                                    left = 0;\n                                    width = resizeXY[2] + resizeXY[0];\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                if (height < 1) {\n                                    height = 1;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[2] + resizeXY[0] - width;\n                                } else if (height >= imageCtrl.currentWinH - resizeXY[5] - 42 - 6) {\n                                    height = imageCtrl.currentWinH - resizeXY[5] - 42 - 6;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[2] + resizeXY[0] - width;\n                                }\n                            } else if (resize == 'rt') {\n                                //右上\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                } else if (width >= imageCtrl.currentWinW - resizeXY[4] - 22 - 36) {\n                                    width = imageCtrl.currentWinW - resizeXY[4] - 22 - 36;\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[3] + resizeXY[1] - height;\n                                if (top > resizeXY[3] + resizeXY[5] - 1) {\n                                    top = resizeXY[3] + resizeXY[5] - 1;\n                                    height = resizeXY[3] + resizeXY[1] - (resizeXY[3] + resizeXY[5] - 1);\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                } else if (top <= 0) {\n                                    top = 0;\n                                    height = resizeXY[3] + resizeXY[1];\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                            } else if (resize == 'rm') {\n                                //右中\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                } else if (width >= imageCtrl.currentWinW - resizeXY[4] - 22 - 36) {\n                                    width = imageCtrl.currentWinW - resizeXY[4] - 22 - 36;\n                                }\n                            } else if (resize == 'rb') {\n                                //右下\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                } else if (width >= imageCtrl.currentWinW - resizeXY[4] - 22 - 36) {\n                                    width = imageCtrl.currentWinW - resizeXY[4] - 22 - 36;\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                if (height < 1) {\n                                    height = 1;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                } else if (height >= imageCtrl.currentWinH - resizeXY[5] - 42 - 6) {\n                                    height = imageCtrl.currentWinH - resizeXY[5] - 42 - 6;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                            } else if (resize == 'mt') {\n                                //中上\n                                top = y;\n                                height = resizeXY[3] - topchange;\n                                if (top > resizeXY[3] + resizeXY[5] - 1) {\n                                    top = resizeXY[3] + resizeXY[5] - 1;\n                                    height = resizeXY[3] + resizeXY[1] - (resizeXY[3] + resizeXY[5] - 1);\n                                } else if (top <= 0) {\n                                    top = 0;\n                                    height = resizeXY[3] + resizeXY[1];\n                                }\n                            } else if (resize == 'mb') {\n                                //中下\n                                height = resizeXY[3] + topchange;\n                                if (height < 1) {\n                                    height = 1;\n                                } else if (height >= imageCtrl.currentWinH - resizeXY[5] - 42 - 6) {\n                                    height = imageCtrl.currentWinH - resizeXY[5] - 42 - 6;\n                                }\n                            }\n                        }\n                        $('#luckysheet-modal-dialog-activeImage').css({\n                            'width': width,\n                            'height': height,\n                            'left': left,\n                            'top': top\n                        });\n                        let scaleX = width / imgItem.crop.width;\n                        let scaleY = height / imgItem.crop.height;\n                        let defaultWidth = Math.round(imgItem.default.width * scaleX);\n                        let defaultHeight = Math.round(imgItem.default.height * scaleY);\n                        let offsetLeft = Math.round(imgItem.crop.offsetLeft * scaleX);\n                        let offsetTop = Math.round(imgItem.crop.offsetTop * scaleY);\n                        $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content').css({\n                            'background-size': defaultWidth + 'px ' + defaultHeight + 'px',\n                            'background-position': -offsetLeft + 'px ' + -offsetTop + 'px'\n                        });\n                    }    //image cropChange\n                    else //image cropChange\n                    if (!!imageCtrl.cropChange) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        if (x < 0 || y < 0) {\n                            return false;\n                        }\n                        let cropChangeXY = imageCtrl.cropChangeXY;\n                        let topchange = y - cropChangeXY[1], leftchange = x - cropChangeXY[0];\n                        let imgItem = imageCtrl.images[imageCtrl.currentImgId];\n                        let cropChange = imageCtrl.cropChange;\n                        let width, height, offsetLeft, offsetTop;\n                        if (cropChange == 'lt') {\n                            //左上\n                            offsetLeft = imgItem.crop.offsetLeft + leftchange;\n                            if (offsetLeft < 0) {\n                                offsetLeft = 0;\n                            }\n                            if (offsetLeft > imgItem.crop.width + imgItem.crop.offsetLeft - 1) {\n                                offsetLeft = imgItem.crop.width + imgItem.crop.offsetLeft - 1;\n                            }\n                            width = imgItem.crop.width + imgItem.crop.offsetLeft - offsetLeft;\n                            offsetTop = imgItem.crop.offsetTop + topchange;\n                            if (offsetTop < 0) {\n                                offsetTop = 0;\n                            }\n                            if (offsetTop > imgItem.crop.height + imgItem.crop.offsetTop - 1) {\n                                offsetTop = imgItem.crop.height + imgItem.crop.offsetTop - 1;\n                            }\n                            height = imgItem.crop.height + imgItem.crop.offsetTop - offsetTop;\n                        } else if (cropChange == 'lm') {\n                            //左中\n                            offsetLeft = imgItem.crop.offsetLeft + leftchange;\n                            if (offsetLeft < 0) {\n                                offsetLeft = 0;\n                            }\n                            if (offsetLeft > imgItem.crop.width + imgItem.crop.offsetLeft - 1) {\n                                offsetLeft = imgItem.crop.width + imgItem.crop.offsetLeft - 1;\n                            }\n                            width = imgItem.crop.width + imgItem.crop.offsetLeft - offsetLeft;\n                            offsetTop = imgItem.crop.offsetTop;\n                            height = imgItem.crop.height;\n                        } else if (cropChange == 'lb') {\n                            //左下\n                            offsetLeft = imgItem.crop.offsetLeft + leftchange;\n                            if (offsetLeft < 0) {\n                                offsetLeft = 0;\n                            }\n                            if (offsetLeft > imgItem.crop.width + imgItem.crop.offsetLeft - 1) {\n                                offsetLeft = imgItem.crop.width + imgItem.crop.offsetLeft - 1;\n                            }\n                            width = imgItem.crop.width + imgItem.crop.offsetLeft - offsetLeft;\n                            offsetTop = imgItem.crop.offsetTop;\n                            height = imgItem.crop.height + topchange;\n                            if (height < 1) {\n                                height = 1;\n                            }\n                            if (height > imgItem.default.height - offsetTop) {\n                                height = imgItem.default.height - offsetTop;\n                            }\n                        } else if (cropChange == 'rt') {\n                            //右上\n                            offsetLeft = imgItem.crop.offsetLeft;\n                            width = imgItem.crop.width + leftchange;\n                            if (width < 1) {\n                                width = 1;\n                            }\n                            if (width > imgItem.default.width - offsetLeft) {\n                                width = imgItem.default.width - offsetLeft;\n                            }\n                            offsetTop = imgItem.crop.offsetTop + topchange;\n                            if (offsetTop < 0) {\n                                offsetTop = 0;\n                            }\n                            if (offsetTop > imgItem.crop.height + imgItem.crop.offsetTop - 1) {\n                                offsetTop = imgItem.crop.height + imgItem.crop.offsetTop - 1;\n                            }\n                            height = imgItem.crop.height + imgItem.crop.offsetTop - offsetTop;\n                        } else if (cropChange == 'rm') {\n                            //右中\n                            offsetLeft = imgItem.crop.offsetLeft;\n                            width = imgItem.crop.width + leftchange;\n                            if (width < 1) {\n                                width = 1;\n                            }\n                            if (width > imgItem.default.width - offsetLeft) {\n                                width = imgItem.default.width - offsetLeft;\n                            }\n                            offsetTop = imgItem.crop.offsetTop;\n                            height = imgItem.crop.height;\n                        } else if (cropChange == 'rb') {\n                            //右下\n                            offsetLeft = imgItem.crop.offsetLeft;\n                            width = imgItem.crop.width + leftchange;\n                            if (width < 1) {\n                                width = 1;\n                            }\n                            if (width > imgItem.default.width - offsetLeft) {\n                                width = imgItem.default.width - offsetLeft;\n                            }\n                            offsetTop = imgItem.crop.offsetTop;\n                            height = imgItem.crop.height + topchange;\n                            if (height < 1) {\n                                height = 1;\n                            }\n                            if (height > imgItem.default.height - offsetTop) {\n                                height = imgItem.default.height - offsetTop;\n                            }\n                        } else if (cropChange == 'mt') {\n                            //中上\n                            offsetLeft = imgItem.crop.offsetLeft;\n                            width = imgItem.crop.width;\n                            offsetTop = imgItem.crop.offsetTop + topchange;\n                            if (offsetTop < 0) {\n                                offsetTop = 0;\n                            }\n                            if (offsetTop > imgItem.crop.height + imgItem.crop.offsetTop - 1) {\n                                offsetTop = imgItem.crop.height + imgItem.crop.offsetTop - 1;\n                            }\n                            height = imgItem.crop.height + imgItem.crop.offsetTop - offsetTop;\n                        } else if (cropChange == 'mb') {\n                            //中下\n                            offsetLeft = imgItem.crop.offsetLeft;\n                            width = imgItem.crop.width;\n                            offsetTop = imgItem.crop.offsetTop;\n                            height = imgItem.crop.height + topchange;\n                            if (height < 1) {\n                                height = 1;\n                            }\n                            if (height > imgItem.default.height - offsetTop) {\n                                height = imgItem.default.height - offsetTop;\n                            }\n                        }\n                        let left = imgItem.default.left + offsetLeft;\n                        let top = imgItem.default.top + offsetTop;\n                        if (imgItem.isFixedPos) {\n                            left = imgItem.fixedLeft + offsetLeft;\n                            top = imgItem.fixedTop + offsetTop;\n                        }\n                        $('#luckysheet-modal-dialog-cropping').show().css({\n                            'width': width,\n                            'height': height,\n                            'left': left,\n                            'top': top\n                        });\n                        $('#luckysheet-modal-dialog-cropping .cropping-mask').css({\n                            'width': imgItem.default.width,\n                            'height': imgItem.default.height,\n                            'background-image': 'url(' + imgItem.src + ')',\n                            'left': -offsetLeft,\n                            'top': -offsetTop\n                        });\n                        $('#luckysheet-modal-dialog-cropping .cropping-content').css({\n                            'background-image': 'url(' + imgItem.src + ')',\n                            'background-size': imgItem.default.width + 'px ' + imgItem.default.height + 'px',\n                            'background-position': -offsetLeft + 'px ' + -offsetTop + 'px'\n                        });\n                        imageCtrl.cropChangeObj = {\n                            width: width,\n                            height: height,\n                            offsetLeft: offsetLeft,\n                            offsetTop: offsetTop\n                        };\n                    } else if (luckysheetPostil.move) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        let myh = luckysheetPostil.currentObj.outerHeight(), myw = luckysheetPostil.currentObj.outerWidth();\n                        let top = y - luckysheetPostil.moveXY[1], left = x - luckysheetPostil.moveXY[0];\n                        if (top < 0) {\n                            top = 0;\n                        }\n                        if (top + myh + 42 + 6 > luckysheetPostil.currentWinH) {\n                            top = luckysheetPostil.currentWinH - myh - 42 - 6;\n                        }\n                        if (left < 0) {\n                            left = 0;\n                        }\n                        if (left + myw + 22 + 36 > luckysheetPostil.currentWinW) {\n                            left = luckysheetPostil.currentWinW - myw - 22 - 36;\n                        }\n                        luckysheetPostil.currentObj.css({\n                            'left': left,\n                            'top': top\n                        });\n                    } else if (!!luckysheetPostil.resize) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        if (x < 0 || y < 0) {\n                            return false;\n                        }\n                        let resizeXY = luckysheetPostil.resizeXY;\n                        let topchange = y - resizeXY[1], leftchange = x - resizeXY[0];\n                        let top = resizeXY[5], height = resizeXY[3], left = resizeXY[4], width = resizeXY[2];\n                        let resize = luckysheetPostil.resize;\n                        if (resize == 'lm' || resize == 'lt' || resize == 'lb') {\n                            left = x;\n                            width = resizeXY[2] - leftchange;\n                            if (left > resizeXY[2] + resizeXY[4] - 60) {\n                                left = resizeXY[2] + resizeXY[4] - 60;\n                                width = resizeXY[2] - (resizeXY[2] + resizeXY[4] - 60 - resizeXY[0]);\n                            } else if (left <= 0) {\n                                left = 0;\n                                width = resizeXY[2] + resizeXY[0];\n                            }\n                        }\n                        if (resize == 'rm' || resize == 'rt' || resize == 'rb') {\n                            width = resizeXY[2] + leftchange;\n                            if (width < 60) {\n                                width = 60;\n                            } else if (width >= luckysheetPostil.currentWinW - resizeXY[4] - 22 - 36) {\n                                width = luckysheetPostil.currentWinW - resizeXY[4] - 22 - 36;\n                            }\n                        }\n                        if (resize == 'mt' || resize == 'lt' || resize == 'rt') {\n                            top = y;\n                            height = resizeXY[3] - topchange;\n                            if (top > resizeXY[3] + resizeXY[5] - 60) {\n                                top = resizeXY[3] + resizeXY[5] - 60;\n                                height = resizeXY[3] - (resizeXY[3] + resizeXY[5] - 60 - resizeXY[1]);\n                            } else if (top <= 0) {\n                                top = 0;\n                                height = resizeXY[3] + resizeXY[1];\n                            }\n                        }\n                        if (resize == 'mb' || resize == 'lb' || resize == 'rb') {\n                            height = resizeXY[3] + topchange;\n                            if (height < 60) {\n                                height = 60;\n                            } else if (height >= luckysheetPostil.currentWinH - resizeXY[5] - 42 - 6) {\n                                height = luckysheetPostil.currentWinH - resizeXY[5] - 42 - 6;\n                            }\n                        }\n                        luckysheetPostil.currentObj.css({\n                            'width': width,\n                            'height': height,\n                            'left': left,\n                            'top': top\n                        });\n                    } else if (!!formula.rangeResize) {\n                        formula.rangeResizeDraging(event, formula.rangeResizeObj, formula.rangeResizexy, formula.rangeResize, formula.rangeResizeWinW, formula.rangeResizeWinH, Store.ch_width, Store.rh_height);\n                    } else if (!!formula.rangeMove) {\n                        formula.rangeMoveDraging(event, formula.rangeMovexy, formula.rangeMoveObj.data('range'), formula.rangeMoveObj, Store.sheetBarHeight, Store.statisticBarHeight);\n                    } else if (!!Store.chart_selection.rangeResize) {\n                        Store.chart_selection.rangeResizeDraging(event, Store.sheetBarHeight, Store.statisticBarHeight);\n                    } else if (!!Store.chart_selection.rangeMove) {\n                        Store.chart_selection.rangeMoveDraging(event, Store.sheetBarHeight, Store.statisticBarHeight);\n                    }\n                    Store.jfautoscrollTimeout = window.requestAnimationFrame(mouseRender);\n                }\n                Store.jfautoscrollTimeout = window.requestAnimationFrame(mouseRender);\n            }\n        });    //表格mouseup\n        //表格mouseup\n        $(document).on('mouseup.luckysheetEvent', function (event) {\n            if (luckysheetConfigsetting && luckysheetConfigsetting.hook && luckysheetConfigsetting.hook.sheetMouseup) {\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let margeset = cells.mergeborer(Store.flowdata, row_index, col_index);\n                if (!!margeset) {\n                    row = margeset.row[1];\n                    row_pre = margeset.row[0];\n                    row_index = margeset.row[2];\n                    col = margeset.column[1];\n                    col_pre = margeset.column[0];\n                    col_index = margeset.column[2];\n                }    // if(Store.flowdata[row_index] && Store.flowdata[row_index][col_index]){\n                // if(Store.flowdata[row_index] && Store.flowdata[row_index][col_index]){\n                let sheetFile = sheetmanage.getSheetByIndex();\n                let moveState = {\n                    functionResizeStatus: formula.functionResizeStatus,\n                    horizontalmoveState: !!luckysheetFreezen.horizontalmovestate,\n                    verticalmoveState: !!luckysheetFreezen.verticalmovestate,\n                    pivotTableMoveState: !!pivotTable && pivotTable.movestate,\n                    sheetMoveStatus: Store.luckysheet_sheet_move_status,\n                    scrollStatus: !!Store.luckysheet_scroll_status,\n                    selectStatus: !!Store.luckysheet_select_status,\n                    rowsSelectedStatus: !!Store.luckysheet_rows_selected_status,\n                    colsSelectedStatus: !!Store.luckysheet_cols_selected_status,\n                    cellSelectedMove: !!Store.luckysheet_cell_selected_move,\n                    cellSelectedExtend: !!Store.luckysheet_cell_selected_extend,\n                    colsChangeSize: !!Store.luckysheet_cols_change_size,\n                    rowsChangeSize: !!Store.luckysheet_rows_change_size,\n                    chartMove: !!Store.chartparam.luckysheetCurrentChartMove,\n                    chartResize: !!Store.chartparam.luckysheetCurrentChartResize,\n                    rangeResize: !!formula.rangeResize,\n                    rangeMove: !!formula.rangeMove\n                };\n                let luckysheetTableContent = $('#luckysheetTableContent').get(0).getContext('2d');\n                luckysheetConfigsetting.createHookFunction('sheetMouseup', Store.flowdata[row_index][col_index], {\n                    r: row_index,\n                    c: col_index,\n                    'start_r': row_pre,\n                    'start_c': col_pre,\n                    'end_r': row,\n                    'end_c': col\n                }, sheetFile, moveState, luckysheetTableContent);    // }\n            }    //数据窗格主体\n            // }\n            //数据窗格主体\n            if (Store.luckysheet_select_status) {\n                clearTimeout(Store.countfuncTimeout);\n                Store.countfuncTimeout = setTimeout(function () {\n                    countfunc();\n                }, 0);    //格式刷\n                //格式刷\n                if (menuButton.luckysheetPaintModelOn) {\n                    selection.pasteHandlerOfPaintModel(Store.luckysheet_copy_save);\n                    if (menuButton.luckysheetPaintSingle) {\n                        //单次 格式刷\n                        menuButton.cancelPaintModel();\n                    }\n                }\n            }\n            Store.luckysheet_select_status = false;\n            window.cancelAnimationFrame(Store.jfautoscrollTimeout);\n            Store.luckysheet_scroll_status = false;\n            $('#luckysheet-cell-selected').find('.luckysheet-cs-fillhandle').css('cursor', 'crosshair').end().find('.luckysheet-cs-draghandle').css('cursor', 'move');\n            $('#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0').css('cursor', 'default');    //行标题窗格主体\n            //行标题窗格主体\n            Store.luckysheet_rows_selected_status = false;    //列标题窗格主体\n            //列标题窗格主体\n            Store.luckysheet_cols_selected_status = false;\n            Store.luckysheet_model_move_state = false;\n            if (formula.functionResizeStatus) {\n                formula.functionResizeStatus = false;\n                $('#luckysheet-wa-calculate-size').removeAttr('style');\n            }\n            if (!!luckysheetFreezen.horizontalmovestate) {\n                luckysheetFreezen.horizontalmovestate = false;\n                $('#luckysheet-freezebar-horizontal').removeClass('luckysheet-freezebar-active');\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-handle').css('cursor', '-webkit-grab');\n                if (Store.freezenhorizontaldata[4] <= Store.columnHeaderHeight) {\n                    luckysheetFreezen.cancelFreezenHorizontal();\n                }\n                luckysheetFreezen.createAssistCanvas();\n                luckysheetrefreshgrid();\n            }\n            if (!!luckysheetFreezen.verticalmovestate) {\n                luckysheetFreezen.verticalmovestate = false;\n                $('#luckysheet-freezebar-vertical').removeClass('luckysheet-freezebar-active');\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-handle').css('cursor', '-webkit-grab');\n                if (Store.freezenverticaldata[4] <= Store.rowHeaderWidth) {\n                    luckysheetFreezen.cancelFreezenVertical();\n                }\n                luckysheetFreezen.createAssistCanvas();\n                luckysheetrefreshgrid();\n            }\n            if (!!pivotTable && pivotTable.movestate) {\n                $('#luckysheet-modal-dialog-slider-pivot-move').remove();\n                pivotTable.movestate = false;\n                $('#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').css('cursor', 'default');\n                if (pivotTable.movesave.containerid != 'luckysheet-modal-dialog-pivotTable-list') {\n                    let $cur = $(event.target).closest('.luckysheet-modal-dialog-slider-config-list');\n                    if ($cur.length == 0) {\n                        if (pivotTable.movesave.containerid == 'luckysheet-modal-dialog-config-value') {\n                            pivotTable.resetOrderby(pivotTable.movesave.obj);\n                        }\n                        pivotTable.movesave.obj.remove();\n                        pivotTable.showvaluecolrow();\n                        $('#luckysheet-modal-dialog-pivotTable-list').find('.luckysheet-modal-dialog-slider-list-item').each(function () {\n                            $(this).find('.luckysheet-slider-list-item-selected').find('i').remove();\n                        });\n                        $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                            let index = $(this).data('index');\n                            $('#luckysheet-modal-dialog-pivotTable-list').find('.luckysheet-modal-dialog-slider-list-item').each(function () {\n                                let $seleted = $(this).find('.luckysheet-slider-list-item-selected');\n                                if ($(this).data('index') == index && $seleted.find('i').length == 0) {\n                                    $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                                }\n                            });\n                        });\n                        pivotTable.refreshPivotTable();\n                    }\n                }\n            }\n            if (Store.luckysheet_sheet_move_status) {\n                Store.luckysheet_sheet_move_status = false;\n                Store.luckysheet_sheet_move_data.activeobject.insertBefore($('#luckysheet-sheets-item-clone'));\n                Store.luckysheet_sheet_move_data.activeobject.removeAttr('style');\n                $('#luckysheet-sheets-item-clone').remove();\n                Store.luckysheet_sheet_move_data.cursorobject.css({ 'cursor': 'pointer' });\n                Store.luckysheet_sheet_move_data = {};\n                sheetmanage.reOrderAllSheet();\n            }    // chart move debounce timer clear\n            // chart move debounce timer clear\n            clearTimeout(Store.chartparam.luckysheetCurrentChartMoveTimeout);    //图表拖动 chartMix\n            //图表拖动 chartMix\n            if (!!Store.chartparam.luckysheetCurrentChartMove) {\n                Store.chartparam.luckysheetCurrentChartMove = false;\n                if (Store.chartparam.luckysheetInsertChartTosheetChange) {\n                    //myTop, myLeft: 本次的chart框位置，scrollLeft,scrollTop: 上一次的滚动条位置\n                    var myTop = Store.chartparam.luckysheetCurrentChartMoveObj.css('top'), myLeft = Store.chartparam.luckysheetCurrentChartMoveObj.css('left'), scrollLeft = $('#luckysheet-cell-main').scrollLeft(), scrollTop = $('#luckysheet-cell-main').scrollTop();    //点击时候存储的信息，即上一次操作结束的图表信息，x,y: chart框位置，scrollLeft1,scrollTop1: 滚动条位置\n                    //点击时候存储的信息，即上一次操作结束的图表信息，x,y: chart框位置，scrollLeft1,scrollTop1: 滚动条位置\n                    var x = Store.chartparam.luckysheetCurrentChartMoveXy[2];\n                    var y = Store.chartparam.luckysheetCurrentChartMoveXy[3];\n                    var scrollLeft1 = Store.chartparam.luckysheetCurrentChartMoveXy[4];\n                    var scrollTop1 = Store.chartparam.luckysheetCurrentChartMoveXy[5];\n                    var chart_id = Store.chartparam.luckysheetCurrentChartMoveObj.find('.luckysheet-modal-dialog-content').attr('id');    //去除chartobj,改用chart_id代替即可定位到此图表\n                    //去除chartobj,改用chart_id代替即可定位到此图表\n                    Store.jfredo.push({\n                        'type': 'moveChart',\n                        'chart_id': chart_id,\n                        'sheetIndex': Store.currentSheetIndex,\n                        'myTop': myTop,\n                        'myLeft': myLeft,\n                        'scrollTop': scrollTop,\n                        'scrollLeft': scrollLeft,\n                        'x': x,\n                        'y': y,\n                        'scrollTop1': scrollTop1,\n                        'scrollLeft1': scrollLeft1\n                    });    // luckysheet.sheetmanage.saveChart({ \"chart_id\": chart_id, \"sheetIndex\": sheetIndex, \"top\": myTop, \"left\": myLeft });\n                           //存储滚动条位置//协同编辑时可能影响用户操作，可以考虑不存储滚动条位置,或者滚动条信息仅仅保存到后台，但是不分发到其他设备（google sheet没有存储滚动条位置）\n                           // Store.Store.saveParam(\"c\", sheetIndex, { \"left\":myLeft, \"top\":myTop,\"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft }, { \"op\":\"xy\", \"cid\": chart_id});\n                }\n            }    //图表改变大小 chartMix\n            // luckysheet.sheetmanage.saveChart({ \"chart_id\": chart_id, \"sheetIndex\": sheetIndex, \"top\": myTop, \"left\": myLeft });\n            //存储滚动条位置//协同编辑时可能影响用户操作，可以考虑不存储滚动条位置,或者滚动条信息仅仅保存到后台，但是不分发到其他设备（google sheet没有存储滚动条位置）\n            // Store.Store.saveParam(\"c\", sheetIndex, { \"left\":myLeft, \"top\":myTop,\"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft }, { \"op\":\"xy\", \"cid\": chart_id});\n            //图表改变大小 chartMix\n            if (!!Store.chartparam.luckysheetCurrentChartResize) {\n                Store.chartparam.luckysheetCurrentChartResize = null;\n                if (Store.chartparam.luckysheetInsertChartTosheetChange) {\n                    var myHeight = Store.chartparam.luckysheetCurrentChartResizeObj.height(), myWidth = Store.chartparam.luckysheetCurrentChartResizeObj.width(), scrollLeft = $('#luckysheet-cell-main').scrollLeft(), scrollTop = $('#luckysheet-cell-main').scrollTop();\n                    var myTop = Store.chartparam.luckysheetCurrentChartMoveObj.css('top'), myLeft = Store.chartparam.luckysheetCurrentChartMoveObj.css('left');\n                    var chart_id = Store.chartparam.luckysheetCurrentChartResizeObj.find('.luckysheet-modal-dialog-content').attr('id');\n                    var myWidth1 = Store.chartparam.luckysheetCurrentChartResizeXy[2];\n                    var myHeight1 = Store.chartparam.luckysheetCurrentChartResizeXy[3];\n                    var x = Store.chartparam.luckysheetCurrentChartResizeXy[4];    //增加上一次的位置x，y\n                    //增加上一次的位置x，y\n                    var y = Store.chartparam.luckysheetCurrentChartResizeXy[5];\n                    var scrollLeft1 = Store.chartparam.luckysheetCurrentChartResizeXy[6];\n                    var scrollTop1 = Store.chartparam.luckysheetCurrentChartResizeXy[7];\n                    Store.jfredo.push({\n                        'type': 'resizeChart',\n                        'chart_id': chart_id,\n                        'sheetIndex': Store.currentSheetIndex,\n                        'myTop': myTop,\n                        'myLeft': myLeft,\n                        'myHeight': myHeight,\n                        'myWidth': myWidth,\n                        'scrollTop': scrollTop,\n                        'scrollLeft': scrollLeft,\n                        'x': x,\n                        'y': y,\n                        'myWidth1': myWidth1,\n                        'myHeight1': myHeight1,\n                        'scrollTop1': scrollTop1,\n                        'scrollLeft1': scrollLeft1\n                    });    //加上滚动条的位置\n                           // luckysheet.sheetmanage.saveChart({ \"chart_id\": chart_id, \"sheetIndex\": sheetIndex, \"height\": myHeight, \"width\": myWidth, \"top\": myTop, \"left\": myLeft, \"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft });\n                           // Store.Store.saveParam(\"c\", sheetIndex, { \"width\":myWidth, \"height\":myHeight, \"top\": myTop, \"left\": myLeft, \"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft}, { \"op\":\"wh\", \"cid\": chart_id});\n                }\n            }\n            //加上滚动条的位置\n            // luckysheet.sheetmanage.saveChart({ \"chart_id\": chart_id, \"sheetIndex\": sheetIndex, \"height\": myHeight, \"width\": myWidth, \"top\": myTop, \"left\": myLeft, \"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft });\n            // Store.Store.saveParam(\"c\", sheetIndex, { \"width\":myWidth, \"height\":myHeight, \"top\": myTop, \"left\": myLeft, \"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft}, { \"op\":\"wh\", \"cid\": chart_id});\n            if (!!formula.rangeResize) {\n                formula.rangeResizeDragged(event, formula.rangeResizeObj, formula.rangeResize, formula.rangeResizexy, formula.rangeResizeWinW, formula.rangeResizeWinH);\n            }    //image move\n            //image move\n            if (imageCtrl.move) {\n                imageCtrl.moveImgItem();\n            }    //image resize\n            //image resize\n            if (imageCtrl.resize) {\n                imageCtrl.resizeImgItem();\n            }    //image cropChange\n            //image cropChange\n            if (imageCtrl.cropChange) {\n                imageCtrl.cropChangeImgItem();\n            }    //批注框 移动\n            //批注框 移动\n            if (luckysheetPostil.move) {\n                luckysheetPostil.move = false;\n                let ps_id = luckysheetPostil.currentObj.closest('.luckysheet-postil-show').attr('id');\n                let ps_r = ps_id.split('luckysheet-postil-show_')[1].split('_')[0];\n                let ps_c = ps_id.split('luckysheet-postil-show_')[1].split('_')[1];\n                let d = Store.deepCopyFlowData(Store.flowdata);\n                let rc = [];\n                d[ps_r][ps_c].ps.left = luckysheetPostil.currentObj.position().left;\n                d[ps_r][ps_c].ps.top = luckysheetPostil.currentObj.position().top;\n                d[ps_r][ps_c].ps.value = luckysheetPostil.currentObj.find('.formulaInputFocus').text();\n                rc.push(ps_r + '_' + ps_c);\n                luckysheetPostil.ref(d, rc);\n                $('#' + ps_id).remove();\n                if (d[ps_r][ps_c].ps.isshow) {\n                    luckysheetPostil.buildPs(ps_r, ps_c, d[ps_r][ps_c].ps);\n                    $('#' + ps_id).addClass('luckysheet-postil-show-active');\n                    $('#' + ps_id).find('.luckysheet-postil-dialog-resize').show();\n                } else {\n                    luckysheetPostil.editPs(ps_r, ps_c);\n                }\n            }    //批注框 改变大小\n            //批注框 改变大小\n            if (!!luckysheetPostil.resize) {\n                luckysheetPostil.resize = null;\n                let ps_id = luckysheetPostil.currentObj.closest('.luckysheet-postil-show').attr('id');\n                let ps_r = ps_id.split('luckysheet-postil-show_')[1].split('_')[0];\n                let ps_c = ps_id.split('luckysheet-postil-show_')[1].split('_')[1];\n                let d = Store.deepCopyFlowData(Store.flowdata);\n                let rc = [];\n                d[ps_r][ps_c].ps.left = luckysheetPostil.currentObj.position().left;\n                d[ps_r][ps_c].ps.top = luckysheetPostil.currentObj.position().top;\n                d[ps_r][ps_c].ps.width = luckysheetPostil.currentObj.outerWidth();\n                d[ps_r][ps_c].ps.height = luckysheetPostil.currentObj.outerHeight();\n                d[ps_r][ps_c].ps.value = luckysheetPostil.currentObj.find('.formulaInputFocus').text();\n                rc.push(ps_r + '_' + ps_c);\n                luckysheetPostil.ref(d, rc);\n                $('#' + ps_id).remove();\n                if (d[ps_r][ps_c].ps.isshow) {\n                    luckysheetPostil.buildPs(ps_r, ps_c, d[ps_r][ps_c].ps);\n                    $('#' + ps_id).addClass('luckysheet-postil-show-active');\n                    $('#' + ps_id).find('.luckysheet-postil-dialog-resize').show();\n                } else {\n                    luckysheetPostil.editPs(ps_r, ps_c);\n                }\n            }    //改变行高\n            //改变行高\n            if (Store.luckysheet_rows_change_size) {\n                Store.luckysheet_rows_change_size = false;\n                $('#luckysheet-change-size-line').hide();\n                $('#luckysheet-rows-change-size').css('opacity', 0);\n                $('#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas').css('cursor', 'default');\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let scrollTop = $('#luckysheet-rows-h').scrollTop();\n                let y = mouse[1] + scrollTop;\n                let winH = $(window).height();\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let size = y + 3 - Store.luckysheet_rows_change_size_start[0];\n                if (y + 3 - Store.luckysheet_rows_change_size_start[0] < 19) {\n                    size = 19;\n                }\n                if (y >= winH - 200 + scrollTop) {\n                    size = winH - 200 - Store.luckysheet_rows_change_size_start[0] + scrollTop;\n                }\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['rowlen'] == null) {\n                    cfg['rowlen'] = {};\n                }\n                if (cfg['customHeight'] == null) {\n                    cfg['customHeight'] = {};\n                }\n                cfg['customHeight'][Store.luckysheet_rows_change_size_start[1]] = 1;\n                const changeRowIndex = Store.luckysheet_rows_change_size_start[1];\n                let changeRowSelected = false;\n                if (Store['luckysheet_select_save'].length > 0) {\n                    Store['luckysheet_select_save'].filter(select => select.row_select).some(select => {\n                        if (changeRowIndex >= select.row[0] && changeRowIndex <= select.row[1]) {\n                            changeRowSelected = true;\n                        }\n                        return changeRowSelected;\n                    });\n                }\n                if (changeRowSelected) {\n                    Store['luckysheet_select_save'].filter(select => select.row_select).forEach(select => {\n                        for (let r = select.row[0]; r <= select.row[1]; r++) {\n                            cfg['rowlen'][r] = Math.ceil(size / Store.zoomRatio);\n                        }\n                    });\n                } else {\n                    cfg['rowlen'][Store.luckysheet_rows_change_size_start[1]] = Math.ceil(size / Store.zoomRatio);\n                }\n                let images = imageCtrl.moveChangeSize('row', Store.luckysheet_rows_change_size_start[1], size);\n                if (Store.clearjfundo) {\n                    Store.jfundo.length = 0;\n                    Store.jfredo.push({\n                        'type': 'resize',\n                        'ctrlType': 'resizeR',\n                        'sheetIndex': Store.currentSheetIndex,\n                        'config': $.extend(true, {}, Store.config),\n                        'curconfig': $.extend(true, {}, cfg),\n                        'images': $.extend(true, {}, imageCtrl.images),\n                        'curImages': $.extend(true, {}, images)\n                    });\n                }    //config\n                //config\n                Store.config = cfg;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                Store.saveParam('cg', Store.currentSheetIndex, cfg['rowlen'], { 'k': 'rowlen' });    //images\n                //images\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].images = images;\n                Store.saveParam('all', Store.currentSheetIndex, images, { 'k': 'images' });\n                imageCtrl.images = images;\n                imageCtrl.allImagesShow();\n                ///jfrefreshgrid_rhcw(Store.flowdata.length, null);\n                Store.refreshGrid_rhcw(Store.flowdata.length, null);\n            }    //改变列宽\n            //改变列宽\n            if (Store.luckysheet_cols_change_size) {\n                Store.luckysheet_cols_change_size = false;\n                $('#luckysheet-change-size-line').hide();\n                $('#luckysheet-cols-change-size').css('opacity', 0);\n                $('#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas').css('cursor', 'default');\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let scrollLeft = $('#luckysheet-cols-h-c').scrollLeft();\n                let x = mouse[0] + scrollLeft;\n                let winW = $(window).width();\n                let row_index = Store.visibledatarow.length - 1, row = Store.visibledatarow[row_index], row_pre = 0;\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let size = x + 3 - Store.luckysheet_cols_change_size_start[0];\n                let firstcolumnlen = Store.defaultcollen;\n                if (Store.config['columnlen'] != null && Store.config['columnlen'][Store.luckysheet_cols_change_size_start[1]] != null) {\n                    firstcolumnlen = Store.config['columnlen'][Store.luckysheet_cols_change_size_start[1]];\n                }\n                if (Math.abs(size - firstcolumnlen) < 3) {\n                    return;\n                }\n                if (x + 3 - Store.luckysheet_cols_change_size_start[0] < 30) {\n                    size = 30;\n                }\n                if (x >= winW - 100 + scrollLeft) {\n                    size = winW - 100 - Store.luckysheet_cols_change_size_start[0] + scrollLeft;\n                }\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['columnlen'] == null) {\n                    cfg['columnlen'] = {};\n                }\n                if (cfg['customWidth'] == null) {\n                    cfg['customWidth'] = {};\n                }\n                cfg['customWidth'][Store.luckysheet_cols_change_size_start[1]] = 1;\n                const changeColumnIndex = Store.luckysheet_cols_change_size_start[1];\n                let changeColumnSelected = false;\n                if (Store['luckysheet_select_save'].length > 0) {\n                    Store['luckysheet_select_save'].filter(select => select.column_select).some(select => {\n                        if (changeColumnIndex >= select.column[0] && changeColumnIndex <= select.column[1]) {\n                            changeColumnSelected = true;\n                        }\n                        return changeColumnSelected;\n                    });\n                }\n                if (changeColumnSelected) {\n                    Store['luckysheet_select_save'].filter(select => select.column_select).forEach(select => {\n                        for (let r = select.column[0]; r <= select.column[1]; r++) {\n                            cfg['columnlen'][r] = Math.ceil(size / Store.zoomRatio);\n                        }\n                    });\n                } else {\n                    cfg['columnlen'][Store.luckysheet_cols_change_size_start[1]] = Math.ceil(size / Store.zoomRatio);\n                }\n                let images = imageCtrl.moveChangeSize('column', Store.luckysheet_cols_change_size_start[1], size);\n                if (Store.clearjfundo) {\n                    Store.jfundo.length = 0;\n                    Store.jfredo.push({\n                        'type': 'resize',\n                        'ctrlType': 'resizeC',\n                        'sheetIndex': Store.currentSheetIndex,\n                        'config': $.extend(true, {}, Store.config),\n                        'curconfig': $.extend(true, {}, cfg),\n                        'images': $.extend(true, {}, imageCtrl.images),\n                        'curImages': $.extend(true, {}, images)\n                    });\n                }    //config\n                //config\n                Store.config = cfg;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                Store.saveParam('cg', Store.currentSheetIndex, cfg['columnlen'], { 'k': 'columnlen' });    //images\n                //images\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].images = images;\n                Store.saveParam('all', Store.currentSheetIndex, images, { 'k': 'images' });\n                imageCtrl.images = images;\n                imageCtrl.allImagesShow();\n                ///jfrefreshgrid_rhcw(null, Store.flowdata[0].length);\n                Store.refreshGrid_rhcw(null, Store.flowdata[0].length);\n                ///setTimeout(function () {\n                ///    luckysheetrefreshgrid();\n                ///}, 1);\n                Store.refresh();\n            }\n            if (formula.rangeMove) {\n                formula.rangeMoveDragged(formula.rangeMoveObj);\n            }    //改变选择框的位置并替换目标单元格\n            //改变选择框的位置并替换目标单元格\n            if (Store.luckysheet_cell_selected_move) {\n                $('#luckysheet-cell-selected-move').hide();\n                Store.luckysheet_cell_selected_move = false;\n                let mouse = mouseposition(event.pageX, event.pageY);\n                if (!checkProtectionLockedRangeList(Store.luckysheet_select_save, Store.currentSheetIndex)) {\n                    return;\n                }\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let x = mouse[0] + scrollLeft;\n                let y = mouse[1] + scrollTop;\n                let winH = $(window).height() + scrollTop - Store.sheetBarHeight - Store.statisticBarHeight, winW = $(window).width() + scrollLeft;\n                let row_index = rowLocation(y)[2];\n                let col_index = colLocation(x)[2];\n                let row_index_original = Store.luckysheet_cell_selected_move_index[0], col_index_original = Store.luckysheet_cell_selected_move_index[1];\n                if (row_index == row_index_original && col_index == col_index_original) {\n                    return;\n                }\n                let d = Store.deepCopyFlowData(Store.flowdata);\n                let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                let data = getdatabyselection(last);\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['merge'] == null) {\n                    cfg['merge'] = {};\n                }\n                if (cfg['rowlen'] == null) {\n                    cfg['rowlen'] = {};\n                }    //选区包含部分单元格\n                //选区包含部分单元格\n                if (hasPartMC(cfg, last['row'][0], last['row'][1], last['column'][0], last['column'][1])) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMerge);\n                    } else {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', locale_drag.noMerge);\n                    }\n                    return;\n                }\n                let row_s = last['row'][0] - row_index_original + row_index, row_e = last['row'][1] - row_index_original + row_index;\n                let col_s = last['column'][0] - col_index_original + col_index, col_e = last['column'][1] - col_index_original + col_index;\n                if (!checkProtectionLockedRangeList([{\n                            row: [\n                                row_s,\n                                row_e\n                            ],\n                            column: [\n                                col_s,\n                                col_e\n                            ]\n                        }], Store.currentSheetIndex)) {\n                    return;\n                }\n                if (row_s < 0 || y < 0) {\n                    row_s = 0;\n                    row_e = last['row'][1] - last['row'][0];\n                }\n                if (col_s < 0 || x < 0) {\n                    col_s = 0;\n                    col_e = last['column'][1] - last['column'][0];\n                }\n                if (row_e >= Store.visibledatarow[Store.visibledatarow.length - 1] || y > winH) {\n                    row_s = Store.visibledatarow.length - 1 - last['row'][1] + last['row'][0];\n                    row_e = Store.visibledatarow.length - 1;\n                }\n                if (col_e >= Store.visibledatacolumn[Store.visibledatacolumn.length - 1] || x > winW) {\n                    col_s = Store.visibledatacolumn.length - 1 - last['column'][1] + last['column'][0];\n                    col_e = Store.visibledatacolumn.length - 1;\n                }    //替换的位置包含部分单元格\n                //替换的位置包含部分单元格\n                if (hasPartMC(cfg, row_s, row_e, col_s, col_e)) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMerge);\n                    } else {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', locale_drag.noMerge);\n                    }\n                    return;\n                }\n                let borderInfoCompute = getBorderInfoCompute(Store.currentSheetIndex);    //删除原本位置的数据\n                //删除原本位置的数据\n                let RowlChange = null;\n                for (let r = last['row'][0]; r <= last['row'][1]; r++) {\n                    if (r in cfg['rowlen']) {\n                        RowlChange = true;\n                    }\n                    for (let c = last['column'][0]; c <= last['column'][1]; c++) {\n                        let cell = d[r][c];\n                        if (getObjType(cell) == 'object' && 'mc' in cell) {\n                            if (cell['mc'].r + '_' + cell['mc'].c in cfg['merge']) {\n                                delete cfg['merge'][cell['mc'].r + '_' + cell['mc'].c];\n                            }\n                        }\n                        d[r][c] = null;\n                    }\n                }    //边框\n                //边框\n                if (cfg['borderInfo'] && cfg['borderInfo'].length > 0) {\n                    let borderInfo = [];\n                    for (let i = 0; i < cfg['borderInfo'].length; i++) {\n                        let bd_rangeType = cfg['borderInfo'][i].rangeType;\n                        if (bd_rangeType == 'range') {\n                            let bd_range = cfg['borderInfo'][i].range;\n                            let bd_emptyRange = [];\n                            for (let j = 0; j < bd_range.length; j++) {\n                                bd_emptyRange = bd_emptyRange.concat(conditionformat.CFSplitRange(bd_range[j], {\n                                    'row': last['row'],\n                                    'column': last['column']\n                                }, {\n                                    'row': [\n                                        row_s,\n                                        row_e\n                                    ],\n                                    'column': [\n                                        col_s,\n                                        col_e\n                                    ]\n                                }, 'restPart'));\n                            }\n                            cfg['borderInfo'][i].range = bd_emptyRange;\n                            borderInfo.push(cfg['borderInfo'][i]);\n                        } else if (bd_rangeType == 'cell') {\n                            let bd_r = cfg['borderInfo'][i].value.row_index;\n                            let bd_c = cfg['borderInfo'][i].value.col_index;\n                            if (!(bd_r >= last['row'][0] && bd_r <= last['row'][1] && bd_c >= last['column'][0] && bd_c <= last['column'][1])) {\n                                borderInfo.push(cfg['borderInfo'][i]);\n                            }\n                        }\n                    }\n                    cfg['borderInfo'] = borderInfo;\n                }    //替换位置数据更新\n                //替换位置数据更新\n                let offsetMC = {};\n                for (let r = 0; r < data.length; r++) {\n                    for (let c = 0; c < data[0].length; c++) {\n                        if (borderInfoCompute[r + last['row'][0] + '_' + (c + last['column'][0])]) {\n                            let bd_obj = {\n                                'rangeType': 'cell',\n                                'value': {\n                                    'row_index': r + row_s,\n                                    'col_index': c + col_s,\n                                    'l': borderInfoCompute[r + last['row'][0] + '_' + (c + last['column'][0])].l,\n                                    'r': borderInfoCompute[r + last['row'][0] + '_' + (c + last['column'][0])].r,\n                                    't': borderInfoCompute[r + last['row'][0] + '_' + (c + last['column'][0])].t,\n                                    'b': borderInfoCompute[r + last['row'][0] + '_' + (c + last['column'][0])].b\n                                }\n                            };\n                            if (cfg['borderInfo'] == null) {\n                                cfg['borderInfo'] = [];\n                            }\n                            cfg['borderInfo'].push(bd_obj);\n                        }\n                        let value = '';\n                        if (data[r] != null && data[r][c] != null) {\n                            value = data[r][c];\n                        }\n                        if (getObjType(value) == 'object' && 'mc' in value) {\n                            let mc = $.extend(true, {}, value['mc']);\n                            if ('rs' in value['mc']) {\n                                offsetMC[mc.r + '_' + mc.c] = [\n                                    r + row_s,\n                                    c + col_s\n                                ];\n                                value['mc'].r = r + row_s;\n                                value['mc'].c = c + col_s;\n                                cfg['merge'][r + row_s + '_' + (c + col_s)] = value['mc'];\n                            } else {\n                                value['mc'].r = offsetMC[mc.r + '_' + mc.c][0];\n                                value['mc'].c = offsetMC[mc.r + '_' + mc.c][1];\n                            }\n                        }\n                        d[r + row_s][c + col_s] = value;\n                    }\n                }\n                if (RowlChange) {\n                    cfg = rowlenByRange(d, last['row'][0], last['row'][1], cfg);\n                    cfg = rowlenByRange(d, row_s, row_e, cfg);\n                }    //条件格式\n                //条件格式\n                let cdformat = $.extend(true, [], Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_conditionformat_save']);\n                if (cdformat != null && cdformat.length > 0) {\n                    for (let i = 0; i < cdformat.length; i++) {\n                        let cdformat_cellrange = cdformat[i].cellrange;\n                        let emptyRange = [];\n                        for (let j = 0; j < cdformat_cellrange.length; j++) {\n                            let range = conditionformat.CFSplitRange(cdformat_cellrange[j], {\n                                'row': last['row'],\n                                'column': last['column']\n                            }, {\n                                'row': [\n                                    row_s,\n                                    row_e\n                                ],\n                                'column': [\n                                    col_s,\n                                    col_e\n                                ]\n                            }, 'allPart');\n                            emptyRange = emptyRange.concat(range);\n                        }\n                        cdformat[i].cellrange = emptyRange;\n                    }\n                }\n                let rf;\n                if (Store.luckysheet_select_save[0].row_focus == Store.luckysheet_select_save[0].row[0]) {\n                    rf = row_s;\n                } else {\n                    rf = row_e;\n                }\n                let cf;\n                if (Store.luckysheet_select_save[0].column_focus == Store.luckysheet_select_save[0].column[0]) {\n                    cf = col_s;\n                } else {\n                    cf = col_e;\n                }\n                let range = [];\n                range.push({\n                    'row': last['row'],\n                    'column': last['column']\n                });\n                range.push({\n                    'row': [\n                        row_s,\n                        row_e\n                    ],\n                    'column': [\n                        col_s,\n                        col_e\n                    ]\n                });\n                last['row'] = [\n                    row_s,\n                    row_e\n                ];\n                last['column'] = [\n                    col_s,\n                    col_e\n                ];\n                last['row_focus'] = rf;\n                last['column_focus'] = cf;\n                let allParam = {\n                    'cfg': cfg,\n                    'RowlChange': RowlChange,\n                    'cdformat': cdformat\n                };\n                ///jfrefreshgrid(d, range, allParam);\n                Store.refreshGrid(d,range,allParam);\n                selectHightlightShow();\n                $('#luckysheet-sheettable').css('cursor', 'default');\n                clearTimeout(Store.countfuncTimeout);\n                Store.countfuncTimeout = setTimeout(function () {\n                    countfunc();\n                }, 500);\n            }    //图表选区拖拽移动\n            //图表选区拖拽移动\n            if (Store.chart_selection.rangeMove) {\n                Store.chart_selection.rangeMoveDragged();\n            }    //图表选区拖拽拉伸\n            //图表选区拖拽拉伸\n            if (!!Store.chart_selection.rangeResize) {\n                Store.chart_selection.rangeResizeDragged();\n            }    //选区下拉\n            //选区下拉\n            if (Store.luckysheet_cell_selected_extend) {\n                Store.luckysheet_cell_selected_extend = false;\n                $('#luckysheet-cell-selected-extend').hide();\n                if (!checkProtectionLockedRangeList(Store.luckysheet_select_save, Store.currentSheetIndex)) {\n                    return;\n                }\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let x = mouse[0] + scrollLeft - 5;\n                let y = mouse[1] + scrollTop - 5;\n                let winH = $(window).height() + scrollTop - Store.sheetBarHeight - Store.statisticBarHeight, winW = $(window).width() + scrollLeft;\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let row_index_original = Store.luckysheet_cell_selected_extend_index[0], col_index_original = Store.luckysheet_cell_selected_extend_index[1];\n                let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                let row_s = last['row'][0], row_e = last['row'][1];\n                let col_s = last['column'][0], col_e = last['column'][1];\n                if (row_s < 0 || y < 0) {\n                    row_s = 0;\n                    row_e = last['row'][1] - last['row'][0];\n                }\n                if (col_s < 0 || x < 0) {\n                    col_s = 0;\n                    col_e = last['column'][1] - last['column'][0];\n                }\n                if (row_e >= Store.visibledatarow[Store.visibledatarow.length - 1] || y > winH) {\n                    row_s = Store.visibledatarow.length - 1 - last['row'][1] + last['row'][0];\n                    row_e = Store.visibledatarow.length - 1;\n                }\n                if (col_e >= Store.visibledatacolumn[Store.visibledatacolumn.length - 1] || x > winW) {\n                    col_s = Store.visibledatacolumn.length - 1 - last['column'][1] + last['column'][0];\n                    col_e = Store.visibledatacolumn.length - 1;\n                }    //复制范围\n                //复制范围\n                luckysheetDropCell.copyRange = {\n                    'row': $.extend(true, [], last['row']),\n                    'column': $.extend(true, [], last['column'])\n                };    //applyType\n                //applyType\n                let typeItemHide = luckysheetDropCell.typeItemHide();\n                if (!typeItemHide[0] && !typeItemHide[1] && !typeItemHide[2] && !typeItemHide[3] && !typeItemHide[4] && !typeItemHide[5] && !typeItemHide[6]) {\n                    luckysheetDropCell.applyType = '0';\n                } else {\n                    luckysheetDropCell.applyType = '1';\n                }\n                if (Math.abs(row_index_original - row_index) > Math.abs(col_index_original - col_index)) {\n                    if (!(row_index >= row_s && row_index <= row_e)) {\n                        if (Store.luckysheet_select_save[0].top_move >= row_pre) {\n                            //当往上拖拽时\n                            luckysheetDropCell.applyRange = {\n                                'row': [\n                                    row_index,\n                                    last['row'][0] - 1\n                                ],\n                                'column': last['column']\n                            };\n                            luckysheetDropCell.direction = 'up';\n                            row_s -= last['row'][0] - row_index;    //是否有数据透视表范围\n                            //是否有数据透视表范围\n                            if (pivotTable.isPivotRange(row_s, col_e)) {\n                                tooltip.info(locale_drag.affectPivot, '');\n                                return;\n                            }\n                        } else {\n                            //当往下拖拽时\n                            luckysheetDropCell.applyRange = {\n                                'row': [\n                                    last['row'][1] + 1,\n                                    row_index\n                                ],\n                                'column': last['column']\n                            };\n                            luckysheetDropCell.direction = 'down';\n                            row_e += row_index - last['row'][1];    //是否有数据透视表范围\n                            //是否有数据透视表范围\n                            if (pivotTable.isPivotRange(row_e, col_e)) {\n                                tooltip.info(locale_drag.affectPivot, '');\n                                return;\n                            }\n                        }\n                    } else {\n                        return;\n                    }\n                } else {\n                    if (!(col_index >= col_s && col_index <= col_e)) {\n                        if (Store.luckysheet_select_save[0].left_move >= col_pre) {\n                            //当往左拖拽时\n                            luckysheetDropCell.applyRange = {\n                                'row': last['row'],\n                                'column': [\n                                    col_index,\n                                    last['column'][0] - 1\n                                ]\n                            };\n                            luckysheetDropCell.direction = 'left';\n                            col_s -= last['column'][0] - col_index;    //是否有数据透视表范围\n                            //是否有数据透视表范围\n                            if (pivotTable.isPivotRange(row_e, col_s)) {\n                                tooltip.info(locale_drag.affectPivot, '');\n                                return;\n                            }\n                        } else {\n                            //当往右拖拽时\n                            luckysheetDropCell.applyRange = {\n                                'row': last['row'],\n                                'column': [\n                                    last['column'][1] + 1,\n                                    col_index\n                                ]\n                            };\n                            luckysheetDropCell.direction = 'right';\n                            col_e += col_index - last['column'][1];    //是否有数据透视表范围\n                            //是否有数据透视表范围\n                            if (pivotTable.isPivotRange(row_e, col_e)) {\n                                tooltip.info(locale_drag.affectPivot, '');\n                                return;\n                            }\n                        }\n                    } else {\n                        return;\n                    }\n                }\n                if (Store.config['merge'] != null) {\n                    let hasMc = false;\n                    for (let r = last['row'][0]; r <= last['row'][1]; r++) {\n                        for (let c = last['column'][0]; c <= last['column'][1]; c++) {\n                            let cell = Store.flowdata[r][c];\n                            if (cell != null && cell.mc != null) {\n                                hasMc = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (hasMc) {\n                        if (isEditMode()) {\n                            alert(locale_drag.noMerge);\n                        } else {\n                            tooltip.info(locale_drag.noMerge, '');\n                        }\n                        return;\n                    }\n                    for (let r = row_s; r <= row_e; r++) {\n                        for (let c = col_s; c <= col_e; c++) {\n                            let cell = Store.flowdata[r][c];\n                            if (cell != null && cell.mc != null) {\n                                hasMc = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (hasMc) {\n                        if (isEditMode()) {\n                            alert(locale_drag.noMerge);\n                        } else {\n                            tooltip.info(locale_drag.noMerge, '');\n                        }\n                        return;\n                    }\n                }\n                last['row'] = [\n                    row_s,\n                    row_e\n                ];\n                last['column'] = [\n                    col_s,\n                    col_e\n                ];\n                luckysheetDropCell.update();\n                luckysheetDropCell.createIcon();\n                $('#luckysheet-cell-selected-move').hide();\n                $('#luckysheet-sheettable').css('cursor', 'default');\n                clearTimeout(Store.countfuncTimeout);\n                Store.countfuncTimeout = setTimeout(function () {\n                    countfunc();\n                }, 500);\n            }\n        });    //禁止浏览器 右键默认菜单\n        //禁止浏览器 右键默认菜单\n        $('.luckysheet-grid-container, #luckysheet-rightclick-menu').on('contextmenu', function (e) {\n            e.preventDefault();\n        });    // //禁止前台编辑(只可 框选单元格、滚动查看表格)\n               // if(!Store.allowEdit){\n               //     return;\n               // }\n               //选区拖动替换\n        // //禁止前台编辑(只可 框选单元格、滚动查看表格)\n        // if(!Store.allowEdit){\n        //     return;\n        // }\n        //选区拖动替换\n        $('#luckysheet-cell-main div.luckysheet-cs-draghandle').mousedown(function (event) {\n            if (isEditMode() || Store.allowEdit === false) {\n                //此模式下禁用选区拖动\n                return;\n            }\n            $('#luckysheet-cell-selected').find('.luckysheet-cs-fillhandle').css('cursor', 'move').end().find('.luckysheet-cs-draghandle').css('cursor', 'move');\n            $('#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0').css('cursor', 'move');\n            Store.luckysheet_cell_selected_move = true;\n            Store.luckysheet_scroll_status = true;\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n            let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n            let row_location = rowLocation(y), row_pre = row_location[0], row = row_location[1], row_index = row_location[2];\n            let col_location = colLocation(x), col_pre = col_location[0], col = col_location[1], col_index = col_location[2];\n            Store.luckysheet_cell_selected_move_index = [\n                row_index,\n                col_index\n            ];\n            $('#luckysheet-cell-selected-move').css({\n                'left': col_pre,\n                'width': col - col_pre - 1,\n                'top': row_pre,\n                'height': row - row_pre - 1,\n                'display': 'block'\n            });\n            event.stopPropagation();\n        });    //选区下拉\n        //选区下拉\n        $('#luckysheet-cell-main div.luckysheet-cs-fillhandle').mousedown(function (event) {\n            if (isEditMode() || Store.allowEdit === false) {\n                //此模式下禁用选区下拉\n                return;\n            }\n            $('#luckysheet-cell-selected').find('.luckysheet-cs-fillhandle').css('cursor', 'crosshair').end().find('.luckysheet-cs-draghandle').css('cursor', 'crosshair');\n            $('#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0').css('cursor', 'crosshair');\n            Store.luckysheet_cell_selected_extend_time = setTimeout(function () {\n                Store.luckysheet_cell_selected_extend = true;\n                Store.luckysheet_scroll_status = true;\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft() - 5;\n                let y = mouse[1] + $('#luckysheet-cell-main').scrollTop() - 5;\n                let row_location = rowLocation(y), row_pre = row_location[0], row = row_location[1], row_index = row_location[2];\n                let col_location = colLocation(x), col_pre = col_location[0], col = col_location[1], col_index = col_location[2];\n                Store.luckysheet_cell_selected_extend_index = [\n                    row_index,\n                    col_index\n                ];\n                $('#luckysheet-cell-selected-extend').css({\n                    'left': col_pre,\n                    'width': col - col_pre - 1,\n                    'top': row_pre,\n                    'height': row - row_pre - 1,\n                    'display': 'block'\n                });\n            }, 100);\n            event.stopPropagation();\n        }).click(function () {\n            clearTimeout(Store.luckysheet_cell_selected_extend_time);\n            event.stopPropagation();\n        }).dblclick(function () {\n            let last = Store.luckysheet_select_save[0];\n            let r0 = last.row[0], r1 = last.row[1], c0 = last.column[0], c1 = last.column[1];\n            if (pivotTable.isPivotRange(r0, c0)) {\n                return;\n            }\n            let dropCellState = false;\n            let step = 0;\n            for (let r = r1 + 1; r < Store.flowdata.length; r++) {\n                if (c0 - 1 >= 0 && c1 + 1 < Store.flowdata[0].length) {\n                    let cell1 = Store.flowdata[r][c0 - 1];\n                    let cell2 = Store.flowdata[r][c1 + 1];\n                    if (r == r1 + 1) {\n                        if ((cell1 == null || isRealNull(cell1.v)) && (cell2 == null || isRealNull(cell2.v))) {\n                            dropCellState = false;\n                            break;\n                        } else {\n                            dropCellState = true;\n                            step++;\n                        }\n                    } else {\n                        if ((cell1 == null || isRealNull(cell1.v)) && (cell2 == null || isRealNull(cell2.v))) {\n                            break;\n                        }\n                        step++;\n                    }\n                } else if (c0 - 1 >= 0) {\n                    let cell = Store.flowdata[r][c0 - 1];\n                    if (r == r1 + 1) {\n                        if (cell == null || isRealNull(cell.v)) {\n                            dropCellState = false;\n                            break;\n                        } else {\n                            dropCellState = true;\n                            step++;\n                        }\n                    } else {\n                        if (cell == null || isRealNull(cell.v)) {\n                            break;\n                        }\n                        step++;\n                    }\n                } else if (c1 + 1 < Store.flowdata[0].length) {\n                    let cell = Store.flowdata[r][c1 + 1];\n                    if (r == r1 + 1) {\n                        if (cell == null || isRealNull(cell.v)) {\n                            dropCellState = false;\n                            break;\n                        } else {\n                            dropCellState = true;\n                            step++;\n                        }\n                    } else {\n                        if (cell == null || isRealNull(cell.v)) {\n                            break;\n                        }\n                        step++;\n                    }\n                }\n            }\n            if (!dropCellState || step == 0) {\n                event.stopPropagation();\n                return;\n            }    //复制范围\n            //复制范围\n            luckysheetDropCell.copyRange = {\n                'row': [\n                    r0,\n                    r1\n                ],\n                'column': [\n                    c0,\n                    c1\n                ]\n            };    //applyType\n            //applyType\n            let typeItemHide = luckysheetDropCell.typeItemHide();\n            if (!typeItemHide[0] && !typeItemHide[1] && !typeItemHide[2] && !typeItemHide[3] && !typeItemHide[4] && !typeItemHide[5] && !typeItemHide[6]) {\n                luckysheetDropCell.applyType = '0';\n            } else {\n                luckysheetDropCell.applyType = '1';\n            }\n            luckysheetDropCell.applyRange = {\n                'row': [\n                    r1 + 1,\n                    r1 + step\n                ],\n                'column': [\n                    c0,\n                    c1\n                ]\n            };\n            luckysheetDropCell.direction = 'down';\n            Store.luckysheet_select_save = [{\n                    'row': [\n                        r0,\n                        r1 + step\n                    ],\n                    'column': [\n                        c0,\n                        c1\n                    ]\n                }];\n            luckysheetDropCell.update();\n            luckysheetDropCell.createIcon();\n            $('#luckysheet-cell-selected-move').hide();\n            $('#luckysheet-sheettable').css('cursor', 'default');\n            clearTimeout(Store.countfuncTimeout);\n            Store.countfuncTimeout = setTimeout(function () {\n                countfunc();\n            }, 500);\n            event.stopPropagation();\n        });    //\n        //\n        $('#luckysheet-bottom-add-row, #luckysheet-bottom-add-row-input, #luckysheet-bottom-return-top').on('mousedown dblclick mouseup', function (e) {\n            e.stopPropagation();\n        });    //底部添加行按钮\n        //底部添加行按钮\n        $('#luckysheet-bottom-add-row').on('click', function (e) {\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            let $t = $(this), value = $('#luckysheet-bottom-add-row-input').val();\n            if (value == '') {\n                value = 100;\n            }\n            if (isNaN(parseInt(value))) {\n                if (isEditMode()) {\n                    alert(locale_info.tipInputNumber);\n                } else {\n                    tooltip.info('error', locale_info.tipInputNumber);\n                }\n                return;\n            }\n            value = parseInt(value);\n            if (value < 1 || value > 100) {\n                if (isEditMode()) {\n                    alert(locale_info.tipInputNumberLimit);\n                } else {\n                    tooltip.info('error', locale_info.tipInputNumberLimit);\n                }\n                return;\n            }\n            luckysheetextendtable('row', Store.flowdata.length - 1, value);\n        });\n        $('#luckysheet-bottom-return-top').on('click', function (e) {\n            $('#luckysheet-scrollbar-y').scrollTop(0);\n        });    //右键菜单 复制按钮\n        //右键菜单 复制按钮\n        $('#luckysheet-copy-btn, #luckysheet-cols-copy-btn, #luckysheet-paste-btn-title').click(function (event) {\n            $(this).parent().hide();    //复制范围内包含部分合并单元格，提示\n            //复制范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n            }    //多重选区 有条件格式时 提示\n            //多重选区 有条件格式时 提示\n            let cdformat = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].luckysheet_conditionformat_save;\n            if (Store.luckysheet_select_save.length > 1 && cdformat != null && cdformat.length > 0) {\n                let hasCF = false;\n                let cf_compute = conditionformat.getComputeMap();\n                label:\n                    for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                        if (hasCF) {\n                            break;\n                        }\n                        let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                        let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                        for (let r = r1; r <= r2; r++) {\n                            for (let c = c1; c <= c2; c++) {\n                                if (conditionformat.checksCF(r, c, cf_compute) != null) {\n                                    hasCF = true;\n                                    continue label;\n                                }\n                            }\n                        }\n                    }\n                if (hasCF) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                    return;\n                }\n            }    //多重选区 行不一样且列不一样时 提示       \n            //多重选区 行不一样且列不一样时 提示       \n            if (Store.luckysheet_select_save.length > 1) {\n                let isSameRow = true, str_r = Store.luckysheet_select_save[0].row[0], end_r = Store.luckysheet_select_save[0].row[1];\n                let isSameCol = true, str_c = Store.luckysheet_select_save[0].column[0], end_c = Store.luckysheet_select_save[0].column[1];\n                for (let s = 1; s < Store.luckysheet_select_save.length; s++) {\n                    if (Store.luckysheet_select_save[s].row[0] != str_r || Store.luckysheet_select_save[s].row[1] != end_r) {\n                        isSameRow = false;\n                    }\n                    if (Store.luckysheet_select_save[s].column[0] != str_c || Store.luckysheet_select_save[s].column[1] != end_c) {\n                        isSameCol = false;\n                    }\n                }\n                if (!isSameRow && !isSameCol || selectIsOverlap()) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                    return;\n                }\n            }\n            selection.copy(event);\n        });    //右键菜单 粘贴按钮\n        //右键菜单 粘贴按钮\n        $('#luckysheet-copy-paste, #luckysheet-cols-paste-btn, #luckysheet-paste-btn-title').click(function (event) {\n            selection.paste(event, 'btn');\n            $(this).parent().hide();\n        });    //Menu bar, Chart button\n        //Menu bar, Chart button\n        $('#luckysheet-chart-btn-title').click(function () {\n            createLuckyChart();\n        });    // Right-click the menu, chart generation\n        // Right-click the menu, chart generation\n        $('#luckysheetdatavisual').click(function () {\n            createLuckyChart();\n            $('#luckysheet-rightclick-menu').hide();\n        });    //菜单栏 数据透视表\n        //菜单栏 数据透视表\n        $('#luckysheet-pivot-btn-title').click(function (e) {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'usePivotTablereports')) {\n                return;\n            }\n            pivotTable.createPivotTable(e);\n        });    //菜单栏 截图按钮\n        //菜单栏 截图按钮\n        $('#luckysheet-chart-btn-screenshot').click(function () {\n            const locale_screenshot = _locale.screenshot;\n            if (Store.luckysheet_select_save.length == 0) {\n                if (isEditMode()) {\n                    alert(locale_screenshot.screenshotTipNoSelection);\n                } else {\n                    tooltip.info(locale_screenshot.screenshotTipTitle, locale_screenshot.screenshotTipNoSelection);\n                }\n                return;\n            }\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_screenshot.screenshotTipHasMulti);\n                } else {\n                    tooltip.info(locale_screenshot.screenshotTipTitle, locale_screenshot.screenshotTipHasMulti);\n                }\n                return;\n            }    //截图范围内包含部分合并单元格，提示\n            //截图范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_screenshot.screenshotTipHasMerge);\n                    } else {\n                        tooltip.info(locale_screenshot.screenshotTipTitle, locale_screenshot.screenshotTipHasMerge);\n                    }\n                    return;\n                }\n            }\n            let st_r = Store.luckysheet_select_save[0].row[0], ed_r = Store.luckysheet_select_save[0].row[1];\n            let st_c = Store.luckysheet_select_save[0].column[0], ed_c = Store.luckysheet_select_save[0].column[1];\n            let scrollHeight, rh_height;\n            if (st_r - 1 < 0) {\n                scrollHeight = 0;\n                rh_height = Store.visibledatarow[ed_r];\n            } else {\n                scrollHeight = Store.visibledatarow[st_r - 1];\n                rh_height = Store.visibledatarow[ed_r] - Store.visibledatarow[st_r - 1];\n            }\n            let scrollWidth, ch_width;\n            if (st_c - 1 < 0) {\n                scrollWidth = 0;\n                ch_width = Store.visibledatacolumn[ed_c];\n            } else {\n                scrollWidth = Store.visibledatacolumn[st_c - 1];\n                ch_width = Store.visibledatacolumn[ed_c] - Store.visibledatacolumn[st_c - 1];\n            }\n            let newCanvas = $('<canvas>').attr({\n                width: Math.ceil(ch_width * devicePixelRatio),\n                height: Math.ceil(rh_height * devicePixelRatio)\n            }).css({\n                width: ch_width,\n                height: rh_height\n            });\n            luckysheetDrawMain(scrollWidth, scrollHeight, ch_width, rh_height, 1, 1, null, null, newCanvas);\n            let ctx_newCanvas = newCanvas.get(0).getContext('2d');    //补上 左边框和上边框\n            //补上 左边框和上边框\n            ctx_newCanvas.beginPath();\n            ctx_newCanvas.moveTo(0, 0);\n            ctx_newCanvas.lineTo(0, Store.devicePixelRatio * rh_height);\n            ctx_newCanvas.lineWidth = Store.devicePixelRatio * 2;\n            ctx_newCanvas.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n            ctx_newCanvas.stroke();\n            ctx_newCanvas.closePath();\n            ctx_newCanvas.beginPath();\n            ctx_newCanvas.moveTo(0, 0);\n            ctx_newCanvas.lineTo(Store.devicePixelRatio * ch_width, 0);\n            ctx_newCanvas.lineWidth = Store.devicePixelRatio * 2;\n            ctx_newCanvas.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n            ctx_newCanvas.stroke();\n            ctx_newCanvas.closePath();\n            let image = new Image();\n            let url = newCanvas.get(0).toDataURL('image/png');\n            image.src = url;\n            if (ch_width > rh_height) {\n                image.style.width = '100%';\n            } else {\n                image.style.height = '100%';\n            }\n            let maxHeight = $(window).height() - 200;\n            tooltip.screenshot(locale_screenshot.screenshotTipSuccess, '<div id=\"luckysheet-confirm-screenshot-save\" style=\"height:' + maxHeight + 'px;overflow:auto;\"></div>', url);\n            $('#luckysheet-confirm-screenshot-save').append(image);\n            newCanvas.remove();\n        });    //截图下载\n        //截图下载\n        $(document).on('click.luckysheetEvent', 'a.download', function () {\n            let dataURI = $('#luckysheet-confirm-screenshot-save img').attr('src');\n            const locale_screenshot = _locale.screenshot;\n            let binStr = atob(dataURI.split(',')[1]), len = binStr.length, arr = new Uint8Array(len);\n            for (let i = 0; i < len; i++) {\n                arr[i] = binStr.charCodeAt(i);\n            }\n            let blob = new Blob([arr]);\n            let element = document.createElement('a');\n            element.setAttribute('href', URL.createObjectURL(blob));\n            element.setAttribute('download', locale_screenshot.screenshotImageName + '.png');\n            element.style.display = 'none';\n            document.body.appendChild(element);\n            element.click();\n            let clickHandler;\n            element.addEventListener('click', clickHandler = function () {\n                requestAnimationFrame(function () {\n                    URL.revokeObjectURL(element.href);\n                });\n                element.removeAttribute('href');\n                element.removeEventListener('click', clickHandler);\n            });\n            document.body.removeChild(element);\n        });    //菜单栏 分列按钮\n        //菜单栏 分列按钮\n        $('#luckysheet-splitColumn-btn-title').click(function () {\n            if (!checkProtectionNotEnable(Store.currentSheetIndex)) {\n                return;\n            }\n            if (Store.luckysheet_select_save == null || Store.luckysheet_select_save.length == 0) {\n                return;\n            }\n            const locale_splitText = _locale.splitText;\n            if (Store.luckysheet_select_save.length > 1) {\n                tooltip.info(locale_splitText.tipNoMulti, '');\n                return;\n            }\n            if (Store.luckysheet_select_save[0].column[0] != Store.luckysheet_select_save[0].column[1]) {\n                tooltip.info(locale_splitText.tipNoMultiColumn, '');\n                return;\n            }\n            splitColumn.createDialog();\n            splitColumn.init();\n        });    //菜单栏 插入图片按钮\n        //菜单栏 插入图片按钮\n        $('#luckysheet-insertImg-btn-title').click(function () {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects')) {\n                return;\n            }\n            $('#luckysheet-imgUpload').click();\n        });\n        $('#luckysheetInsertImage').click(function () {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects')) {\n                return;\n            }\n            $('#luckysheet-imgUpload').click();\n            $('#luckysheet-rightclick-menu').hide();\n        });\n        $('#luckysheet-imgUpload').click(function (e) {\n            e.stopPropagation();\n        });\n        $('#luckysheet-imgUpload').on('change', function (e) {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects', false)) {\n                return;\n            }\n            let file = e.currentTarget.files[0];\n            let render = new FileReader();\n            render.readAsDataURL(file);\n            render.onload = function (event) {\n                let src = event.target.result;\n                imageCtrl.inserImg(src);\n                $('#luckysheet-imgUpload').val('');\n            };\n        });    //菜单栏 插入链接按钮\n        //菜单栏 插入链接按钮\n        $('#luckysheet-insertLink-btn-title').click(function () {\n            if (!checkProtectionNotEnable(Store.currentSheetIndex)) {\n                return;\n            }\n            if (Store.luckysheet_select_save == null || Store.luckysheet_select_save.length == 0) {\n                return;\n            }\n            hyperlinkCtrl.createDialog();\n            hyperlinkCtrl.init();\n        });\n        $('#luckysheetInsertLink').click(function () {\n            $('#luckysheet-insertLink-btn-title').click();\n            $('#luckysheet-rightclick-menu').hide();\n        });    //菜单栏 数据验证按钮\n        //菜单栏 数据验证按钮\n        $('#luckysheet-dataVerification-btn-title').click(function () {\n            if (!checkProtectionNotEnable(Store.currentSheetIndex)) {\n                return;\n            }\n            if (Store.luckysheet_select_save == null || Store.luckysheet_select_save.length == 0) {\n                return;\n            }\n            dataVerificationCtrl.createDialog();\n            dataVerificationCtrl.init();\n        });\n        $('#luckysheetDataVerification').click(function () {\n            $('#luckysheet-dataVerification-btn-title').click();\n            $('#luckysheet-rightclick-menu').hide();\n        });    //Cell format\n        //Cell format\n        $('#luckysheetCellFormatRightClickMenu').click(function () {\n            openCellFormatModel();\n        });    //冻结行列\n        //冻结行列\n        $('#luckysheet-freezen-btn-horizontal').click(function () {\n            if ($.trim($(this).text()) == locale().freezen.freezenCancel) {\n                luckysheetFreezen.saveFrozen('freezenCancel');\n                if (Store.freezenverticaldata != null) {\n                    luckysheetFreezen.cancelFreezenVertical();\n                    luckysheetFreezen.createAssistCanvas();\n                    luckysheetrefreshgrid();\n                }\n                if (Store.freezenhorizontaldata != null) {\n                    luckysheetFreezen.cancelFreezenHorizontal();\n                    luckysheetFreezen.createAssistCanvas();\n                    luckysheetrefreshgrid();\n                }\n                luckysheetFreezen.scrollAdapt();\n            } else {\n                luckysheetFreezen.saveFrozen('freezenRow');\n                if (Store.freezenverticaldata != null) {\n                    luckysheetFreezen.cancelFreezenVertical();\n                    luckysheetFreezen.createAssistCanvas();\n                    luckysheetrefreshgrid();\n                }\n                if (Store.freezenhorizontaldata == null) {\n                    luckysheetFreezen.createFreezenHorizontal();\n                    luckysheetFreezen.createAssistCanvas();\n                }\n            }\n        });\n        $('#luckysheet-freezen-btn-vertical').click(function () {\n            if (Store.freezenverticaldata != null) {\n                luckysheetFreezen.saveFrozen('freezenCancel');\n                luckysheetFreezen.cancelFreezenVertical();\n                luckysheetrefreshgrid();\n            } else {\n                luckysheetFreezen.saveFrozen('freezenColumn');\n                luckysheetFreezen.createFreezenVertical();\n            }\n            luckysheetFreezen.createAssistCanvas();\n        });\n        $('#luckysheet-rightclick-menu input').on('keydown', function (e) {\n            e.stopPropagation();\n        });\n        $('#luckysheet-modal-dialog-mask').on('click dbclick mousedown mousemove mouseup', function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n        });\n        let copychange = function () {\n            if (document.hidden || document.webkitHidden || document.msHidden) {\n                Store.iscopyself = false;\n            }\n        };\n        $(document).on('visibilitychange.luckysheetEvent webkitvisibilitychange.luckysheetEvent msvisibilitychange.luckysheetEvent', copychange).on('mouseleave.luckysheetEvent', function () {\n            Store.iscopyself = false;\n        }).on('mousedown.luckysheetEvent', function (event) {\n            //有批注在编辑时\n            luckysheetPostil.removeActivePs();\n            hideMenuByCancel(event);    //点击功能栏时 如果是单元格编辑模式 则退出编辑模式 \n            //点击功能栏时 如果是单元格编辑模式 则退出编辑模式 \n            if ($(event.target).closest('#luckysheet-wa-editor').length > 0 && parseInt($('#luckysheet-input-box').css('top')) > 0) {\n                console.log(event);\n                formula.updatecell(Store.luckysheetCellUpdate[0], Store.luckysheetCellUpdate[1]);\n                luckysheetMoveHighlightCell('down', 0, 'rangeOfSelect');\n            }\n        });    //表格左上角点击 全选表格\n        //表格左上角点击 全选表格\n        $('#luckysheet-left-top').click(function (event) {\n            if (!checkProtectionAllSelected(Store.currentSheetIndex)) {\n                return;\n            }\n            $('#luckysheet-wa-functionbox-confirm').click();\n            Store.luckysheet_select_status = false;\n            Store.luckysheet_select_save = [{\n                    'row': [\n                        0,\n                        Store.flowdata.length - 1\n                    ],\n                    'column': [\n                        0,\n                        Store.flowdata[0].length - 1\n                    ],\n                    'row_focus': 0,\n                    'column_focus': 0,\n                    row_select: true,\n                    column_select: true\n                }];\n            selectHightlightShow();\n            clearTimeout(Store.countfuncTimeout);\n            Store.countfuncTimeout = setTimeout(function () {\n                countfunc();\n            }, 500);    /* 选中区域：发送网络请求 */\n            /* 选中区域：发送网络请求 */\n            Store.saveParam('mv', Store.currentSheetIndex, Store.luckysheet_select_save);\n            event.stopPropagation();\n        });    //回退 重做 按钮\n        //回退 重做 按钮\n        $('#luckysheet-icon-undo').click(function (event) {\n            controlHistory.redo(event);\n        });\n        $('#luckysheet-icon-redo').click(function (event) {\n            controlHistory.undo(event);\n        });    //模态框拖动\n        //模态框拖动\n        $(document).on('mousedown.luckysheetEvent', 'div.luckysheet-modal-dialog', function (e) {\n            if (!$(e.target).is('.luckysheet-modal-dialog')) {\n                return;\n            }\n            Store.luckysheet_model_move_state = true;\n            Store.luckysheet_model_move_obj = $(e.currentTarget);\n            let toffset = Store.luckysheet_model_move_obj.offset();\n            Store.luckysheet_model_xy = [\n                e.pageX - toffset.left,\n                e.pageY - toffset.top\n            ];\n        });    //模态框关闭\n        //模态框关闭\n        $(document).on('click.luckysheetEvent', '.luckysheet-modal-dialog-title-close, .luckysheet-model-close-btn', function (e) {\n            //选择文本颜色和单元格颜色弹出框取消\n            if ($('#textcolorselect').is(':visible') || $('#cellcolorselect').is(':visible')) {\n                $('#luckysheet-conditionformat-dialog').show();\n            }\n            $(e.currentTarget).parents('.luckysheet-modal-dialog').hide();\n            $('#luckysheet-modal-dialog-mask').hide();    //函数查找功能所有弹出框关闭和取消\n            //函数查找功能所有弹出框关闭和取消\n            if ($(this).parents('.luckysheet-modal-dialog').hasClass('luckysheet-search-formula')) {\n                formula.dontupdate();\n                luckysheetMoveHighlightCell('down', 0, 'rangeOfSelect');\n            }\n            if ($(this).parents('.luckysheet-modal-dialog').hasClass('luckysheet-search-formula-parm')) {\n                formula.dontupdate();\n                luckysheetMoveHighlightCell('down', 0, 'rangeOfSelect');\n            }\n            if ($(this).parents('.luckysheet-modal-dialog').hasClass('luckysheet-search-formula-parm-select')) {\n                formula.dontupdate();\n                luckysheetMoveHighlightCell('down', 0, 'rangeOfSelect');\n            }\n            luckysheetContainerFocus();\n        });    //左上角返回按钮\n        //左上角返回按钮\n        $('#luckysheet_info_detail_title').click(function () {\n            window.open(luckysheetConfigsetting.myFolderUrl, '_self');\n        });    //图表选区mousedown\n        //图表选区mousedown\n        $('#luckysheet-chart-rangeShow').on('mousedown.chartRangeShowMove', '.luckysheet-chart-rangeShow-move', function (event) {\n            Store.chart_selection.rangeMove = true;\n            Store.luckysheet_scroll_status = true;\n            Store.chart_selection.rangeMoveObj = $(this).parent();\n            let chart_json = Store.currentChart;\n            let $id = $(this).parent().attr('id');\n            if ($id == 'luckysheet-chart-rangeShow-content') {\n                let row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.content.row[0];\n                let col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.content.column[0];\n                Store.chart_selection.rangeMoveIndex = [\n                    row_s,\n                    col_s\n                ];\n            } else if ($id == 'luckysheet-chart-rangeShow-rowtitle') {\n                let row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.rowtitle.row[0];\n                let col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.rowtitle.column[0];\n                Store.chart_selection.rangeMoveIndex = [\n                    row_s,\n                    col_s\n                ];\n            } else if ($id == 'luckysheet-chart-rangeShow-coltitle') {\n                let row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.coltitle.row[0];\n                let col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.coltitle.column[0];\n                Store.chart_selection.rangeMoveIndex = [\n                    row_s,\n                    col_s\n                ];\n            }\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n            let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n            let type = $(this).data('type');\n            if (type == 'top') {\n                y += 3;\n            } else if (type == 'right') {\n                x -= 3;\n            } else if (type == 'bottom') {\n                y -= 3;\n            } else if (type == 'left') {\n                x += 3;\n            }\n            let row_index = rowLocation(y)[2];\n            let col_index = colLocation(x)[2];\n            Store.chart_selection.rangeMovexy = [\n                row_index,\n                col_index\n            ];\n            event.stopPropagation();\n        });\n        $('#luckysheet-chart-rangeShow').on('mousedown.chartRangeShowResize', '.luckysheet-chart-rangeShow-resize', function (event) {\n            Store.chart_selection.rangeResize = $(this).data('type');    //开始状态resize\n            //开始状态resize\n            Store.luckysheet_scroll_status = true;\n            Store.chart_selection.rangeResizeObj = $(this).parent();\n            let chart_json = Store.currentChart;\n            let row_s;\n            let row_e;\n            let col_s;\n            let col_e;\n            let $id = $(this).parent().attr('id');\n            if ($id == 'luckysheet-chart-rangeShow-content') {\n                if (chart_json.rangeRowCheck.exits) {\n                    row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.content.row[0];\n                    row_e = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.content.row[1];\n                } else {\n                    row_s = chart_json.rangeSplitArray.content.row[0];\n                    row_e = chart_json.rangeSplitArray.content.row[0];\n                }\n                if (chart_json.rangeColCheck.exits) {\n                    col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.content.column[0];\n                    col_e = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.content.column[1];\n                } else {\n                    col_s = chart_json.rangeSplitArray.content.column[0];\n                    col_e = chart_json.rangeSplitArray.content.column[1];\n                }\n                Store.chart_selection.rangeResizeIndex = {\n                    'row': [\n                        row_s,\n                        row_e\n                    ],\n                    'column': [\n                        col_s,\n                        col_e\n                    ]\n                };\n            } else if ($id == 'luckysheet-chart-rangeShow-rowtitle') {\n                let row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.rowtitle.row[0];\n                let row_e = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.rowtitle.row[1];\n                let col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.rowtitle.column[0];\n                let col_e = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.rowtitle.column[1];\n                Store.chart_selection.rangeResizeIndex = {\n                    'row': [\n                        row_s,\n                        row_e\n                    ],\n                    'column': [\n                        col_s,\n                        col_e\n                    ]\n                };\n            } else if ($id == 'luckysheet-chart-rangeShow-coltitle') {\n                let row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.coltitle.row[0];\n                let row_e = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.coltitle.row[1];\n                let col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.coltitle.column[0];\n                let col_e = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.coltitle.column[1];\n                Store.chart_selection.rangeResizeIndex = {\n                    'row': [\n                        row_s,\n                        row_e\n                    ],\n                    'column': [\n                        col_s,\n                        col_e\n                    ]\n                };\n            }\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n            let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n            if (Store.chart_selection.rangeResize == 'lt') {\n                x += 3;\n                y += 3;\n            } else if (Store.chart_selection.rangeResize == 'lb') {\n                x += 3;\n                y -= 3;\n            } else if (Store.chart_selection.rangeResize == 'rt') {\n                x -= 3;\n                y += 3;\n            } else if (Store.chart_selection.rangeResize == 'rb') {\n                x -= 3;\n                y -= 3;\n            }\n            let row_index = rowLocation(y)[2];\n            let col_index = colLocation(x)[2];\n            Store.chart_selection.rangeResizexy = [\n                row_index,\n                col_index\n            ];\n            event.stopPropagation();\n        });\n        $('#luckysheet-wa-calculate-size').mousedown(function (e) {\n            let y = e.pageY;\n            formula.functionResizeData.y = y;\n            formula.functionResizeStatus = true;\n            formula.functionResizeData.calculatebarHeight = Store.calculatebarHeight;\n            if (formula.rangetosheet != null) {\n                formula.updatecell(Store.luckysheetCellUpdate[0], Store.luckysheetCellUpdate[1]);\n            }\n        });    // 点击设置字体大小的下拉箭头，把自动聚焦输入框去除（认为下拉设置字体大小，不需要聚焦输入框）\n               // //toolbar菜单\n               // $(\"#\" + Store.container + \" .luckysheet-wa-editor\").on(\"click\", \".luckysheet-toolbar-zoom-combobox\", function (e) {\n               //     $(e.currentTarget).addClass(\"luckysheet-toolbar-combo-button-open\");\n               //     $(e.currentTarget).find(\".luckysheet-toolbar-combo-button-input\").focus();\n               // });\n               // $(\"#\" + Store.container + \" .luckysheet-wa-editor\").on(\"blur\", \".luckysheet-toolbar-combo-button-input\", function (e) {\n               //     $(e.currentTarget).closest(\".luckysheet-toolbar-zoom-combobox\").removeClass(\"luckysheet-toolbar-combo-button-open\");\n               // });\n               //表格格式处理\n        // 点击设置字体大小的下拉箭头，把自动聚焦输入框去除（认为下拉设置字体大小，不需要聚焦输入框）\n        // //toolbar菜单\n        // $(\"#\" + Store.container + \" .luckysheet-wa-editor\").on(\"click\", \".luckysheet-toolbar-zoom-combobox\", function (e) {\n        //     $(e.currentTarget).addClass(\"luckysheet-toolbar-combo-button-open\");\n        //     $(e.currentTarget).find(\".luckysheet-toolbar-combo-button-input\").focus();\n        // });\n        // $(\"#\" + Store.container + \" .luckysheet-wa-editor\").on(\"blur\", \".luckysheet-toolbar-combo-button-input\", function (e) {\n        //     $(e.currentTarget).closest(\".luckysheet-toolbar-zoom-combobox\").removeClass(\"luckysheet-toolbar-combo-button-open\");\n        // });\n        //表格格式处理\n        menuButton.initialMenuButton();\n        let dpi_x = document.getElementById('testdpidiv').offsetWidth * Store.devicePixelRatio;\n        let dpi_y = document.getElementById('testdpidiv').offsetHeight * Store.devicePixelRatio;    //粘贴事件处理\n        //粘贴事件处理\n        $(document).on('paste.luckysheetEvent', function (e) {\n            if (isEditMode()) {\n                //此模式下禁用粘贴\n                return;\n            }\n            if (selection.isPasteAction) {\n                $('#luckysheet-rich-text-editor').blur();\n                selection.isPasteAction = false;\n                let clipboardData = window.clipboardData;    //for IE\n                //for IE\n                if (!clipboardData) {\n                    // for chrome\n                    clipboardData = e.originalEvent.clipboardData;\n                }\n                let txtdata = clipboardData.getData('text/html') || clipboardData.getData('text/plain');    //如果标示是qksheet复制的内容，判断剪贴板内容是否是当前页面复制的内容\n                //如果标示是qksheet复制的内容，判断剪贴板内容是否是当前页面复制的内容\n                let isEqual = true;\n                if (txtdata.indexOf('luckysheet_copy_action_table') > -1 && Store.luckysheet_copy_save['copyRange'] != null && Store.luckysheet_copy_save['copyRange'].length > 0) {\n                    //剪贴板内容解析\n                    let cpDataArr = [];\n                    let reg = new RegExp('<tr.*?>(.*?)</tr>', 'g');\n                    let reg2 = new RegExp('<td.*?>(.*?)</td>', 'g');\n                    let regArr = txtdata.match(reg);\n                    for (let i = 0; i < regArr.length; i++) {\n                        let cpRowArr = [];\n                        let reg2Arr = regArr[i].match(reg2);\n                        if (reg2Arr != null) {\n                            for (let j = 0; j < reg2Arr.length; j++) {\n                                let cpValue = reg2Arr[j].replace(/<td.*?>/g, '').replace(/<\\/td>/g, '');\n                                cpRowArr.push(cpValue);\n                            }\n                        }\n                        cpDataArr.push(cpRowArr);\n                    }    //当前页面复制区内容\n                    //当前页面复制区内容\n                    let copy_r1 = Store.luckysheet_copy_save['copyRange'][0].row[0], copy_r2 = Store.luckysheet_copy_save['copyRange'][0].row[1], copy_c1 = Store.luckysheet_copy_save['copyRange'][0].column[0], copy_c2 = Store.luckysheet_copy_save['copyRange'][0].column[1];\n                    let copy_index = Store.luckysheet_copy_save['dataSheetIndex'];\n                    let d;\n                    if (copy_index == Store.currentSheetIndex) {\n                        d = Store.deepCopyFlowData(Store.flowdata);\n                    } else {\n                        d = Store.luckysheetfile[getSheetIndex(copy_index)].data;\n                    }\n                    for (let r = copy_r1; r <= copy_r2; r++) {\n                        if (r - copy_r1 > cpDataArr.length - 1) {\n                            break;\n                        }\n                        for (let c = copy_c1; c <= copy_c2; c++) {\n                            let cell = d[r][c];\n                            if (cell != null && cell.mc != null && cell.mc.rs == null) {\n                                continue;\n                            }\n                            let v;\n                            if (cell != null) {\n                                if (cell.ct != null && cell.ct.fa.indexOf('w') > -1) {\n                                    v = d[r][c].v;\n                                } else {\n                                    v = d[r][c].m;\n                                }\n                            } else {\n                                v = '';\n                            }\n                            if (v == null) {\n                                v = '';\n                            }\n                            if (cpDataArr[r - copy_r1][c - copy_c1] != v) {\n                                isEqual = false;\n                                break;\n                            }\n                        }\n                    }\n                }\n                const locale_fontjson = locale().fontjson;    // hook\n                // hook\n                if (!luckysheetConfigsetting.createHookFunction('rangePasteBefore', Store.luckysheet_select_save, txtdata)) {\n                    return;\n                }\n                if (txtdata.indexOf('luckysheet_copy_action_table') > -1 && Store.luckysheet_copy_save['copyRange'] != null && Store.luckysheet_copy_save['copyRange'].length > 0 && isEqual) {\n                    //剪切板内容 和 luckysheet本身复制的内容 一致\n                    if (Store.luckysheet_paste_iscut) {\n                        Store.luckysheet_paste_iscut = false;\n                        selection.pasteHandlerOfCutPaste(Store.luckysheet_copy_save);\n                        selection.clearcopy(e);\n                    } else {\n                        selection.pasteHandlerOfCopyPaste(Store.luckysheet_copy_save);\n                    }\n                } else if (txtdata.indexOf('luckysheet_copy_action_image') > -1) {\n                    imageCtrl.pasteImgItem();\n                } else {\n                    if (txtdata.indexOf('table') > -1) {\n                        $('#luckysheet-copy-content').html(txtdata);\n                        let data = new Array($('#luckysheet-copy-content').find('table tr').length);\n                        let colLen = 0;\n                        $('#luckysheet-copy-content').find('table tr').eq(0).find('td').each(function () {\n                            let colspan = parseInt($(this).attr('colspan'));\n                            if (isNaN(colspan)) {\n                                colspan = 1;\n                            }\n                            colLen += colspan;\n                        });\n                        for (let i = 0; i < data.length; i++) {\n                            data[i] = new Array(colLen);\n                        }\n                        let r = 0;\n                        let borderInfo = {};\n                        $('#luckysheet-copy-content').find('table tr').each(function () {\n                            let $tr = $(this);\n                            let c = 0;\n                            $tr.find('td').each(function () {\n                                let $td = $(this);\n                                let cell = {};\n                                let txt = $td.text();\n                                if ($.trim(txt).length == 0) {\n                                    cell.v = null;\n                                    cell.m = '';\n                                } else {\n                                    let mask = genarate($td.text());\n                                    cell.v = mask[2];\n                                    cell.ct = mask[1];\n                                    cell.m = mask[0];\n                                }\n                                let bg = $td.css('background-color');\n                                if (bg == 'rgba(0, 0, 0, 0)') {\n                                    bg = null;\n                                }\n                                cell.bg = bg;\n                                let bl = $td.css('font-weight');\n                                if (bl == 400 || bl == 'normal') {\n                                    cell.bl = 0;\n                                } else {\n                                    cell.bl = 1;\n                                }\n                                let it = $td.css('font-style');\n                                if (it == 'normal') {\n                                    cell.it = 0;\n                                } else {\n                                    cell.it = 1;\n                                }\n                                let ff = $td.css('font-family');\n                                let ffs = ff.split(',');\n                                for (let i = 0; i < ffs.length; i++) {\n                                    let fa = $.trim(ffs[i].toLowerCase());\n                                    fa = locale_fontjson[fa];\n                                    if (fa == null) {\n                                        cell.ff = 0;\n                                    } else {\n                                        cell.ff = fa;\n                                        break;\n                                    }\n                                }\n                                let fs = Math.floor(parseInt($td.css('font-size')) * 72 / 96) + 1;\n                                cell.fs = fs;\n                                let fc = $td.css('color');\n                                cell.fc = fc;\n                                let ht = $td.css('text-align');\n                                if (ht == 'center') {\n                                    cell.ht = 0;\n                                } else if (ht == 'right') {\n                                    cell.ht = 2;\n                                } else {\n                                    cell.ht = 1;\n                                }\n                                let vt = $td.css('vertical-align');\n                                if (vt == 'middle') {\n                                    cell.vt = 0;\n                                } else if (vt == 'top' || vt == 'text-top') {\n                                    cell.vt = 1;\n                                } else {\n                                    cell.vt = 2;\n                                }\n                                while (c < colLen && data[r][c] != null) {\n                                    c++;\n                                }\n                                if (c == colLen) {\n                                    return true;\n                                }\n                                if (data[r][c] == null) {\n                                    data[r][c] = cell;\n                                    let rowspan = parseInt($td.attr('rowspan'));\n                                    let colspan = parseInt($td.attr('colspan'));\n                                    if (isNaN(rowspan)) {\n                                        rowspan = 1;\n                                    }\n                                    if (isNaN(colspan)) {\n                                        colspan = 1;\n                                    }\n                                    let r_ab = Store.luckysheet_select_save[0]['row'][0] + r;\n                                    let c_ab = Store.luckysheet_select_save[0]['column'][0] + c;\n                                    for (let rp = 0; rp < rowspan; rp++) {\n                                        for (let cp = 0; cp < colspan; cp++) {\n                                            if (rp == 0) {\n                                                let bt = $td.css('border-top');\n                                                if (bt != null && bt.length > 0 && bt.substr(0, 3).toLowerCase() != '0px') {\n                                                    let width = $td.css('border-top-width');\n                                                    let type = $td.css('border-top-style');\n                                                    let color = $td.css('border-top-color');\n                                                    let borderconfig = menuButton.getQKBorder(width, type, color);\n                                                    if (borderInfo[r + rp + '_' + (c + cp)] == null) {\n                                                        borderInfo[r + rp + '_' + (c + cp)] = {};\n                                                    }\n                                                    borderInfo[r + rp + '_' + (c + cp)].t = {\n                                                        'style': borderconfig[0],\n                                                        'color': borderconfig[1]\n                                                    };\n                                                }\n                                            }\n                                            if (rp == rowspan - 1) {\n                                                let bb = $td.css('border-bottom');\n                                                if (bb != null && bb.length > 0 && bb.substr(0, 3).toLowerCase() != '0px') {\n                                                    let width = $td.css('border-bottom-width');\n                                                    let type = $td.css('border-bottom-style');\n                                                    let color = $td.css('border-bottom-color');\n                                                    let borderconfig = menuButton.getQKBorder(width, type, color);\n                                                    if (borderInfo[r + rp + '_' + (c + cp)] == null) {\n                                                        borderInfo[r + rp + '_' + (c + cp)] = {};\n                                                    }\n                                                    borderInfo[r + rp + '_' + (c + cp)].b = {\n                                                        'style': borderconfig[0],\n                                                        'color': borderconfig[1]\n                                                    };\n                                                }\n                                            }\n                                            if (cp == 0) {\n                                                let bl = $td.css('border-left');\n                                                if (bl != null && bl.length > 0 && bl.substr(0, 3).toLowerCase() != '0px') {\n                                                    let width = $td.css('border-left-width');\n                                                    let type = $td.css('border-left-style');\n                                                    let color = $td.css('border-left-color');\n                                                    let borderconfig = menuButton.getQKBorder(width, type, color);\n                                                    if (borderInfo[r + rp + '_' + (c + cp)] == null) {\n                                                        borderInfo[r + rp + '_' + (c + cp)] = {};\n                                                    }\n                                                    borderInfo[r + rp + '_' + (c + cp)].l = {\n                                                        'style': borderconfig[0],\n                                                        'color': borderconfig[1]\n                                                    };\n                                                }\n                                            }\n                                            if (cp == colspan - 1) {\n                                                let br = $td.css('border-right');\n                                                if (br != null && br.length > 0 && br.substr(0, 3).toLowerCase() != '0px') {\n                                                    let width = $td.css('border-right-width');\n                                                    let type = $td.css('border-right-style');\n                                                    let color = $td.css('border-right-color');\n                                                    let borderconfig = menuButton.getQKBorder(width, type, color);\n                                                    if (borderInfo[r + rp + '_' + (c + cp)] == null) {\n                                                        borderInfo[r + rp + '_' + (c + cp)] = {};\n                                                    }\n                                                    borderInfo[r + rp + '_' + (c + cp)].r = {\n                                                        'style': borderconfig[0],\n                                                        'color': borderconfig[1]\n                                                    };\n                                                }\n                                            }\n                                            if (rp == 0 && cp == 0) {\n                                                continue;\n                                            }\n                                            data[r + rp][c + cp] = {\n                                                'mc': {\n                                                    'r': r_ab,\n                                                    'c': c_ab\n                                                }\n                                            };\n                                        }\n                                    }\n                                    if (rowspan > 1 || colspan > 1) {\n                                        let first = {\n                                            'rs': rowspan,\n                                            'cs': colspan,\n                                            'r': r_ab,\n                                            'c': c_ab\n                                        };\n                                        data[r][c].mc = first;\n                                    }\n                                }\n                                c++;\n                                if (c == colLen) {\n                                    return true;\n                                }\n                            });\n                            r++;\n                        });\n                        Store.luckysheet_selection_range = [];\n                        selection.pasteHandler(data, borderInfo);\n                        $('#luckysheet-copy-content').empty();\n                    }    //复制的是图片\n                    else //复制的是图片\n                    if (clipboardData.files.length == 1 && clipboardData.files[0].type.indexOf('image') > -1) {\n                        let render = new FileReader();\n                        render.readAsDataURL(clipboardData.files[0]);\n                        render.onload = function (event) {\n                            let src = event.target.result;\n                            imageCtrl.inserImg(src);\n                        };\n                        return;\n                    } else {\n                        txtdata = clipboardData.getData('text/plain');\n                        selection.pasteHandler(txtdata);\n                    }\n                }\n            } else if ($(e.target).closest('#luckysheet-rich-text-editor').length > 0) {\n                // 阻止默认粘贴\n                e.preventDefault();\n                let clipboardData = window.clipboardData;    //for IE\n                //for IE\n                if (!clipboardData) {\n                    // for chrome\n                    clipboardData = e.originalEvent.clipboardData;\n                }\n                let text = clipboardData.getData('text/plain');    // 插入\n                // 插入\n                document.execCommand('insertText', false, text);\n            }\n        });    //是否允许加载下一页\n        //是否允许加载下一页\n        if (luckysheetConfigsetting.enablePage) {\n            $('#luckysheet-bottom-page-next').click(function () {\n                let queryExps = luckysheetConfigsetting.pageInfo.queryExps;\n                let reportId = luckysheetConfigsetting.pageInfo.reportId;\n                let fields = luckysheetConfigsetting.pageInfo.fields;\n                let mobile = luckysheetConfigsetting.pageInfo.mobile;\n                let frezon = luckysheetConfigsetting.pageInfo.frezon;\n                let currentPage = luckysheetConfigsetting.pageInfo.currentPage;\n                let totalPage = luckysheetConfigsetting.pageInfo.totalPage;\n                let pageUrl = luckysheetConfigsetting.pageInfo.pageUrl;\n                method.addDataAjax({\n                    'queryExps': queryExps,\n                    'reportId': reportId,\n                    'fields': fields,\n                    'mobile': mobile,\n                    'frezon': frezon,\n                    'pageIndex': currentPage,\n                    'currentPage': currentPage\n                }, Store.currentSheetIndex, pageUrl, function () {\n                    luckysheetConfigsetting.pageInfo.currentPage++;\n                    if (luckysheetConfigsetting.pageInfo.totalPage == luckysheetConfigsetting.pageInfo.currentPage) {\n                        $('#luckysheet-bottom-page-next').hide();\n                        let pageInfoFull = replaceHtml(locale_info.pageInfoFull, {\n                            total: luckysheetConfigsetting.total,\n                            totalPage: luckysheetConfigsetting.pageInfo.totalPage\n                        });\n                        $('#luckysheet-bottom-page-info').html(pageInfoFull);\n                    } else {\n                        let pageInfo = replaceHtml(locale_info.pageInfo, {\n                            total: luckysheetConfigsetting.total,\n                            totalPage: luckysheetConfigsetting.pageInfo.totalPage,\n                            currentPage: luckysheetConfigsetting.pageInfo.currentPage\n                        });\n                        $('#luckysheet-bottom-page-info').html(pageInfo);\n                    }\n                });\n            }).mousedown(function (e) {\n                e.stopPropagation();\n            });\n        }    //回到顶部\n        //回到顶部\n        $('#luckysheet-bottom-bottom-top').click(function () {\n            $('#luckysheet-scrollbar-y').scrollTop(0);\n        }).mousedown(function (e) {\n            e.stopPropagation();\n        });\n    };    // 协同编辑其他用户不在操作的时候，且已经展示了用户名10秒，则用户名框隐藏\n    // 协同编辑其他用户不在操作的时候，且已经展示了用户名10秒，则用户名框隐藏\n    function hideUsername() {\n        let $showEle = $$('.luckysheet-multipleRange-show');\n        if ($showEle.length === undefined) {\n            $showEle = [$showEle];\n        }\n        $showEle.forEach(ele => {\n            const id = ele.id.replace('luckysheet-multipleRange-show-', '');\n            if (Store.cooperativeEdit.usernameTimeout['user' + id] === null) {\n                $$('.username', ele).style.display = 'none';\n            }\n        });\n    }\n});"]}