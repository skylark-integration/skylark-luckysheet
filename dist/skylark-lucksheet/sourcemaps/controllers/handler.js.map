{"version":3,"sources":["controllers/handler.js"],"names":["define","mobileinit","luckysheetConfigsetting","luckysheetFreezen","pivotTable","luckysheetDropCell","luckysheetPostil","imageCtrl","hyperlinkCtrl","dataVerificationCtrl","menuButton","conditionformat","alternateformat","ifFormulaGenerator","sheetmanage","server","m_updateCell","m_sheetSearch","luckysheetsizeauto","m_sheetMove","m_select","selection","controlHistory","splitColumn","m_cursorPos","m_constant","m_protection","m_cellFormat","m_util","m_get","m_location","m_getRowlen","m_validate","m_count","browser","formula","m_extend","luckysheetscrollevent","m_refresh","m_getdata","tooltip","editor","m_format","method","m_border","m_draw","locale","Store","m_plugin","luckysheetupdateCell","luckysheet_searcharray","luckysheetMoveHighlightCell","selectHightlightShow","selectIsOverlap","selectionCopyShow","luckysheet_count_show","selectHelpboxFill","hideMenuByCancel","luckysheetdefaultstyle","checkProtectionLockedRangeList","checkProtectionAllSelected","checkProtectionSelectLockedOrUnLockedCells","checkProtectionNotEnable","checkProtectionAuthorityNormal","openCellFormatModel","replaceHtml","getObjType","chatatABC","ArrayUnique","showrightclickmenu","luckysheetactiveCell","luckysheetContainerFocus","$$","getSheetIndex","getRangetxt","rowLocation","colLocation","mouseposition","rowlenByRange","isRealNull","hasPartMC","isEditMode","countfunc","luckysheetextendtable","jfrefreshgrid","jfrefreshgrid_rhcw","luckysheetrefreshgrid","getdatabyselection","datagridgrowth","genarate","getBorderInfoCompute","luckysheetDrawMain","createLuckyChart","hideAllNeedRangeShow","detectOS","mobilecheck","Date","now","getTime","vendors","i","length","window","requestAnimationFrame","vp","cancelAnimationFrame","test","navigator","userAgent","lastTime","callback","nextTime","Math","max","setTimeout","clearTimeout","$","mousewheel","event","delta","scrollNum","deltaFactor","scrollLeft","this","deltaY","deltaX","preventDefault","scroll","_locale","locale_drag","drag","locale_info","info","mousewheelArrayUniqueTimeout","scrollTop","visibledatacolumn_c","visibledatacolumn","visibledatarow_c","visibledatarow","freezenhorizontaldata","freezenverticaldata","visibledatacolumn_unique","visibledatarow_unique","row_st","rowscroll","row_ed","step","round","zoomRatio","resize","document","getElementById","container","mouseup","e","inputMenuButtonFocus","target","mousedown","hasClass","$showEle","undefined","forEach","ele","id","replace","cooperativeEdit","usernameTimeout","style","display","hideUsername","find","css","end","removeActivePs","is","cancelActiveImgItem","mouse","pageX","pageY","cellmainWidth","cellMainSrollBarSize","cellmainHeight","x","y","sheetFile","getSheetByIndex","luckysheetTableContent","get","getContext","row_location","row","row_pre","row_index","col_location","col","col_pre","col_index","row_index_ed","col_index_ed","margeset","mergeborer","flowdata","column","createHookFunction","r","c","start_r","start_c","end_r","end_c","cellFocus","which","hide","isright","s","luckysheet_select_save","dd","fireMousedown","hyperlink","luckysheet_scroll_status","$input","parseInt","rangestart","rangedrag_column_start","rangedrag_row_start","israngeseleciton","rowseleted","columnseleted","left","width","top","height","shiftKey","last","func_selectedrange","row_focus","column_focus","changeparam","mergeMoveMain","ctrlKey","text","vText","lastWord","substr","functionHTMLGenerate","getSelection","currSelection","functionRangeIndex","anchorNode","parent","index","anchorOffset","textRange","createRange","html","canceFunctionrangeSelected","createRangeHightlight","rangeHightlightselected","left_move","width_move","top_move","height_move","rangeSetValue","show","$editor","rangechangeindex","data_parm_index","closest","$span","setCaretPosition","updatecell","luckysheetCellUpdate","luckysheet_select_status","currentSheetIndex","selectStatus","selectRange","push","range","getTxtByRange","val","rangetosheet","luckysheetfile","name","singleRangeFocus","click","extend","luckysheet_pivotTable_select_state","menuButtonFocus","fucntionboxshow","scrollAdaptOfselect","saveParam","rangefocus","pivotclick","allowEdit","obj_s","cellRightClickConfig","copy","copyAs","paste","insertColumn","deleteColumn","hideColumn","columnWidth","clear","matrix","sort","filter","chart","image","link","data","cellFormat","luckysheetRightHeadClickIs","rightclick","right","luckysheet_cols_menu_status","cfg","config","first_collen","defaultcollen","isSame","c1","c2","insertRow","deleteRow","hideRow","rowHeight","bottom","first_rowlen","defaultrowlen","r1","r2","deleteCell","dblclick","isPivotRange","values","showType","pivotDatas","addNewSheet","drillDown","luckysheetPaintModelOn","cancelPaintModel","addEventListener","stopPropagation","files","dataTransfer","type","indexOf","render","FileReader","readAsDataURL","onload","src","result","inserImg","hook","cellDragStop","handleCellDragStopEvent","on","overshow","jfautoscrollTimeout","sheetMousemove","moveState","functionResizeStatus","horizontalmoveState","horizontalmovestate","verticalmoveState","verticalmovestate","pivotTableMoveState","movestate","sheetMoveStatus","luckysheet_sheet_move_status","scrollStatus","rowsSelectedStatus","luckysheet_rows_selected_status","colsSelectedStatus","luckysheet_cols_selected_status","cellSelectedMove","luckysheet_cell_selected_move","cellSelectedExtend","luckysheet_cell_selected_extend","colsChangeSize","luckysheet_cols_change_size","rowsChangeSize","luckysheet_rows_change_size","chartMove","chartparam","luckysheetCurrentChartMove","chartResize","luckysheetCurrentChartResize","rangeResize","rangeMove","movepx","functionResizeData","mpx","calculatebarHeight","winh","background","cursor","functionResizeTimeout","columnHeaderHeight","windowHeight","cutVolumn","saveFreezen","rowHeaderWidth","windowWidth","movesave","abs","luckysheet_sheet_move_data","winW","curleft","offset","activeobject","widthlist","cursorobject","curindex","insertAfter","eq","insertBefore","each","outerWidth","luckysheet_model_move_state","winH","myh","luckysheet_model_move_obj","myw","luckysheet_model_xy","countfuncTimeout","mouseRender","stop","sleft","scrollFreezen","rangedrag","rangedrag_row","rangedrag_column","sheetBarHeight","statisticBarHeight","row_index_original","luckysheet_cell_selected_move_index","col_index_original","row_s","row_e","col_s","col_e","luckysheet_cell_selected_extend_index","luckysheet_cols_change_size_start","luckysheet_rows_change_size_start","luckysheetCurrentChartMoveObj","luckysheetCurrentChartMoveXy","luckysheetCurrentChartMoveWinH","luckysheetCurrentChartMoveWinW","scrollAdapt","toffset","tpsition","position","luckysheetCurrentChartResizeObj","topchange","luckysheetCurrentChartResizeXy","leftchange","luckysheetCurrentChartResizeWinW","luckysheetCurrentChartResizeWinH","resizedata","resizeChart","luckysheetCurrentChart","move","imgItem","images","currentImgId","isFixedPos","moveXY","minTop","maxTop","currentWinH","minLeft","maxLeft","currentWinW","infobarHeight","toolbarHeight","resizeXY","scaleX","crop","scaleY","defaultWidth","default","defaultHeight","offsetLeft","offsetTop","background-size","background-position","cropChange","cropChangeXY","fixedLeft","fixedTop","background-image","cropChangeObj","currentObj","outerHeight","rangeResizeDraging","rangeResizeObj","rangeResizexy","rangeResizeWinW","rangeResizeWinH","ch_width","rh_height","rangeMoveDraging","rangeMovexy","rangeMoveObj","chart_selection","sheetMouseup","pasteHandlerOfPaintModel","luckysheet_copy_save","luckysheetPaintSingle","removeAttr","removeClass","cancelFreezenHorizontal","createAssistCanvas","cancelFreezenVertical","remove","containerid","resetOrderby","obj","showvaluecolrow","$seleted","append","refreshPivotTable","reOrderAllSheet","luckysheetCurrentChartMoveTimeout","luckysheetInsertChartTosheetChange","myTop","myLeft","scrollLeft1","scrollTop1","chart_id","attr","jfredo","sheetIndex","myHeight","myWidth","myWidth1","myHeight1","rangeResizeDragged","moveImgItem","resizeImgItem","cropChangeImgItem","ps_id","ps_r","split","ps_c","d","deepCopyFlowData","rc","ps","value","ref","isshow","buildPs","addClass","editPs","size","changeRowIndex","changeRowSelected","select","row_select","some","ceil","moveChangeSize","clearjfundo","jfundo","ctrlType","curconfig","curImages","k","allImagesShow","firstcolumnlen","changeColumnIndex","changeColumnSelected","column_select","rangeMoveDragged","alert","noMerge","borderInfoCompute","RowlChange","cell","borderInfo","bd_rangeType","rangeType","bd_range","bd_emptyRange","j","concat","CFSplitRange","bd_r","bd_c","offsetMC","bd_obj","l","t","b","mc","rf","cf","cdformat","cdformat_cellrange","cellrange","emptyRange","copyRange","typeItemHide","applyType","applyRange","direction","affectPivot","hasMc","update","createIcon","luckysheet_cell_selected_extend_time","r0","c0","dropCellState","cell1","cell2","v","isNaN","tipInputNumber","tipInputNumberLimit","has_PartMC","noPartMerge","luckysheet_conditionformat_save","hasCF","cf_compute","getComputeMap","label","checksCF","noMulti","isSameRow","str_r","isSameCol","str_c","createPivotTable","locale_screenshot","screenshot","screenshotTipNoSelection","screenshotTipTitle","screenshotTipHasMulti","screenshotTipHasMerge","scrollHeight","scrollWidth","st_r","ed_r","st_c","ed_c","newCanvas","devicePixelRatio","ctx_newCanvas","beginPath","moveTo","lineTo","lineWidth","strokeStyle","stroke","closePath","Image","url","toDataURL","maxHeight","screenshotTipSuccess","dataURI","binStr","atob","len","arr","Uint8Array","charCodeAt","clickHandler","blob","Blob","element","createElement","setAttribute","URL","createObjectURL","screenshotImageName","body","appendChild","revokeObjectURL","href","removeAttribute","removeEventListener","removeChild","locale_splitText","splitText","tipNoMulti","createDialog","init","tipNoMultiColumn","file","currentTarget","trim","freezen","freezenCancel","saveFrozen","createFreezenHorizontal","createFreezenVertical","hidden","webkitHidden","msHidden","iscopyself","console","log","redo","undo","parents","dontupdate","open","myFolderUrl","chart_json","currentChart","$id","rangeArray","rangeSplitArray","content","rangeMoveIndex","rowtitle","coltitle","rangeRowCheck","exits","rangeColCheck","rangeResizeIndex","initialMenuButton","offsetWidth","offsetHeight","isPasteAction","blur","clipboardData","originalEvent","txtdata","getData","isEqual","cpDataArr","reg","RegExp","reg2","regArr","match","cpRowArr","reg2Arr","cpValue","copy_r1","copy_r2","copy_c1","copy_c2","copy_index","rs","ct","fa","m","locale_fontjson","fontjson","luckysheet_paste_iscut","pasteHandlerOfCutPaste","clearcopy","pasteHandlerOfCopyPaste","pasteImgItem","Array","colLen","colspan","$td","txt","mask","bg","bl","it","ffs","toLowerCase","ff","fs","floor","fc","ht","vt","rowspan","r_ab","c_ab","rp","cp","bt","color","borderconfig","getQKBorder","bb","br","first","cs","luckysheet_selection_range","pasteHandler","empty","execCommand","enablePage","queryExps","pageInfo","reportId","fields","mobile","frezon","currentPage","pageUrl","totalPage","addDataAjax","pageIndex","pageInfoFull","total"],"mappings":"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","file":"../../controllers/handler.js","sourcesContent":["define([\n    './mobile',\n    './luckysheetConfigsetting',\n    './freezen',\n    './pivotTable',\n    './dropCell',\n    './postil',\n    './imageCtrl',\n    './hyperlinkCtrl',\n    './dataVerificationCtrl',\n    './menuButton',\n    './conditionformat',\n    './alternateformat',\n    './ifFormulaGenerator',\n    './sheetmanage',\n    './server',\n    './updateCell',\n    './sheetSearch',\n    './resize',\n    './sheetMove',\n    './select',\n    './selection',\n    './controlHistory',\n    './splitColumn',\n    '../global/cursorPos',\n    './constant',\n    './protection',\n    './cellFormat',\n    '../utils/util',\n    '../methods/get',\n    '../global/location',\n    '../global/getRowlen',\n    '../global/validate',\n    '../global/count',\n    '../global/browser',\n    '../global/formula',\n    '../global/extend',\n    '../global/scroll',\n    '../global/refresh',\n    '../global/getdata',\n    '../global/tooltip',\n    '../global/editor',\n    '../global/format',\n    '../global/method',\n    '../global/border',\n    '../global/draw',\n    '../locale/locale',\n    '../store',\n    '../expendPlugins/chart/plugin'\n], function (mobileinit, luckysheetConfigsetting, luckysheetFreezen, pivotTable, luckysheetDropCell, luckysheetPostil, imageCtrl, hyperlinkCtrl, dataVerificationCtrl, menuButton, conditionformat, alternateformat, ifFormulaGenerator, sheetmanage, server, m_updateCell, m_sheetSearch, luckysheetsizeauto, m_sheetMove, m_select, selection, controlHistory, splitColumn, m_cursorPos, m_constant, m_protection, m_cellFormat, m_util, m_get, m_location, m_getRowlen, m_validate, m_count, browser, formula, m_extend, luckysheetscrollevent, m_refresh, m_getdata, tooltip, editor, m_format, method, m_border, m_draw, locale, Store, m_plugin) {\n    'use strict';\n    const {luckysheetupdateCell} = m_updateCell;\n    const {luckysheet_searcharray} = m_sheetSearch;\n    const {luckysheetMoveHighlightCell} = m_sheetMove;\n    const {selectHightlightShow, selectIsOverlap, selectionCopyShow, luckysheet_count_show, selectHelpboxFill} = m_select;\n    const {hideMenuByCancel} = m_cursorPos;\n    const {luckysheetdefaultstyle} = m_constant;\n    const {checkProtectionLockedRangeList, checkProtectionAllSelected, checkProtectionSelectLockedOrUnLockedCells, checkProtectionNotEnable, checkProtectionAuthorityNormal} = m_protection;\n    const {openCellFormatModel} = m_cellFormat;\n    const {replaceHtml, getObjType, chatatABC, ArrayUnique, showrightclickmenu, luckysheetactiveCell, luckysheetContainerFocus, $$} = m_util;\n    const {getSheetIndex, getRangetxt} = m_get;\n    const {rowLocation, colLocation, mouseposition} = m_location;\n    const {rowlenByRange} = m_getRowlen;\n    const {isRealNull, hasPartMC, isEditMode} = m_validate;\n    const {countfunc} = m_count;\n    const {luckysheetextendtable} = m_extend;\n    const {jfrefreshgrid, jfrefreshgrid_rhcw, luckysheetrefreshgrid} = m_refresh;\n    const {getdatabyselection, datagridgrowth} = m_getdata;\n    const {genarate} = m_format;\n    const {getBorderInfoCompute} = m_border;\n    const {luckysheetDrawMain} = m_draw;\n    const {createLuckyChart, hideAllNeedRangeShow} = m_plugin;\n    //, columeflowset, rowflowset\n    return function luckysheetHandler() {\n        const os = browser.detectOS(), isMobile = browser.mobilecheck();    //移动端\n        //移动端\n        if (isMobile) {\n            mobileinit();\n        }\n        if (!Date.now)\n            Date.now = function () {\n                return new Date().getTime();\n            };    //requestAnimationFrame method\n        //requestAnimationFrame method\n        (function () {\n            'use strict';\n            var vendors = [\n                'webkit',\n                'moz'\n            ];\n            for (var i = 0; i < vendors.length && !window.requestAnimationFrame; ++i) {\n                var vp = vendors[i];\n                window.requestAnimationFrame = window[vp + 'RequestAnimationFrame'];\n                window.cancelAnimationFrame = window[vp + 'CancelAnimationFrame'] || window[vp + 'CancelRequestAnimationFrame'];\n            }\n            if (/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)    // iOS6 is buggy\n|| // iOS6 is buggy\n                !window.requestAnimationFrame || !window.cancelAnimationFrame) {\n                var lastTime = 0;\n                window.requestAnimationFrame = function (callback) {\n                    var now = Date.now();\n                    var nextTime = Math.max(lastTime + 16, now);\n                    return setTimeout(function () {\n                        callback(lastTime = nextTime);\n                    }, nextTime - now);\n                };\n                window.cancelAnimationFrame = clearTimeout;\n            }\n        }());\n        $('#luckysheet-sheet-container-c').mousewheel(function (event, delta) {\n            let scrollNum = event.deltaFactor < 40 ? 1 : event.deltaFactor < 80 ? 2 : 3;\n            let scrollLeft = $(this).scrollLeft();\n            if (event.deltaY != 0) {\n                if (event.deltaY < 0) {\n                    scrollLeft = scrollLeft + 10 * scrollNum;\n                } else {\n                    scrollLeft = scrollLeft - 10 * scrollNum;\n                }\n            } else if (event.deltaX != 0) {\n                if (event.deltaX > 0) {\n                    scrollLeft = scrollLeft + 10 * scrollNum;\n                } else {\n                    scrollLeft = scrollLeft - 10 * scrollNum;\n                }\n            }\n            $(this).scrollLeft(scrollLeft);\n            event.preventDefault();\n        });    //滚动监听\n        //滚动监听\n        $('#luckysheet-cell-main').scroll(function () {\n        }).mousewheel(function (event, delta) {\n            event.preventDefault();\n        });\n        const _locale = locale();\n        const locale_drag = _locale.drag;\n        const locale_info = _locale.info;\n        let prev, mousewheelArrayUniqueTimeout;\n        $('#luckysheet-grid-window-1').mousewheel(function (event, delta) {\n            let scrollLeft = $('#luckysheet-scrollbar-x').scrollLeft(), scrollTop = $('#luckysheet-scrollbar-y').scrollTop();\n            let visibledatacolumn_c = Store.visibledatacolumn, visibledatarow_c = Store.visibledatarow;\n            if (luckysheetFreezen.freezenhorizontaldata != null) {\n                visibledatarow_c = luckysheetFreezen.freezenhorizontaldata[3];\n            }\n            if (luckysheetFreezen.freezenverticaldata != null) {\n                visibledatacolumn_c = luckysheetFreezen.freezenverticaldata[3];\n            }\n            clearTimeout(mousewheelArrayUniqueTimeout);    // if(Store.visibledatacolumn.length!=visibledatacolumn_c.length){\n            // if(Store.visibledatacolumn.length!=visibledatacolumn_c.length){\n            if (Store.visibledatacolumn_unique != null) {\n                visibledatacolumn_c = Store.visibledatacolumn_unique;\n            } else {\n                visibledatacolumn_c = ArrayUnique(visibledatacolumn_c);\n                Store.visibledatacolumn_unique = visibledatacolumn_c;\n            }    // }\n                 // if(Store.visibledatarow.length!=visibledatarow_c.length){\n            // }\n            // if(Store.visibledatarow.length!=visibledatarow_c.length){\n            if (Store.visibledatarow_unique != null) {\n                visibledatarow_c = Store.visibledatarow_unique;\n            } else {\n                visibledatarow_c = ArrayUnique(visibledatarow_c);\n                Store.visibledatarow_unique = visibledatarow_c;\n            }    // }\n                 // visibledatacolumn_c = ArrayUnique(visibledatacolumn_c);\n                 // visibledatarow_c = ArrayUnique(visibledatarow_c);\n            // }\n            // visibledatacolumn_c = ArrayUnique(visibledatacolumn_c);\n            // visibledatarow_c = ArrayUnique(visibledatarow_c);\n            let col_st = luckysheet_searcharray(visibledatacolumn_c, scrollLeft);\n            let row_st = luckysheet_searcharray(visibledatarow_c, scrollTop);\n            if (luckysheetFreezen.freezenhorizontaldata != null) {\n                row_st = luckysheet_searcharray(visibledatarow_c, scrollTop + luckysheetFreezen.freezenhorizontaldata[0]);\n            }\n            let colscroll = 0;\n            let rowscroll = 0;\n            let scrollNum = event.deltaFactor < 40 ? 1 : event.deltaFactor < 80 ? 2 : 3;    //一次滚动三行或三列\n            //一次滚动三行或三列\n            if (event.deltaY != 0) {\n                let row_ed, step = Math.round(scrollNum / Store.zoomRatio);\n                step = step < 1 ? 1 : step;\n                if (event.deltaY < 0) {\n                    row_ed = row_st + step;\n                    if (row_ed >= visibledatarow_c.length) {\n                        row_ed = visibledatarow_c.length - 1;\n                    }\n                } else {\n                    row_ed = row_st - step;\n                    if (row_ed < 0) {\n                        row_ed = 0;\n                    }\n                }\n                rowscroll = row_ed == 0 ? 0 : visibledatarow_c[row_ed - 1];\n                if (luckysheetFreezen.freezenhorizontaldata != null) {\n                    rowscroll -= luckysheetFreezen.freezenhorizontaldata[0];\n                }\n                $('#luckysheet-scrollbar-y').scrollTop(rowscroll);\n            } else if (event.deltaX != 0) {\n                let col_ed;    // if((isMac && event.deltaX >0 ) || (!isMac && event.deltaX < 0)){\n                // if((isMac && event.deltaX >0 ) || (!isMac && event.deltaX < 0)){\n                if (event.deltaX > 0) {\n                    scrollLeft = scrollLeft + 20 * Store.zoomRatio;    // if(col_ed >= visibledatacolumn_c.length){\n                                                                       //     col_ed = visibledatacolumn_c.length - 1;\n                                                                       // }\n                } else\n                    // if(col_ed >= visibledatacolumn_c.length){\n                    //     col_ed = visibledatacolumn_c.length - 1;\n                    // }\n                    {\n                        scrollLeft = scrollLeft - 20 * Store.zoomRatio;    // if(col_ed < 0){\n                                                                           //     col_ed = 0;\n                                                                           // }\n                    }    // colscroll = col_ed == 0 ? 0 : visibledatacolumn_c[col_ed - 1];\n                // if(col_ed < 0){\n                //     col_ed = 0;\n                // }\n                // colscroll = col_ed == 0 ? 0 : visibledatacolumn_c[col_ed - 1];\n                $('#luckysheet-scrollbar-x').scrollLeft(scrollLeft);\n            }\n            mousewheelArrayUniqueTimeout = setTimeout(() => {\n                Store.visibledatacolumn_unique = null;\n                Store.visibledatarow_unique = null;\n            }, 500);\n        });\n        $('#luckysheet-scrollbar-x').scroll(function () {\n            // setTimeout(function(){\n            luckysheetscrollevent();    // },10); \n        }).mousewheel(function (event, delta) {\n            event.preventDefault();\n        });\n        $('#luckysheet-scrollbar-y').scroll(function () {\n            // setTimeout(function(){\n            luckysheetscrollevent();    // },10);\n        }).mousewheel(function (event, delta) {\n            event.preventDefault();\n        });    //页面resize\n        //页面resize\n        $(window).resize(function () {\n            let luckysheetDocument = document.getElementById(Store.container);\n            if (luckysheetDocument) {\n                luckysheetsizeauto();\n            }\n        });\n        $('#luckysheet-rich-text-editor').mouseup(function (e) {\n            menuButton.inputMenuButtonFocus(e.target);\n        });    //表格mousedown\n        //表格mousedown\n        $('#luckysheet-cell-main, #luckysheetTableContent').mousedown(function (event) {\n            if ($(event.target).hasClass('luckysheet-mousedown-cancel')) {\n                return;\n            }    // 协同编辑其他用户不在操作的时候，用户名框隐藏\n            // 协同编辑其他用户不在操作的时候，用户名框隐藏\n            hideUsername();\n            $('#luckysheet-cell-selected').find('.luckysheet-cs-fillhandle').css('cursor', 'default').end().find('.luckysheet-cs-draghandle').css('cursor', 'default');\n            $('#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0').css('cursor', 'default');    //有批注在编辑时\n            //有批注在编辑时\n            luckysheetPostil.removeActivePs();    //图片 active/cropping\n            //图片 active/cropping\n            if ($('#luckysheet-modal-dialog-activeImage').is(':visible') || $('#luckysheet-modal-dialog-cropping').is(':visible')) {\n                imageCtrl.cancelActiveImgItem();\n            }    //luckysheetautoadjustmousedown = 1;\n            //luckysheetautoadjustmousedown = 1;\n            let mouse = mouseposition(event.pageX, event.pageY);\n            if (mouse[0] >= Store.cellmainWidth - Store.cellMainSrollBarSize || mouse[1] >= Store.cellmainHeight - Store.cellMainSrollBarSize) {\n                return;\n            }\n            let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n            let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n            if (luckysheetFreezen.freezenverticaldata != null && mouse[0] < luckysheetFreezen.freezenverticaldata[0] - luckysheetFreezen.freezenverticaldata[2]) {\n                x = mouse[0] + luckysheetFreezen.freezenverticaldata[2];\n            }\n            if (luckysheetFreezen.freezenhorizontaldata != null && mouse[1] < luckysheetFreezen.freezenhorizontaldata[0] - luckysheetFreezen.freezenhorizontaldata[2]) {\n                y = mouse[1] + luckysheetFreezen.freezenhorizontaldata[2];\n            }\n            let sheetFile = sheetmanage.getSheetByIndex();\n            let luckysheetTableContent = $('#luckysheetTableContent').get(0).getContext('2d');\n            let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n            let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n            let row_index_ed = row_index, col_index_ed = col_index;\n            let margeset = menuButton.mergeborer(Store.flowdata, row_index, col_index);\n            if (!!margeset) {\n                row = margeset.row[1];\n                row_pre = margeset.row[0];\n                row_index = margeset.row[2];\n                row_index_ed = margeset.row[3];\n                col = margeset.column[1];\n                col_pre = margeset.column[0];\n                col_index = margeset.column[2];\n                col_index_ed = margeset.column[3];\n            }    //单元格单击之前\n            //单元格单击之前\n            if (!method.createHookFunction('cellMousedownBefore', Store.flowdata[row_index][col_index], {\n                    r: row_index,\n                    c: col_index,\n                    'start_r': row_pre,\n                    'start_c': col_pre,\n                    'end_r': row,\n                    'end_c': col\n                }, sheetFile, luckysheetTableContent)) {\n                return;\n            }    //数据验证 单元格聚焦\n            //数据验证 单元格聚焦\n            dataVerificationCtrl.cellFocus(row_index, col_index, true);    //若点击单元格部分不在视图内\n            //若点击单元格部分不在视图内\n            if (col_pre < $('#luckysheet-cell-main').scrollLeft()) {\n                $('#luckysheet-scrollbar-x').scrollLeft(col_pre);\n            }\n            if (row_pre < $('#luckysheet-cell-main').scrollTop()) {\n                $('#luckysheet-scrollbar-y').scrollTop(row_pre);\n            }    //mousedown是右键\n            //mousedown是右键\n            if (event.which == '3') {\n                $('#luckysheet-dataVerification-showHintBox').hide();\n                let isright = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    if (Store.luckysheet_select_save[s]['row'] != null && (row_index >= Store.luckysheet_select_save[s]['row'][0] && row_index <= Store.luckysheet_select_save[s]['row'][1] && col_index >= Store.luckysheet_select_save[s]['column'][0] && col_index <= Store.luckysheet_select_save[s]['column'][1])) {\n                        isright = true;\n                        break;\n                    }\n                }\n                if (isright) {\n                    return;\n                }\n            }    //单元格数据下钻\n            //单元格数据下钻\n            if (Store.flowdata[row_index] != null && Store.flowdata[row_index][col_index] != null && Store.flowdata[row_index][col_index].dd != null) {\n                if (luckysheetConfigsetting.fireMousedown != null && getObjType(luckysheetConfigsetting.fireMousedown) == 'function') {\n                    luckysheetConfigsetting.fireMousedown(Store.flowdata[row_index][col_index].dd);\n                    return;\n                }\n            }    //链接 单元格聚焦\n            //链接 单元格聚焦\n            if (hyperlinkCtrl.hyperlink && hyperlinkCtrl.hyperlink[row_index + '_' + col_index] && event.which != '3') {\n                hyperlinkCtrl.cellFocus(row_index, col_index);\n                return;\n            }\n            Store.luckysheet_scroll_status = true;    //公式相关\n            //公式相关\n            let $input = $('#luckysheet-input-box');\n            if (parseInt($input.css('top')) > 0) {\n                if (formula.rangestart || formula.rangedrag_column_start || formula.rangedrag_row_start || formula.israngeseleciton()) {\n                    //公式选区\n                    let rowseleted = [\n                        row_index,\n                        row_index_ed\n                    ];\n                    let columnseleted = [\n                        col_index,\n                        col_index_ed\n                    ];\n                    let left = col_pre;\n                    let width = col - col_pre - 1;\n                    let top = row_pre;\n                    let height = row - row_pre - 1;\n                    if (event.shiftKey) {\n                        let last = formula.func_selectedrange;\n                        let top = 0, height = 0, rowseleted = [];\n                        if (last.top > row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            if (last.row[1] > last.row_focus) {\n                                last.row[1] = last.row_focus;\n                            }\n                            rowseleted = [\n                                row_index,\n                                last.row[1]\n                            ];\n                        } else if (last.top == row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            rowseleted = [\n                                row_index,\n                                last.row[0]\n                            ];\n                        } else {\n                            top = last.top;\n                            height = row - last.top - 1;\n                            if (last.row[0] < last.row_focus) {\n                                last.row[0] = last.row_focus;\n                            }\n                            rowseleted = [\n                                last.row[0],\n                                row_index\n                            ];\n                        }\n                        let left = 0, width = 0, columnseleted = [];\n                        if (last.left > col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            if (last.column[1] > last.column_focus) {\n                                last.column[1] = last.column_focus;\n                            }\n                            columnseleted = [\n                                col_index,\n                                last.column[1]\n                            ];\n                        } else if (last.left == col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            columnseleted = [\n                                col_index,\n                                last.column[0]\n                            ];\n                        } else {\n                            left = last.left;\n                            width = col - last.left - 1;\n                            if (last.column[0] < last.column_focus) {\n                                last.column[0] = last.column_focus;\n                            }\n                            columnseleted = [\n                                last.column[0],\n                                col_index\n                            ];\n                        }\n                        let changeparam = menuButton.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                        if (changeparam != null) {\n                            columnseleted = changeparam[0];\n                            rowseleted = changeparam[1];\n                            top = changeparam[2];\n                            height = changeparam[3];\n                            left = changeparam[4];\n                            width = changeparam[5];\n                        }\n                        luckysheet_count_show(left, top, width, height, rowseleted, columnseleted);\n                        last['row'] = rowseleted;\n                        last['column'] = columnseleted;\n                        last['left_move'] = left;\n                        last['width_move'] = width;\n                        last['top_move'] = top;\n                        last['height_move'] = height;\n                        formula.func_selectedrange = last;\n                    } else if (event.ctrlKey && $('#luckysheet-rich-text-editor').find('span').last().text() != ',') {\n                        //按住ctrl 选择选区时  先处理上一个选区\n                        let vText = $('#luckysheet-rich-text-editor').text();\n                        if (vText.length > 0) {\n                            let lastWord = vText.substr(vText.length - 1, 1);\n                            if (lastWord != ',' && lastWord != '=' && lastWord != '(') {\n                                vText += ',';\n                            }\n                        }\n                        if (vText.length > 0 && vText.substr(0, 1) == '=') {\n                            vText = formula.functionHTMLGenerate(vText);\n                            if (window.getSelection) {\n                                // all browsers, except IE before version 9\n                                let currSelection = window.getSelection();\n                                formula.functionRangeIndex = [\n                                    $(currSelection.anchorNode).parent().index(),\n                                    currSelection.anchorOffset\n                                ];\n                            } else {\n                                // Internet Explorer before version 9\n                                let textRange = document.selection.createRange();\n                                formula.functionRangeIndex = textRange;\n                            }\n                            $('#luckysheet-rich-text-editor').html(vText);\n                            formula.canceFunctionrangeSelected();\n                            formula.createRangeHightlight();\n                        }\n                        formula.rangestart = false;\n                        formula.rangedrag_column_start = false;\n                        formula.rangedrag_row_start = false;\n                        $('#luckysheet-functionbox-cell').html(vText);\n                        formula.rangeHightlightselected($('#luckysheet-rich-text-editor'));    //再进行 选区的选择\n                        //再进行 选区的选择\n                        formula.israngeseleciton();\n                        formula.func_selectedrange = {\n                            'left': left,\n                            'width': width,\n                            'top': top,\n                            'height': height,\n                            'left_move': left,\n                            'width_move': width,\n                            'top_move': top,\n                            'height_move': height,\n                            'row': rowseleted,\n                            'column': columnseleted,\n                            'row_focus': row_index,\n                            'column_focus': col_index\n                        };\n                    } else {\n                        formula.func_selectedrange = {\n                            'left': left,\n                            'width': width,\n                            'top': top,\n                            'height': height,\n                            'left_move': left,\n                            'width_move': width,\n                            'top_move': top,\n                            'height_move': height,\n                            'row': rowseleted,\n                            'column': columnseleted,\n                            'row_focus': row_index,\n                            'column_focus': col_index\n                        };\n                    }\n                    formula.rangeSetValue({\n                        'row': rowseleted,\n                        'column': columnseleted\n                    });\n                    formula.rangestart = true;\n                    formula.rangedrag_column_start = false;\n                    formula.rangedrag_row_start = false;\n                    $('#luckysheet-formula-functionrange-select').css({\n                        'left': left,\n                        'width': width,\n                        'top': top,\n                        'height': height\n                    }).show();\n                    $('#luckysheet-formula-help-c').hide();\n                    luckysheet_count_show(left, top, width, height, rowseleted, columnseleted);\n                    setTimeout(function () {\n                        let currSelection = window.getSelection();\n                        let anchorOffset = currSelection.anchorNode;\n                        let $editor;\n                        if ($('#luckysheet-search-formula-parm').is(':visible') || $('#luckysheet-search-formula-parm-select').is(':visible')) {\n                            $editor = $('#luckysheet-rich-text-editor');\n                            formula.rangechangeindex = formula.data_parm_index;\n                        } else {\n                            $editor = $(anchorOffset).closest('div');\n                        }\n                        let $span = $editor.find(\"span[rangeindex='\" + formula.rangechangeindex + \"']\");\n                        formula.setCaretPosition($span.get(0), 0, $span.html().length);\n                    }, 1);\n                    return;\n                } else {\n                    formula.updatecell(Store.luckysheetCellUpdate[0], Store.luckysheetCellUpdate[1]);\n                    Store.luckysheet_select_status = true;\n                    if ($('#luckysheet-info').is(':visible')) {\n                        Store.luckysheet_select_status = false;\n                    }\n                }\n            } else {\n                if (checkProtectionSelectLockedOrUnLockedCells(row_index, col_index, Store.currentSheetIndex)) {\n                    Store.luckysheet_select_status = true;\n                }\n            }    //条件格式 应用范围可选择多个单元格\n            //条件格式 应用范围可选择多个单元格\n            if ($('#luckysheet-multiRange-dialog').is(':visible')) {\n                conditionformat.selectStatus = true;\n                Store.luckysheet_select_status = false;\n                if (event.shiftKey) {\n                    let last = conditionformat.selectRange[conditionformat.selectRange.length - 1];\n                    let top = 0, height = 0, rowseleted = [];\n                    if (last.top > row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        if (last.row[1] > last.row_focus) {\n                            last.row[1] = last.row_focus;\n                        }\n                        rowseleted = [\n                            row_index,\n                            last.row[1]\n                        ];\n                    } else if (last.top == row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        rowseleted = [\n                            row_index,\n                            last.row[0]\n                        ];\n                    } else {\n                        top = last.top;\n                        height = row - last.top - 1;\n                        if (last.row[0] < last.row_focus) {\n                            last.row[0] = last.row_focus;\n                        }\n                        rowseleted = [\n                            last.row[0],\n                            row_index\n                        ];\n                    }\n                    let left = 0, width = 0, columnseleted = [];\n                    if (last.left > col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        if (last.column[1] > last.column_focus) {\n                            last.column[1] = last.column_focus;\n                        }\n                        columnseleted = [\n                            col_index,\n                            last.column[1]\n                        ];\n                    } else if (last.left == col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        columnseleted = [\n                            col_index,\n                            last.column[0]\n                        ];\n                    } else {\n                        left = last.left;\n                        width = col - last.left - 1;\n                        if (last.column[0] < last.column_focus) {\n                            last.column[0] = last.column_focus;\n                        }\n                        columnseleted = [\n                            last.column[0],\n                            col_index\n                        ];\n                    }\n                    let changeparam = menuButton.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                    if (changeparam != null) {\n                        columnseleted = changeparam[0];\n                        rowseleted = changeparam[1];\n                        top = changeparam[2];\n                        height = changeparam[3];\n                        left = changeparam[4];\n                        width = changeparam[5];\n                    }\n                    last['row'] = rowseleted;\n                    last['column'] = columnseleted;\n                    last['left_move'] = left;\n                    last['width_move'] = width;\n                    last['top_move'] = top;\n                    last['height_move'] = height;\n                    conditionformat.selectRange[conditionformat.selectRange.length - 1] = last;\n                } else if (event.ctrlKey) {\n                    conditionformat.selectRange.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            row_index,\n                            row_index_ed\n                        ],\n                        'column': [\n                            col_index,\n                            col_index_ed\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': col_index\n                    });\n                } else {\n                    conditionformat.selectRange = [];\n                    conditionformat.selectRange.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            row_index,\n                            row_index_ed\n                        ],\n                        'column': [\n                            col_index,\n                            col_index_ed\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': col_index\n                    });\n                }\n                selectionCopyShow(conditionformat.selectRange);\n                let range = conditionformat.getTxtByRange(conditionformat.selectRange);\n                $('#luckysheet-multiRange-dialog input').val(range);\n                return;\n            } else {\n                conditionformat.selectStatus = false;\n                conditionformat.selectRange = [];\n            }    //条件格式 条件值只能选择单个单元格\n            //条件格式 条件值只能选择单个单元格\n            if ($('#luckysheet-singleRange-dialog').is(':visible')) {\n                Store.luckysheet_select_status = false;\n                selectionCopyShow([{\n                        'row': [\n                            row_index,\n                            row_index\n                        ],\n                        'column': [\n                            col_index,\n                            col_index\n                        ]\n                    }]);\n                let range = getRangetxt(Store.currentSheetIndex, {\n                    'row': [\n                        row_index,\n                        row_index\n                    ],\n                    'column': [\n                        col_index,\n                        col_index\n                    ]\n                }, Store.currentSheetIndex);\n                $('#luckysheet-singleRange-dialog input').val(range);\n                return;\n            }    //数据验证 单元格范围选择\n            //数据验证 单元格范围选择\n            if ($('#luckysheet-dataVerificationRange-dialog').is(':visible')) {\n                dataVerificationCtrl.selectStatus = true;\n                Store.luckysheet_select_status = false;\n                if (event.shiftKey) {\n                    let last = dataVerificationCtrl.selectRange[dataVerificationCtrl.selectRange.length - 1];\n                    let top = 0, height = 0, rowseleted = [];\n                    if (last.top > row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        if (last.row[1] > last.row_focus) {\n                            last.row[1] = last.row_focus;\n                        }\n                        rowseleted = [\n                            row_index,\n                            last.row[1]\n                        ];\n                    } else if (last.top == row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        rowseleted = [\n                            row_index,\n                            last.row[0]\n                        ];\n                    } else {\n                        top = last.top;\n                        height = row - last.top - 1;\n                        if (last.row[0] < last.row_focus) {\n                            last.row[0] = last.row_focus;\n                        }\n                        rowseleted = [\n                            last.row[0],\n                            row_index\n                        ];\n                    }\n                    let left = 0, width = 0, columnseleted = [];\n                    if (last.left > col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        if (last.column[1] > last.column_focus) {\n                            last.column[1] = last.column_focus;\n                        }\n                        columnseleted = [\n                            col_index,\n                            last.column[1]\n                        ];\n                    } else if (last.left == col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        columnseleted = [\n                            col_index,\n                            last.column[0]\n                        ];\n                    } else {\n                        left = last.left;\n                        width = col - last.left - 1;\n                        if (last.column[0] < last.column_focus) {\n                            last.column[0] = last.column_focus;\n                        }\n                        columnseleted = [\n                            last.column[0],\n                            col_index\n                        ];\n                    }\n                    let changeparam = menuButton.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                    if (changeparam != null) {\n                        columnseleted = changeparam[0];\n                        rowseleted = changeparam[1];\n                        top = changeparam[2];\n                        height = changeparam[3];\n                        left = changeparam[4];\n                        width = changeparam[5];\n                    }\n                    last['row'] = rowseleted;\n                    last['column'] = columnseleted;\n                    last['left_move'] = left;\n                    last['width_move'] = width;\n                    last['top_move'] = top;\n                    last['height_move'] = height;\n                    dataVerificationCtrl.selectRange[dataVerificationCtrl.selectRange.length - 1] = last;\n                } else {\n                    dataVerificationCtrl.selectRange = [];\n                    dataVerificationCtrl.selectRange.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            row_index,\n                            row_index_ed\n                        ],\n                        'column': [\n                            col_index,\n                            col_index_ed\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': col_index\n                    });\n                }\n                selectionCopyShow(dataVerificationCtrl.selectRange);\n                let range = dataVerificationCtrl.getTxtByRange(dataVerificationCtrl.selectRange);\n                if (formula.rangetosheet != Store.currentSheetIndex) {\n                    range = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].name + '!' + range;\n                }\n                $('#luckysheet-dataVerificationRange-dialog input').val(range);\n                return;\n            } else {\n                dataVerificationCtrl.selectStatus = false;\n                dataVerificationCtrl.selectRange = [];\n            }    //if公式生成器\n            //if公式生成器\n            if (ifFormulaGenerator.singleRangeFocus) {\n                $('#luckysheet-ifFormulaGenerator-dialog .singRange').click();\n            }\n            if ($('#luckysheet-ifFormulaGenerator-singleRange-dialog').is(':visible')) {\n                //选择单个单元格\n                Store.luckysheet_select_status = false;\n                formula.rangestart = false;\n                $('#luckysheet-formula-functionrange-select').css({\n                    'left': col_pre,\n                    'width': col - col_pre - 1,\n                    'top': row_pre,\n                    'height': row - row_pre - 1\n                }).show();\n                $('#luckysheet-formula-help-c').hide();\n                let range = getRangetxt(Store.currentSheetIndex, {\n                    'row': [\n                        row_index,\n                        row_index\n                    ],\n                    'column': [\n                        col_index,\n                        col_index\n                    ]\n                }, Store.currentSheetIndex);\n                $('#luckysheet-ifFormulaGenerator-singleRange-dialog input').val(range);\n                return;\n            }\n            if ($('#luckysheet-ifFormulaGenerator-multiRange-dialog').is(':visible')) {\n                //选择范围\n                Store.luckysheet_select_status = false;\n                formula.func_selectedrange = {\n                    'left': col_pre,\n                    'width': col - col_pre - 1,\n                    'top': row_pre,\n                    'height': row - row_pre - 1,\n                    'left_move': col_pre,\n                    'width_move': col - col_pre - 1,\n                    'top_move': row_pre,\n                    'height_move': row - row_pre - 1,\n                    'row': [\n                        row_index,\n                        row_index\n                    ],\n                    'column': [\n                        col_index,\n                        col_index\n                    ],\n                    'row_focus': row_index,\n                    'column_focus': col_index\n                };\n                formula.rangestart = true;\n                $('#luckysheet-formula-functionrange-select').css({\n                    'left': col_pre,\n                    'width': col - col_pre - 1,\n                    'top': row_pre,\n                    'height': row - row_pre - 1\n                }).show();\n                $('#luckysheet-formula-help-c').hide();\n                let range = getRangetxt(Store.currentSheetIndex, {\n                    'row': [\n                        row_index,\n                        row_index\n                    ],\n                    'column': [\n                        col_index,\n                        col_index\n                    ]\n                }, Store.currentSheetIndex);\n                $('#luckysheet-ifFormulaGenerator-multiRange-dialog input').val(range);\n                $('#luckysheet-row-count-show').hide();\n                $('#luckysheet-column-count-show').hide();\n                return;\n            }\n            if (Store.luckysheet_select_status) {\n                if (event.shiftKey) {\n                    //按住shift点击，选择范围\n                    let last = $.extend(true, {}, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]);    //选区最后一个\n                    //选区最后一个\n                    let top = 0, height = 0, rowseleted = [];\n                    if (last.top > row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        if (last.row[1] > last.row_focus) {\n                            last.row[1] = last.row_focus;\n                        }\n                        rowseleted = [\n                            row_index,\n                            last.row[1]\n                        ];\n                    } else if (last.top == row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        rowseleted = [\n                            row_index,\n                            last.row[0]\n                        ];\n                    } else {\n                        top = last.top;\n                        height = row - last.top - 1;\n                        if (last.row[0] < last.row_focus) {\n                            last.row[0] = last.row_focus;\n                        }\n                        rowseleted = [\n                            last.row[0],\n                            row_index\n                        ];\n                    }\n                    let left = 0, width = 0, columnseleted = [];\n                    if (last.left > col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        if (last.column[1] > last.column_focus) {\n                            last.column[1] = last.column_focus;\n                        }\n                        columnseleted = [\n                            col_index,\n                            last.column[1]\n                        ];\n                    } else if (last.left == col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        columnseleted = [\n                            col_index,\n                            last.column[0]\n                        ];\n                    } else {\n                        left = last.left;\n                        width = col - last.left - 1;\n                        if (last.column[0] < last.column_focus) {\n                            last.column[0] = last.column_focus;\n                        }\n                        columnseleted = [\n                            last.column[0],\n                            col_index\n                        ];\n                    }\n                    let changeparam = menuButton.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                    if (changeparam != null) {\n                        columnseleted = changeparam[0];\n                        rowseleted = changeparam[1];\n                        top = changeparam[2];\n                        height = changeparam[3];\n                        left = changeparam[4];\n                        width = changeparam[5];\n                    }\n                    last['row'] = rowseleted;\n                    last['column'] = columnseleted;\n                    last['left_move'] = left;\n                    last['width_move'] = width;\n                    last['top_move'] = top;\n                    last['height_move'] = height;\n                    Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1] = last;    //交替颜色选择范围\n                    //交替颜色选择范围\n                    if ($('#luckysheet-alternateformat-rangeDialog').is(':visible')) {\n                        $('#luckysheet-alternateformat-rangeDialog input').val(getRangetxt(Store.currentSheetIndex, Store.luckysheet_select_save));\n                    }\n                    if (pivotTable.luckysheet_pivotTable_select_state) {\n                        $('#luckysheet-pivotTable-range-selection-input').val(Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].name + '!' + chatatABC(Store.luckysheet_select_save[0]['column'][0]) + (Store.luckysheet_select_save[0]['row'][0] + 1) + ':' + chatatABC(Store.luckysheet_select_save[0]['column'][1]) + (Store.luckysheet_select_save[0]['row'][1] + 1));\n                    }\n                } else if (event.ctrlKey) {\n                    //选区添加\n                    Store.luckysheet_select_save.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            row_index,\n                            row_index_ed\n                        ],\n                        'column': [\n                            col_index,\n                            col_index_ed\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': col_index\n                    });\n                } else {\n                    Store.luckysheet_select_save.length = 0;\n                    Store.luckysheet_select_save.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            row_index,\n                            row_index_ed\n                        ],\n                        'column': [\n                            col_index,\n                            col_index_ed\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': col_index\n                    });    //单元格格式icon对应\n                    //单元格格式icon对应\n                    menuButton.menuButtonFocus(Store.flowdata, row_index, col_index);    //函数公式显示栏\n                    //函数公式显示栏\n                    formula.fucntionboxshow(row_index, col_index);\n                }\n                selectHightlightShow();\n                if (luckysheetFreezen.freezenhorizontaldata != null || luckysheetFreezen.freezenverticaldata != null) {\n                    luckysheetFreezen.scrollAdaptOfselect();\n                }\n                if (!browser.mobilecheck()) {\n                    //非移动端聚焦输入框\n                    luckysheetactiveCell();\n                }    //允许编辑后的后台更新时\n                //允许编辑后的后台更新时\n                server.saveParam('mv', Store.currentSheetIndex, Store.luckysheet_select_save);\n            }    //交替颜色\n            //交替颜色\n            if (alternateformat.rangefocus) {\n                alternateformat.rangefocus = false;\n                $('#luckysheet-alternateformat-range .fa-table').click();\n            }\n            $('#luckysheet-row-count-show, #luckysheet-column-count-show').hide();\n            if (!isEditMode()) {\n                //chartMix 隐藏当前页的数据选择区域高亮\n                hideAllNeedRangeShow();\n            }    // selectHelpboxFill();\n                 //数据透视表\n            // selectHelpboxFill();\n            //数据透视表\n            pivotTable.pivotclick(row_index, col_index, Store.currentSheetIndex);\n            luckysheetContainerFocus();\n            method.createHookFunction('cellMousedown', Store.flowdata[row_index][col_index], {\n                r: row_index,\n                c: col_index,\n                'start_r': row_pre,\n                'start_c': col_pre,\n                'end_r': row,\n                'end_c': col\n            }, sheetFile, luckysheetTableContent);    //$(\"#luckysheet-cols-h-c .luckysheet-cols-h-cells-c .luckysheet-cols-h-cells-clip .luckysheet-cols-h-cell-sel\").removeClass(\"luckysheet-cols-h-cell-sel\").addClass(\"luckysheet-cols-h-cell-nosel\");\n                                                      //$(\"#luckysheet-rows-h .luckysheet-rows-h-cells .luckysheet-rows-h-cells-c .luckysheet-rows-h-cells-clip .luckysheet-rows-h-cell-sel\").removeClass(\"luckysheet-rows-h-cell-sel\").addClass(\"luckysheet-rows-h-cell-nosel\");\n                                                      //$(\"#luckysheet-cols-h-c .luckysheet-cols-h-cells-c .luckysheet-cols-h-cells-clip .luckysheet-cols-h-cell-nosel\").eq(col_index).removeClass(\"luckysheet-cols-h-cell-nosel\").addClass(\"luckysheet-cols-h-cell-sel\");\n                                                      //$(\"#luckysheet-rows-h .luckysheet-rows-h-cells .luckysheet-rows-h-cells-c .luckysheet-rows-h-cells-clip .luckysheet-rows-h-cell-nosel\").eq(row_index).removeClass(\"luckysheet-rows-h-cell-nosel\").addClass(\"luckysheet-rows-h-cell-sel\");\n                                                      //event.stopImmediatePropagation();\n        }).mouseup(function (event) {\n            if (event.which == '3') {\n                //禁止前台编辑(只可 框选单元格、滚动查看表格)\n                if (!Store.allowEdit) {\n                    return;\n                }\n                if (isEditMode()) {\n                    //非编辑模式下禁止右键功能框\n                    return;\n                }\n                let x = event.pageX;\n                let y = event.pageY;\n                let data = Store.flowdata;\n                let obj_s = Store.luckysheet_select_save[0];\n                const cellRightClickConfig = luckysheetConfigsetting.cellRightClickConfig;\n                $('#luckysheet-cols-rows-data').show();\n                $('#luckysheet-cols-rows-handleincell').show();\n                $('#luckysheet-cols-rows-add, #luckysheet-cols-rows-shift').hide();\n                $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'block';\n                $$('#luckysheet-cols-rows-handleincell .luckysheet-menuseparator').style.display = 'block';\n                if (obj_s['row'] != null && obj_s['row'][0] == 0 && obj_s['row'][1] == Store.flowdata.length - 1) {\n                    // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste && !cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth && !cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                        return;\n                    }\n                    Store.luckysheetRightHeadClickIs = 'column';\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word').text(locale().rightclick.column);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size').text(locale().rightclick.width);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left').text(locale().rightclick.left);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right').text(locale().rightclick.right);\n                    $('#luckysheet-cols-rows-add').show();    // $(\"#luckysheet-cols-rows-data\").show();\n                    // $(\"#luckysheet-cols-rows-data\").show();\n                    $('#luckysheet-cols-rows-shift').hide();\n                    $('#luckysheet-cols-rows-handleincell').hide();\n                    Store.luckysheet_cols_menu_status = true;\n                    $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'block';    // 自定义右键菜单：向左向右增加列，删除列，隐藏显示列，设置列宽\n                    // 自定义右键菜单：向左向右增加列，删除列，隐藏显示列，设置列宽\n                    $$('#luckysheet-top-left-add-selected').style.display = cellRightClickConfig.insertColumn ? 'block' : 'none';\n                    $$('#luckysheet-bottom-right-add-selected').style.display = cellRightClickConfig.insertColumn ? 'block' : 'none';\n                    $$('#luckysheet-del-selected').style.display = cellRightClickConfig.deleteColumn ? 'block' : 'none';\n                    $$('#luckysheet-hide-selected').style.display = cellRightClickConfig.hideColumn ? 'block' : 'none';\n                    $$('#luckysheet-show-selected').style.display = cellRightClickConfig.hideColumn ? 'block' : 'none';\n                    $$('#luckysheet-column-row-width-selected').style.display = cellRightClickConfig.columnWidth ? 'block' : 'none';    // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste) {\n                        $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                        if (!cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth) {\n                            $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                        }\n                    }    // 2.当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                    // 2.当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                    if (!cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth) {\n                        $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                    }    //列宽默认值\n                    //列宽默认值\n                    let cfg = $.extend(true, {}, Store.config);\n                    if (cfg['columnlen'] == null) {\n                        cfg['columnlen'] = {};\n                    }\n                    let first_collen = cfg['columnlen'][Store.luckysheet_select_save[0].column[0]] == null ? Store.defaultcollen : cfg['columnlen'][Store.luckysheet_select_save[0].column[0]];\n                    let isSame = true;\n                    for (let i = 0; i < Store.luckysheet_select_save.length; i++) {\n                        let s = Store.luckysheet_select_save[i];\n                        let c1 = s.column[0], c2 = s.column[1];\n                        for (let c = c1; c <= c2; c++) {\n                            let collen = cfg['columnlen'][c] == null ? Store.defaultcollen : cfg['columnlen'][c];\n                            if (collen != first_collen) {\n                                isSame = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (isSame) {\n                        $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val(first_collen);\n                    } else {\n                        $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val('');\n                    }\n                } else if (obj_s['column'] != null && obj_s['column'][0] == 0 && obj_s['column'][1] == Store.flowdata[0].length - 1) {\n                    // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste && !cellRightClickConfig.insertRow && !cellRightClickConfig.deleteRow && !cellRightClickConfig.hideRow && !cellRightClickConfig.rowHeight && !cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                        return;\n                    }\n                    Store.luckysheetRightHeadClickIs = 'row';\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word').text(locale().rightclick.row);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size').text(locale().rightclick.height);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left').text(locale().rightclick.top);\n                    $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right').text(locale().rightclick.bottom);\n                    $('#luckysheet-cols-rows-add').show();    // $(\"#luckysheet-cols-rows-data\").show();\n                    // $(\"#luckysheet-cols-rows-data\").show();\n                    $('#luckysheet-cols-rows-shift').hide();\n                    $('#luckysheet-cols-rows-handleincell').hide();\n                    Store.luckysheet_cols_menu_status = true;\n                    $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'block';    // 自定义右键菜单：向上向下增加行，删除行，隐藏显示行，设置行高\n                    // 自定义右键菜单：向上向下增加行，删除行，隐藏显示行，设置行高\n                    $$('#luckysheet-top-left-add-selected').style.display = cellRightClickConfig.insertRow ? 'block' : 'none';\n                    $$('#luckysheet-bottom-right-add-selected').style.display = cellRightClickConfig.insertRow ? 'block' : 'none';\n                    $$('#luckysheet-del-selected').style.display = cellRightClickConfig.deleteRow ? 'block' : 'none';\n                    $$('#luckysheet-hide-selected').style.display = cellRightClickConfig.hideRow ? 'block' : 'none';\n                    $$('#luckysheet-show-selected').style.display = cellRightClickConfig.hideRow ? 'block' : 'none';\n                    $$('#luckysheet-column-row-width-selected').style.display = cellRightClickConfig.rowHeight ? 'block' : 'none';    // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste) {\n                        $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                        if (!cellRightClickConfig.insertRow && !cellRightClickConfig.deleteRow && !cellRightClickConfig.hideRow && !cellRightClickConfig.rowHeight) {\n                            $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                        }\n                    }    // 2. 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                    // 2. 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                    if (!cellRightClickConfig.insertRow && !cellRightClickConfig.deleteRow && !cellRightClickConfig.hideRow && !cellRightClickConfig.rowHeight) {\n                        $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                    }    //行高默认值\n                    //行高默认值\n                    let cfg = $.extend(true, {}, Store.config);\n                    if (cfg['rowlen'] == null) {\n                        cfg['rowlen'] = {};\n                    }\n                    let first_rowlen = cfg['rowlen'][Store.luckysheet_select_save[0].row[0]] == null ? Store.defaultrowlen : cfg['rowlen'][Store.luckysheet_select_save[0].row[0]];\n                    let isSame = true;\n                    for (let i = 0; i < Store.luckysheet_select_save.length; i++) {\n                        let s = Store.luckysheet_select_save[i];\n                        let r1 = s.row[0], r2 = s.row[1];\n                        for (let r = r1; r <= r2; r++) {\n                            let rowlen = cfg['rowlen'][r] == null ? Store.defaultrowlen : cfg['rowlen'][r];\n                            if (rowlen != first_rowlen) {\n                                isSame = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (isSame) {\n                        $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val(first_rowlen);\n                    } else {\n                        $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val('');\n                    }\n                } else {\n                    // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste && !cellRightClickConfig.insertRow && !cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteRow && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.deleteCell && !cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                        return;\n                    }    // 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    // 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                    if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste) {\n                        $$('#luckysheet-cols-rows-handleincell .luckysheet-menuseparator').style.display = 'none';\n                        if (!cellRightClickConfig.insertRow && !cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteRow && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.deleteCell) {\n                            $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                        }\n                    }\n                    if (!cellRightClickConfig.insertRow && !cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteRow && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.deleteCell) {\n                        $$('#luckysheet-cols-rows-handleincell .luckysheet-menuseparator').style.display = 'none';\n                    }\n                }    // 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                // 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                if (!cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                    $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                }\n                showrightclickmenu($('#luckysheet-rightclick-menu'), x, y);\n            }    // 备注：在mousedown中发送光标信息会漏处理部分(选区)范围\n            // 备注：在mousedown中发送光标信息会漏处理部分(选区)范围\n            server.saveParam('mv', Store.currentSheetIndex, Store.luckysheet_select_save);\n        }).dblclick(function (event) {\n            if ($(event.target).hasClass('luckysheet-mousedown-cancel')) {\n                return;\n            }    //禁止前台编辑(只可 框选单元格、滚动查看表格)\n            //禁止前台编辑(只可 框选单元格、滚动查看表格)\n            if (!Store.allowEdit) {\n                return;\n            }\n            if (parseInt($('#luckysheet-input-box').css('top')) > 0) {\n                return;\n            }\n            let mouse = mouseposition(event.pageX, event.pageY);\n            if (mouse[0] >= Store.cellmainWidth - Store.cellMainSrollBarSize || mouse[1] >= Store.cellmainHeight - Store.cellMainSrollBarSize) {\n                return;\n            }\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft(), scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let x = mouse[0] + scrollLeft;\n            let y = mouse[1] + scrollTop;\n            if (luckysheetFreezen.freezenverticaldata != null && mouse[0] < luckysheetFreezen.freezenverticaldata[0] - luckysheetFreezen.freezenverticaldata[2]) {\n                x = mouse[0] + luckysheetFreezen.freezenverticaldata[2];\n            }\n            if (luckysheetFreezen.freezenhorizontaldata != null && mouse[1] < luckysheetFreezen.freezenhorizontaldata[0] - luckysheetFreezen.freezenhorizontaldata[2]) {\n                y = mouse[1] + luckysheetFreezen.freezenhorizontaldata[2];\n            }\n            let row_location = rowLocation(y), row_index = row_location[2];\n            let col_location = colLocation(x), col_index = col_location[2];\n            let margeset = menuButton.mergeborer(Store.flowdata, row_index, col_index);\n            if (!!margeset) {\n                row_index = margeset.row[2];\n                col_index = margeset.column[2];\n            }\n            if (pivotTable.isPivotRange(row_index, col_index)) {\n                //数据透视表没有 任何数据\n                if ((pivotTable.filter == null || pivotTable.filter.length == 0) && (pivotTable.row == null || pivotTable.row.length == 0) && (pivotTable.column == null || pivotTable.column.length == 0) && (pivotTable.values == null || pivotTable.values.length == 0)) {\n                    return;\n                }    //数据透视表没有 数值数据\n                //数据透视表没有 数值数据\n                if (pivotTable.values == null || pivotTable.values.length == 0) {\n                    return;\n                }    //点击位置不是 数值数据 所在区域\n                //点击位置不是 数值数据 所在区域\n                if (row_index == 0 || col_index == 0) {\n                    return;\n                }\n                if (pivotTable.column != null && pivotTable.column.length > 0) {\n                    if (pivotTable.values.length >= 2 && pivotTable.showType == 'column') {\n                        if (row_index <= pivotTable.column.length || col_index >= pivotTable.pivotDatas[0].length - pivotTable.values.length) {\n                            return;\n                        }\n                    } else {\n                        if (row_index <= pivotTable.column.length - 1 || col_index >= pivotTable.pivotDatas[0].length - 1) {\n                            return;\n                        }\n                    }\n                }\n                if (pivotTable.row != null && pivotTable.row.length > 0) {\n                    if (pivotTable.values.length >= 2 && pivotTable.showType == 'row') {\n                        if (col_index <= pivotTable.row.length || row_index >= pivotTable.pivotDatas.length - pivotTable.values.length) {\n                            return;\n                        }\n                    } else {\n                        if (col_index <= pivotTable.row.length - 1 || row_index >= pivotTable.pivotDatas.length - 1) {\n                            return;\n                        }\n                    }\n                }\n                sheetmanage.addNewSheet(event);\n                pivotTable.drillDown(row_index, col_index);\n                return;\n            }\n            if ($('#luckysheet-search-formula-parm').is(':visible') || $('#luckysheet-search-formula-parm-select').is(':visible')) {\n                //公式参数栏显示\n                $('#luckysheet-cell-selected').hide();\n            } else if ($('#luckysheet-conditionformat-dialog').is(':visible') || $('#luckysheet-administerRule-dialog').is(':visible') || $('#luckysheet-newConditionRule-dialog').is(':visible') || $('#luckysheet-editorConditionRule-dialog').is(':visible') || $('#luckysheet-singleRange-dialog').is(':visible') || $('#luckysheet-multiRange-dialog').is(':visible')) {\n                //条件格式\n                return;\n            } else if ($('#luckysheet-modal-dialog-slider-alternateformat').is(':visible') || $('#luckysheet-alternateformat-rangeDialog').is(':visible')) {\n                //交替颜色\n                return;\n            } else {\n                if (menuButton.luckysheetPaintModelOn) {\n                    menuButton.cancelPaintModel();\n                }    // 检查当前坐标和焦点坐标是否一致，如果不一致那么进行修正\n                // 检查当前坐标和焦点坐标是否一致，如果不一致那么进行修正\n                let column_focus = Store.luckysheet_select_save[0]['column_focus'];\n                let row_focus = Store.luckysheet_select_save[0]['row_focus'];\n                if (column_focus !== col_index || row_focus !== row_index) {\n                    row_index = row_focus;\n                    col_index = column_focus;\n                }\n                ;\n                luckysheetupdateCell(row_index, col_index, Store.flowdata);    /* 设置选区高亮 */\n                /* 设置选区高亮 */\n                selectHightlightShow();\n            }\n        });    //监听拖拽 \n        //监听拖拽 \n        document.getElementById('luckysheet-cell-main').addEventListener('drop', function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            let files = e.dataTransfer.files;    //拖拽插入图片\n            //拖拽插入图片\n            if (files.length == 1 && files[0].type.indexOf('image') > -1) {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects')) {\n                    return;\n                }\n                let render = new FileReader();\n                render.readAsDataURL(files[0]);\n                render.onload = function (event) {\n                    let src = event.target.result;\n                    imageCtrl.inserImg(src);\n                };\n            }\n            handleCellDragStopEvent(e);\n        }, false);\n        document.getElementById('luckysheet-cell-main').addEventListener('dragover', function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n        }, false);    /**\n     * 处理单元格上鼠标拖拽停止事件\n     * @param {DragEvent} event \n     */\n        /**\n     * 处理单元格上鼠标拖拽停止事件\n     * @param {DragEvent} event \n     */\n        function handleCellDragStopEvent(event) {\n            if (luckysheetConfigsetting && luckysheetConfigsetting.hook && luckysheetConfigsetting.hook.cellDragStop) {\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let margeset = menuButton.mergeborer(Store.flowdata, row_index, col_index);\n                if (!!margeset) {\n                    row = margeset.row[1];\n                    row_pre = margeset.row[0];\n                    row_index = margeset.row[2];\n                    col = margeset.column[1];\n                    col_pre = margeset.column[0];\n                    col_index = margeset.column[2];\n                }\n                let sheetFile = sheetmanage.getSheetByIndex();\n                let luckysheetTableContent = $('#luckysheetTableContent').get(0).getContext('2d');\n                method.createHookFunction('cellDragStop', Store.flowdata[row_index][col_index], {\n                    r: row_index,\n                    c: col_index,\n                    'start_r': row_pre,\n                    'start_c': col_pre,\n                    'end_r': row,\n                    'end_c': col\n                }, sheetFile, luckysheetTableContent, event);\n            }\n        }    //表格mousemove\n        //表格mousemove\n        $(document).on('mousemove.luckysheetEvent', function (event) {\n            luckysheetPostil.overshow(event);    //有批注显示\n            //有批注显示\n            hyperlinkCtrl.overshow(event);    //链接提示显示\n            //链接提示显示\n            window.cancelAnimationFrame(Store.jfautoscrollTimeout);\n            if (luckysheetConfigsetting && luckysheetConfigsetting.hook && luckysheetConfigsetting.hook.sheetMousemove) {\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let margeset = menuButton.mergeborer(Store.flowdata, row_index, col_index);\n                if (!!margeset) {\n                    row = margeset.row[1];\n                    row_pre = margeset.row[0];\n                    row_index = margeset.row[2];\n                    col = margeset.column[1];\n                    col_pre = margeset.column[0];\n                    col_index = margeset.column[2];\n                }    // if(Store.flowdata[row_index] && Store.flowdata[row_index][col_index]){\n                // if(Store.flowdata[row_index] && Store.flowdata[row_index][col_index]){\n                let sheetFile = sheetmanage.getSheetByIndex();\n                let moveState = {\n                    functionResizeStatus: formula.functionResizeStatus,\n                    horizontalmoveState: !!luckysheetFreezen.horizontalmovestate,\n                    verticalmoveState: !!luckysheetFreezen.verticalmovestate,\n                    pivotTableMoveState: !!pivotTable && pivotTable.movestate,\n                    sheetMoveStatus: Store.luckysheet_sheet_move_status,\n                    scrollStatus: !!Store.luckysheet_scroll_status,\n                    selectStatus: !!Store.luckysheet_select_status,\n                    rowsSelectedStatus: !!Store.luckysheet_rows_selected_status,\n                    colsSelectedStatus: !!Store.luckysheet_cols_selected_status,\n                    cellSelectedMove: !!Store.luckysheet_cell_selected_move,\n                    cellSelectedExtend: !!Store.luckysheet_cell_selected_extend,\n                    colsChangeSize: !!Store.luckysheet_cols_change_size,\n                    rowsChangeSize: !!Store.luckysheet_rows_change_size,\n                    chartMove: !!Store.chartparam.luckysheetCurrentChartMove,\n                    chartResize: !!Store.chartparam.luckysheetCurrentChartResize,\n                    rangeResize: !!formula.rangeResize,\n                    rangeMove: !!formula.rangeMove\n                };\n                let luckysheetTableContent = $('#luckysheetTableContent').get(0).getContext('2d');\n                if (Store.flowdata && Store.flowdata[row_index]) {\n                    method.createHookFunction('sheetMousemove', Store.flowdata[row_index][col_index], {\n                        r: row_index,\n                        c: col_index,\n                        'start_r': row_pre,\n                        'start_c': col_pre,\n                        'end_r': row,\n                        'end_c': col\n                    }, sheetFile, moveState, luckysheetTableContent);\n                }    // }\n            }\n            // }\n            if (formula.functionResizeStatus) {\n                let y = event.pageY;\n                let movepx = y - formula.functionResizeData.y;\n                let mpx = formula.functionResizeData.calculatebarHeight + movepx;\n                let winh = Math.round($(window).height() / 2);\n                if (mpx <= 28) {\n                    if (mpx <= 20) {\n                        return;\n                    }\n                    mpx = 28;\n                } else if (mpx >= winh) {\n                    if (mpx >= winh + 8) {\n                        return;\n                    }\n                    mpx = winh;\n                }\n                Store.calculatebarHeight = mpx;\n                $('#luckysheet-wa-calculate').css('height', Store.calculatebarHeight - 2);\n                $('#luckysheet-wa-calculate-size').css({\n                    'background': '#5e5e5e',\n                    'cursor': 'ns-resize'\n                });\n                clearTimeout(formula.functionResizeTimeout);\n                formula.functionResizeTimeout = setTimeout(function () {\n                    luckysheetsizeauto();\n                }, 15);\n            } else if (!!luckysheetFreezen.horizontalmovestate) {\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let x = mouse[0] + scrollLeft;\n                let y = mouse[1] + scrollTop;\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let top = mouse[1] + Store.columnHeaderHeight;\n                if (top < Store.columnHeaderHeight) {\n                    top = Store.columnHeaderHeight;\n                }\n                if (top > luckysheetFreezen.windowHeight - 4) {\n                    top = luckysheetFreezen.windowHeight - 4;\n                }\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-handle').css({ 'top': top });\n                if (top + scrollTop - Store.columnHeaderHeight >= row_pre + (row - row_pre) / 2) {\n                    top = row - 2 - scrollTop + Store.columnHeaderHeight;\n                    luckysheetFreezen.freezenhorizontaldata = [\n                        row,\n                        row_index + 1,\n                        scrollTop,\n                        luckysheetFreezen.cutVolumn(Store.visibledatarow, row_index + 1),\n                        top\n                    ];\n                } else {\n                    top = row_pre - 2 - scrollTop + Store.columnHeaderHeight;\n                    luckysheetFreezen.freezenhorizontaldata = [\n                        row_pre,\n                        row_index,\n                        scrollTop,\n                        luckysheetFreezen.cutVolumn(Store.visibledatarow, row_index),\n                        top\n                    ];\n                }\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-drop').css({ 'top': top });\n                luckysheetFreezen.saveFreezen(luckysheetFreezen.freezenhorizontaldata, top, null, null);\n            } else if (!!luckysheetFreezen.verticalmovestate) {\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let x = mouse[0] + scrollLeft;\n                let y = mouse[1] + scrollTop;\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let left = mouse[0] + Store.rowHeaderWidth;\n                if (left < Store.rowHeaderWidth) {\n                    left = Store.rowHeaderWidth;\n                }\n                if (left > luckysheetFreezen.windowWidth - 4) {\n                    left = luckysheetFreezen.windowWidth - 4;\n                }\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-handle').css({ 'left': left });\n                if (left + scrollLeft - Store.rowHeaderWidth >= col_pre + (col - col_pre) / 2) {\n                    left = col - 2 - scrollLeft + Store.rowHeaderWidth;\n                    luckysheetFreezen.freezenverticaldata = [\n                        col,\n                        col_index + 1,\n                        scrollLeft,\n                        luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_index + 1),\n                        left\n                    ];\n                } else {\n                    left = col_pre - 2 - scrollLeft + Store.rowHeaderWidth;\n                    luckysheetFreezen.freezenverticaldata = [\n                        col_pre,\n                        col_index,\n                        scrollLeft,\n                        luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_index),\n                        left\n                    ];\n                }\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-drop').css({ 'left': left });\n                luckysheetFreezen.saveFreezen(null, null, luckysheetFreezen.freezenverticaldata, left);\n                luckysheetsizeauto();    //调节选区时下部单元格溢出\n            } else //调节选区时下部单元格溢出\n            if (!!pivotTable && pivotTable.movestate) {\n                let x = event.pageX, y = event.pageY;\n                $('#luckysheet-modal-dialog-slider-pivot-move').css({\n                    'left': x - pivotTable.movesave.width / 2,\n                    'top': y - pivotTable.movesave.height\n                });\n            } else if (Store.luckysheet_sheet_move_status) {\n                let scrollLeft = $('#luckysheet-sheet-container-c').scrollLeft();\n                let x = event.pageX + scrollLeft;\n                if (Math.abs(event.pageX - Store.luckysheet_sheet_move_data.pageX) < 3) {\n                    return;\n                }\n                let winW = $('#luckysheet-sheet-container').width();\n                let left = x - Store.luckysheet_sheet_move_data.curleft - $('#luckysheet-sheet-container').offset().left;\n                Store.luckysheet_sheet_move_data.activeobject.css({ 'left': left });\n                let row_index = luckysheet_searcharray(Store.luckysheet_sheet_move_data.widthlist, left + Store.luckysheet_sheet_move_data.curleft);\n                Store.luckysheet_sheet_move_data.cursorobject.css({ 'cursor': 'move' });\n                if (left - scrollLeft <= 6) {\n                    $('#luckysheet-sheets-leftscroll').click();\n                }\n                if (left - scrollLeft >= winW - 40) {\n                    $('#luckysheet-sheets-rightscroll').click();\n                }\n                if (row_index != Store.luckysheet_sheet_move_data.curindex) {\n                    if (row_index == -1 && left > 0) {\n                        row_index = Store.luckysheet_sheet_move_data.widthlist.length - 1;\n                        $('#luckysheet-sheets-item-clone').insertAfter($('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').eq(row_index));\n                    } else if (row_index == -1 && left <= 0) {\n                        $('#luckysheet-sheets-item-clone').insertBefore($('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').eq(0));\n                    } else {\n                        $('#luckysheet-sheets-item-clone').insertAfter($('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').eq(row_index));\n                    }\n                    Store.luckysheet_sheet_move_data.widthlist = [];\n                    $('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').each(function (i) {\n                        if (i == 0) {\n                            Store.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth()));\n                        } else {\n                            Store.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth()) + Store.luckysheet_sheet_move_data.widthlist[i - 1]);\n                        }\n                    });\n                    Store.luckysheet_sheet_move_data.curindex = $('#luckysheet-sheet-area div.luckysheet-sheets-item:visible').index($('#luckysheet-sheets-item-clone'));\n                }\n            } else if (Store.luckysheet_model_move_state) {\n                let scrollTop = $(document).scrollTop(), scrollLeft = $(document).scrollLeft();\n                let y = event.pageY + scrollTop, x = event.pageX + scrollLeft;\n                let winH = $(window).height(), winW = $(window).width();\n                let myh = Store.luckysheet_model_move_obj.height(), myw = Store.luckysheet_model_move_obj.width();\n                let top = y - Store.luckysheet_model_xy[1], left = x - Store.luckysheet_model_xy[0];\n                if (top < 0) {\n                    top = 0;\n                }\n                if (top + myh + 62 > winH) {\n                    top = winH - myh - 62;\n                }\n                if (left < 0) {\n                    left = 0;\n                }\n                if (left + myw + 86 > winW) {\n                    left = winW - myw - 86;\n                }\n                Store.luckysheet_model_move_obj.css({\n                    'top': top,\n                    'left': left\n                });\n                event.preventDefault();\n            } else if (!!Store.luckysheet_scroll_status || !!Store.luckysheet_select_status || !!Store.luckysheet_rows_selected_status || !!Store.luckysheet_cols_selected_status || !!Store.luckysheet_cell_selected_move || !!Store.luckysheet_cell_selected_extend || !!Store.luckysheet_cols_change_size || !!Store.luckysheet_rows_change_size || !!Store.chartparam.luckysheetCurrentChartMove || !!Store.chartparam.luckysheetCurrentChartResize || !!formula.rangeResize || !!formula.rangeMove) {\n                if (Store.luckysheet_select_status) {\n                    clearTimeout(Store.countfuncTimeout);\n                    Store.countfuncTimeout = setTimeout(function () {\n                        countfunc();\n                    }, 500);\n                }\n                function mouseRender() {\n                    if (Store.luckysheet_scroll_status && !Store.luckysheet_cols_change_size && !Store.luckysheet_rows_change_size) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let left = $('#luckysheet-scrollbar-x').scrollLeft(), top = $('#luckysheet-scrollbar-y').scrollTop();\n                        let x = mouse[0];\n                        let y = mouse[1];\n                        let winH = $('#luckysheet-cell-main').height() - 20 * Store.zoomRatio, winW = $('#luckysheet-cell-main').width() - 60 * Store.zoomRatio;\n                        if (y < 0 || y > winH) {\n                            let stop;\n                            if (y < 0) {\n                                stop = top + y / 2;\n                            } else {\n                                stop = top + (y - winH) / 2;\n                            }\n                            $('#luckysheet-scrollbar-y').scrollTop(stop);\n                        }\n                        if (x < 0 || x > winW) {\n                            let sleft;\n                            if (x < 0) {\n                                sleft = left + x / 2;\n                            } else {\n                                sleft = left + (x - winW) / 2;\n                            }\n                            $('#luckysheet-scrollbar-x').scrollLeft(sleft);\n                        }\n                    }\n                    if (Store.luckysheet_select_status) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        if (!checkProtectionSelectLockedOrUnLockedCells(row_index, col_index, Store.currentSheetIndex)) {\n                            // Store.luckysheet_select_status = false;\n                            return;\n                        }\n                        let last = $.extend(true, {}, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]);\n                        let top = 0, height = 0, rowseleted = [];\n                        if (last.top > row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            if (last.row[1] > last.row_focus) {\n                                last.row[1] = last.row_focus;\n                            }\n                            rowseleted = [\n                                row_index,\n                                last.row[1]\n                            ];\n                        } else if (last.top == row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            rowseleted = [\n                                row_index,\n                                last.row[0]\n                            ];\n                        } else {\n                            top = last.top;\n                            height = row - last.top - 1;\n                            if (last.row[0] < last.row_focus) {\n                                last.row[0] = last.row_focus;\n                            }\n                            rowseleted = [\n                                last.row[0],\n                                row_index\n                            ];\n                        }\n                        let left = 0, width = 0, columnseleted = [];\n                        if (last.left > col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            if (last.column[1] > last.column_focus) {\n                                last.column[1] = last.column_focus;\n                            }\n                            columnseleted = [\n                                col_index,\n                                last.column[1]\n                            ];\n                        } else if (last.left == col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            columnseleted = [\n                                col_index,\n                                last.column[0]\n                            ];\n                        } else {\n                            left = last.left;\n                            width = col - last.left - 1;\n                            if (last.column[0] < last.column_focus) {\n                                last.column[0] = last.column_focus;\n                            }\n                            columnseleted = [\n                                last.column[0],\n                                col_index\n                            ];\n                        }\n                        let changeparam = menuButton.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                        if (changeparam != null) {\n                            columnseleted = changeparam[0];\n                            rowseleted = changeparam[1];\n                            top = changeparam[2];\n                            height = changeparam[3];\n                            left = changeparam[4];\n                            width = changeparam[5];\n                        }\n                        last['row'] = rowseleted;\n                        last['column'] = columnseleted;\n                        last['left_move'] = left;\n                        last['width_move'] = width;\n                        last['top_move'] = top;\n                        last['height_move'] = height;\n                        Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1] = last;\n                        selectHightlightShow();\n                        luckysheetFreezen.scrollFreezen();    // selectHelpboxFill();\n                                                              //交替颜色选择范围\n                        // selectHelpboxFill();\n                        //交替颜色选择范围\n                        if ($('#luckysheet-alternateformat-rangeDialog').is(':visible')) {\n                            $('#luckysheet-alternateformat-rangeDialog input').val(getRangetxt(Store.currentSheetIndex, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]));\n                        }\n                        if (pivotTable.luckysheet_pivotTable_select_state) {\n                            $('#luckysheet-pivotTable-range-selection-input').val(Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].name + '!' + chatatABC(Store.luckysheet_select_save[0]['column'][0]) + (Store.luckysheet_select_save[0]['row'][0] + 1) + ':' + chatatABC(Store.luckysheet_select_save[0]['column'][1]) + (Store.luckysheet_select_save[0]['row'][1] + 1));\n                        }\n                    } else if (conditionformat.selectStatus) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        let last = conditionformat.selectRange[conditionformat.selectRange.length - 1];\n                        let top = 0, height = 0, rowseleted = [];\n                        if (last.top > row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            if (last.row[1] > last.row_focus) {\n                                last.row[1] = last.row_focus;\n                            }\n                            rowseleted = [\n                                row_index,\n                                last.row[1]\n                            ];\n                        } else if (last.top == row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            rowseleted = [\n                                row_index,\n                                last.row[0]\n                            ];\n                        } else {\n                            top = last.top;\n                            height = row - last.top - 1;\n                            if (last.row[0] < last.row_focus) {\n                                last.row[0] = last.row_focus;\n                            }\n                            rowseleted = [\n                                last.row[0],\n                                row_index\n                            ];\n                        }\n                        let left = 0, width = 0, columnseleted = [];\n                        if (last.left > col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            if (last.column[1] > last.column_focus) {\n                                last.column[1] = last.column_focus;\n                            }\n                            columnseleted = [\n                                col_index,\n                                last.column[1]\n                            ];\n                        } else if (last.left == col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            columnseleted = [\n                                col_index,\n                                last.column[0]\n                            ];\n                        } else {\n                            left = last.left;\n                            width = col - last.left - 1;\n                            if (last.column[0] < last.column_focus) {\n                                last.column[0] = last.column_focus;\n                            }\n                            columnseleted = [\n                                last.column[0],\n                                col_index\n                            ];\n                        }\n                        let changeparam = menuButton.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                        if (changeparam != null) {\n                            columnseleted = changeparam[0];\n                            rowseleted = changeparam[1];\n                            top = changeparam[2];\n                            height = changeparam[3];\n                            left = changeparam[4];\n                            width = changeparam[5];\n                        }\n                        last['row'] = rowseleted;\n                        last['column'] = columnseleted;\n                        last['left_move'] = left;\n                        last['width_move'] = width;\n                        last['top_move'] = top;\n                        last['height_move'] = height;\n                        conditionformat.selectRange[conditionformat.selectRange.length - 1] = last;\n                        selectionCopyShow(conditionformat.selectRange);\n                        let range = conditionformat.getTxtByRange(conditionformat.selectRange);\n                        $('#luckysheet-multiRange-dialog input').val(range);\n                    } else if (dataVerificationCtrl.selectStatus) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        let last = dataVerificationCtrl.selectRange[dataVerificationCtrl.selectRange.length - 1];\n                        let top = 0, height = 0, rowseleted = [];\n                        if (last.top > row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            if (last.row[1] > last.row_focus) {\n                                last.row[1] = last.row_focus;\n                            }\n                            rowseleted = [\n                                row_index,\n                                last.row[1]\n                            ];\n                        } else if (last.top == row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            rowseleted = [\n                                row_index,\n                                last.row[0]\n                            ];\n                        } else {\n                            top = last.top;\n                            height = row - last.top - 1;\n                            if (last.row[0] < last.row_focus) {\n                                last.row[0] = last.row_focus;\n                            }\n                            rowseleted = [\n                                last.row[0],\n                                row_index\n                            ];\n                        }\n                        let left = 0, width = 0, columnseleted = [];\n                        if (last.left > col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            if (last.column[1] > last.column_focus) {\n                                last.column[1] = last.column_focus;\n                            }\n                            columnseleted = [\n                                col_index,\n                                last.column[1]\n                            ];\n                        } else if (last.left == col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            columnseleted = [\n                                col_index,\n                                last.column[0]\n                            ];\n                        } else {\n                            left = last.left;\n                            width = col - last.left - 1;\n                            if (last.column[0] < last.column_focus) {\n                                last.column[0] = last.column_focus;\n                            }\n                            columnseleted = [\n                                last.column[0],\n                                col_index\n                            ];\n                        }\n                        let changeparam = menuButton.mergeMoveMain(columnseleted, rowseleted, last, top, height, left, width);\n                        if (changeparam != null) {\n                            columnseleted = changeparam[0];\n                            rowseleted = changeparam[1];\n                            top = changeparam[2];\n                            height = changeparam[3];\n                            left = changeparam[4];\n                            width = changeparam[5];\n                        }\n                        last['row'] = rowseleted;\n                        last['column'] = columnseleted;\n                        last['left_move'] = left;\n                        last['width_move'] = width;\n                        last['top_move'] = top;\n                        last['height_move'] = height;\n                        dataVerificationCtrl.selectRange[dataVerificationCtrl.selectRange.length - 1] = last;\n                        selectionCopyShow(dataVerificationCtrl.selectRange);\n                        let range = dataVerificationCtrl.getTxtByRange(dataVerificationCtrl.selectRange);\n                        if (formula.rangetosheet != Store.currentSheetIndex) {\n                            range = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].name + '!' + range;\n                        }\n                        $('#luckysheet-dataVerificationRange-dialog input').val(range);\n                    } else if (formula.rangestart) {\n                        formula.rangedrag(event);\n                    } else if (formula.rangedrag_row_start) {\n                        formula.rangedrag_row(event);\n                    } else if (formula.rangedrag_column_start) {\n                        formula.rangedrag_column(event);\n                    } else if (Store.luckysheet_rows_selected_status) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let y = mouse[1] + $('#luckysheet-rows-h').scrollTop();\n                        if (y < 0) {\n                            return false;\n                        }\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_index = Store.visibledatacolumn.length - 1, col = Store.visibledatacolumn[col_index], col_pre = 0;\n                        let last = $.extend(true, {}, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]);\n                        let top = 0, height = 0, rowseleted = [];\n                        if (last.top > row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            if (last.row[1] > last.row_focus) {\n                                last.row[1] = last.row_focus;\n                            }\n                            rowseleted = [\n                                row_index,\n                                last.row[1]\n                            ];\n                        } else if (last.top == row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            rowseleted = [\n                                row_index,\n                                last.row[0]\n                            ];\n                        } else {\n                            top = last.top;\n                            height = row - last.top - 1;\n                            if (last.row[0] < last.row_focus) {\n                                last.row[0] = last.row_focus;\n                            }\n                            rowseleted = [\n                                last.row[0],\n                                row_index\n                            ];\n                        }\n                        last['row'] = rowseleted;\n                        last['top_move'] = top;\n                        last['height_move'] = height;\n                        Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1] = last;\n                        selectHightlightShow();\n                        clearTimeout(Store.countfuncTimeout);\n                        Store.countfuncTimeout = setTimeout(function () {\n                            countfunc();\n                        }, 500);\n                    } else if (Store.luckysheet_cols_selected_status) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cols-h-c').scrollLeft();\n                        if (x < 0) {\n                            return false;\n                        }\n                        let row_index = Store.visibledatarow.length - 1, row = Store.visibledatarow[row_index], row_pre = 0;\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        let last = $.extend(true, {}, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]);\n                        let left = 0, width = 0, columnseleted = [];\n                        if (last.left > col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            if (last.column[1] > last.column_focus) {\n                                last.column[1] = last.column_focus;\n                            }\n                            columnseleted = [\n                                col_index,\n                                last.column[1]\n                            ];\n                        } else if (last.left == col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            columnseleted = [\n                                col_index,\n                                last.column[0]\n                            ];\n                        } else {\n                            left = last.left;\n                            width = col - last.left - 1;\n                            if (last.column[0] < last.column_focus) {\n                                last.column[0] = last.column_focus;\n                            }\n                            columnseleted = [\n                                last.column[0],\n                                col_index\n                            ];\n                        }\n                        last['column'] = columnseleted;\n                        last['left_move'] = left;\n                        last['width_move'] = width;\n                        Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1] = last;\n                        selectHightlightShow();\n                        clearTimeout(Store.countfuncTimeout);\n                        Store.countfuncTimeout = setTimeout(function () {\n                            countfunc();\n                        }, 500);\n                    } else if (Store.luckysheet_cell_selected_move) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                        let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                        let x = mouse[0] + scrollLeft;\n                        let y = mouse[1] + scrollTop;\n                        let winH = $(window).height() + scrollTop - Store.sheetBarHeight - Store.statisticBarHeight, winW = $(window).width() + scrollLeft;\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        let row_index_original = Store.luckysheet_cell_selected_move_index[0], col_index_original = Store.luckysheet_cell_selected_move_index[1];\n                        let row_s = Store.luckysheet_select_save[0]['row'][0] - row_index_original + row_index, row_e = Store.luckysheet_select_save[0]['row'][1] - row_index_original + row_index;\n                        let col_s = Store.luckysheet_select_save[0]['column'][0] - col_index_original + col_index, col_e = Store.luckysheet_select_save[0]['column'][1] - col_index_original + col_index;\n                        if (row_s < 0 || y < 0) {\n                            row_s = 0;\n                            row_e = Store.luckysheet_select_save[0]['row'][1] - Store.luckysheet_select_save[0]['row'][0];\n                        }\n                        if (col_s < 0 || x < 0) {\n                            col_s = 0;\n                            col_e = Store.luckysheet_select_save[0]['column'][1] - Store.luckysheet_select_save[0]['column'][0];\n                        }\n                        if (row_e >= Store.visibledatarow[Store.visibledatarow.length - 1] || y > winH) {\n                            row_s = Store.visibledatarow.length - 1 - Store.luckysheet_select_save[0]['row'][1] + Store.luckysheet_select_save[0]['row'][0];\n                            row_e = Store.visibledatarow.length - 1;\n                        }\n                        if (col_e >= Store.visibledatacolumn[Store.visibledatacolumn.length - 1] || x > winW) {\n                            col_s = Store.visibledatacolumn.length - 1 - Store.luckysheet_select_save[0]['column'][1] + Store.luckysheet_select_save[0]['column'][0];\n                            col_e = Store.visibledatacolumn.length - 1;\n                        }\n                        col_pre = col_s - 1 == -1 ? 0 : Store.visibledatacolumn[col_s - 1];\n                        col = Store.visibledatacolumn[col_e];\n                        row_pre = row_s - 1 == -1 ? 0 : Store.visibledatarow[row_s - 1];\n                        row = Store.visibledatarow[row_e];\n                        $('#luckysheet-cell-selected-move').css({\n                            'left': col_pre,\n                            'width': col - col_pre - 2,\n                            'top': row_pre,\n                            'height': row - row_pre - 2,\n                            'display': 'block'\n                        });\n                    } else if (Store.luckysheet_cell_selected_extend) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let scrollLeft = $('#luckysheet-cell-main').scrollLeft() - 5;\n                        let scrollTop = $('#luckysheet-cell-main').scrollTop() - 5;\n                        let x = mouse[0] + scrollLeft;\n                        let y = mouse[1] + scrollTop;\n                        let winH = $(window).height() + scrollTop - Store.sheetBarHeight - Store.statisticBarHeight, winW = $(window).width() + scrollLeft;\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        let row_index_original = Store.luckysheet_cell_selected_extend_index[0], col_index_original = Store.luckysheet_cell_selected_extend_index[1];\n                        let row_s = Store.luckysheet_select_save[0]['row'][0], row_e = Store.luckysheet_select_save[0]['row'][1];\n                        let col_s = Store.luckysheet_select_save[0]['column'][0], col_e = Store.luckysheet_select_save[0]['column'][1];\n                        if (row_s < 0 || y < 0) {\n                            row_s = 0;\n                            row_e = Store.luckysheet_select_save[0]['row'][1] - Store.luckysheet_select_save[0]['row'][0];\n                        }\n                        if (col_s < 0 || x < 0) {\n                            col_s = 0;\n                            col_e = Store.luckysheet_select_save[0]['column'][1] - Store.luckysheet_select_save[0]['column'][0];\n                        }\n                        if (row_e >= Store.visibledatarow[Store.visibledatarow.length - 1] || y > winH) {\n                            row_s = Store.visibledatarow.length - 1 - Store.luckysheet_select_save[0]['row'][1] + Store.luckysheet_select_save[0]['row'][0];\n                            row_e = Store.visibledatarow.length - 1;\n                        }\n                        if (col_e >= Store.visibledatacolumn[Store.visibledatacolumn.length - 1] || x > winW) {\n                            col_s = Store.visibledatacolumn.length - 1 - Store.luckysheet_select_save[0]['column'][1] + Store.luckysheet_select_save[0]['column'][0];\n                            col_e = Store.visibledatacolumn.length - 1;\n                        }\n                        let top = Store.luckysheet_select_save[0].top_move, height = Store.luckysheet_select_save[0].height_move;\n                        let left = Store.luckysheet_select_save[0].left_move, width = Store.luckysheet_select_save[0].width_move;\n                        if (Math.abs(row_index_original - row_index) > Math.abs(col_index_original - col_index)) {\n                            if (!(row_index >= row_s && row_index <= row_e)) {\n                                if (Store.luckysheet_select_save[0].top_move >= row_pre) {\n                                    top = row_pre;\n                                    height = Store.luckysheet_select_save[0].top_move + Store.luckysheet_select_save[0].height_move - row_pre;\n                                } else {\n                                    top = Store.luckysheet_select_save[0].top_move;\n                                    height = row - Store.luckysheet_select_save[0].top_move - 1;\n                                }\n                            }\n                        } else {\n                            if (!(col_index >= col_s && col_index <= col_e)) {\n                                if (Store.luckysheet_select_save[0].left_move >= col_pre) {\n                                    left = col_pre;\n                                    width = Store.luckysheet_select_save[0].left_move + Store.luckysheet_select_save[0].width_move - col_pre;\n                                } else {\n                                    left = Store.luckysheet_select_save[0].left_move;\n                                    width = col - Store.luckysheet_select_save[0].left_move - 1;\n                                }\n                            }\n                        }\n                        $('#luckysheet-cell-selected-extend').css({\n                            'left': left,\n                            'width': width,\n                            'top': top,\n                            'height': height,\n                            'display': 'block'\n                        });\n                    } else if (Store.luckysheet_cols_change_size) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let scrollLeft = $('#luckysheet-cols-h-c').scrollLeft();\n                        let x = mouse[0] + scrollLeft;\n                        let winW = $(window).width();\n                        let row_index = Store.visibledatarow.length - 1, row = Store.visibledatarow[row_index], row_pre = 0;\n                        let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                        if (x + 3 - Store.luckysheet_cols_change_size_start[0] > 30 && x < winW + scrollLeft - 100) {\n                            $('#luckysheet-change-size-line').css({ 'left': x });\n                            $('#luckysheet-cols-change-size').css({ 'left': x - 2 });\n                        }\n                    } else if (Store.luckysheet_rows_change_size) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let scrollTop = $('#luckysheet-rows-h').scrollTop();\n                        let y = mouse[1] + scrollTop;\n                        let winH = $(window).height();\n                        let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                        if (y + 3 - Store.luckysheet_rows_change_size_start[0] > 19 && y < winH + scrollTop - 200) {\n                            $('#luckysheet-change-size-line').css({ 'top': y });\n                            $('#luckysheet-rows-change-size').css({ 'top': y });\n                        }\n                    }    // chart move\n                    else // chart move\n                    if (!!Store.chartparam.luckysheetCurrentChartMove) {\n                        const mouse = mouseposition(event.pageX, event.pageY);\n                        const x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        const y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        const myh = Store.chartparam.luckysheetCurrentChartMoveObj.height(), myw = Store.chartparam.luckysheetCurrentChartMoveObj.width();\n                        let top = y - Store.chartparam.luckysheetCurrentChartMoveXy[1], left = x - Store.chartparam.luckysheetCurrentChartMoveXy[0];\n                        if (top < 0) {\n                            top = 0;\n                        }\n                        if (top + myh + 42 + 6 > Store.chartparam.luckysheetCurrentChartMoveWinH) {\n                            top = Store.chartparam.luckysheetCurrentChartMoveWinH - myh - 42 - 6;\n                        }\n                        if (left < 0) {\n                            left = 0;\n                        }\n                        if (left + myw + 22 + 36 > Store.chartparam.luckysheetCurrentChartMoveWinW) {\n                            left = Store.chartparam.luckysheetCurrentChartMoveWinW - myw - 22 - 36;\n                        }\n                        Store.chartparam.luckysheetCurrentChartMoveObj.css({\n                            'top': top,\n                            'left': left\n                        });\n                        if (luckysheetFreezen.freezenhorizontaldata != null || luckysheetFreezen.freezenverticaldata != null) {\n                            luckysheetFreezen.scrollAdapt();\n                            const toffset = Store.chartparam.luckysheetCurrentChartMoveObj.offset();\n                            const tpsition = Store.chartparam.luckysheetCurrentChartMoveObj.position();\n                            Store.chartparam.luckysheetCurrentChartMoveXy = [\n                                event.pageX - toffset.left,\n                                event.pageY - toffset.top,\n                                tpsition.left,\n                                tpsition.top,\n                                $('#luckysheet-scrollbar-x').scrollLeft(),\n                                $('#luckysheet-scrollbar-y').scrollTop()\n                            ];\n                        }\n                    }    // chart resize\n                    else // chart resize\n                    if (!!Store.chartparam.luckysheetCurrentChartResize) {\n                        const scrollTop = $('#luckysheet-cell-main').scrollTop(), scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                        const mouse = mouseposition(event.pageX, event.pageY);\n                        const x = mouse[0] + scrollLeft;\n                        const y = mouse[1] + scrollTop;\n                        if (x < 0 || y < 0) {\n                            return false;\n                        }\n                        const myh = Store.chartparam.luckysheetCurrentChartResizeObj.height(), myw = Store.chartparam.luckysheetCurrentChartResizeObj.width();\n                        const topchange = y - Store.chartparam.luckysheetCurrentChartResizeXy[1], leftchange = x - Store.chartparam.luckysheetCurrentChartResizeXy[0];\n                        let top = Store.chartparam.luckysheetCurrentChartResizeXy[5], height = Store.chartparam.luckysheetCurrentChartResizeXy[3], left = Store.chartparam.luckysheetCurrentChartResizeXy[4], width = Store.chartparam.luckysheetCurrentChartResizeXy[2];\n                        if (Store.chartparam.luckysheetCurrentChartResize == 'lm' || Store.chartparam.luckysheetCurrentChartResize == 'lt' || Store.chartparam.luckysheetCurrentChartResize == 'lb') {\n                            left = x;\n                            width = Store.chartparam.luckysheetCurrentChartResizeXy[2] - leftchange;\n                            if (left > Store.chartparam.luckysheetCurrentChartResizeXy[2] + Store.chartparam.luckysheetCurrentChartResizeXy[4] - 60) {\n                                left = Store.chartparam.luckysheetCurrentChartResizeXy[2] + Store.chartparam.luckysheetCurrentChartResizeXy[4] - 60;\n                                width = Store.chartparam.luckysheetCurrentChartResizeXy[2] - (Store.chartparam.luckysheetCurrentChartResizeXy[2] + Store.chartparam.luckysheetCurrentChartResizeXy[4] - 60 - Store.chartparam.luckysheetCurrentChartResizeXy[0]);\n                            } else if (left <= 0) {\n                                left = 0;\n                                width = Store.chartparam.luckysheetCurrentChartResizeXy[2] + Store.chartparam.luckysheetCurrentChartResizeXy[0];\n                            }\n                        }\n                        if (Store.chartparam.luckysheetCurrentChartResize == 'rm' || Store.chartparam.luckysheetCurrentChartResize == 'rt' || Store.chartparam.luckysheetCurrentChartResize == 'rb') {\n                            width = Store.chartparam.luckysheetCurrentChartResizeXy[2] + leftchange;\n                            if (width < 60) {\n                                width = 60;\n                            } else if (width >= Store.chartparam.luckysheetCurrentChartResizeWinW - Store.chartparam.luckysheetCurrentChartResizeXy[4] - 22 - 36) {\n                                width = Store.chartparam.luckysheetCurrentChartResizeWinW - Store.chartparam.luckysheetCurrentChartResizeXy[4] - 22 - 36;\n                            }\n                        }\n                        if (Store.chartparam.luckysheetCurrentChartResize == 'mt' || Store.chartparam.luckysheetCurrentChartResize == 'lt' || Store.chartparam.luckysheetCurrentChartResize == 'rt') {\n                            top = y;\n                            height = Store.chartparam.luckysheetCurrentChartResizeXy[3] - topchange;\n                            if (top > Store.chartparam.luckysheetCurrentChartResizeXy[3] + Store.chartparam.luckysheetCurrentChartResizeXy[5] - 60) {\n                                top = Store.chartparam.luckysheetCurrentChartResizeXy[3] + Store.chartparam.luckysheetCurrentChartResizeXy[5] - 60;\n                                height = Store.chartparam.luckysheetCurrentChartResizeXy[3] - (Store.chartparam.luckysheetCurrentChartResizeXy[3] + Store.chartparam.luckysheetCurrentChartResizeXy[5] - 60 - Store.chartparam.luckysheetCurrentChartResizeXy[1]);\n                            } else if (top <= 0) {\n                                top = 0;\n                                height = Store.chartparam.luckysheetCurrentChartResizeXy[3] + Store.chartparam.luckysheetCurrentChartResizeXy[1];\n                            }\n                        }\n                        if (Store.chartparam.luckysheetCurrentChartResize == 'mb' || Store.chartparam.luckysheetCurrentChartResize == 'lb' || Store.chartparam.luckysheetCurrentChartResize == 'rb') {\n                            height = Store.chartparam.luckysheetCurrentChartResizeXy[3] + topchange;\n                            if (height < 60) {\n                                height = 60;\n                            } else if (height >= Store.chartparam.luckysheetCurrentChartResizeWinH - Store.chartparam.luckysheetCurrentChartResizeXy[5] - 42 - 6) {\n                                height = Store.chartparam.luckysheetCurrentChartResizeWinH - Store.chartparam.luckysheetCurrentChartResizeXy[5] - 42 - 6;\n                            }\n                        }\n                        const resizedata = {\n                            'top': top,\n                            'left': left,\n                            'height': height,\n                            'width': width\n                        };\n                        Store.chartparam.luckysheetCurrentChartResizeObj.css(resizedata);    // resize chart\n                        // resize chart\n                        Store.resizeChart(Store.chartparam.luckysheetCurrentChart);\n                    }    //image move\n                    else //image move\n                    if (imageCtrl.move) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        let imgItem = imageCtrl.images[imageCtrl.currentImgId];\n                        if (imgItem.isFixedPos) {\n                            x = event.pageX;\n                            y = event.pageY;\n                        }\n                        let myh = $('#luckysheet-modal-dialog-activeImage').height(), myw = $('#luckysheet-modal-dialog-activeImage').width();\n                        let top = y - imageCtrl.moveXY[1], left = x - imageCtrl.moveXY[0];\n                        let minTop = 0, maxTop = imageCtrl.currentWinH - myh - 42 - 6, minLeft = 0, maxLeft = imageCtrl.currentWinW - myw - 22 - 36;\n                        if (imgItem.isFixedPos) {\n                            minTop = Store.infobarHeight + Store.toolbarHeight + Store.calculatebarHeight + Store.columnHeaderHeight;\n                            maxTop = minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - myh;\n                            minLeft = Store.rowHeaderWidth;\n                            maxLeft = minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - myw;\n                        }\n                        if (top < minTop) {\n                            top = minTop;\n                        }\n                        if (top > maxTop) {\n                            top = maxTop;\n                        }\n                        if (left < minLeft) {\n                            left = minLeft;\n                        }\n                        if (left > maxLeft) {\n                            left = maxLeft;\n                        }\n                        $('#luckysheet-modal-dialog-activeImage').css({\n                            'left': left,\n                            'top': top\n                        });\n                    }    //image resize\n                    else //image resize\n                    if (!!imageCtrl.resize) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                        let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                        let x = mouse[0] + scrollLeft;\n                        let y = mouse[1] + scrollTop;\n                        if (x < 0 || y < 0) {\n                            return false;\n                        }\n                        let resizeXY = imageCtrl.resizeXY;\n                        let topchange = y - resizeXY[1], leftchange = x - resizeXY[0];\n                        let top = resizeXY[5], height = resizeXY[3], left = resizeXY[4], width = resizeXY[2];\n                        let resize = imageCtrl.resize;\n                        let imgItem = imageCtrl.images[imageCtrl.currentImgId];\n                        if (imgItem.isFixedPos) {\n                            let minTop = Store.infobarHeight + Store.toolbarHeight + Store.calculatebarHeight + Store.columnHeaderHeight;\n                            let minLeft = Store.rowHeaderWidth;\n                            if (resize == 'lt') {\n                                //左上\n                                left = resizeXY[4] - resizeXY[6] + leftchange;\n                                if (left < minLeft) {\n                                    left = minLeft;\n                                }\n                                if (left > resizeXY[4] - resizeXY[6] + resizeXY[2] - 1) {\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - 1;\n                                }\n                                width = resizeXY[4] - resizeXY[6] + resizeXY[2] - left;\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[5] - resizeXY[7] + resizeXY[3] - height;\n                                if (top < minTop) {\n                                    top = minTop;\n                                    height = resizeXY[5] - resizeXY[7] + resizeXY[3] - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - width;\n                                }\n                                if (top > resizeXY[5] - resizeXY[7] + resizeXY[3] - 1) {\n                                    top = resizeXY[5] - resizeXY[7] + resizeXY[3] - 1;\n                                    height = resizeXY[5] - resizeXY[7] + resizeXY[3] - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - width;\n                                }\n                            } else if (resize == 'lm') {\n                                //左中\n                                left = resizeXY[4] - resizeXY[6] + leftchange;\n                                if (left < minLeft) {\n                                    left = minLeft;\n                                }\n                                if (left > resizeXY[4] - resizeXY[6] + resizeXY[2] - 1) {\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - 1;\n                                }\n                                width = resizeXY[4] - resizeXY[6] + resizeXY[2] - left;\n                                top = resizeXY[5] - resizeXY[7];\n                                height = resizeXY[3];\n                            } else if (resize == 'lb') {\n                                //左下\n                                left = resizeXY[4] - resizeXY[6] + leftchange;\n                                if (left < minLeft) {\n                                    left = minLeft;\n                                }\n                                if (left > resizeXY[4] - resizeXY[6] + resizeXY[2] - 1) {\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - 1;\n                                }\n                                width = resizeXY[4] - resizeXY[6] + resizeXY[2] - left;\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[5] - resizeXY[7];\n                                if (height < 1) {\n                                    height = 1;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - width;\n                                }\n                                if (height > minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top) {\n                                    height = minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[4] - resizeXY[6] + resizeXY[2] - width;\n                                }\n                            } else if (resize == 'rt') {\n                                //右上\n                                left = resizeXY[4] - resizeXY[6];\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                }\n                                if (width > minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left) {\n                                    width = minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left;\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[5] - resizeXY[7] + resizeXY[3] - height;\n                                if (top < minTop) {\n                                    top = minTop;\n                                    height = resizeXY[5] - resizeXY[7] + resizeXY[3] - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                                if (top > resizeXY[5] - resizeXY[7] + resizeXY[3] - 1) {\n                                    top = resizeXY[5] - resizeXY[7] + resizeXY[3] - 1;\n                                    height = resizeXY[5] - resizeXY[7] + resizeXY[3] - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                            } else if (resize == 'rm') {\n                                //右中\n                                left = resizeXY[4] - resizeXY[6];\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                }\n                                if (width > minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left) {\n                                    width = minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left;\n                                }\n                                top = resizeXY[5] - resizeXY[7];\n                                height = resizeXY[3];\n                            } else if (resize == 'rb') {\n                                //右下\n                                left = resizeXY[4] - resizeXY[6];\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                }\n                                if (width > minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left) {\n                                    width = minLeft + Store.cellmainWidth - Store.cellMainSrollBarSize - left;\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[5] - resizeXY[7];\n                                if (height < 1) {\n                                    height = 1;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                                if (height > minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top) {\n                                    height = minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                            } else if (resize == 'mt') {\n                                //中上\n                                left = resizeXY[4] - resizeXY[6];\n                                width = resizeXY[2];\n                                top = resizeXY[5] - resizeXY[7] + topchange;\n                                if (top < minTop) {\n                                    top = minTop;\n                                }\n                                if (top > resizeXY[5] - resizeXY[7] + resizeXY[3] - 1) {\n                                    top = resizeXY[5] - resizeXY[7] + resizeXY[3] - 1;\n                                }\n                                height = resizeXY[5] - resizeXY[7] + resizeXY[3] - top;\n                            } else if (resize == 'mb') {\n                                //中下\n                                left = resizeXY[4] - resizeXY[6];\n                                width = resizeXY[2];\n                                top = resizeXY[5] - resizeXY[7];\n                                height = resizeXY[3] + topchange;\n                                if (height < 1) {\n                                    height = 1;\n                                }\n                                if (height > minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top) {\n                                    height = minTop + Store.cellmainHeight - Store.cellMainSrollBarSize - top;\n                                }\n                            }\n                        } else {\n                            if (resize == 'lt') {\n                                //左上\n                                left = x;\n                                width = resizeXY[2] - leftchange;\n                                if (left > resizeXY[2] + resizeXY[4] - 1) {\n                                    left = resizeXY[2] + resizeXY[4] - 1;\n                                    width = resizeXY[2] + resizeXY[0] - (resizeXY[2] + resizeXY[4] - 1);\n                                } else if (left <= 0) {\n                                    left = 0;\n                                    width = resizeXY[2] + resizeXY[0];\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[3] + resizeXY[1] - height;\n                                if (top > resizeXY[3] + resizeXY[5] - 1) {\n                                    top = resizeXY[3] + resizeXY[5] - 1;\n                                    height = resizeXY[3] + resizeXY[1] - (resizeXY[3] + resizeXY[5] - 1);\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[2] + resizeXY[0] - width;\n                                } else if (top <= 0) {\n                                    top = 0;\n                                    height = resizeXY[3] + resizeXY[1];\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[2] + resizeXY[0] - width;\n                                }\n                            } else if (resize == 'lm') {\n                                //左中\n                                left = x;\n                                width = resizeXY[2] - leftchange;\n                                if (left > resizeXY[2] + resizeXY[4] - 1) {\n                                    left = resizeXY[2] + resizeXY[4] - 1;\n                                    width = resizeXY[2] + resizeXY[0] - (resizeXY[2] + resizeXY[4] - 1);\n                                } else if (left <= 0) {\n                                    left = 0;\n                                    width = resizeXY[2] + resizeXY[0];\n                                }\n                            } else if (resize == 'lb') {\n                                //左下\n                                left = x;\n                                width = resizeXY[2] - leftchange;\n                                if (left > resizeXY[2] + resizeXY[4] - 1) {\n                                    left = resizeXY[2] + resizeXY[4] - 1;\n                                    width = resizeXY[2] + resizeXY[0] - (resizeXY[2] + resizeXY[4] - 1);\n                                } else if (left <= 0) {\n                                    left = 0;\n                                    width = resizeXY[2] + resizeXY[0];\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                if (height < 1) {\n                                    height = 1;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[2] + resizeXY[0] - width;\n                                } else if (height >= imageCtrl.currentWinH - resizeXY[5] - 42 - 6) {\n                                    height = imageCtrl.currentWinH - resizeXY[5] - 42 - 6;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                    left = resizeXY[2] + resizeXY[0] - width;\n                                }\n                            } else if (resize == 'rt') {\n                                //右上\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                } else if (width >= imageCtrl.currentWinW - resizeXY[4] - 22 - 36) {\n                                    width = imageCtrl.currentWinW - resizeXY[4] - 22 - 36;\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                top = resizeXY[3] + resizeXY[1] - height;\n                                if (top > resizeXY[3] + resizeXY[5] - 1) {\n                                    top = resizeXY[3] + resizeXY[5] - 1;\n                                    height = resizeXY[3] + resizeXY[1] - (resizeXY[3] + resizeXY[5] - 1);\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                } else if (top <= 0) {\n                                    top = 0;\n                                    height = resizeXY[3] + resizeXY[1];\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                            } else if (resize == 'rm') {\n                                //右中\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                } else if (width >= imageCtrl.currentWinW - resizeXY[4] - 22 - 36) {\n                                    width = imageCtrl.currentWinW - resizeXY[4] - 22 - 36;\n                                }\n                            } else if (resize == 'rb') {\n                                //右下\n                                width = resizeXY[2] + leftchange;\n                                if (width < 1) {\n                                    width = 1;\n                                } else if (width >= imageCtrl.currentWinW - resizeXY[4] - 22 - 36) {\n                                    width = imageCtrl.currentWinW - resizeXY[4] - 22 - 36;\n                                }\n                                height = Math.round(width * (resizeXY[3] / resizeXY[2]));\n                                if (height < 1) {\n                                    height = 1;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                } else if (height >= imageCtrl.currentWinH - resizeXY[5] - 42 - 6) {\n                                    height = imageCtrl.currentWinH - resizeXY[5] - 42 - 6;\n                                    width = Math.round(height * (resizeXY[2] / resizeXY[3]));\n                                }\n                            } else if (resize == 'mt') {\n                                //中上\n                                top = y;\n                                height = resizeXY[3] - topchange;\n                                if (top > resizeXY[3] + resizeXY[5] - 1) {\n                                    top = resizeXY[3] + resizeXY[5] - 1;\n                                    height = resizeXY[3] + resizeXY[1] - (resizeXY[3] + resizeXY[5] - 1);\n                                } else if (top <= 0) {\n                                    top = 0;\n                                    height = resizeXY[3] + resizeXY[1];\n                                }\n                            } else if (resize == 'mb') {\n                                //中下\n                                height = resizeXY[3] + topchange;\n                                if (height < 1) {\n                                    height = 1;\n                                } else if (height >= imageCtrl.currentWinH - resizeXY[5] - 42 - 6) {\n                                    height = imageCtrl.currentWinH - resizeXY[5] - 42 - 6;\n                                }\n                            }\n                        }\n                        $('#luckysheet-modal-dialog-activeImage').css({\n                            'width': width,\n                            'height': height,\n                            'left': left,\n                            'top': top\n                        });\n                        let scaleX = width / imgItem.crop.width;\n                        let scaleY = height / imgItem.crop.height;\n                        let defaultWidth = Math.round(imgItem.default.width * scaleX);\n                        let defaultHeight = Math.round(imgItem.default.height * scaleY);\n                        let offsetLeft = Math.round(imgItem.crop.offsetLeft * scaleX);\n                        let offsetTop = Math.round(imgItem.crop.offsetTop * scaleY);\n                        $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content').css({\n                            'background-size': defaultWidth + 'px ' + defaultHeight + 'px',\n                            'background-position': -offsetLeft + 'px ' + -offsetTop + 'px'\n                        });\n                    }    //image cropChange\n                    else //image cropChange\n                    if (!!imageCtrl.cropChange) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        if (x < 0 || y < 0) {\n                            return false;\n                        }\n                        let cropChangeXY = imageCtrl.cropChangeXY;\n                        let topchange = y - cropChangeXY[1], leftchange = x - cropChangeXY[0];\n                        let imgItem = imageCtrl.images[imageCtrl.currentImgId];\n                        let cropChange = imageCtrl.cropChange;\n                        let width, height, offsetLeft, offsetTop;\n                        if (cropChange == 'lt') {\n                            //左上\n                            offsetLeft = imgItem.crop.offsetLeft + leftchange;\n                            if (offsetLeft < 0) {\n                                offsetLeft = 0;\n                            }\n                            if (offsetLeft > imgItem.crop.width + imgItem.crop.offsetLeft - 1) {\n                                offsetLeft = imgItem.crop.width + imgItem.crop.offsetLeft - 1;\n                            }\n                            width = imgItem.crop.width + imgItem.crop.offsetLeft - offsetLeft;\n                            offsetTop = imgItem.crop.offsetTop + topchange;\n                            if (offsetTop < 0) {\n                                offsetTop = 0;\n                            }\n                            if (offsetTop > imgItem.crop.height + imgItem.crop.offsetTop - 1) {\n                                offsetTop = imgItem.crop.height + imgItem.crop.offsetTop - 1;\n                            }\n                            height = imgItem.crop.height + imgItem.crop.offsetTop - offsetTop;\n                        } else if (cropChange == 'lm') {\n                            //左中\n                            offsetLeft = imgItem.crop.offsetLeft + leftchange;\n                            if (offsetLeft < 0) {\n                                offsetLeft = 0;\n                            }\n                            if (offsetLeft > imgItem.crop.width + imgItem.crop.offsetLeft - 1) {\n                                offsetLeft = imgItem.crop.width + imgItem.crop.offsetLeft - 1;\n                            }\n                            width = imgItem.crop.width + imgItem.crop.offsetLeft - offsetLeft;\n                            offsetTop = imgItem.crop.offsetTop;\n                            height = imgItem.crop.height;\n                        } else if (cropChange == 'lb') {\n                            //左下\n                            offsetLeft = imgItem.crop.offsetLeft + leftchange;\n                            if (offsetLeft < 0) {\n                                offsetLeft = 0;\n                            }\n                            if (offsetLeft > imgItem.crop.width + imgItem.crop.offsetLeft - 1) {\n                                offsetLeft = imgItem.crop.width + imgItem.crop.offsetLeft - 1;\n                            }\n                            width = imgItem.crop.width + imgItem.crop.offsetLeft - offsetLeft;\n                            offsetTop = imgItem.crop.offsetTop;\n                            height = imgItem.crop.height + topchange;\n                            if (height < 1) {\n                                height = 1;\n                            }\n                            if (height > imgItem.default.height - offsetTop) {\n                                height = imgItem.default.height - offsetTop;\n                            }\n                        } else if (cropChange == 'rt') {\n                            //右上\n                            offsetLeft = imgItem.crop.offsetLeft;\n                            width = imgItem.crop.width + leftchange;\n                            if (width < 1) {\n                                width = 1;\n                            }\n                            if (width > imgItem.default.width - offsetLeft) {\n                                width = imgItem.default.width - offsetLeft;\n                            }\n                            offsetTop = imgItem.crop.offsetTop + topchange;\n                            if (offsetTop < 0) {\n                                offsetTop = 0;\n                            }\n                            if (offsetTop > imgItem.crop.height + imgItem.crop.offsetTop - 1) {\n                                offsetTop = imgItem.crop.height + imgItem.crop.offsetTop - 1;\n                            }\n                            height = imgItem.crop.height + imgItem.crop.offsetTop - offsetTop;\n                        } else if (cropChange == 'rm') {\n                            //右中\n                            offsetLeft = imgItem.crop.offsetLeft;\n                            width = imgItem.crop.width + leftchange;\n                            if (width < 1) {\n                                width = 1;\n                            }\n                            if (width > imgItem.default.width - offsetLeft) {\n                                width = imgItem.default.width - offsetLeft;\n                            }\n                            offsetTop = imgItem.crop.offsetTop;\n                            height = imgItem.crop.height;\n                        } else if (cropChange == 'rb') {\n                            //右下\n                            offsetLeft = imgItem.crop.offsetLeft;\n                            width = imgItem.crop.width + leftchange;\n                            if (width < 1) {\n                                width = 1;\n                            }\n                            if (width > imgItem.default.width - offsetLeft) {\n                                width = imgItem.default.width - offsetLeft;\n                            }\n                            offsetTop = imgItem.crop.offsetTop;\n                            height = imgItem.crop.height + topchange;\n                            if (height < 1) {\n                                height = 1;\n                            }\n                            if (height > imgItem.default.height - offsetTop) {\n                                height = imgItem.default.height - offsetTop;\n                            }\n                        } else if (cropChange == 'mt') {\n                            //中上\n                            offsetLeft = imgItem.crop.offsetLeft;\n                            width = imgItem.crop.width;\n                            offsetTop = imgItem.crop.offsetTop + topchange;\n                            if (offsetTop < 0) {\n                                offsetTop = 0;\n                            }\n                            if (offsetTop > imgItem.crop.height + imgItem.crop.offsetTop - 1) {\n                                offsetTop = imgItem.crop.height + imgItem.crop.offsetTop - 1;\n                            }\n                            height = imgItem.crop.height + imgItem.crop.offsetTop - offsetTop;\n                        } else if (cropChange == 'mb') {\n                            //中下\n                            offsetLeft = imgItem.crop.offsetLeft;\n                            width = imgItem.crop.width;\n                            offsetTop = imgItem.crop.offsetTop;\n                            height = imgItem.crop.height + topchange;\n                            if (height < 1) {\n                                height = 1;\n                            }\n                            if (height > imgItem.default.height - offsetTop) {\n                                height = imgItem.default.height - offsetTop;\n                            }\n                        }\n                        let left = imgItem.default.left + offsetLeft;\n                        let top = imgItem.default.top + offsetTop;\n                        if (imgItem.isFixedPos) {\n                            left = imgItem.fixedLeft + offsetLeft;\n                            top = imgItem.fixedTop + offsetTop;\n                        }\n                        $('#luckysheet-modal-dialog-cropping').show().css({\n                            'width': width,\n                            'height': height,\n                            'left': left,\n                            'top': top\n                        });\n                        $('#luckysheet-modal-dialog-cropping .cropping-mask').css({\n                            'width': imgItem.default.width,\n                            'height': imgItem.default.height,\n                            'background-image': 'url(' + imgItem.src + ')',\n                            'left': -offsetLeft,\n                            'top': -offsetTop\n                        });\n                        $('#luckysheet-modal-dialog-cropping .cropping-content').css({\n                            'background-image': 'url(' + imgItem.src + ')',\n                            'background-size': imgItem.default.width + 'px ' + imgItem.default.height + 'px',\n                            'background-position': -offsetLeft + 'px ' + -offsetTop + 'px'\n                        });\n                        imageCtrl.cropChangeObj = {\n                            width: width,\n                            height: height,\n                            offsetLeft: offsetLeft,\n                            offsetTop: offsetTop\n                        };\n                    } else if (luckysheetPostil.move) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        let myh = luckysheetPostil.currentObj.outerHeight(), myw = luckysheetPostil.currentObj.outerWidth();\n                        let top = y - luckysheetPostil.moveXY[1], left = x - luckysheetPostil.moveXY[0];\n                        if (top < 0) {\n                            top = 0;\n                        }\n                        if (top + myh + 42 + 6 > luckysheetPostil.currentWinH) {\n                            top = luckysheetPostil.currentWinH - myh - 42 - 6;\n                        }\n                        if (left < 0) {\n                            left = 0;\n                        }\n                        if (left + myw + 22 + 36 > luckysheetPostil.currentWinW) {\n                            left = luckysheetPostil.currentWinW - myw - 22 - 36;\n                        }\n                        luckysheetPostil.currentObj.css({\n                            'left': left,\n                            'top': top\n                        });\n                    } else if (!!luckysheetPostil.resize) {\n                        let mouse = mouseposition(event.pageX, event.pageY);\n                        let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                        let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                        if (x < 0 || y < 0) {\n                            return false;\n                        }\n                        let resizeXY = luckysheetPostil.resizeXY;\n                        let topchange = y - resizeXY[1], leftchange = x - resizeXY[0];\n                        let top = resizeXY[5], height = resizeXY[3], left = resizeXY[4], width = resizeXY[2];\n                        let resize = luckysheetPostil.resize;\n                        if (resize == 'lm' || resize == 'lt' || resize == 'lb') {\n                            left = x;\n                            width = resizeXY[2] - leftchange;\n                            if (left > resizeXY[2] + resizeXY[4] - 60) {\n                                left = resizeXY[2] + resizeXY[4] - 60;\n                                width = resizeXY[2] - (resizeXY[2] + resizeXY[4] - 60 - resizeXY[0]);\n                            } else if (left <= 0) {\n                                left = 0;\n                                width = resizeXY[2] + resizeXY[0];\n                            }\n                        }\n                        if (resize == 'rm' || resize == 'rt' || resize == 'rb') {\n                            width = resizeXY[2] + leftchange;\n                            if (width < 60) {\n                                width = 60;\n                            } else if (width >= luckysheetPostil.currentWinW - resizeXY[4] - 22 - 36) {\n                                width = luckysheetPostil.currentWinW - resizeXY[4] - 22 - 36;\n                            }\n                        }\n                        if (resize == 'mt' || resize == 'lt' || resize == 'rt') {\n                            top = y;\n                            height = resizeXY[3] - topchange;\n                            if (top > resizeXY[3] + resizeXY[5] - 60) {\n                                top = resizeXY[3] + resizeXY[5] - 60;\n                                height = resizeXY[3] - (resizeXY[3] + resizeXY[5] - 60 - resizeXY[1]);\n                            } else if (top <= 0) {\n                                top = 0;\n                                height = resizeXY[3] + resizeXY[1];\n                            }\n                        }\n                        if (resize == 'mb' || resize == 'lb' || resize == 'rb') {\n                            height = resizeXY[3] + topchange;\n                            if (height < 60) {\n                                height = 60;\n                            } else if (height >= luckysheetPostil.currentWinH - resizeXY[5] - 42 - 6) {\n                                height = luckysheetPostil.currentWinH - resizeXY[5] - 42 - 6;\n                            }\n                        }\n                        luckysheetPostil.currentObj.css({\n                            'width': width,\n                            'height': height,\n                            'left': left,\n                            'top': top\n                        });\n                    } else if (!!formula.rangeResize) {\n                        formula.rangeResizeDraging(event, formula.rangeResizeObj, formula.rangeResizexy, formula.rangeResize, formula.rangeResizeWinW, formula.rangeResizeWinH, Store.ch_width, Store.rh_height);\n                    } else if (!!formula.rangeMove) {\n                        formula.rangeMoveDraging(event, formula.rangeMovexy, formula.rangeMoveObj.data('range'), formula.rangeMoveObj, Store.sheetBarHeight, Store.statisticBarHeight);\n                    } else if (!!Store.chart_selection.rangeResize) {\n                        Store.chart_selection.rangeResizeDraging(event, Store.sheetBarHeight, Store.statisticBarHeight);\n                    } else if (!!Store.chart_selection.rangeMove) {\n                        Store.chart_selection.rangeMoveDraging(event, Store.sheetBarHeight, Store.statisticBarHeight);\n                    }\n                    Store.jfautoscrollTimeout = window.requestAnimationFrame(mouseRender);\n                }\n                Store.jfautoscrollTimeout = window.requestAnimationFrame(mouseRender);\n            }\n        });    //表格mouseup\n        //表格mouseup\n        $(document).on('mouseup.luckysheetEvent', function (event) {\n            if (luckysheetConfigsetting && luckysheetConfigsetting.hook && luckysheetConfigsetting.hook.sheetMouseup) {\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n                let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let margeset = menuButton.mergeborer(Store.flowdata, row_index, col_index);\n                if (!!margeset) {\n                    row = margeset.row[1];\n                    row_pre = margeset.row[0];\n                    row_index = margeset.row[2];\n                    col = margeset.column[1];\n                    col_pre = margeset.column[0];\n                    col_index = margeset.column[2];\n                }    // if(Store.flowdata[row_index] && Store.flowdata[row_index][col_index]){\n                // if(Store.flowdata[row_index] && Store.flowdata[row_index][col_index]){\n                let sheetFile = sheetmanage.getSheetByIndex();\n                let moveState = {\n                    functionResizeStatus: formula.functionResizeStatus,\n                    horizontalmoveState: !!luckysheetFreezen.horizontalmovestate,\n                    verticalmoveState: !!luckysheetFreezen.verticalmovestate,\n                    pivotTableMoveState: !!pivotTable && pivotTable.movestate,\n                    sheetMoveStatus: Store.luckysheet_sheet_move_status,\n                    scrollStatus: !!Store.luckysheet_scroll_status,\n                    selectStatus: !!Store.luckysheet_select_status,\n                    rowsSelectedStatus: !!Store.luckysheet_rows_selected_status,\n                    colsSelectedStatus: !!Store.luckysheet_cols_selected_status,\n                    cellSelectedMove: !!Store.luckysheet_cell_selected_move,\n                    cellSelectedExtend: !!Store.luckysheet_cell_selected_extend,\n                    colsChangeSize: !!Store.luckysheet_cols_change_size,\n                    rowsChangeSize: !!Store.luckysheet_rows_change_size,\n                    chartMove: !!Store.chartparam.luckysheetCurrentChartMove,\n                    chartResize: !!Store.chartparam.luckysheetCurrentChartResize,\n                    rangeResize: !!formula.rangeResize,\n                    rangeMove: !!formula.rangeMove\n                };\n                let luckysheetTableContent = $('#luckysheetTableContent').get(0).getContext('2d');\n                method.createHookFunction('sheetMouseup', Store.flowdata[row_index][col_index], {\n                    r: row_index,\n                    c: col_index,\n                    'start_r': row_pre,\n                    'start_c': col_pre,\n                    'end_r': row,\n                    'end_c': col\n                }, sheetFile, moveState, luckysheetTableContent);    // }\n            }    //数据窗格主体\n            // }\n            //数据窗格主体\n            if (Store.luckysheet_select_status) {\n                clearTimeout(Store.countfuncTimeout);\n                Store.countfuncTimeout = setTimeout(function () {\n                    countfunc();\n                }, 0);    //格式刷\n                //格式刷\n                if (menuButton.luckysheetPaintModelOn) {\n                    selection.pasteHandlerOfPaintModel(Store.luckysheet_copy_save);\n                    if (menuButton.luckysheetPaintSingle) {\n                        //单次 格式刷\n                        menuButton.cancelPaintModel();\n                    }\n                }\n            }\n            Store.luckysheet_select_status = false;\n            window.cancelAnimationFrame(Store.jfautoscrollTimeout);\n            Store.luckysheet_scroll_status = false;\n            $('#luckysheet-cell-selected').find('.luckysheet-cs-fillhandle').css('cursor', 'crosshair').end().find('.luckysheet-cs-draghandle').css('cursor', 'move');\n            $('#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0').css('cursor', 'default');    //行标题窗格主体\n            //行标题窗格主体\n            Store.luckysheet_rows_selected_status = false;    //列标题窗格主体\n            //列标题窗格主体\n            Store.luckysheet_cols_selected_status = false;\n            Store.luckysheet_model_move_state = false;\n            if (formula.functionResizeStatus) {\n                formula.functionResizeStatus = false;\n                $('#luckysheet-wa-calculate-size').removeAttr('style');\n            }\n            if (!!luckysheetFreezen.horizontalmovestate) {\n                luckysheetFreezen.horizontalmovestate = false;\n                $('#luckysheet-freezebar-horizontal').removeClass('luckysheet-freezebar-active');\n                $('#luckysheet-freezebar-horizontal').find('.luckysheet-freezebar-horizontal-handle').css('cursor', '-webkit-grab');\n                if (luckysheetFreezen.freezenhorizontaldata[4] <= Store.columnHeaderHeight) {\n                    luckysheetFreezen.cancelFreezenHorizontal();\n                }\n                luckysheetFreezen.createAssistCanvas();\n                luckysheetrefreshgrid();\n            }\n            if (!!luckysheetFreezen.verticalmovestate) {\n                luckysheetFreezen.verticalmovestate = false;\n                $('#luckysheet-freezebar-vertical').removeClass('luckysheet-freezebar-active');\n                $('#luckysheet-freezebar-vertical').find('.luckysheet-freezebar-vertical-handle').css('cursor', '-webkit-grab');\n                if (luckysheetFreezen.freezenverticaldata[4] <= Store.rowHeaderWidth) {\n                    luckysheetFreezen.cancelFreezenVertical();\n                }\n                luckysheetFreezen.createAssistCanvas();\n                luckysheetrefreshgrid();\n            }\n            if (!!pivotTable && pivotTable.movestate) {\n                $('#luckysheet-modal-dialog-slider-pivot-move').remove();\n                pivotTable.movestate = false;\n                $('#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').css('cursor', 'default');\n                if (pivotTable.movesave.containerid != 'luckysheet-modal-dialog-pivotTable-list') {\n                    let $cur = $(event.target).closest('.luckysheet-modal-dialog-slider-config-list');\n                    if ($cur.length == 0) {\n                        if (pivotTable.movesave.containerid == 'luckysheet-modal-dialog-config-value') {\n                            pivotTable.resetOrderby(pivotTable.movesave.obj);\n                        }\n                        pivotTable.movesave.obj.remove();\n                        pivotTable.showvaluecolrow();\n                        $('#luckysheet-modal-dialog-pivotTable-list').find('.luckysheet-modal-dialog-slider-list-item').each(function () {\n                            $(this).find('.luckysheet-slider-list-item-selected').find('i').remove();\n                        });\n                        $('#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value').find('.luckysheet-modal-dialog-slider-config-item').each(function () {\n                            let index = $(this).data('index');\n                            $('#luckysheet-modal-dialog-pivotTable-list').find('.luckysheet-modal-dialog-slider-list-item').each(function () {\n                                let $seleted = $(this).find('.luckysheet-slider-list-item-selected');\n                                if ($(this).data('index') == index && $seleted.find('i').length == 0) {\n                                    $seleted.append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                                }\n                            });\n                        });\n                        pivotTable.refreshPivotTable();\n                    }\n                }\n            }\n            if (Store.luckysheet_sheet_move_status) {\n                Store.luckysheet_sheet_move_status = false;\n                Store.luckysheet_sheet_move_data.activeobject.insertBefore($('#luckysheet-sheets-item-clone'));\n                Store.luckysheet_sheet_move_data.activeobject.removeAttr('style');\n                $('#luckysheet-sheets-item-clone').remove();\n                Store.luckysheet_sheet_move_data.cursorobject.css({ 'cursor': 'pointer' });\n                Store.luckysheet_sheet_move_data = {};\n                sheetmanage.reOrderAllSheet();\n            }    // chart move debounce timer clear\n            // chart move debounce timer clear\n            clearTimeout(Store.chartparam.luckysheetCurrentChartMoveTimeout);    //图表拖动 chartMix\n            //图表拖动 chartMix\n            if (!!Store.chartparam.luckysheetCurrentChartMove) {\n                Store.chartparam.luckysheetCurrentChartMove = false;\n                if (Store.chartparam.luckysheetInsertChartTosheetChange) {\n                    //myTop, myLeft: 本次的chart框位置，scrollLeft,scrollTop: 上一次的滚动条位置\n                    var myTop = Store.chartparam.luckysheetCurrentChartMoveObj.css('top'), myLeft = Store.chartparam.luckysheetCurrentChartMoveObj.css('left'), scrollLeft = $('#luckysheet-cell-main').scrollLeft(), scrollTop = $('#luckysheet-cell-main').scrollTop();    //点击时候存储的信息，即上一次操作结束的图表信息，x,y: chart框位置，scrollLeft1,scrollTop1: 滚动条位置\n                    //点击时候存储的信息，即上一次操作结束的图表信息，x,y: chart框位置，scrollLeft1,scrollTop1: 滚动条位置\n                    var x = Store.chartparam.luckysheetCurrentChartMoveXy[2];\n                    var y = Store.chartparam.luckysheetCurrentChartMoveXy[3];\n                    var scrollLeft1 = Store.chartparam.luckysheetCurrentChartMoveXy[4];\n                    var scrollTop1 = Store.chartparam.luckysheetCurrentChartMoveXy[5];\n                    var chart_id = Store.chartparam.luckysheetCurrentChartMoveObj.find('.luckysheet-modal-dialog-content').attr('id');    //去除chartobj,改用chart_id代替即可定位到此图表\n                    //去除chartobj,改用chart_id代替即可定位到此图表\n                    Store.jfredo.push({\n                        'type': 'moveChart',\n                        'chart_id': chart_id,\n                        'sheetIndex': Store.currentSheetIndex,\n                        'myTop': myTop,\n                        'myLeft': myLeft,\n                        'scrollTop': scrollTop,\n                        'scrollLeft': scrollLeft,\n                        'x': x,\n                        'y': y,\n                        'scrollTop1': scrollTop1,\n                        'scrollLeft1': scrollLeft1\n                    });    // luckysheet.sheetmanage.saveChart({ \"chart_id\": chart_id, \"sheetIndex\": sheetIndex, \"top\": myTop, \"left\": myLeft });\n                           //存储滚动条位置//协同编辑时可能影响用户操作，可以考虑不存储滚动条位置,或者滚动条信息仅仅保存到后台，但是不分发到其他设备（google sheet没有存储滚动条位置）\n                           // Store.server.saveParam(\"c\", sheetIndex, { \"left\":myLeft, \"top\":myTop,\"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft }, { \"op\":\"xy\", \"cid\": chart_id});\n                }\n            }    //图表改变大小 chartMix\n            // luckysheet.sheetmanage.saveChart({ \"chart_id\": chart_id, \"sheetIndex\": sheetIndex, \"top\": myTop, \"left\": myLeft });\n            //存储滚动条位置//协同编辑时可能影响用户操作，可以考虑不存储滚动条位置,或者滚动条信息仅仅保存到后台，但是不分发到其他设备（google sheet没有存储滚动条位置）\n            // Store.server.saveParam(\"c\", sheetIndex, { \"left\":myLeft, \"top\":myTop,\"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft }, { \"op\":\"xy\", \"cid\": chart_id});\n            //图表改变大小 chartMix\n            if (!!Store.chartparam.luckysheetCurrentChartResize) {\n                Store.chartparam.luckysheetCurrentChartResize = null;\n                if (Store.chartparam.luckysheetInsertChartTosheetChange) {\n                    var myHeight = Store.chartparam.luckysheetCurrentChartResizeObj.height(), myWidth = Store.chartparam.luckysheetCurrentChartResizeObj.width(), scrollLeft = $('#luckysheet-cell-main').scrollLeft(), scrollTop = $('#luckysheet-cell-main').scrollTop();\n                    var myTop = Store.chartparam.luckysheetCurrentChartMoveObj.css('top'), myLeft = Store.chartparam.luckysheetCurrentChartMoveObj.css('left');\n                    var chart_id = Store.chartparam.luckysheetCurrentChartResizeObj.find('.luckysheet-modal-dialog-content').attr('id');\n                    var myWidth1 = Store.chartparam.luckysheetCurrentChartResizeXy[2];\n                    var myHeight1 = Store.chartparam.luckysheetCurrentChartResizeXy[3];\n                    var x = Store.chartparam.luckysheetCurrentChartResizeXy[4];    //增加上一次的位置x，y\n                    //增加上一次的位置x，y\n                    var y = Store.chartparam.luckysheetCurrentChartResizeXy[5];\n                    var scrollLeft1 = Store.chartparam.luckysheetCurrentChartResizeXy[6];\n                    var scrollTop1 = Store.chartparam.luckysheetCurrentChartResizeXy[7];\n                    Store.jfredo.push({\n                        'type': 'resizeChart',\n                        'chart_id': chart_id,\n                        'sheetIndex': Store.currentSheetIndex,\n                        'myTop': myTop,\n                        'myLeft': myLeft,\n                        'myHeight': myHeight,\n                        'myWidth': myWidth,\n                        'scrollTop': scrollTop,\n                        'scrollLeft': scrollLeft,\n                        'x': x,\n                        'y': y,\n                        'myWidth1': myWidth1,\n                        'myHeight1': myHeight1,\n                        'scrollTop1': scrollTop1,\n                        'scrollLeft1': scrollLeft1\n                    });    //加上滚动条的位置\n                           // luckysheet.sheetmanage.saveChart({ \"chart_id\": chart_id, \"sheetIndex\": sheetIndex, \"height\": myHeight, \"width\": myWidth, \"top\": myTop, \"left\": myLeft, \"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft });\n                           // Store.server.saveParam(\"c\", sheetIndex, { \"width\":myWidth, \"height\":myHeight, \"top\": myTop, \"left\": myLeft, \"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft}, { \"op\":\"wh\", \"cid\": chart_id});\n                }\n            }\n            //加上滚动条的位置\n            // luckysheet.sheetmanage.saveChart({ \"chart_id\": chart_id, \"sheetIndex\": sheetIndex, \"height\": myHeight, \"width\": myWidth, \"top\": myTop, \"left\": myLeft, \"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft });\n            // Store.server.saveParam(\"c\", sheetIndex, { \"width\":myWidth, \"height\":myHeight, \"top\": myTop, \"left\": myLeft, \"scrollTop\": scrollTop, \"scrollLeft\": scrollLeft}, { \"op\":\"wh\", \"cid\": chart_id});\n            if (!!formula.rangeResize) {\n                formula.rangeResizeDragged(event, formula.rangeResizeObj, formula.rangeResize, formula.rangeResizexy, formula.rangeResizeWinW, formula.rangeResizeWinH);\n            }    //image move\n            //image move\n            if (imageCtrl.move) {\n                imageCtrl.moveImgItem();\n            }    //image resize\n            //image resize\n            if (imageCtrl.resize) {\n                imageCtrl.resizeImgItem();\n            }    //image cropChange\n            //image cropChange\n            if (imageCtrl.cropChange) {\n                imageCtrl.cropChangeImgItem();\n            }    //批注框 移动\n            //批注框 移动\n            if (luckysheetPostil.move) {\n                luckysheetPostil.move = false;\n                let ps_id = luckysheetPostil.currentObj.closest('.luckysheet-postil-show').attr('id');\n                let ps_r = ps_id.split('luckysheet-postil-show_')[1].split('_')[0];\n                let ps_c = ps_id.split('luckysheet-postil-show_')[1].split('_')[1];\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                let rc = [];\n                d[ps_r][ps_c].ps.left = luckysheetPostil.currentObj.position().left;\n                d[ps_r][ps_c].ps.top = luckysheetPostil.currentObj.position().top;\n                d[ps_r][ps_c].ps.value = luckysheetPostil.currentObj.find('.formulaInputFocus').text();\n                rc.push(ps_r + '_' + ps_c);\n                luckysheetPostil.ref(d, rc);\n                $('#' + ps_id).remove();\n                if (d[ps_r][ps_c].ps.isshow) {\n                    luckysheetPostil.buildPs(ps_r, ps_c, d[ps_r][ps_c].ps);\n                    $('#' + ps_id).addClass('luckysheet-postil-show-active');\n                    $('#' + ps_id).find('.luckysheet-postil-dialog-resize').show();\n                } else {\n                    luckysheetPostil.editPs(ps_r, ps_c);\n                }\n            }    //批注框 改变大小\n            //批注框 改变大小\n            if (!!luckysheetPostil.resize) {\n                luckysheetPostil.resize = null;\n                let ps_id = luckysheetPostil.currentObj.closest('.luckysheet-postil-show').attr('id');\n                let ps_r = ps_id.split('luckysheet-postil-show_')[1].split('_')[0];\n                let ps_c = ps_id.split('luckysheet-postil-show_')[1].split('_')[1];\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                let rc = [];\n                d[ps_r][ps_c].ps.left = luckysheetPostil.currentObj.position().left;\n                d[ps_r][ps_c].ps.top = luckysheetPostil.currentObj.position().top;\n                d[ps_r][ps_c].ps.width = luckysheetPostil.currentObj.outerWidth();\n                d[ps_r][ps_c].ps.height = luckysheetPostil.currentObj.outerHeight();\n                d[ps_r][ps_c].ps.value = luckysheetPostil.currentObj.find('.formulaInputFocus').text();\n                rc.push(ps_r + '_' + ps_c);\n                luckysheetPostil.ref(d, rc);\n                $('#' + ps_id).remove();\n                if (d[ps_r][ps_c].ps.isshow) {\n                    luckysheetPostil.buildPs(ps_r, ps_c, d[ps_r][ps_c].ps);\n                    $('#' + ps_id).addClass('luckysheet-postil-show-active');\n                    $('#' + ps_id).find('.luckysheet-postil-dialog-resize').show();\n                } else {\n                    luckysheetPostil.editPs(ps_r, ps_c);\n                }\n            }    //改变行高\n            //改变行高\n            if (Store.luckysheet_rows_change_size) {\n                Store.luckysheet_rows_change_size = false;\n                $('#luckysheet-change-size-line').hide();\n                $('#luckysheet-rows-change-size').css('opacity', 0);\n                $('#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas').css('cursor', 'default');\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let scrollTop = $('#luckysheet-rows-h').scrollTop();\n                let y = mouse[1] + scrollTop;\n                let winH = $(window).height();\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let size = y + 3 - Store.luckysheet_rows_change_size_start[0];\n                if (y + 3 - Store.luckysheet_rows_change_size_start[0] < 19) {\n                    size = 19;\n                }\n                if (y >= winH - 200 + scrollTop) {\n                    size = winH - 200 - Store.luckysheet_rows_change_size_start[0] + scrollTop;\n                }\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['rowlen'] == null) {\n                    cfg['rowlen'] = {};\n                }\n                if (cfg['customHeight'] == null) {\n                    cfg['customHeight'] = {};\n                }\n                cfg['customHeight'][Store.luckysheet_rows_change_size_start[1]] = 1;\n                const changeRowIndex = Store.luckysheet_rows_change_size_start[1];\n                let changeRowSelected = false;\n                if (Store['luckysheet_select_save'].length > 0) {\n                    Store['luckysheet_select_save'].filter(select => select.row_select).some(select => {\n                        if (changeRowIndex >= select.row[0] && changeRowIndex <= select.row[1]) {\n                            changeRowSelected = true;\n                        }\n                        return changeRowSelected;\n                    });\n                }\n                if (changeRowSelected) {\n                    Store['luckysheet_select_save'].filter(select => select.row_select).forEach(select => {\n                        for (let r = select.row[0]; r <= select.row[1]; r++) {\n                            cfg['rowlen'][r] = Math.ceil(size / Store.zoomRatio);\n                        }\n                    });\n                } else {\n                    cfg['rowlen'][Store.luckysheet_rows_change_size_start[1]] = Math.ceil(size / Store.zoomRatio);\n                }\n                let images = imageCtrl.moveChangeSize('row', Store.luckysheet_rows_change_size_start[1], size);\n                if (Store.clearjfundo) {\n                    Store.jfundo.length = 0;\n                    Store.jfredo.push({\n                        'type': 'resize',\n                        'ctrlType': 'resizeR',\n                        'sheetIndex': Store.currentSheetIndex,\n                        'config': $.extend(true, {}, Store.config),\n                        'curconfig': $.extend(true, {}, cfg),\n                        'images': $.extend(true, {}, imageCtrl.images),\n                        'curImages': $.extend(true, {}, images)\n                    });\n                }    //config\n                //config\n                Store.config = cfg;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                server.saveParam('cg', Store.currentSheetIndex, cfg['rowlen'], { 'k': 'rowlen' });    //images\n                //images\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].images = images;\n                server.saveParam('all', Store.currentSheetIndex, images, { 'k': 'images' });\n                imageCtrl.images = images;\n                imageCtrl.allImagesShow();\n                jfrefreshgrid_rhcw(Store.flowdata.length, null);\n            }    //改变列宽\n            //改变列宽\n            if (Store.luckysheet_cols_change_size) {\n                Store.luckysheet_cols_change_size = false;\n                $('#luckysheet-change-size-line').hide();\n                $('#luckysheet-cols-change-size').css('opacity', 0);\n                $('#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas').css('cursor', 'default');\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let scrollLeft = $('#luckysheet-cols-h-c').scrollLeft();\n                let x = mouse[0] + scrollLeft;\n                let winW = $(window).width();\n                let row_index = Store.visibledatarow.length - 1, row = Store.visibledatarow[row_index], row_pre = 0;\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let size = x + 3 - Store.luckysheet_cols_change_size_start[0];\n                let firstcolumnlen = Store.defaultcollen;\n                if (Store.config['columnlen'] != null && Store.config['columnlen'][Store.luckysheet_cols_change_size_start[1]] != null) {\n                    firstcolumnlen = Store.config['columnlen'][Store.luckysheet_cols_change_size_start[1]];\n                }\n                if (Math.abs(size - firstcolumnlen) < 3) {\n                    return;\n                }\n                if (x + 3 - Store.luckysheet_cols_change_size_start[0] < 30) {\n                    size = 30;\n                }\n                if (x >= winW - 100 + scrollLeft) {\n                    size = winW - 100 - Store.luckysheet_cols_change_size_start[0] + scrollLeft;\n                }\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['columnlen'] == null) {\n                    cfg['columnlen'] = {};\n                }\n                if (cfg['customWidth'] == null) {\n                    cfg['customWidth'] = {};\n                }\n                cfg['customWidth'][Store.luckysheet_cols_change_size_start[1]] = 1;\n                const changeColumnIndex = Store.luckysheet_cols_change_size_start[1];\n                let changeColumnSelected = false;\n                if (Store['luckysheet_select_save'].length > 0) {\n                    Store['luckysheet_select_save'].filter(select => select.column_select).some(select => {\n                        if (changeColumnIndex >= select.column[0] && changeColumnIndex <= select.column[1]) {\n                            changeColumnSelected = true;\n                        }\n                        return changeColumnSelected;\n                    });\n                }\n                if (changeColumnSelected) {\n                    Store['luckysheet_select_save'].filter(select => select.column_select).forEach(select => {\n                        for (let r = select.column[0]; r <= select.column[1]; r++) {\n                            cfg['columnlen'][r] = Math.ceil(size / Store.zoomRatio);\n                        }\n                    });\n                } else {\n                    cfg['columnlen'][Store.luckysheet_cols_change_size_start[1]] = Math.ceil(size / Store.zoomRatio);\n                }\n                let images = imageCtrl.moveChangeSize('column', Store.luckysheet_cols_change_size_start[1], size);\n                if (Store.clearjfundo) {\n                    Store.jfundo.length = 0;\n                    Store.jfredo.push({\n                        'type': 'resize',\n                        'ctrlType': 'resizeC',\n                        'sheetIndex': Store.currentSheetIndex,\n                        'config': $.extend(true, {}, Store.config),\n                        'curconfig': $.extend(true, {}, cfg),\n                        'images': $.extend(true, {}, imageCtrl.images),\n                        'curImages': $.extend(true, {}, images)\n                    });\n                }    //config\n                //config\n                Store.config = cfg;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                server.saveParam('cg', Store.currentSheetIndex, cfg['columnlen'], { 'k': 'columnlen' });    //images\n                //images\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].images = images;\n                server.saveParam('all', Store.currentSheetIndex, images, { 'k': 'images' });\n                imageCtrl.images = images;\n                imageCtrl.allImagesShow();\n                jfrefreshgrid_rhcw(null, Store.flowdata[0].length);\n                setTimeout(function () {\n                    luckysheetrefreshgrid();\n                }, 1);\n            }\n            if (formula.rangeMove) {\n                formula.rangeMoveDragged(formula.rangeMoveObj);\n            }    //改变选择框的位置并替换目标单元格\n            //改变选择框的位置并替换目标单元格\n            if (Store.luckysheet_cell_selected_move) {\n                $('#luckysheet-cell-selected-move').hide();\n                Store.luckysheet_cell_selected_move = false;\n                let mouse = mouseposition(event.pageX, event.pageY);\n                if (!checkProtectionLockedRangeList(Store.luckysheet_select_save, Store.currentSheetIndex)) {\n                    return;\n                }\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let x = mouse[0] + scrollLeft;\n                let y = mouse[1] + scrollTop;\n                let winH = $(window).height() + scrollTop - Store.sheetBarHeight - Store.statisticBarHeight, winW = $(window).width() + scrollLeft;\n                let row_index = rowLocation(y)[2];\n                let col_index = colLocation(x)[2];\n                let row_index_original = Store.luckysheet_cell_selected_move_index[0], col_index_original = Store.luckysheet_cell_selected_move_index[1];\n                if (row_index == row_index_original && col_index == col_index_original) {\n                    return;\n                }\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                let data = getdatabyselection(last);\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['merge'] == null) {\n                    cfg['merge'] = {};\n                }\n                if (cfg['rowlen'] == null) {\n                    cfg['rowlen'] = {};\n                }    //选区包含部分单元格\n                //选区包含部分单元格\n                if (hasPartMC(cfg, last['row'][0], last['row'][1], last['column'][0], last['column'][1])) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMerge);\n                    } else {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', locale_drag.noMerge);\n                    }\n                    return;\n                }\n                let row_s = last['row'][0] - row_index_original + row_index, row_e = last['row'][1] - row_index_original + row_index;\n                let col_s = last['column'][0] - col_index_original + col_index, col_e = last['column'][1] - col_index_original + col_index;\n                if (!checkProtectionLockedRangeList([{\n                            row: [\n                                row_s,\n                                row_e\n                            ],\n                            column: [\n                                col_s,\n                                col_e\n                            ]\n                        }], Store.currentSheetIndex)) {\n                    return;\n                }\n                if (row_s < 0 || y < 0) {\n                    row_s = 0;\n                    row_e = last['row'][1] - last['row'][0];\n                }\n                if (col_s < 0 || x < 0) {\n                    col_s = 0;\n                    col_e = last['column'][1] - last['column'][0];\n                }\n                if (row_e >= Store.visibledatarow[Store.visibledatarow.length - 1] || y > winH) {\n                    row_s = Store.visibledatarow.length - 1 - last['row'][1] + last['row'][0];\n                    row_e = Store.visibledatarow.length - 1;\n                }\n                if (col_e >= Store.visibledatacolumn[Store.visibledatacolumn.length - 1] || x > winW) {\n                    col_s = Store.visibledatacolumn.length - 1 - last['column'][1] + last['column'][0];\n                    col_e = Store.visibledatacolumn.length - 1;\n                }    //替换的位置包含部分单元格\n                //替换的位置包含部分单元格\n                if (hasPartMC(cfg, row_s, row_e, col_s, col_e)) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMerge);\n                    } else {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', locale_drag.noMerge);\n                    }\n                    return;\n                }\n                let borderInfoCompute = getBorderInfoCompute(Store.currentSheetIndex);    //删除原本位置的数据\n                //删除原本位置的数据\n                let RowlChange = null;\n                for (let r = last['row'][0]; r <= last['row'][1]; r++) {\n                    if (r in cfg['rowlen']) {\n                        RowlChange = true;\n                    }\n                    for (let c = last['column'][0]; c <= last['column'][1]; c++) {\n                        let cell = d[r][c];\n                        if (getObjType(cell) == 'object' && 'mc' in cell) {\n                            if (cell['mc'].r + '_' + cell['mc'].c in cfg['merge']) {\n                                delete cfg['merge'][cell['mc'].r + '_' + cell['mc'].c];\n                            }\n                        }\n                        d[r][c] = null;\n                    }\n                }    //边框\n                //边框\n                if (cfg['borderInfo'] && cfg['borderInfo'].length > 0) {\n                    let borderInfo = [];\n                    for (let i = 0; i < cfg['borderInfo'].length; i++) {\n                        let bd_rangeType = cfg['borderInfo'][i].rangeType;\n                        if (bd_rangeType == 'range') {\n                            let bd_range = cfg['borderInfo'][i].range;\n                            let bd_emptyRange = [];\n                            for (let j = 0; j < bd_range.length; j++) {\n                                bd_emptyRange = bd_emptyRange.concat(conditionformat.CFSplitRange(bd_range[j], {\n                                    'row': last['row'],\n                                    'column': last['column']\n                                }, {\n                                    'row': [\n                                        row_s,\n                                        row_e\n                                    ],\n                                    'column': [\n                                        col_s,\n                                        col_e\n                                    ]\n                                }, 'restPart'));\n                            }\n                            cfg['borderInfo'][i].range = bd_emptyRange;\n                            borderInfo.push(cfg['borderInfo'][i]);\n                        } else if (bd_rangeType == 'cell') {\n                            let bd_r = cfg['borderInfo'][i].value.row_index;\n                            let bd_c = cfg['borderInfo'][i].value.col_index;\n                            if (!(bd_r >= last['row'][0] && bd_r <= last['row'][1] && bd_c >= last['column'][0] && bd_c <= last['column'][1])) {\n                                borderInfo.push(cfg['borderInfo'][i]);\n                            }\n                        }\n                    }\n                    cfg['borderInfo'] = borderInfo;\n                }    //替换位置数据更新\n                //替换位置数据更新\n                let offsetMC = {};\n                for (let r = 0; r < data.length; r++) {\n                    for (let c = 0; c < data[0].length; c++) {\n                        if (borderInfoCompute[r + last['row'][0] + '_' + (c + last['column'][0])]) {\n                            let bd_obj = {\n                                'rangeType': 'cell',\n                                'value': {\n                                    'row_index': r + row_s,\n                                    'col_index': c + col_s,\n                                    'l': borderInfoCompute[r + last['row'][0] + '_' + (c + last['column'][0])].l,\n                                    'r': borderInfoCompute[r + last['row'][0] + '_' + (c + last['column'][0])].r,\n                                    't': borderInfoCompute[r + last['row'][0] + '_' + (c + last['column'][0])].t,\n                                    'b': borderInfoCompute[r + last['row'][0] + '_' + (c + last['column'][0])].b\n                                }\n                            };\n                            if (cfg['borderInfo'] == null) {\n                                cfg['borderInfo'] = [];\n                            }\n                            cfg['borderInfo'].push(bd_obj);\n                        }\n                        let value = '';\n                        if (data[r] != null && data[r][c] != null) {\n                            value = data[r][c];\n                        }\n                        if (getObjType(value) == 'object' && 'mc' in value) {\n                            let mc = $.extend(true, {}, value['mc']);\n                            if ('rs' in value['mc']) {\n                                offsetMC[mc.r + '_' + mc.c] = [\n                                    r + row_s,\n                                    c + col_s\n                                ];\n                                value['mc'].r = r + row_s;\n                                value['mc'].c = c + col_s;\n                                cfg['merge'][r + row_s + '_' + (c + col_s)] = value['mc'];\n                            } else {\n                                value['mc'].r = offsetMC[mc.r + '_' + mc.c][0];\n                                value['mc'].c = offsetMC[mc.r + '_' + mc.c][1];\n                            }\n                        }\n                        d[r + row_s][c + col_s] = value;\n                    }\n                }\n                if (RowlChange) {\n                    cfg = rowlenByRange(d, last['row'][0], last['row'][1], cfg);\n                    cfg = rowlenByRange(d, row_s, row_e, cfg);\n                }    //条件格式\n                //条件格式\n                let cdformat = $.extend(true, [], Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_conditionformat_save']);\n                if (cdformat != null && cdformat.length > 0) {\n                    for (let i = 0; i < cdformat.length; i++) {\n                        let cdformat_cellrange = cdformat[i].cellrange;\n                        let emptyRange = [];\n                        for (let j = 0; j < cdformat_cellrange.length; j++) {\n                            let range = conditionformat.CFSplitRange(cdformat_cellrange[j], {\n                                'row': last['row'],\n                                'column': last['column']\n                            }, {\n                                'row': [\n                                    row_s,\n                                    row_e\n                                ],\n                                'column': [\n                                    col_s,\n                                    col_e\n                                ]\n                            }, 'allPart');\n                            emptyRange = emptyRange.concat(range);\n                        }\n                        cdformat[i].cellrange = emptyRange;\n                    }\n                }\n                let rf;\n                if (Store.luckysheet_select_save[0].row_focus == Store.luckysheet_select_save[0].row[0]) {\n                    rf = row_s;\n                } else {\n                    rf = row_e;\n                }\n                let cf;\n                if (Store.luckysheet_select_save[0].column_focus == Store.luckysheet_select_save[0].column[0]) {\n                    cf = col_s;\n                } else {\n                    cf = col_e;\n                }\n                let range = [];\n                range.push({\n                    'row': last['row'],\n                    'column': last['column']\n                });\n                range.push({\n                    'row': [\n                        row_s,\n                        row_e\n                    ],\n                    'column': [\n                        col_s,\n                        col_e\n                    ]\n                });\n                last['row'] = [\n                    row_s,\n                    row_e\n                ];\n                last['column'] = [\n                    col_s,\n                    col_e\n                ];\n                last['row_focus'] = rf;\n                last['column_focus'] = cf;\n                let allParam = {\n                    'cfg': cfg,\n                    'RowlChange': RowlChange,\n                    'cdformat': cdformat\n                };\n                jfrefreshgrid(d, range, allParam);\n                selectHightlightShow();\n                $('#luckysheet-sheettable').css('cursor', 'default');\n                clearTimeout(Store.countfuncTimeout);\n                Store.countfuncTimeout = setTimeout(function () {\n                    countfunc();\n                }, 500);\n            }    //图表选区拖拽移动\n            //图表选区拖拽移动\n            if (Store.chart_selection.rangeMove) {\n                Store.chart_selection.rangeMoveDragged();\n            }    //图表选区拖拽拉伸\n            //图表选区拖拽拉伸\n            if (!!Store.chart_selection.rangeResize) {\n                Store.chart_selection.rangeResizeDragged();\n            }    //选区下拉\n            //选区下拉\n            if (Store.luckysheet_cell_selected_extend) {\n                Store.luckysheet_cell_selected_extend = false;\n                $('#luckysheet-cell-selected-extend').hide();\n                if (!checkProtectionLockedRangeList(Store.luckysheet_select_save, Store.currentSheetIndex)) {\n                    return;\n                }\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let x = mouse[0] + scrollLeft - 5;\n                let y = mouse[1] + scrollTop - 5;\n                let winH = $(window).height() + scrollTop - Store.sheetBarHeight - Store.statisticBarHeight, winW = $(window).width() + scrollLeft;\n                let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n                let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n                let row_index_original = Store.luckysheet_cell_selected_extend_index[0], col_index_original = Store.luckysheet_cell_selected_extend_index[1];\n                let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                let row_s = last['row'][0], row_e = last['row'][1];\n                let col_s = last['column'][0], col_e = last['column'][1];\n                if (row_s < 0 || y < 0) {\n                    row_s = 0;\n                    row_e = last['row'][1] - last['row'][0];\n                }\n                if (col_s < 0 || x < 0) {\n                    col_s = 0;\n                    col_e = last['column'][1] - last['column'][0];\n                }\n                if (row_e >= Store.visibledatarow[Store.visibledatarow.length - 1] || y > winH) {\n                    row_s = Store.visibledatarow.length - 1 - last['row'][1] + last['row'][0];\n                    row_e = Store.visibledatarow.length - 1;\n                }\n                if (col_e >= Store.visibledatacolumn[Store.visibledatacolumn.length - 1] || x > winW) {\n                    col_s = Store.visibledatacolumn.length - 1 - last['column'][1] + last['column'][0];\n                    col_e = Store.visibledatacolumn.length - 1;\n                }    //复制范围\n                //复制范围\n                luckysheetDropCell.copyRange = {\n                    'row': $.extend(true, [], last['row']),\n                    'column': $.extend(true, [], last['column'])\n                };    //applyType\n                //applyType\n                let typeItemHide = luckysheetDropCell.typeItemHide();\n                if (!typeItemHide[0] && !typeItemHide[1] && !typeItemHide[2] && !typeItemHide[3] && !typeItemHide[4] && !typeItemHide[5] && !typeItemHide[6]) {\n                    luckysheetDropCell.applyType = '0';\n                } else {\n                    luckysheetDropCell.applyType = '1';\n                }\n                if (Math.abs(row_index_original - row_index) > Math.abs(col_index_original - col_index)) {\n                    if (!(row_index >= row_s && row_index <= row_e)) {\n                        if (Store.luckysheet_select_save[0].top_move >= row_pre) {\n                            //当往上拖拽时\n                            luckysheetDropCell.applyRange = {\n                                'row': [\n                                    row_index,\n                                    last['row'][0] - 1\n                                ],\n                                'column': last['column']\n                            };\n                            luckysheetDropCell.direction = 'up';\n                            row_s -= last['row'][0] - row_index;    //是否有数据透视表范围\n                            //是否有数据透视表范围\n                            if (pivotTable.isPivotRange(row_s, col_e)) {\n                                tooltip.info(locale_drag.affectPivot, '');\n                                return;\n                            }\n                        } else {\n                            //当往下拖拽时\n                            luckysheetDropCell.applyRange = {\n                                'row': [\n                                    last['row'][1] + 1,\n                                    row_index\n                                ],\n                                'column': last['column']\n                            };\n                            luckysheetDropCell.direction = 'down';\n                            row_e += row_index - last['row'][1];    //是否有数据透视表范围\n                            //是否有数据透视表范围\n                            if (pivotTable.isPivotRange(row_e, col_e)) {\n                                tooltip.info(locale_drag.affectPivot, '');\n                                return;\n                            }\n                        }\n                    } else {\n                        return;\n                    }\n                } else {\n                    if (!(col_index >= col_s && col_index <= col_e)) {\n                        if (Store.luckysheet_select_save[0].left_move >= col_pre) {\n                            //当往左拖拽时\n                            luckysheetDropCell.applyRange = {\n                                'row': last['row'],\n                                'column': [\n                                    col_index,\n                                    last['column'][0] - 1\n                                ]\n                            };\n                            luckysheetDropCell.direction = 'left';\n                            col_s -= last['column'][0] - col_index;    //是否有数据透视表范围\n                            //是否有数据透视表范围\n                            if (pivotTable.isPivotRange(row_e, col_s)) {\n                                tooltip.info(locale_drag.affectPivot, '');\n                                return;\n                            }\n                        } else {\n                            //当往右拖拽时\n                            luckysheetDropCell.applyRange = {\n                                'row': last['row'],\n                                'column': [\n                                    last['column'][1] + 1,\n                                    col_index\n                                ]\n                            };\n                            luckysheetDropCell.direction = 'right';\n                            col_e += col_index - last['column'][1];    //是否有数据透视表范围\n                            //是否有数据透视表范围\n                            if (pivotTable.isPivotRange(row_e, col_e)) {\n                                tooltip.info(locale_drag.affectPivot, '');\n                                return;\n                            }\n                        }\n                    } else {\n                        return;\n                    }\n                }\n                if (Store.config['merge'] != null) {\n                    let hasMc = false;\n                    for (let r = last['row'][0]; r <= last['row'][1]; r++) {\n                        for (let c = last['column'][0]; c <= last['column'][1]; c++) {\n                            let cell = Store.flowdata[r][c];\n                            if (cell != null && cell.mc != null) {\n                                hasMc = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (hasMc) {\n                        if (isEditMode()) {\n                            alert(locale_drag.noMerge);\n                        } else {\n                            tooltip.info(locale_drag.noMerge, '');\n                        }\n                        return;\n                    }\n                    for (let r = row_s; r <= row_e; r++) {\n                        for (let c = col_s; c <= col_e; c++) {\n                            let cell = Store.flowdata[r][c];\n                            if (cell != null && cell.mc != null) {\n                                hasMc = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (hasMc) {\n                        if (isEditMode()) {\n                            alert(locale_drag.noMerge);\n                        } else {\n                            tooltip.info(locale_drag.noMerge, '');\n                        }\n                        return;\n                    }\n                }\n                last['row'] = [\n                    row_s,\n                    row_e\n                ];\n                last['column'] = [\n                    col_s,\n                    col_e\n                ];\n                luckysheetDropCell.update();\n                luckysheetDropCell.createIcon();\n                $('#luckysheet-cell-selected-move').hide();\n                $('#luckysheet-sheettable').css('cursor', 'default');\n                clearTimeout(Store.countfuncTimeout);\n                Store.countfuncTimeout = setTimeout(function () {\n                    countfunc();\n                }, 500);\n            }\n        });    //禁止浏览器 右键默认菜单\n        //禁止浏览器 右键默认菜单\n        $('.luckysheet-grid-container, #luckysheet-rightclick-menu').on('contextmenu', function (e) {\n            e.preventDefault();\n        });    // //禁止前台编辑(只可 框选单元格、滚动查看表格)\n               // if(!Store.allowEdit){\n               //     return;\n               // }\n               //选区拖动替换\n        // //禁止前台编辑(只可 框选单元格、滚动查看表格)\n        // if(!Store.allowEdit){\n        //     return;\n        // }\n        //选区拖动替换\n        $('#luckysheet-cell-main div.luckysheet-cs-draghandle').mousedown(function (event) {\n            if (isEditMode() || Store.allowEdit === false) {\n                //此模式下禁用选区拖动\n                return;\n            }\n            $('#luckysheet-cell-selected').find('.luckysheet-cs-fillhandle').css('cursor', 'move').end().find('.luckysheet-cs-draghandle').css('cursor', 'move');\n            $('#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0').css('cursor', 'move');\n            Store.luckysheet_cell_selected_move = true;\n            Store.luckysheet_scroll_status = true;\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n            let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n            let row_location = rowLocation(y), row_pre = row_location[0], row = row_location[1], row_index = row_location[2];\n            let col_location = colLocation(x), col_pre = col_location[0], col = col_location[1], col_index = col_location[2];\n            Store.luckysheet_cell_selected_move_index = [\n                row_index,\n                col_index\n            ];\n            $('#luckysheet-cell-selected-move').css({\n                'left': col_pre,\n                'width': col - col_pre - 1,\n                'top': row_pre,\n                'height': row - row_pre - 1,\n                'display': 'block'\n            });\n            event.stopPropagation();\n        });    //选区下拉\n        //选区下拉\n        $('#luckysheet-cell-main div.luckysheet-cs-fillhandle').mousedown(function (event) {\n            if (isEditMode() || Store.allowEdit === false) {\n                //此模式下禁用选区下拉\n                return;\n            }\n            $('#luckysheet-cell-selected').find('.luckysheet-cs-fillhandle').css('cursor', 'crosshair').end().find('.luckysheet-cs-draghandle').css('cursor', 'crosshair');\n            $('#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0').css('cursor', 'crosshair');\n            Store.luckysheet_cell_selected_extend_time = setTimeout(function () {\n                Store.luckysheet_cell_selected_extend = true;\n                Store.luckysheet_scroll_status = true;\n                let mouse = mouseposition(event.pageX, event.pageY);\n                let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft() - 5;\n                let y = mouse[1] + $('#luckysheet-cell-main').scrollTop() - 5;\n                let row_location = rowLocation(y), row_pre = row_location[0], row = row_location[1], row_index = row_location[2];\n                let col_location = colLocation(x), col_pre = col_location[0], col = col_location[1], col_index = col_location[2];\n                Store.luckysheet_cell_selected_extend_index = [\n                    row_index,\n                    col_index\n                ];\n                $('#luckysheet-cell-selected-extend').css({\n                    'left': col_pre,\n                    'width': col - col_pre - 1,\n                    'top': row_pre,\n                    'height': row - row_pre - 1,\n                    'display': 'block'\n                });\n            }, 100);\n            event.stopPropagation();\n        }).click(function () {\n            clearTimeout(Store.luckysheet_cell_selected_extend_time);\n            event.stopPropagation();\n        }).dblclick(function () {\n            let last = Store.luckysheet_select_save[0];\n            let r0 = last.row[0], r1 = last.row[1], c0 = last.column[0], c1 = last.column[1];\n            if (pivotTable.isPivotRange(r0, c0)) {\n                return;\n            }\n            let dropCellState = false;\n            let step = 0;\n            for (let r = r1 + 1; r < Store.flowdata.length; r++) {\n                if (c0 - 1 >= 0 && c1 + 1 < Store.flowdata[0].length) {\n                    let cell1 = Store.flowdata[r][c0 - 1];\n                    let cell2 = Store.flowdata[r][c1 + 1];\n                    if (r == r1 + 1) {\n                        if ((cell1 == null || isRealNull(cell1.v)) && (cell2 == null || isRealNull(cell2.v))) {\n                            dropCellState = false;\n                            break;\n                        } else {\n                            dropCellState = true;\n                            step++;\n                        }\n                    } else {\n                        if ((cell1 == null || isRealNull(cell1.v)) && (cell2 == null || isRealNull(cell2.v))) {\n                            break;\n                        }\n                        step++;\n                    }\n                } else if (c0 - 1 >= 0) {\n                    let cell = Store.flowdata[r][c0 - 1];\n                    if (r == r1 + 1) {\n                        if (cell == null || isRealNull(cell.v)) {\n                            dropCellState = false;\n                            break;\n                        } else {\n                            dropCellState = true;\n                            step++;\n                        }\n                    } else {\n                        if (cell == null || isRealNull(cell.v)) {\n                            break;\n                        }\n                        step++;\n                    }\n                } else if (c1 + 1 < Store.flowdata[0].length) {\n                    let cell = Store.flowdata[r][c1 + 1];\n                    if (r == r1 + 1) {\n                        if (cell == null || isRealNull(cell.v)) {\n                            dropCellState = false;\n                            break;\n                        } else {\n                            dropCellState = true;\n                            step++;\n                        }\n                    } else {\n                        if (cell == null || isRealNull(cell.v)) {\n                            break;\n                        }\n                        step++;\n                    }\n                }\n            }\n            if (!dropCellState || step == 0) {\n                event.stopPropagation();\n                return;\n            }    //复制范围\n            //复制范围\n            luckysheetDropCell.copyRange = {\n                'row': [\n                    r0,\n                    r1\n                ],\n                'column': [\n                    c0,\n                    c1\n                ]\n            };    //applyType\n            //applyType\n            let typeItemHide = luckysheetDropCell.typeItemHide();\n            if (!typeItemHide[0] && !typeItemHide[1] && !typeItemHide[2] && !typeItemHide[3] && !typeItemHide[4] && !typeItemHide[5] && !typeItemHide[6]) {\n                luckysheetDropCell.applyType = '0';\n            } else {\n                luckysheetDropCell.applyType = '1';\n            }\n            luckysheetDropCell.applyRange = {\n                'row': [\n                    r1 + 1,\n                    r1 + step\n                ],\n                'column': [\n                    c0,\n                    c1\n                ]\n            };\n            luckysheetDropCell.direction = 'down';\n            Store.luckysheet_select_save = [{\n                    'row': [\n                        r0,\n                        r1 + step\n                    ],\n                    'column': [\n                        c0,\n                        c1\n                    ]\n                }];\n            luckysheetDropCell.update();\n            luckysheetDropCell.createIcon();\n            $('#luckysheet-cell-selected-move').hide();\n            $('#luckysheet-sheettable').css('cursor', 'default');\n            clearTimeout(Store.countfuncTimeout);\n            Store.countfuncTimeout = setTimeout(function () {\n                countfunc();\n            }, 500);\n            event.stopPropagation();\n        });    //\n        //\n        $('#luckysheet-bottom-add-row, #luckysheet-bottom-add-row-input, #luckysheet-bottom-return-top').on('mousedown dblclick mouseup', function (e) {\n            e.stopPropagation();\n        });    //底部添加行按钮\n        //底部添加行按钮\n        $('#luckysheet-bottom-add-row').on('click', function (e) {\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            let $t = $(this), value = $('#luckysheet-bottom-add-row-input').val();\n            if (value == '') {\n                value = 100;\n            }\n            if (isNaN(parseInt(value))) {\n                if (isEditMode()) {\n                    alert(locale_info.tipInputNumber);\n                } else {\n                    tooltip.info('error', locale_info.tipInputNumber);\n                }\n                return;\n            }\n            value = parseInt(value);\n            if (value < 1 || value > 100) {\n                if (isEditMode()) {\n                    alert(locale_info.tipInputNumberLimit);\n                } else {\n                    tooltip.info('error', locale_info.tipInputNumberLimit);\n                }\n                return;\n            }\n            luckysheetextendtable('row', Store.flowdata.length - 1, value);\n        });\n        $('#luckysheet-bottom-return-top').on('click', function (e) {\n            $('#luckysheet-scrollbar-y').scrollTop(0);\n        });    //右键菜单 复制按钮\n        //右键菜单 复制按钮\n        $('#luckysheet-copy-btn, #luckysheet-cols-copy-btn, #luckysheet-paste-btn-title').click(function (event) {\n            $(this).parent().hide();    //复制范围内包含部分合并单元格，提示\n            //复制范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n            }    //多重选区 有条件格式时 提示\n            //多重选区 有条件格式时 提示\n            let cdformat = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].luckysheet_conditionformat_save;\n            if (Store.luckysheet_select_save.length > 1 && cdformat != null && cdformat.length > 0) {\n                let hasCF = false;\n                let cf_compute = conditionformat.getComputeMap();\n                label:\n                    for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                        if (hasCF) {\n                            break;\n                        }\n                        let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                        let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                        for (let r = r1; r <= r2; r++) {\n                            for (let c = c1; c <= c2; c++) {\n                                if (conditionformat.checksCF(r, c, cf_compute) != null) {\n                                    hasCF = true;\n                                    continue label;\n                                }\n                            }\n                        }\n                    }\n                if (hasCF) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                    return;\n                }\n            }    //多重选区 行不一样且列不一样时 提示       \n            //多重选区 行不一样且列不一样时 提示       \n            if (Store.luckysheet_select_save.length > 1) {\n                let isSameRow = true, str_r = Store.luckysheet_select_save[0].row[0], end_r = Store.luckysheet_select_save[0].row[1];\n                let isSameCol = true, str_c = Store.luckysheet_select_save[0].column[0], end_c = Store.luckysheet_select_save[0].column[1];\n                for (let s = 1; s < Store.luckysheet_select_save.length; s++) {\n                    if (Store.luckysheet_select_save[s].row[0] != str_r || Store.luckysheet_select_save[s].row[1] != end_r) {\n                        isSameRow = false;\n                    }\n                    if (Store.luckysheet_select_save[s].column[0] != str_c || Store.luckysheet_select_save[s].column[1] != end_c) {\n                        isSameCol = false;\n                    }\n                }\n                if (!isSameRow && !isSameCol || selectIsOverlap()) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                    return;\n                }\n            }\n            selection.copy(event);\n        });    //右键菜单 粘贴按钮\n        //右键菜单 粘贴按钮\n        $('#luckysheet-copy-paste, #luckysheet-cols-paste-btn, #luckysheet-paste-btn-title').click(function (event) {\n            selection.paste(event, 'btn');\n            $(this).parent().hide();\n        });    //Menu bar, Chart button\n        //Menu bar, Chart button\n        $('#luckysheet-chart-btn-title').click(function () {\n            createLuckyChart();\n        });    // Right-click the menu, chart generation\n        // Right-click the menu, chart generation\n        $('#luckysheetdatavisual').click(function () {\n            createLuckyChart();\n            $('#luckysheet-rightclick-menu').hide();\n        });    //菜单栏 数据透视表\n        //菜单栏 数据透视表\n        $('#luckysheet-pivot-btn-title').click(function (e) {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'usePivotTablereports')) {\n                return;\n            }\n            pivotTable.createPivotTable(e);\n        });    //菜单栏 截图按钮\n        //菜单栏 截图按钮\n        $('#luckysheet-chart-btn-screenshot').click(function () {\n            const locale_screenshot = _locale.screenshot;\n            if (Store.luckysheet_select_save.length == 0) {\n                if (isEditMode()) {\n                    alert(locale_screenshot.screenshotTipNoSelection);\n                } else {\n                    tooltip.info(locale_screenshot.screenshotTipTitle, locale_screenshot.screenshotTipNoSelection);\n                }\n                return;\n            }\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_screenshot.screenshotTipHasMulti);\n                } else {\n                    tooltip.info(locale_screenshot.screenshotTipTitle, locale_screenshot.screenshotTipHasMulti);\n                }\n                return;\n            }    //截图范围内包含部分合并单元格，提示\n            //截图范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_screenshot.screenshotTipHasMerge);\n                    } else {\n                        tooltip.info(locale_screenshot.screenshotTipTitle, locale_screenshot.screenshotTipHasMerge);\n                    }\n                    return;\n                }\n            }\n            let st_r = Store.luckysheet_select_save[0].row[0], ed_r = Store.luckysheet_select_save[0].row[1];\n            let st_c = Store.luckysheet_select_save[0].column[0], ed_c = Store.luckysheet_select_save[0].column[1];\n            let scrollHeight, rh_height;\n            if (st_r - 1 < 0) {\n                scrollHeight = 0;\n                rh_height = Store.visibledatarow[ed_r];\n            } else {\n                scrollHeight = Store.visibledatarow[st_r - 1];\n                rh_height = Store.visibledatarow[ed_r] - Store.visibledatarow[st_r - 1];\n            }\n            let scrollWidth, ch_width;\n            if (st_c - 1 < 0) {\n                scrollWidth = 0;\n                ch_width = Store.visibledatacolumn[ed_c];\n            } else {\n                scrollWidth = Store.visibledatacolumn[st_c - 1];\n                ch_width = Store.visibledatacolumn[ed_c] - Store.visibledatacolumn[st_c - 1];\n            }\n            let newCanvas = $('<canvas>').attr({\n                width: Math.ceil(ch_width * devicePixelRatio),\n                height: Math.ceil(rh_height * devicePixelRatio)\n            }).css({\n                width: ch_width,\n                height: rh_height\n            });\n            luckysheetDrawMain(scrollWidth, scrollHeight, ch_width, rh_height, 1, 1, null, null, newCanvas);\n            let ctx_newCanvas = newCanvas.get(0).getContext('2d');    //补上 左边框和上边框\n            //补上 左边框和上边框\n            ctx_newCanvas.beginPath();\n            ctx_newCanvas.moveTo(0, 0);\n            ctx_newCanvas.lineTo(0, Store.devicePixelRatio * rh_height);\n            ctx_newCanvas.lineWidth = Store.devicePixelRatio * 2;\n            ctx_newCanvas.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n            ctx_newCanvas.stroke();\n            ctx_newCanvas.closePath();\n            ctx_newCanvas.beginPath();\n            ctx_newCanvas.moveTo(0, 0);\n            ctx_newCanvas.lineTo(Store.devicePixelRatio * ch_width, 0);\n            ctx_newCanvas.lineWidth = Store.devicePixelRatio * 2;\n            ctx_newCanvas.strokeStyle = luckysheetdefaultstyle.strokeStyle;\n            ctx_newCanvas.stroke();\n            ctx_newCanvas.closePath();\n            let image = new Image();\n            let url = newCanvas.get(0).toDataURL('image/png');\n            image.src = url;\n            if (ch_width > rh_height) {\n                image.style.width = '100%';\n            } else {\n                image.style.height = '100%';\n            }\n            let maxHeight = $(window).height() - 200;\n            tooltip.screenshot(locale_screenshot.screenshotTipSuccess, '<div id=\"luckysheet-confirm-screenshot-save\" style=\"height:' + maxHeight + 'px;overflow:auto;\"></div>', url);\n            $('#luckysheet-confirm-screenshot-save').append(image);\n            newCanvas.remove();\n        });    //截图下载\n        //截图下载\n        $(document).on('click.luckysheetEvent', 'a.download', function () {\n            let dataURI = $('#luckysheet-confirm-screenshot-save img').attr('src');\n            const locale_screenshot = _locale.screenshot;\n            let binStr = atob(dataURI.split(',')[1]), len = binStr.length, arr = new Uint8Array(len);\n            for (let i = 0; i < len; i++) {\n                arr[i] = binStr.charCodeAt(i);\n            }\n            let blob = new Blob([arr]);\n            let element = document.createElement('a');\n            element.setAttribute('href', URL.createObjectURL(blob));\n            element.setAttribute('download', locale_screenshot.screenshotImageName + '.png');\n            element.style.display = 'none';\n            document.body.appendChild(element);\n            element.click();\n            let clickHandler;\n            element.addEventListener('click', clickHandler = function () {\n                requestAnimationFrame(function () {\n                    URL.revokeObjectURL(element.href);\n                });\n                element.removeAttribute('href');\n                element.removeEventListener('click', clickHandler);\n            });\n            document.body.removeChild(element);\n        });    //菜单栏 分列按钮\n        //菜单栏 分列按钮\n        $('#luckysheet-splitColumn-btn-title').click(function () {\n            if (!checkProtectionNotEnable(Store.currentSheetIndex)) {\n                return;\n            }\n            if (Store.luckysheet_select_save == null || Store.luckysheet_select_save.length == 0) {\n                return;\n            }\n            const locale_splitText = _locale.splitText;\n            if (Store.luckysheet_select_save.length > 1) {\n                tooltip.info(locale_splitText.tipNoMulti, '');\n                return;\n            }\n            if (Store.luckysheet_select_save[0].column[0] != Store.luckysheet_select_save[0].column[1]) {\n                tooltip.info(locale_splitText.tipNoMultiColumn, '');\n                return;\n            }\n            splitColumn.createDialog();\n            splitColumn.init();\n        });    //菜单栏 插入图片按钮\n        //菜单栏 插入图片按钮\n        $('#luckysheet-insertImg-btn-title').click(function () {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects')) {\n                return;\n            }\n            $('#luckysheet-imgUpload').click();\n        });\n        $('#luckysheetInsertImage').click(function () {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects')) {\n                return;\n            }\n            $('#luckysheet-imgUpload').click();\n            $('#luckysheet-rightclick-menu').hide();\n        });\n        $('#luckysheet-imgUpload').click(function (e) {\n            e.stopPropagation();\n        });\n        $('#luckysheet-imgUpload').on('change', function (e) {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects', false)) {\n                return;\n            }\n            let file = e.currentTarget.files[0];\n            let render = new FileReader();\n            render.readAsDataURL(file);\n            render.onload = function (event) {\n                let src = event.target.result;\n                imageCtrl.inserImg(src);\n                $('#luckysheet-imgUpload').val('');\n            };\n        });    //菜单栏 插入链接按钮\n        //菜单栏 插入链接按钮\n        $('#luckysheet-insertLink-btn-title').click(function () {\n            if (!checkProtectionNotEnable(Store.currentSheetIndex)) {\n                return;\n            }\n            if (Store.luckysheet_select_save == null || Store.luckysheet_select_save.length == 0) {\n                return;\n            }\n            hyperlinkCtrl.createDialog();\n            hyperlinkCtrl.init();\n        });\n        $('#luckysheetInsertLink').click(function () {\n            $('#luckysheet-insertLink-btn-title').click();\n            $('#luckysheet-rightclick-menu').hide();\n        });    //菜单栏 数据验证按钮\n        //菜单栏 数据验证按钮\n        $('#luckysheet-dataVerification-btn-title').click(function () {\n            if (!checkProtectionNotEnable(Store.currentSheetIndex)) {\n                return;\n            }\n            if (Store.luckysheet_select_save == null || Store.luckysheet_select_save.length == 0) {\n                return;\n            }\n            dataVerificationCtrl.createDialog();\n            dataVerificationCtrl.init();\n        });\n        $('#luckysheetDataVerification').click(function () {\n            $('#luckysheet-dataVerification-btn-title').click();\n            $('#luckysheet-rightclick-menu').hide();\n        });    //Cell format\n        //Cell format\n        $('#luckysheetCellFormatRightClickMenu').click(function () {\n            openCellFormatModel();\n        });    //冻结行列\n        //冻结行列\n        $('#luckysheet-freezen-btn-horizontal').click(function () {\n            if ($.trim($(this).text()) == locale().freezen.freezenCancel) {\n                luckysheetFreezen.saveFrozen('freezenCancel');\n                if (luckysheetFreezen.freezenverticaldata != null) {\n                    luckysheetFreezen.cancelFreezenVertical();\n                    luckysheetFreezen.createAssistCanvas();\n                    luckysheetrefreshgrid();\n                }\n                if (luckysheetFreezen.freezenhorizontaldata != null) {\n                    luckysheetFreezen.cancelFreezenHorizontal();\n                    luckysheetFreezen.createAssistCanvas();\n                    luckysheetrefreshgrid();\n                }\n                luckysheetFreezen.scrollAdapt();\n            } else {\n                luckysheetFreezen.saveFrozen('freezenRow');\n                if (luckysheetFreezen.freezenverticaldata != null) {\n                    luckysheetFreezen.cancelFreezenVertical();\n                    luckysheetFreezen.createAssistCanvas();\n                    luckysheetrefreshgrid();\n                }\n                if (luckysheetFreezen.freezenhorizontaldata == null) {\n                    luckysheetFreezen.createFreezenHorizontal();\n                    luckysheetFreezen.createAssistCanvas();\n                }\n            }\n        });\n        $('#luckysheet-freezen-btn-vertical').click(function () {\n            if (luckysheetFreezen.freezenverticaldata != null) {\n                luckysheetFreezen.saveFrozen('freezenCancel');\n                luckysheetFreezen.cancelFreezenVertical();\n                luckysheetrefreshgrid();\n            } else {\n                luckysheetFreezen.saveFrozen('freezenColumn');\n                luckysheetFreezen.createFreezenVertical();\n            }\n            luckysheetFreezen.createAssistCanvas();\n        });\n        $('#luckysheet-rightclick-menu input').on('keydown', function (e) {\n            e.stopPropagation();\n        });\n        $('#luckysheet-modal-dialog-mask').on('click dbclick mousedown mousemove mouseup', function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n        });\n        let copychange = function () {\n            if (document.hidden || document.webkitHidden || document.msHidden) {\n                Store.iscopyself = false;\n            }\n        };\n        $(document).on('visibilitychange.luckysheetEvent webkitvisibilitychange.luckysheetEvent msvisibilitychange.luckysheetEvent', copychange).on('mouseleave.luckysheetEvent', function () {\n            Store.iscopyself = false;\n        }).on('mousedown.luckysheetEvent', function (event) {\n            //有批注在编辑时\n            luckysheetPostil.removeActivePs();\n            hideMenuByCancel(event);    //点击功能栏时 如果是单元格编辑模式 则退出编辑模式 \n            //点击功能栏时 如果是单元格编辑模式 则退出编辑模式 \n            if ($(event.target).closest('#luckysheet-wa-editor').length > 0 && parseInt($('#luckysheet-input-box').css('top')) > 0) {\n                console.log(event);\n                formula.updatecell(Store.luckysheetCellUpdate[0], Store.luckysheetCellUpdate[1]);\n                luckysheetMoveHighlightCell('down', 0, 'rangeOfSelect');\n            }\n        });    //表格左上角点击 全选表格\n        //表格左上角点击 全选表格\n        $('#luckysheet-left-top').click(function (event) {\n            if (!checkProtectionAllSelected(Store.currentSheetIndex)) {\n                return;\n            }\n            $('#luckysheet-wa-functionbox-confirm').click();\n            Store.luckysheet_select_status = false;\n            Store.luckysheet_select_save = [{\n                    'row': [\n                        0,\n                        Store.flowdata.length - 1\n                    ],\n                    'column': [\n                        0,\n                        Store.flowdata[0].length - 1\n                    ],\n                    'row_focus': 0,\n                    'column_focus': 0,\n                    row_select: true,\n                    column_select: true\n                }];\n            selectHightlightShow();\n            clearTimeout(Store.countfuncTimeout);\n            Store.countfuncTimeout = setTimeout(function () {\n                countfunc();\n            }, 500);    /* 选中区域：发送网络请求 */\n            /* 选中区域：发送网络请求 */\n            server.saveParam('mv', Store.currentSheetIndex, Store.luckysheet_select_save);\n            event.stopPropagation();\n        });    //回退 重做 按钮\n        //回退 重做 按钮\n        $('#luckysheet-icon-undo').click(function (event) {\n            controlHistory.redo(event);\n        });\n        $('#luckysheet-icon-redo').click(function (event) {\n            controlHistory.undo(event);\n        });    //模态框拖动\n        //模态框拖动\n        $(document).on('mousedown.luckysheetEvent', 'div.luckysheet-modal-dialog', function (e) {\n            if (!$(e.target).is('.luckysheet-modal-dialog')) {\n                return;\n            }\n            Store.luckysheet_model_move_state = true;\n            Store.luckysheet_model_move_obj = $(e.currentTarget);\n            let toffset = Store.luckysheet_model_move_obj.offset();\n            Store.luckysheet_model_xy = [\n                e.pageX - toffset.left,\n                e.pageY - toffset.top\n            ];\n        });    //模态框关闭\n        //模态框关闭\n        $(document).on('click.luckysheetEvent', '.luckysheet-modal-dialog-title-close, .luckysheet-model-close-btn', function (e) {\n            //选择文本颜色和单元格颜色弹出框取消\n            if ($('#textcolorselect').is(':visible') || $('#cellcolorselect').is(':visible')) {\n                $('#luckysheet-conditionformat-dialog').show();\n            }\n            $(e.currentTarget).parents('.luckysheet-modal-dialog').hide();\n            $('#luckysheet-modal-dialog-mask').hide();    //函数查找功能所有弹出框关闭和取消\n            //函数查找功能所有弹出框关闭和取消\n            if ($(this).parents('.luckysheet-modal-dialog').hasClass('luckysheet-search-formula')) {\n                formula.dontupdate();\n                luckysheetMoveHighlightCell('down', 0, 'rangeOfSelect');\n            }\n            if ($(this).parents('.luckysheet-modal-dialog').hasClass('luckysheet-search-formula-parm')) {\n                formula.dontupdate();\n                luckysheetMoveHighlightCell('down', 0, 'rangeOfSelect');\n            }\n            if ($(this).parents('.luckysheet-modal-dialog').hasClass('luckysheet-search-formula-parm-select')) {\n                formula.dontupdate();\n                luckysheetMoveHighlightCell('down', 0, 'rangeOfSelect');\n            }\n            luckysheetContainerFocus();\n        });    //左上角返回按钮\n        //左上角返回按钮\n        $('#luckysheet_info_detail_title').click(function () {\n            window.open(luckysheetConfigsetting.myFolderUrl, '_self');\n        });    //图表选区mousedown\n        //图表选区mousedown\n        $('#luckysheet-chart-rangeShow').on('mousedown.chartRangeShowMove', '.luckysheet-chart-rangeShow-move', function (event) {\n            Store.chart_selection.rangeMove = true;\n            Store.luckysheet_scroll_status = true;\n            Store.chart_selection.rangeMoveObj = $(this).parent();\n            let chart_json = Store.currentChart;\n            let $id = $(this).parent().attr('id');\n            if ($id == 'luckysheet-chart-rangeShow-content') {\n                let row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.content.row[0];\n                let col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.content.column[0];\n                Store.chart_selection.rangeMoveIndex = [\n                    row_s,\n                    col_s\n                ];\n            } else if ($id == 'luckysheet-chart-rangeShow-rowtitle') {\n                let row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.rowtitle.row[0];\n                let col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.rowtitle.column[0];\n                Store.chart_selection.rangeMoveIndex = [\n                    row_s,\n                    col_s\n                ];\n            } else if ($id == 'luckysheet-chart-rangeShow-coltitle') {\n                let row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.coltitle.row[0];\n                let col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.coltitle.column[0];\n                Store.chart_selection.rangeMoveIndex = [\n                    row_s,\n                    col_s\n                ];\n            }\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n            let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n            let type = $(this).data('type');\n            if (type == 'top') {\n                y += 3;\n            } else if (type == 'right') {\n                x -= 3;\n            } else if (type == 'bottom') {\n                y -= 3;\n            } else if (type == 'left') {\n                x += 3;\n            }\n            let row_index = rowLocation(y)[2];\n            let col_index = colLocation(x)[2];\n            Store.chart_selection.rangeMovexy = [\n                row_index,\n                col_index\n            ];\n            event.stopPropagation();\n        });\n        $('#luckysheet-chart-rangeShow').on('mousedown.chartRangeShowResize', '.luckysheet-chart-rangeShow-resize', function (event) {\n            Store.chart_selection.rangeResize = $(this).data('type');    //开始状态resize\n            //开始状态resize\n            Store.luckysheet_scroll_status = true;\n            Store.chart_selection.rangeResizeObj = $(this).parent();\n            let chart_json = Store.currentChart;\n            let row_s;\n            let row_e;\n            let col_s;\n            let col_e;\n            let $id = $(this).parent().attr('id');\n            if ($id == 'luckysheet-chart-rangeShow-content') {\n                if (chart_json.rangeRowCheck.exits) {\n                    row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.content.row[0];\n                    row_e = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.content.row[1];\n                } else {\n                    row_s = chart_json.rangeSplitArray.content.row[0];\n                    row_e = chart_json.rangeSplitArray.content.row[0];\n                }\n                if (chart_json.rangeColCheck.exits) {\n                    col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.content.column[0];\n                    col_e = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.content.column[1];\n                } else {\n                    col_s = chart_json.rangeSplitArray.content.column[0];\n                    col_e = chart_json.rangeSplitArray.content.column[1];\n                }\n                Store.chart_selection.rangeResizeIndex = {\n                    'row': [\n                        row_s,\n                        row_e\n                    ],\n                    'column': [\n                        col_s,\n                        col_e\n                    ]\n                };\n            } else if ($id == 'luckysheet-chart-rangeShow-rowtitle') {\n                let row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.rowtitle.row[0];\n                let row_e = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.rowtitle.row[1];\n                let col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.rowtitle.column[0];\n                let col_e = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.rowtitle.column[1];\n                Store.chart_selection.rangeResizeIndex = {\n                    'row': [\n                        row_s,\n                        row_e\n                    ],\n                    'column': [\n                        col_s,\n                        col_e\n                    ]\n                };\n            } else if ($id == 'luckysheet-chart-rangeShow-coltitle') {\n                let row_s = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.coltitle.row[0];\n                let row_e = chart_json.rangeArray[0].row[0] + chart_json.rangeSplitArray.coltitle.row[1];\n                let col_s = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.coltitle.column[0];\n                let col_e = chart_json.rangeArray[0].column[0] + chart_json.rangeSplitArray.coltitle.column[1];\n                Store.chart_selection.rangeResizeIndex = {\n                    'row': [\n                        row_s,\n                        row_e\n                    ],\n                    'column': [\n                        col_s,\n                        col_e\n                    ]\n                };\n            }\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let x = mouse[0] + $('#luckysheet-cell-main').scrollLeft();\n            let y = mouse[1] + $('#luckysheet-cell-main').scrollTop();\n            if (Store.chart_selection.rangeResize == 'lt') {\n                x += 3;\n                y += 3;\n            } else if (Store.chart_selection.rangeResize == 'lb') {\n                x += 3;\n                y -= 3;\n            } else if (Store.chart_selection.rangeResize == 'rt') {\n                x -= 3;\n                y += 3;\n            } else if (Store.chart_selection.rangeResize == 'rb') {\n                x -= 3;\n                y -= 3;\n            }\n            let row_index = rowLocation(y)[2];\n            let col_index = colLocation(x)[2];\n            Store.chart_selection.rangeResizexy = [\n                row_index,\n                col_index\n            ];\n            event.stopPropagation();\n        });\n        $('#luckysheet-wa-calculate-size').mousedown(function (e) {\n            let y = e.pageY;\n            formula.functionResizeData.y = y;\n            formula.functionResizeStatus = true;\n            formula.functionResizeData.calculatebarHeight = Store.calculatebarHeight;\n            if (formula.rangetosheet != null) {\n                formula.updatecell(Store.luckysheetCellUpdate[0], Store.luckysheetCellUpdate[1]);\n            }\n        });    // 点击设置字体大小的下拉箭头，把自动聚焦输入框去除（认为下拉设置字体大小，不需要聚焦输入框）\n               // //toolbar菜单\n               // $(\"#\" + Store.container + \" .luckysheet-wa-editor\").on(\"click\", \".luckysheet-toolbar-zoom-combobox\", function (e) {\n               //     $(e.currentTarget).addClass(\"luckysheet-toolbar-combo-button-open\");\n               //     $(e.currentTarget).find(\".luckysheet-toolbar-combo-button-input\").focus();\n               // });\n               // $(\"#\" + Store.container + \" .luckysheet-wa-editor\").on(\"blur\", \".luckysheet-toolbar-combo-button-input\", function (e) {\n               //     $(e.currentTarget).closest(\".luckysheet-toolbar-zoom-combobox\").removeClass(\"luckysheet-toolbar-combo-button-open\");\n               // });\n               //表格格式处理\n        // 点击设置字体大小的下拉箭头，把自动聚焦输入框去除（认为下拉设置字体大小，不需要聚焦输入框）\n        // //toolbar菜单\n        // $(\"#\" + Store.container + \" .luckysheet-wa-editor\").on(\"click\", \".luckysheet-toolbar-zoom-combobox\", function (e) {\n        //     $(e.currentTarget).addClass(\"luckysheet-toolbar-combo-button-open\");\n        //     $(e.currentTarget).find(\".luckysheet-toolbar-combo-button-input\").focus();\n        // });\n        // $(\"#\" + Store.container + \" .luckysheet-wa-editor\").on(\"blur\", \".luckysheet-toolbar-combo-button-input\", function (e) {\n        //     $(e.currentTarget).closest(\".luckysheet-toolbar-zoom-combobox\").removeClass(\"luckysheet-toolbar-combo-button-open\");\n        // });\n        //表格格式处理\n        menuButton.initialMenuButton();\n        let dpi_x = document.getElementById('testdpidiv').offsetWidth * Store.devicePixelRatio;\n        let dpi_y = document.getElementById('testdpidiv').offsetHeight * Store.devicePixelRatio;    //粘贴事件处理\n        //粘贴事件处理\n        $(document).on('paste.luckysheetEvent', function (e) {\n            if (isEditMode()) {\n                //此模式下禁用粘贴\n                return;\n            }\n            if (selection.isPasteAction) {\n                $('#luckysheet-rich-text-editor').blur();\n                selection.isPasteAction = false;\n                let clipboardData = window.clipboardData;    //for IE\n                //for IE\n                if (!clipboardData) {\n                    // for chrome\n                    clipboardData = e.originalEvent.clipboardData;\n                }\n                let txtdata = clipboardData.getData('text/html') || clipboardData.getData('text/plain');    //如果标示是qksheet复制的内容，判断剪贴板内容是否是当前页面复制的内容\n                //如果标示是qksheet复制的内容，判断剪贴板内容是否是当前页面复制的内容\n                let isEqual = true;\n                if (txtdata.indexOf('luckysheet_copy_action_table') > -1 && Store.luckysheet_copy_save['copyRange'] != null && Store.luckysheet_copy_save['copyRange'].length > 0) {\n                    //剪贴板内容解析\n                    let cpDataArr = [];\n                    let reg = new RegExp('<tr.*?>(.*?)</tr>', 'g');\n                    let reg2 = new RegExp('<td.*?>(.*?)</td>', 'g');\n                    let regArr = txtdata.match(reg);\n                    for (let i = 0; i < regArr.length; i++) {\n                        let cpRowArr = [];\n                        let reg2Arr = regArr[i].match(reg2);\n                        if (reg2Arr != null) {\n                            for (let j = 0; j < reg2Arr.length; j++) {\n                                let cpValue = reg2Arr[j].replace(/<td.*?>/g, '').replace(/<\\/td>/g, '');\n                                cpRowArr.push(cpValue);\n                            }\n                        }\n                        cpDataArr.push(cpRowArr);\n                    }    //当前页面复制区内容\n                    //当前页面复制区内容\n                    let copy_r1 = Store.luckysheet_copy_save['copyRange'][0].row[0], copy_r2 = Store.luckysheet_copy_save['copyRange'][0].row[1], copy_c1 = Store.luckysheet_copy_save['copyRange'][0].column[0], copy_c2 = Store.luckysheet_copy_save['copyRange'][0].column[1];\n                    let copy_index = Store.luckysheet_copy_save['dataSheetIndex'];\n                    let d;\n                    if (copy_index == Store.currentSheetIndex) {\n                        d = editor.deepCopyFlowData(Store.flowdata);\n                    } else {\n                        d = Store.luckysheetfile[getSheetIndex(copy_index)].data;\n                    }\n                    for (let r = copy_r1; r <= copy_r2; r++) {\n                        if (r - copy_r1 > cpDataArr.length - 1) {\n                            break;\n                        }\n                        for (let c = copy_c1; c <= copy_c2; c++) {\n                            let cell = d[r][c];\n                            if (cell != null && cell.mc != null && cell.mc.rs == null) {\n                                continue;\n                            }\n                            let v;\n                            if (cell != null) {\n                                if (cell.ct != null && cell.ct.fa.indexOf('w') > -1) {\n                                    v = d[r][c].v;\n                                } else {\n                                    v = d[r][c].m;\n                                }\n                            } else {\n                                v = '';\n                            }\n                            if (v == null) {\n                                v = '';\n                            }\n                            if (cpDataArr[r - copy_r1][c - copy_c1] != v) {\n                                isEqual = false;\n                                break;\n                            }\n                        }\n                    }\n                }\n                const locale_fontjson = locale().fontjson;    // hook\n                // hook\n                if (!method.createHookFunction('rangePasteBefore', Store.luckysheet_select_save, txtdata)) {\n                    return;\n                }\n                if (txtdata.indexOf('luckysheet_copy_action_table') > -1 && Store.luckysheet_copy_save['copyRange'] != null && Store.luckysheet_copy_save['copyRange'].length > 0 && isEqual) {\n                    //剪切板内容 和 luckysheet本身复制的内容 一致\n                    if (Store.luckysheet_paste_iscut) {\n                        Store.luckysheet_paste_iscut = false;\n                        selection.pasteHandlerOfCutPaste(Store.luckysheet_copy_save);\n                        selection.clearcopy(e);\n                    } else {\n                        selection.pasteHandlerOfCopyPaste(Store.luckysheet_copy_save);\n                    }\n                } else if (txtdata.indexOf('luckysheet_copy_action_image') > -1) {\n                    imageCtrl.pasteImgItem();\n                } else {\n                    if (txtdata.indexOf('table') > -1) {\n                        $('#luckysheet-copy-content').html(txtdata);\n                        let data = new Array($('#luckysheet-copy-content').find('table tr').length);\n                        let colLen = 0;\n                        $('#luckysheet-copy-content').find('table tr').eq(0).find('td').each(function () {\n                            let colspan = parseInt($(this).attr('colspan'));\n                            if (isNaN(colspan)) {\n                                colspan = 1;\n                            }\n                            colLen += colspan;\n                        });\n                        for (let i = 0; i < data.length; i++) {\n                            data[i] = new Array(colLen);\n                        }\n                        let r = 0;\n                        let borderInfo = {};\n                        $('#luckysheet-copy-content').find('table tr').each(function () {\n                            let $tr = $(this);\n                            let c = 0;\n                            $tr.find('td').each(function () {\n                                let $td = $(this);\n                                let cell = {};\n                                let txt = $td.text();\n                                if ($.trim(txt).length == 0) {\n                                    cell.v = null;\n                                    cell.m = '';\n                                } else {\n                                    let mask = genarate($td.text());\n                                    cell.v = mask[2];\n                                    cell.ct = mask[1];\n                                    cell.m = mask[0];\n                                }\n                                let bg = $td.css('background-color');\n                                if (bg == 'rgba(0, 0, 0, 0)') {\n                                    bg = null;\n                                }\n                                cell.bg = bg;\n                                let bl = $td.css('font-weight');\n                                if (bl == 400 || bl == 'normal') {\n                                    cell.bl = 0;\n                                } else {\n                                    cell.bl = 1;\n                                }\n                                let it = $td.css('font-style');\n                                if (it == 'normal') {\n                                    cell.it = 0;\n                                } else {\n                                    cell.it = 1;\n                                }\n                                let ff = $td.css('font-family');\n                                let ffs = ff.split(',');\n                                for (let i = 0; i < ffs.length; i++) {\n                                    let fa = $.trim(ffs[i].toLowerCase());\n                                    fa = locale_fontjson[fa];\n                                    if (fa == null) {\n                                        cell.ff = 0;\n                                    } else {\n                                        cell.ff = fa;\n                                        break;\n                                    }\n                                }\n                                let fs = Math.floor(parseInt($td.css('font-size')) * 72 / 96) + 1;\n                                cell.fs = fs;\n                                let fc = $td.css('color');\n                                cell.fc = fc;\n                                let ht = $td.css('text-align');\n                                if (ht == 'center') {\n                                    cell.ht = 0;\n                                } else if (ht == 'right') {\n                                    cell.ht = 2;\n                                } else {\n                                    cell.ht = 1;\n                                }\n                                let vt = $td.css('vertical-align');\n                                if (vt == 'middle') {\n                                    cell.vt = 0;\n                                } else if (vt == 'top' || vt == 'text-top') {\n                                    cell.vt = 1;\n                                } else {\n                                    cell.vt = 2;\n                                }\n                                while (c < colLen && data[r][c] != null) {\n                                    c++;\n                                }\n                                if (c == colLen) {\n                                    return true;\n                                }\n                                if (data[r][c] == null) {\n                                    data[r][c] = cell;\n                                    let rowspan = parseInt($td.attr('rowspan'));\n                                    let colspan = parseInt($td.attr('colspan'));\n                                    if (isNaN(rowspan)) {\n                                        rowspan = 1;\n                                    }\n                                    if (isNaN(colspan)) {\n                                        colspan = 1;\n                                    }\n                                    let r_ab = Store.luckysheet_select_save[0]['row'][0] + r;\n                                    let c_ab = Store.luckysheet_select_save[0]['column'][0] + c;\n                                    for (let rp = 0; rp < rowspan; rp++) {\n                                        for (let cp = 0; cp < colspan; cp++) {\n                                            if (rp == 0) {\n                                                let bt = $td.css('border-top');\n                                                if (bt != null && bt.length > 0 && bt.substr(0, 3).toLowerCase() != '0px') {\n                                                    let width = $td.css('border-top-width');\n                                                    let type = $td.css('border-top-style');\n                                                    let color = $td.css('border-top-color');\n                                                    let borderconfig = menuButton.getQKBorder(width, type, color);\n                                                    if (borderInfo[r + rp + '_' + (c + cp)] == null) {\n                                                        borderInfo[r + rp + '_' + (c + cp)] = {};\n                                                    }\n                                                    borderInfo[r + rp + '_' + (c + cp)].t = {\n                                                        'style': borderconfig[0],\n                                                        'color': borderconfig[1]\n                                                    };\n                                                }\n                                            }\n                                            if (rp == rowspan - 1) {\n                                                let bb = $td.css('border-bottom');\n                                                if (bb != null && bb.length > 0 && bb.substr(0, 3).toLowerCase() != '0px') {\n                                                    let width = $td.css('border-bottom-width');\n                                                    let type = $td.css('border-bottom-style');\n                                                    let color = $td.css('border-bottom-color');\n                                                    let borderconfig = menuButton.getQKBorder(width, type, color);\n                                                    if (borderInfo[r + rp + '_' + (c + cp)] == null) {\n                                                        borderInfo[r + rp + '_' + (c + cp)] = {};\n                                                    }\n                                                    borderInfo[r + rp + '_' + (c + cp)].b = {\n                                                        'style': borderconfig[0],\n                                                        'color': borderconfig[1]\n                                                    };\n                                                }\n                                            }\n                                            if (cp == 0) {\n                                                let bl = $td.css('border-left');\n                                                if (bl != null && bl.length > 0 && bl.substr(0, 3).toLowerCase() != '0px') {\n                                                    let width = $td.css('border-left-width');\n                                                    let type = $td.css('border-left-style');\n                                                    let color = $td.css('border-left-color');\n                                                    let borderconfig = menuButton.getQKBorder(width, type, color);\n                                                    if (borderInfo[r + rp + '_' + (c + cp)] == null) {\n                                                        borderInfo[r + rp + '_' + (c + cp)] = {};\n                                                    }\n                                                    borderInfo[r + rp + '_' + (c + cp)].l = {\n                                                        'style': borderconfig[0],\n                                                        'color': borderconfig[1]\n                                                    };\n                                                }\n                                            }\n                                            if (cp == colspan - 1) {\n                                                let br = $td.css('border-right');\n                                                if (br != null && br.length > 0 && br.substr(0, 3).toLowerCase() != '0px') {\n                                                    let width = $td.css('border-right-width');\n                                                    let type = $td.css('border-right-style');\n                                                    let color = $td.css('border-right-color');\n                                                    let borderconfig = menuButton.getQKBorder(width, type, color);\n                                                    if (borderInfo[r + rp + '_' + (c + cp)] == null) {\n                                                        borderInfo[r + rp + '_' + (c + cp)] = {};\n                                                    }\n                                                    borderInfo[r + rp + '_' + (c + cp)].r = {\n                                                        'style': borderconfig[0],\n                                                        'color': borderconfig[1]\n                                                    };\n                                                }\n                                            }\n                                            if (rp == 0 && cp == 0) {\n                                                continue;\n                                            }\n                                            data[r + rp][c + cp] = {\n                                                'mc': {\n                                                    'r': r_ab,\n                                                    'c': c_ab\n                                                }\n                                            };\n                                        }\n                                    }\n                                    if (rowspan > 1 || colspan > 1) {\n                                        let first = {\n                                            'rs': rowspan,\n                                            'cs': colspan,\n                                            'r': r_ab,\n                                            'c': c_ab\n                                        };\n                                        data[r][c].mc = first;\n                                    }\n                                }\n                                c++;\n                                if (c == colLen) {\n                                    return true;\n                                }\n                            });\n                            r++;\n                        });\n                        Store.luckysheet_selection_range = [];\n                        selection.pasteHandler(data, borderInfo);\n                        $('#luckysheet-copy-content').empty();\n                    }    //复制的是图片\n                    else //复制的是图片\n                    if (clipboardData.files.length == 1 && clipboardData.files[0].type.indexOf('image') > -1) {\n                        let render = new FileReader();\n                        render.readAsDataURL(clipboardData.files[0]);\n                        render.onload = function (event) {\n                            let src = event.target.result;\n                            imageCtrl.inserImg(src);\n                        };\n                        return;\n                    } else {\n                        txtdata = clipboardData.getData('text/plain');\n                        selection.pasteHandler(txtdata);\n                    }\n                }\n            } else if ($(e.target).closest('#luckysheet-rich-text-editor').length > 0) {\n                // 阻止默认粘贴\n                e.preventDefault();\n                let clipboardData = window.clipboardData;    //for IE\n                //for IE\n                if (!clipboardData) {\n                    // for chrome\n                    clipboardData = e.originalEvent.clipboardData;\n                }\n                let text = clipboardData.getData('text/plain');    // 插入\n                // 插入\n                document.execCommand('insertText', false, text);\n            }\n        });    //是否允许加载下一页\n        //是否允许加载下一页\n        if (luckysheetConfigsetting.enablePage) {\n            $('#luckysheet-bottom-page-next').click(function () {\n                let queryExps = luckysheetConfigsetting.pageInfo.queryExps;\n                let reportId = luckysheetConfigsetting.pageInfo.reportId;\n                let fields = luckysheetConfigsetting.pageInfo.fields;\n                let mobile = luckysheetConfigsetting.pageInfo.mobile;\n                let frezon = luckysheetConfigsetting.pageInfo.frezon;\n                let currentPage = luckysheetConfigsetting.pageInfo.currentPage;\n                let totalPage = luckysheetConfigsetting.pageInfo.totalPage;\n                let pageUrl = luckysheetConfigsetting.pageInfo.pageUrl;\n                method.addDataAjax({\n                    'queryExps': queryExps,\n                    'reportId': reportId,\n                    'fields': fields,\n                    'mobile': mobile,\n                    'frezon': frezon,\n                    'pageIndex': currentPage,\n                    'currentPage': currentPage\n                }, Store.currentSheetIndex, pageUrl, function () {\n                    luckysheetConfigsetting.pageInfo.currentPage++;\n                    if (luckysheetConfigsetting.pageInfo.totalPage == luckysheetConfigsetting.pageInfo.currentPage) {\n                        $('#luckysheet-bottom-page-next').hide();\n                        let pageInfoFull = replaceHtml(locale_info.pageInfoFull, {\n                            total: luckysheetConfigsetting.total,\n                            totalPage: luckysheetConfigsetting.pageInfo.totalPage\n                        });\n                        $('#luckysheet-bottom-page-info').html(pageInfoFull);\n                    } else {\n                        let pageInfo = replaceHtml(locale_info.pageInfo, {\n                            total: luckysheetConfigsetting.total,\n                            totalPage: luckysheetConfigsetting.pageInfo.totalPage,\n                            currentPage: luckysheetConfigsetting.pageInfo.currentPage\n                        });\n                        $('#luckysheet-bottom-page-info').html(pageInfo);\n                    }\n                });\n            }).mousedown(function (e) {\n                e.stopPropagation();\n            });\n        }    //回到顶部\n        //回到顶部\n        $('#luckysheet-bottom-bottom-top').click(function () {\n            $('#luckysheet-scrollbar-y').scrollTop(0);\n        }).mousedown(function (e) {\n            e.stopPropagation();\n        });\n    };    // 协同编辑其他用户不在操作的时候，且已经展示了用户名10秒，则用户名框隐藏\n    // 协同编辑其他用户不在操作的时候，且已经展示了用户名10秒，则用户名框隐藏\n    function hideUsername() {\n        let $showEle = $$('.luckysheet-multipleRange-show');\n        if ($showEle.length === undefined) {\n            $showEle = [$showEle];\n        }\n        $showEle.forEach(ele => {\n            const id = ele.id.replace('luckysheet-multipleRange-show-', '');\n            if (Store.cooperativeEdit.usernameTimeout['user' + id] === null) {\n                $$('.username', ele).style.display = 'none';\n            }\n        });\n    }\n});"]}