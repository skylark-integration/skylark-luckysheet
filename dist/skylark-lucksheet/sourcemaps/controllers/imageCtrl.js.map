{"version":3,"sources":["controllers/imageCtrl.js"],"names":["define","m_location","server","luckysheetsizeauto","m_constant","m_protection","m_get","m_set","m_util","Store","locale","mouseposition","modelHTML","checkProtectionAuthorityNormal","getSheetIndex","setluckysheet_scroll_status","replaceHtml","imgItem","type","src","originWidth","originHeight","default","width","height","left","top","crop","offsetLeft","offsetTop","isFixedPos","fixedLeft","fixedTop","border","radius","style","color","images","currentImgId","currentWinW","currentWinH","resize","resizeXY","move","moveXY","cropChange","cropChangeXY","cropChangeObj","copyImgItemObj","inserImg","_this","this","last","luckysheet_select_save","length","rowIndex","row_focus","colIndex","column_focus","visibledatacolumn","visibledatarow","image","Image","onload","img","addImgItem","generateRandomId","prefix","userAgent","window","navigator","replace","split","mid","i","Math","round","random","Date","getTime","modelHtml","id","imgItemParam","getImgItemParam","zoomRatio","position","borderWidth","getSliderHtml","imageText","imageSetting","close","conventional","moveCell1","moveCell2","moveCell3","fixedPos","solid","dashed","dotted","double","sliderHtmlShow","$","remove","sliderHtml","append","prop","val","css","attr","init","colorSelectDialog","currenColor","_locale","locale_button","button","locale_toolbar","toolbar","locale_imageCtrl","imageCtrl","show","addclass","title","borderTile","content","borderCur","botton","confirm","cancel","$t","find","end","myh","outerHeight","myw","outerWidth","winw","winh","scrollLeft","document","scrollTop","spectrum","showPalette","showPaletteOnly","preferredFormat","clickoutFiresChange","showInitial","showInput","flat","hideAfterPaletteSelect","showSelectionPalette","showButtons","maxPaletteSize","maxSelectionSize","cancelText","chooseText","confirmColor","togglePaletteMoreText","customColor","togglePaletteLessText","collapse","togglePaletteOnly","clearText","noColorSelectedText","localStorageKey","gridKey","palette","toHexString","click","hide","off","on","configChange","value","checked","valueAsNumber","$parent","parents","e","currentSheetIndex","cancelActiveImgItem","item","background-image","background-size","background-position","border-width","border-style","border-color","border-radius","right","bottom","stopPropagation","is","scrollWidth","scrollHeight","offset","pageX","pageY","data","mouse","x","y","croppingEnter","croppingExit","restoreImgItem","removeImgItem","ref","[object Object]","extend","rowHeaderWidth","infobarHeight","toolbarHeight","calculatebarHeight","columnHeaderHeight","moveImgItem","obj","resizeImgItem","scaleX","clientWidth","scaleY","clientHeight","cropping","cropChangeImgItem","copyImgItem","clipboardData","originalEvent","cpdata","setData","textarea","html","focus","select","execCommand","setTimeout","blur","pasteImgItem","allImagesShow","empty","imgId","moveChangeSize","rc","index","size","row","changeSize","col","file","luckysheetfile","clearjfundo","jfundo","jfredo","push","sheetIndex","curImages","saveParam","k"],"mappings":";;;;;;;AAAAA,QACI,qBACA,WACA,WACA,aACA,eACA,iBACA,iBACA,gBACA,WACA,oBACD,SAAUC,EAAYC,EAAQC,EAAoBC,EAAYC,EAAcC,EAAOC,EAAOC,EAAQC,EAAOC,GACxG,aACA,MAAMC,cAACA,GAAiBV,GAClBW,UAACA,GAAaR,GACdS,+BAACA,GAAkCR,GACnCS,cAACA,GAAiBR,GAClBS,4BAACA,GAA+BR,GAChCS,YAACA,GAAeR,EA+8BtB,OA78BIS,SACIC,KAAM,IAENC,IAAK,GAELC,YAAa,KAEbC,aAAc,KAEdC,SACIC,MAAO,KAEPC,OAAQ,KAERC,KAAM,KAENC,IAAK,MAGTC,MACIJ,MAAO,KAEPC,OAAQ,KAERI,WAAY,EAEZC,UAAW,GAGfC,YAAY,EAEZC,UAAW,KAEXC,SAAU,KAEVC,QACIV,MAAO,EAEPW,OAAQ,EAERC,MAAO,QAEPC,MAAO,SAIfC,OAAQ,KACRC,aAAc,KACdC,YAAa,KACbC,YAAa,KACbC,OAAQ,KACRC,SAAU,KACVC,MAAM,EACNC,OAAQ,KACRC,WAAY,KACZC,aAAc,KACdC,cAAe,KACfC,eAAgB,KAChBC,SAAU,SAAU9B,GAChB,IAAI+B,EAAQC,KACRC,EAAO3C,EAAM4C,uBAAuB5C,EAAM4C,uBAAuBC,OAAS,GAC1EC,EAAWH,EAAKI,WAAa,EAC7BC,EAAWL,EAAKM,cAAgB,EAChCjC,EAAmB,GAAZgC,EAAgB,EAAIhD,EAAMkD,kBAAkBF,EAAW,GAC9D/B,EAAkB,GAAZ6B,EAAgB,EAAI9C,EAAMmD,eAAeL,EAAW,GAC1DM,EAAQ,IAAIC,MAChBD,EAAME,OAAS,WACX,IAAIxC,EAAQsC,EAAMtC,MAAOC,EAASqC,EAAMrC,OACpCwC,GACA7C,IAAKA,EACLM,KAAMA,EACNC,IAAKA,EACLN,YAAaG,EACbF,aAAcG,GAElB0B,EAAMe,WAAWD,IAErBH,EAAM1C,IAAMA,GAEhB+C,iBAAkB,SAAUC,GACV,MAAVA,IACAA,EAAS,OAEb,IAAIC,EAAYC,OAAOC,UAAUF,UAAUG,QAAQ,gBAAiB,IAAIC,MAAM,IAC1EC,EAAM,GACV,IAAK,IAAIC,EAAI,EAAGA,EAAI,GAAIA,IACpBD,GAAOL,EAAUO,KAAKC,MAAMD,KAAKE,UAAYT,EAAUd,OAAS,KAGpE,OAAOa,EAAS,IAAMM,EAAM,KADjB,IAAIK,MAAOC,WAG1BC,UAAW,SAAUC,EAAIhE,GACrB,IACIE,EAAMF,EAAQE,IACd+D,EAFQ/B,KAEagC,gBAAgBlE,GACrCM,EAAQ2D,EAAa3D,MAAQd,EAAM2E,UACnC5D,EAAS0D,EAAa1D,OAASf,EAAM2E,UACrC3D,EAAOyD,EAAazD,KAAOhB,EAAM2E,UACjC1D,EAAMwD,EAAaxD,IAAMjB,EAAM2E,UAC/BC,EAAWH,EAAaG,SACxBC,EAAcrE,EAAQgB,OAAOV,MACjC,kBAAoB0D,iFAAoF1D,cAAoBC,0BAAiC6D,UAAmB5D,WAAgBC,8LAEvKP,qCAAyCF,EAAQK,QAAQC,MAAQd,EAAM2E,sBAAwBnE,EAAQK,QAAQE,OAASf,EAAM2E,qBAAuBnE,EAAQU,KAAKC,WAAanB,EAAM2E,oBAAsBnE,EAAQU,KAAKE,UAAYpB,EAAM2E,+HAE9LE,OAAmBrE,EAAQgB,OAAOE,SAAWlB,EAAQgB,OAAOG,uBAAyBnB,EAAQgB,OAAOC,OAASzB,EAAM2E,uCAAyCE,cAA0BA,YAAwBA,eAA2BA,wCAGlTC,cAAe,WACX,IAAIC,EAAY9E,IAAS8E,UACzB,2QAEqBA,EAAUC,gGACgCD,EAAUE,2UAMxBF,EAAUG,qTAINH,EAAUI,+RAIVJ,EAAUK,+RAIVL,EAAUM,gTAKTN,EAAUO,qMAIfP,EAAUvD,0LAGzBuD,EAAUjE,2PAIViE,EAAUtD,6PAIVsD,EAAUrD,sJAESqD,EAAUQ,kFACTR,EAAUS,mFACVT,EAAUU,mFACVV,EAAUW,iNAI9BX,EAAUpD,kXAUhDgE,eAAgB,WAEZC,EAAE,6CAA6CC,SAC/C,IAAIC,EAFQpD,KAEWoC,gBACvBc,EAAE,QAAQG,OAAOD,GACjBpG,IACA,IAAIc,EALQkC,KAKQd,OALRc,KAKqBb,cAE7BpB,EAAOD,EAAQC,KACnBmF,EAAE,yDAA2DnF,GAAMuF,KAAK,WAAW,GAEnF,IAAI3E,EAAab,EAAQa,WACzBuE,EAAE,gEAAgEI,KAAK,UAAW3E,GAElF,IAAIG,EAAShB,EAAQgB,OACrBoE,EAAE,iEAAiEK,IAAIzE,EAAOV,OAC9E8E,EAAE,kEAAkEK,IAAIzE,EAAOC,QAC/EmE,EAAE,iEAAiEK,IAAIzE,EAAOE,OAC9EkE,EAAE,sEAAsEM,IAAI,mBAAoB1E,EAAOG,OAAOwE,KAAK,QAAS3E,EAAOG,OAjBvHe,KAkBN0D,QAEVC,kBAAmB,SAAUC,GACzB,MAAMC,EAAUtG,IACVuG,EAAgBD,EAAQE,OACxBC,EAAiBH,EAAQI,QACzBC,EAAmBL,EAAQM,UACjCjB,EAAE,iCAAiCkB,OACnClB,EAAE,4CAA4CC,SAC9CD,EAAE,QAAQG,OAAOxF,EAAYJ,GACzBqE,GAAM,0CACNuC,SAAY,0CACZC,MAASJ,EAAiBK,WAC1BC,kEACeN,EAAiBO,0BAA4Bb,8BAA0CA,uGAGtGc,+FAAmGZ,EAAca,wGAC3Cb,EAAcc,kBACpF5F,MAAS,oBAEb,IAAI6F,EAAK3B,EAAE,4CAA4C4B,KAAK,oCAAoCtB,IAAI,YAAa,KAAKuB,MAAOC,EAAMH,EAAGI,cAAeC,EAAML,EAAGM,aAC1JC,EAAOlC,EAAEhC,QAAQ9C,QAASiH,EAAOnC,EAAEhC,QAAQ7C,SAC3CiH,EAAapC,EAAEqC,UAAUD,aAAcE,EAAYtC,EAAEqC,UAAUC,YACnEtC,EAAE,4CAA4CM,KAC1ClF,MAAS8G,EAAOE,EAAaJ,GAAO,EACpC3G,KAAQ8G,EAAOG,EAAYR,GAAO,IACnCZ,OAEHlB,EAAE,4CAA4C4B,KAAK,iBAAiBW,UAChEC,aAAa,EACbC,iBAAiB,EACjBC,gBAAiB,MACjBC,qBAAqB,EACrBC,aAAa,EACbC,WAAW,EACXC,MAAM,EACNC,wBAAwB,EACxBC,sBAAsB,EACtBC,aAAa,EAEbC,eAAgB,EAChBC,iBAAkB,EAClBpH,MAAO2E,EACP0C,WAAYxC,EAAcc,OAC1B2B,WAAYvC,EAAewC,aAC3BC,sBAAuBzC,EAAe0C,YACtCC,sBAAuB3C,EAAe4C,SACtCC,mBAAmB,EACnBC,UAAW9C,EAAe8C,UAC1BC,oBAAqB/C,EAAe+C,oBACpCC,gBAAiB,qBAAuBjK,EAAOkK,QAC/CC,UAEQ,OACA,OACA,OACA,OACA,OACA,OACA,UACA,SAGA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,SAGA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAGA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAGA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAGA,OACA,UACA,UACA,UACA,UACA,UACA,UACA,YAGA,OACA,UACA,UACA,UACA,UACA,UACA,UACA,YAGA,OACA,UACA,UACA,UACA,UACA,UACA,UACA,YAGR1H,KAAM,SAAUP,GAERA,EADS,MAATA,EACQA,EAAMkI,cAEN,OAEZjE,EAAE,8DAA8DM,IAAI,mBAAoBvE,GAAOwE,KAAK,QAASxE,OAIzHyE,KAAM,WACF,IAAI3D,EAAQC,KAEZkD,EAAE,yEAAyEkE,MAAM,WAC7ElE,EAAE,6CAA6CmE,OAC/CrK,MAGJkG,EAAE,6CAA6CoE,IAAI,gBAAgBC,GAAG,eAAgB,kDAAmD,WACrIxH,EAAMyH,aAAa,OAAQxH,KAAKyH,SAGpCvE,EAAE,6CAA6CoE,IAAI,mBAAmBC,GAAG,kBAAmB,4CAA6C,WACrIxH,EAAMyH,aAAa,WAAYxH,KAAK0H,WAGxCxE,EAAE,6CAA6CoE,IAAI,sBAAsBC,GAAG,qBAAsB,sBAAuB,WACrHxH,EAAMyH,aAAa,eAAgBxH,KAAK2H,iBAG5CzE,EAAE,6CAA6CoE,IAAI,uBAAuBC,GAAG,sBAAuB,uBAAwB,WACxHxH,EAAMyH,aAAa,gBAAiBxH,KAAK2H,iBAG7CzE,EAAE,6CAA6CoE,IAAI,sBAAsBC,GAAG,qBAAsB,sBAAuB,WACrHxH,EAAMyH,aAAa,eAAgBxH,KAAKyH,SAG5CvE,EAAE,6CAA6CoE,IAAI,eAAeC,GAAG,cAAe,sBAAuB,WACvG,IAAI3D,EAAcV,EAAElD,MAAM8E,KAAK,QAAQrB,KAAK,SAC5C1D,EAAM4D,kBAAkBC,KAG5BV,EAAEqC,UAAU+B,IAAI,4BAA4BC,GAAG,2BAA4B,mDAAoD,WAC3H,IAAIK,EAAU1E,EAAElD,MAAM6H,QAAQ,4CAC9B3E,EAAE,iCAAiCmE,OACnCO,EAAQP,OACR,IAAIzD,EAAcgE,EAAQ9C,KAAK,qBAAqBrB,KAAK,SACzDP,EAAE,sEAAsEM,IAAI,mBAAoBI,GAAaH,KAAK,QAASG,GAC3H7D,EAAMyH,aAAa,eAAgB5D,KAGvCV,EAAE,8BAA8BoE,IAAI,oBAAoBC,GAAG,mBAAoB,iCAAkC,SAAUO,GACvH,IAAKpK,EAA+BJ,EAAMyK,kBAAmB,eAAe,GACxE,OAEJ7E,EAAElD,MAAMqH,OACR,IAAIvF,EAAKoB,EAAElD,MAAMyD,KAAK,MACI,MAAtB1D,EAAMZ,cAAwBY,EAAMZ,cAAgB2C,GACpD/B,EAAMiI,sBAEVjI,EAAMZ,aAAe2C,EACrB,IAAImG,EAAOlI,EAAMb,OAAO4C,GACpBC,EAAehC,EAAMiC,gBAAgBiG,GACrC7J,EAAQ2D,EAAa3D,MAAQd,EAAM2E,UACnC5D,EAAS0D,EAAa1D,OAASf,EAAM2E,UACrC3D,EAAOyD,EAAazD,KAAOhB,EAAM2E,UACjC1D,EAAMwD,EAAaxD,IAAMjB,EAAM2E,UAC/BC,EAAWH,EAAaG,SAC5BgB,EAAE,wCAAwCkB,OAAOZ,KAC7CpF,MAASA,EACTC,OAAUA,EACVC,KAAQA,EACRC,IAAOA,EACP2D,SAAYA,IAEhBgB,EAAE,yEAAyEM,KACvE0E,mBAAoB,OAASD,EAAKjK,IAAM,IACxCmK,kBAAmBF,EAAK9J,QAAQC,MAAQd,EAAM2E,UAAY,MAAQgG,EAAK9J,QAAQE,OAASf,EAAM2E,UAAY,KAC1GmG,uBAAwBH,EAAKzJ,KAAKC,WAAanB,EAAM2E,UAAY,OAASgG,EAAKzJ,KAAKE,UAAYpB,EAAM2E,UAAY,OAEtHiB,EAAE,wEAAwEM,KACtE6E,eAAgBJ,EAAKnJ,OAAOV,MAAQd,EAAM2E,UAC1CqG,eAAgBL,EAAKnJ,OAAOE,MAC5BuJ,eAAgBN,EAAKnJ,OAAOG,MAC5BuJ,gBAAiBP,EAAKnJ,OAAOC,OAASzB,EAAM2E,UAC5C3D,MAAS2J,EAAKnJ,OAAOV,MAAQd,EAAM2E,UACnCwG,OAAUR,EAAKnJ,OAAOV,MAAQd,EAAM2E,UACpC1D,KAAQ0J,EAAKnJ,OAAOV,MAAQd,EAAM2E,UAClCyG,QAAWT,EAAKnJ,OAAOV,MAAQd,EAAM2E,YAEzClC,EAAMkD,iBACN6E,EAAEa,oBAGNzF,EAAE,wCAAwCoE,IAAI,kBAAkBC,GAAG,iBAAkB,mCAAoC,SAAUO,GAC/H,IAAKpK,EAA+BJ,EAAMyK,kBAAmB,eAAe,GACxE,OAEC7E,EAAE,6CAA6C0F,GAAG,aACnD7I,EAAMkD,iBAEVlD,EAAMP,MAAO,EACbO,EAAMX,YAAc8D,EAAE,yBAAyB,GAAG2F,YAClD9I,EAAMV,YAAc6D,EAAE,yBAAyB,GAAG4F,aAClD,IAAIC,EAAS7F,EAAE,wCAAwC6F,SACvDhJ,EAAMN,QACFqI,EAAEkB,MAAQD,EAAOzK,KACjBwJ,EAAEmB,MAAQF,EAAOxK,KAErBX,GAA4B,GAC5BkK,EAAEa,oBAGNzF,EAAE,wCAAwCoE,IAAI,oBAAoBC,GAAG,mBAAoB,uCAAwC,SAAUO,GACvI,IAAKpK,EAA+BJ,EAAMyK,kBAAmB,eAAe,GACxE,OAEJhI,EAAMX,YAAc8D,EAAE,yBAAyB,GAAG2F,YAClD9I,EAAMV,YAAc6D,EAAE,yBAAyB,GAAG4F,aAClD/I,EAAMT,OAAS4D,EAAElD,MAAMkJ,KAAK,QAC5B,IAAI1D,EAAYtC,EAAE,yBAAyBsC,YAAaF,EAAapC,EAAE,yBAAyBoC,aAC5F6D,EAAQ3L,EAAcsK,EAAEkB,MAAOlB,EAAEmB,OACjCG,EAAID,EAAM,GAAK7D,EACf+D,EAAIF,EAAM,GAAK3D,EACftD,EAAWgB,EAAE,wCAAwChB,WACrD9D,EAAQ8E,EAAE,wCAAwC9E,QAClDC,EAAS6E,EAAE,wCAAwC7E,SACvD0B,EAAMR,UACF6J,EACAC,EACAjL,EACAC,EACA6D,EAAS5D,KAAOgH,EAChBpD,EAAS3D,IAAMiH,EACfF,EACAE,GAEJ5H,GAA4B,GAC5BkK,EAAEa,oBAGNzF,EAAE,wCAAwCoE,IAAI,2BAA2BC,GAAG,0BAA2B,kCAAmC,SAAUO,GAChJ/H,EAAMuJ,gBACNxB,EAAEa,oBAGNzF,EAAE,qCAAqCoE,IAAI,0BAA0BC,GAAG,yBAA0B,kCAAmC,SAAUO,GAC3I/H,EAAMwJ,eACNzB,EAAEa,oBAGNzF,EAAE,qCAAqCoE,IAAI,wBAAwBC,GAAG,uBAAwB,eAAgB,SAAUO,GACpH/H,EAAML,WAAawD,EAAElD,MAAMkJ,KAAK,QAChC,IAAI1D,EAAYtC,EAAE,yBAAyBsC,YAAaF,EAAapC,EAAE,yBAAyBoC,aAC5F6D,EAAQ3L,EAAcsK,EAAEkB,MAAOlB,EAAEmB,OACjCG,EAAID,EAAM,GAAK7D,EACf+D,EAAIF,EAAM,GAAK3D,EACnBzF,EAAMJ,cACFyJ,EACAC,GAEJzL,GAA4B,GAC5BkK,EAAEa,oBAGNzF,EAAE,8BAA8BoE,IAAI,qBAAqBC,GAAG,oBAAqB,qCAAsC,SAAUO,GAC7H/H,EAAMyJ,iBACN1B,EAAEa,oBAGNzF,EAAE,8BAA8BoE,IAAI,oBAAoBC,GAAG,mBAAoB,iCAAkC,SAAUO,GACvH/H,EAAM0J,gBACN3B,EAAEa,qBAGVnB,aAAc,SAAUzJ,EAAM0J,GAC1B,IAAI1H,EAAQC,KACRlC,EAAUiC,EAAMb,OAAOa,EAAMZ,cACjC,OAAQpB,GACR,IAAK,OACDD,EAAQC,KAAO0J,EACf,MACJ,IAAK,WACD3J,EAAQa,WAAa8I,EACrB,IAAI1F,EAAehC,EAAMiC,gBAAgBlE,GACrCM,EAAQ2D,EAAa3D,MACrBC,EAAS0D,EAAa1D,OACtBC,EAAOyD,EAAazD,KACpBC,EAAMwD,EAAaxD,IACnB2D,EAAWH,EAAaG,SAC5BgB,EAAE,wCAAwCkB,OAAOZ,KAC7CpF,MAASA,EACTC,OAAUA,EACVC,KAAQA,EACRC,IAAOA,EACP2D,SAAYA,IAEhB,MACJ,IAAK,eACDpE,EAAQgB,OAAOV,MAAQqJ,EACvBvE,EAAE,wEAAwEM,KACtE6E,eAAgBZ,EAChBnJ,MAASmJ,EACTgB,OAAUhB,EACVlJ,KAAQkJ,EACRiB,QAAWjB,IAEf,MACJ,IAAK,gBACD3J,EAAQgB,OAAOC,OAAS0I,EACxBvE,EAAE,wEAAwEM,IAAI,gBAAiBiE,GAC/F,MACJ,IAAK,eACD3J,EAAQgB,OAAOE,MAAQyI,EACvBvE,EAAE,wEAAwEM,IAAI,eAAgBiE,GAC9F,MACJ,IAAK,eACD3J,EAAQgB,OAAOG,MAAQwI,EACvBvE,EAAE,wEAAwEM,IAAI,eAAgBiE,GAGlG1H,EAAM2J,OAEVC,gBAAgB7L,GACZ,IAAIa,EAAab,EAAQa,WACrBP,EAAQN,EAAQK,QAAQC,MAAOC,EAASP,EAAQK,QAAQE,OAAQC,EAAOR,EAAQK,QAAQG,KAAMC,EAAMT,EAAQK,QAAQI,IACnHT,EAAQU,KAAKJ,OAASA,GAASN,EAAQU,KAAKH,QAAUA,IACtDD,EAAQN,EAAQU,KAAKJ,MACrBC,EAASP,EAAQU,KAAKH,OACtBC,GAAQR,EAAQU,KAAKC,WACrBF,GAAOT,EAAQU,KAAKE,WAExB,IAAIwD,EAAW,WAMf,OALIvD,IACAuD,EAAW,QACX5D,EAAOR,EAAQc,UAAYd,EAAQU,KAAKC,WACxCF,EAAMT,EAAQe,SAAWf,EAAQU,KAAKE,YAGtCN,MAAOA,EACPC,OAAQA,EACRC,KAAMA,EACNC,IAAKA,EACL2D,SAAUA,IAGlB8F,oBAAqB,WAEjB9E,EAAE,wCAAwCmE,OAC1CnE,EAAE,qCAAqCmE,OACvCnE,EAAE,6CAA6CmE,OAC/C,IAAIvJ,EAJQkC,KAIQd,OAJRc,KAIqBb,cAC7B4C,EALQ/B,KAKagC,gBAAgBlE,GACrCM,EAAQ2D,EAAa3D,MAAQd,EAAM2E,UACnC5D,EAAS0D,EAAa1D,OAASf,EAAM2E,UACrC3D,EAAOyD,EAAazD,KAAOhB,EAAM2E,UACjC1D,EAAMwD,EAAaxD,IAAMjB,EAAM2E,UAC/BC,EAAWH,EAAaG,SAC5BgB,EAAE,IAXUlD,KAWEb,cAAciF,OAAOZ,KAC/BpF,MAASA,EACTC,OAAUA,EACVC,KAAQA,EACRC,IAAOA,EACP2D,SAAYA,IAEhBgB,EAAE,IAlBUlD,KAkBEb,aAAe,QAAQqE,KACjCpF,MAASN,EAAQK,QAAQC,MAAQd,EAAM2E,UACvC5D,OAAUP,EAAQK,QAAQE,OAASf,EAAM2E,UACzC3D,MAASR,EAAQU,KAAKC,WAAanB,EAAM2E,UACzC1D,KAAQT,EAAQU,KAAKE,UAAYpB,EAAM2E,YAE3CiB,EAAE,IAxBUlD,KAwBEb,aAAe,oCAAoCqE,KAC7D6E,eAAgBvK,EAAQgB,OAAOV,MAAQd,EAAM2E,UAC7CqG,eAAgBxK,EAAQgB,OAAOE,MAC/BuJ,eAAgBzK,EAAQgB,OAAOG,MAC/BuJ,gBAAiB1K,EAAQgB,OAAOC,OAASzB,EAAM2E,UAC/C3D,MAASR,EAAQgB,OAAOV,MAAQd,EAAM2E,UACtCwG,OAAU3K,EAAQgB,OAAOV,MAAQd,EAAM2E,UACvC1D,KAAQT,EAAQgB,OAAOV,MAAQd,EAAM2E,UACrCyG,QAAW5K,EAAQgB,OAAOV,MAAQd,EAAM2E,YAhChCjC,KAkCNb,aAAe,MAEzB2B,WAAY,SAAUD,GAClB,IACIzC,EAAOC,EADP0B,EAAQC,KAGRa,EAAI3C,aAAe2C,EAAI5C,aACvBI,EAASmD,KAAKC,MAAMZ,EAAI3C,cAFlB,IAEwC2C,EAAI5C,cAClDG,EAHM,MAKNA,EAAQoD,KAAKC,MAAMZ,EAAI5C,aALjB,IAKsC4C,EAAI3C,eAChDG,EANM,KAQU,MAAhB0B,EAAMb,SACNa,EAAMb,WAEV,IAAIpB,EAAUoF,EAAE0G,QAAO,KAAU7J,EAAMjC,SACvCA,EAAQE,IAAM6C,EAAI7C,IAClBF,EAAQG,YAAc4C,EAAI5C,YAC1BH,EAAQI,aAAe2C,EAAI3C,aAC3BJ,EAAQK,QAAQC,MAAQA,EACxBN,EAAQK,QAAQE,OAASA,EACzBP,EAAQK,QAAQG,KAAOuC,EAAIvC,KAC3BR,EAAQK,QAAQI,IAAMsC,EAAItC,IAC1BT,EAAQU,KAAKJ,MAAQA,EACrBN,EAAQU,KAAKH,OAASA,EACtB,IAAImH,EAAYtC,EAAE,yBAAyBsC,YAAaF,EAAapC,EAAE,yBAAyBoC,aAChGxH,EAAQc,UAAYiC,EAAIvC,KAAOgH,EAAahI,EAAMuM,eAClD/L,EAAQe,SAAWgC,EAAItC,IAAMiH,EAAYlI,EAAMwM,cAAgBxM,EAAMyM,cAAgBzM,EAAM0M,mBAAqB1M,EAAM2M,mBACtH,IAAInI,EAAK/B,EAAMgB,mBACXc,EAAY9B,EAAM8B,UAAUC,EAAIhE,GACpCoF,EAAE,wCAAwCG,OAAOxB,GACjD9B,EAAMb,OAAO4C,GAAMhE,EACnBiC,EAAM2J,MACN3J,EAAM2D,QAEVwG,YAAa,WACGlK,KACNR,MAAO,EACb,IAAI2K,EAAMjH,EAAE,wCAAwC,GAChD+E,EAHQjI,KAGKd,OAHLc,KAGkBb,cAC1B8I,EAAKtJ,YACLsJ,EAAKrJ,UAAYuL,EAAI1L,WAAawJ,EAAKzJ,KAAKC,WAC5CwJ,EAAKpJ,SAAWsL,EAAIzL,UAAYuJ,EAAKzJ,KAAKE,YAE1CuJ,EAAK9J,QAAQG,KAAO6L,EAAI1L,WAAawJ,EAAKzJ,KAAKC,WAC/CwJ,EAAK9J,QAAQI,IAAM4L,EAAIzL,UAAYuJ,EAAKzJ,KAAKE,WATrCsB,KAWN0J,OAEVU,cAAe,WACCpK,KACNV,OAAS,KACf,IAAI6K,EAAMjH,EAAE,wCAAwC,GAChD+E,EAHQjI,KAGKd,OAHLc,KAGkBb,cAC1BkL,EAASF,EAAIG,YAAcrC,EAAKzJ,KAAKJ,MACrCmM,EAASJ,EAAIK,aAAevC,EAAKzJ,KAAKH,OAC1C4J,EAAK9J,QAAQC,MAAQoD,KAAKC,MAAMwG,EAAK9J,QAAQC,MAAQiM,GACrDpC,EAAK9J,QAAQE,OAASmD,KAAKC,MAAMwG,EAAK9J,QAAQE,OAASkM,GACvDtC,EAAKzJ,KAAKJ,MAAQoD,KAAKC,MAAMwG,EAAKzJ,KAAKJ,MAAQiM,GAC/CpC,EAAKzJ,KAAKH,OAASmD,KAAKC,MAAMwG,EAAKzJ,KAAKH,OAASkM,GACjDtC,EAAKzJ,KAAKC,WAAa+C,KAAKC,MAAMwG,EAAKzJ,KAAKC,WAAa4L,GACzDpC,EAAKzJ,KAAKE,UAAY8C,KAAKC,MAAMwG,EAAKzJ,KAAKE,UAAY6L,GACnDtC,EAAKtJ,YACLsJ,EAAKrJ,UAAYuL,EAAI1L,WACrBwJ,EAAKpJ,SAAWsL,EAAIzL,YAEpBuJ,EAAK9J,QAAQG,KAAO6L,EAAI1L,WAAawJ,EAAKzJ,KAAKC,WAC/CwJ,EAAK9J,QAAQI,IAAM4L,EAAIzL,UAAYuJ,EAAKzJ,KAAKE,WAjBrCsB,KAmBN0J,OAEVJ,cAAe,WAGX,GAFYtJ,KACNyK,UAAW,GACZ/M,EAA+BJ,EAAMyK,kBAAmB,eAAe,GACxE,OAEJ7E,EAAE,wCAAwCmE,OAC1CnE,EAAE,6CAA6CmE,OAC/C,IAAIY,EAPQjI,KAOKd,OAPLc,KAOkBb,cAC1B4C,EARQ/B,KAQagC,gBAAgBiG,GACrC7J,EAAQ2D,EAAa3D,MACrBC,EAAS0D,EAAa1D,OACtBC,EAAOyD,EAAazD,KACpBC,EAAMwD,EAAaxD,IACnB2D,EAAWH,EAAaG,SAC5BgB,EAAE,qCAAqCkB,OAAOZ,KAC1CpF,MAASA,EACTC,OAAUA,EACVC,KAAQA,EACRC,IAAOA,EACP2D,SAAYA,IAEhBgB,EAAE,oDAAoDM,KAClDpF,MAAS6J,EAAK9J,QAAQC,MACtBC,OAAU4J,EAAK9J,QAAQE,OACvB6J,mBAAoB,OAASD,EAAKjK,IAAM,IACxCM,MAAS2J,EAAKzJ,KAAKC,WACnBF,KAAQ0J,EAAKzJ,KAAKE,YAEtBwE,EAAE,uDAAuDM,KACrD0E,mBAAoB,OAASD,EAAKjK,IAAM,IACxCmK,kBAAmBF,EAAK9J,QAAQC,MAAQ,MAAQ6J,EAAK9J,QAAQE,OAAS,KACtE+J,uBAAwBH,EAAKzJ,KAAKC,WAAa,OAASwJ,EAAKzJ,KAAKE,UAAY,OAElFwE,EAAE,qEAAqEM,KACnE6E,eAAgBJ,EAAKnJ,OAAOV,MAC5BkK,eAAgBL,EAAKnJ,OAAOE,MAC5BuJ,eAAgBN,EAAKnJ,OAAOG,MAC5BuJ,gBAAiBP,EAAKnJ,OAAOC,OAC7BT,MAAS2J,EAAKnJ,OAAOV,MACrBqK,OAAUR,EAAKnJ,OAAOV,MACtBG,KAAQ0J,EAAKnJ,OAAOV,MACpBsK,QAAWT,EAAKnJ,OAAOV,SAG/BmL,aAAc,WACEvJ,KACNyK,UAAW,EACjBvH,EAAE,qCAAqCmE,OACvC,IAAIY,EAHQjI,KAGKd,OAHLc,KAGkBb,cAC1B4C,EAJQ/B,KAIagC,gBAAgBiG,GACrC7J,EAAQ2D,EAAa3D,MACrBC,EAAS0D,EAAa1D,OACtBC,EAAOyD,EAAazD,KACpBC,EAAMwD,EAAaxD,IACnB2D,EAAWH,EAAaG,SAC5BgB,EAAE,wCAAwCkB,OAAOZ,KAC7CpF,MAASA,EACTC,OAAUA,EACVC,KAAQA,EACRC,IAAOA,EACP2D,SAAYA,IAEhBgB,EAAE,yEAAyEM,KACvE0E,mBAAoB,OAASD,EAAKjK,IAAM,IACxCmK,kBAAmBF,EAAK9J,QAAQC,MAAQ,MAAQ6J,EAAK9J,QAAQE,OAAS,KACtE+J,uBAAwBH,EAAKzJ,KAAKC,WAAa,OAASwJ,EAAKzJ,KAAKE,UAAY,QAGtFgM,kBAAmB,WACH1K,KACNN,WAAa,KACnB,IAAIuI,EAFQjI,KAEKd,OAFLc,KAEkBb,cAC9B8I,EAAKzJ,KAAKJ,MAHE4B,KAGYJ,cAAcxB,MACtC6J,EAAKzJ,KAAKH,OAJE2B,KAIaJ,cAAcvB,OACvC4J,EAAKzJ,KAAKC,WALEuB,KAKiBJ,cAAcnB,WAC3CwJ,EAAKzJ,KAAKE,UANEsB,KAMgBJ,cAAclB,UAN9BsB,KAON0J,OAEVF,eAAgB,WACZ,IACI1L,EADQkC,KACQd,OADRc,KACqBb,cACjCrB,EAAQK,QAAQC,MAAQN,EAAQG,YAChCH,EAAQK,QAAQE,OAASP,EAAQI,aACjCJ,EAAQU,KAAKJ,MAAQN,EAAQG,YAC7BH,EAAQU,KAAKH,OAASP,EAAQI,aAC9BJ,EAAQU,KAAKC,WAAa,EAC1BX,EAAQU,KAAKE,UAAY,EACzB,IAAIqD,EARQ/B,KAQagC,gBAAgBlE,GACrCM,EAAQ2D,EAAa3D,MACrBC,EAAS0D,EAAa1D,OACtBC,EAAOyD,EAAazD,KACpBC,EAAMwD,EAAaxD,IACnB2D,EAAWH,EAAaG,SAC5BgB,EAAE,wCAAwCkB,OAAOZ,KAC7CpF,MAASA,EACTC,OAAUA,EACVC,KAAQA,EACRC,IAAOA,EACP2D,SAAYA,IAEhBgB,EAAE,yEAAyEM,KACvE0E,mBAAoB,OAASpK,EAAQE,IAAM,IAC3CmK,kBAAmBrK,EAAQK,QAAQC,MAAQ,MAAQN,EAAQK,QAAQE,OAAS,KAC5E+J,uBAAwBtK,EAAQU,KAAKC,WAAa,OAASX,EAAQU,KAAKE,UAAY,OAxB5EsB,KA0BN0J,OAEVD,cAAe,WAEXvG,EAAE,wCAAwCmE,OAC1CnE,EAAE,qCAAqCmE,OACvCnE,EAAE,6CAA6CmE,OAC/CnE,EAAE,IAJUlD,KAIEb,cAAcgE,gBAJhBnD,KAKCd,OALDc,KAKcb,cALda,KAMNb,aAAe,KANTa,KAON0J,OAEViB,YAAa,SAAU7C,GACP9H,KACNH,eAAiBqD,EAAE0G,QAAO,KADpB5J,KACoCd,OADpCc,KACiDb,eAC7D,IAAIyL,EAAgB1J,OAAO0J,cAEtBA,IAEDA,EAAgB9C,EAAE+C,cAAcD,eAEpC,IAAIE,EAAS,4EACb,GAAKF,EAaD,OADAA,EAAcG,QAAQ,OAAQD,IACvB,EAbS,CAChB,IAAIE,EAAW9H,EAAE,4BACjB8H,EAASC,KAAKH,GACdE,EAASE,QACTF,EAASG,SACT5F,SAAS6F,YAAY,aACrB7F,SAAS6F,YAAY,QAErBC,WAAW,WACPnI,EAAE,4BAA4BoI,QAC/B,MAOXC,aAAc,WACV,IACInL,EAAW9C,EAAM4C,uBAAuB,GAAGG,WAAa,EACxDC,EAAWhD,EAAM4C,uBAAuB,GAAGK,cAAgB,EAC3DjC,EAAmB,GAAZgC,EAAgB,EAAIhD,EAAMkD,kBAAkBF,EAAW,GAC9D/B,EAAkB,GAAZ6B,EAAgB,EAAI9C,EAAMmD,eAAeL,EAAW,GAC1DS,EAAMqC,EAAE0G,QAAO,KALP5J,KAKuBH,gBACnCgB,EAAI1C,QAAQG,KAAOA,EAAOuC,EAAIrC,KAAKC,WACnCoC,EAAI1C,QAAQI,IAAMA,EAAMsC,EAAIrC,KAAKE,UACjC,IAAI8G,EAAYtC,EAAE,yBAAyBsC,YAAaF,EAAapC,EAAE,yBAAyBoC,aAChGzE,EAAIjC,UAAYiC,EAAI1C,QAAQG,KAAOgH,EAAahI,EAAMuM,eACtDhJ,EAAIhC,SAAWgC,EAAI1C,QAAQI,IAAMiH,EAAYlI,EAAMwM,cAAgBxM,EAAMyM,cAAgBzM,EAAM0M,mBAAqB1M,EAAM2M,mBAC1H,IAAInI,EAXQ9B,KAWGe,mBACXc,EAZQ7B,KAYU6B,UAAUC,EAAIjB,GACpCqC,EAAE,wCAAwCG,OAAOxB,GAbrC7B,KAcNd,OAAO4C,GAAMjB,EAdPb,KAeN0J,MAfM1J,KAgBN0D,QAEV8H,cAAe,WACX,IAAIzL,EAAQC,KAKZ,GAJAkD,EAAE,wCAAwCmE,OAC1CnE,EAAE,qCAAqCmE,OACvCnE,EAAE,6CAA6CmE,OAC/CnE,EAAE,wCAAwCuI,QACtB,MAAhB1L,EAAMb,OAGV,IAAK,IAAIwM,KAAS3L,EAAMb,OAAQ,CAC5B,IAAIpB,EAAUiC,EAAMb,OAAOwM,GACvB7J,EAAY9B,EAAM8B,UAAU6J,EAAO5N,GACvCoF,EAAE,wCAAwCG,OAAOxB,KAGzD8J,eAAgB,SAAUC,EAAIC,EAAOC,GACjC,IAAI/L,EAAQC,KACRd,EAASgE,EAAE0G,QAAO,KAAU7J,EAAMb,QACtC,GAAU,OAAN0M,EAAa,CACb,IAAIG,EAAMzO,EAAMmD,eAAeoL,GAC3BG,EAAaF,GAAQC,GADwBF,EAAQ,IAAM,EAAI,EAAIvO,EAAMmD,eAAeoL,EAAQ,IAC3D,GACzC,IAAK,IAAIH,KAASxM,EAAQ,CACtB,IAAIpB,EAAUoB,EAAOwM,GACjB3J,EAAehC,EAAMiC,gBAAgBlE,GACrCC,EAAOD,EAAQC,KACnB,GAAY,KAARA,GACA,GAAIgE,EAAaxD,KAAOwN,EACpBjO,EAAQK,QAAQI,IAAMwD,EAAaxD,IAAMyN,EAAalO,EAAQU,KAAKE,eAEnE,GAAIqD,EAAaxD,IAAMwD,EAAa1D,QAAU0N,EAAM,EAChD,GAAIhK,EAAaxD,IAAMwN,EAAMC,EAAY,CACrC,IAAIzB,GAAUxI,EAAa1D,OAAS2N,GAAcjK,EAAa1D,OAC/DP,EAAQK,QAAQE,OAASmD,KAAKC,MAAM3D,EAAQK,QAAQE,OAASkM,GAC7DzM,EAAQU,KAAKH,OAASmD,KAAKC,MAAM3D,EAAQU,KAAKH,OAASkM,GACvDzM,EAAQU,KAAKE,UAAY8C,KAAKC,MAAM3D,EAAQU,KAAKE,UAAY6L,OAC1D,CACH,IAAIA,GAAUxI,EAAaxD,IAAMwD,EAAa1D,OAAS0N,GAAOhK,EAAa1D,OAC3EP,EAAQK,QAAQE,OAASmD,KAAKC,MAAM3D,EAAQK,QAAQE,OAASkM,GAC7DzM,EAAQU,KAAKH,OAASmD,KAAKC,MAAM3D,EAAQU,KAAKH,OAASkM,GACvDzM,EAAQU,KAAKE,UAAY8C,KAAKC,MAAM3D,EAAQU,KAAKE,UAAY6L,GAC7DzM,EAAQK,QAAQI,IAAMwN,EAAMC,EAAalO,EAAQU,KAAKE,eAG1D,GAAIqD,EAAaxD,IAAMwN,EAAMC,EAAY,CACrC,IAAIzB,EAAS,EAAIxI,EAAa1D,OAC9BP,EAAQK,QAAQE,OAASmD,KAAKC,MAAM3D,EAAQK,QAAQE,OAASkM,GAC7DzM,EAAQU,KAAKH,OAASmD,KAAKC,MAAM3D,EAAQU,KAAKH,OAASkM,GACvDzM,EAAQU,KAAKE,UAAY8C,KAAKC,MAAM3D,EAAQU,KAAKE,UAAY6L,GAC7DzM,EAAQK,QAAQI,IAAMwN,EAAMC,EAAalO,EAAQU,KAAKE,eACnD,GAAIqD,EAAaxD,IAAMwD,EAAa1D,OAAS0N,EAAMC,EAAY,CAClE,IAAIzB,GAAUwB,EAAMC,EAAajK,EAAaxD,KAAOwD,EAAa1D,OAClEP,EAAQK,QAAQE,OAASmD,KAAKC,MAAM3D,EAAQK,QAAQE,OAASkM,GAC7DzM,EAAQU,KAAKH,OAASmD,KAAKC,MAAM3D,EAAQU,KAAKH,OAASkM,GACvDzM,EAAQU,KAAKE,UAAY8C,KAAKC,MAAM3D,EAAQU,KAAKE,UAAY6L,QAI1D,KAARxM,IACHgE,EAAaxD,KAAOwN,EACpBjO,EAAQK,QAAQI,IAAMwD,EAAaxD,IAAMyN,EAAalO,EAAQU,KAAKE,UAC5DqD,EAAaxD,IAAMwN,EAAMC,IAChClO,EAAQK,QAAQI,IAAMwN,EAAMC,EAAalO,EAAQU,KAAKE,kBAI/D,GAAU,UAANkN,EAAgB,CACvB,IAAIK,EAAM3O,EAAMkD,kBAAkBqL,GAC9BG,EAAaF,GAAQG,GAD2BJ,EAAQ,IAAM,EAAI,EAAIvO,EAAMkD,kBAAkBqL,EAAQ,IACjE,GACzC,IAAK,IAAIH,KAASxM,EAAQ,CACtB,IAAIpB,EAAUoB,EAAOwM,GACjB3J,EAAehC,EAAMiC,gBAAgBlE,GACrCC,EAAOD,EAAQC,KACnB,GAAY,KAARA,GACA,GAAIgE,EAAazD,MAAQ2N,EACrBnO,EAAQK,QAAQG,KAAOyD,EAAazD,KAAO0N,EAAalO,EAAQU,KAAKC,gBAErE,GAAIsD,EAAazD,KAAOyD,EAAa3D,OAAS6N,EAAM,EAChD,GAAIlK,EAAazD,KAAO2N,EAAMD,EAAY,CACtC,IAAI3B,GAAUtI,EAAa3D,MAAQ4N,GAAcjK,EAAa3D,MAC9DN,EAAQK,QAAQC,MAAQoD,KAAKC,MAAM3D,EAAQK,QAAQC,MAAQiM,GAC3DvM,EAAQU,KAAKJ,MAAQoD,KAAKC,MAAM3D,EAAQU,KAAKJ,MAAQiM,GACrDvM,EAAQU,KAAKC,WAAa+C,KAAKC,MAAM3D,EAAQU,KAAKC,WAAa4L,OAC5D,CACH,IAAIA,GAAUtI,EAAazD,KAAOyD,EAAa3D,MAAQ6N,GAAOlK,EAAa3D,MAC3EN,EAAQK,QAAQC,MAAQoD,KAAKC,MAAM3D,EAAQK,QAAQC,MAAQiM,GAC3DvM,EAAQU,KAAKJ,MAAQoD,KAAKC,MAAM3D,EAAQU,KAAKJ,MAAQiM,GACrDvM,EAAQU,KAAKC,WAAa+C,KAAKC,MAAM3D,EAAQU,KAAKC,WAAa4L,GAC/DvM,EAAQK,QAAQG,KAAO2N,EAAMD,EAAalO,EAAQU,KAAKC,gBAG3D,GAAIsD,EAAazD,KAAO2N,EAAMD,EAAY,CACtC,IAAI3B,EAAS,EAAItI,EAAa3D,MAC9BN,EAAQK,QAAQC,MAAQoD,KAAKC,MAAM3D,EAAQK,QAAQC,MAAQiM,GAC3DvM,EAAQU,KAAKJ,MAAQoD,KAAKC,MAAM3D,EAAQU,KAAKJ,MAAQiM,GACrDvM,EAAQU,KAAKC,WAAa+C,KAAKC,MAAM3D,EAAQU,KAAKC,WAAa4L,GAC/DvM,EAAQK,QAAQG,KAAO2N,EAAMD,EAAalO,EAAQU,KAAKC,gBACpD,GAAIsD,EAAazD,KAAOyD,EAAa3D,MAAQ6N,EAAMD,EAAY,CAClE,IAAI3B,GAAU4B,EAAMD,EAAajK,EAAazD,MAAQyD,EAAa3D,MACnEN,EAAQK,QAAQC,MAAQoD,KAAKC,MAAM3D,EAAQK,QAAQC,MAAQiM,GAC3DvM,EAAQU,KAAKJ,MAAQoD,KAAKC,MAAM3D,EAAQU,KAAKJ,MAAQiM,GACrDvM,EAAQU,KAAKC,WAAa+C,KAAKC,MAAM3D,EAAQU,KAAKC,WAAa4L,QAI5D,KAARtM,IACHgE,EAAazD,MAAQ2N,EACrBnO,EAAQK,QAAQG,KAAOyD,EAAazD,KAAO0N,EAAalO,EAAQU,KAAKC,WAC9DsD,EAAazD,KAAO2N,EAAMD,IACjClO,EAAQK,QAAQG,KAAO2N,EAAMD,EAAalO,EAAQU,KAAKC,cAKvE,OAAOS,GAEXwK,IAAK,WACD,IACIwC,EAAO5O,EAAM6O,eAAexO,EAAcL,EAAMyK,oBAChD7I,EAFQc,KAEOd,OACf5B,EAAM8O,cACN9O,EAAM+O,OAAOlM,OAAS,EACtB7C,EAAMgP,OAAOC,MACTxO,KAAQ,YACRyO,WAAclP,EAAMyK,kBACpB7I,OAAyB,MAAfgN,EAAKhN,OAAiB,KAAOgE,EAAE0G,QAAO,KAAUsC,EAAKhN,QAC/DuN,UAAavN,KAGrBgN,EAAKhN,OAASgE,EAAE0G,QAAO,KAAU1K,GACjCnC,EAAO2P,UAAU,MAAOpP,EAAMyK,kBAAmBmE,EAAKhN,QAAUyN,EAAK","file":"../../controllers/imageCtrl.js","sourcesContent":["define([\n    '../global/location',\n    './server',\n    './resize',\n    './constant',\n    './protection',\n    '../methods/get',\n    '../methods/set',\n    '../utils/util',\n    '../store',\n    '../locale/locale'\n], function (m_location, server, luckysheetsizeauto, m_constant, m_protection, m_get, m_set, m_util, Store, locale) {\n    'use strict';\n    const {mouseposition} = m_location;\n    const {modelHTML} = m_constant;\n    const {checkProtectionAuthorityNormal} = m_protection;\n    const {getSheetIndex} = m_get;\n    const {setluckysheet_scroll_status} = m_set;\n    const {replaceHtml} = m_util;\n    const imageCtrl = {\n        imgItem: {\n            type: '3',\n            //1移动并调整单元格大小 2移动并且不调整单元格的大小 3不要移动单元格并调整其大小\n            src: '',\n            //图片url\n            originWidth: null,\n            //图片原始宽度\n            originHeight: null,\n            //图片原始高度\n            default: {\n                width: null,\n                //图片 宽度\n                height: null,\n                //图片 高度\n                left: null,\n                //图片离表格左边的 位置\n                top: null\n            },\n            //图片离表格顶部的 位置\n            crop: {\n                width: null,\n                //图片裁剪后 宽度\n                height: null,\n                //图片裁剪后 高度\n                offsetLeft: 0,\n                //图片裁剪后离未裁剪时 左边的位移\n                offsetTop: 0\n            },\n            //图片裁剪后离未裁剪时 顶部的位移\n            isFixedPos: false,\n            //固定位置\n            fixedLeft: null,\n            //固定位置 左位移\n            fixedTop: null,\n            //固定位置 右位移\n            border: {\n                width: 0,\n                //边框宽度\n                radius: 0,\n                //边框半径\n                style: 'solid',\n                //边框类型\n                color: '#000'\n            }\n        },\n        //边框颜色\n        images: null,\n        currentImgId: null,\n        currentWinW: null,\n        currentWinH: null,\n        resize: null,\n        resizeXY: null,\n        move: false,\n        moveXY: null,\n        cropChange: null,\n        cropChangeXY: null,\n        cropChangeObj: null,\n        copyImgItemObj: null,\n        inserImg: function (src) {\n            let _this = this;\n            let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n            let rowIndex = last.row_focus || 0;\n            let colIndex = last.column_focus || 0;\n            let left = colIndex == 0 ? 0 : Store.visibledatacolumn[colIndex - 1];\n            let top = rowIndex == 0 ? 0 : Store.visibledatarow[rowIndex - 1];\n            let image = new Image();\n            image.onload = function () {\n                let width = image.width, height = image.height;\n                let img = {\n                    src: src,\n                    left: left,\n                    top: top,\n                    originWidth: width,\n                    originHeight: height\n                };\n                _this.addImgItem(img);\n            };\n            image.src = src;\n        },\n        generateRandomId: function (prefix) {\n            if (prefix == null) {\n                prefix = 'img';\n            }\n            let userAgent = window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g, '').split('');\n            let mid = '';\n            for (let i = 0; i < 12; i++) {\n                mid += userAgent[Math.round(Math.random() * (userAgent.length - 1))];\n            }\n            let time = new Date().getTime();\n            return prefix + '_' + mid + '_' + time;\n        },\n        modelHtml: function (id, imgItem) {\n            let _this = this;\n            let src = imgItem.src;\n            let imgItemParam = _this.getImgItemParam(imgItem);\n            let width = imgItemParam.width * Store.zoomRatio;\n            let height = imgItemParam.height * Store.zoomRatio;\n            let left = imgItemParam.left * Store.zoomRatio;\n            let top = imgItemParam.top * Store.zoomRatio;\n            let position = imgItemParam.position;\n            let borderWidth = imgItem.border.width;\n            return `<div id=\"${ id }\" class=\"luckysheet-modal-dialog luckysheet-modal-dialog-image\" style=\"width:${ width }px;height:${ height }px;padding:0;position:${ position };left:${ left }px;top:${ top }px;z-index:200;\">\n                    <div class=\"luckysheet-modal-dialog-content\" style=\"width:100%;height:100%;overflow:hidden;position:relative;\">\n                        <img src=\"${ src }\" style=\"position:absolute;width:${ imgItem.default.width * Store.zoomRatio }px;height:${ imgItem.default.height * Store.zoomRatio }px;left:${ -imgItem.crop.offsetLeft * Store.zoomRatio }px;top:${ -imgItem.crop.offsetTop * Store.zoomRatio }px;\" />\n                    </div>\n                    <div class=\"luckysheet-modal-dialog-border\" style=\"border:${ borderWidth }px ${ imgItem.border.style } ${ imgItem.border.color };border-radius:${ imgItem.border.radius * Store.zoomRatio }px;position:absolute;left:${ -borderWidth }px;right:${ -borderWidth }px;top:${ -borderWidth }px;bottom:${ -borderWidth }px;\"></div>\n                </div>`;\n        },\n        getSliderHtml: function () {\n            let imageText = locale().imageText;\n            return `<div id=\"luckysheet-modal-dialog-slider-imageCtrl\" class=\"luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-imageCtrl\" style=\"display:block;\">\n                    <div class=\"luckysheet-modal-dialog-slider-title\">\n                        <span>${ imageText.imageSetting }</span>\n                        <span class=\"luckysheet-model-close-btn\" title=\"${ imageText.close }\">\n                            <i class=\"fa fa-times\" aria-hidden=\"true\"></i>\n                        </span>\n                    </div>\n                    <div class=\"luckysheet-modal-dialog-slider-content\">\n                        <div class=\"slider-box\">\n                            <div class=\"slider-box-title\">${ imageText.conventional }</div>\n                            <div class=\"slider-box-radios\">\n                                <div class=\"radio-item\">\n                                    <input type=\"radio\" id=\"imgItemType1\" name=\"imgItemType\" value=\"1\">\n                                    <label for=\"imgItemType1\">${ imageText.moveCell1 }</label>\n                                </div>\n                                <div class=\"radio-item\">\n                                    <input type=\"radio\" id=\"imgItemType2\" name=\"imgItemType\" value=\"2\">\n                                    <label for=\"imgItemType2\">${ imageText.moveCell2 }</label>\n                                </div>\n                                <div class=\"radio-item\">\n                                    <input type=\"radio\" id=\"imgItemType3\" name=\"imgItemType\" value=\"3\">\n                                    <label for=\"imgItemType3\">${ imageText.moveCell3 }</label>\n                                </div>\n                            </div>\n                            <div class=\"slider-box-checkbox\">\n                                <input type=\"checkbox\" id=\"imgItemIsFixedPos\">\n                                <label for=\"imgItemIsFixedPos\">${ imageText.fixedPos }</label>\n                            </div>\n                        </div>\n                        <div class=\"slider-box\">\n                            <div class=\"slider-box-title\">${ imageText.border }</div>\n                            <div class=\"slider-box-borderConfig\">\n                                <div class=\"border-item\">\n                                    <label>${ imageText.width }</label>\n                                    <input type=\"number\" id=\"imgItemBorderWidth\" min=\"0\">\n                                </div>\n                                <div class=\"border-item\">\n                                    <label>${ imageText.radius }</label>\n                                    <input type=\"number\" id=\"imgItemBorderRadius\" min=\"0\">\n                                </div>\n                                <div class=\"border-item\">\n                                    <label>${ imageText.style }</label>\n                                    <select id=\"imgItemBorderStyle\">\n                                        <option value=\"solid\">${ imageText.solid }</option>\n                                        <option value=\"dashed\">${ imageText.dashed }</option>\n                                        <option value=\"dotted\">${ imageText.dotted }</option>\n                                        <option value=\"double\">${ imageText.double }</option>\n                                    </select>\n                                </div>\n                                <div class=\"border-item\">\n                                    <label>${ imageText.color }</label>\n                                    <div id=\"imgItemBorderColor\" class=\"imgItemBorderColor\">\n                                        <span></span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>`;\n        },\n        sliderHtmlShow: function () {\n            let _this = this;\n            $('#luckysheet-modal-dialog-slider-imageCtrl').remove();\n            let sliderHtml = _this.getSliderHtml();\n            $('body').append(sliderHtml);\n            luckysheetsizeauto();\n            let imgItem = _this.images[_this.currentImgId];    //类型\n            //类型\n            let type = imgItem.type;\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemType' + type).prop('checked', true);    //固定位置\n            //固定位置\n            let isFixedPos = imgItem.isFixedPos;\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemIsFixedPos').prop('checked', isFixedPos);    //边框宽度\n            //边框宽度\n            let border = imgItem.border;\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderWidth').val(border.width);\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderRadius').val(border.radius);\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderStyle').val(border.style);\n            $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span').css('background-color', border.color).attr('title', border.color);\n            _this.init();\n        },\n        colorSelectDialog: function (currenColor) {\n            const _locale = locale();\n            const locale_button = _locale.button;\n            const locale_toolbar = _locale.toolbar;\n            const locale_imageCtrl = _locale.imageCtrl;\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-imageCtrl-colorSelect-dialog').remove();\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-imageCtrl-colorSelect-dialog',\n                'addclass': 'luckysheet-imageCtrl-colorSelect-dialog',\n                'title': locale_imageCtrl.borderTile,\n                'content': `<div class=\"currenColor\">\n                            ${ locale_imageCtrl.borderCur }:<span title=\"${ currenColor }\" style=\"background-color:${ currenColor }\"></span>\n                        </div>\n                        <div class=\"colorshowbox\"></div>`,\n                'botton': `<button id=\"luckysheet-imageCtrl-colorSelect-dialog-confirm\" class=\"btn btn-primary\">${ locale_button.confirm }</button>\n                        <button class=\"btn btn-default luckysheet-model-close-btn\">${ locale_button.cancel }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-imageCtrl-colorSelect-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-imageCtrl-colorSelect-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();    //初始化选择颜色插件\n            //初始化选择颜色插件\n            $('#luckysheet-imageCtrl-colorSelect-dialog').find('.colorshowbox').spectrum({\n                showPalette: true,\n                showPaletteOnly: true,\n                preferredFormat: 'hex',\n                clickoutFiresChange: false,\n                showInitial: true,\n                showInput: true,\n                flat: true,\n                hideAfterPaletteSelect: true,\n                showSelectionPalette: true,\n                showButtons: false,\n                //隐藏选择取消按钮\n                maxPaletteSize: 8,\n                maxSelectionSize: 8,\n                color: currenColor,\n                cancelText: locale_button.cancel,\n                chooseText: locale_toolbar.confirmColor,\n                togglePaletteMoreText: locale_toolbar.customColor,\n                togglePaletteLessText: locale_toolbar.collapse,\n                togglePaletteOnly: true,\n                clearText: locale_toolbar.clearText,\n                noColorSelectedText: locale_toolbar.noColorSelectedText,\n                localStorageKey: 'spectrum.textcolor' + server.gridKey,\n                palette: [\n                    [\n                        '#000',\n                        '#444',\n                        '#666',\n                        '#999',\n                        '#ccc',\n                        '#eee',\n                        '#f3f3f3',\n                        '#fff'\n                    ],\n                    [\n                        '#f00',\n                        '#f90',\n                        '#ff0',\n                        '#0f0',\n                        '#0ff',\n                        '#00f',\n                        '#90f',\n                        '#f0f'\n                    ],\n                    [\n                        '#f4cccc',\n                        '#fce5cd',\n                        '#fff2cc',\n                        '#d9ead3',\n                        '#d0e0e3',\n                        '#cfe2f3',\n                        '#d9d2e9',\n                        '#ead1dc'\n                    ],\n                    [\n                        '#ea9999',\n                        '#f9cb9c',\n                        '#ffe599',\n                        '#b6d7a8',\n                        '#a2c4c9',\n                        '#9fc5e8',\n                        '#b4a7d6',\n                        '#d5a6bd'\n                    ],\n                    [\n                        '#e06666',\n                        '#f6b26b',\n                        '#ffd966',\n                        '#93c47d',\n                        '#76a5af',\n                        '#6fa8dc',\n                        '#8e7cc3',\n                        '#c27ba0'\n                    ],\n                    [\n                        '#c00',\n                        '#e69138',\n                        '#f1c232',\n                        '#6aa84f',\n                        '#45818e',\n                        '#3d85c6',\n                        '#674ea7',\n                        '#a64d79'\n                    ],\n                    [\n                        '#900',\n                        '#b45f06',\n                        '#bf9000',\n                        '#38761d',\n                        '#134f5c',\n                        '#0b5394',\n                        '#351c75',\n                        '#741b47'\n                    ],\n                    [\n                        '#600',\n                        '#783f04',\n                        '#7f6000',\n                        '#274e13',\n                        '#0c343d',\n                        '#073763',\n                        '#20124d',\n                        '#4c1130'\n                    ]\n                ],\n                move: function (color) {\n                    if (color != null) {\n                        color = color.toHexString();\n                    } else {\n                        color = '#000';\n                    }\n                    $('#luckysheet-imageCtrl-colorSelect-dialog .currenColor span').css('background-color', color).attr('title', color);\n                }\n            });\n        },\n        init: function () {\n            let _this = this;    //关闭\n            //关闭\n            $('#luckysheet-modal-dialog-slider-imageCtrl .luckysheet-model-close-btn').click(function () {\n                $('#luckysheet-modal-dialog-slider-imageCtrl').hide();\n                luckysheetsizeauto();\n            });    //常规\n            //常规\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('change.radio').on('change.radio', '.radio-item input[type=radio][name=imgItemType]', function () {\n                _this.configChange('type', this.value);\n            });    //固定位置\n            //固定位置\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('change.checkbox').on('change.checkbox', '.slider-box-checkbox input[type=checkbox]', function () {\n                _this.configChange('fixedPos', this.checked);\n            });    //边框宽度\n            //边框宽度\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('change.borderWidth').on('change.borderWidth', '#imgItemBorderWidth', function () {\n                _this.configChange('border-width', this.valueAsNumber);\n            });    //边框半径\n            //边框半径\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('change.borderRadius').on('change.borderRadius', '#imgItemBorderRadius', function () {\n                _this.configChange('border-radius', this.valueAsNumber);\n            });    //边框样式\n            //边框样式\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('change.borderStyle').on('change.borderStyle', '#imgItemBorderStyle', function () {\n                _this.configChange('border-style', this.value);\n            });    //边框颜色 选择\n            //边框颜色 选择\n            $('#luckysheet-modal-dialog-slider-imageCtrl').off('click.color').on('click.color', '#imgItemBorderColor', function () {\n                let currenColor = $(this).find('span').attr('title');\n                _this.colorSelectDialog(currenColor);\n            });    //边框选择颜色 确定 \n            //边框选择颜色 确定 \n            $(document).off('click.selectColorConfirm').on('click.selectColorConfirm', '#luckysheet-imageCtrl-colorSelect-dialog-confirm', function () {\n                let $parent = $(this).parents('#luckysheet-imageCtrl-colorSelect-dialog');\n                $('#luckysheet-modal-dialog-mask').hide();\n                $parent.hide();\n                let currenColor = $parent.find('.currenColor span').attr('title');\n                $('#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span').css('background-color', currenColor).attr('title', currenColor);\n                _this.configChange('border-color', currenColor);\n            });    //image active\n            //image active\n            $('#luckysheet-image-showBoxs').off('mousedown.active').on('mousedown.active', '.luckysheet-modal-dialog-image', function (e) {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects', false)) {\n                    return;\n                }\n                $(this).hide();\n                let id = $(this).attr('id');\n                if (_this.currentImgId != null && _this.currentImgId != id) {\n                    _this.cancelActiveImgItem();\n                }\n                _this.currentImgId = id;\n                let item = _this.images[id];\n                let imgItemParam = _this.getImgItemParam(item);\n                let width = imgItemParam.width * Store.zoomRatio;\n                let height = imgItemParam.height * Store.zoomRatio;\n                let left = imgItemParam.left * Store.zoomRatio;\n                let top = imgItemParam.top * Store.zoomRatio;\n                let position = imgItemParam.position;\n                $('#luckysheet-modal-dialog-activeImage').show().css({\n                    'width': width,\n                    'height': height,\n                    'left': left,\n                    'top': top,\n                    'position': position\n                });\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content').css({\n                    'background-image': 'url(' + item.src + ')',\n                    'background-size': item.default.width * Store.zoomRatio + 'px ' + item.default.height * Store.zoomRatio + 'px',\n                    'background-position': -item.crop.offsetLeft * Store.zoomRatio + 'px ' + -item.crop.offsetTop * Store.zoomRatio + 'px'\n                });\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border').css({\n                    'border-width': item.border.width * Store.zoomRatio,\n                    'border-style': item.border.style,\n                    'border-color': item.border.color,\n                    'border-radius': item.border.radius * Store.zoomRatio,\n                    'left': -item.border.width * Store.zoomRatio,\n                    'right': -item.border.width * Store.zoomRatio,\n                    'top': -item.border.width * Store.zoomRatio,\n                    'bottom': -item.border.width * Store.zoomRatio\n                });\n                _this.sliderHtmlShow();\n                e.stopPropagation();\n            });    //image move\n            //image move\n            $('#luckysheet-modal-dialog-activeImage').off('mousedown.move').on('mousedown.move', '.luckysheet-modal-dialog-content', function (e) {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects', false)) {\n                    return;\n                }\n                if (!$('#luckysheet-modal-dialog-slider-imageCtrl').is(':visible')) {\n                    _this.sliderHtmlShow();\n                }\n                _this.move = true;\n                _this.currentWinW = $('#luckysheet-cell-main')[0].scrollWidth;\n                _this.currentWinH = $('#luckysheet-cell-main')[0].scrollHeight;\n                let offset = $('#luckysheet-modal-dialog-activeImage').offset();\n                _this.moveXY = [\n                    e.pageX - offset.left,\n                    e.pageY - offset.top\n                ];\n                setluckysheet_scroll_status(true);\n                e.stopPropagation();\n            });    //image resize\n            //image resize\n            $('#luckysheet-modal-dialog-activeImage').off('mousedown.resize').on('mousedown.resize', '.luckysheet-modal-dialog-resize-item', function (e) {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects', false)) {\n                    return;\n                }\n                _this.currentWinW = $('#luckysheet-cell-main')[0].scrollWidth;\n                _this.currentWinH = $('#luckysheet-cell-main')[0].scrollHeight;\n                _this.resize = $(this).data('type');\n                let scrollTop = $('#luckysheet-cell-main').scrollTop(), scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let mouse = mouseposition(e.pageX, e.pageY);\n                let x = mouse[0] + scrollLeft;\n                let y = mouse[1] + scrollTop;\n                let position = $('#luckysheet-modal-dialog-activeImage').position();\n                let width = $('#luckysheet-modal-dialog-activeImage').width();\n                let height = $('#luckysheet-modal-dialog-activeImage').height();\n                _this.resizeXY = [\n                    x,\n                    y,\n                    width,\n                    height,\n                    position.left + scrollLeft,\n                    position.top + scrollTop,\n                    scrollLeft,\n                    scrollTop\n                ];\n                setluckysheet_scroll_status(true);\n                e.stopPropagation();\n            });    //image croppingEnter\n            //image croppingEnter\n            $('#luckysheet-modal-dialog-activeImage').off('mousedown.croppingEnter').on('mousedown.croppingEnter', '.luckysheet-modal-controll-crop', function (e) {\n                _this.croppingEnter();\n                e.stopPropagation();\n            });    //image croppingExit\n            //image croppingExit\n            $('#luckysheet-modal-dialog-cropping').off('mousedown.croppingExit').on('mousedown.croppingExit', '.luckysheet-modal-controll-crop', function (e) {\n                _this.croppingExit();\n                e.stopPropagation();\n            });    //image crop change\n            //image crop change\n            $('#luckysheet-modal-dialog-cropping').off('mousedown.cropChange').on('mousedown.cropChange', '.resize-item', function (e) {\n                _this.cropChange = $(this).data('type');\n                let scrollTop = $('#luckysheet-cell-main').scrollTop(), scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                let mouse = mouseposition(e.pageX, e.pageY);\n                let x = mouse[0] + scrollLeft;\n                let y = mouse[1] + scrollTop;\n                _this.cropChangeXY = [\n                    x,\n                    y\n                ];\n                setluckysheet_scroll_status(true);\n                e.stopPropagation();\n            });    //image restore\n            //image restore\n            $('#luckysheet-image-showBoxs').off('mousedown.restore').on('mousedown.restore', '.luckysheet-modal-controll-restore', function (e) {\n                _this.restoreImgItem();\n                e.stopPropagation();\n            });    //image delete\n            //image delete\n            $('#luckysheet-image-showBoxs').off('mousedown.delete').on('mousedown.delete', '.luckysheet-modal-controll-del', function (e) {\n                _this.removeImgItem();\n                e.stopPropagation();\n            });\n        },\n        configChange: function (type, value) {\n            let _this = this;\n            let imgItem = _this.images[_this.currentImgId];\n            switch (type) {\n            case 'type':\n                imgItem.type = value;\n                break;\n            case 'fixedPos':\n                imgItem.isFixedPos = value;\n                let imgItemParam = _this.getImgItemParam(imgItem);\n                let width = imgItemParam.width;\n                let height = imgItemParam.height;\n                let left = imgItemParam.left;\n                let top = imgItemParam.top;\n                let position = imgItemParam.position;\n                $('#luckysheet-modal-dialog-activeImage').show().css({\n                    'width': width,\n                    'height': height,\n                    'left': left,\n                    'top': top,\n                    'position': position\n                });\n                break;\n            case 'border-width':\n                imgItem.border.width = value;\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border').css({\n                    'border-width': value,\n                    'left': -value,\n                    'right': -value,\n                    'top': -value,\n                    'bottom': -value\n                });\n                break;\n            case 'border-radius':\n                imgItem.border.radius = value;\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border').css('border-radius', value);\n                break;\n            case 'border-style':\n                imgItem.border.style = value;\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border').css('border-style', value);\n                break;\n            case 'border-color':\n                imgItem.border.color = value;\n                $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border').css('border-color', value);\n                break;\n            }\n            _this.ref();\n        },\n        getImgItemParam(imgItem) {\n            let isFixedPos = imgItem.isFixedPos;\n            let width = imgItem.default.width, height = imgItem.default.height, left = imgItem.default.left, top = imgItem.default.top;\n            if (imgItem.crop.width != width || imgItem.crop.height != height) {\n                width = imgItem.crop.width;\n                height = imgItem.crop.height;\n                left += imgItem.crop.offsetLeft;\n                top += imgItem.crop.offsetTop;\n            }\n            let position = 'absolute';\n            if (isFixedPos) {\n                position = 'fixed';\n                left = imgItem.fixedLeft + imgItem.crop.offsetLeft;\n                top = imgItem.fixedTop + imgItem.crop.offsetTop;\n            }\n            return {\n                width: width,\n                height: height,\n                left: left,\n                top: top,\n                position: position\n            };\n        },\n        cancelActiveImgItem: function () {\n            let _this = this;\n            $('#luckysheet-modal-dialog-activeImage').hide();\n            $('#luckysheet-modal-dialog-cropping').hide();\n            $('#luckysheet-modal-dialog-slider-imageCtrl').hide();\n            let imgItem = _this.images[_this.currentImgId];\n            let imgItemParam = _this.getImgItemParam(imgItem);\n            let width = imgItemParam.width * Store.zoomRatio;\n            let height = imgItemParam.height * Store.zoomRatio;\n            let left = imgItemParam.left * Store.zoomRatio;\n            let top = imgItemParam.top * Store.zoomRatio;\n            let position = imgItemParam.position;\n            $('#' + _this.currentImgId).show().css({\n                'width': width,\n                'height': height,\n                'left': left,\n                'top': top,\n                'position': position\n            });\n            $('#' + _this.currentImgId + ' img').css({\n                'width': imgItem.default.width * Store.zoomRatio,\n                'height': imgItem.default.height * Store.zoomRatio,\n                'left': -imgItem.crop.offsetLeft * Store.zoomRatio,\n                'top': -imgItem.crop.offsetTop * Store.zoomRatio\n            });\n            $('#' + _this.currentImgId + ' .luckysheet-modal-dialog-border').css({\n                'border-width': imgItem.border.width * Store.zoomRatio,\n                'border-style': imgItem.border.style,\n                'border-color': imgItem.border.color,\n                'border-radius': imgItem.border.radius * Store.zoomRatio,\n                'left': -imgItem.border.width * Store.zoomRatio,\n                'right': -imgItem.border.width * Store.zoomRatio,\n                'top': -imgItem.border.width * Store.zoomRatio,\n                'bottom': -imgItem.border.width * Store.zoomRatio\n            });\n            _this.currentImgId = null;\n        },\n        addImgItem: function (img) {\n            let _this = this;\n            let width, height;\n            let max = 400;\n            if (img.originHeight < img.originWidth) {\n                height = Math.round(img.originHeight * (max / img.originWidth));\n                width = max;\n            } else {\n                width = Math.round(img.originWidth * (max / img.originHeight));\n                height = max;\n            }\n            if (_this.images == null) {\n                _this.images = {};\n            }\n            let imgItem = $.extend(true, {}, _this.imgItem);\n            imgItem.src = img.src;\n            imgItem.originWidth = img.originWidth;\n            imgItem.originHeight = img.originHeight;\n            imgItem.default.width = width;\n            imgItem.default.height = height;\n            imgItem.default.left = img.left;\n            imgItem.default.top = img.top;\n            imgItem.crop.width = width;\n            imgItem.crop.height = height;\n            let scrollTop = $('#luckysheet-cell-main').scrollTop(), scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            imgItem.fixedLeft = img.left - scrollLeft + Store.rowHeaderWidth;\n            imgItem.fixedTop = img.top - scrollTop + Store.infobarHeight + Store.toolbarHeight + Store.calculatebarHeight + Store.columnHeaderHeight;\n            let id = _this.generateRandomId();\n            let modelHtml = _this.modelHtml(id, imgItem);\n            $('#luckysheet-image-showBoxs .img-list').append(modelHtml);\n            _this.images[id] = imgItem;\n            _this.ref();\n            _this.init();\n        },\n        moveImgItem: function () {\n            let _this = this;\n            _this.move = false;\n            let obj = $('#luckysheet-modal-dialog-activeImage')[0];\n            let item = _this.images[_this.currentImgId];\n            if (item.isFixedPos) {\n                item.fixedLeft = obj.offsetLeft - item.crop.offsetLeft;\n                item.fixedTop = obj.offsetTop - item.crop.offsetTop;\n            } else {\n                item.default.left = obj.offsetLeft - item.crop.offsetLeft;\n                item.default.top = obj.offsetTop - item.crop.offsetTop;\n            }\n            _this.ref();\n        },\n        resizeImgItem: function () {\n            let _this = this;\n            _this.resize = null;\n            let obj = $('#luckysheet-modal-dialog-activeImage')[0];\n            let item = _this.images[_this.currentImgId];\n            let scaleX = obj.clientWidth / item.crop.width;\n            let scaleY = obj.clientHeight / item.crop.height;\n            item.default.width = Math.round(item.default.width * scaleX);\n            item.default.height = Math.round(item.default.height * scaleY);\n            item.crop.width = Math.round(item.crop.width * scaleX);\n            item.crop.height = Math.round(item.crop.height * scaleY);\n            item.crop.offsetLeft = Math.round(item.crop.offsetLeft * scaleX);\n            item.crop.offsetTop = Math.round(item.crop.offsetTop * scaleY);\n            if (item.isFixedPos) {\n                item.fixedLeft = obj.offsetLeft;\n                item.fixedTop = obj.offsetTop;\n            } else {\n                item.default.left = obj.offsetLeft - item.crop.offsetLeft;\n                item.default.top = obj.offsetTop - item.crop.offsetTop;\n            }\n            _this.ref();\n        },\n        croppingEnter: function () {\n            let _this = this;\n            _this.cropping = true;\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'editObjects', false)) {\n                return;\n            }\n            $('#luckysheet-modal-dialog-activeImage').hide();\n            $('#luckysheet-modal-dialog-slider-imageCtrl').hide();\n            let item = _this.images[_this.currentImgId];\n            let imgItemParam = _this.getImgItemParam(item);\n            let width = imgItemParam.width;\n            let height = imgItemParam.height;\n            let left = imgItemParam.left;\n            let top = imgItemParam.top;\n            let position = imgItemParam.position;\n            $('#luckysheet-modal-dialog-cropping').show().css({\n                'width': width,\n                'height': height,\n                'left': left,\n                'top': top,\n                'position': position\n            });\n            $('#luckysheet-modal-dialog-cropping .cropping-mask').css({\n                'width': item.default.width,\n                'height': item.default.height,\n                'background-image': 'url(' + item.src + ')',\n                'left': -item.crop.offsetLeft,\n                'top': -item.crop.offsetTop\n            });\n            $('#luckysheet-modal-dialog-cropping .cropping-content').css({\n                'background-image': 'url(' + item.src + ')',\n                'background-size': item.default.width + 'px ' + item.default.height + 'px',\n                'background-position': -item.crop.offsetLeft + 'px ' + -item.crop.offsetTop + 'px'\n            });\n            $('#luckysheet-modal-dialog-cropping .luckysheet-modal-dialog-border').css({\n                'border-width': item.border.width,\n                'border-style': item.border.style,\n                'border-color': item.border.color,\n                'border-radius': item.border.radius,\n                'left': -item.border.width,\n                'right': -item.border.width,\n                'top': -item.border.width,\n                'bottom': -item.border.width\n            });\n        },\n        croppingExit: function () {\n            let _this = this;\n            _this.cropping = false;\n            $('#luckysheet-modal-dialog-cropping').hide();\n            let item = _this.images[_this.currentImgId];\n            let imgItemParam = _this.getImgItemParam(item);\n            let width = imgItemParam.width;\n            let height = imgItemParam.height;\n            let left = imgItemParam.left;\n            let top = imgItemParam.top;\n            let position = imgItemParam.position;\n            $('#luckysheet-modal-dialog-activeImage').show().css({\n                'width': width,\n                'height': height,\n                'left': left,\n                'top': top,\n                'position': position\n            });\n            $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content').css({\n                'background-image': 'url(' + item.src + ')',\n                'background-size': item.default.width + 'px ' + item.default.height + 'px',\n                'background-position': -item.crop.offsetLeft + 'px ' + -item.crop.offsetTop + 'px'\n            });\n        },\n        cropChangeImgItem: function () {\n            let _this = this;\n            _this.cropChange = null;\n            let item = _this.images[_this.currentImgId];\n            item.crop.width = _this.cropChangeObj.width;\n            item.crop.height = _this.cropChangeObj.height;\n            item.crop.offsetLeft = _this.cropChangeObj.offsetLeft;\n            item.crop.offsetTop = _this.cropChangeObj.offsetTop;\n            _this.ref();\n        },\n        restoreImgItem: function () {\n            let _this = this;\n            let imgItem = _this.images[_this.currentImgId];\n            imgItem.default.width = imgItem.originWidth;\n            imgItem.default.height = imgItem.originHeight;\n            imgItem.crop.width = imgItem.originWidth;\n            imgItem.crop.height = imgItem.originHeight;\n            imgItem.crop.offsetLeft = 0;\n            imgItem.crop.offsetTop = 0;\n            let imgItemParam = _this.getImgItemParam(imgItem);\n            let width = imgItemParam.width;\n            let height = imgItemParam.height;\n            let left = imgItemParam.left;\n            let top = imgItemParam.top;\n            let position = imgItemParam.position;\n            $('#luckysheet-modal-dialog-activeImage').show().css({\n                'width': width,\n                'height': height,\n                'left': left,\n                'top': top,\n                'position': position\n            });\n            $('#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content').css({\n                'background-image': 'url(' + imgItem.src + ')',\n                'background-size': imgItem.default.width + 'px ' + imgItem.default.height + 'px',\n                'background-position': -imgItem.crop.offsetLeft + 'px ' + -imgItem.crop.offsetTop + 'px'\n            });\n            _this.ref();\n        },\n        removeImgItem: function () {\n            let _this = this;\n            $('#luckysheet-modal-dialog-activeImage').hide();\n            $('#luckysheet-modal-dialog-cropping').hide();\n            $('#luckysheet-modal-dialog-slider-imageCtrl').hide();\n            $('#' + _this.currentImgId).remove();\n            delete _this.images[_this.currentImgId];\n            _this.currentImgId = null;\n            _this.ref();\n        },\n        copyImgItem: function (e) {\n            let _this = this;\n            _this.copyImgItemObj = $.extend(true, {}, _this.images[_this.currentImgId]);\n            let clipboardData = window.clipboardData;    //for IE\n            //for IE\n            if (!clipboardData) {\n                // for chrome\n                clipboardData = e.originalEvent.clipboardData;\n            }\n            let cpdata = '<table data-type=\"luckysheet_copy_action_image\"><tr><td><td></tr></table>';\n            if (!clipboardData) {\n                let textarea = $('#luckysheet-copy-content');\n                textarea.html(cpdata);\n                textarea.focus();\n                textarea.select();\n                document.execCommand('selectAll');\n                document.execCommand('Copy');    // 等50毫秒，keyPress事件发生了再去处理数据\n                // 等50毫秒，keyPress事件发生了再去处理数据\n                setTimeout(function () {\n                    $('#luckysheet-copy-content').blur();\n                }, 10);\n            } else {\n                clipboardData.setData('Text', cpdata);\n                return false;    //否则设不生效\n            }\n        },\n        //否则设不生效\n        pasteImgItem: function () {\n            let _this = this;\n            let rowIndex = Store.luckysheet_select_save[0].row_focus || 0;\n            let colIndex = Store.luckysheet_select_save[0].column_focus || 0;\n            let left = colIndex == 0 ? 0 : Store.visibledatacolumn[colIndex - 1];\n            let top = rowIndex == 0 ? 0 : Store.visibledatarow[rowIndex - 1];\n            let img = $.extend(true, {}, _this.copyImgItemObj);\n            img.default.left = left - img.crop.offsetLeft;\n            img.default.top = top - img.crop.offsetTop;\n            let scrollTop = $('#luckysheet-cell-main').scrollTop(), scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            img.fixedLeft = img.default.left - scrollLeft + Store.rowHeaderWidth;\n            img.fixedTop = img.default.top - scrollTop + Store.infobarHeight + Store.toolbarHeight + Store.calculatebarHeight + Store.columnHeaderHeight;\n            let id = _this.generateRandomId();\n            let modelHtml = _this.modelHtml(id, img);\n            $('#luckysheet-image-showBoxs .img-list').append(modelHtml);\n            _this.images[id] = img;\n            _this.ref();\n            _this.init();\n        },\n        allImagesShow: function () {\n            let _this = this;\n            $('#luckysheet-modal-dialog-activeImage').hide();\n            $('#luckysheet-modal-dialog-cropping').hide();\n            $('#luckysheet-modal-dialog-slider-imageCtrl').hide();\n            $('#luckysheet-image-showBoxs .img-list').empty();\n            if (_this.images == null) {\n                return;\n            }\n            for (let imgId in _this.images) {\n                let imgItem = _this.images[imgId];\n                let modelHtml = _this.modelHtml(imgId, imgItem);\n                $('#luckysheet-image-showBoxs .img-list').append(modelHtml);\n            }\n        },\n        moveChangeSize: function (rc, index, size) {\n            let _this = this;\n            let images = $.extend(true, {}, _this.images);\n            if (rc == 'row') {\n                let row = Store.visibledatarow[index], row_pre = index - 1 == -1 ? 0 : Store.visibledatarow[index - 1];\n                let changeSize = size - (row - row_pre - 1);\n                for (let imgId in images) {\n                    let imgItem = images[imgId];\n                    let imgItemParam = _this.getImgItemParam(imgItem);\n                    let type = imgItem.type;\n                    if (type == '1') {\n                        if (imgItemParam.top >= row) {\n                            imgItem.default.top = imgItemParam.top + changeSize - imgItem.crop.offsetTop;\n                        } else {\n                            if (imgItemParam.top + imgItemParam.height >= row - 2) {\n                                if (imgItemParam.top < row + changeSize) {\n                                    let scaleY = (imgItemParam.height + changeSize) / imgItemParam.height;\n                                    imgItem.default.height = Math.round(imgItem.default.height * scaleY);\n                                    imgItem.crop.height = Math.round(imgItem.crop.height * scaleY);\n                                    imgItem.crop.offsetTop = Math.round(imgItem.crop.offsetTop * scaleY);\n                                } else {\n                                    let scaleY = (imgItemParam.top + imgItemParam.height - row) / imgItemParam.height;\n                                    imgItem.default.height = Math.round(imgItem.default.height * scaleY);\n                                    imgItem.crop.height = Math.round(imgItem.crop.height * scaleY);\n                                    imgItem.crop.offsetTop = Math.round(imgItem.crop.offsetTop * scaleY);\n                                    imgItem.default.top = row + changeSize - imgItem.crop.offsetTop;\n                                }\n                            } else {\n                                if (imgItemParam.top > row + changeSize) {\n                                    let scaleY = 1 / imgItemParam.height;\n                                    imgItem.default.height = Math.round(imgItem.default.height * scaleY);\n                                    imgItem.crop.height = Math.round(imgItem.crop.height * scaleY);\n                                    imgItem.crop.offsetTop = Math.round(imgItem.crop.offsetTop * scaleY);\n                                    imgItem.default.top = row + changeSize - imgItem.crop.offsetTop;\n                                } else if (imgItemParam.top + imgItemParam.height > row + changeSize) {\n                                    let scaleY = (row + changeSize - imgItemParam.top) / imgItemParam.height;\n                                    imgItem.default.height = Math.round(imgItem.default.height * scaleY);\n                                    imgItem.crop.height = Math.round(imgItem.crop.height * scaleY);\n                                    imgItem.crop.offsetTop = Math.round(imgItem.crop.offsetTop * scaleY);\n                                }\n                            }\n                        }\n                    } else if (type == '2') {\n                        if (imgItemParam.top >= row) {\n                            imgItem.default.top = imgItemParam.top + changeSize - imgItem.crop.offsetTop;\n                        } else if (imgItemParam.top > row + changeSize) {\n                            imgItem.default.top = row + changeSize - imgItem.crop.offsetTop;\n                        }\n                    }\n                }\n            } else if (rc == 'column') {\n                let col = Store.visibledatacolumn[index], col_pre = index - 1 == -1 ? 0 : Store.visibledatacolumn[index - 1];\n                let changeSize = size - (col - col_pre - 1);\n                for (let imgId in images) {\n                    let imgItem = images[imgId];\n                    let imgItemParam = _this.getImgItemParam(imgItem);\n                    let type = imgItem.type;\n                    if (type == '1') {\n                        if (imgItemParam.left >= col) {\n                            imgItem.default.left = imgItemParam.left + changeSize - imgItem.crop.offsetLeft;\n                        } else {\n                            if (imgItemParam.left + imgItemParam.width >= col - 2) {\n                                if (imgItemParam.left < col + changeSize) {\n                                    let scaleX = (imgItemParam.width + changeSize) / imgItemParam.width;\n                                    imgItem.default.width = Math.round(imgItem.default.width * scaleX);\n                                    imgItem.crop.width = Math.round(imgItem.crop.width * scaleX);\n                                    imgItem.crop.offsetLeft = Math.round(imgItem.crop.offsetLeft * scaleX);\n                                } else {\n                                    let scaleX = (imgItemParam.left + imgItemParam.width - col) / imgItemParam.width;\n                                    imgItem.default.width = Math.round(imgItem.default.width * scaleX);\n                                    imgItem.crop.width = Math.round(imgItem.crop.width * scaleX);\n                                    imgItem.crop.offsetLeft = Math.round(imgItem.crop.offsetLeft * scaleX);\n                                    imgItem.default.left = col + changeSize - imgItem.crop.offsetLeft;\n                                }\n                            } else {\n                                if (imgItemParam.left > col + changeSize) {\n                                    let scaleX = 1 / imgItemParam.width;\n                                    imgItem.default.width = Math.round(imgItem.default.width * scaleX);\n                                    imgItem.crop.width = Math.round(imgItem.crop.width * scaleX);\n                                    imgItem.crop.offsetLeft = Math.round(imgItem.crop.offsetLeft * scaleX);\n                                    imgItem.default.left = col + changeSize - imgItem.crop.offsetLeft;\n                                } else if (imgItemParam.left + imgItemParam.width > col + changeSize) {\n                                    let scaleX = (col + changeSize - imgItemParam.left) / imgItemParam.width;\n                                    imgItem.default.width = Math.round(imgItem.default.width * scaleX);\n                                    imgItem.crop.width = Math.round(imgItem.crop.width * scaleX);\n                                    imgItem.crop.offsetLeft = Math.round(imgItem.crop.offsetLeft * scaleX);\n                                }\n                            }\n                        }\n                    } else if (type == '2') {\n                        if (imgItemParam.left >= col) {\n                            imgItem.default.left = imgItemParam.left + changeSize - imgItem.crop.offsetLeft;\n                        } else if (imgItemParam.left > col + changeSize) {\n                            imgItem.default.left = col + changeSize - imgItem.crop.offsetLeft;\n                        }\n                    }\n                }\n            }\n            return images;\n        },\n        ref: function () {\n            let _this = this;\n            let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            let images = _this.images;\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                Store.jfredo.push({\n                    'type': 'imageCtrl',\n                    'sheetIndex': Store.currentSheetIndex,\n                    'images': file.images == null ? null : $.extend(true, {}, file.images),\n                    'curImages': images\n                });\n            }\n            file.images = $.extend(true, {}, images);\n            server.saveParam('all', Store.currentSheetIndex, file.images, { 'k': 'images' });\n        }\n    };\n    return imageCtrl;\n});"]}