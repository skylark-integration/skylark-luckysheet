{"version":3,"sources":["controllers/protection.js"],"names":["define","Store","locale","m_constant","m_get","m_set","protection_methods","luckysheetsizeauto","dataVerificationCtrl","m_util","m_select","tooltip","modelHTML","getSheetIndex","setluckysheet_scroll_status","replaceHtml","transformRangeToAbsolute","openSelfModel","selectionCopyShow","isInitialProtection","isInitialProtectionAddRang","rangeItemListCache","isAddRangeItemState","updateRangeItemIndex","validationAuthority","updatingSheetFile","firstInputSheetProtectionPassword","inputRangeProtectionPassword","authorityItemArr","addRangeItem","item","_locale","local_protection","protection","locale_button","button","title","name","sqref","password","passwordTxt","length","rangeItemHasPassword","rangeItemTemplate","rangeItemDblclick","delete","update","$","append","initialProtectionRangeModal","file","id","addclass","allowRangeTitle","content","allowRangeAddTitle","allowRangeAddtitleDefault","allowRangeAddSqrf","selectCellRangeHolder","selectCellRange","allowRangeAddTitlePassword","enterPassword","allowRangeAddTitleHint","allowRangeAddTitleHintTitle","botton","insert","cancel","style","restoreProtectionConfig","aut","i","checkId","authorityValue","selectLockedCells","selectunLockedCells","prop","algorithmName","val","sheet","hintText","empty","allowRangeList","push","closeProtectionModal","hide","Object","assign","openProtectionModal","authorityItemHtml","protectionModalHtml","protectiontTitle","close","swichProtectionTip","enterHintTitle","authorityTitle","allowRangeAdd","confirm","validationTitle","validationTips","validationInputHint","initialProtectionRIghtBar","click","is","hint","config","authority","authorityData","saltValue","html","document","off","on","e","$rangeItem","target","closest","index","find","splice","remove","rangeText","alert","rangeItemErrorTitleNull","range","getRangeByTxt","checkRangePasswordUrl","$rangeitem","eq","$name","attr","rangeItemErrorRange","rangeItemErrorRangeNull","$validation","show","hasher","CryptoApi","getHasher","hmac","hash","checkPasswordWrongalert","checkPasswordNullalert","change","$selectLockedCells","$selectunLockedCells","selectLockedCellsChecked","txt","this","siblings","trim","rangeDialog","selectRange","s","r1","row","r2","c1","column","c2","visibledatarow","row_pre","col","visibledatacolumn","col_pre","left","width","top","height","left_move","width_move","top_move","height_move","row_focus","column_focus","parents","$input","inputValue","substr","initialEvent"],"mappings":"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","file":"../../controllers/protection.js","sourcesContent":["define([\n    '../store',\n    '../locale/locale',\n    '../widgets/constant',\n    '../methods/get',\n    '../methods/set',\n    '../methods/protection_methods',\n    '../widgets/resize',\n    '../widgets/dataVerificationCtrl',\n    '../utils/util',\n    '../widgets/select',\n    '../widgets/tooltip'\n], function (Store, locale, m_constant, m_get, m_set, protection_methods,luckysheetsizeauto, dataVerificationCtrl, m_util, m_select, tooltip) {\n    'use strict';\n    const {modelHTML} = m_constant;\n    const {getSheetIndex} = m_get;\n    const {setluckysheet_scroll_status} = m_set;\n    const {replaceHtml, transformRangeToAbsolute, openSelfModel} = m_util;\n    const {selectionCopyShow} = m_select;\n    let isInitialProtection = false, isInitialProtectionAddRang = false, rangeItemListCache = [], isAddRangeItemState = true, updateRangeItemIndex = null, validationAuthority = null, updatingSheetFile = null, firstInputSheetProtectionPassword = true;\n    let sqrefMapCache = {}, inputRangeProtectionPassword = {}, initialRangePasswordHtml = false;\n    const authorityItemArr = [\n        'selectLockedCells',\n        'selectunLockedCells',\n        'formatCells',\n        'formatColumns',\n        'formatRows',\n        'insertColumns',\n        'insertRows',\n        'insertHyperlinks',\n        'deleteColumns',\n        'deleteRows',\n        'sort',\n        'filter',\n        'usePivotTablereports',\n        'editObjects',\n        'editScenarios'\n    ];\n    function addRangeItem(item) {\n        const _locale = locale();\n        const local_protection = _locale.protection;\n        const locale_button = _locale.button;\n        let title = item.name, sqref = item.sqref, password = item.password;\n        let passwordTxt = '';\n        if (password != null && password.length > 0) {\n            passwordTxt = '<i class=\"icon iconfont luckysheet-iconfont-bianji2\" title=\"' + local_protection.rangeItemHasPassword + '\"></i>';\n        }\n        let rangeItemTemplate = `\n        <div class=\"luckysheet-protection-rangeItem\" title=\"${ local_protection.rangeItemDblclick }\">\n            <div class=\"luckysheet-protection-rangeItem-del\" title=\"${ locale_button.delete }\">\n                <i class=\"icon iconfont luckysheet-iconfont-shanchu\"></i>\n            </div>\n            <div class=\"luckysheet-protection-rangeItem-name\" title=\"${ title }\">\n                ${ title }${ passwordTxt }\n            </div>\n            <div class=\"luckysheet-protection-rangeItem-range\" title=\"${ sqref }\">\n                ${ sqref }\n            </div>\n            <div class=\"luckysheet-protection-rangeItem-update\" title=\"${ locale_button.update }\">\n                <i class=\"icon iconfont luckysheet-iconfont-bianji\"></i>\n            </div>\n        </div>\n    `;\n        $('#luckysheet-protection-rangeItem-container').append(rangeItemTemplate);\n    }\n    function initialEvent(file) {\n        const _locale = locale();\n        const local_protection = _locale.protection;\n        const locale_button = _locale.button;    //confirm protection\n        //confirm protection\n        $('#luckysheet-slider-protection-ok').click(function () {\n            let password = $('#protection-password').val();\n            let sheet = $('#protection-swichProtectionState').is(':checked');\n            let hint = $('#protection-hint').val();\n            let file = updatingSheetFile, aut = {};\n            if (file != null && file.config != null && file.config.authority != null) {\n                aut = file.config.authority;\n            }\n            let authorityData = {};\n            let algorithmName = 'None';\n            if (password != '\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022') {\n                authorityData.password = password;\n                authorityData.algorithmName = 'None';\n                authorityData.saltValue = null;\n            } else if (aut != null) {\n                authorityData.algorithmName = aut.algorithmName;\n                authorityData.saltValue = aut.saltValue;\n                authorityData.password = aut.password;\n            } else {\n                authorityData.algorithmName = 'None';\n                authorityData.saltValue = null;\n                authorityData.password = '';\n            }\n            authorityData.hintText = hint;\n            authorityData.sheet = sheet == true ? 1 : 0;\n            for (let i = 0; i < authorityItemArr.length; i++) {\n                let name = authorityItemArr[i];\n                let checkId = 'luckysheet-protection-check-' + name;\n                let authorityValue = $('#' + checkId).is(':checked');\n                authorityData[name] = authorityValue == true ? 1 : 0;\n            }\n            authorityData.allowRangeList = rangeItemListCache;\n            rangeItemListCache = [];\n            firstInputSheetProtectionPassword = true;\n            if (file.config == null) {\n                file.config = {};\n            }\n            file.config.authority = authorityData;\n            inputRangeProtectionPassword = {};\n            closeProtectionModal();\n        });    //cancel protection\n        //cancel protection\n        $('#luckysheet-slider-protection-cancel, #luckysheet-modal-dialog-protection-close').click(function () {\n            closeProtectionModal();\n        });    //Add allow edit range\n        //Add allow edit range\n        $('#luckysheet-slider-protection-addRange').click(function () {\n            initialProtectionRangeModal();\n            isAddRangeItemState = true;\n            $('#luckysheet-protection-rangeItem-confirm').html(locale_button.insert);\n            openSelfModel('luckysheet-protection-rangeItem-dialog');\n            $('#protection-allowRangeAdd-title').val('Default' + rangeItemListCache.length);\n            $('#protection-allowRangeAdd-range input').val('');\n            $('#protection-allowRangeAdd-password').val('');\n            $('#protection-allowRangeAdd-hint').val('');\n        });    //update allow edit range\n        //update allow edit range\n        $(document).off('click.luckysheetProtection.rangeItemUpdate').on('click.luckysheetProtection.rangeItemUpdate', '#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-update', function (e) {\n            initialProtectionRangeModal();\n            isAddRangeItemState = false;\n            $('#luckysheet-protection-rangeItem-confirm').html(locale_button.update);\n            openSelfModel('luckysheet-protection-rangeItem-dialog');\n            let $rangeItem = $(e.target).closest('.luckysheet-protection-rangeItem');\n            let $rangeItemContainer = $('#luckysheet-protection-rangeItem-container');\n            let index = $rangeItemContainer.find('> div.luckysheet-protection-rangeItem').index($rangeItem);\n            let item = rangeItemListCache[index];\n            updateRangeItemIndex = index;\n            $('#protection-allowRangeAdd-title').val(item.name);\n            $('#protection-allowRangeAdd-range input').val(item.sqref);\n            if (item.algorithmName == 'None') {\n                $('#protection-allowRangeAdd-password').val(item.password);\n            } else {\n                $('#protection-allowRangeAdd-password').val('\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022');\n            }\n            $('#protection-allowRangeAdd-hint').val(item.hintText);\n        });    //delete allow edit range\n        //delete allow edit range\n        $(document).off('click.luckysheetProtection.rangeItemDelete').on('click.luckysheetProtection.rangeItemDelete', '#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-del', function (e) {\n            let $rangeItem = $(e.target).closest('.luckysheet-protection-rangeItem');\n            let $rangeItemContainer = $('#luckysheet-protection-rangeItem-container');\n            let index = $rangeItemContainer.find('> div.luckysheet-protection-rangeItem').index($rangeItem);\n            let item = rangeItemListCache[index];\n            rangeItemListCache.splice(index, 1);\n            $rangeItem.remove();\n        });    //confirm allow edit range\n        //confirm allow edit range\n        $(document).off('click.luckysheetProtection.rangeItemConfirm').on('click.luckysheetProtection.rangeItemConfirm', '#luckysheet-protection-rangeItem-confirm', function () {\n            let name = $('#protection-allowRangeAdd-title').val(), rangeText = $('#protection-allowRangeAdd-range input').val(), password = $('#protection-allowRangeAdd-password').val(), hint = $('#protection-allowRangeAdd-hint').val();\n            if (name.length == 0) {\n                alert(local_protection.rangeItemErrorTitleNull);\n                return;\n            }\n            let range = dataVerificationCtrl.getRangeByTxt(rangeText);\n            if (rangeText.length == 0) {\n                alert(local_protection.rangeItemErrorRangeNull);\n                return;\n            }\n            if (range.length == 0) {\n                alert(local_protection.rangeItemErrorRange);\n                return;\n            }\n            rangeText = transformRangeToAbsolute(rangeText);\n            if (isAddRangeItemState) {\n                let item = {\n                    name: name,\n                    password: password,\n                    hintText: hint,\n                    algorithmName: 'None',\n                    //MD2,MD4,MD5,RIPEMD-128,RIPEMD-160,SHA-1,SHA-256,SHA-384,SHA-512,WHIRLPOOL\n                    saltValue: null,\n                    checkRangePasswordUrl: null,\n                    sqref: rangeText\n                };\n                addRangeItem(item);\n                rangeItemListCache.push(item);\n            } else {\n                let index = updateRangeItemIndex;\n                let item = rangeItemListCache[index];\n                item.name = name;\n                item.sqref = rangeText;\n                item.hintText = hint;\n                if (password != '\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022') {\n                    item.password = password;\n                    item.algorithmName = 'None';\n                }\n                let $rangeItemContainer = $('#luckysheet-protection-rangeItem-container');\n                let $rangeitem = $rangeItemContainer.find('> div.luckysheet-protection-rangeItem').eq(index);\n                let $name = $rangeitem.find('.luckysheet-protection-rangeItem-name');\n                let passwordTxt = '';\n                if (password != null && password.length > 0) {\n                    passwordTxt = '<i class=\"icon iconfont luckysheet-iconfont-bianji2\" title=\"' + local_protection.rangeItemHasPassword + '\"></i>';\n                }\n                $name.html(name + passwordTxt).attr('title', name);\n                let $range = $rangeitem.find('.luckysheet-protection-rangeItem-range');\n                $range.html(rangeText).attr('title', rangeText);\n            }\n            $('#luckysheet-protection-rangeItem-dialog').hide();\n            $('#luckysheet-modal-dialog-mask').hide();\n        });    //sheet validation check passWord\n        //sheet validation check passWord\n        $(document).off('click.luckysheetProtection.validationConfirm').on('click.luckysheetProtection.validationConfirm', '#luckysheet-protection-sheet-validation-confirm', function (e) {\n            let $validation = $('#luckysheet-protection-sheet-validation');\n            let aut = validationAuthority;\n            if (aut == null) {\n                restoreProtectionConfig(validationAuthority);\n                $validation.hide();\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-modal-dialog-slider-protection').show();\n                luckysheetsizeauto();\n                return;\n            }\n            let $input = $validation.find('input');\n            let password = $input.val();\n            if (password == null || password.length == 0) {\n                alert(local_protection.checkPasswordNullalert);\n                return;\n            }\n            if (aut.algorithmName != null && aut.algorithmName != 'None') {\n                if (aut.saltValue != null && aut.saltValue.length > 0) {\n                    var hasher = CryptoApi.getHasher(aut.algorithmName);\n                    password = CryptoApi.hmac(aut.saltValue, password, hasher);\n                } else {\n                    password = CryptoApi.hash(aut.algorithmName, password);\n                }\n            }\n            if (password == aut.password) {\n                restoreProtectionConfig(validationAuthority);\n                $validation.hide();\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-modal-dialog-slider-protection').show();\n                luckysheetsizeauto();\n                firstInputSheetProtectionPassword = false;\n            } else {\n                alert(local_protection.checkPasswordWrongalert);\n            }\n        });\n        $('#luckysheet-protection-check-selectLockedCells').change(function () {\n            let $selectLockedCells = $('#luckysheet-protection-check-selectLockedCells'), $selectunLockedCells = $('#luckysheet-protection-check-selectunLockedCells');\n            let selectLockedCellsChecked = $selectLockedCells.is(':checked'), selectunLockedCellsChecked = $selectunLockedCells.is(':checked');\n            if (selectLockedCellsChecked) {\n                $selectunLockedCells.prop('checked', true);\n            }\n        });\n        $('#luckysheet-protection-check-selectunLockedCells').change(function () {\n            let $selectLockedCells = $('#luckysheet-protection-check-selectLockedCells'), $selectunLockedCells = $('#luckysheet-protection-check-selectunLockedCells');\n            let selectLockedCellsChecked = $selectLockedCells.is(':checked'), selectunLockedCellsChecked = $selectunLockedCells.is(':checked');\n            if (!selectunLockedCellsChecked) {\n                $selectLockedCells.prop('checked', false);\n            }\n        });    //Cell range select controll\n        //Cell range select controll\n        $(document).off('click.luckysheetProtection.dvRange').on('click.luckysheetProtection.dvRange', '#protection-allowRangeAdd-range .fa-table', function (e) {\n            $('#luckysheet-protection-rangeItem-dialog').hide();\n            let dataSource = '0';\n            let txt = $(this).siblings('input').val().trim();\n            dataVerificationCtrl.rangeDialog(dataSource, txt);\n            dataVerificationCtrl.selectRange = [];\n            let range = dataVerificationCtrl.getRangeByTxt(txt);\n            if (range.length > 0) {\n                for (let s = 0; s < range.length; s++) {\n                    let r1 = range[s].row[0], r2 = range[s].row[1];\n                    let c1 = range[s].column[0], c2 = range[s].column[1];\n                    let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                    let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                    dataVerificationCtrl.selectRange.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            r1,\n                            r2\n                        ],\n                        'column': [\n                            c1,\n                            c2\n                        ],\n                        'row_focus': r1,\n                        'column_focus': c1\n                    });\n                }\n            }\n            selectionCopyShow(dataVerificationCtrl.selectRange);\n        });\n        $(document).off('click.luckysheetProtection.dvRange2').on('click.luckysheetProtection.dvRange2', '#luckysheet-protection-rangeItem-dialog .show-box-item-dropdown .range .fa-table', function (e) {\n            $('#luckysheet-protection-rangeItem-dialog').hide();\n            let dataSource = '1';\n            let txt = $(this).siblings('input').val().trim();\n            dataVerificationCtrl.rangeDialog(dataSource, txt);\n            dataVerificationCtrl.selectRange = [];\n            let range = dataVerificationCtrl.getRangeByTxt(txt);\n            if (range.length > 0) {\n                for (let s = 0; s < range.length; s++) {\n                    let r1 = range[s].row[0], r2 = range[s].row[1];\n                    let c1 = range[s].column[0], c2 = range[s].column[1];\n                    let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                    let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                    dataVerificationCtrl.selectRange.push({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': row_pre,\n                        'height': row - row_pre - 1,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            r1,\n                            r2\n                        ],\n                        'column': [\n                            c1,\n                            c2\n                        ],\n                        'row_focus': r1,\n                        'column_focus': c1\n                    });\n                }\n            }\n            selectionCopyShow(dataVerificationCtrl.selectRange);\n        });\n        $(document).off('click.luckysheetProtection.dvRangeConfirm').on('click.luckysheetProtection.dvRangeConfirm', '#luckysheet-dataVerificationRange-dialog-confirm', function (e) {\n            let txt = $(this).parents('#luckysheet-dataVerificationRange-dialog').find('input').val();\n            let $input = $('#protection-allowRangeAdd-range input'), inputValue = $input.val();\n            if (inputValue.substr(inputValue.length - 1, 1) == ',') {\n                $input.val(inputValue + txt);\n            } else {\n                $input.val(txt);\n            }\n            $('#luckysheet-dataVerificationRange-dialog').hide();\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-protection-rangeItem-dialog').show();\n            let range = [];\n            selectionCopyShow(range);\n        });\n        $(document).off('click.luckysheetProtection.dvRangeClose').on('click.dvRangeClose', '#luckysheet-dataVerificationRange-dialog-close', function (e) {\n            $('#luckysheet-dataVerificationRange-dialog').hide();\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-protection-rangeItem-dialog').show();\n            let range = [];\n            selectionCopyShow(range);\n        });\n        $(document).on('click.luckysheetProtection.luckysheetProtection', '#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close', function (e) {\n            $('#luckysheet-dataVerificationRange-dialog').hide();\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-protection-rangeItem-dialog').show();\n            let range = [];\n            selectionCopyShow(range);\n        });\n    }    //protect range config\n    //protect range config\n    function initialProtectionRangeModal(file) {\n        if (isInitialProtectionAddRang) {\n            return;\n        }\n        isInitialProtectionAddRang = true;\n        let _locale = locale();\n        let local_protection = _locale.protection;\n        const locale_button = _locale.button;\n        $('body').append(replaceHtml(modelHTML, {\n            'id': 'luckysheet-protection-rangeItem-dialog',\n            'addclass': 'luckysheet-protection-rangeItem-dialog',\n            'title': local_protection.allowRangeTitle,\n            'content': `\n            <div class=\"luckysheet-protection-rangeItem-content\">\n                <div class=\"luckysheet-slider-protection-row\">\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-3x\">\n                        ${ local_protection.allowRangeAddTitle }\n                    </div>\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-7x\" style=\"left:30%\">\n                        <input class=\"luckysheet-protection-rangeItemiInput\" id=\"protection-allowRangeAdd-title\"  placeHolder=\"${ local_protection.allowRangeAddtitleDefault }\">\n                    </div>\n                </div>\n                <div class=\"luckysheet-slider-protection-row\">\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-3x\">\n                        ${ local_protection.allowRangeAddSqrf }\n                    </div>\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-7x\" style=\"left:30%\">\n                        <div id=\"protection-allowRangeAdd-range\" class=\"range\">\n                            <input class=\"formulaInputFocus\" spellcheck=\"false\" placeHolder=\"${ local_protection.selectCellRangeHolder }\">\n                            <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ local_protection.selectCellRange }\"></i>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"luckysheet-slider-protection-row\">\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-3x\">\n                        ${ local_protection.allowRangeAddTitlePassword }\n                    </div>\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-7x\" style=\"left:30%\">\n                        <input class=\"luckysheet-protection-rangeItemiInput\" id=\"protection-allowRangeAdd-password\"  placeHolder=\"${ local_protection.enterPassword }\">\n                    </div>\n                </div>\n                <div class=\"luckysheet-slider-protection-row\">\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-3x\">\n                        ${ local_protection.allowRangeAddTitleHint }\n                    </div>\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-7x\" style=\"left:30%\">\n                        <textarea class=\"luckysheet-protection-rangeItemTextarea\" id=\"protection-allowRangeAdd-hint\"  placeHolder=\"${ local_protection.allowRangeAddTitleHintTitle }\"></textarea>\n                    </div>\n                </div>\n            </div>\n        `,\n            'botton': `<button id=\"luckysheet-protection-rangeItem-confirm\" class=\"btn btn-primary\">${ locale_button.insert }</button>\n                    <button class=\"btn btn-default luckysheet-model-close-btn\">${ locale_button.cancel }</button>`,\n            'style': 'z-index:100003'\n        }));\n    }    //Protect sheet initial\n    //Protect sheet initial\n    function initialProtectionRIghtBar(file) {\n        const _locale = locale();\n        const local_protection = _locale.protection;\n        const locale_button = _locale.button;\n        let authorityItemHtml = '';\n        for (let i = 0; i < authorityItemArr.length; i++) {\n            let name = authorityItemArr[i];\n            authorityItemHtml += `\n            <div class=\"luckysheet-slider-protection-row\" style=\"height:18px;\">\n                <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-10x\">\n                <label for=\"luckysheet-protection-check-${ name }\"><input id=\"luckysheet-protection-check-${ name }\" name=\"luckysheet-protection-check-${ name }\" type=\"checkbox\">${ local_protection[name] }</label>\n                </div>\n            </div>\n        `;\n        }\n        const protectionModalHtml = `\n    <div id=\"luckysheet-modal-dialog-slider-protection\" class=\"luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-pivot\" style=\"display:none;\">\n        <div class=\"luckysheet-modal-dialog-slider-title\"> <span>${ local_protection.protectiontTitle }</span> <span id=\"luckysheet-modal-dialog-protection-close\" title=\"${ locale_button.close }\"><i class=\"fa fa-times\" aria-hidden=\"true\"></i></span> </div>\n        <div class=\"luckysheet-modal-dialog-slider-content\">\n            <div class=\"luckysheet-slider-protection-config\" style=\"top:10px;height:115px\">\n                <div class=\"luckysheet-slider-protection-row\">\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-10x\">\n                    <label for=\"protection-swichProtectionState\"><input id=\"protection-swichProtectionState\" name=\"protection-swichProtectionState\" type=\"checkbox\">${ local_protection.swichProtectionTip }</label>\n                    </div>\n                </div>\n                <div class=\"luckysheet-slider-protection-row\" style=\"height:23px;\">\n                    <div class=\"luckysheet-slider-protection-column\" style=\"width:98%;\">\n                        <input class=\"luckysheet-protection-input\" id=\"protection-password\"  placeHolder=\"${ local_protection.enterPassword }\">\n                    </div>\n                </div>\n                <div class=\"luckysheet-slider-protection-row\" style=\"height:47px;margin-top:4px;\">\n                    <div class=\"luckysheet-slider-protection-column\" style=\"width:98%;\">\n                        <textarea class=\"luckysheet-protection-textarea\" id=\"protection-hint\"  placeHolder=\"${ local_protection.enterHintTitle }\"></textarea>\n                    </div>\n                </div>\n            </div>\n            <div class=\"luckysheet-slider-protection-config\" style=\"top:130px;height:290px;border-top:1px solid #c5c5c5\">\n                <div class=\"luckysheet-slider-protection-row\" style=\"height:20px;\">\n                    ${ local_protection.authorityTitle }\n                </div>\n                ${ authorityItemHtml }\n            </div>\n            <div class=\"luckysheet-slider-protection-config\" style=\"top:440px;bottom:45px;border-top:1px solid #c5c5c5\">\n                <div class=\"luckysheet-slider-protection-row\" style=\"height:25px;\">\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-7x\" style=\"left:0px;line-height: 25px;\">\n                        ${ local_protection.allowRangeTitle }\n                    </div>\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-3x\" style=\"left:70%;\">\n                        <div class=\"luckysheet-slider-protection-ok luckysheet-slider-protection-addRange\" id=\"luckysheet-slider-protection-addRange\">\n                            ${ local_protection.allowRangeAdd }\n                        </div>\n                    </div>\n                </div>\n\n                <div id=\"luckysheet-protection-rangeItem-container\" class=\"luckysheet-slider-protection-row\" style=\"top:25px;bottom:0px;position:absolute\">\n                   \n                </div>\n            </div>\n            <div class=\"luckysheet-slider-protection-config\" style=\"bottom:0px;height:45px\">\n                <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-5x\" style=\"left:0px;\">\n                    <div class=\"luckysheet-slider-protection-ok\" id=\"luckysheet-slider-protection-ok\">\n                        ${ locale_button.confirm }\n                    </div>\n                </div>\n                <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-5x\" style=\"left:50%;\">\n                    <div class=\"luckysheet-slider-protection-cancel\" id=\"luckysheet-slider-protection-cancel\">\n                        ${ locale_button.cancel }\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    `;\n        $('body').append(protectionModalHtml);    //Password input initial for sheet Protection\n        //Password input initial for sheet Protection\n        $('body').append(replaceHtml(modelHTML, {\n            'id': 'luckysheet-protection-sheet-validation',\n            'addclass': 'luckysheet-protection-sheet-validation',\n            'title': local_protection.validationTitle,\n            'content': `\n            <div class=\"luckysheet-slider-protection-row\">\n                <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-10x\">\n                    ${ local_protection.validationTips }\n                </div>\n            </div>\n            <div class=\"luckysheet-slider-protection-row\" style=\"margin-top:20px\">\n                <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-10x\">\n                    <input type=\"password\" class=\"luckysheet-protection-rangeItemiInput\" placeHolder=\"${ local_protection.validationInputHint }\">\n                </div>\n            </div>\n        `,\n            'botton': `<button id=\"luckysheet-protection-sheet-validation-confirm\" class=\"btn btn-primary\">${ locale_button.confirm }</button>\n                    <button class=\"btn btn-default luckysheet-model-close-btn\">${ locale_button.cancel }</button>`,\n            'style': 'z-index:100003'\n        }));\n    }\n    function restoreProtectionConfig(aut) {\n        if (aut == null) {\n            aut = {};\n        }\n        for (let i = 0; i < authorityItemArr.length; i++) {\n            let name = authorityItemArr[i];\n            let checkId = 'luckysheet-protection-check-' + name;\n            let authorityValue = aut[name];\n            if (authorityValue == null) {\n                authorityValue = 0;\n            }\n            if (authorityValue == null && name in {\n                    selectLockedCells: 1,\n                    selectunLockedCells: 1\n                }) {\n                authorityValue = 1;\n            }\n            $('#' + checkId).prop('checked', authorityValue == 1 ? true : false);\n        }\n        if (aut.password != null && aut.password.length > 0) {\n            if (aut.algorithmName == 'None' || aut.algorithmName == null) {\n                $('#protection-password').val(aut.password);\n            } else {\n                $('#protection-password').val('\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022');\n            }\n        } else {\n            $('#protection-password').val('');\n        }\n        let sheet = aut.sheet;\n        if (aut.sheet == null) {\n            sheet = 0;\n        }\n        $('#protection-swichProtectionState').prop('checked', sheet == 1 ? true : false);\n        let hintText = aut.hintText;\n        if (hintText == null) {\n            hintText = '';\n        }\n        $('#protection-hint').val(hintText);\n        rangeItemListCache = [];\n        $('#luckysheet-protection-rangeItem-container').empty();\n        let allowRangeList = aut.allowRangeList;\n        if (allowRangeList != null && allowRangeList.length > 0) {\n            for (let i = 0; i < allowRangeList.length; i++) {\n                let item = allowRangeList[i];\n                addRangeItem(item);\n                rangeItemListCache.push(item);\n            }\n        }\n    }\n    function openProtectionModal(file) {\n        if (!isInitialProtection) {\n            initialProtectionRIghtBar(file);\n            initialEvent(file);\n            isInitialProtection = true;\n        }\n        updatingSheetFile = file;\n        if (file != null && file.config != null && file.config.authority != null) {\n            let aut = file.config.authority;\n            if (firstInputSheetProtectionPassword && aut.sheet == 1 && aut.password != null && aut.password.length > 0) {\n                validationAuthority = aut;\n                $('#luckysheet-protection-sheet-validation input').val('');\n                openSelfModel('luckysheet-protection-sheet-validation');\n                return;\n            } else {\n                //retore protection config\n                restoreProtectionConfig(aut);\n            }\n        } else {\n            //protection initial config\n            $('#luckysheet-protection-check-selectLockedCells').prop('checked', true);\n            $('#luckysheet-protection-check-selectunLockedCells').prop('checked', true);\n        }\n        $('#luckysheet-modal-dialog-slider-protection').show();\n        luckysheetsizeauto();\n    }\n    function closeProtectionModal() {\n        $('#luckysheet-protection-rangeItem-dialog').hide();\n        $('#luckysheet-modal-dialog-slider-protection').hide();\n        luckysheetsizeauto();\n    }\n    function checkProtectionLockedSqref(r, c, aut, local_protection, isOpenAlert = true) {\n        let isPass = false;\n        let rangeAut = aut.allowRangeList;\n        if (rangeAut != null && rangeAut.length > 0) {\n            let isExists = false;\n            for (let i = 0; i < rangeAut.length; i++) {\n                let ra = rangeAut[i];\n                let sqref = ra.sqref;\n                let range = dataVerificationCtrl.getRangeByTxt(sqref);\n                if (range.length > 0) {\n                    for (let s = 0; s < range.length; s++) {\n                        let r1 = range[s].row[0], r2 = range[s].row[1];\n                        let c1 = range[s].column[0], c2 = range[s].column[1];\n                        if (r >= r1 && r <= r2 && c >= c1 && c <= c2) {\n                            isExists = true;\n                            break;\n                        }\n                    }\n                }\n                if (isExists) {\n                    let password = ra.password;\n                    if (password != null && password.length > 0 && !(sqref in inputRangeProtectionPassword)) {\n                        if (isOpenAlert) {\n                            openRangePasswordModal(ra);\n                            $('#luckysheet-selection-copy .luckysheet-selection-copy').hide();\n                        }\n                        return false;\n                    } else {\n                        isPass = true;\n                    }\n                    break;\n                }\n            }\n        }\n        if (!isPass && isOpenAlert) {\n            let ht;\n            if (aut.hintText != null && aut.hintText.length > 0) {\n                ht = aut.hintText;\n            } else {\n                ht = local_protection.defaultSheetHintText;\n            }\n            tooltip.info('', ht);\n            $('#luckysheet-selection-copy .luckysheet-selection-copy').hide();\n        }\n        return isPass;\n    }\n    function openRangePasswordModal(rangeAut) {\n        const _locale = locale();\n        const local_protection = _locale.protection;\n        const locale_button = _locale.button;\n        if (!initialRangePasswordHtml) {\n            //Password input initial for range\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-protection-range-validation',\n                'addclass': 'luckysheet-protection-sheet-validation',\n                'title': local_protection.validationTitle,\n                'content': `\n                <div class=\"luckysheet-slider-protection-row\">\n                    <div id=\"luckysheet-protection-range-validation-hint\" class=\"luckysheet-slider-protection-column luckysheet-protection-column-10x\">\n                        \n                    </div>\n                </div>\n                <div class=\"luckysheet-slider-protection-row\" style=\"margin-top:20px\">\n                    <div class=\"luckysheet-slider-protection-column luckysheet-protection-column-10x\">\n                        <input type=\"password\" class=\"luckysheet-protection-rangeItemiInput\" placeHolder=\"${ local_protection.validationInputHint }\">\n                    </div>\n                </div>\n            `,\n                'botton': `<button id=\"luckysheet-protection-range-validation-confirm\" class=\"btn btn-primary\">${ locale_button.confirm }</button>\n                        <button class=\"btn btn-default luckysheet-model-close-btn\">${ locale_button.cancel }</button>`,\n                'style': 'z-index:100003'\n            }));\n        }\n        initialRangePasswordHtml = true;\n        openSelfModel('luckysheet-protection-range-validation');\n        let $hint = $('#luckysheet-protection-range-validation-hint');\n        if (rangeAut.hintText != null && rangeAut.hintText.length > 0) {\n            $hint.html(rangeAut.hintText);\n        } else {\n            $hint.html(local_protection.defaultRangeHintText);\n        }\n        let $rangeV = $('#luckysheet-protection-range-validation');\n        let $input = $rangeV.find('input');\n        $input.val('');\n        $('#luckysheet-protection-range-validation-confirm').off('click').on('click', function () {\n            let password = $input.val();\n            if (password == null || password.length == 0) {\n                alert(local_protection.checkPasswordNullalert);\n                return;\n            }\n            if (rangeAut.algorithmName != null && rangeAut.algorithmName != 'None') {\n                // password = CryptoApi.hash(rangeAut.algorithmName, password);\n                if (rangeAut.saltValue != null && rangeAut.saltValue.length > 0) {\n                    var hasher = CryptoApi.getHasher(rangeAut.algorithmName);\n                    password = CryptoApi.hmac(rangeAut.saltValue, password, hasher);\n                } else {\n                    password = CryptoApi.hash(rangeAut.algorithmName, password);\n                }\n            }\n            if (password == rangeAut.password) {\n                inputRangeProtectionPassword[rangeAut.sqref] = 1;\n                $rangeV.hide();\n                $('#luckysheet-modal-dialog-mask').hide();\n                alert(local_protection.checkPasswordSucceedalert);\n            } else {\n                alert(local_protection.checkPasswordWrongalert);\n            }\n        });\n    }    \n\n    return Object.assign({\n        openProtectionModal: openProtectionModal,\n        closeProtectionModal: closeProtectionModal,\n    },protection_methods);\n});"]}