{"version":3,"sources":["controllers/locationCell.js"],"names":["define","m_util","m_get","m_validate","tooltip","m_constant","m_select","conditionformat","Store","locale","replaceHtml","getSheetIndex","isRealNull","isEditMode","modelHTML","selectHightlightShow","createDialog","$","show","remove","_locale","locale_location","findAndReplace","locale_button","button","content","locationConstant","locationDate","locationDigital","locationString","locationBool","locationFormula","locationError","locationNull","locationCondition","locationRowSpan","locationColumnSpan","append","id","addclass","title","location","botton","confirm","cancel","style","$t","find","css","end","myh","outerHeight","myw","outerWidth","winw","window","width","winh","height","scrollLeft","document","scrollTop","left","top","init","_this","this","on","e","prop","siblings","removeAttr","off","hide","$radio","attr","value","range","$checkbox","length","arr","i","hasClass","push","join","luckysheet_select_save","row","column","flowdata","extend","apply","alert","locationTiplessTwoRow","info","locationTiplessTwoColumn","type","rangeArr","minR","maxR","minC","maxC","cellSave","s","st_r","ed_r","st_c","ed_c","r","c","cell","mc","v","f","ct","indexOf","t","getRangeArr","index","currentSheetIndex","ruleArr","luckysheetfile","data","locationTipNotFindCell","computeMap","compute","Object","keys","winH","winW","r1","r2","c1","c2","visibledatarow","row_pre","col","visibledatacolumn","col_pre","[object Object]","stack_str","stack_edr","stack_stc","stack_edc","rs","cs","deleteCellInSave"],"mappings":"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","file":"../../controllers/locationCell.js","sourcesContent":["define([\n    '../utils/util',\n    '../methods/get',\n    '../global/validate',\n    '../global/tooltip',\n    './constant',\n    './select',\n    './conditionformat',\n    '../store',\n    '../locale/locale'\n], function (m_util, m_get, m_validate, tooltip, m_constant, m_select, conditionformat, Store, locale) {\n    'use strict';\n    const {replaceHtml} = m_util;\n    const {getSheetIndex} = m_get;\n    const {isRealNull, isEditMode} = m_validate;\n    const {modelHTML} = m_constant;\n    const {selectHightlightShow} = m_select;\n    //定位\n    const luckysheetLocationCell = {\n        createDialog: function () {\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-locationCell-dialog').remove();\n            const _locale = locale();\n            const locale_location = _locale.findAndReplace;\n            const locale_button = _locale.button;\n            let content = '<div class=\"listbox\">' + '<div class=\"listItem\">' + '<input type=\"radio\" name=\"locationType\" checked=\"checked\" id=\"locationConstant\">' + '<label for=\"locationConstant\">' + locale_location.locationConstant + '</label>' + '<div class=\"subbox\">' + '<div class=\"subItem\">' + '<input type=\"checkbox\" checked=\"checked\" class=\"date\" id=\"locationConstantDate\">' + '<label for=\"locationConstantDate\">' + locale_location.locationDate + '</label>' + '</div>' + '<div class=\"subItem\">' + '<input type=\"checkbox\" checked=\"checked\" class=\"number\" id=\"locationConstantNumber\">' + '<label for=\"locationConstantNumber\">' + locale_location.locationDigital + '</label>' + '</div>' + '<div class=\"subItem\">' + '<input type=\"checkbox\" checked=\"checked\" class=\"string\" id=\"locationConstantString\">' + '<label for=\"locationConstantString\">' + locale_location.locationString + '</label>' + '</div>' + '<div class=\"subItem\">' + '<input type=\"checkbox\" checked=\"checked\" class=\"boolean\" id=\"locationConstantBoolean\">' + '<label for=\"locationConstantBoolean\">' + locale_location.locationBool + '</label>' + '</div>' + '<div class=\"subItem\">' + '<input type=\"checkbox\" checked=\"checked\" class=\"error\" id=\"locationConstantError\">' + '<label for=\"locationConstantError\">' + locale_location.locationBool + '</label>' + '</div>' + '</div>' + '</div>' + '<div class=\"listItem\">' + '<input type=\"radio\" name=\"locationType\" id=\"locationFormula\">' + '<label for=\"locationFormula\">' + locale_location.locationFormula + '</label>' + '<div class=\"subbox\">' + '<div class=\"subItem\">' + '<input type=\"checkbox\" checked=\"checked\" class=\"date\" id=\"locationFormulaDate\" disabled=\"true\">' + '<label for=\"locationFormulaDate\" style=\"color: #666\">' + locale_location.locationDate + '</label>' + '</div>' + '<div class=\"subItem\">' + '<input type=\"checkbox\" checked=\"checked\" class=\"number\" id=\"locationFormulaNumber\" disabled=\"true\">' + '<label for=\"locationFormulaNumber\" style=\"color: #666\">' + locale_location.locationDigital + '</label>' + '</div>' + '<div class=\"subItem\">' + '<input type=\"checkbox\" checked=\"checked\" class=\"string\" id=\"locationFormulaString\" disabled=\"true\">' + '<label for=\"locationFormulaString\" style=\"color: #666\">' + locale_location.locationString + '</label>' + '</div>' + '<div class=\"subItem\">' + '<input type=\"checkbox\" checked=\"checked\" class=\"boolean\" id=\"locationFormulaBoolean\" disabled=\"true\">' + '<label for=\"locationFormulaBoolean\" style=\"color: #666\">' + locale_location.locationBool + '</label>' + '</div>' + '<div class=\"subItem\">' + '<input type=\"checkbox\" checked=\"checked\" class=\"error\" id=\"locationFormulaError\" disabled=\"true\">' + '<label for=\"locationFormulaError\" style=\"color: #666\">' + locale_location.locationError + '</label>' + '</div>' + '</div>' + '</div>' + '<div class=\"listItem\">' + '<input type=\"radio\" name=\"locationType\" id=\"locationNull\">' + '<label for=\"locationNull\">' + locale_location.locationNull + '</label>' + '</div>' + '<div class=\"listItem\">' + '<input type=\"radio\" name=\"locationType\" id=\"locationCF\">' + '<label for=\"locationCF\">' + locale_location.locationCondition + '</label>' + '</div>' + '<div class=\"listItem\">' + '<input type=\"radio\" name=\"locationType\" id=\"locationStepRow\">' + '<label for=\"locationStepRow\">' + locale_location.locationRowSpan + '</label>' + '</div>' + '<div class=\"listItem\">' + '<input type=\"radio\" name=\"locationType\" id=\"locationStepColumn\">' + '<label for=\"locationStepColumn\">' + locale_location.locationColumnSpan + '</label>' + '</div>' + '</div>';\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-locationCell-dialog',\n                'addclass': 'luckysheet-locationCell-dialog',\n                'title': locale_location.location,\n                'content': content,\n                'botton': '<button id=\"luckysheet-locationCell-dialog-confirm\" class=\"btn btn-primary\">' + locale_button.confirm + '</button><button class=\"btn btn-default luckysheet-model-close-btn\">' + locale_button.cancel + '</button>',\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-locationCell-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 400).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-locationCell-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n        },\n        init: function () {\n            let _this = this;\n            const locale_location = locale().findAndReplace;\n            $(document).on('click', '#luckysheet-locationCell-dialog .listItem input:radio', function (e) {\n                $('#luckysheet-locationCell-dialog .listItem input:checkbox').prop('disabled', true);\n                $('#luckysheet-locationCell-dialog .listItem .subbox label').css('color', '#666');\n                $(this).siblings('.subbox').find('input:checkbox').removeAttr('disabled');\n                $(this).siblings('.subbox').find('label').css('color', '#000');\n            });\n            $(document).off('click.locationCellConfirm').on('click.locationCellConfirm', '#luckysheet-locationCell-dialog #luckysheet-locationCell-dialog-confirm', function () {\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-locationCell-dialog').hide();\n                let $radio = $('#luckysheet-locationCell-dialog .listItem input:radio:checked');\n                let id = $radio.attr('id');\n                if (id == 'locationConstant' || id == 'locationFormula') {\n                    let $checkbox = $radio.siblings('.subbox').find('input:checkbox:checked');\n                    let value;\n                    if ($checkbox.length == 0) {\n                        return;\n                    } else if ($checkbox.length == 5) {\n                        value = 'all';\n                    } else {\n                        let arr = [];\n                        for (let i = 0; i < $checkbox.length; i++) {\n                            if ($($checkbox[i]).hasClass('date')) {\n                                arr.push('d');\n                            } else if ($($checkbox[i]).hasClass('number')) {\n                                arr.push('n');\n                            } else if ($($checkbox[i]).hasClass('string')) {\n                                arr.push('s,g');\n                            } else if ($($checkbox[i]).hasClass('boolean')) {\n                                arr.push('b');\n                            } else if ($($checkbox[i]).hasClass('error')) {\n                                arr.push('e');\n                            }\n                        }\n                        value = arr.join(',');\n                    }\n                    let range;\n                    if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1] && Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                        //单个单元格\n                        range = [{\n                                'row': [\n                                    0,\n                                    Store.flowdata.length - 1\n                                ],\n                                'column': [\n                                    0,\n                                    Store.flowdata[0].length - 1\n                                ]\n                            }];\n                    } else {\n                        range = $.extend(true, [], Store.luckysheet_select_save);\n                    }\n                    _this.apply(range, id, value);\n                } else if (id == 'locationStepRow') {\n                    if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1]) {\n                        if (isEditMode()) {\n                            alert(locale_location.locationTiplessTwoRow);\n                        } else {\n                            tooltip.info('', locale_location.locationTiplessTwoRow);\n                        }\n                        return;\n                    }\n                    let range = $.extend(true, [], Store.luckysheet_select_save);\n                    _this.apply(range, 'locationStepRow');\n                } else if (id == 'locationStepColumn') {\n                    if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                        if (isEditMode()) {\n                            alert(locale_location.locationTiplessTwoColumn);\n                        } else {\n                            tooltip.info('', locale_location.locationTiplessTwoColumn);\n                        }\n                        return;\n                    }\n                    let range = $.extend(true, [], Store.luckysheet_select_save);\n                    _this.apply(range, 'locationStepColumn');\n                } else {\n                    let range;\n                    if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1] && Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                        //单个单元格\n                        range = [{\n                                'row': [\n                                    0,\n                                    Store.flowdata.length - 1\n                                ],\n                                'column': [\n                                    0,\n                                    Store.flowdata[0].length - 1\n                                ]\n                            }];\n                    } else {\n                        range = $.extend(true, [], Store.luckysheet_select_save);\n                    }\n                    _this.apply(range, id);\n                }\n            });\n        },\n        apply: function (range, type, value) {\n            const locale_location = locale().findAndReplace;\n            let rangeArr = [];\n            if (type == 'locationFormula' || type == 'locationConstant' || type == 'locationNull') {\n                //公式 常量 空值\n                let minR = null, maxR = null, minC = null, maxC = null, cellSave = {};\n                for (let s = 0; s < range.length; s++) {\n                    let st_r = range[s].row[0], ed_r = range[s].row[1], st_c = range[s].column[0], ed_c = range[s].column[1];\n                    if (minR == null || minR < st_r) {\n                        minR = st_r;\n                    }\n                    if (maxR == null || maxR > ed_r) {\n                        maxR = ed_r;\n                    }\n                    if (minC == null || minC < st_c) {\n                        minC = st_c;\n                    }\n                    if (maxC == null || maxC > ed_c) {\n                        maxC = ed_c;\n                    }\n                    for (let r = st_r; r <= ed_r; r++) {\n                        for (let c = st_c; c <= ed_c; c++) {\n                            let cell = Store.flowdata[r][c];\n                            if (cell != null && cell.mc != null) {\n                                cell = Store.flowdata[cell.mc.r][cell.mc.c];\n                            }\n                            if (type == 'locationFormula' && cell != null && !isRealNull(cell.v) && cell.f != null && (value == 'all' || cell.ct != null && value.indexOf(cell.ct.t) > -1)) {\n                                cellSave[r + '_' + c] = 0;\n                            } else if (type == 'locationConstant' && cell != null && !isRealNull(cell.v) && (value == 'all' || cell.ct != null && value.indexOf(cell.ct.t) > -1)) {\n                                cellSave[r + '_' + c] = 0;\n                            } else if (type == 'locationNull' && (cell == null || isRealNull(cell.v))) {\n                                cellSave[r + '_' + c] = 0;\n                            }\n                        }\n                    }\n                }\n                rangeArr = this.getRangeArr(minR, maxR, minC, maxC, cellSave, rangeArr);\n            } else if (type == 'locationCF') {\n                //条件格式\n                let index = getSheetIndex(Store.currentSheetIndex);\n                let ruleArr = Store.luckysheetfile[index]['luckysheet_conditionformat_save'];\n                let data = Store.luckysheetfile[index]['data'];\n                if (ruleArr == null || ruleArr.length == 0) {\n                    if (isEditMode()) {\n                        alert(locale_location.locationTipNotFindCell);\n                    } else {\n                        tooltip.info('', locale_location.locationTipNotFindCell);\n                    }\n                    return;\n                }\n                computeMap = conditionformat.compute(ruleArr, data);\n                if (Object.keys(computeMap).length == 0) {\n                    if (isEditMode()) {\n                        alert(locale_location.locationTipNotFindCell);\n                    } else {\n                        tooltip.info('', locale_location.locationTipNotFindCell);\n                    }\n                    return;\n                }\n                let minR = null, maxR = null, minC = null, maxC = null, cellSave = {};\n                for (let s = 0; s < range.length; s++) {\n                    let st_r = range[s].row[0], ed_r = range[s].row[1], st_c = range[s].column[0], ed_c = range[s].column[1];\n                    if (minR == null || minR < st_r) {\n                        minR = st_r;\n                    }\n                    if (maxR == null || maxR > ed_r) {\n                        maxR = ed_r;\n                    }\n                    if (minC == null || minC < st_c) {\n                        minC = st_c;\n                    }\n                    if (maxC == null || maxC > ed_c) {\n                        maxC = ed_c;\n                    }\n                    for (let r = st_r; r <= ed_r; r++) {\n                        for (let c = st_c; c <= ed_c; c++) {\n                            if (r + '_' + c in computeMap) {\n                                cellSave[r + '_' + c] = 0;\n                            }\n                        }\n                    }\n                }\n                rangeArr = this.getRangeArr(minR, maxR, minC, maxC, cellSave, rangeArr);\n            } else if (type == 'locationStepRow') {\n                //间隔行\n                for (let s = 0; s < range.length; s++) {\n                    if (range[s].row[0] == range[s].row[1]) {\n                        continue;\n                    }\n                    let st_r = range[s].row[0], ed_r = range[s].row[1];\n                    let st_c = range[s].column[0], ed_c = range[s].column[1];\n                    for (let r = st_r; r <= ed_r; r++) {\n                        if ((r - st_r) % 2 == 0) {\n                            rangeArr.push({\n                                'row': [\n                                    r,\n                                    r\n                                ],\n                                'column': [\n                                    st_c,\n                                    ed_c\n                                ]\n                            });\n                        }\n                    }\n                }\n            } else if (type == 'locationStepColumn') {\n                //间隔列\n                for (let s = 0; s < range.length; s++) {\n                    if (range[s].column[0] == range[s].column[1]) {\n                        continue;\n                    }\n                    let st_r = range[s].row[0], ed_r = range[s].row[1];\n                    let st_c = range[s].column[0], ed_c = range[s].column[1];\n                    for (let c = st_c; c <= ed_c; c++) {\n                        if ((c - st_c) % 2 == 0) {\n                            rangeArr.push({\n                                'row': [\n                                    st_r,\n                                    ed_r\n                                ],\n                                'column': [\n                                    c,\n                                    c\n                                ]\n                            });\n                        }\n                    }\n                }\n            }\n            if (rangeArr.length == 0) {\n                if (isEditMode()) {\n                    alert(locale_location.locationTipNotFindCell);\n                } else {\n                    tooltip.info('', locale_location.locationTipNotFindCell);\n                }\n            } else {\n                Store.luckysheet_select_save = rangeArr;\n                selectHightlightShow();\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft(), scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let winH = $('#luckysheet-cell-main').height(), winW = $('#luckysheet-cell-main').width();\n                let r1 = Store.luckysheet_select_save[0]['row'][0], r2 = Store.luckysheet_select_save[0]['row'][1], c1 = Store.luckysheet_select_save[0]['column'][0], c2 = Store.luckysheet_select_save[0]['column'][1];\n                let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                if (col - scrollLeft - winW + 20 > 0) {\n                    $('#luckysheet-scrollbar-x').scrollLeft(col - winW + 20);\n                } else if (col_pre - scrollLeft - 20 < 0) {\n                    $('#luckysheet-scrollbar-x').scrollLeft(col_pre - 20);\n                }\n                if (row - scrollTop - winH + 20 > 0) {\n                    $('#luckysheet-scrollbar-y').scrollTop(row - winH + 20);\n                } else if (row_pre - scrollTop - 20 < 0) {\n                    $('#luckysheet-scrollbar-y').scrollTop(row_pre - 20);\n                }\n            }\n        },\n        getRangeArr(minR, maxR, minC, maxC, cellSave, rangeArr) {\n            if (Object.keys(cellSave).length == 0) {\n                return rangeArr;\n            }\n            let _this = this;\n            let stack_str = null, stack_edr = null, stack_stc = null, stack_edc = null;\n            for (let r = minR; r <= maxR; r++) {\n                for (let c = minC; c <= maxC; c++) {\n                    let cell = Store.flowdata[r][c];\n                    if (r + '_' + c in cellSave) {\n                        if (cell != null && cell.mc != null) {\n                            if (stack_stc == null) {\n                                let range = {\n                                    'row': [\n                                        cell.mc.r,\n                                        cell.mc.r + cell.mc.rs - 1\n                                    ],\n                                    'column': [\n                                        cell.mc.c,\n                                        cell.mc.c + cell.mc.cs - 1\n                                    ]\n                                };\n                                rangeArr.push(range);\n                                cellSave = _this.deleteCellInSave(cellSave, range);\n                                return _this.getRangeArr(minR, maxR, minC, maxC, cellSave, rangeArr);\n                            } else if (c < stack_edc) {\n                                let range = {\n                                    'row': [\n                                        stack_str,\n                                        stack_edr\n                                    ],\n                                    'column': [\n                                        stack_stc,\n                                        stack_edc\n                                    ]\n                                };\n                                rangeArr.push(range);\n                                cellSave = _this.deleteCellInSave(cellSave, range);\n                                return _this.getRangeArr(minR, maxR, minC, maxC, cellSave, rangeArr);\n                            } else {\n                                break;\n                            }\n                        } else if (stack_stc == null) {\n                            stack_stc = c;\n                            stack_edc = c;\n                            stack_str = r;\n                            stack_edr = r;\n                        } else if (c > stack_edc) {\n                            stack_edc = c;\n                        }\n                    } else if (stack_stc != null) {\n                        if (cell != null && cell.mc != null) {\n                            break;\n                        } else if (c < stack_stc) {\n                        } else if (c <= stack_edc) {\n                            let range = {\n                                'row': [\n                                    stack_str,\n                                    stack_edr\n                                ],\n                                'column': [\n                                    stack_stc,\n                                    stack_edc\n                                ]\n                            };\n                            rangeArr.push(range);\n                            cellSave = _this.deleteCellInSave(cellSave, range);\n                            return _this.getRangeArr(minR, maxR, minC, maxC, cellSave, rangeArr);\n                        } else {\n                            stack_edr = r;\n                        }\n                    }\n                }\n            }\n            if (stack_stc != null) {\n                let range = {\n                    'row': [\n                        stack_str,\n                        stack_edr\n                    ],\n                    'column': [\n                        stack_stc,\n                        stack_edc\n                    ]\n                };\n                rangeArr.push(range);\n                cellSave = _this.deleteCellInSave(cellSave, range);\n                return _this.getRangeArr(minR, maxR, minC, maxC, cellSave, rangeArr);\n            }\n        },\n        deleteCellInSave(cellSave, range) {\n            for (let r = range.row[0]; r <= range.row[1]; r++) {\n                for (let c = range.column[0]; c <= range.column[1]; c++) {\n                    delete cellSave[r + '_' + c];\n                }\n            }\n            return cellSave;\n        }\n    };\n    return luckysheetLocationCell;\n});"]}