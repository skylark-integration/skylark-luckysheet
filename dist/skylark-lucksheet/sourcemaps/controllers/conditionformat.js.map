{"version":3,"sources":["controllers/conditionformat.js"],"names":["define","m_get","m_util","formula","m_validate","tooltip","m_getdata","m_format","conditionformat_methods","m_constant","m_select","locale","m_protection","luckysheetConfigsetting","Store","dayjs","getSheetIndex","getRangetxt","replaceHtml","getObjType","chatatABC","isRealNull","isEditMode","getcellvalue","genarate","modelHTML","luckysheet_CFiconsImg","selectionCopyShow","checkProtectionFormatCells","Object","assign","ruleTypeHtml","conditionformat_Text","conditionformat","ruleTypeItem1","ruleTypeItem2","ruleTypeItem3","ruleTypeItem4","ruleTypeItem5","ruleTypeItem6","textCellColorHtml","textColor","cellColor","init","_this","this","$","document","off","on","index","val","getConditionRuleList","addClass","siblings","removeClass","currentSheetIndex","fileH","extend","luckysheetfile","historyRules","getHistoryRules","fileClone","c","length","sheetIndex","fileC","currentRules","getCurrentRules","ref","hide","allowUpdate","files","i","saveParam","k","parents","changeSheet","txt","trim","dataItem","attr","multiRangeDialog","selectRange","range","getRangeByTxt","s","r1","row","r2","c1","column","c2","visibledatarow","row_pre","col","visibledatacolumn","col_pre","push","left","width","top","height","left_move","width_move","top_move","height_move","row_focus","column_focus","v","find","cellrange","show","luckysheet_select_save","newConditionRuleDialog","alert","pleaseSelectRange","info","format","rule","type1","type2","color","spectrum","toHexString","type","maxcolor","toRgbString","midcolor","mincolor","len","leftMin","textcolor","cellcolor","conditionName","conditionRange","conditionValue","v1","v2","rangeArr1","infoDialog","onlySingleCell","flowdata","isNaN","conditionValueCanOnly","rangeArr2","rangeArr","pleaseSelectADate","is","parseInt","pleaseEnterInteger","source","ruleArr","undefined","administerRuleDialog","itemIndex","data","editorRule","editorConditionRuleDialog","console","log","html","getRuleExplain","colorSelectInit","optionVal","daterangeInit","toggle","leftmin","title","position","css","splice","updateItem","id","$id","singleRangeDialog","value","remove","append","addclass","selectCell","content","pleaseSelectCell","botton","confirm","cancel","style","$t","end","myh","outerHeight","myw","outerWidth","winw","window","winh","scrollLeft","scrollTop","showPalette","showPaletteOnly","preferredFormat","clickoutFiresChange","showInitial","showInput","hideAfterPaletteSelect","showSelectionPalette","maxPaletteSize","maxSelectionSize","cancelText","chooseText","confirmColor","togglePaletteMoreText","togglePaletteLessText","togglePaletteOnly","clearText","clearColorSelect","noColorSelectedText","localStorageKey","gridKey","palette","change","conditionformatDialog","conditionformat_occurrenceDate","CFiconsDialog","pleaseSelectIcon","direction","threeWayArrow","multicolor","threeTriangles","fourWayArrow","fiveWayArrow","grayColor","shape","threeColorTrafficLight","rimless","threeSigns","greenRedBlackGradient","bordered","fourColorTrafficLight","mark","threeSymbols","circled","tricolorFlag","noCircle","grade","threeStars","fiveQuadrantDiagram","fiveBoxes","grade4","grade5","icons","close","opHtml","j","status","currentSheet","sheet","showRules","newRule","editRule","deleteRule","applyRange","conditionformatManageRules","empty","luckysheet_conditionformat_save","ruleName","formatHtml","dataBar","colorGradation","getConditionRuleName","rangeTxtArr","itemHtml","join","prepend","each","x","closest","can","get","getContext","my_gradient","createLinearGradient","addColorStop","fillStyle","fillRect","beginPath","moveTo","lineTo","lineWidth","devicePixelRatio","strokeStyle","stroke","closePath","l","t","w1","h1","w2","h2","drawImage","eq","ruleExplainHtml","chooseRuleType","editRuleDescription","newFormatRule","ruleType","ruleFormat","editFormatRule","e","val1","val2","formatStyle","fillType","gradient","solid","dataBarColor","tricolor","twocolor","maxValue","medianValue","minValue","ruleTypeItem2_title","cellValue","specificText","occurrence","greaterThan","lessThan","between","equal","in","selectDataRange","contain","setFormat","ruleTypeItem3_title","last","selectRange_percent","ruleTypeItem4_title","above","below","selectRange_average","all","duplicateValue","uniqueValue","selectRange_value","flatpickr","mode","onChange","label","start","format1","yesterday","today","format2","lastWeek","thisWeek","lastMonth","thisMonth","lastYear","thisYear","last7days","last30days","indexOf"],"mappings":"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","file":"../../controllers/conditionformat.js","sourcesContent":["define([\n    '../methods/get',\n    '../utils/util',\n    '../methods/formula_methods',\n    '../methods/validate',\n    '../widgets/tooltip',\n    '../methods/getdata',\n    '../methods/format',\n    '../methods/conditionformat_methods',\n    '../widgets/constant',\n    '../widgets/select',\n    '../locale/locale',\n    '../methods/protection_methods',\n    '../methods/luckysheetConfigsetting',\n    '../store',\n    'skylark-moment'\n], function (m_get, m_util, formula, m_validate, tooltip,  m_getdata, m_format, conditionformat_methods,m_constant, m_select, locale, m_protection,luckysheetConfigsetting, Store, dayjs) {\n    'use strict';\n    const {getSheetIndex, getRangetxt} = m_get;\n    const {replaceHtml, getObjType, chatatABC} = m_util;\n    const {isRealNull} = m_validate;\n    const {isEditMode} = luckysheetConfigsetting;\n    const {getcellvalue} = m_getdata;\n    const {genarate} = m_format;\n    const {modelHTML, luckysheet_CFiconsImg} = m_constant;\n    const {selectionCopyShow} = m_select;\n    const {checkProtectionFormatCells} = m_protection;\n    //条件格式\n    const conditionformat = Object.assign(conditionformat_methods, {\n        //{\"sheetIndex\": sheetIndex,\"itemIndex\": itemIndex,\"data\": luckysheetfile[sheetIndex].luckysheet_conditionformat_save[itemIndex]}\n        ruleTypeHtml: function () {\n            const conditionformat_Text = locale().conditionformat;\n            return `<div class=\"ruleTypeBox\">\n                    <div class=\"ruleTypeItem\">\n                        <span class=\"icon iconfont luckysheet-iconfont-youjiantou\"></span>\n                        <span>${ conditionformat_Text.ruleTypeItem1 }</span>\n                    </div>\n                    <div class=\"ruleTypeItem\">\n                        <span class=\"icon iconfont luckysheet-iconfont-youjiantou\"></span>\n                        <span>${ conditionformat_Text.ruleTypeItem2 }</span>\n                    </div>\n                    <div class=\"ruleTypeItem\">\n                        <span class=\"icon iconfont luckysheet-iconfont-youjiantou\"></span>\n                        <span>${ conditionformat_Text.ruleTypeItem3 }</span>\n                    </div>\n                    <div class=\"ruleTypeItem\">\n                        <span class=\"icon iconfont luckysheet-iconfont-youjiantou\"></span>\n                        <span>${ conditionformat_Text.ruleTypeItem4 }</span>\n                    </div>\n                    <div class=\"ruleTypeItem\">\n                        <span class=\"icon iconfont luckysheet-iconfont-youjiantou\"></span>\n                        <span>${ conditionformat_Text.ruleTypeItem5 }</span>\n                    </div>\n                    <div class=\"ruleTypeItem\">\n                        <span class=\"icon iconfont luckysheet-iconfont-youjiantou\"></span>\n                        <span>${ conditionformat_Text.ruleTypeItem6 }</span>\n                    </div>\n                </div>`;\n        },\n        textCellColorHtml: function () {\n            const conditionformat_Text = locale().conditionformat;\n            return `<div id=\"textCellColor\">\n                    <div class=\"colorbox\">\n                        <input id=\"checkTextColor\" type=\"checkbox\" checked=\"checked\">\n                        <label for=\"checkTextColor\">${ conditionformat_Text.textColor }：</label>\n                        <input id=\"textcolorshow\" data-tips=\"${ conditionformat_Text.textColor }\" data-func=\"background\" class=\"luckysheet-conditionformat-config-color\" type=\"text\" value=\"#9c0006\" style=\"display: none;\">\n                    </div>\n                    <div class=\"colorbox\">\n                        <input id=\"checkCellColor\" type=\"checkbox\" checked=\"checked\">\n                        <label for=\"checkCellColor\">${ conditionformat_Text.cellColor }：</label>\n                        <input id=\"cellcolorshow\" data-tips=\"${ conditionformat_Text.cellColor }\" data-func=\"background\" class=\"luckysheet-conditionformat-config-color\" type=\"text\" value=\"#ffc7ce\" style=\"display: none;\">\n                    </div>\n                </div>`;\n        },\n        //黄-绿色阶\n        init: function () {\n            let _this = this;\n            const conditionformat_Text = locale().conditionformat;    // 管理规则\n            // 管理规则\n            $(document).off('change.CFchooseSheet').on('change.CFchooseSheet', '#luckysheet-administerRule-dialog .chooseSheet', function () {\n                let index = $('#luckysheet-administerRule-dialog .chooseSheet option:selected').val();\n                _this.getConditionRuleList(index);\n            });\n            $(document).off('click.CFadministerRuleItem').on('click.CFadministerRuleItem', '#luckysheet-administerRule-dialog .ruleList .listBox .item', function () {\n                $(this).addClass('on').siblings().removeClass('on');\n            });\n            $(document).off('click.CFadministerRuleConfirm').on('click.CFadministerRuleConfirm', '#luckysheet-administerRule-dialog-confirm', function () {\n                if (!checkProtectionFormatCells(Store.currentSheetIndex)) {\n                    return;\n                }    //保存之前的规则\n                //保存之前的规则\n                let fileH = $.extend(true, [], Store.luckysheetfile);\n                let historyRules = _this.getHistoryRules(fileH);    //保存当前的规则\n                //保存当前的规则\n                let fileClone = $.extend(true, [], _this.fileClone);\n                for (let c = 0; c < fileClone.length; c++) {\n                    let sheetIndex = fileClone[c]['index'];\n                    Store.luckysheetfile[getSheetIndex(sheetIndex)]['luckysheet_conditionformat_save'] = fileClone[getSheetIndex(sheetIndex)]['luckysheet_conditionformat_save'];\n                }\n                let fileC = $.extend(true, [], Store.luckysheetfile);\n                let currentRules = _this.getCurrentRules(fileC);    //刷新一次表格\n                //刷新一次表格\n                _this.ref(historyRules, currentRules);    //隐藏一些dom\n                //隐藏一些dom\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-administerRule-dialog').hide();    //发送给后台\n                //发送给后台\n                if (Store.allowUpdate) {\n                    let files = $.extend(true, [], Store.luckysheetfile);\n                    for (let i = 0; i < files.length; i++) {\n                        Store.saveParam('all', files[i]['index'], files[i]['luckysheet_conditionformat_save'], { 'k': 'luckysheet_conditionformat_save' });\n                    }\n                }\n            });\n            $(document).off('click.CFadministerRuleClose').on('click.CFadministerRuleClose', '#luckysheet-administerRule-dialog-close', function () {\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-administerRule-dialog').hide();\n                _this.fileClone = [];\n            });\n            $(document).off('click.CFadministerRuleFa').on('click.CFadministerRuleFa', '#luckysheet-administerRule-dialog .item .fa-table', function () {\n                $(this).parents('#luckysheet-administerRule-dialog').hide();\n                let sheetIndex = $('#luckysheet-administerRule-dialog .chooseSheet select option:selected').val();\n                if (sheetIndex != Store.currentSheetIndex) {\n                    Store.changeSheet(sheetIndex);\n                }\n                let txt = $(this).siblings('input').val().trim();\n                let dataItem = $(this).parents('.item').attr('data-item');\n                _this.multiRangeDialog(dataItem, txt);\n                _this.selectRange = [];\n                let range = _this.getRangeByTxt(txt);\n                if (range.length > 0) {\n                    for (let s = 0; s < range.length; s++) {\n                        let r1 = range[s].row[0], r2 = range[s].row[1];\n                        let c1 = range[s].column[0], c2 = range[s].column[1];\n                        let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                        let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                        _this.selectRange.push({\n                            'left': col_pre,\n                            'width': col - col_pre - 1,\n                            'top': row_pre,\n                            'height': row - row_pre - 1,\n                            'left_move': col_pre,\n                            'width_move': col - col_pre - 1,\n                            'top_move': row_pre,\n                            'height_move': row - row_pre - 1,\n                            'row': [\n                                r1,\n                                r2\n                            ],\n                            'column': [\n                                c1,\n                                c2\n                            ],\n                            'row_focus': r1,\n                            'column_focus': c1\n                        });\n                    }\n                }\n                selectionCopyShow(_this.selectRange);\n            });\n            $(document).off('click.CFmultiRangeConfirm').on('click.CFmultiRangeConfirm', '#luckysheet-multiRange-dialog-confirm', function () {\n                $(this).parents('#luckysheet-multiRange-dialog').hide();\n                let dataItem = $(this).attr('data-item');\n                let v = $(this).parents('#luckysheet-multiRange-dialog').find('input').val();\n                $('#luckysheet-administerRule-dialog .item[data-item=' + dataItem + '] input').val(v);\n                let sheetIndex = $('#luckysheet-administerRule-dialog .chooseSheet option:selected').val();\n                _this.fileClone[getSheetIndex(sheetIndex)]['luckysheet_conditionformat_save'][dataItem].cellrange = _this.getRangeByTxt(v);\n                $('#luckysheet-modal-dialog-mask').show();\n                $('#luckysheet-administerRule-dialog').show();\n                let range = [];\n                selectionCopyShow(range);\n            });\n            $(document).off('click.CFmultiRangeClose').on('click.CFmultiRangeClose', '#luckysheet-multiRange-dialog-close', function () {\n                $(this).parents('#luckysheet-multiRange-dialog').hide();\n                $('#luckysheet-modal-dialog-mask').show();\n                $('#luckysheet-administerRule-dialog').show();\n                $('#luckysheet-formula-functionrange-select').hide();\n                $('#luckysheet-row-count-show').hide();\n                $('#luckysheet-column-count-show').hide();\n                let range = [];\n                selectionCopyShow(range);\n            });    // 新建规则\n            // 新建规则\n            $(document).off('click.CFnewConditionRule').on('click.CFnewConditionRule', '#newConditionRule', function () {\n                let sheetIndex = $('#luckysheet-administerRule-dialog .chooseSheet option:selected').val();\n                if (!checkProtectionFormatCells(sheetIndex)) {\n                    return;\n                }\n                if (Store.luckysheet_select_save.length == 0) {\n                    if (isEditMode()) {\n                        alert(conditionformat_Text.pleaseSelectRange);\n                    } else {\n                        tooltip.info(conditionformat_Text.pleaseSelectRange, '');\n                    }\n                    return;\n                }\n                _this.newConditionRuleDialog(1);\n            });\n            $(document).off('click.CFnewConditionRuleConfirm').on('click.CFnewConditionRuleConfirm', '#luckysheet-newConditionRule-dialog-confirm', function () {\n                if (!checkProtectionFormatCells(Store.currentSheetIndex)) {\n                    return;\n                }\n                let index = $('#luckysheet-newConditionRule-dialog .ruleTypeItem.on').index();\n                let type1 = $('#luckysheet-newConditionRule-dialog #type1 option:selected').val();\n                let type2 = $('#luckysheet-newConditionRule-dialog .' + type1 + 'Box #type2 option:selected').val();\n                let format, rule;\n                if (index == 0) {\n                    if (type1 == 'dataBar') {\n                        //数据条\n                        let color = $(this).parents('#luckysheet-newConditionRule-dialog').find('.dataBarBox .luckysheet-conditionformat-config-color').spectrum('get').toHexString();\n                        if (type2 == 'gradient') {\n                            //渐变填充\n                            format = [\n                                color,\n                                '#ffffff'\n                            ];\n                        } else if (type2 == 'solid') {\n                            //实心填充\n                            format = [color];\n                        }\n                        rule = {\n                            'type': 'dataBar',\n                            'cellrange': $.extend(true, [], Store.luckysheet_select_save),\n                            'format': format\n                        };\n                    } else if (type1 == 'colorGradation') {\n                        //色阶\n                        let maxcolor = $(this).parents('#luckysheet-newConditionRule-dialog').find('.colorGradationBox .maxVal .luckysheet-conditionformat-config-color').spectrum('get').toRgbString();\n                        let midcolor = $(this).parents('#luckysheet-newConditionRule-dialog').find('.colorGradationBox .midVal .luckysheet-conditionformat-config-color').spectrum('get').toRgbString();\n                        let mincolor = $(this).parents('#luckysheet-newConditionRule-dialog').find('.colorGradationBox .minVal .luckysheet-conditionformat-config-color').spectrum('get').toRgbString();\n                        if (type2 == 'threeColor') {\n                            //三色\n                            format = [\n                                maxcolor,\n                                midcolor,\n                                mincolor\n                            ];\n                        } else if (type2 == 'twoColor') {\n                            //双色\n                            format = [\n                                maxcolor,\n                                mincolor\n                            ];\n                        }\n                        rule = {\n                            'type': 'colorGradation',\n                            'cellrange': $.extend(true, [], Store.luckysheet_select_save),\n                            'format': format\n                        };\n                    } else if (type1 == 'icons') {\n                        //图标集\n                        let len = $(this).parents('#luckysheet-newConditionRule-dialog').find('.iconsBox .model').attr('data-len');\n                        let leftMin = $(this).parents('#luckysheet-newConditionRule-dialog').find('.iconsBox .model').attr('data-leftmin');\n                        let top = $(this).parents('#luckysheet-newConditionRule-dialog').find('.iconsBox .model').attr('data-top');\n                        format = {\n                            'len': len,\n                            'leftMin': leftMin,\n                            'top': top\n                        };\n                        rule = {\n                            'type': 'icons',\n                            'cellrange': $.extend(true, [], Store.luckysheet_select_save),\n                            'format': format\n                        };\n                    }\n                } else {\n                    let conditionName = '', conditionRange = [], conditionValue = [];\n                    if (index == 1) {\n                        if (type1 == 'number') {\n                            //单元格值\n                            conditionName = type2;\n                            if (type2 == 'betweenness') {\n                                let v1 = $('#luckysheet-newConditionRule-dialog #conditionVal input').val().trim();\n                                let v2 = $('#luckysheet-newConditionRule-dialog #conditionVal2 input').val().trim();    //条件值是否是选区\n                                //条件值是否是选区\n                                let rangeArr1 = _this.getRangeByTxt(v1);\n                                if (rangeArr1.length > 1) {\n                                    _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                    return;\n                                } else if (rangeArr1.length == 1) {\n                                    let r1 = rangeArr1[0].row[0], r2 = rangeArr1[0].row[1];\n                                    let c1 = rangeArr1[0].column[0], c2 = rangeArr1[0].column[1];\n                                    if (r1 == r2 && c1 == c2) {\n                                        v1 = getcellvalue(r1, c1, Store.flowdata);\n                                        conditionRange.push({\n                                            'row': rangeArr1[0].row,\n                                            'column': rangeArr1[0].column\n                                        });\n                                        conditionValue.push(v1);\n                                    } else {\n                                        _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                        return;\n                                    }\n                                } else if (rangeArr1.length == 0) {\n                                    if (isNaN(v1) || v1 == '') {\n                                        _this.infoDialog(conditionformat_Text.conditionValueCanOnly, '');\n                                        return;\n                                    } else {\n                                        conditionValue.push(v1);\n                                    }\n                                }\n                                let rangeArr2 = _this.getRangeByTxt(v2);\n                                if (rangeArr2.length > 1) {\n                                    _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                    return;\n                                } else if (rangeArr2.length == 1) {\n                                    let r1 = rangeArr2[0].row[0], r2 = rangeArr2[0].row[1];\n                                    let c1 = rangeArr2[0].column[0], c2 = rangeArr2[0].column[1];\n                                    if (r1 == r2 && c1 == c2) {\n                                        v2 = getcellvalue(r1, c1, Store.flowdata);\n                                        conditionRange.push({\n                                            'row': rangeArr2[0].row,\n                                            'column': rangeArr2[0].column\n                                        });\n                                        conditionValue.push(v2);\n                                    } else {\n                                        _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                        return;\n                                    }\n                                } else if (rangeArr2.length == 0) {\n                                    if (isNaN(v2) || v2 == '') {\n                                        _this.infoDialog(conditionformat_Text.conditionValueCanOnly, '');\n                                        return;\n                                    } else {\n                                        conditionValue.push(v2);\n                                    }\n                                }\n                            } else {\n                                //条件值\n                                let v = $('#luckysheet-newConditionRule-dialog #conditionVal input').val().trim();    //条件值是否是选区\n                                //条件值是否是选区\n                                let rangeArr = _this.getRangeByTxt(v);\n                                if (rangeArr.length > 1) {\n                                    _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                    return;\n                                } else if (rangeArr.length == 1) {\n                                    let r1 = rangeArr[0].row[0], r2 = rangeArr[0].row[1];\n                                    let c1 = rangeArr[0].column[0], c2 = rangeArr[0].column[1];\n                                    if (r1 == r2 && c1 == c2) {\n                                        v = getcellvalue(r1, c1, Store.flowdata);\n                                        conditionRange.push({\n                                            'row': rangeArr[0].row,\n                                            'column': rangeArr[0].column\n                                        });\n                                        conditionValue.push(v);\n                                    } else {\n                                        _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                        return;\n                                    }\n                                } else if (rangeArr.length == 0) {\n                                    if (isNaN(v) || v == '') {\n                                        _this.infoDialog(conditionformat_Text.conditionValueCanOnly, '');\n                                        return;\n                                    } else {\n                                        conditionValue.push(v);\n                                    }\n                                }\n                            }\n                        } else if (type1 == 'text') {\n                            //特定文本\n                            conditionName = 'textContains';    //条件值\n                            //条件值\n                            let v = $('#luckysheet-newConditionRule-dialog #conditionVal input').val().trim();    //条件值是否是选区\n                            //条件值是否是选区\n                            let rangeArr = _this.getRangeByTxt(v);\n                            if (rangeArr.length > 1) {\n                                _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                return;\n                            } else if (rangeArr.length == 1) {\n                                let r1 = rangeArr[0].row[0], r2 = rangeArr[0].row[1];\n                                let c1 = rangeArr[0].column[0], c2 = rangeArr[0].column[1];\n                                if (r1 == r2 && c1 == c2) {\n                                    v = getcellvalue(r1, c1, Store.flowdata);\n                                    conditionRange.push({\n                                        'row': rangeArr[0].row,\n                                        'column': rangeArr[0].column\n                                    });\n                                    conditionValue.push(v);\n                                } else {\n                                    _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                    return;\n                                }\n                            } else if (rangeArr.length == 0) {\n                                if (v == '') {\n                                    _this.infoDialog(conditionformat_Text.conditionValueCanOnly, '');\n                                    return;\n                                } else {\n                                    conditionValue.push(v);\n                                }\n                            }\n                        } else if (type1 == 'date') {\n                            //发生日期\n                            conditionName = 'occurrenceDate';    //条件值\n                            //条件值\n                            let v = $('#luckysheet-newConditionRule-dialog #daterange-btn').val();\n                            if (v == '' || v == null) {\n                                _this.infoDialog(conditionformat_Text.pleaseSelectADate, '');\n                                return;\n                            }\n                            conditionValue.push(v);\n                        }\n                    } else if (index == 2) {\n                        //排名靠前靠后\n                        //条件名称\n                        if (type1 == 'top') {\n                            if ($('#luckysheet-newConditionRule-dialog #isPercent').is(':selected')) {\n                                conditionName = 'top10%';\n                            } else {\n                                conditionName = 'top10';\n                            }\n                        } else if (type1 == 'last') {\n                            if ($('#luckysheet-newConditionRule-dialog #isPercent').is(':selected')) {\n                                conditionName = 'last10%';\n                            } else {\n                                conditionName = 'last10';\n                            }\n                        }    //条件值\n                        //条件值\n                        let v = $('#luckysheet-newConditionRule-dialog #conditionVal input').val().trim();\n                        if (parseInt(v) != v || parseInt(v) < 1 || parseInt(v) > 1000) {\n                            _this.infoDialog(conditionformat_Text.pleaseEnterInteger, '');\n                            return;\n                        }\n                        conditionValue.push(parseInt(v));\n                    } else if (index == 3) {\n                        //平均值\n                        if (type1 == 'AboveAverage') {\n                            conditionName = 'AboveAverage';\n                            conditionValue.push('AboveAverage');\n                        } else if (type1 == 'SubAverage') {\n                            conditionName = 'SubAverage';\n                            conditionValue.push('SubAverage');\n                        }\n                    } else if (index == 4) {\n                        //重复值\n                        conditionName = 'duplicateValue';\n                        conditionValue.push(type1);\n                    } else if (index == 5) {\n                        //公式\n                        conditionName = 'formula';    //条件值\n                        //条件值\n                        let v = $('#luckysheet-newConditionRule-dialog #formulaConditionVal input').val().trim();\n                        if (v == '') {\n                            _this.infoDialog('Condition value cannot be empty!', '');\n                            return;\n                        }\n                        conditionValue.push(v);\n                    }    //格式颜色\n                    //格式颜色\n                    let textcolor;\n                    if ($('#luckysheet-newConditionRule-dialog #checkTextColor').is(':checked')) {\n                        textcolor = $('#luckysheet-newConditionRule-dialog #textcolorshow').spectrum('get').toHexString();\n                    } else {\n                        textcolor = null;\n                    }\n                    let cellcolor;\n                    if ($('#luckysheet-newConditionRule-dialog #checkCellColor').is(':checked')) {\n                        cellcolor = $('#luckysheet-newConditionRule-dialog #cellcolorshow').spectrum('get').toHexString();\n                    } else {\n                        cellcolor = null;\n                    }\n                    format = {\n                        'textColor': textcolor,\n                        'cellColor': cellcolor\n                    };\n                    rule = {\n                        'type': 'default',\n                        'cellrange': $.extend(true, [], Store.luckysheet_select_save),\n                        'format': format,\n                        'conditionName': conditionName,\n                        'conditionRange': conditionRange,\n                        'conditionValue': conditionValue\n                    };\n                }\n                $('#luckysheet-newConditionRule-dialog').hide();    //新建规则的入口\n                //新建规则的入口\n                let source = $(this).attr('data-source');\n                if (source == 0) {\n                    $('#luckysheet-modal-dialog-mask').hide();    //保存之前的规则\n                    //保存之前的规则\n                    let fileH = $.extend(true, [], Store.luckysheetfile);\n                    let historyRules = _this.getHistoryRules(fileH);    //保存当前的规则\n                    //保存当前的规则\n                    let ruleArr = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_conditionformat_save'] == undefined ? [] : Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_conditionformat_save'];\n                    ruleArr.push(rule);\n                    Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_conditionformat_save'] = ruleArr;\n                    let fileC = $.extend(true, [], Store.luckysheetfile);\n                    let currentRules = _this.getCurrentRules(fileC);    //刷新一次表格\n                    //刷新一次表格\n                    _this.ref(historyRules, currentRules);    //发送给后台\n                    //发送给后台\n                    if (Store.allowUpdate) {\n                        Store.saveParam('all', Store.currentSheetIndex, ruleArr, { 'k': 'luckysheet_conditionformat_save' });\n                    }\n                } else if (source == 1) {\n                    //临时存储新规则\n                    let ruleArr = !!_this.fileClone[getSheetIndex(Store.currentSheetIndex)]['luckysheet_conditionformat_save'] ? _this.fileClone[getSheetIndex(Store.currentSheetIndex)]['luckysheet_conditionformat_save'] : [];\n                    ruleArr.push(rule);\n                    _this.fileClone[getSheetIndex(Store.currentSheetIndex)]['luckysheet_conditionformat_save'] = ruleArr;    //新建规则隐藏，管理规则显示\n                    //新建规则隐藏，管理规则显示\n                    _this.administerRuleDialog();\n                }\n            });\n            $(document).off('click.CFnewConditionRuleClose').on('click.CFnewConditionRuleClose', '#luckysheet-newConditionRule-dialog-close', function () {\n                //新建规则的入口\n                let source = $(this).attr('data-source');\n                if (source == 0) {\n                    $('#luckysheet-modal-dialog-mask').hide();\n                }\n                if (source == 1) {\n                    $('#luckysheet-administerRule-dialog').show();\n                }    //新建规则隐藏\n                //新建规则隐藏\n                $('#luckysheet-newConditionRule-dialog').hide();    //隐藏虚线框\n                //隐藏虚线框\n                $('#luckysheet-formula-functionrange-select').hide();\n                $('#luckysheet-row-count-show').hide();\n                $('#luckysheet-column-count-show').hide();\n            });    // 编辑规则\n            // 编辑规则\n            $(document).off('click.CFeditorConditionRule').on('click.CFeditorConditionRule', '#editorConditionRule', function () {\n                let sheetIndex = $('#luckysheet-administerRule-dialog .chooseSheet option:selected').val();\n                if (!checkProtectionFormatCells(sheetIndex)) {\n                    return;\n                }\n                let itemIndex = $('#luckysheet-administerRule-dialog .ruleList .listBox .item.on').attr('data-item');\n                let rule = {\n                    'sheetIndex': sheetIndex,\n                    'itemIndex': itemIndex,\n                    'data': _this.fileClone[getSheetIndex(sheetIndex)]['luckysheet_conditionformat_save'][itemIndex]\n                };\n                _this.editorRule = rule;\n                _this.editorConditionRuleDialog();\n            });\n            $(document).off('click.CFeditorConditionRuleConfirm').on('click.CFeditorConditionRuleConfirm', '#luckysheet-editorConditionRule-dialog-confirm', function () {\n                let index = $('#luckysheet-editorConditionRule-dialog .ruleTypeItem.on').index();\n                let type1 = $('#luckysheet-editorConditionRule-dialog #type1 option:selected').val();\n                let type2 = $('#luckysheet-editorConditionRule-dialog .' + type1 + 'Box #type2 option:selected').val();\n                let cellrange = _this.editorRule['data'].cellrange;\n                let format, rule;\n                if (index == 0) {\n                    if (type1 == 'dataBar') {\n                        //数据条\n                        let color = $(this).parents('#luckysheet-editorConditionRule-dialog').find('.dataBarBox .luckysheet-conditionformat-config-color').spectrum('get').toHexString();\n                        if (type2 == 'gradient') {\n                            //渐变填充\n                            format = [\n                                color,\n                                '#ffffff'\n                            ];\n                        } else if (type2 == 'solid') {\n                            //实心填充\n                            format = [color];\n                        }\n                        rule = {\n                            'type': 'dataBar',\n                            'cellrange': cellrange,\n                            'format': format\n                        };\n                    } else if (type1 == 'colorGradation') {\n                        //色阶\n                        let maxcolor = $(this).parents('#luckysheet-editorConditionRule-dialog').find('.colorGradationBox .maxVal .luckysheet-conditionformat-config-color').spectrum('get').toRgbString();\n                        let midcolor = $(this).parents('#luckysheet-editorConditionRule-dialog').find('.colorGradationBox .midVal .luckysheet-conditionformat-config-color').spectrum('get').toRgbString();\n                        let mincolor = $(this).parents('#luckysheet-editorConditionRule-dialog').find('.colorGradationBox .minVal .luckysheet-conditionformat-config-color').spectrum('get').toRgbString();\n                        if (type2 == 'threeColor') {\n                            //三色\n                            format = [\n                                maxcolor,\n                                midcolor,\n                                mincolor\n                            ];\n                        } else if (type2 == 'twoColor') {\n                            //双色\n                            format = [\n                                maxcolor,\n                                mincolor\n                            ];\n                        }\n                        rule = {\n                            'type': 'colorGradation',\n                            'cellrange': cellrange,\n                            'format': format\n                        };\n                    } else if (type1 == 'icons') {\n                        //图标集\n                        let len = $(this).parents('#luckysheet-editorConditionRule-dialog').find('.iconsBox .model').attr('data-len');\n                        let leftMin = $(this).parents('#luckysheet-editorConditionRule-dialog').find('.iconsBox .model').attr('data-leftmin');\n                        let top = $(this).parents('#luckysheet-editorConditionRule-dialog').find('.iconsBox .model').attr('data-top');\n                        format = {\n                            'len': len,\n                            'leftMin': leftMin,\n                            'top': top\n                        };\n                        rule = {\n                            'type': 'icons',\n                            'cellrange': cellrange,\n                            'format': format\n                        };\n                    }\n                } else {\n                    let conditionName = '', conditionRange = [], conditionValue = [];\n                    if (index == 1) {\n                        if (type1 == 'number') {\n                            //单元格值\n                            conditionName = type2;\n                            if (type2 == 'betweenness') {\n                                let v1 = $('#luckysheet-editorConditionRule-dialog #conditionVal input').val().trim();\n                                let v2 = $('#luckysheet-editorConditionRule-dialog #conditionVal2 input').val().trim();    //条件值是否是选区\n                                //条件值是否是选区\n                                let rangeArr1 = _this.getRangeByTxt(v1);\n                                if (rangeArr1.length > 1) {\n                                    _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                    return;\n                                } else if (rangeArr1.length == 1) {\n                                    let r1 = rangeArr1[0].row[0], r2 = rangeArr1[0].row[1];\n                                    let c1 = rangeArr1[0].column[0], c2 = rangeArr1[0].column[1];\n                                    if (r1 == r2 && c1 == c2) {\n                                        v1 = getcellvalue(r1, c1, Store.flowdata);\n                                        conditionRange.push({\n                                            'row': rangeArr1[0].row,\n                                            'column': rangeArr1[0].column\n                                        });\n                                        conditionValue.push(v1);\n                                    } else {\n                                        _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                        return;\n                                    }\n                                } else if (rangeArr1.length == 0) {\n                                    if (isNaN(v1) || v1 == '') {\n                                        _this.infoDialog(conditionformat_Text.conditionValueCanOnly, '');\n                                        return;\n                                    } else {\n                                        conditionValue.push(v1);\n                                    }\n                                }\n                                let rangeArr2 = _this.getRangeByTxt(v2);\n                                if (rangeArr2.length > 1) {\n                                    _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                    return;\n                                } else if (rangeArr2.length == 1) {\n                                    let r1 = rangeArr2[0].row[0], r2 = rangeArr2[0].row[1];\n                                    let c1 = rangeArr2[0].column[0], c2 = rangeArr2[0].column[1];\n                                    if (r1 == r2 && c1 == c2) {\n                                        v2 = getcellvalue(r1, c1, Store.flowdata);\n                                        conditionRange.push({\n                                            'row': rangeArr2[0].row,\n                                            'column': rangeArr2[0].column\n                                        });\n                                        conditionValue.push(v2);\n                                    } else {\n                                        _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                        return;\n                                    }\n                                } else if (rangeArr2.length == 0) {\n                                    if (isNaN(v2) || v2 == '') {\n                                        _this.infoDialog(conditionformat_Text.conditionValueCanOnly, '');\n                                        return;\n                                    } else {\n                                        conditionValue.push(v2);\n                                    }\n                                }\n                            } else {\n                                //条件值\n                                let v = $('#luckysheet-editorConditionRule-dialog #conditionVal input').val().trim();    //条件值是否是选区\n                                //条件值是否是选区\n                                let rangeArr = _this.getRangeByTxt(v);\n                                if (rangeArr.length > 1) {\n                                    _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                    return;\n                                } else if (rangeArr.length == 1) {\n                                    let r1 = rangeArr[0].row[0], r2 = rangeArr[0].row[1];\n                                    let c1 = rangeArr[0].column[0], c2 = rangeArr[0].column[1];\n                                    if (r1 == r2 && c1 == c2) {\n                                        v = getcellvalue(r1, c1, Store.flowdata);\n                                        conditionRange.push({\n                                            'row': rangeArr[0].row,\n                                            'column': rangeArr[0].column\n                                        });\n                                        conditionValue.push(v);\n                                    } else {\n                                        _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                        return;\n                                    }\n                                } else if (rangeArr.length == 0) {\n                                    if (isNaN(v) || v == '') {\n                                        _this.infoDialog(conditionformat_Text.conditionValueCanOnly, '');\n                                        return;\n                                    } else {\n                                        conditionValue.push(v);\n                                    }\n                                }\n                            }\n                        } else if (type1 == 'text') {\n                            //特定文本\n                            conditionName = 'textContains';    //条件值\n                            //条件值\n                            let v = $('#luckysheet-editorConditionRule-dialog #conditionVal input').val().trim();    //条件值是否是选区\n                            //条件值是否是选区\n                            let rangeArr = _this.getRangeByTxt(v);\n                            if (rangeArr.length > 1) {\n                                _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                return;\n                            } else if (rangeArr.length == 1) {\n                                let r1 = rangeArr[0].row[0], r2 = rangeArr[0].row[1];\n                                let c1 = rangeArr[0].column[0], c2 = rangeArr[0].column[1];\n                                if (r1 == r2 && c1 == c2) {\n                                    v = getcellvalue(r1, c1, Store.flowdata);\n                                    conditionRange.push({\n                                        'row': rangeArr[0].row,\n                                        'column': rangeArr[0].column\n                                    });\n                                    conditionValue.push(v);\n                                } else {\n                                    _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                                    return;\n                                }\n                            } else if (rangeArr.length == 0) {\n                                if (isNaN(v) || v == '') {\n                                    _this.infoDialog(conditionformat_Text.conditionValueCanOnly, '');\n                                    return;\n                                } else {\n                                    conditionValue.push(v);\n                                }\n                            }\n                        } else if (type1 == 'date') {\n                            //发生日期\n                            conditionName = 'occurrenceDate';    //条件值\n                            //条件值\n                            let v = $('#luckysheet-editorConditionRule-dialog #daterange-btn').val();\n                            if (v == '' || v == null) {\n                                _this.infoDialog(conditionformat_Text.pleaseSelectADate, '');\n                                return;\n                            }\n                            conditionValue.push(v);\n                        }\n                    } else if (index == 2) {\n                        //排名靠前靠后\n                        //条件名称\n                        if (type1 == 'top') {\n                            if ($('#luckysheet-editorConditionRule-dialog #isPercent').is(':selected')) {\n                                conditionName = 'top10%';\n                            } else {\n                                conditionName = 'top10';\n                            }\n                        } else if (type1 == 'last') {\n                            if ($('#luckysheet-editorConditionRule-dialog #isPercent').is(':selected')) {\n                                conditionName = 'last10%';\n                            } else {\n                                conditionName = 'last10';\n                            }\n                        }    //条件值\n                        //条件值\n                        let v = $('#luckysheet-editorConditionRule-dialog #conditionVal input').val().trim();\n                        if (parseInt(v) != v || parseInt(v) < 1 || parseInt(v) > 1000) {\n                            _this.infoDialog(conditionformat_Text.pleaseEnterInteger, '');\n                            return;\n                        }\n                        conditionValue.push(v);\n                    } else if (index == 3) {\n                        //平均值\n                        if (type1 == 'AboveAverage') {\n                            conditionName = 'AboveAverage';\n                            conditionValue.push('AboveAverage');\n                        } else if (type1 == 'SubAverage') {\n                            conditionName = 'SubAverage';\n                            conditionValue.push('SubAverage');\n                        }\n                    } else if (index == 4) {\n                        //重复值\n                        conditionName = 'duplicateValue';\n                        conditionValue.push(type1);\n                    } else if (index == 5) {\n                        //公式\n                        conditionName = 'formula';    //条件值\n                        //条件值\n                        let v = $('#luckysheet-editorConditionRule-dialog #formulaConditionVal input').val().trim();\n                        console.log(v);\n                        if (v == '') {\n                            _this.infoDialog('Condition value cannot be empty!', '');\n                            return;\n                        }\n                        conditionValue.push(v);\n                    }    //格式颜色\n                    //格式颜色\n                    let textcolor;\n                    if ($('#luckysheet-editorConditionRule-dialog #checkTextColor').is(':checked')) {\n                        textcolor = $('#luckysheet-editorConditionRule-dialog #textcolorshow').spectrum('get').toHexString();\n                    } else {\n                        textcolor = null;\n                    }\n                    let cellcolor;\n                    if ($('#luckysheet-editorConditionRule-dialog #checkCellColor').is(':checked')) {\n                        cellcolor = $('#luckysheet-editorConditionRule-dialog #cellcolorshow').spectrum('get').toHexString();\n                    } else {\n                        cellcolor = null;\n                    }\n                    format = {\n                        'textColor': textcolor,\n                        'cellColor': cellcolor\n                    };\n                    rule = {\n                        'type': 'default',\n                        'cellrange': cellrange,\n                        'format': format,\n                        'conditionName': conditionName,\n                        'conditionRange': conditionRange,\n                        'conditionValue': conditionValue\n                    };\n                }    //修改编辑的规则\n                //修改编辑的规则\n                let sheetIndex = _this.editorRule['sheetIndex'];\n                let itemIndex = _this.editorRule['itemIndex'];\n                _this.fileClone[getSheetIndex(sheetIndex)]['luckysheet_conditionformat_save'][itemIndex] = rule;    //编辑规则隐藏，管理规则显示\n                //编辑规则隐藏，管理规则显示\n                $('#luckysheet-editorConditionRule-dialog').hide();\n                _this.administerRuleDialog();\n            });\n            $(document).off('click.CFeditorConditionRuleClose').on('click.CFeditorConditionRuleClose', '#luckysheet-editorConditionRule-dialog-close', function () {\n                //编辑规则隐藏，管理规则显示\n                $('#luckysheet-editorConditionRule-dialog').hide();\n                $('#luckysheet-administerRule-dialog').show();    //隐藏虚线框\n                //隐藏虚线框\n                $('#luckysheet-formula-functionrange-select').hide();\n                $('#luckysheet-row-count-show').hide();\n                $('#luckysheet-column-count-show').hide();\n            });    // 新建规则、编辑规则 类型切换\n            // 新建规则、编辑规则 类型切换\n            $(document).off('click.CFnewEditorRuleItem').on('click.CFnewEditorRuleItem', '.luckysheet-newEditorRule-dialog .ruleTypeItem', function () {\n                $(this).addClass('on').siblings().removeClass('on');\n                let index = $(this).index();\n                $(this).parents('.luckysheet-newEditorRule-dialog').find('.ruleExplainBox').html(_this.getRuleExplain(index));\n                _this.colorSelectInit();\n            });\n            $(document).off('change.CFnewEditorRuleType1').on('change.CFnewEditorRuleType1', '.luckysheet-newEditorRule-dialog #type1', function () {\n                let optionVal = $(this).find('option:selected').val();\n                if (optionVal == 'dataBar' || optionVal == 'colorGradation' || optionVal == 'icons' || optionVal == 'number' || optionVal == 'text' || optionVal == 'date') {\n                    $(this).parents('.luckysheet-newEditorRule-dialog').find('.' + optionVal + 'Box').show().siblings().hide();\n                }\n                if (optionVal == 'date') {\n                    _this.daterangeInit($(this).parents('.luckysheet-newEditorRule-dialog').attr('id'));\n                }\n            });\n            $(document).off('change.CFnewEditorRuleType2').on('change.CFnewEditorRuleType2', '.luckysheet-newEditorRule-dialog #type2', function () {\n                let type1 = $(this).parents('.luckysheet-newEditorRule-dialog').find('#type1 option:selected').val();\n                if (type1 == 'colorGradation') {\n                    let type2 = $(this).find('option:selected').val();\n                    if (type2 == 'threeColor') {\n                        $(this).parents('.luckysheet-newEditorRule-dialog').find('.midVal').show();\n                    } else {\n                        $(this).parents('.luckysheet-newEditorRule-dialog').find('.midVal').hide();\n                    }\n                } else if (type1 == 'number') {\n                    let type2 = $(this).find('option:selected').val();\n                    if (type2 == 'betweenness') {\n                        $(this).parents('.luckysheet-newEditorRule-dialog').find('.txt').show();\n                        $(this).parents('.luckysheet-newEditorRule-dialog').find('#conditionVal2').show();\n                    } else {\n                        $(this).parents('.luckysheet-newEditorRule-dialog').find('.txt').hide();\n                        $(this).parents('.luckysheet-newEditorRule-dialog').find('#conditionVal2').hide();\n                    }\n                }\n            });\n            $(document).off('click.CFiconsShowbox').on('click.CFiconsShowbox', '.luckysheet-newEditorRule-dialog .iconsBox .showbox', function () {\n                $(this).parents('.iconsBox').find('ul').toggle();\n            });\n            $(document).off('click.CFiconsLi').on('click.CFiconsLi', '.luckysheet-newEditorRule-dialog .iconsBox li', function () {\n                let len = $(this).find('div').attr('data-len');\n                let leftmin = $(this).find('div').attr('data-leftmin');\n                let top = $(this).find('div').attr('data-top');\n                let title = $(this).find('div').attr('title');\n                let position = $(this).find('div').css('background-position');\n                $(this).parents('.iconsBox').find('.showbox .model').css('background-position', position);\n                $(this).parents('.iconsBox').find('.showbox .model').attr('data-len', len);\n                $(this).parents('.iconsBox').find('.showbox .model').attr('data-leftmin', leftmin);\n                $(this).parents('.iconsBox').find('.showbox .model').attr('data-top', top);\n                $(this).parents('.iconsBox').find('.showbox .model').attr('title', title);\n                $(this).parents('ul').hide();\n            });    // 删除规则\n            // 删除规则\n            $(document).off('click.CFdeleteConditionRule').on('click.CFdeleteConditionRule', '#deleteConditionRule', function () {\n                let sheetIndex = $('#luckysheet-administerRule-dialog .chooseSheet option:selected').val();\n                if (!checkProtectionFormatCells(sheetIndex)) {\n                    return;\n                }\n                let itemIndex = $('#luckysheet-administerRule-dialog .ruleList .listBox .item.on').attr('data-item');\n                _this.fileClone[getSheetIndex(sheetIndex)]['luckysheet_conditionformat_save'].splice(itemIndex, 1);\n                _this.administerRuleDialog();\n            });    // 规则子菜单弹出层 点击确定修改样式\n            // 规则子菜单弹出层 点击确定修改样式\n            $(document).off('click.CFdefault').on('click.CFdefault', '#luckysheet-conditionformat-dialog-confirm', function () {\n                if (!checkProtectionFormatCells(Store.currentSheetIndex)) {\n                    return;\n                }    //条件名称\n                //条件名称\n                let conditionName = $('#luckysheet-conditionformat-dialog .box').attr('data-itemvalue');    //条件单元格\n                //条件单元格\n                let conditionRange = [];    //条件值\n                //条件值\n                let conditionValue = [];\n                if (conditionName == 'greaterThan' || conditionName == 'lessThan' || conditionName == 'equal' || conditionName == 'textContains') {\n                    let v = $('#luckysheet-conditionformat-dialog #conditionVal').val().trim();    //条件值是否是选区\n                    //条件值是否是选区\n                    let rangeArr = _this.getRangeByTxt(v);\n                    if (rangeArr.length > 1) {\n                        _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                        return;\n                    } else if (rangeArr.length == 1) {\n                        let r1 = rangeArr[0].row[0], r2 = rangeArr[0].row[1];\n                        let c1 = rangeArr[0].column[0], c2 = rangeArr[0].column[1];\n                        if (r1 == r2 && c1 == c2) {\n                            v = getcellvalue(r1, c1, Store.flowdata);\n                            conditionRange.push({\n                                'row': rangeArr[0].row,\n                                'column': rangeArr[0].column\n                            });\n                            conditionValue.push(v);\n                        } else {\n                            _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                            return;\n                        }\n                    } else if (rangeArr.length == 0) {\n                        if (isNaN(v) || v == '') {\n                            _this.infoDialog(conditionformat_Text.conditionValueCanOnly, '');\n                            return;\n                        } else {\n                            conditionValue.push(v);\n                        }\n                    }\n                } else if (conditionName == 'betweenness') {\n                    //介于\n                    let v1 = $('#luckysheet-conditionformat-dialog #conditionVal').val().trim();\n                    let v2 = $('#luckysheet-conditionformat-dialog #conditionVal2').val().trim();    //条件值是否是选区\n                    //条件值是否是选区\n                    let rangeArr1 = _this.getRangeByTxt(v1);\n                    if (rangeArr1.length > 1) {\n                        _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                        return;\n                    } else if (rangeArr1.length == 1) {\n                        let r1 = rangeArr1[0].row[0], r2 = rangeArr1[0].row[1];\n                        let c1 = rangeArr1[0].column[0], c2 = rangeArr1[0].column[1];\n                        if (r1 == r2 && c1 == c2) {\n                            v1 = getcellvalue(r1, c1, Store.flowdata);\n                            conditionRange.push({\n                                'row': rangeArr1[0].row,\n                                'column': rangeArr1[0].column\n                            });\n                            conditionValue.push(v1);\n                        } else {\n                            _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                            return;\n                        }\n                    } else if (rangeArr1.length == 0) {\n                        if (isNaN(v1) || v1 == '') {\n                            _this.infoDialog(conditionformat_Text.conditionValueCanOnly, '');\n                            return;\n                        } else {\n                            conditionValue.push(v1);\n                        }\n                    }\n                    let rangeArr2 = _this.getRangeByTxt(v2);\n                    if (rangeArr2.length > 1) {\n                        _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                        return;\n                    } else if (rangeArr2.length == 1) {\n                        let r1 = rangeArr2[0].row[0], r2 = rangeArr2[0].row[1];\n                        let c1 = rangeArr2[0].column[0], c2 = rangeArr2[0].column[1];\n                        if (r1 == r2 && c1 == c2) {\n                            v2 = getcellvalue(r1, c1, Store.flowdata);\n                            conditionRange.push({\n                                'row': rangeArr2[0].row,\n                                'column': rangeArr2[0].column\n                            });\n                            conditionValue.push(v2);\n                        } else {\n                            _this.infoDialog(conditionformat_Text.onlySingleCell, '');\n                            return;\n                        }\n                    } else if (rangeArr2.length == 0) {\n                        if (isNaN(v2) || v2 == '') {\n                            _this.infoDialog(conditionformat_Text.conditionValueCanOnly, '');\n                            return;\n                        } else {\n                            conditionValue.push(v2);\n                        }\n                    }\n                } else if (conditionName == 'occurrenceDate') {\n                    //日期\n                    let v = $('#luckysheet-conditionformat-dialog #daterange-btn').val();\n                    if (v == '' || v == null) {\n                        _this.infoDialog(conditionformat_Text.pleaseSelectADate, '');\n                        return;\n                    }\n                    conditionValue.push(v);\n                } else if (conditionName == 'duplicateValue') {\n                    //重复值\n                    conditionValue.push($('#luckysheet-conditionformat-dialog #conditionVal option:selected').val());\n                } else if (conditionName == 'top10' || conditionName == 'top10%' || conditionName == 'last10' || conditionName == 'last10%') {\n                    let v = $('#luckysheet-conditionformat-dialog #conditionVal').val().trim();\n                    if (parseInt(v) != v || parseInt(v) < 1 || parseInt(v) > 1000) {\n                        _this.infoDialog(conditionformat_Text.pleaseEnterInteger, '');\n                        return;\n                    }\n                    conditionValue.push(v);\n                } else if (conditionName == 'AboveAverage') {\n                    //高于平均值\n                    conditionValue.push('AboveAverage');\n                } else if (conditionName == 'SubAverage') {\n                    //低于平均值\n                    conditionValue.push('SubAverage');\n                }    //格式颜色\n                //格式颜色\n                let textcolor;\n                if ($('#checkTextColor').is(':checked')) {\n                    textcolor = $('#textcolorshow').spectrum('get').toHexString();\n                } else {\n                    textcolor = null;\n                }\n                let cellcolor;\n                if ($('#checkCellColor').is(':checked')) {\n                    cellcolor = $('#cellcolorshow').spectrum('get').toHexString();\n                } else {\n                    cellcolor = null;\n                }    //保存之前的规则\n                //保存之前的规则\n                let fileH = $.extend(true, [], Store.luckysheetfile);\n                let historyRules = _this.getHistoryRules(fileH);    //保存当前的规则\n                //保存当前的规则\n                let rule = {\n                    'type': 'default',\n                    'cellrange': $.extend(true, [], Store.luckysheet_select_save),\n                    'format': {\n                        'textColor': textcolor,\n                        'cellColor': cellcolor\n                    },\n                    'conditionName': conditionName,\n                    'conditionRange': conditionRange,\n                    'conditionValue': conditionValue\n                };\n                let ruleArr = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_conditionformat_save'] == undefined ? [] : Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_conditionformat_save'];\n                ruleArr.push(rule);\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_conditionformat_save'] = ruleArr;\n                let fileC = $.extend(true, [], Store.luckysheetfile);\n                let currentRules = _this.getCurrentRules(fileC); \n                //刷新一次表格\n                _this.ref(historyRules, currentRules); \n                //隐藏一些dom\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-conditionformat-dialog').hide(); \n                //发送给后台\n                if (Store.allowUpdate) {\n                    Store.saveParam('all', Store.currentSheetIndex, ruleArr, { 'k': 'luckysheet_conditionformat_save' });\n                }\n            }); \n            // 图标集弹出层 选择\n            $(document).off('click.CFicons').on('click.CFicons', '#luckysheet-CFicons-dialog .item', function () {\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-CFicons-dialog').hide();\n                if (Store.luckysheet_select_save.length > 0) {\n                    let cellrange = $.extend(true, [], Store.luckysheet_select_save);\n                    let format = {\n                        'len': $(this).attr('data-len'),\n                        'leftMin': $(this).attr('data-leftMin'),\n                        'top': $(this).attr('data-top')\n                    };\n                    _this.updateItem('icons', cellrange, format);\n                }\n            });    // 选择单元格\n            // 选择单元格\n            $(document).on('click', '.range .fa-table', function () {\n                let id = $(this).parents('.luckysheet-modal-dialog').attr('id');\n                $('#' + id).hide();    //入口\n                //入口\n                let source;\n                if (id == 'luckysheet-conditionformat-dialog') {\n                    let $id = $(this).siblings('input').attr('id');\n                    if ($id == 'conditionVal') {\n                        source = '0_1';\n                    } else {\n                        source = '0_2';\n                    }\n                } else if (id == 'luckysheet-newConditionRule-dialog') {\n                    let $id = $(this).parents('.range').attr('id');\n                    if ($id == 'formulaConditionVal') {\n                        source = '1_0';\n                    } else if ($id == 'conditionVal') {\n                        source = '1_1';\n                    } else {\n                        source = '1_2';\n                    }\n                } else if (id == 'luckysheet-editorConditionRule-dialog') {\n                    let $id = $(this).parents('.range').attr('id');\n                    if ($id == 'formulaConditionVal') {\n                        source = '2_0';\n                    } else if ($id == 'conditionVal') {\n                        source = '2_1';\n                    } else {\n                        source = '2_2';\n                    }\n                }    //input值\n                //input值\n                let v = $(this).siblings('input').val();\n                _this.singleRangeDialog(source, v);\n                selectionCopyShow(_this.getRangeByTxt(v));\n            });\n            $(document).on('click', '#luckysheet-singleRange-dialog-confirm', function () {\n                $('#luckysheet-modal-dialog-mask').show();\n                $(this).parents('#luckysheet-singleRange-dialog').hide();\n                let source = $(this).attr('data-source');\n                let v = $(this).parents('#luckysheet-singleRange-dialog').find('input').val();\n                if (source == '0_1') {\n                    $('#luckysheet-conditionformat-dialog').show();\n                    $('#luckysheet-conditionformat-dialog #conditionVal').val(v);\n                } else if (source == '0_2') {\n                    $('#luckysheet-conditionformat-dialog').show();\n                    $('#luckysheet-conditionformat-dialog #conditionVal2').val(v);\n                } else if (source == '1_0') {\n                    $('#luckysheet-newConditionRule-dialog').show();\n                    $('#luckysheet-newConditionRule-dialog #formulaConditionVal input').val(v);\n                } else if (source == '1_1') {\n                    $('#luckysheet-newConditionRule-dialog').show();\n                    $('#luckysheet-newConditionRule-dialog #conditionVal input').val(v);\n                } else if (source == '1_2') {\n                    $('#luckysheet-newConditionRule-dialog').show();\n                    $('#luckysheet-newConditionRule-dialog #conditionVal2 input').val(v);\n                } else if (source == '2_0') {\n                    $('#luckysheet-editorConditionRule-dialog').show();\n                    $('#luckysheet-editorConditionRule-dialog #formulaConditionVal input').val(v);\n                } else if (source == '2_1') {\n                    $('#luckysheet-editorConditionRule-dialog').show();\n                    $('#luckysheet-editorConditionRule-dialog #conditionVal input').val(v);\n                } else if (source == '2_2') {\n                    $('#luckysheet-editorConditionRule-dialog').show();\n                    $('#luckysheet-editorConditionRule-dialog #conditionVal2 input').val(v);\n                }\n                let range = [];\n                selectionCopyShow(range);\n            });\n            $(document).on('click', '#luckysheet-singleRange-dialog-close', function () {\n                $('#luckysheet-modal-dialog-mask').show();\n                $(this).parents('#luckysheet-singleRange-dialog').hide();\n                let source = $(this).attr('data-source');\n                if (source == '0_1' || source == '0_2') {\n                    $('#luckysheet-conditionformat-dialog').show();\n                } else if (source == '1_0' || source == '1_1' || source == '1_2') {\n                    $('#luckysheet-newConditionRule-dialog').show();\n                } else if (source == '2_0' || source == '2_1' || source == '2_2') {\n                    $('#luckysheet-editorConditionRule-dialog').show();\n                }\n                let range = [];\n                selectionCopyShow(range);\n            });    // 弹出层右上角关闭按钮\n            // 弹出层右上角关闭按钮\n            $(document).on('click', '.luckysheet-modal-dialog-title-close', function () {\n                let id = $(this).parents('.luckysheet-modal-dialog').attr('id');    //新建规则弹出层\n                //新建规则弹出层\n                if (id == 'luckysheet-newConditionRule-dialog') {\n                    let source = $('#' + id).find('#luckysheet-newConditionRule-dialog-close').attr('data-source');    //新建规则入口\n                    //新建规则入口\n                    if (source == 1) {\n                        $('#luckysheet-administerRule-dialog').show();\n                    }\n                }    //编辑规则弹出层\n                //编辑规则弹出层\n                if (id == 'luckysheet-editorConditionRule-dialog') {\n                    $('#luckysheet-administerRule-dialog').show();\n                }    //选择单元格弹出层\n                //选择单元格弹出层\n                if (id == 'luckysheet-singleRange-dialog') {\n                    $('#luckysheet-modal-dialog-mask').show();\n                    let source = $(this).parents('#luckysheet-singleRange-dialog').find('#luckysheet-singleRange-dialog-confirm').attr('data-source');\n                    if (source == '0_1' || source == '0_2') {\n                        $('#luckysheet-conditionformat-dialog').show();\n                    } else if (source == '1_1' || source == '1_2') {\n                        $('#luckysheet-newConditionRule-dialog').show();\n                    } else if (source == '2_1' || source == '2_2') {\n                        $('#luckysheet-editorConditionRule-dialog').show();\n                    }\n                    let range = [];\n                    selectionCopyShow(range);\n                }    //选择应用范围弹出层\n                //选择应用范围弹出层\n                if (id == 'luckysheet-multiRange-dialog') {\n                    $('#luckysheet-modal-dialog-mask').show();\n                    $('#luckysheet-administerRule-dialog').show();\n                    let range = [];\n                    selectionCopyShow(range);\n                }    //提示框\n                //提示框\n                if (id == 'luckysheet-conditionformat-info-dialog') {\n                    $('#luckysheet-modal-dialog-mask').show();\n                }\n            });    //提示框\n            //提示框\n            $(document).on('click', '#luckysheet-conditionformat-info-dialog-close', function () {\n                $(this).parents('#luckysheet-conditionformat-info-dialog').hide();\n            });\n        },\n        singleRangeDialog: function (source, value) {\n            $('#luckysheet-modal-dialog-mask').hide();\n            $('#luckysheet-singleRange-dialog').remove();\n            const conditionformat_Text = locale().conditionformat;\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-singleRange-dialog',\n                'addclass': 'luckysheet-singleRange-dialog',\n                'title': conditionformat_Text.selectCell,\n                'content': `<input readonly=\"readonly\" placeholder=\"${ conditionformat_Text.pleaseSelectCell }\" value=\"${ value }\"/>`,\n                'botton': `<button id=\"luckysheet-singleRange-dialog-confirm\" class=\"btn btn-primary\" data-source=\"${ source }\">${ conditionformat_Text.confirm }</button>\n                        <button id=\"luckysheet-singleRange-dialog-close\" class=\"btn btn-default\" data-source=\"${ source }\">${ conditionformat_Text.cancel }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-singleRange-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-singleRange-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n        },\n        multiRangeDialog: function (dataItem, value) {\n            let _this = this;\n            $('#luckysheet-modal-dialog-mask').hide();\n            $('#luckysheet-multiRange-dialog').remove();\n            const conditionformat_Text = locale().conditionformat;\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-multiRange-dialog',\n                'addclass': 'luckysheet-multiRange-dialog',\n                'title': conditionformat_Text.selectRange,\n                'content': `<input readonly=\"readonly\" placeholder=\"${ conditionformat_Text.pleaseSelectRange }\" value=\"${ value }\"/>`,\n                'botton': `<button id=\"luckysheet-multiRange-dialog-confirm\" class=\"btn btn-primary\" data-item=\"${ dataItem }\">${ conditionformat_Text.confirm }</button>\n                        <button id=\"luckysheet-multiRange-dialog-close\" class=\"btn btn-default\">${ conditionformat_Text.cancel }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-multiRange-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-multiRange-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n            selectionCopyShow(_this.getRangeByTxt(value));\n        },\n        colorSelectInit: function () {\n            const conditionformat_Text = locale().conditionformat;\n            $('.luckysheet-conditionformat-config-color').spectrum({\n                showPalette: true,\n                showPaletteOnly: true,\n                preferredFormat: 'hex',\n                clickoutFiresChange: false,\n                showInitial: true,\n                showInput: true,\n                // flat: true,\n                hideAfterPaletteSelect: true,\n                showSelectionPalette: true,\n                // showButtons: false,//隐藏选择取消按钮\n                maxPaletteSize: 8,\n                maxSelectionSize: 8,\n                // color: currenColor,\n                cancelText: conditionformat_Text.cancel,\n                chooseText: conditionformat_Text.confirmColor,\n                togglePaletteMoreText: '自定义',\n                togglePaletteLessText: '收起',\n                togglePaletteOnly: true,\n                clearText: conditionformat_Text.clearColorSelect,\n                noColorSelectedText: '没有颜色被选择',\n                localStorageKey: 'spectrum.textcolor' + Store.gridKey,\n                palette: [\n                    [\n                        '#000',\n                        '#444',\n                        '#666',\n                        '#999',\n                        '#ccc',\n                        '#eee',\n                        '#f3f3f3',\n                        '#fff'\n                    ],\n                    [\n                        '#f00',\n                        '#f90',\n                        '#ff0',\n                        '#0f0',\n                        '#0ff',\n                        '#00f',\n                        '#90f',\n                        '#f0f'\n                    ],\n                    [\n                        '#f4cccc',\n                        '#fce5cd',\n                        '#fff2cc',\n                        '#d9ead3',\n                        '#d0e0e3',\n                        '#cfe2f3',\n                        '#d9d2e9',\n                        '#ead1dc'\n                    ],\n                    [\n                        '#ea9999',\n                        '#f9cb9c',\n                        '#ffe599',\n                        '#b6d7a8',\n                        '#a2c4c9',\n                        '#9fc5e8',\n                        '#b4a7d6',\n                        '#d5a6bd'\n                    ],\n                    [\n                        '#e06666',\n                        '#f6b26b',\n                        '#ffd966',\n                        '#93c47d',\n                        '#76a5af',\n                        '#6fa8dc',\n                        '#8e7cc3',\n                        '#c27ba0'\n                    ],\n                    [\n                        '#c00',\n                        '#e69138',\n                        '#f1c232',\n                        '#6aa84f',\n                        '#45818e',\n                        '#3d85c6',\n                        '#674ea7',\n                        '#a64d79'\n                    ],\n                    [\n                        '#900',\n                        '#b45f06',\n                        '#bf9000',\n                        '#38761d',\n                        '#134f5c',\n                        '#0b5394',\n                        '#351c75',\n                        '#741b47'\n                    ],\n                    [\n                        '#600',\n                        '#783f04',\n                        '#7f6000',\n                        '#274e13',\n                        '#0c343d',\n                        '#073763',\n                        '#20124d',\n                        '#4c1130'\n                    ]\n                ],\n                change: function (color) {\n                    if (color != null) {\n                        color = color.toHexString();\n                    }\n                }\n            });\n        },\n        conditionformatDialog: function (title, content) {\n            let _this = this;\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-conditionformat-dialog').remove();\n            const conditionformat_Text = locale().conditionformat;\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-conditionformat-dialog',\n                'addclass': 'luckysheet-conditionformat-dialog',\n                'title': title,\n                'content': content,\n                'botton': `<button id=\"luckysheet-conditionformat-dialog-confirm\" class=\"btn btn-primary\">${ conditionformat_Text.confirm }</button>\n                        <button class=\"btn btn-default luckysheet-model-close-btn\">${ conditionformat_Text.cancel }</button>`,\n                'style': 'z-index:9999'\n            }));\n            let $t = $('#luckysheet-conditionformat-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-conditionformat-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n            _this.init();\n            _this.colorSelectInit();\n            if (title == locale().conditionformat.conditionformat_occurrenceDate) {\n                _this.daterangeInit('luckysheet-conditionformat-dialog');\n            }\n        },\n        CFiconsDialog: function () {\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-CFicons-dialog').remove();\n            const conditionformat_Text = locale().conditionformat;\n            let content = `<div class=\"box\">\n                            <div style=\"margin-bottom: 10px;\">${ conditionformat_Text.pleaseSelectIcon }</div>\n                            <div class=\"title\">${ conditionformat_Text.direction }</div>\n                            <div class=\"list\">\n                                <div class=\"left\">\n                                    <div class=\"item\" data-len=\"3\" data-leftMin=\"0\" data-top=\"0\" title=\"${ conditionformat_Text.threeWayArrow }(${ conditionformat_Text.multicolor })\"><div style=\"background-position:0 0;\"></div></div>\n                                    <div class=\"item\" data-len=\"3\" data-leftMin=\"0\" data-top=\"1\" title=\"${ conditionformat_Text.threeTriangles }\"><div style=\"background-position:0 -20px;\"></div></div>\n                                    <div class=\"item\" data-len=\"4\" data-leftMin=\"0\" data-top=\"2\" title=\"${ conditionformat_Text.fourWayArrow }(${ conditionformat_Text.multicolor })\"><div style=\"background-position:0 -40px;\"></div></div>\n                                    <div class=\"item\" data-len=\"5\" data-leftMin=\"0\" data-top=\"3\" title=\"${ conditionformat_Text.fiveWayArrow }(${ conditionformat_Text.multicolor })\"><div style=\"background-position:0 -60px;\"></div></div>\n                                </div>\n                                <div class=\"right\">\n                                    <div class=\"item\" data-len=\"3\" data-leftMin=\"5\" data-top=\"0\" title=\"${ conditionformat_Text.threeWayArrow }(${ conditionformat_Text.grayColor })\"><div style=\"background-position:-131px 0;\"></div></div>\n                                    <div class=\"item\" data-len=\"4\" data-leftMin=\"5\" data-top=\"1\" title=\"${ conditionformat_Text.fourWayArrow }(${ conditionformat_Text.grayColor })\"><div style=\"background-position:-131px -20px;\"></div></div>\n                                    <div class=\"item\" data-len=\"5\" data-leftMin=\"5\" data-top=\"2\" title=\"${ conditionformat_Text.fiveWayArrow }(${ conditionformat_Text.grayColor })\"><div style=\"background-position:-131px -40px;\"></div></div>\n                                </div>\n                                <div style=\"clear:both;\"></div>\n                            </div>\n                            <div class=\"title\">${ conditionformat_Text.shape }</div>\n                            <div class=\"list\">\n                                <div class=\"left\">\n                                    <div class=\"item\" data-len=\"3\" data-leftMin=\"0\" data-top=\"4\" title=\"${ conditionformat_Text.threeColorTrafficLight }(${ conditionformat_Text.rimless })\"><div style=\"background-position:0 -80px;\"></div></div>\n                                    <div class=\"item\" data-len=\"3\" data-leftMin=\"0\" data-top=\"5\" title=\"${ conditionformat_Text.threeSigns }\"><div style=\"background-position:0 -100px;\"></div></div>\n                                    <div class=\"item\" data-len=\"4\" data-leftMin=\"0\" data-top=\"6\" title=\"${ conditionformat_Text.greenRedBlackGradient }\"><div style=\"background-position:0 -120px;\"></div></div>\n                                </div>\n                                <div class=\"right\">\n                                    <div class=\"item\" data-len=\"3\" data-leftMin=\"5\" data-top=\"4\" title=\"${ conditionformat_Text.threeColorTrafficLight }(${ conditionformat_Text.bordered })\"><div style=\"background-position:-131px -80px;\"></div></div>\n                                    <div class=\"item\" data-len=\"4\" data-leftMin=\"5\" data-top=\"5\" title=\"${ conditionformat_Text.fourColorTrafficLight }\"><div style=\"background-position:-131px -100px;\"></div></div>\n                                </div>\n                                <div style=\"clear:both;\"></div>\n                            </div>\n                            <div class=\"title\">${ conditionformat_Text.mark }</div>\n                            <div class=\"list\">\n                                <div class=\"left\">\n                                    <div class=\"item\" data-len=\"3\" data-leftMin=\"0\" data-top=\"7\" title=\"${ conditionformat_Text.threeSymbols }(${ conditionformat_Text.circled })\"><div style=\"background-position:0 -140px;\"></div></div>\n                                    <div class=\"item\" data-len=\"3\" data-leftMin=\"0\" data-top=\"8\" title=\"${ conditionformat_Text.tricolorFlag }\"><div style=\"background-position:0 -160px;\"></div></div>\n                                </div>\n                                <div class=\"right\">\n                                    <div class=\"item\" data-len=\"3\" data-leftMin=\"5\" data-top=\"7\" title=\"${ conditionformat_Text.threeSymbols }(${ conditionformat_Text.noCircle })\"><div style=\"background-position:-131px -140px;\"></div></div>\n                                </div>\n                                <div style=\"clear:both;\"></div>\n                            </div>\n                            <div class=\"title\">${ conditionformat_Text.grade }</div>\n                            <div class=\"list\">\n                                <div class=\"left\">\n                                    <div class=\"item\" data-len=\"3\" data-leftMin=\"0\" data-top=\"9\" title=\"${ conditionformat_Text.threeStars }\"><div style=\"background-position:0 -180px;\"></div></div>\n                                    <div class=\"item\" data-len=\"5\" data-leftMin=\"0\" data-top=\"10\" title=\"${ conditionformat_Text.fiveQuadrantDiagram }\"><div style=\"background-position:0 -200px;\"></div></div>\n                                    <div class=\"item\" data-len=\"5\" data-leftMin=\"0\" data-top=\"11\" title=\"${ conditionformat_Text.fiveBoxes }\"><div style=\"background-position:0 -220px;\"></div></div>\n                                </div>\n                                <div class=\"right\">\n                                    <div class=\"item\" data-len=\"4\" data-leftMin=\"5\" data-top=\"9\" title=\"${ conditionformat_Text.grade4 }\"><div style=\"background-position:-131px -180px;\"></div></div>\n                                    <div class=\"item\" data-len=\"5\" data-leftMin=\"5\" data-top=\"10\" title=\"${ conditionformat_Text.grade5 }\"><div style=\"background-position:-131px -200px;\"></div></div>\n                                </div>\n                                <div style=\"clear:both;\"></div>\n                            </div>\n                        </div>`;\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-CFicons-dialog',\n                'addclass': 'luckysheet-CFicons-dialog',\n                'title': conditionformat_Text.icons,\n                'content': content,\n                'botton': `<button class=\"btn btn-default luckysheet-model-close-btn\">${ conditionformat_Text.close }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-CFicons-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 400).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-CFicons-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n        },\n        administerRuleDialog: function () {\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-administerRule-dialog').remove();\n            const conditionformat_Text = locale().conditionformat;    //工作表\n            //工作表\n            let opHtml = '';\n            for (let j = 0; j < Store.luckysheetfile.length; j++) {\n                if (Store.luckysheetfile[j].status == '1') {\n                    opHtml += `<option value=\"${ Store.luckysheetfile[j]['index'] }\" selected=\"selected\">\n                                ${ conditionformat_Text.currentSheet }：${ Store.luckysheetfile[j]['name'] }\n                            </option>`;\n                } else {\n                    opHtml += `<option value=\"${ Store.luckysheetfile[j]['index'] }\">\n                                ${ conditionformat_Text.sheet }：${ Store.luckysheetfile[j]['name'] }\n                            </option>`;\n                }\n            }\n            let content = `<div class=\"chooseSheet\">\n                            <label>${ conditionformat_Text.showRules }：</label>\n                            <select>${ opHtml }</select>\n                        </div>\n                        <div class=\"ruleBox\">\n                            <div class=\"ruleBtn\">\n                                <button id=\"newConditionRule\" class=\"btn btn-default\">${ conditionformat_Text.newRule }</button>\n                                <button id=\"editorConditionRule\" class=\"btn btn-default\">${ conditionformat_Text.editRule }</button>\n                                <button id=\"deleteConditionRule\" class=\"btn btn-default\">${ conditionformat_Text.deleteRule }</button>\n                            </div>\n                            <div class=\"ruleList\">\n                                <div class=\"listTitle\">\n                                    <span>${ conditionformat_Text.rule }</span>\n                                    <span>${ conditionformat_Text.format }</span>\n                                    <span>${ conditionformat_Text.applyRange }</span>\n                                </div>\n                                <div class=\"listBox\"></div>\n                            </div>\n                        </div>`;\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-administerRule-dialog',\n                'addclass': 'luckysheet-administerRule-dialog',\n                'title': conditionformat_Text.conditionformatManageRules,\n                'content': content,\n                'botton': `<button id=\"luckysheet-administerRule-dialog-confirm\" class=\"btn btn-primary\">${ conditionformat_Text.confirm }</button>\n                        <button id=\"luckysheet-administerRule-dialog-close\" class=\"btn btn-default\">${ conditionformat_Text.close }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-administerRule-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 400).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-administerRule-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();    //当前工作表的规则列表\n            //当前工作表的规则列表\n            let index = $('#luckysheet-administerRule-dialog .chooseSheet option:selected').val();\n            this.getConditionRuleList(index);\n        },\n        getConditionRuleList: function (index) {\n            let _this = this;\n            $('#luckysheet-administerRule-dialog .ruleList .listBox').empty();\n            let ruleArr = _this.fileClone[getSheetIndex(index)].luckysheet_conditionformat_save;    //条件格式规则集合\n            //条件格式规则集合\n            if (ruleArr != null && ruleArr.length > 0) {\n                const conditionformat_Text = locale().conditionformat;\n                for (let i = 0; i < ruleArr.length; i++) {\n                    let type = ruleArr[i]['type'];    //规则类型\n                    //规则类型\n                    let format = ruleArr[i]['format'];    //规则样式\n                    //规则样式\n                    let cellrange = ruleArr[i]['cellrange'];    //规则应用范围\n                    //规则应用范围\n                    let ruleName;    //规则名称\n                    //规则名称\n                    let formatHtml = '';    //样式dom\n                    //样式dom\n                    if (type == 'dataBar') {\n                        ruleName = conditionformat_Text.dataBar;\n                        formatHtml = '<canvas width=\"46\" height=\"18\" style=\"width: 46px;height: 18px;margin: 3px 0 0 5px;\"></canvas>';\n                    } else if (type == 'colorGradation') {\n                        ruleName = conditionformat_Text.colorGradation;\n                        formatHtml = '<canvas width=\"46\" height=\"18\" style=\"width: 46px;height: 18px;margin: 3px 0 0 5px;\"></canvas>';\n                    } else if (type == 'icons') {\n                        ruleName = conditionformat_Text.icons;\n                        formatHtml = '<canvas width=\"46\" height=\"18\" style=\"width: 46px;height: 18px;margin: 3px 0 0 5px;\"></canvas>';\n                    } else {\n                        ruleName = _this.getConditionRuleName(ruleArr[i].conditionName, ruleArr[i].conditionRange, ruleArr[i].conditionValue);\n                        if (format['textColor'] != null) {\n                            formatHtml += '<span class=\"colorbox\" title=\"' + conditionformat_Text.textColor + '\" style=\"background-color:' + format['textColor'] + '\"></span>';\n                        }\n                        if (format['cellColor'] != null) {\n                            formatHtml += '<span class=\"colorbox\" title=\"' + conditionformat_Text.cellColor + '\" style=\"background-color:' + format['cellColor'] + '\"></span>';\n                        }\n                    }    //应用范围dom\n                    //应用范围dom\n                    let rangeTxtArr = [];\n                    for (let s = 0; s < cellrange.length; s++) {\n                        let r1 = cellrange[s].row[0], r2 = cellrange[s].row[1];\n                        let c1 = cellrange[s].column[0], c2 = cellrange[s].column[1];\n                        rangeTxtArr.push(chatatABC(c1) + (r1 + 1) + ':' + chatatABC(c2) + (r2 + 1));\n                    }    //条件格式规则列表dom\n                    //条件格式规则列表dom\n                    let itemHtml = '<div class=\"item\" data-item=\"' + i + '\">' + '<div class=\"ruleName\" title=\"' + ruleName + '\">' + ruleName + '</div>' + '<div class=\"format\">' + formatHtml + '</div>' + '<div class=\"ruleRange\">' + '<input class=\"formulaInputFocus\" readonly=\"true\" value=\"' + rangeTxtArr.join(',') + '\"/>' + '<i class=\"fa fa-table\" aria-hidden=\"true\" title=\"' + conditionformat_Text.selectRange + '\"></i>' + '</div>' + '</div>';\n                    $('#luckysheet-administerRule-dialog .ruleList .listBox').prepend(itemHtml);\n                }\n                $('#luckysheet-administerRule-dialog .ruleList .listBox .item canvas').each(function (i) {\n                    let x = $(this).closest('.item').attr('data-item');\n                    let type = ruleArr[x]['type'];\n                    let format = ruleArr[x]['format'];\n                    let can = $(this).get(0).getContext('2d');\n                    if (type == 'dataBar') {\n                        if (format.length == 2) {\n                            let my_gradient = can.createLinearGradient(0, 0, 46, 0);\n                            my_gradient.addColorStop(0, format[0]);\n                            my_gradient.addColorStop(1, format[1]);\n                            can.fillStyle = my_gradient;\n                            can.fillRect(0, 0, 46, 18);\n                            can.beginPath();\n                            can.moveTo(0, 0);\n                            can.lineTo(0, 18);\n                            can.lineTo(46, 18);\n                            can.lineTo(46, 0);\n                            can.lineTo(0, 0);\n                            can.lineWidth = Store.devicePixelRatio;\n                            can.strokeStyle = format[0];\n                            can.stroke();\n                            can.closePath();\n                        } else if (format.length == 1) {\n                            can.fillStyle = format[0];\n                            can.fillRect(0, 0, 46, 18);\n                            can.beginPath();\n                            can.moveTo(0, 0);\n                            can.lineTo(0, 18);\n                            can.lineTo(46, 18);\n                            can.lineTo(46, 0);\n                            can.lineTo(0, 0);\n                            can.lineWidth = Store.devicePixelRatio;\n                            can.strokeStyle = format[0];\n                            can.stroke();\n                            can.closePath();\n                        }\n                    } else if (type == 'colorGradation') {\n                        let my_gradient = can.createLinearGradient(0, 0, 46, 0);\n                        if (format.length == 3) {\n                            my_gradient.addColorStop(0, format[0]);\n                            my_gradient.addColorStop(0.5, format[1]);\n                            my_gradient.addColorStop(1, format[2]);\n                        } else if (format.length == 2) {\n                            my_gradient.addColorStop(0, format[0]);\n                            my_gradient.addColorStop(1, format[1]);\n                        }\n                        can.fillStyle = my_gradient;\n                        can.fillRect(0, 0, 46, 18);\n                    } else if (type == 'icons') {\n                        let len = format['len'];\n                        let l = format['leftMin'];\n                        let t = format['top'];\n                        let w1 = 32 * len + 10 * (len - 1);\n                        let h1 = 32;\n                        let w2 = 46;\n                        let h2 = 46 * 32 / w1;\n                        if (l == '0') {\n                            can.drawImage(luckysheet_CFiconsImg, 0, t * 32, w1, h1, 0, (18 - h2) / 2, w2, h2);\n                        } else if (l == '5') {\n                            can.drawImage(luckysheet_CFiconsImg, 210, t * 32, w1, h1, 0, (18 - h2) / 2, w2, h2);\n                        }\n                    }\n                });\n                $('#luckysheet-administerRule-dialog .ruleList .listBox .item').eq(0).addClass('on');\n            }\n        },\n        newConditionRuleDialog: function (source) {\n            let _this = this;\n            const conditionformat_Text = locale().conditionformat;    //规则说明\n            //规则说明\n            let ruleExplainHtml = _this.getRuleExplain(0);    //弹出层\n            //弹出层\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-administerRule-dialog').hide();\n            $('#luckysheet-newConditionRule-dialog').remove();\n            let content = '<div>' + '<div class=\"boxTitle\">' + conditionformat_Text.chooseRuleType + '\\uFF1A</div>' + _this.ruleTypeHtml() + '<div class=\"boxTitle\">' + conditionformat_Text.editRuleDescription + '\\uFF1A</div>' + '<div class=\"ruleExplainBox\">' + ruleExplainHtml + '</div>' + '</div>';\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-newConditionRule-dialog',\n                'addclass': 'luckysheet-newEditorRule-dialog',\n                'title': conditionformat_Text.newFormatRule,\n                'content': content,\n                'botton': `<button id=\"luckysheet-newConditionRule-dialog-confirm\" class=\"btn btn-primary\" data-source=\"${ source }\">${ conditionformat_Text.confirm }</button>\n                        <button id=\"luckysheet-newConditionRule-dialog-close\" class=\"btn btn-default\" data-source=\"${ source }\">${ conditionformat_Text.cancel }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-newConditionRule-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 400).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-newConditionRule-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();    //index的规则类型focus\n            //index的规则类型focus\n            $('#luckysheet-newConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq(0)').addClass('on').siblings().removeClass('on');\n            _this.colorSelectInit();\n        },\n        editorConditionRuleDialog: function () {\n            let _this = this;\n            const conditionformat_Text = locale().conditionformat;\n            let rule = _this.editorRule.data;\n            if (rule == null) {\n                return;\n            }\n            let ruleType = rule['type'], ruleFormat = rule['format'], conditionName = rule['conditionName'];\n            let index, type1;\n            if (ruleType == 'dataBar' || ruleType == 'colorGradation' || ruleType == 'icons') {\n                index = 0;\n                type1 = ruleType;\n            } else {\n                if (conditionName == 'greaterThan' || conditionName == 'lessThan' || conditionName == 'betweenness' || conditionName == 'equal' || conditionName == 'textContains' || conditionName == 'occurrenceDate') {\n                    index = 1;\n                    if (conditionName == 'greaterThan' || conditionName == 'lessThan' || conditionName == 'betweenness' || conditionName == 'equal') {\n                        type1 = 'number';\n                    } else if (conditionName == 'textContains') {\n                        type1 = 'text';\n                    } else if (conditionName == 'occurrenceDate') {\n                        type1 = 'date';\n                    }\n                } else if (conditionName == 'top10' || conditionName == 'top10%' || conditionName == 'last10' || conditionName == 'last10%') {\n                    index = 2;\n                    if (conditionName == 'top10' || conditionName == 'top10%') {\n                        type1 = 'top';\n                    } else if (conditionName == 'last10' || conditionName == 'last10%') {\n                        type1 = 'last';\n                    }\n                } else if (conditionName == 'AboveAverage' || conditionName == 'SubAverage') {\n                    index = 3;\n                    type1 = conditionName;\n                } else if (conditionName == 'duplicateValue') {\n                    index = 4;\n                    type1 = rule['conditionValue'];\n                } else if (conditionName == 'formula') {\n                    index = 5;\n                }\n            }    //规则说明\n            //规则说明\n            let ruleExplainHtml = _this.getRuleExplain(index);    //弹出层\n            //弹出层\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-administerRule-dialog').hide();\n            $('#luckysheet-editorConditionRule-dialog').remove();\n            let content = '<div>' + '<div class=\"boxTitle\">' + conditionformat_Text.chooseRuleType + '\\uFF1A</div>' + _this.ruleTypeHtml() + '<div class=\"boxTitle\">' + conditionformat_Text.editRuleDescription + '\\uFF1A</div>' + '<div class=\"ruleExplainBox\">' + ruleExplainHtml + '</div>' + '</div>';\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-editorConditionRule-dialog',\n                'addclass': 'luckysheet-newEditorRule-dialog',\n                'title': conditionformat_Text.editFormatRule,\n                'content': content,\n                'botton': `<button id=\"luckysheet-editorConditionRule-dialog-confirm\" class=\"btn btn-primary\">${ conditionformat_Text.confirm }</button>\n                        <button id=\"luckysheet-editorConditionRule-dialog-close\" class=\"btn btn-default\">${ conditionformat_Text.cancel }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-editorConditionRule-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 400).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-editorConditionRule-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n            _this.colorSelectInit();    //规则类型focus\n            //规则类型focus\n            $('#luckysheet-editorConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq(' + index + ')').addClass('on').siblings().removeClass('on');    //type1\n            //type1\n            $('#luckysheet-editorConditionRule-dialog #type1').val(type1);\n            if (type1 == 'dataBar' || type1 == 'colorGradation' || type1 == 'icons' || type1 == 'number' || type1 == 'text' || type1 == 'date') {\n                $('#luckysheet-editorConditionRule-dialog .' + type1 + 'Box').show();\n                $('#luckysheet-editorConditionRule-dialog .' + type1 + 'Box').siblings().hide();\n            }\n            if (type1 == 'date') {\n                _this.daterangeInit('luckysheet-editorConditionRule-dialog');\n            }    //type2  format  value\n            //type2  format  value\n            if (ruleType == 'dataBar' || ruleType == 'colorGradation' || ruleType == 'icons') {\n                if (type1 == 'dataBar') {\n                    if (ruleFormat.length == 2) {\n                        $('#luckysheet-editorConditionRule-dialog .dataBarBox #type2').val('gradient');\n                    } else if (ruleFormat.length == 1) {\n                        $('#luckysheet-editorConditionRule-dialog .dataBarBox #type2').val('solid');\n                    }\n                    $('#luckysheet-editorConditionRule-dialog .dataBarBox .luckysheet-conditionformat-config-color').spectrum('set', ruleFormat[0]);\n                } else if (type1 == 'colorGradation') {\n                    if (ruleFormat.length == 3) {\n                        $('#luckysheet-editorConditionRule-dialog .colorGradationBox #type2').val('threeColor');\n                        $('#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal').show();\n                        $('#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color').spectrum('set', ruleFormat[0]);\n                        $('#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal .luckysheet-conditionformat-config-color').spectrum('set', ruleFormat[1]);\n                        $('#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color').spectrum('set', ruleFormat[2]);\n                    } else if (ruleFormat.length == 2) {\n                        $('#luckysheet-editorConditionRule-dialog .colorGradationBox #type2').val('twoColor');\n                        $('#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal').hide();\n                        $('#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color').spectrum('set', ruleFormat[0]);\n                        $('#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color').spectrum('set', ruleFormat[1]);\n                    }\n                } else if (type1 == 'icons') {\n                    let len = ruleFormat['len'];\n                    let l = ruleFormat['leftMin'];\n                    let t = ruleFormat['top'];\n                    $('#luckysheet-editorConditionRule-dialog .iconsBox li').each(function (i, e) {\n                        if ($(e).find('div').attr('data-len') == len && $(e).find('div').attr('data-leftmin') == l && $(e).find('div').attr('data-top') == t) {\n                            $('#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model').css('background-position', $(e).find('div').css('background-position'));\n                            $('#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model').attr('data-len', $(e).find('div').attr('data-len'));\n                            $('#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model').attr('data-leftmin', $(e).find('div').attr('data-leftmin'));\n                            $('#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model').attr('data-top', $(e).find('div').attr('data-leftmin'));\n                            $('#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model').attr('title', $(e).find('div').attr('title'));\n                            return true;\n                        }\n                    });\n                }\n            } else {\n                if (type1 == 'number') {\n                    $('#luckysheet-editorConditionRule-dialog .numberBox #type2').val(conditionName);\n                    let val1;\n                    if (rule.conditionRange[0] != null) {\n                        val1 = getRangetxt(Store.currentSheetIndex, {\n                            'row': rule.conditionRange[0]['row'],\n                            'column': rule.conditionRange[0]['column']\n                        }, Store.currentSheetIndex);\n                    } else {\n                        val1 = rule.conditionValue[0];\n                    }\n                    $('#luckysheet-editorConditionRule-dialog .numberBox #conditionVal input').val(val1);\n                    if (conditionName == 'betweenness') {\n                        $('#luckysheet-editorConditionRule-dialog .numberBox .txt').show();\n                        $('#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2').show();\n                        let val2;\n                        if (rule.conditionRange[1] != null) {\n                            val2 = getRangetxt(Store.currentSheetIndex, {\n                                'row': rule.conditionRange[1]['row'],\n                                'column': rule.conditionRange[1]['column']\n                            }, Store.currentSheetIndex);\n                        } else {\n                            val2 = rule.conditionValue[1];\n                        }\n                        $('#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2 input').val(val2);\n                    } else {\n                        $('#luckysheet-editorConditionRule-dialog .numberBox .txt').hide();\n                        $('#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2').hide();\n                    }\n                } else if (type1 == 'text') {\n                    let val1;\n                    if (rule.conditionRange[0] != null) {\n                        val1 = getRangetxt(Store.currentSheetIndex, {\n                            'row': rule.conditionRange[0]['row'],\n                            'column': rule.conditionRange[0]['column']\n                        }, Store.currentSheetIndex);\n                    } else {\n                        val1 = rule.conditionValue[0];\n                    }\n                    $('#luckysheet-editorConditionRule-dialog .textBox #conditionVal input').val(val1);\n                } else if (type1 == 'date') {\n                    _this.daterangeInit('luckysheet-editorConditionRule-dialog');\n                    let val1 = rule.conditionValue[0];\n                    $('#luckysheet-editorConditionRule-dialog .dateBox #daterange-btn').val(val1);\n                } else if (type1 == 'top' || type1 == 'last') {\n                    let val1 = rule.conditionValue[0];\n                    if (conditionName == 'top10%' || conditionName == 'last10%') {\n                        $('#luckysheet-editorConditionRule-dialog #isPercent').attr('checked', 'checked');\n                    }\n                } else {\n                    if (conditionName == 'formula') {\n                        let val1 = rule.conditionValue[0];\n                        $('#luckysheet-editorConditionRule-dialog #formulaConditionVal input').val(val1);\n                    }\n                }\n                $('#luckysheet-editorConditionRule-dialog #textcolorshow').spectrum('set', ruleFormat.textColor);\n                $('#luckysheet-editorConditionRule-dialog #cellcolorshow').spectrum('set', ruleFormat.cellColor);\n            }\n        },\n        infoDialog: function (title, content) {\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-conditionformat-info-dialog').remove();\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-conditionformat-info-dialog',\n                'addclass': '',\n                'title': title,\n                'content': content,\n                'botton': `<button id=\"luckysheet-conditionformat-info-dialog-close\" class=\"btn btn-default\">${ locale().conditionformat.close }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-conditionformat-info-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-conditionformat-info-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n        },\n        getRuleExplain: function (index) {\n            const conditionformat_Text = locale().conditionformat;\n            let textCellColorHtml = this.textCellColorHtml();\n            let ruleExplainHtml;\n            switch (index) {\n            case 0:\n                //基于各自值设置所有单元格的格式\n                ruleExplainHtml = `<div class=\"title\">${ conditionformat_Text.ruleTypeItem1 }：</div>\n                                    <div style=\"height: 30px;margin-bottom: 5px;\">\n                                        <label style=\"display: block;width: 80px;height: 30px;line-height: 30px;float: left;\">${ conditionformat_Text.formatStyle }：</label>\n                                        <select id=\"type1\">\n                                            <option value=\"dataBar\">${ conditionformat_Text.dataBar }</option>\n                                            <option value=\"colorGradation\">${ conditionformat_Text.colorGradation }</option>\n                                            <option value=\"icons\">${ conditionformat_Text.icons }</option>\n                                        </select>\n                                    </div>\n                                    <div>\n                                        <div class=\"type1Box dataBarBox\">\n                                            <div style=\"height: 30px;margin-bottom: 5px;\">\n                                                <label style=\"display: block;width: 80px;height: 30px;line-height: 30px;float: left;\">${ conditionformat_Text.fillType }：</label>\n                                                <select id=\"type2\">\n                                                    <option value=\"gradient\">${ conditionformat_Text.gradient }</option>\n                                                    <option value=\"solid\">${ conditionformat_Text.solid }</option>\n                                                </select>\n                                            </div>\n                                            <div style=\"height: 30px;margin-bottom: 5px;\">\n                                                <label style=\"display: block;width: 80px;height: 30px;line-height: 30px;float: left;\">${ conditionformat_Text.color }：</label>\n                                                <input data-tips=\"${ conditionformat_Text.dataBarColor }\" data-func=\"background\" class=\"luckysheet-conditionformat-config-color\" type=\"text\" value=\"#638ec6\" style=\"display: none;\"> \n                                            </div>\n                                        </div>\n                                        <div class=\"type1Box colorGradationBox\" style=\"display: none;\">\n                                            <div style=\"height: 30px;margin-bottom: 5px;\">\n                                                <label style=\"display: block;width: 80px;height: 30px;line-height: 30px;float: left;\">${ conditionformat_Text.fillType }：</label>\n                                                <select id=\"type2\">\n                                                    <option value=\"threeColor\">${ conditionformat_Text.tricolor }</option>\n                                                    <option value=\"twoColor\">${ conditionformat_Text.twocolor }</option>\n                                                </select>\n                                            </div>\n                                            <div class=\"maxVal\" style=\"height: 30px;margin-bottom: 5px;\">\n                                                <label style=\"display: block;width: 80px;height: 30px;line-height: 30px;float: left;\">${ conditionformat_Text.maxValue }：</label>\n                                                <input data-tips=\"${ conditionformat_Text.maxValue } ${ conditionformat_Text.color }\" data-func=\"background\" class=\"luckysheet-conditionformat-config-color\" type=\"text\" value=\"rgb(99, 190, 123)\" style=\"display: none;\">\n                                            </div>\n                                            <div class=\"midVal\" style=\"height: 30px;margin-bottom: 5px;\">\n                                                <label style=\"display: block;width: 80px;height: 30px;line-height: 30px;float: left;\">${ conditionformat_Text.medianValue }：</label>\n                                                <input data-tips=\"${ conditionformat_Text.medianValue } ${ conditionformat_Text.color }\" data-func=\"background\" class=\"luckysheet-conditionformat-config-color\" type=\"text\" value=\"rgb(255, 235, 132)\" style=\"display: none;\">\n                                            </div>\n                                            <div class=\"minVal\" style=\"height: 30px;margin-bottom: 5px;\">\n                                                <label style=\"display: block;width: 80px;height: 30px;line-height: 30px;float: left;\">${ conditionformat_Text.minValue }：</label>\n                                                <input data-tips=\"${ conditionformat_Text.minValue } ${ conditionformat_Text.color }\" data-func=\"background\" class=\"luckysheet-conditionformat-config-color\" type=\"text\" value=\"rgb(248, 105, 107)\" style=\"display: none;\">\n                                            </div>\n                                        </div>\n                                        <div class=\"type1Box iconsBox\" style=\"display: none;\">\n                                            <label>${ conditionformat_Text.fillType }：</label>\n                                            <div class=\"showbox\">\n                                                <div class=\"model\" data-len=\"3\" data-leftmin=\"0\" data-top=\"0\" title=\"${ conditionformat_Text.threeWayArrow }(${ conditionformat_Text.multicolor })\" style=\"background-position: 0 0;\"></div>\n                                                <span class=\"ui-selectmenu-icon ui-icon ui-icon-triangle-1-s\" style=\"margin-top: 2px;\"></span>\n                                            </div>\n                                            <ul>\n                                                <li><div data-len=\"3\" data-leftmin=\"0\" data-top=\"0\" title=\"${ conditionformat_Text.threeWayArrow }(${ conditionformat_Text.multicolor })\" style=\"background-position: 0 0;\"></div></li>\n                                                <li><div data-len=\"3\" data-leftmin=\"5\" data-top=\"0\" title=\"${ conditionformat_Text.threeWayArrow }(${ conditionformat_Text.grayColor })\" style=\"background-position: -131px 0;\"></div></li>\n                                                <li><div data-len=\"3\" data-leftmin=\"0\" data-top=\"1\" title=\"${ conditionformat_Text.threeTriangles }\" style=\"background-position: 0 -20px;\"></div></li>\n                                                <li><div data-len=\"4\" data-leftmin=\"0\" data-top=\"2\" title=\"${ conditionformat_Text.fourWayArrow }(${ conditionformat_Text.multicolor })\" style=\"background-position: 0 -40px;\"></div></li>\n                                                <li><div data-len=\"4\" data-leftmin=\"5\" data-top=\"1\" title=\"${ conditionformat_Text.fourWayArrow }(${ conditionformat_Text.grayColor })\" style=\"background-position: -131px -20px;\"></div></li>\n                                                <li><div data-len=\"5\" data-leftmin=\"0\" data-top=\"3\" title=\"${ conditionformat_Text.fiveWayArrow }(${ conditionformat_Text.multicolor })\" style=\"background-position: 0 -60px;\"></div></li>\n                                                <li><div data-len=\"5\" data-leftmin=\"5\" data-top=\"2\" title=\"${ conditionformat_Text.fiveWayArrow }(${ conditionformat_Text.grayColor })\" style=\"background-position: -131px -40px;\"></div></li>\n                                                <li><div data-len=\"3\" data-leftmin=\"0\" data-top=\"4\" title=\"${ conditionformat_Text.threeColorTrafficLight }(${ conditionformat_Text.rimless })\" style=\"background-position: 0 -80px;\"></div></li>\n                                                <li><div data-len=\"3\" data-leftmin=\"5\" data-top=\"4\" title=\"${ conditionformat_Text.threeColorTrafficLight }(${ conditionformat_Text.bordered })\" style=\"background-position: -131px -80px;\"></div></li>\n                                                <li><div data-len=\"3\" data-leftmin=\"0\" data-top=\"5\" title=\"${ conditionformat_Text.threeSigns }\" style=\"background-position: 0 -100px;\"></div></li>\n                                                <li><div data-len=\"4\" data-leftmin=\"5\" data-top=\"5\" title=\"${ conditionformat_Text.fourColorTrafficLight }\" style=\"background-position: -131px -100px;\"></div></li>\n                                                <li><div data-len=\"4\" data-leftmin=\"0\" data-top=\"6\" title=\"${ conditionformat_Text.greenRedBlackGradient }\" style=\"background-position: 0 -120px;\"></div></li>\n                                                <li><div data-len=\"3\" data-leftmin=\"0\" data-top=\"7\" title=\"${ conditionformat_Text.threeSymbols }(${ conditionformat_Text.circled })\" style=\"background-position: 0 -140px;\"></div></li>\n                                                <li><div data-len=\"3\" data-leftmin=\"5\" data-top=\"7\" title=\"${ conditionformat_Text.threeSymbols }(${ conditionformat_Text.noCircle })\" style=\"background-position: -131px -140px;\"></div></li>\n                                                <li><div data-len=\"3\" data-leftmin=\"0\" data-top=\"8\" title=\"${ conditionformat_Text.tricolorFlag }\" style=\"background-position: 0 -160px;\"></div></li>\n                                                <li><div data-len=\"3\" data-leftmin=\"0\" data-top=\"9\" title=\"${ conditionformat_Text.threeStars }\" style=\"background-position: 0 -180px;\"></div></li>\n                                                <li><div data-len=\"5\" data-leftmin=\"0\" data-top=\"10\" title=\"${ conditionformat_Text.fiveQuadrantDiagram }\" style=\"background-position: 0 -200px;\"></div></li>\n                                                <li><div data-len=\"5\" data-leftmin=\"0\" data-top=\"11\" title=\"${ conditionformat_Text.fiveBoxes }\" style=\"background-position: 0 -220px;\"></div></li>\n                                                <li><div data-len=\"4\" data-leftmin=\"5\" data-top=\"9\" title=\"${ conditionformat_Text.grade4 }\" style=\"background-position: -131px -180px;\"></div></li>\n                                                <li><div data-len=\"5\" data-leftmin=\"5\" data-top=\"10\" title=\"${ conditionformat_Text.grade5 }\" style=\"background-position: -131px -200px;\"></div></li>\n                                            </ul>\n                                        </div>\n                                    </div>`;\n                break;\n            case 1:\n                //只为包含以下内容的单元格设置格式\n                ruleExplainHtml = `<div class=\"title\">${ conditionformat_Text.ruleTypeItem2_title }：</div>\n                                    <div style=\"height: 30px;margin-bottom: 10px;\">\n                                        <select id=\"type1\">\n                                            <option value=\"number\">${ conditionformat_Text.cellValue }</option>\n                                            <option value=\"text\">${ conditionformat_Text.specificText }</option>\n                                            <option value=\"date\">${ conditionformat_Text.occurrence }</option>\n                                        </select>\n                                        <div>\n                                            <div class=\"type1Box numberBox\">\n                                                <select id=\"type2\">\n                                                    <option value=\"greaterThan\">${ conditionformat_Text.greaterThan }</option>\n                                                    <option value=\"lessThan\">${ conditionformat_Text.lessThan }</option>\n                                                    <option value=\"betweenness\">${ conditionformat_Text.between }</option>\n                                                    <option value=\"equal\">${ conditionformat_Text.equal }</option>\n                                                </select>\n                                                <div class=\"inpbox range\" id=\"conditionVal\">\n                                                    <input class=\"formulaInputFocus\"/>\n                                                    <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ conditionformat_Text.selectCell }\"></i>\n                                                </div>\n                                                <span class=\"txt\" style=\"display: none;\">${ conditionformat_Text.in }</span>\n                                                <div class=\"inpbox range\" id=\"conditionVal2\" style=\"display: none;\">\n                                                    <input class=\"formulaInputFocus\"/>\n                                                    <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ conditionformat_Text.selectDataRange }\"></i>\n                                                </div>\n                                            </div>\n                                            <div class=\"type1Box textBox\" style=\"display: none;\">\n                                                <select id=\"type2\">\n                                                    <option value=\"\">${ conditionformat_Text.contain }</option>\n                                                </select>\n                                                <div class=\"inpbox range\" id=\"conditionVal\">\n                                                    <input class=\"formulaInputFocus\"/>\n                                                    <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ conditionformat_Text.selectCell }\"></i>\n                                                </div>\n                                            </div>\n                                            <div class=\"type1Box dateBox\" style=\"display: none;\">\n                                                <div style=\"width: 162px;\" class=\"inpbox\">\n                                                    <input style=\"width: 150px;\" id=\"daterange-btn\" readonly=\"readonly\" placeholder=\"${ conditionformat_Text.pleaseSelectADate }\"/>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <div class=\"title\">${ conditionformat_Text.setFormat }: </div>${ textCellColorHtml }`;\n                break;\n            case 2:\n                //仅对排名靠前或靠后的数值设置格式\n                ruleExplainHtml = `<div class=\"title\">${ conditionformat_Text.ruleTypeItem3_title }：</div>\n                                    <div style=\"height: 30px;margin-bottom: 10px;\">\n                                        <select id=\"type1\">\n                                            <option value=\"top\">${ conditionformat_Text.top }</option>\n                                            <option value=\"last\">${ conditionformat_Text.last }</option>\n                                        </select>\n                                        <div class=\"inpbox\" id=\"conditionVal\">\n                                            <input class=\"formulaInputFocus\" type=\"number\" value=\"10\"/>\n                                        </div>\n                                        <input id=\"isPercent\" type=\"checkbox\"/>\n                                        <label for=\"isPercent\" class=\"txt\">${ conditionformat_Text.selectRange_percent }</label>\n                                    </div>\n                                    <div class=\"title\">${ conditionformat_Text.setFormat }：</div>${ textCellColorHtml }`;\n                break;\n            case 3:\n                //仅对高于或低于平均值的数值设置格式\n                ruleExplainHtml = `<div class=\"title\">${ conditionformat_Text.ruleTypeItem4_title }：</div>\n                                    <div style=\"height: 30px;margin-bottom: 10px;\">\n                                        <select id=\"type1\">\n                                            <option value=\"AboveAverage\">${ conditionformat_Text.above }</option>\n                                            <option value=\"SubAverage\">${ conditionformat_Text.below }</option>\n                                        </select>\n                                        <span class=\"txt\">${ conditionformat_Text.selectRange_average }</span>\n                                    </div>\n                                    <div class=\"title\">${ conditionformat_Text.setFormat }：</div>${ textCellColorHtml }`;\n                break;\n            case 4:\n                //仅对唯一值或重复值设置格式\n                ruleExplainHtml = `<div class=\"title\">${ conditionformat_Text.all }：</div>\n                                    <div style=\"height: 30px;margin-bottom: 10px;\">\n                                        <select id=\"type1\">\n                                            <option value=\"0\">${ conditionformat_Text.duplicateValue }</option>\n                                            <option value=\"1\">${ conditionformat_Text.uniqueValue }</option>\n                                        </select>\n                                        <span class=\"txt\">${ conditionformat_Text.selectRange_value }</span>\n                                    </div>\n                                    <div class=\"title\">${ conditionformat_Text.setFormat }：</div>${ textCellColorHtml }`;\n                break;\n            case 5:\n                //使用公式确定要设置格式的单元格\n                ruleExplainHtml = `<div class=\"title\">${ conditionformat_Text.ruleTypeItem2_title }：</div>\n                                    <div style=\"height: 30px;margin-bottom: 10px;\">\n                                        <div class=\"inpbox range\" id=\"formulaConditionVal\" style=\"width: 250px;\">\n                                            <input class=\"formulaInputFocus\" style=\"width: 200px;\"/>\n                                            <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ conditionformat_Text.selectCell }\"></i>\n                                        </div>\n                                    </div>\n                                    <div class=\"title\">${ conditionformat_Text.setFormat }: </div>${ textCellColorHtml }`;\n                break;\n            }\n            return ruleExplainHtml;\n        },\n        daterangeInit: function (id) {\n            const conditionformat_Text = locale().conditionformat;    //日期选择插件\n            //日期选择插件\n            $('.ranges_1 ul').remove();\n            $('#' + id).find('#daterange-btn').flatpickr({\n                mode: 'range',\n                onChange: function (data, label) {\n                    const [start, end] = data;    //label:通过它来知道用户选择的是什么，传给后台进行相应的展示\n                    //label:通过它来知道用户选择的是什么，传给后台进行相应的展示\n                    let format1 = [\n                        conditionformat_Text.yesterday,\n                        conditionformat_Text.today\n                    ];\n                    let format2 = [\n                        conditionformat_Text.lastWeek,\n                        conditionformat_Text.thisWeek,\n                        conditionformat_Text.lastMonth,\n                        conditionformat_Text.thisMonth,\n                        conditionformat_Text.lastYear,\n                        conditionformat_Text.thisYear,\n                        conditionformat_Text.last7days,\n                        conditionformat_Text.last30days\n                    ];\n                    if (label == conditionformat_Text.all) {\n                        $('#daterange-btn').val('');\n                    } else if (format1.indexOf(label) > -1) {\n                        $('#daterange-btn').val(dayjs(start).format('YYYY/MM/DD'));\n                    } else if (format2.indexOf(label) > -1) {\n                        $('#daterange-btn').val(dayjs(start).format('YYYY/MM/DD') + '-' + dayjs(end).format('YYYY/MM/DD'));\n                    }\n                }\n            });\n        }\n    });\n    return conditionformat;\n});"]}