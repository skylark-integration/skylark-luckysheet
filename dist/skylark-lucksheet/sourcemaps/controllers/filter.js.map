{"version":3,"sources":["controllers/filter.js"],"names":["define","m_get","editor","m_validate","tooltip","m_getRowlen","m_select","m_sheetMove","server","locale","Store","menuButton","conditionformat","alternateformat","m_protection","m_util","cleargridelement","m_refresh","m_sort","json","m_format","getSheetIndex","isRealNull","isEditMode","rowlenByRange","selectHightlightShow","luckysheetMoveEndCell","checkProtectionAuthorityNormal","rgbTohex","showrightclickmenu","jfrefreshgrid","jfrefreshgrid_rhcw","orderbydata","orderbydata1D","update","genarate","labelFilterOptionState","$top","optionstate","rowhidden","caljs","notSave","str","edr","cindex","stc","edc","addClass","data","JSON","stringify","html","removeClass","file","luckysheetfile","currentSheetIndex","filter","param","saveParam","k","orderbydatafiler","index","asc","d","deepCopyFlowData","flowdata","hasMc","r","data_row","c","mc","push","locale_filter","alert","mergeError","info","allParam","config","cfg","$","extend","RowlChange","row","column","createFilter","luckysheet_select_save","length","hide","container","attr","focus","locale_splitText","splitText","tipNoMulti","isPivotTable","remove","last","st_c","ed_c","curR","cell","v","luckysheet_shiftpositon","luckysheet_filter_save","createFilterOptions","filterchage","jfredo","type","curdata","sheetIndex","filter_save","filterObj","r1","r2","c1","c2","visibledatarow","row_pre","col","visibledatacolumn","col_pre","newSelectedHTML","append","optionHTML","caljs_data","caljs_value1_data","caljs_value2_data","replace","scrollTop","filter_select","initialFilterHandler","hidefilersubmenu","_locale","locale_button","button","click","submenuhide","rightclickmenu","hover","$t","this","attrid","$attr","$con","parent","winW","window","width","winH","height","menuW","attrH","attrW","offset","top","left","css","show","setTimeout","clearTimeout","mouseover","find","e","text","$type","$value","prop","eq","next","slideUp","slideToggle","is","filiterInputNone","slideDown","toffset","$menu","mheight","on","currentTarget","st_r","ed_r","parse","val","byconditiontype","$input","off","empty","filiterMoreDataTip","rowhiddenother","not","each","rh","dvmap","dvmap_uncheck","vmap","vmap_uncheck","ct","t","m","y","split","item","yearHtml","ysum","monthHtml","mT2","msum","dayHtml","mT","dT","dayL","Number","filiterMonthText","filiterYearText","unshift","vmapKeys","Object","keys","i","x","dataHtml","valueBlank","join","stopPropagation","bgMap","fcMap","af_compute","getComputeMap","cf_compute","bg","checkstatus","checksAF","checksCF","indexOf","substr","repeat","fc","filterBgColorHtml","bgColorItemHtml","b","filiterByColorTip","content","filterFcColorHtml","fcColorItemHtml","f","filiterByTextColorTip","filterContainerOneColorTip","confirm","end","myh","myw","document","siblings","bg_filter","fc_filter","bg_colorMap","fc_colorMap","color","$id","closest","get","rowhiddenall","rowhidenPre","parseJsonParm","clearjfundo","redo","jfundo","removeAttr","parents","yearDayAllCheck","monthDayAllCheck","event","$p","hasClass","conditionNone","optiongroups","toString","day","month","filterdata","value","value1","valuelen","parseInt","parseFloat","min","max","value2","year","itemV","filterDateFormatTip","fmt"],"mappings":"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","file":"../../controllers/filter.js","sourcesContent":["define([\n    '../methods/get',\n    '../global/editor',\n    '../global/validate',\n    '../global/tooltip',\n    '../global/getRowlen',\n    './select',\n    './sheetMove',\n    './server',\n    '../locale/locale',\n    '../store',\n    './menuButton',\n    './conditionformat',\n    './alternateformat',\n    './protection',\n    '../utils/util',\n    '../global/cleargridelement',\n    '../global/refresh',\n    '../global/sort',\n    '../global/json',\n    '../global/format'\n], function (m_get, editor, m_validate, tooltip, m_getRowlen, m_select, m_sheetMove, server, locale, Store, menuButton, conditionformat, alternateformat, m_protection, m_util, cleargridelement, m_refresh, m_sort, json, m_format) {\n    'use strict';\n    const {getSheetIndex} = m_get;\n    const {isRealNull, isEditMode} = m_validate;\n    const {rowlenByRange} = m_getRowlen;\n    const {selectHightlightShow} = m_select;\n    const {luckysheetMoveEndCell} = m_sheetMove;\n    const {checkProtectionAuthorityNormal} = m_protection;\n    const {rgbTohex, showrightclickmenu} = m_util;\n    const {jfrefreshgrid, jfrefreshgrid_rhcw} = m_refresh;\n    const {orderbydata, orderbydata1D} = m_sort;\n    const {update, genarate} = m_format;\n    //筛选配置状态\n    function labelFilterOptionState($top, optionstate, rowhidden, caljs, notSave, str, edr, cindex, stc, edc) {\n        if (optionstate) {\n            $top.addClass('luckysheet-filter-options-active').data('rowhidden', JSON.stringify(rowhidden)).data('caljs', JSON.stringify(caljs)).html('<i class=\"fa fa-filter luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>');\n            if (caljs != null) {\n                $top.data('byconditionvalue', caljs['value']).data('byconditiontype', caljs['type']).data('byconditiontext', caljs['text']);\n                if (caljs['value1'] != null) {\n                    $top.data('byconditionvalue1', caljs['value1']);\n                }\n                if (caljs['value2'] != null) {\n                    $top.data('byconditionvalue2', caljs['value2']);\n                }\n            }\n        } else {\n            $top.removeClass('luckysheet-filter-options-active').data('rowhidden', '').data('caljs', '').html('<i class=\"fa fa-caret-down luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>');\n            $top.data('byconditionvalue', 'null').data('byconditiontype', '0').data('byconditiontext', '无').data('byconditionvalue1', '').data('byconditionvalue2', '');\n        }\n        if (!!notSave) {\n            let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            if (file.filter == null) {\n                file.filter = {};\n            }\n            if (optionstate) {\n                let param = {\n                    'caljs': caljs,\n                    'rowhidden': rowhidden,\n                    'optionstate': optionstate,\n                    'str': str,\n                    'edr': edr,\n                    'cindex': cindex,\n                    'stc': stc,\n                    'edc': edc\n                };\n                file.filter[cindex - stc] = param;\n            } else {\n                delete file.filter[cindex - stc];\n            }\n            server.saveParam('all', Store.currentSheetIndex, file.filter, { 'k': 'filter' });\n        }\n    }    //筛选排序\n    //筛选排序\n    function orderbydatafiler(str, stc, edr, edc, index, asc) {\n        let d = editor.deepCopyFlowData(Store.flowdata);\n        str = str + 1;\n        let hasMc = false;    //排序选区是否有合并单元格\n        //排序选区是否有合并单元格\n        let data = [];\n        for (let r = str; r <= edr; r++) {\n            let data_row = [];\n            for (let c = stc; c <= edc; c++) {\n                if (d[r][c] != null && d[r][c].mc != null) {\n                    hasMc = true;\n                    break;\n                }\n                data_row.push(d[r][c]);\n            }\n            data.push(data_row);\n        }\n        if (hasMc) {\n            const locale_filter = locale().filter;\n            if (isEditMode()) {\n                alert(locale_filter.mergeError);\n            } else {\n                tooltip.info(locale_filter.mergeError, '');\n            }\n            return;\n        }\n        data = orderbydata(data, index - stc, asc);\n        for (let r = str; r <= edr; r++) {\n            for (let c = stc; c <= edc; c++) {\n                d[r][c] = data[r - str][c - stc];\n            }\n        }\n        let allParam = {};\n        if (Store.config['rowlen'] != null) {\n            let cfg = $.extend(true, {}, Store.config);\n            cfg = rowlenByRange(d, str, edr, cfg);\n            allParam = {\n                'cfg': cfg,\n                'RowlChange': true\n            };\n        }\n        jfrefreshgrid(d, [{\n                'row': [\n                    str,\n                    edr\n                ],\n                'column': [\n                    stc,\n                    edc\n                ]\n            }], allParam);\n    }    //创建筛选按钮\n    //创建筛选按钮\n    function createFilter() {\n        if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'filter')) {\n            return;\n        }\n        if (Store.luckysheet_select_save.length > 1) {\n            $('#luckysheet-rightclick-menu').hide();\n            $('#luckysheet-filter-menu, #luckysheet-filter-submenu').hide();\n            $('#' + Store.container).attr('tabindex', 0).focus();\n            const locale_splitText = locale().splitText;\n            if (isEditMode()) {\n                alert(locale_splitText.tipNoMulti);\n            } else {\n                tooltip.info(locale_splitText.tipNoMulti, '');\n            }\n            return;\n        }\n        if (Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].isPivotTable) {\n            return;\n        }\n        $('#luckysheet-filter-selected-sheet' + Store.currentSheetIndex + ', #luckysheet-filter-options-sheet' + Store.currentSheetIndex).remove();\n        let last = Store.luckysheet_select_save[0];\n        if (last['row'][0] == last['row'][1] && last['column'][0] == last['column'][1]) {\n            let st_c, ed_c, curR = last['row'][1];\n            for (let c = 0; c < Store.flowdata[curR].length; c++) {\n                let cell = Store.flowdata[curR][c];\n                if (cell != null && !isRealNull(cell.v)) {\n                    if (st_c == null) {\n                        st_c = c;\n                    }\n                } else if (st_c != null) {\n                    ed_c = c - 1;\n                    break;\n                }\n            }\n            if (ed_c == null) {\n                ed_c = Store.flowdata[curR].length - 1;\n            }\n            Store.luckysheet_select_save = [{\n                    'row': [\n                        curR,\n                        curR\n                    ],\n                    'column': [\n                        st_c,\n                        ed_c\n                    ]\n                }];\n            selectHightlightShow();\n            Store.luckysheet_shiftpositon = $.extend(true, {}, last);\n            luckysheetMoveEndCell('down', 'range');\n        } else if (last['row'][1] - last['row'][0] < 2) {\n            Store.luckysheet_shiftpositon = $.extend(true, {}, last);\n            luckysheetMoveEndCell('down', 'range');\n        }\n        Store.luckysheet_filter_save = $.extend(true, {}, Store.luckysheet_select_save[0]);\n        createFilterOptions(Store.luckysheet_filter_save);\n        server.saveParam('all', Store.currentSheetIndex, Store.luckysheet_filter_save, { 'k': 'filter_select' });\n        if (Store.filterchage) {\n            Store.jfredo.push({\n                'type': 'filtershow',\n                'data': [],\n                'curdata': [],\n                'sheetIndex': Store.currentSheetIndex,\n                'filter_save': Store.luckysheet_filter_save\n            });\n        }\n    }    //创建筛选配置\n    //创建筛选配置\n    function createFilterOptions(luckysheet_filter_save, filterObj) {\n        $('#luckysheet-filter-selected-sheet' + Store.currentSheetIndex).remove();\n        $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex).remove();\n        if (luckysheet_filter_save == null || JSON.stringify(luckysheet_filter_save) == '{}') {\n            return;\n        }\n        let r1 = luckysheet_filter_save.row[0], r2 = luckysheet_filter_save.row[1];\n        let c1 = luckysheet_filter_save.column[0], c2 = luckysheet_filter_save.column[1];\n        let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n        let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n        let newSelectedHTML = '<div id=\"luckysheet-filter-selected-sheet' + Store.currentSheetIndex + '\" class=\"luckysheet-cell-selected luckysheet-filter-selected\"  style=\"left:' + col_pre + 'px;width:' + (col - col_pre - 1) + 'px;top:' + row_pre + 'px;height:' + (row - row_pre - 1) + 'px;display:block;border-color:#897BFF;z-index:20;background:none;\"></div>';\n        $('#luckysheet-cell-main').append(newSelectedHTML);\n        let optionHTML = '';\n        for (let c = c1; c <= c2; c++) {\n            if (filterObj == null || filterObj[c - c1] == null) {\n                optionHTML += '<div data-rowhidden=\"\" data-str=\"' + r1 + '\" data-edr=\"' + r2 + '\" data-cindex=\"' + c + '\" data-stc=\"' + c1 + '\" data-edc=\"' + c2 + '\" class=\"luckysheet-filter-options\" style=\"left:' + (Store.visibledatacolumn[c] - 20) + 'px;top:' + row_pre + 'px;display:block;\"><i class=\"fa fa-caret-down\" aria-hidden=\"true\"></i></div>';\n            } else {\n                let caljs_data;\n                if (filterObj[c - c1].caljs != null) {\n                    let caljs_value1_data;\n                    if (filterObj[c - c1].caljs['value1'] != null) {\n                        caljs_value1_data = 'data-byconditionvalue1=\"' + filterObj[c - c1].caljs['value1'] + '\" ';\n                    } else {\n                        caljs_value1_data = '';\n                    }\n                    let caljs_value2_data;\n                    if (filterObj[c - c1].caljs['value2'] != null) {\n                        caljs_value2_data = 'data-byconditionvalue2=\"' + filterObj[c - c1].caljs['value2'] + '\" ';\n                    } else {\n                        caljs_value2_data = '';\n                    }\n                    caljs_data = 'data-caljs=\"' + JSON.stringify(filterObj[c - c1].caljs) + '\" ' + 'data-byconditionvalue=\"' + filterObj[c - c1].caljs['value'] + '\" ' + 'data-byconditiontype=\"' + filterObj[c - c1].caljs['type'] + '\" ' + 'data-byconditiontext=\"' + filterObj[c - c1].caljs['text'] + '\" ' + caljs_value1_data + caljs_value2_data;\n                } else {\n                    caljs_data = '';\n                }\n                optionHTML += '<div data-rowhidden=\"' + JSON.stringify(filterObj[c - c1].rowhidden).replace(/\\\"/g, \"'\") + '\" ' + caljs_data + ' data-str=\"' + r1 + '\" data-edr=\"' + r2 + '\" data-cindex=\"' + c + '\" data-stc=\"' + c1 + '\" data-edc=\"' + c2 + '\" class=\"luckysheet-filter-options luckysheet-filter-options-active\" style=\"left:' + (Store.visibledatacolumn[c] - 20) + 'px;top:' + row_pre + 'px;display:block;\"><i class=\"fa fa-filter luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i></div>';\n            }\n        }\n        $('#luckysheet-cell-main').append('<div id=\"luckysheet-filter-options-sheet' + Store.currentSheetIndex + '\" class=\"luckysheet-filter-options-c\">' + optionHTML + '</div>');\n        $('#luckysheet-rightclick-menu').hide();\n        $('#luckysheet-filter-menu, #luckysheet-filter-submenu').hide();\n        if ($('#luckysheet-cell-main').scrollTop() > luckysheet_filter_save['top_move']) {\n            $('#luckysheet-scrollbar-y').scrollTop(luckysheet_filter_save['top_move']);\n        }\n        let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n        file.filter_select = luckysheet_filter_save;\n    }\n    function initialFilterHandler() {\n        //filter event handler\n        let hidefilersubmenu = null;\n        const _locale = locale();\n        const locale_filter = _locale.filter;\n        const locale_button = _locale.button;\n        $('#luckysheetfilter').click(createFilter);    //右键菜单 菜单项hover\n        //右键菜单 菜单项hover\n        let submenuhide = null, rightclickmenu = null;\n        $('.luckysheet-cols-menu .luckysheet-cols-submenu').hover(function () {\n            let $t = $(this), attrid = $t.attr('id'), $attr = $('#' + attrid + '_sub'), $con = $t.parent();\n            let winW = $(window).width(), winH = $(window).height();\n            let menuW = $con.width(), attrH = $attr.height() + 25, attrW = $attr.width() + 5;\n            let offset = $t.offset();\n            let top = offset.top, left = offset.left + menuW;\n            if (left + attrW > winW) {\n                left = offset.left - attrW;\n            }\n            if (top + attrH > winH) {\n                top = winH - attrH;\n            }\n            $attr.css({\n                'top': top,\n                'left': left\n            }).show();\n            rightclickmenu = $t;\n        }, function () {\n            let $t = $(this), attrid = $t.attr('id'), $attr = $('#' + attrid + '_sub');\n            submenuhide = setTimeout(function () {\n                $attr.hide();\n            }, 200);\n        });\n        $('.luckysheet-rightgclick-menu-sub').hover(function () {\n            rightclickmenu.addClass('luckysheet-cols-menuitem-hover');\n            clearTimeout(submenuhide);\n        }, function () {\n            rightclickmenu.removeClass('luckysheet-cols-menuitem-hover');\n            $(this).hide();\n        });\n        $('#luckysheet-filter-menu').mouseover(function () {\n            clearTimeout(hidefilersubmenu);\n            hidefilersubmenu = setTimeout(function () {\n                $('#luckysheet-filter-submenu').hide();\n            }, 500);\n        });\n        $('#luckysheet-filter-submenu').mouseover(function () {\n            clearTimeout(hidefilersubmenu);\n        }).find('.luckysheet-cols-menuitem').click(function (e) {\n            $('#luckysheet-filter-selected span').html($(this).find('.luckysheet-cols-menuitem-content').text()).data('value', $(this).data('value'));\n            $('#luckysheet-filter-menu .luckysheet-filter-selected-input').hide();\n            let $type = $(this).data('type');\n            let $value = $(this).attr('data-value');\n            if ($type == '2') {\n                $('#luckysheet-filter-selected span').data('type', '2');\n                $('#luckysheet-filter-menu .luckysheet-filter-selected-input2').show();\n                $('#luckysheet-filter-menu .luckysheet-filter-selected-input input').prop('type', 'number');\n            } else if ($type == '0') {\n                $('#luckysheet-filter-selected span').data('type', '0');\n            } else {\n                $('#luckysheet-filter-selected span').data('type', '1');\n                $('#luckysheet-filter-menu .luckysheet-filter-selected-input').eq(0).show();    //若是日期 改变input type类型为date\n                //若是日期 改变input type类型为date\n                if ($value == 'dateequal' || $value == 'datelessthan' || $value == 'datemorethan') {\n                    $('#luckysheet-filter-menu .luckysheet-filter-selected-input input').prop('type', 'date');\n                } else if ($value == 'morethan' || $value == 'moreequalthan' || $value == 'lessthan' || $value == 'lessequalthan' || $value == 'equal' || $value == 'noequal') {\n                    $('#luckysheet-filter-menu .luckysheet-filter-selected-input input').prop('type', 'number');\n                } else {\n                    $('#luckysheet-filter-menu .luckysheet-filter-selected-input input').prop('type', 'text');\n                }\n            }\n            $('#luckysheet-filter-byvalue').next().slideUp();\n            $('#luckysheet-filter-submenu').hide();\n        });\n        $('#luckysheet-filter-bycondition, #luckysheet-filter-byvalue').click(function () {\n            let $t = $(this);\n            $t.next().slideToggle(200);\n            setTimeout(function () {\n                if ($t.attr('id') == 'luckysheet-filter-bycondition' && $('#luckysheet-filter-bycondition').next().is(':visible')) {\n                    if ($('#luckysheet-filter-selected span').text() != locale_filter.filiterInputNone) {\n                        $('#luckysheet-filter-byvalue').next().slideUp(200);\n                    }\n                }\n                if ($t.is($('#luckysheet-filter-bycondition'))) {\n                    if ($('#luckysheet-filter-bycondition').next().is(':hidden') && $('#luckysheet-filter-byvalue').next().is(':hidden')) {\n                        $('#luckysheet-filter-byvalue').next().slideDown(200);\n                    }\n                }\n            }, 300);\n        });\n        $('#luckysheet-filter-selected').click(function () {\n            let $t = $(this), toffset = $t.offset(), $menu = $('#luckysheet-filter-submenu');\n            $menu.hide();\n            let winH = $(window).height(), winW = $(window).width();\n            let menuW = $menu.width(), menuH = $menu.height();\n            let top = toffset.top, left = toffset.left, mheight = winH - toffset.top - 20;\n            if (toffset.left + menuW > winW) {\n                left = toffset.left - menuW;\n            }\n            if (toffset.top > winH / 2) {\n                top = winH - toffset.top;\n                if (top < 0) {\n                    top = 0;\n                }\n                mheight = toffset.top - 20;\n            }\n            $menu.css({\n                'top': top,\n                'left': left,\n                'height': mheight\n            }).show();\n            clearTimeout(hidefilersubmenu);\n        });    //筛选按钮点击事件\n        //筛选按钮点击事件\n        $('#luckysheet-cell-main').on('click', '.luckysheet-filter-options', function (e) {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'filter')) {\n                return;\n            }\n            let $t = $(e.currentTarget), toffset = $t.offset(), $menu = $('#luckysheet-filter-menu'), winH = $(window).height(), winW = $(window).width();\n            let st_r = $t.data('str'), ed_r = $t.data('edr'), cindex = $t.data('cindex'), st_c = $t.data('stc'), ed_c = $t.data('edc'), rowhidden = $t.data('rowhidden') == '' ? {} : JSON.parse($t.data('rowhidden').replace(/\\'/g, '\"'));\n            $('body .luckysheet-cols-menu').hide();\n            $('#luckysheet-filter-menu, #luckysheet-filter-submenu').hide();\n            $('#luckysheet-filter-byvalue-input').val('');\n            $('#luckysheet-filter-bycondition').next().hide();\n            $('#luckysheet-filter-byvalue').next().show();\n            $menu.data('str', st_r);\n            $menu.data('edr', ed_r);\n            $menu.data('cindex', cindex);\n            $menu.data('stc', st_c);\n            $menu.data('edc', ed_c);\n            $('#luckysheet-filter-menu .luckysheet-filter-selected-input').hide().find('input').val();\n            $('#luckysheet-filter-selected span').data('type', '0').data('type', null).text(locale_filter.filiterInputNone);\n            let byconditiontype = $t.data('byconditiontype');\n            $('#luckysheet-filter-selected span').data('value', $t.data('byconditionvalue')).data('type', byconditiontype).text($t.data('byconditiontext'));\n            if (byconditiontype == '2') {\n                let $input = $('#luckysheet-filter-menu .luckysheet-filter-selected-input2').show().find('input');\n                $input.eq(0).val($t.data('byconditionvalue1'));\n                $input.eq(1).val($t.data('byconditionvalue2'));\n            } else if (byconditiontype == '1') {\n                $('#luckysheet-filter-menu .luckysheet-filter-selected-input').eq(0).show().find('input').val($t.data('byconditionvalue1'));\n            }\n            $('#luckysheet-filter-orderby-asc').off('click').on('click', function () {\n                orderbydatafiler(st_r, st_c, ed_r, ed_c, cindex, true);\n            });\n            $('#luckysheet-filter-orderby-desc').off('click').on('click', function () {\n                orderbydatafiler(st_r, st_c, ed_r, ed_c, cindex, false);\n            });\n            $('#luckysheet-filter-byvalue-select').empty().html('<div style=\"width:100%;text-align:center;position:relative;top:45%;font-size:14px;\"><div class=\"luckysheetLoaderGif\"></div><span>' + locale_filter.filiterMoreDataTip + '</span></div>');\n            let rowhiddenother = {};    //其它筛选列的隐藏行\n            //其它筛选列的隐藏行\n            $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').not(this).each(function () {\n                let $t = $(this), rh = $t.data('rowhidden');\n                if (rh == '') {\n                    return true;\n                }\n                rh = JSON.parse(rh.replace(/\\'/g, '\"'));\n                for (let r in rh) {\n                    rowhiddenother[r] = 0;\n                }\n            });\n            let data = Store.flowdata;\n            setTimeout(function () {\n                //日期值\n                let dvmap = {};\n                let dvmap_uncheck = {};    //除日期以外的值\n                //除日期以外的值\n                let vmap = {};\n                let vmap_uncheck = {};\n                for (let r = st_r + 1; r <= ed_r; r++) {\n                    if (r in rowhiddenother) {\n                        continue;\n                    }\n                    if (Store.flowdata[r] == null) {\n                        continue;\n                    }\n                    let cell = Store.flowdata[r][cindex];\n                    if (cell != null && !isRealNull(cell.v) && cell.ct != null && cell.ct.t == 'd') {\n                        //单元格是日期\n                        let v = update('YYYY-MM-DD', cell.v);\n                        let y = v.split('-')[0];\n                        let m = v.split('-')[1];\n                        let d = v.split('-')[2];\n                        if (!(y in dvmap)) {\n                            dvmap[y] = {};\n                        }\n                        if (!(m in dvmap[y])) {\n                            dvmap[y][m] = {};\n                        }\n                        if (!(d in dvmap[y][m])) {\n                            dvmap[y][m][d] = 0;\n                        }\n                        dvmap[y][m][d]++;\n                        if (r in rowhidden) {\n                            dvmap_uncheck[y] = 0;\n                            dvmap_uncheck[m] = 0;\n                            dvmap_uncheck[d] = 0;\n                        }\n                    } else {\n                        let v, m;\n                        if (cell == null || isRealNull(cell.v)) {\n                            v = null;\n                            m = null;\n                        } else {\n                            v = cell.v;\n                            m = cell.m;\n                        }\n                        if (!(v in vmap)) {\n                            vmap[v] = {};\n                        }\n                        if (!(m in vmap[v])) {\n                            vmap[v][m] = 0;\n                        }\n                        vmap[v][m]++;\n                        if (r in rowhidden) {\n                            vmap_uncheck[v + '#$$$#' + m] = 0;\n                        }\n                    }\n                }    //遍历数据加到页面\n                //遍历数据加到页面\n                let item = [];\n                if (JSON.stringify(dvmap).length > 2) {\n                    for (let y in dvmap) {\n                        let ysum = 0;\n                        let monthHtml = '';\n                        for (let m in dvmap[y]) {\n                            let msum = 0;\n                            let dayHtml = '';\n                            for (let d in dvmap[y][m]) {\n                                let dayL = dvmap[y][m][d];\n                                msum += dayL;    //月 小于 10\n                                //月 小于 10\n                                let mT;\n                                if (Number(m) < 10) {\n                                    mT = '0' + Number(m);\n                                } else {\n                                    mT = m;\n                                }    //日 小于 10\n                                //日 小于 10\n                                let dT;\n                                if (Number(d) < 10) {\n                                    dT = '0' + Number(d);\n                                } else {\n                                    dT = d;\n                                }    //日是否选中状态\n                                //日是否选中状态\n                                if (y in dvmap_uncheck && m in dvmap_uncheck && d in dvmap_uncheck) {\n                                    dayHtml += '<div class=\"day luckysheet-mousedown-cancel cf\" data-check=\"false\" title=\"' + y + '-' + mT + '-' + dT + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + d + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + dayL + ' )</span>' + '</div>';\n                                } else {\n                                    dayHtml += '<div class=\"day luckysheet-mousedown-cancel cf\" data-check=\"true\" title=\"' + y + '-' + mT + '-' + dT + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + d + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + dayL + ' )</span>' + '</div>';\n                                }\n                            }\n                            ysum += msum;    //月 小于 10\n                            //月 小于 10\n                            let mT2;\n                            if (Number(m) < 10) {\n                                mT2 = '0' + Number(m);\n                            } else {\n                                mT2 = m;\n                            }    //月是否选中状态\n                            //月是否选中状态\n                            if (y in dvmap_uncheck && m in dvmap_uncheck) {\n                                monthHtml += '<div class=\"monthBox luckysheet-mousedown-cancel\">' + '<div class=\"month luckysheet-mousedown-cancel cf\" data-check=\"false\" title=\"' + y + '-' + mT2 + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + m + '' + locale_filter.filiterMonthText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + msum + ' )</span>' + '</div>' + '<div class=\"dayList luckysheet-mousedown-cancel\">' + dayHtml + '</div>' + '</div>';\n                            } else {\n                                monthHtml += '<div class=\"monthBox luckysheet-mousedown-cancel\">' + '<div class=\"month luckysheet-mousedown-cancel cf\" data-check=\"true\" title=\"' + y + '-' + mT2 + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + m + '' + locale_filter.filiterMonthText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + msum + ' )</span>' + '</div>' + '<div class=\"dayList luckysheet-mousedown-cancel\">' + dayHtml + '</div>' + '</div>';\n                            }\n                        }    //年是否选中状态\n                        //年是否选中状态\n                        let yearHtml;\n                        if (y in dvmap_uncheck) {\n                            yearHtml = '<div class=\"yearBox luckysheet-mousedown-cancel\">' + '<div class=\"year luckysheet-mousedown-cancel cf\" data-check=\"false\" title=\"' + y + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + y + '' + locale_filter.filiterYearText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + ysum + ' )</span>' + '</div>' + '<div class=\"monthList luckysheet-mousedown-cancel\">' + monthHtml + '</div>' + '</div>';\n                        } else {\n                            yearHtml = '<div class=\"yearBox luckysheet-mousedown-cancel\">' + '<div class=\"year luckysheet-mousedown-cancel cf\" data-check=\"true\" title=\"' + y + '\">' + '<i class=\"fa fa-caret-right luckysheet-mousedown-cancel\" aria-hidden=\"true\"></i>' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + y + '' + locale_filter.filiterYearText + '</label>' + '<span class=\"count luckysheet-mousedown-cancel\">( ' + ysum + ' )</span>' + '</div>' + '<div class=\"monthList luckysheet-mousedown-cancel\">' + monthHtml + '</div>' + '</div>';\n                        }\n                        item.unshift(yearHtml);\n                    }\n                }\n                if (JSON.stringify(vmap).length > 2) {\n                    let vmapKeys = Object.keys(vmap);\n                    vmapKeys = orderbydata1D(vmapKeys, true);\n                    for (let i = 0; i < vmapKeys.length; i++) {\n                        let v = vmapKeys[i];\n                        for (let x in vmap[v]) {\n                            let text;\n                            if (v + '#$$$#' + x == 'null#$$$#null') {\n                                text = locale_filter.valueBlank;\n                            } else {\n                                text = x;\n                            }    //是否选中状态\n                            //是否选中状态\n                            let dataHtml;\n                            if (v + '#$$$#' + x in vmap_uncheck) {\n                                dataHtml = '<div class=\"textBox luckysheet-mousedown-cancel cf\" data-check=\"false\" data-filter=\"' + (v + '#$$$#' + x) + '\" title=\"' + text + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + text + '</label>' + '<span class=\"luckysheet-mousedown-cancel count\">( ' + vmap[v][x] + ' )</span>' + '</div>';\n                            } else {\n                                dataHtml = '<div class=\"textBox luckysheet-mousedown-cancel cf\" data-check=\"true\" data-filter=\"' + (v + '#$$$#' + x) + '\" title=\"' + text + '\">' + '<input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/>' + '<label class=\"luckysheet-mousedown-cancel\">' + text + '</label>' + '<span class=\"luckysheet-mousedown-cancel count\">( ' + vmap[v][x] + ' )</span>' + '</div>';\n                            }\n                            item.push(dataHtml);\n                        }\n                    }\n                }\n                $('#luckysheet-filter-byvalue-select').html(\"<div class='ListBox luckysheet-mousedown-cancel' style='min-height: 100px; max-height: \" + (winH - toffset.top - 350) + \"px; overflow-y: auto; overflow-x: hidden;'><table cellspacing='0' style='width:100%;' class='luckysheet-mousedown-cancel'>\" + item.join('') + '</table></div>');\n            }, 1);\n            showrightclickmenu($menu, toffset.left, toffset.top + 20);\n            e.stopPropagation();\n            return false;\n        });    //按颜色筛选\n        //按颜色筛选\n        $('#luckysheet-filter-orderby-color').hover(function () {\n            //遍历筛选列颜色\n            let $menu = $('#luckysheet-filter-menu');\n            let st_r = $menu.data('str'), ed_r = $menu.data('edr'), cindex = $menu.data('cindex'), st_c = $menu.data('stc'), ed_c = $menu.data('edc');\n            let bgMap = {};    //单元格颜色\n            //单元格颜色\n            let fcMap = {};    //字体颜色\n            //字体颜色\n            let af_compute = alternateformat.getComputeMap();\n            let cf_compute = conditionformat.getComputeMap();\n            for (let r = st_r + 1; r <= ed_r; r++) {\n                let cell = Store.flowdata[r][cindex];    //单元格颜色\n                //单元格颜色\n                let bg = menuButton.checkstatus(Store.flowdata, r, cindex, 'bg');\n                if (bg == null) {\n                    bg = '#ffffff';\n                }\n                let checksAF = alternateformat.checksAF(r, cindex, af_compute);\n                if (checksAF != null) {\n                    //若单元格有交替颜色\n                    bg = checksAF[1];\n                }\n                let checksCF = conditionformat.checksCF(r, cindex, cf_compute);\n                if (checksCF != null && checksCF['cellColor'] != null) {\n                    //若单元格有条件格式\n                    bg = checksCF['cellColor'];\n                }\n                if (bg.indexOf('rgb') > -1) {\n                    bg = rgbTohex(bg);\n                }\n                if (bg.length == 4) {\n                    bg = bg.substr(0, 1) + bg.substr(1, 1).repeat(2) + bg.substr(2, 1).repeat(2) + bg.substr(3, 1).repeat(2);\n                }    //字体颜色\n                //字体颜色\n                let fc = menuButton.checkstatus(Store.flowdata, r, cindex, 'fc');\n                if (checksAF != null) {\n                    //若单元格有交替颜色\n                    fc = checksAF[0];\n                }\n                if (checksCF != null && checksCF['textColor'] != null) {\n                    //若单元格有条件格式\n                    fc = checksCF['textColor'];\n                }\n                if (fc.indexOf('rgb') > -1) {\n                    fc = rgbTohex(fc);\n                }\n                if (fc.length == 4) {\n                    fc = fc.substr(0, 1) + fc.substr(1, 1).repeat(2) + fc.substr(2, 1).repeat(2) + fc.substr(3, 1).repeat(2);\n                }\n                if (Store.config != null && Store.config['rowhidden'] != null && r in Store.config['rowhidden']) {\n                    bgMap[bg] = 1;\n                    if (cell != null && !isRealNull(cell.v)) {\n                        fcMap[fc] = 1;\n                    }\n                } else {\n                    bgMap[bg] = 0;\n                    if (cell != null && !isRealNull(cell.v)) {\n                        fcMap[fc] = 0;\n                    }\n                }\n            }    //\n            //\n            let filterBgColorHtml = '';\n            if (JSON.stringify(bgMap).length > 2 && Object.keys(bgMap).length > 1) {\n                let bgColorItemHtml = '';\n                for (let b in bgMap) {\n                    if (bgMap[b] == 0) {\n                        bgColorItemHtml += '<div class=\"item luckysheet-mousedown-cancel\"><label class=\"luckysheet-mousedown-cancel\" style=\"background-color: ' + b + '\" title=\"' + b + '\"></label><input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/></div>';\n                    } else {\n                        bgColorItemHtml += '<div class=\"item luckysheet-mousedown-cancel\"><label class=\"luckysheet-mousedown-cancel\" style=\"background-color: ' + b + '\" title=\"' + b + '\"></label><input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/></div>';\n                    }\n                }\n                filterBgColorHtml = '<div id=\"filterBgColor\" class=\"box luckysheet-mousedown-cancel\"><div class=\"title luckysheet-mousedown-cancel\">' + locale_filter.filiterByColorTip + '</div><div style=\"max-height:128px;overflow:auto;\" class=\"luckysheet-mousedown-cancel\">' + bgColorItemHtml + '</div></div>';\n            }\n            let filterFcColorHtml = '';\n            if (JSON.stringify(fcMap).length > 2 && Object.keys(fcMap).length > 1) {\n                let fcColorItemHtml = '';\n                for (let f in fcMap) {\n                    if (fcMap[f] == 0) {\n                        fcColorItemHtml += '<div class=\"item luckysheet-mousedown-cancel\"><label class=\"luckysheet-mousedown-cancel\" style=\"background-color: ' + f + '\" title=\"' + f + '\"></label><input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\" checked=\"checked\"/></div>';\n                    } else {\n                        fcColorItemHtml += '<div class=\"item luckysheet-mousedown-cancel\"><label class=\"luckysheet-mousedown-cancel\" style=\"background-color: ' + f + '\" title=\"' + f + '\"></label><input class=\"luckysheet-mousedown-cancel\" type=\"checkbox\"/></div>';\n                    }\n                }\n                filterFcColorHtml = '<div id=\"filterFcColor\" class=\"box luckysheet-mousedown-cancel\"><div class=\"title luckysheet-mousedown-cancel\">' + locale_filter.filiterByTextColorTip + '</div><div style=\"max-height:128px;overflow:auto;\" class=\"luckysheet-mousedown-cancel\">' + fcColorItemHtml + '</div></div>';\n            }    //\n            //\n            let content;\n            if (filterBgColorHtml == '' && filterFcColorHtml == '') {\n                content = '<div class=\"luckysheet-mousedown-cancel\" style=\"padding: 10px 30px;text-align: center;\">' + locale_filter.filterContainerOneColorTip + '</div>';\n            } else {\n                content = filterBgColorHtml + filterFcColorHtml + '<div class=\"luckysheet-mousedown-cancel\"><button id=\"luckysheet-filter-orderby-color-confirm\" class=\"btn btn-primary luckysheet-mousedown-cancel\" style=\"margin: 5px 20px;width: 70px;\">' + locale_button.confirm + '</button></div>';\n            }    //颜色筛选子菜单\n            //颜色筛选子菜单\n            $('#luckysheet-filter-orderby-color-submenu').remove();\n            $('body').append('<div id=\"luckysheet-filter-orderby-color-submenu\" class=\"luckysheet-cols-menu luckysheet-mousedown-cancel\">' + content + '</div>');\n            let $t = $('#luckysheet-filter-orderby-color-submenu').end();\n            let $con = $(this).parent();\n            let winW = $(window).width(), winH = $(window).height();\n            let menuW = $con.width(), myh = $t.height() + 25, myw = $t.width() + 5;\n            let offset = $(this).offset();\n            let top = offset.top, left = offset.left + menuW;\n            if (left + myw > winW) {\n                left = offset.left - myw;\n            }\n            if (top + myh > winH) {\n                top = winH - myh;\n            }\n            $('#luckysheet-filter-orderby-color-submenu').css({\n                'top': top,\n                'left': left\n            }).show();\n        }, function () {\n            submenuhide = setTimeout(function () {\n                $('#luckysheet-filter-orderby-color-submenu').hide();\n            }, 200);\n        });\n        $(document).on('mouseover mouseleave', '#luckysheet-filter-orderby-color-submenu', function (e) {\n            if (e.type === 'mouseover') {\n                clearTimeout(submenuhide);\n            } else {\n                $(this).hide();\n            }\n        });\n        $(document).on('click', '#luckysheet-filter-orderby-color-submenu .item label', function () {\n            $(this).siblings(\"input[type='checkbox']\").click();\n        });\n        $(document).off('click.orderbyColorConfirm').on('click.orderbyColorConfirm', '#luckysheet-filter-orderby-color-submenu #luckysheet-filter-orderby-color-confirm', function () {\n            let bg_colorMap = {};\n            let fc_colorMap = {};\n            $('#luckysheet-filter-orderby-color-submenu .item').each(function (i, e) {\n                if ($(e).find(\"input[type='checkbox']\").is(':checked')) {\n                    let color = $(this).find('label').attr('title');\n                    let $id = $(this).closest('.box').attr('id');\n                    if ($id == 'filterBgColor') {\n                        bg_colorMap[color] = 0;\n                    } else if ($id == 'filterFcColor') {\n                        fc_colorMap[color] = 0;\n                    }\n                }\n            });\n            let bg_filter;\n            if ($('#luckysheet-filter-orderby-color-submenu #filterBgColor').length > 0) {\n                bg_filter = true;\n            } else {\n                bg_filter = false;\n            }\n            let fc_filter;\n            if ($('#luckysheet-filter-orderby-color-submenu #filterFcColor').length > 0) {\n                fc_filter = true;\n            } else {\n                fc_filter = false;\n            }\n            let $menu = $('#luckysheet-filter-menu');\n            let st_r = $menu.data('str'), ed_r = $menu.data('edr'), cindex = $menu.data('cindex'), st_c = $menu.data('stc'), ed_c = $menu.data('edc');\n            let rowhiddenother = {};    //其它筛选列的隐藏行\n            //其它筛选列的隐藏行\n            $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').not($('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').eq(cindex - st_c).get(0)).each(function () {\n                let $t = $(this), rh = $t.data('rowhidden');\n                if (rh == '') {\n                    return true;\n                }\n                rh = JSON.parse(rh);\n                for (let r in rh) {\n                    rowhiddenother[r] = 0;\n                }\n            });\n            let filterdata = {};\n            let rowhidden = {};\n            let caljs = {};\n            let af_compute = alternateformat.getComputeMap();\n            let cf_compute = conditionformat.getComputeMap();\n            for (let r = st_r + 1; r <= ed_r; r++) {\n                if (r in rowhiddenother) {\n                    continue;\n                }\n                if (Store.flowdata[r] == null) {\n                    continue;\n                }\n                let cell = Store.flowdata[r][cindex];    //单元格颜色\n                //单元格颜色\n                let bg = menuButton.checkstatus(Store.flowdata, r, cindex, 'bg');\n                let checksAF = alternateformat.checksAF(r, cindex, af_compute);\n                if (checksAF != null) {\n                    //若单元格有交替颜色\n                    bg = checksAF[1];\n                }\n                let checksCF = conditionformat.checksCF(r, cindex, cf_compute);\n                if (checksCF != null && checksCF['cellColor'] != null) {\n                    //若单元格有条件格式\n                    bg = checksCF['cellColor'];\n                }    // bg maybe null\n                // bg maybe null\n                bg = bg == null ? '#ffffff' : bg;\n                if (bg.indexOf('rgb') > -1) {\n                    bg = rgbTohex(bg);\n                }\n                if (bg.length == 4) {\n                    bg = bg.substr(0, 1) + bg.substr(1, 1).repeat(2) + bg.substr(2, 1).repeat(2) + bg.substr(3, 1).repeat(2);\n                }    //文本颜色\n                //文本颜色\n                let fc = menuButton.checkstatus(Store.flowdata, r, cindex, 'fc');\n                if (checksAF != null) {\n                    //若单元格有交替颜色\n                    fc = checksAF[0];\n                }\n                if (checksCF != null && checksCF['textColor'] != null) {\n                    //若单元格有条件格式\n                    fc = checksCF['textColor'];\n                }\n                if (fc.indexOf('rgb') > -1) {\n                    fc = rgbTohex(fc);\n                }\n                if (fc.length == 4) {\n                    fc = fc.substr(0, 1) + fc.substr(1, 1).repeat(2) + fc.substr(2, 1).repeat(2) + fc.substr(3, 1).repeat(2);\n                }\n                if (bg_filter && fc_filter) {\n                    if (!(bg in bg_colorMap) && (!(fc in fc_colorMap) || cell == null || isRealNull(cell.v))) {\n                        rowhidden[r] = 0;\n                    }\n                } else if (bg_filter) {\n                    if (!(bg in bg_colorMap)) {\n                        rowhidden[r] = 0;\n                    }\n                } else if (fc_filter) {\n                    if (!(fc in fc_colorMap) || cell == null || isRealNull(cell.v)) {\n                        rowhidden[r] = 0;\n                    }\n                }\n            }\n            let $top = $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').eq(cindex - st_c);\n            let optionstate = Object.keys(rowhidden).length > 0;\n            let rowhiddenall = $.extend(true, rowhiddenother, rowhidden), rowhidenPre = json.parseJsonParm($top.data('rowhidden'));\n            labelFilterOptionState($top, optionstate, rowhidden, caljs, true, st_r, ed_r, cindex, st_c, ed_c);\n            let cfg = $.extend(true, {}, Store.config);\n            cfg['rowhidden'] = rowhiddenall;    //保存撤销\n            //保存撤销\n            if (Store.clearjfundo) {\n                let redo = {};\n                redo['type'] = 'datachangeAll_filter';\n                redo['sheetIndex'] = Store.currentSheetIndex;\n                redo['config'] = $.extend(true, {}, Store.config);\n                redo['curconfig'] = cfg;\n                redo['optionstate'] = optionstate;\n                redo['optionsindex'] = cindex - st_c;\n                redo['rowhidden'] = $.extend(true, {}, rowhidden);\n                redo['rowhidenPre'] = $.extend(true, {}, rowhidenPre);\n                if (caljs != null) {\n                    redo['caljs'] = caljs;\n                }\n                Store.jfundo.length = 0;\n                Store.jfredo.push(redo);\n            }    //config\n            //config\n            Store.config = cfg;\n            Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n            server.saveParam('cg', Store.currentSheetIndex, cfg['rowhidden'], { 'k': 'rowhidden' });    //行高、列宽 刷新  \n            //行高、列宽 刷新  \n            jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            $('#luckysheet-filter-menu, #luckysheet-filter-submenu, #luckysheet-filter-orderby-color-submenu').hide();\n            cleargridelement();\n        });    //点击复选框\n        //点击复选框\n        $(document).off('click.filterCheckbox1').on('click.filterCheckbox1', '#luckysheet-filter-byvalue-select .textBox', function () {\n            if ($(this).attr('data-check') == 'true') {\n                $(this).attr('data-check', 'false');\n                $(this).find(\"input[type='checkbox']\").removeAttr('checked');\n            } else {\n                $(this).attr('data-check', 'true');\n                $(this).find(\"input[type='checkbox']\").prop('checked', true);\n            }\n        });\n        $(document).off('click.filterCheckbox2').on('click.filterCheckbox2', '#luckysheet-filter-byvalue-select .year', function () {\n            if ($(this).attr('data-check') == 'true') {\n                $(this).attr('data-check', 'false');\n                $(this).parents('.yearBox').find('.month').attr('data-check', 'false');\n                $(this).parents('.yearBox').find('.day').attr('data-check', 'false');\n                $(this).parents('.yearBox').find(\"input[type='checkbox']\").removeAttr('checked');\n            } else {\n                $(this).attr('data-check', 'true');\n                $(this).parents('.yearBox').find('.month').attr('data-check', 'true');\n                $(this).parents('.yearBox').find('.day').attr('data-check', 'true');\n                $(this).parents('.yearBox').find(\"input[type='checkbox']\").prop('checked', true);\n            }\n        });\n        $(document).off('click.filterCheckbox3').on('click.filterCheckbox3', '#luckysheet-filter-byvalue-select .month', function () {\n            //月份 对应的 天\n            if ($(this).attr('data-check') == 'true') {\n                $(this).attr('data-check', 'false');\n                $(this).parents('.monthBox').find('.day').attr('data-check', 'false');\n                $(this).parents('.monthBox').find(\"input[type='checkbox']\").removeAttr('checked');\n            } else {\n                $(this).attr('data-check', 'true');\n                $(this).parents('.monthBox').find('.day').attr('data-check', 'true');\n                $(this).parents('.monthBox').find(\"input[type='checkbox']\").prop('checked', true);\n            }    //月份 对应的 年份\n            //月份 对应的 年份\n            let yearDayAllCheck = true;\n            let $yearDay = $(this).parents('.yearBox').find('.day');\n            $yearDay.each(function (i, e) {\n                if ($(e).attr('data-check') == 'true') {\n                } else {\n                    yearDayAllCheck = false;\n                }\n            });\n            if (yearDayAllCheck) {\n                $(this).parents('.yearBox').find('.year').attr('data-check', 'true');\n                $(this).parents('.yearBox').find(\".year input[type='checkbox']\").prop('checked', true);\n            } else {\n                $(this).parents('.yearBox').find('.year').attr('data-check', 'false');\n                $(this).parents('.yearBox').find(\".year input[type='checkbox']\").removeAttr('checked');\n            }\n        });\n        $(document).off('click.filterCheckbox4').on('click.filterCheckbox4', '#luckysheet-filter-byvalue-select .day', function () {\n            if ($(this).attr('data-check') == 'true') {\n                $(this).attr('data-check', 'false');\n                $(this).find(\"input[type='checkbox']\").removeAttr('checked');\n            } else {\n                $(this).attr('data-check', 'true');\n                $(this).find(\"input[type='checkbox']\").prop('checked', true);\n            }    //天 对应的 月份\n            //天 对应的 月份\n            let monthDayAllCheck = true;\n            let $monthDay = $(this).parents('.monthBox').find('.day');\n            $monthDay.each(function (i, e) {\n                if ($(e).attr('data-check') == 'true') {\n                } else {\n                    monthDayAllCheck = false;\n                }\n            });\n            if (monthDayAllCheck) {\n                $(this).parents('.monthBox').find('.month').attr('data-check', 'true');\n                $(this).parents('.monthBox').find(\".month input[type='checkbox']\").prop('checked', true);\n            } else {\n                $(this).parents('.monthBox').find('.month').attr('data-check', 'false');\n                $(this).parents('.monthBox').find(\".month input[type='checkbox']\").removeAttr('checked');\n            }    //天 对应的 年份\n            //天 对应的 年份\n            let yearDayAllCheck = true;\n            let $yearDay = $(this).parents('.yearBox').find('.day');\n            $yearDay.each(function (i, e) {\n                if ($(e).attr('data-check') == 'true') {\n                } else {\n                    yearDayAllCheck = false;\n                }\n            });\n            if (yearDayAllCheck) {\n                $(this).parents('.yearBox').find('.year').attr('data-check', 'true');\n                $(this).parents('.yearBox').find(\".year input[type='checkbox']\").prop('checked', true);\n            } else {\n                $(this).parents('.yearBox').find('.year').attr('data-check', 'false');\n                $(this).parents('.yearBox').find(\".year input[type='checkbox']\").removeAttr('checked');\n            }\n        });    //日期 三级下拉显示\n        //日期 三级下拉显示\n        $(document).off('click.filterYearDropdown').on('click.filterYearDropdown', '#luckysheet-filter-byvalue-select .yearBox .fa-caret-right', function (event) {\n            let $p = $(this).parents('.luckysheet-mousedown-cancel');\n            if ($p.hasClass('year')) {\n                $(this).parents('.yearBox').find('.monthList').slideToggle();\n            }\n            if ($p.hasClass('month')) {\n                $(this).parents('.monthBox').find('.dayList').slideToggle();\n            }\n            event.stopPropagation();\n        });    //全选\n        //全选\n        $('#luckysheet-filter-byvalue-btn-all').click(function () {\n            $(\"#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']\").prop('checked', true);\n            $(\"#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']\").parents('.luckysheet-mousedown-cancel').attr('data-check', 'true');\n        });    //清除\n        //清除\n        $('#luckysheet-filter-byvalue-btn-clear').click(function () {\n            $(\"#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']\").removeAttr('checked');\n            $(\"#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']\").parents('.luckysheet-mousedown-cancel').attr('data-check', 'false');\n        });    //反选\n        //反选\n        $('#luckysheet-filter-byvalue-btn-contra').click(function () {\n            let $input = $(\"#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']\");\n            $input.each(function (i, e) {\n                if ($(e).is(':checked')) {\n                    $(e).removeAttr('checked');\n                    $(e).parents('.luckysheet-mousedown-cancel').attr('data-check', 'false');\n                } else {\n                    $(e).prop('checked', true);\n                    $(e).parents('.luckysheet-mousedown-cancel').attr('data-check', 'true');\n                }\n            });    //天 对应的 月份\n            //天 对应的 月份\n            let $month = $('#luckysheet-filter-byvalue-select .ListBox .monthBox');\n            $month.each(function (index, event) {\n                let monthDayAllCheck = true;\n                let $monthDay = $(event).find(\".day input[type='checkbox']\");\n                $monthDay.each(function (i, e) {\n                    if ($(e).is(':checked')) {\n                    } else {\n                        monthDayAllCheck = false;\n                    }\n                });\n                if (monthDayAllCheck) {\n                    $(event).find(\".month input[type='checkbox']\").prop('checked', true);\n                    $(event).attr('data-check', 'true');\n                } else {\n                    $(event).find(\".month input[type='checkbox']\").removeAttr('checked');\n                    $(event).attr('data-check', 'false');\n                }\n            });    //天 对应的 年份\n            //天 对应的 年份\n            let $year = $('#luckysheet-filter-byvalue-select .ListBox .yearBox');\n            $year.each(function (index, event) {\n                let yearDayAllCheck = true;\n                let $yearDay = $(event).find(\".day input[type='checkbox']\");\n                $yearDay.each(function (i, e) {\n                    if ($(e).is(':checked')) {\n                    } else {\n                        yearDayAllCheck = false;\n                    }\n                });\n                if (yearDayAllCheck) {\n                    $(event).find(\".year input[type='checkbox']\").prop('checked', true);\n                    $(event).attr('data-check', 'true');\n                } else {\n                    $(event).find(\".year input[type='checkbox']\").removeAttr('checked');\n                    $(event).attr('data-check', 'false');\n                }\n            });\n        });    //清除筛选\n        //清除筛选\n        $('#luckysheet-filter-initial').click(function () {\n            if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'filter')) {\n                return;\n            }\n            $('#luckysheet-filter-menu .luckysheet-filter-selected-input').hide().find('input').val();\n            $('#luckysheet-filter-selected span').data('type', '0').data('type', null).text(locale_filter.conditionNone);\n            let redo = {};\n            redo['type'] = 'datachangeAll_filter_clear';\n            redo['sheetIndex'] = Store.currentSheetIndex;\n            redo['config'] = $.extend(true, {}, Store.config);\n            Store.config['rowhidden'] = {};\n            redo['curconfig'] = $.extend(true, {}, Store.config);\n            redo['filter_save'] = $.extend(true, {}, Store.luckysheet_filter_save);\n            let optiongroups = [];\n            $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').each(function () {\n                let $t = $(this);\n                let optionstate = $t.hasClass('luckysheet-filter-options-active');\n                let rowhidden = json.parseJsonParm($t.data('rowhidden'));\n                let caljs = json.parseJsonParm($t.data('caljs'));\n                optiongroups.push({\n                    'optionstate': optionstate,\n                    'rowhidden': rowhidden,\n                    'caljs': caljs,\n                    'str': $t.data('str'),\n                    'edr': $t.data('edr'),\n                    'cindex': $t.data('cindex'),\n                    'stc': $t.data('stc'),\n                    'edc': $t.data('edc')\n                });\n            });\n            redo['optiongroups'] = optiongroups;\n            Store.jfundo.length = 0;\n            Store.jfredo.push(redo);\n            $('#luckysheet-filter-selected-sheet' + Store.currentSheetIndex + ', #luckysheet-filter-options-sheet' + Store.currentSheetIndex).remove();\n            $('#luckysheet-filter-menu, #luckysheet-filter-submenu').hide();    //清除筛选发送给后台\n            //清除筛选发送给后台\n            Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].filter = null;\n            Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].filter_select = null;\n            server.saveParam('fsc', Store.currentSheetIndex, null);    //config\n            //config\n            Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n            server.saveParam('cg', Store.currentSheetIndex, {}, { 'k': 'rowhidden' });    //行高、列宽 刷新  \n            //行高、列宽 刷新  \n            jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n        });    //按照值进行筛选\n        //按照值进行筛选\n        $('#luckysheet-filter-byvalue-input').on('input propertychange', function () {\n            let v = $(this).val().toString();\n            $('#luckysheet-filter-byvalue-select .ListBox .luckysheet-mousedown-cancel').show();\n            if (v != '') {\n                $(\"#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']\").each(function (i, e) {\n                    if ($(e).closest('.day').length > 0) {\n                        let day = $(e).siblings('label').text().toString();\n                        let month = $(e).closest('.monthBox').find('.month label').text().toString();\n                        let year = $(e).closest('.yearBox').find('.year label').text().toString();\n                        let itemV = year + '-' + month + '-' + day;\n                        if (itemV.indexOf(v) == -1) {\n                            $(e).closest('.day').hide();    //天 对应的 月份\n                            //天 对应的 月份\n                            let $monthDay = $(e).closest('.dayList').find('.day:visible');\n                            if ($monthDay.length == 0) {\n                                $(e).closest('.monthBox').find('.month').hide();\n                            }    //天 对应的 年份\n                            //天 对应的 年份\n                            let $yearDay = $(e).closest('.monthList').find('.day:visible');\n                            if ($yearDay.length == 0) {\n                                $(e).closest('.yearBox').find('.year').hide();\n                            }\n                        }\n                    }\n                    if ($(e).closest('.textBox').length > 0) {\n                        let itemV = $(e).siblings('label').text().toString();\n                        if (itemV.indexOf(v) == -1) {\n                            $(e).parents('.textBox').hide();\n                        }\n                    }\n                });\n            }\n        });    //筛选取消\n        //筛选取消\n        $('#luckysheet-filter-cancel').click(function () {\n            $('#luckysheet-filter-menu, #luckysheet-filter-submenu').hide();\n        });    //筛选 确认\n        //筛选 确认\n        $('#luckysheet-filter-confirm').click(function () {\n            let $menu = $('#luckysheet-filter-menu');\n            let st_r = $menu.data('str'), ed_r = $menu.data('edr'), cindex = $menu.data('cindex'), st_c = $menu.data('stc'), ed_c = $menu.data('edc');\n            let rowhiddenother = {};    //其它筛选列的隐藏行\n            //其它筛选列的隐藏行\n            $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').not($('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').eq(cindex - st_c).get(0)).each(function () {\n                let $t = $(this), rh = $t.data('rowhidden');\n                if (rh == '') {\n                    return true;\n                }\n                rh = JSON.parse(rh.replace(/\\'/g, '\"'));\n                for (let r in rh) {\n                    rowhiddenother[r] = 0;\n                }\n            });\n            let filterdata = {};\n            let rowhidden = {};\n            let caljs = {};\n            if ($('#luckysheet-filter-bycondition').next().is(':visible') && $('#luckysheet-filter-byvalue').next().is(':hidden') && $('#luckysheet-filter-selected span').data('value') != 'null') {\n                let $t = $('#luckysheet-filter-selected span');\n                let type = $t.data('type'), value = $t.data('value');\n                caljs['value'] = value;\n                caljs['text'] = $t.text();\n                if (type == '0') {\n                    caljs['type'] = '0';\n                } else if (type == '2') {\n                    let $input = $('#luckysheet-filter-menu .luckysheet-filter-selected-input2 input');\n                    caljs['type'] = '2';\n                    caljs['value1'] = $input.eq(0).val();\n                    caljs['value2'] = $input.eq(1).val();\n                } else {\n                    caljs['type'] = '1';\n                    caljs['value1'] = $('#luckysheet-filter-menu .luckysheet-filter-selected-input').eq(0).find('input').val();\n                }\n                for (let r = st_r + 1; r <= ed_r; r++) {\n                    if (r in rowhiddenother) {\n                        continue;\n                    }\n                    if (Store.flowdata[r] == null) {\n                        continue;\n                    }\n                    let cell = Store.flowdata[r][cindex];\n                    if (value == 'cellnull') {\n                        //单元格为空\n                        if (cell != null && !isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'cellnonull') {\n                        //单元格有数据\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'textinclude') {\n                        //文本包含 \n                        let value1 = caljs['value1'];\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else {\n                            if (cell.m.indexOf(value1) == -1) {\n                                rowhidden[r] = 0;\n                            }\n                        }\n                    } else if (value == 'textnotinclude') {\n                        //文本不包含\n                        let value1 = caljs['value1'];\n                        if (cell == null || isRealNull(cell.v)) {\n                        } else {\n                            if (cell.m.indexOf(value1) > -1) {\n                                rowhidden[r] = 0;\n                            }\n                        }\n                    } else if (value == 'textstart') {\n                        //文本开头为\n                        let value1 = caljs['value1'], valuelen = value1.length;\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else {\n                            if (cell.m.substr(0, valuelen) != value1) {\n                                rowhidden[r] = 0;\n                            }\n                        }\n                    } else if (value == 'textend') {\n                        //文本结尾为\n                        let value1 = caljs['value1'], valuelen = value1.length;\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else {\n                            if (valuelen > cell.m.length || cell.m.substr(cell.m.length - valuelen, valuelen) != value1) {\n                                rowhidden[r] = 0;\n                            }\n                        }\n                    } else if (value == 'textequal') {\n                        //文本等于\n                        let value1 = caljs['value1'];\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else {\n                            if (cell.m != value1) {\n                                rowhidden[r] = 0;\n                            }\n                        }\n                    } else if (value == 'dateequal') {\n                        //日期等于\n                        let value1 = genarate(caljs['value1'])[2];\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else if (cell.ct != null && cell.ct.t == 'd') {\n                            if (parseInt(cell.v) != value1) {\n                                rowhidden[r] = 0;\n                            }\n                        } else {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'datelessthan') {\n                        //日期早于\n                        let value1 = genarate(caljs['value1'])[2];\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else if (cell.ct != null && cell.ct.t == 'd') {\n                            if (parseInt(cell.v) >= value1) {\n                                rowhidden[r] = 0;\n                            }\n                        } else {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'datemorethan') {\n                        //日期晚于\n                        let value1 = genarate(caljs['value1'])[2];\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else if (cell.ct != null && cell.ct.t == 'd') {\n                            if (parseInt(cell.v) <= value1) {\n                                rowhidden[r] = 0;\n                            }\n                        } else {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'morethan') {\n                        //大于\n                        let value1 = parseFloat(caljs['value1']);\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else if (cell.ct != null && cell.ct.t == 'n') {\n                            if (cell.v <= value1) {\n                                rowhidden[r] = 0;\n                            }\n                        } else {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'moreequalthan') {\n                        //大于等于\n                        let value1 = parseFloat(caljs['value1']);\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else if (cell.ct != null && cell.ct.t == 'n') {\n                            if (cell.v < value1) {\n                                rowhidden[r] = 0;\n                            }\n                        } else {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'lessthan') {\n                        //小于\n                        let value1 = parseFloat(caljs['value1']);\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else if (cell.ct != null && cell.ct.t == 'n') {\n                            if (cell.v >= value1) {\n                                rowhidden[r] = 0;\n                            }\n                        } else {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'lessequalthan') {\n                        //小于等于\n                        let value1 = parseFloat(caljs['value1']);\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else if (cell.ct != null && cell.ct.t == 'n') {\n                            if (cell.v > value1) {\n                                rowhidden[r] = 0;\n                            }\n                        } else {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'equal') {\n                        //等于\n                        let value1 = parseFloat(caljs['value1']);\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else if (cell.ct != null && cell.ct.t == 'n') {\n                            if (cell.v != value1) {\n                                rowhidden[r] = 0;\n                            }\n                        } else {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'noequal') {\n                        //不等于\n                        let value1 = parseFloat(caljs['value1']);\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else if (cell.ct != null && cell.ct.t == 'n') {\n                            if (cell.v == value1) {\n                                rowhidden[r] = 0;\n                            }\n                        } else {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'include') {\n                        //介于\n                        let value1 = parseFloat(caljs['value1']), value2 = parseFloat(caljs['value2']);\n                        let min, max;\n                        if (value1 < value2) {\n                            min = value1;\n                            max = value2;\n                        } else {\n                            max = value1;\n                            min = value2;\n                        }\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else if (cell.ct != null && cell.ct.t == 'n') {\n                            if (cell.v < min || cell.v > max) {\n                                rowhidden[r] = 0;\n                            }\n                        } else {\n                            rowhidden[r] = 0;\n                        }\n                    } else if (value == 'noinclude') {\n                        //不在其中\n                        let value1 = parseFloat(caljs['value1']), value2 = parseFloat(caljs['value2']);\n                        let min, max;\n                        if (value1 < value2) {\n                            min = value1;\n                            max = value2;\n                        } else {\n                            max = value1;\n                            min = value2;\n                        }\n                        if (cell == null || isRealNull(cell.v)) {\n                            rowhidden[r] = 0;\n                        } else if (cell.ct != null && cell.ct.t == 'n') {\n                            if (cell.v >= min && cell.v <= max) {\n                                rowhidden[r] = 0;\n                            }\n                        } else {\n                            rowhidden[r] = 0;\n                        }\n                    }\n                }\n            } else {\n                $(\"#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']\").each(function (i, e) {\n                    if ($(e).is(':visible') && $(e).is(':checked')) {\n                        return true;\n                    }\n                    if ($(e).closest('.day').length > 0) {\n                        let day = $(e).siblings('label').text();\n                        if (Number(day) < 10) {\n                            day = '0' + Number(day);\n                        }\n                        let month = $(e).closest('.monthBox').find('.month label').text().replace(locale_filter.filiterMonthText, '');\n                        if (Number(month) < 10) {\n                            month = '0' + Number(month);\n                        }\n                        let year = $(e).closest('.yearBox').find('.year label').text().replace(locale_filter.filiterYearText, '');\n                        let itemV = locale_filter.filterDateFormatTip + '#$$$#' + year + '-' + month + '-' + day;\n                        filterdata[itemV] = '1';\n                    }\n                    if ($(e).closest('.textBox').length > 0) {\n                        let itemV = $(e).closest('.textBox').data('filter');\n                        filterdata[itemV] = '1';\n                    }\n                });\n                for (let r = st_r + 1; r <= ed_r; r++) {\n                    if (r in rowhiddenother) {\n                        continue;\n                    }\n                    if (Store.flowdata[r] == null) {\n                        continue;\n                    }\n                    let cell = Store.flowdata[r][cindex];\n                    let value;\n                    if (cell == null || isRealNull(cell.v)) {\n                        value = 'null#$$$#null';\n                    } else if (cell.ct != null && cell.ct.t == 'd') {\n                        let fmt = update('YYYY-MM-DD', cell.v);\n                        value = locale_filter.filterDateFormatTip + '#$$$#' + fmt;\n                    } else {\n                        value = cell.v + '#$$$#' + cell.m;\n                    }\n                    if (value in filterdata) {\n                        rowhidden[r] = 0;\n                    }\n                }\n            }\n            let $top = $('#luckysheet-filter-options-sheet' + Store.currentSheetIndex + ' .luckysheet-filter-options').eq(cindex - st_c);\n            let optionstate = $(\"#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible:checked\").length < $(\"#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible\").length || $('#luckysheet-filter-byvalue-input').val().length > 0 || $('#luckysheet-filter-bycondition').next().is(':visible') && $('#luckysheet-filter-byvalue').next().is(':hidden') && $('#luckysheet-filter-selected span').data('value') != 'null';\n            let rowhiddenall = $.extend(true, rowhiddenother, rowhidden), rowhidenPre = json.parseJsonParm($top.data('rowhidden'));\n            labelFilterOptionState($top, optionstate, rowhidden, caljs, true, st_r, ed_r, cindex, st_c, ed_c);\n            let cfg = $.extend(true, {}, Store.config);\n            cfg['rowhidden'] = rowhiddenall;    //保存撤销\n            //保存撤销\n            if (Store.clearjfundo) {\n                let redo = {};\n                redo['type'] = 'datachangeAll_filter';\n                redo['sheetIndex'] = Store.currentSheetIndex;\n                redo['config'] = $.extend(true, {}, Store.config);\n                redo['curconfig'] = cfg;\n                redo['optionstate'] = optionstate;\n                redo['optionsindex'] = cindex - st_c;\n                redo['rowhidden'] = $.extend(true, {}, rowhidden);\n                redo['rowhidenPre'] = $.extend(true, {}, rowhidenPre);\n                if (caljs != null) {\n                    redo['caljs'] = caljs;\n                }\n                Store.jfundo.length = 0;\n                Store.jfredo.push(redo);\n            }    //config\n            //config\n            Store.config = cfg;\n            Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n            server.saveParam('cg', Store.currentSheetIndex, cfg['rowhidden'], { 'k': 'rowhidden' });    //行高、列宽 刷新  \n            //行高、列宽 刷新  \n            jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            $('#luckysheet-filter-menu, #luckysheet-filter-submenu').hide();\n            cleargridelement();\n        });\n    }\n    return {\n        labelFilterOptionState,\n        orderbydatafiler,\n        createFilter,\n        createFilterOptions,\n        initialFilterHandler\n    };\n});"]}