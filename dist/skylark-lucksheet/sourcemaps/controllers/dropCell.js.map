{"version":3,"sources":["controllers/dropCell.js"],"names":["define","m_location","m_count","m_border","m_validate","m_format","formula","conditionformat","m_protection","m_select","m_get","m_util","Store","locale","dayjs","rowLocationByIndex","colLocationByIndex","countfunc","getBorderInfoCompute","isRealNum","genarate","update","checkProtectionLockedRangeList","selectHightlightShow","getSheetIndex","getObjType","replaceHtml","iconHtml","typeListHtml","copyRange","applyRange","applyType","direction","chnNumChar","零","一","二","三","四","五","六","七","八","九","chnNameValue","十","value","secUnit","百","千","万","亿","ChineseToNumber","chnStr","_this","this","rtn","section","number","str","split","i","length","num","unit","chnNumChar2","chnUnitSection","chnUnitChar","SectionToChinese","strIns","unitPos","zero","v","Math","floor","NumberToChinese","needZero","isChnNumber","txt","isExtendNumber","reg","test","match","matchTxt","matchIndex","lastIndexOf","beforeTxt","substr","afterTxt","Number","isChnWeek1","isChnWeek2","isChnWeek3","createIcon","row_index","col_index","copy_r","copy_c","apply_r","apply_c","row","col","$","remove","append","css","left","top","mouseover","mouseleave","mousedown","event","locale_dropCell","dropCell","copyCell","sequence","onlyFormat","noFormat","day","workDay","month","year","chineseNumber","typeItemHide","hide","offset","winH","window","height","winW","width","menuW","menuH","show","type","find","stopPropagation","document","off","on","attr","str_r","end_r","str_c","end_c","hasNumber","hasExtendNumber","hasDate","hasChn","hasChnWeek1","hasChnWeek2","hasChnWeek3","r","c","flowdata","cell","t","currentSheetIndex","allowEdit","csLen","d","deepCopyFlowData","file","luckysheetfile","cfg","extend","config","borderInfoCompute","dataVerification","copy_str_r","copy_end_r","copy_str_c","copy_end_c","copyData","getCopyData","apply_str_r","apply_end_r","apply_str_c","apply_end_c","asLen","copyD","applyData","getApplyData","j","f","functionCopy","execfunction","execFunctionGroup","undefined","spl","data","Infinity","m","toString","indexOf","len","toExponential","mask","round","ct","fa","bd_r","bd_c","bd_obj","rangeType","l","b","push","cdformat","cdformat_cellrange","cellrange","emptyRange","range","CFSplitRange","column","concat","allParam","refreshRange","luckysheet_select_save","r1","r2","c1","c2","a1","a2","b1","b2","a","obj","arrData","arrIndex","text","extendNumberBeforeStr","extendNumberAfterStr","isSameStr","index","rsd","copyD_number","applyD_number","s","getLenS","getDataByType","getDataIndex","copyD_extendNumber","applyD_extendNumber","copyD_date","applyD_date","copyD_chnNumber","applyD_chnNumber","copyD_chnWeek2","applyD_chnWeek2","copyD_chnWeek3","applyD_chnWeek3","copyD_other","applyD_other","x","y","indexArr","sum","dataType","reverse","FillCopy","FillSeries","step","FillExtendNumber","dataNumArr","isEqualDiff","FillDays","judgeDate","diff","FillMonths","FillChnWeek","FillChnNumber","hasweek","weekIndex","FillChnWeek2","lastTxt","FillChnWeek3","FillOnlyFormat","dataArr","FillWithoutFormat","newLen","add","date","format","subtract","abs","step_month","ceil","step_day","FillYears","step_year","isEqualRatio","pow","xArr","getXArr","forecast","last","lastIndex","valueTxt","arr","ratio","yArr","getAverage","ax","ay","sum_d","sum_n","isSameDay","isSameMonth","isEqualDiffDays","isEqualDiffMonths","isEqualDiffYears","sameDay","sameMonth","equalDiffDays","equalDiffMonths","equalDiffYears"],"mappings":"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","file":"../../controllers/dropCell.js","sourcesContent":["define([\n    '../methods/location',\n    '../methods/count',\n    '../methods/border',\n    '../methods/validate',\n    '../methods/format',\n    '../methods/formula_methods',\n    '../methods/conditionformat_methods',\n    '../methods/protection_methods',\n    '../widgets/select',\n    '../methods/get',\n    '../utils/util',\n    '../store',\n    '../locale/locale',\n    'skylark-moment'\n], function (m_location, m_count, m_border, m_validate, m_format,  formula, conditionformat, m_protection, m_select, m_get, m_util, Store, locale, dayjs) {\n    'use strict';\n    const {rowLocationByIndex, colLocationByIndex} = m_location;\n    const {countfunc} = m_count;\n    const {getBorderInfoCompute} = m_border;\n    const {isRealNum} = m_validate;\n    const {genarate, update} = m_format;\n    const {checkProtectionLockedRangeList} = m_protection;\n    const {selectHightlightShow} = m_select;\n    const {getSheetIndex} = m_get;\n    const {getObjType, replaceHtml} = m_util;\n    //选区下拉\n    const luckysheetDropCell = {\n        iconHtml: '<div id=\"luckysheet-dropCell-icon\" style=\"position: absolute;padding: 2px;background-color: #f1f1f1;z-index: 990;cursor: pointer;\">' + '<div id=\"icon_dropCell\"></div>' + '</div>',\n        typeListHtml: '<div id=\"luckysheet-dropCell-typeList\" class=\"luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel\">' + '<div class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" data-type=\"0\">' + '<div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\" style=\"padding: 3px 2px;\">' + '<span style=\"margin-right:5px;width:13px;display:inline-block;\" class=\"icon luckysheet-mousedown-cancel\"></span>${copyCell}' + '</div>' + '</div>' + '<div class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" data-type=\"1\">' + '<div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\" style=\"padding: 3px 2px;\">' + '<span style=\"margin-right:5px;width:13px;display:inline-block;\" class=\"icon luckysheet-mousedown-cancel\"></span>${sequence}' + '</div>' + '</div>' + '<div class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" data-type=\"2\">' + '<div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\" style=\"padding: 3px 2px;\">' + '<span style=\"margin-right:5px;width:13px;display:inline-block;\" class=\"icon luckysheet-mousedown-cancel\"></span>${onlyFormat}' + '</div>' + '</div>' + '<div class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" data-type=\"3\">' + '<div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\" style=\"padding: 3px 2px;\">' + '<span style=\"margin-right:5px;width:13px;display:inline-block;\" class=\"icon luckysheet-mousedown-cancel\"></span>${noFormat}' + '</div>' + '</div>' + '<div class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" data-type=\"4\">' + '<div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\" style=\"padding: 3px 2px;\">' + '<span style=\"margin-right:5px;width:13px;display:inline-block;\" class=\"icon luckysheet-mousedown-cancel\"></span>${day}' + '</div>' + '</div>' + '<div class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" data-type=\"5\">' + '<div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\" style=\"padding: 3px 2px;\">' + '<span style=\"margin-right:5px;width:13px;display:inline-block;\" class=\"icon luckysheet-mousedown-cancel\"></span>${workDay}' + '</div>' + '</div>' + '<div class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" data-type=\"6\">' + '<div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\" style=\"padding: 3px 2px;\">' + '<span style=\"margin-right:5px;width:13px;display:inline-block;\" class=\"icon luckysheet-mousedown-cancel\"></span>${month}' + '</div>' + '</div>' + '<div class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" data-type=\"7\">' + '<div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\" style=\"padding: 3px 2px;\">' + '<span style=\"margin-right:5px;width:13px;display:inline-block;\" class=\"icon luckysheet-mousedown-cancel\"></span>${year}' + '</div>' + '</div>' + '<div class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" data-type=\"8\">' + '<div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\" style=\"padding: 3px 2px;\">' + '<span style=\"margin-right:5px;width:13px;display:inline-block;\" class=\"icon luckysheet-mousedown-cancel\"></span>${chineseNumber}' + '</div>' + '</div>' + '</div>',\n        copyRange: {},\n        //复制范围\n        applyRange: {},\n        //应用范围\n        applyType: null,\n        //0复制单元格，1填充序列，2仅填充格式，3不带格式填充，4以天数填充，5以工作日填充，6以月填充，7以年填充，8以中文小写数字序列填充\n        direction: null,\n        //down-往下拖拽，right-往右拖拽，up-往上拖拽，left-往左拖拽\n        chnNumChar: {\n            '零': 0,\n            '一': 1,\n            '二': 2,\n            '三': 3,\n            '四': 4,\n            '五': 5,\n            '六': 6,\n            '七': 7,\n            '八': 8,\n            '九': 9\n        },\n        chnNameValue: {\n            '十': {\n                value: 10,\n                secUnit: false\n            },\n            '百': {\n                value: 100,\n                secUnit: false\n            },\n            '千': {\n                value: 1000,\n                secUnit: false\n            },\n            '万': {\n                value: 10000,\n                secUnit: true\n            },\n            '亿': {\n                value: 100000000,\n                secUnit: true\n            }\n        },\n        ChineseToNumber: function (chnStr) {\n            let _this = this;\n            let rtn = 0;\n            let section = 0;\n            let number = 0;\n            let secUnit = false;\n            let str = chnStr.split('');\n            for (let i = 0; i < str.length; i++) {\n                let num = _this.chnNumChar[str[i]];\n                if (typeof num != 'undefined') {\n                    number = num;\n                    if (i == str.length - 1) {\n                        section += number;\n                    }\n                } else {\n                    let unit = _this.chnNameValue[str[i]].value;\n                    secUnit = _this.chnNameValue[str[i]].secUnit;\n                    if (secUnit) {\n                        section = (section + number) * unit;\n                        rtn += section;\n                        section = 0;\n                    } else {\n                        section += number * unit;\n                    }\n                    number = 0;\n                }\n            }\n            return rtn + section;\n        },\n        chnNumChar2: [\n            '零',\n            '一',\n            '二',\n            '三',\n            '四',\n            '五',\n            '六',\n            '七',\n            '八',\n            '九'\n        ],\n        chnUnitSection: [\n            '',\n            '万',\n            '亿',\n            '万亿',\n            '亿亿'\n        ],\n        chnUnitChar: [\n            '',\n            '十',\n            '百',\n            '千'\n        ],\n        SectionToChinese: function (section) {\n            let _this = this;\n            let strIns = '', chnStr = '';\n            let unitPos = 0;\n            let zero = true;\n            while (section > 0) {\n                let v = section % 10;\n                if (v == 0) {\n                    if (!zero) {\n                        zero = true;\n                        chnStr = _this.chnNumChar2[v] + chnStr;\n                    }\n                } else {\n                    zero = false;\n                    strIns = _this.chnNumChar2[v];\n                    strIns += _this.chnUnitChar[unitPos];\n                    chnStr = strIns + chnStr;\n                }\n                unitPos++;\n                section = Math.floor(section / 10);\n            }\n            return chnStr;\n        },\n        NumberToChinese: function (num) {\n            let _this = this;\n            let unitPos = 0;\n            let strIns = '', chnStr = '';\n            let needZero = false;\n            if (num == 0) {\n                return _this.chnNumChar2[0];\n            }\n            while (num > 0) {\n                let section = num % 10000;\n                if (needZero) {\n                    chnStr = _this.chnNumChar2[0] + chnStr;\n                }\n                strIns = _this.SectionToChinese(section);\n                strIns += section != 0 ? _this.chnUnitSection[unitPos] : _this.chnUnitSection[0];\n                chnStr = strIns + chnStr;\n                needZero = section < 1000 && section > 0;\n                num = Math.floor(num / 10000);\n                unitPos++;\n            }\n            return chnStr;\n        },\n        isChnNumber: function (txt) {\n            let _this = this;\n            let isChnNumber = true;\n            if (txt.length == 1) {\n                if (txt == '日' || txt in _this.chnNumChar) {\n                    isChnNumber = true;\n                } else {\n                    isChnNumber = false;\n                }\n            } else {\n                let str = txt.split('');\n                for (let i = 0; i < str.length; i++) {\n                    if (!(str[i] in _this.chnNumChar || str[i] in _this.chnNameValue)) {\n                        isChnNumber = false;\n                        break;\n                    }\n                }\n            }\n            return isChnNumber;\n        },\n        isExtendNumber: function (txt) {\n            let reg = /0|([1-9]+[0-9]*)/g;\n            let isExtendNumber = reg.test(txt);\n            if (isExtendNumber) {\n                let match = txt.match(reg);\n                let matchTxt = match[match.length - 1];\n                let matchIndex = txt.lastIndexOf(matchTxt);\n                let beforeTxt = txt.substr(0, matchIndex);\n                let afterTxt = txt.substr(matchIndex + matchTxt.length);\n                return [\n                    isExtendNumber,\n                    Number(matchTxt),\n                    beforeTxt,\n                    afterTxt\n                ];\n            } else {\n                return [isExtendNumber];\n            }\n        },\n        isChnWeek1: function (txt) {\n            let _this = this;\n            let isChnWeek1;\n            if (txt.length == 1) {\n                if (txt == '日' || _this.ChineseToNumber(txt) < 7) {\n                    isChnWeek1 = true;\n                } else {\n                    isChnWeek1 = false;\n                }\n            } else {\n                isChnWeek1 = false;\n            }\n            return isChnWeek1;\n        },\n        isChnWeek2: function (txt) {\n            let isChnWeek2;\n            if (txt.length == 2) {\n                if (txt == '周一' || txt == '周二' || txt == '周三' || txt == '周四' || txt == '周五' || txt == '周六' || txt == '周日') {\n                    isChnWeek2 = true;\n                } else {\n                    isChnWeek2 = false;\n                }\n            } else {\n                isChnWeek2 = false;\n            }\n            return isChnWeek2;\n        },\n        isChnWeek3: function (txt) {\n            let isChnWeek3;\n            if (txt.length == 3) {\n                if (txt == '星期一' || txt == '星期二' || txt == '星期三' || txt == '星期四' || txt == '星期五' || txt == '星期六' || txt == '星期日') {\n                    isChnWeek3 = true;\n                } else {\n                    isChnWeek3 = false;\n                }\n            } else {\n                isChnWeek3 = false;\n            }\n            return isChnWeek3;\n        },\n        createIcon: function () {\n            let _this = this;\n            let copy_r = _this.copyRange['row'][1], copy_c = _this.copyRange['column'][1];\n            let apply_r = _this.applyRange['row'][1], apply_c = _this.applyRange['column'][1];\n            let row_index, col_index;\n            if (apply_r >= copy_r && apply_c >= copy_c) {\n                row_index = apply_r;\n                col_index = apply_c;\n            } else {\n                row_index = copy_r;\n                col_index = copy_c;\n            }\n            let row = rowLocationByIndex(row_index)[1], row_pre = rowLocationByIndex(row_index)[0];\n            let col = colLocationByIndex(col_index)[1], col_pre = colLocationByIndex(col_index)[0];\n            $('#luckysheet-dropCell-icon').remove();\n            $('#luckysheet-cell-main').append(_this.iconHtml);\n            $('#luckysheet-dropCell-icon').css({\n                'left': col,\n                'top': row\n            });   \n            //点击icon\n            $('#luckysheet-dropCell-icon').mouseover(function () {\n                $(this).css('background-color', '#ffe8e8');\n            }).mouseleave(function () {\n                $(this).css('background-color', '#f1f1f1');\n            }).mousedown(function (event) {\n                $('#luckysheet-dropCell-typeList').remove();\n                const _locale = locale();\n                const locale_dropCell = _locale.dropCell;\n                $('body').append(replaceHtml(_this.typeListHtml, {\n                    copyCell: locale_dropCell.copyCell,\n                    sequence: locale_dropCell.sequence,\n                    onlyFormat: locale_dropCell.onlyFormat,\n                    noFormat: locale_dropCell.noFormat,\n                    day: locale_dropCell.day,\n                    workDay: locale_dropCell.workDay,\n                    month: locale_dropCell.month,\n                    year: locale_dropCell.year,\n                    chineseNumber: locale_dropCell.chineseNumber\n                }));\n                let typeItemHide = _this.typeItemHide();\n                if (!typeItemHide[0] && !typeItemHide[1] && !typeItemHide[2] && !typeItemHide[3] && !typeItemHide[4] && !typeItemHide[5] && !typeItemHide[6]) {\n                    $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=1]').hide();\n                    $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]').hide();\n                    $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]').hide();\n                    $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]').hide();\n                    $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]').hide();\n                    $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]').hide();\n                }\n                if (!typeItemHide[2]) {\n                    $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]').hide();\n                    $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]').hide();\n                    $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]').hide();\n                    $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]').hide();\n                }\n                if (!typeItemHide[3]) {\n                    $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]').hide();\n                }\n                let left = $(this).offset().left;\n                let top = $(this).offset().top + 25;\n                let winH = $(window).height(), winW = $(window).width();\n                let menuW = $('#luckysheet-dropCell-typeList').width(), menuH = $('#luckysheet-dropCell-typeList').height();\n                if (left + menuW > winW) {\n                    left = left - menuW;\n                }\n                if (top + menuH > winH) {\n                    top = top - menuH - 38;\n                }\n                if (top < 0) {\n                    top = 0;\n                }\n                $('#luckysheet-dropCell-typeList').css({\n                    'left': left,\n                    'top': top\n                }).show();\n                $('#luckysheet-dropCell-icon').mouseleave(function () {\n                    $(this).css('backgroundColor', '#ffe8e8');\n                });\n                let type = _this.applyType;\n                $('#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=' + type + ']').find('span').append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                event.stopPropagation();\n            });    //点击数据填充类型\n            //点击数据填充类型\n            $(document).off('click.dCtypeList').on('click.dCtypeList', '#luckysheet-dropCell-typeList .luckysheet-cols-menuitem', function () {\n                $('#luckysheet-dropCell-typeList .fa-check').remove();\n                $(this).find('span').append('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n                let type = $(this).attr('data-type');\n                _this.applyType = type;\n                _this.update();\n                $('#luckysheet-dropCell-typeList').hide();\n                $('#luckysheet-dropCell-icon').css('backgroundColor', '#f1f1f1');\n                $('#luckysheet-dropCell-icon').mouseleave(function () {\n                    $(this).css('backgroundColor', '#f1f1f1');\n                });\n                countfunc();\n            });\n        },\n        typeItemHide: function () {\n            let _this = this;\n            let copyRange = _this.copyRange;\n            let str_r = copyRange['row'][0], end_r = copyRange['row'][1];\n            let str_c = copyRange['column'][0], end_c = copyRange['column'][1];\n            let hasNumber = false, hasExtendNumber = false, hasDate = false, hasChn = false, hasChnWeek1 = false, hasChnWeek2 = false, hasChnWeek3 = false;\n            for (let r = str_r; r <= end_r; r++) {\n                for (let c = str_c; c <= end_c; c++) {\n                    if (!!Store.flowdata[r][c]) {\n                        let cell = Store.flowdata[r][c];\n                        if (getObjType(cell) == 'object' && cell['v'] != null && cell['f'] == null) {\n                            if (cell['ct'] != null && cell['ct'].t == 'n') {\n                                hasNumber = true;\n                            } else if (cell['ct'] != null && cell['ct'].t == 'd') {\n                                hasDate = true;\n                            } else if (_this.isExtendNumber(cell['m'])[0]) {\n                                hasExtendNumber = true;\n                            } else if (_this.isChnNumber(cell['m']) && cell['m'] != '日') {\n                                hasChn = true;\n                            } else if (cell['m'] == '日') {\n                                hasChnWeek1 = true;\n                            } else if (_this.isChnWeek2(cell['m'])) {\n                                hasChnWeek2 = true;\n                            } else if (_this.isChnWeek3(cell['m'])) {\n                                hasChnWeek3 = true;\n                            }\n                        }\n                    }\n                }\n            }\n            return [\n                hasNumber,\n                hasExtendNumber,\n                hasDate,\n                hasChn,\n                hasChnWeek1,\n                hasChnWeek2,\n                hasChnWeek3\n            ];\n        },\n        update: function () {\n            let _this = this;\n            if (!checkProtectionLockedRangeList([_this.applyRange], Store.currentSheetIndex)) {\n                return;\n            }\n            if (Store.allowEdit === false) {\n                return;\n            }\n            let d = Store.deepCopyFlowData(Store.flowdata);\n            let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            let cfg = $.extend(true, {}, Store.config);\n            let borderInfoCompute = getBorderInfoCompute();\n            let dataVerification = $.extend(true, {}, file['dataVerification']);\n            let direction = _this.direction;\n            let type = _this.applyType;    //复制范围\n            //复制范围\n            let copyRange = _this.copyRange;\n            let copy_str_r = copyRange['row'][0], copy_end_r = copyRange['row'][1];\n            let copy_str_c = copyRange['column'][0], copy_end_c = copyRange['column'][1];\n            let copyData = _this.getCopyData(d, copy_str_r, copy_end_r, copy_str_c, copy_end_c, direction);\n            let csLen;\n            if (direction == 'down' || direction == 'up') {\n                csLen = copy_end_r - copy_str_r + 1;\n            } else if (direction == 'right' || direction == 'left') {\n                csLen = copy_end_c - copy_str_c + 1;\n            }    //应用范围\n            //应用范围\n            let applyRange = _this.applyRange;\n            let apply_str_r = applyRange['row'][0], apply_end_r = applyRange['row'][1];\n            let apply_str_c = applyRange['column'][0], apply_end_c = applyRange['column'][1];\n            if (direction == 'down' || direction == 'up') {\n                let asLen = apply_end_r - apply_str_r + 1;\n                for (let i = apply_str_c; i <= apply_end_c; i++) {\n                    let copyD = copyData[i - apply_str_c];\n                    let applyData = _this.getApplyData(copyD, csLen, asLen);\n                    if (direction == 'down') {\n                        for (let j = apply_str_r; j <= apply_end_r; j++) {\n                            let cell = applyData[j - apply_str_r];\n                            if (cell.f != null) {\n                                let f = '=' + formula.functionCopy(cell.f, 'down', j - apply_str_r + 1);\n                                let v = formula.execfunction(f, j, i);\n                                formula.execFunctionGroup(j, i, v[1], undefined, d);\n                                cell.f = v[2];\n                                cell.v = v[1];\n                                if (cell.spl != null) {\n                                    cell.spl = v[3].data;\n                                } else {\n                                    if (isRealNum(cell.v) && !/^\\d{6}(18|19|20)?\\d{2}(0[1-9]|1[12])(0[1-9]|[12]\\d|3[01])\\d{3}(\\d|X)$/i.test(cell.v)) {\n                                        if (cell.v == Infinity || cell.v == -Infinity) {\n                                            cell.m = cell.v.toString();\n                                        } else {\n                                            if (cell.v.toString().indexOf('e') > -1) {\n                                                let len = cell.v.toString().split('.')[1].split('e')[0].length;\n                                                if (len > 5) {\n                                                    len = 5;\n                                                }\n                                                cell.m = cell.v.toExponential(len).toString();\n                                            } else {\n                                                let mask = genarate(Math.round(cell.v * 1000000000) / 1000000000);\n                                                cell.m = mask[0].toString();\n                                            }\n                                        }\n                                        cell.ct = {\n                                            'fa': 'General',\n                                            't': 'n'\n                                        };\n                                    } else {\n                                        let mask = genarate(cell.v);\n                                        cell.m = mask[0].toString();\n                                        cell.ct = mask[1];\n                                    }\n                                }\n                            }\n                            d[j][i] = cell;    //边框\n                            //边框\n                            let bd_r = copy_str_r + (j - apply_str_r) % csLen;\n                            let bd_c = i;\n                            if (borderInfoCompute[bd_r + '_' + bd_c]) {\n                                let bd_obj = {\n                                    'rangeType': 'cell',\n                                    'value': {\n                                        'row_index': j,\n                                        'col_index': i,\n                                        'l': borderInfoCompute[bd_r + '_' + bd_c].l,\n                                        'r': borderInfoCompute[bd_r + '_' + bd_c].r,\n                                        't': borderInfoCompute[bd_r + '_' + bd_c].t,\n                                        'b': borderInfoCompute[bd_r + '_' + bd_c].b\n                                    }\n                                };\n                                cfg['borderInfo'].push(bd_obj);\n                            } else if (borderInfoCompute[j + '_' + i]) {\n                                let bd_obj = {\n                                    'rangeType': 'cell',\n                                    'value': {\n                                        'row_index': j,\n                                        'col_index': i,\n                                        'l': null,\n                                        'r': null,\n                                        't': null,\n                                        'b': null\n                                    }\n                                };\n                                cfg['borderInfo'].push(bd_obj);\n                            }    //数据验证\n                            //数据验证\n                            if (dataVerification[bd_r + '_' + bd_c]) {\n                                dataVerification[j + '_' + i] = dataVerification[bd_r + '_' + bd_c];\n                            }\n                        }\n                    }\n                    if (direction == 'up') {\n                        for (let j = apply_end_r; j >= apply_str_r; j--) {\n                            let cell = applyData[apply_end_r - j];\n                            if (cell.f != null) {\n                                let f = '=' + formula.functionCopy(cell.f, 'up', apply_end_r - j + 1);\n                                let v = formula.execfunction(f, j, i);\n                                formula.execFunctionGroup(j, i, v[1], undefined, d);\n                                cell.f = v[2];\n                                cell.v = v[1];\n                                if (cell.spl != null) {\n                                    cell.spl = v[3].data;\n                                } else {\n                                    if (isRealNum(cell.v) && !/^\\d{6}(18|19|20)?\\d{2}(0[1-9]|1[12])(0[1-9]|[12]\\d|3[01])\\d{3}(\\d|X)$/i.test(cell.v)) {\n                                        if (cell.v == Infinity || cell.v == -Infinity) {\n                                            cell.m = cell.v.toString();\n                                        } else {\n                                            if (cell.v.toString().indexOf('e') > -1) {\n                                                let len = cell.v.toString().split('.')[1].split('e')[0].length;\n                                                if (len > 5) {\n                                                    len = 5;\n                                                }\n                                                cell.m = cell.v.toExponential(len).toString();\n                                            } else {\n                                                let mask = genarate(Math.round(cell.v * 1000000000) / 1000000000);\n                                                cell.m = mask[0].toString();\n                                            }\n                                        }\n                                        cell.ct = {\n                                            'fa': 'General',\n                                            't': 'n'\n                                        };\n                                    } else {\n                                        let mask = genarate(cell.v);\n                                        cell.m = mask[0].toString();\n                                        cell.ct = mask[1];\n                                    }\n                                }\n                            }\n                            d[j][i] = cell;    //边框\n                            //边框\n                            let bd_r = copy_end_r - (apply_end_r - j) % csLen;\n                            let bd_c = i;\n                            if (borderInfoCompute[bd_r + '_' + bd_c]) {\n                                let bd_obj = {\n                                    'rangeType': 'cell',\n                                    'value': {\n                                        'row_index': j,\n                                        'col_index': i,\n                                        'l': borderInfoCompute[bd_r + '_' + bd_c].l,\n                                        'r': borderInfoCompute[bd_r + '_' + bd_c].r,\n                                        't': borderInfoCompute[bd_r + '_' + bd_c].t,\n                                        'b': borderInfoCompute[bd_r + '_' + bd_c].b\n                                    }\n                                };\n                                cfg['borderInfo'].push(bd_obj);\n                            } else if (borderInfoCompute[j + '_' + i]) {\n                                let bd_obj = {\n                                    'rangeType': 'cell',\n                                    'value': {\n                                        'row_index': j,\n                                        'col_index': i,\n                                        'l': null,\n                                        'r': null,\n                                        't': null,\n                                        'b': null\n                                    }\n                                };\n                                cfg['borderInfo'].push(bd_obj);\n                            }    //数据验证\n                            //数据验证\n                            if (dataVerification[bd_r + '_' + bd_c]) {\n                                dataVerification[j + '_' + i] = dataVerification[bd_r + '_' + bd_c];\n                            }\n                        }\n                    }\n                }\n            } else if (direction == 'right' || direction == 'left') {\n                let asLen = apply_end_c - apply_str_c + 1;\n                for (let i = apply_str_r; i <= apply_end_r; i++) {\n                    let copyD = copyData[i - apply_str_r];\n                    let applyData = _this.getApplyData(copyD, csLen, asLen);\n                    if (direction == 'right') {\n                        for (let j = apply_str_c; j <= apply_end_c; j++) {\n                            let cell = applyData[j - apply_str_c];\n                            if (cell.f != null) {\n                                let f = '=' + formula.functionCopy(cell.f, 'right', j - apply_str_c + 1);\n                                let v = formula.execfunction(f, i, j);\n                                formula.execFunctionGroup(j, i, v[1], undefined, d);\n                                cell.f = v[2];\n                                cell.v = v[1];\n                                if (cell.spl != null) {\n                                    cell.spl = v[3].data;\n                                } else {\n                                    if (isRealNum(cell.v) && !/^\\d{6}(18|19|20)?\\d{2}(0[1-9]|1[12])(0[1-9]|[12]\\d|3[01])\\d{3}(\\d|X)$/i.test(cell.v)) {\n                                        if (cell.v == Infinity || cell.v == -Infinity) {\n                                            cell.m = cell.v.toString();\n                                        } else {\n                                            if (cell.v.toString().indexOf('e') > -1) {\n                                                let len = cell.v.toString().split('.')[1].split('e')[0].length;\n                                                if (len > 5) {\n                                                    len = 5;\n                                                }\n                                                cell.m = cell.v.toExponential(len).toString();\n                                            } else {\n                                                let mask = genarate(Math.round(cell.v * 1000000000) / 1000000000);\n                                                cell.m = mask[0].toString();\n                                            }\n                                        }\n                                        cell.ct = {\n                                            'fa': 'General',\n                                            't': 'n'\n                                        };\n                                    } else {\n                                        let mask = genarate(cell.v);\n                                        cell.m = mask[0].toString();\n                                        cell.ct = mask[1];\n                                    }\n                                }\n                            }\n                            d[i][j] = cell;    //边框\n                            //边框\n                            let bd_r = i;\n                            let bd_c = copy_str_c + (j - apply_str_c) % csLen;\n                            if (borderInfoCompute[bd_r + '_' + bd_c]) {\n                                let bd_obj = {\n                                    'rangeType': 'cell',\n                                    'value': {\n                                        'row_index': i,\n                                        'col_index': j,\n                                        'l': borderInfoCompute[bd_r + '_' + bd_c].l,\n                                        'r': borderInfoCompute[bd_r + '_' + bd_c].r,\n                                        't': borderInfoCompute[bd_r + '_' + bd_c].t,\n                                        'b': borderInfoCompute[bd_r + '_' + bd_c].b\n                                    }\n                                };\n                                cfg['borderInfo'].push(bd_obj);\n                            } else if (borderInfoCompute[i + '_' + j]) {\n                                let bd_obj = {\n                                    'rangeType': 'cell',\n                                    'value': {\n                                        'row_index': i,\n                                        'col_index': j,\n                                        'l': null,\n                                        'r': null,\n                                        't': null,\n                                        'b': null\n                                    }\n                                };\n                                cfg['borderInfo'].push(bd_obj);\n                            }    //数据验证\n                            //数据验证\n                            if (dataVerification[bd_r + '_' + bd_c]) {\n                                dataVerification[i + '_' + j] = dataVerification[bd_r + '_' + bd_c];\n                            }\n                        }\n                    }\n                    if (direction == 'left') {\n                        for (let j = apply_end_c; j >= apply_str_c; j--) {\n                            let cell = applyData[apply_end_c - j];\n                            if (cell.f != null) {\n                                let f = '=' + formula.functionCopy(cell.f, 'left', apply_end_c - j + 1);\n                                let v = formula.execfunction(f, i, j);\n                                formula.execFunctionGroup(j, i, v[1], undefined, d);\n                                cell.f = v[2];\n                                cell.v = v[1];\n                                if (cell.spl != null) {\n                                    cell.spl = v[3].data;\n                                } else {\n                                    if (isRealNum(cell.v) && !/^\\d{6}(18|19|20)?\\d{2}(0[1-9]|1[12])(0[1-9]|[12]\\d|3[01])\\d{3}(\\d|X)$/i.test(cell.v)) {\n                                        if (cell.v == Infinity || cell.v == -Infinity) {\n                                            cell.m = cell.v.toString();\n                                        } else {\n                                            if (cell.v.toString().indexOf('e') > -1) {\n                                                let len = cell.v.toString().split('.')[1].split('e')[0].length;\n                                                if (len > 5) {\n                                                    len = 5;\n                                                }\n                                                cell.m = cell.v.toExponential(len).toString();\n                                            } else {\n                                                let mask = genarate(Math.round(cell.v * 1000000000) / 1000000000);\n                                                cell.m = mask[0].toString();\n                                            }\n                                        }\n                                        cell.ct = {\n                                            'fa': 'General',\n                                            't': 'n'\n                                        };\n                                    } else {\n                                        let mask = genarate(cell.v);\n                                        cell.m = mask[0].toString();\n                                        cell.ct = mask[1];\n                                    }\n                                }\n                            }\n                            d[i][j] = cell;    //边框\n                            //边框\n                            let bd_r = i;\n                            let bd_c = copy_end_c - (apply_end_c - j) % csLen;\n                            if (borderInfoCompute[bd_r + '_' + bd_c]) {\n                                let bd_obj = {\n                                    'rangeType': 'cell',\n                                    'value': {\n                                        'row_index': i,\n                                        'col_index': j,\n                                        'l': borderInfoCompute[bd_r + '_' + bd_c].l,\n                                        'r': borderInfoCompute[bd_r + '_' + bd_c].r,\n                                        't': borderInfoCompute[bd_r + '_' + bd_c].t,\n                                        'b': borderInfoCompute[bd_r + '_' + bd_c].b\n                                    }\n                                };\n                                cfg['borderInfo'].push(bd_obj);\n                            } else if (borderInfoCompute[i + '_' + j]) {\n                                let bd_obj = {\n                                    'rangeType': 'cell',\n                                    'value': {\n                                        'row_index': i,\n                                        'col_index': j,\n                                        'l': null,\n                                        'r': null,\n                                        't': null,\n                                        'b': null\n                                    }\n                                };\n                                cfg['borderInfo'].push(bd_obj);\n                            }    //数据验证\n                            //数据验证\n                            if (dataVerification[bd_r + '_' + bd_c]) {\n                                dataVerification[i + '_' + j] = dataVerification[bd_r + '_' + bd_c];\n                            }\n                        }\n                    }\n                }\n            }    //条件格式\n            //条件格式\n            let cdformat = $.extend(true, [], file['luckysheet_conditionformat_save']);\n            if (cdformat != null && cdformat.length > 0) {\n                for (let i = 0; i < cdformat.length; i++) {\n                    let cdformat_cellrange = cdformat[i].cellrange;\n                    let emptyRange = [];\n                    for (let j = 0; j < cdformat_cellrange.length; j++) {\n                        let range = conditionformat.CFSplitRange(cdformat_cellrange[j], {\n                            'row': copyRange['row'],\n                            'column': copyRange['column']\n                        }, {\n                            'row': applyRange['row'],\n                            'column': applyRange['column']\n                        }, 'operatePart');\n                        if (range.length > 0) {\n                            emptyRange = emptyRange.concat(range);\n                        }\n                    }\n                    if (emptyRange.length > 0) {\n                        cdformat[i].cellrange.push(applyRange);\n                    }\n                }\n            }    //刷新一次表格\n            //刷新一次表格\n            let allParam = {\n                'cfg': cfg,\n                'cdformat': cdformat,\n                'dataVerification': dataVerification\n            };\n            ///jfrefreshgrid(d, Store.luckysheet_select_save, allParam);\n            Store.refreshRange(d, Store.luckysheet_select_save, allParam);\n\n            selectHightlightShow();\n        },\n        getCopyData: function (d, r1, r2, c1, c2, direction) {\n            let _this = this;\n            let copyData = [];\n            let a1, a2, b1, b2;\n            if (direction == 'down' || direction == 'up') {\n                a1 = c1;\n                a2 = c2;\n                b1 = r1;\n                b2 = r2;\n            } else if (direction == 'right' || direction == 'left') {\n                a1 = r1;\n                a2 = r2;\n                b1 = c1;\n                b2 = c2;\n            }\n            for (let a = a1; a <= a2; a++) {\n                let obj = {};\n                let arrData = [];\n                let arrIndex = [];\n                let text = '';\n                let extendNumberBeforeStr = null;\n                let extendNumberAfterStr = null;\n                let isSameStr = true;\n                for (let b = b1; b <= b2; b++) {\n                    //单元格\n                    let data;\n                    if (direction == 'down' || direction == 'up') {\n                        data = d[b][a];\n                    } else if (direction == 'right' || direction == 'left') {\n                        data = d[a][b];\n                    }    //单元格值类型\n                    //单元格值类型\n                    let str;\n                    if (!!data && !!data['v'] && data['f'] == null) {\n                        if (!!data['ct'] && data['ct']['t'] == 'n') {\n                            str = 'number';\n                            extendNumberBeforeStr = null;\n                            extendNumberAfterStr = null;\n                        } else if (!!data['ct'] && data['ct']['t'] == 'd') {\n                            str = 'date';\n                            extendNumberBeforeStr = null;\n                            extendNumberAfterStr = null;\n                        } else if (_this.isExtendNumber(data['m'])[0]) {\n                            str = 'extendNumber';\n                            let isExtendNumber = _this.isExtendNumber(data['m']);\n                            if (extendNumberBeforeStr == null || extendNumberAfterStr == null) {\n                                isSameStr = true;\n                                extendNumberBeforeStr = isExtendNumber[2];\n                                extendNumberAfterStr = isExtendNumber[3];\n                            } else {\n                                if (isExtendNumber[2] != extendNumberBeforeStr || isExtendNumber[3] != extendNumberAfterStr) {\n                                    isSameStr = false;\n                                    extendNumberBeforeStr = isExtendNumber[2];\n                                    extendNumberAfterStr = isExtendNumber[3];\n                                } else {\n                                    isSameStr = true;\n                                }\n                            }\n                        } else if (_this.isChnNumber(data['m'])) {\n                            str = 'chnNumber';\n                            extendNumberBeforeStr = null;\n                            extendNumberAfterStr = null;\n                        } else if (_this.isChnWeek2(data['m'])) {\n                            str = 'chnWeek2';\n                            extendNumberBeforeStr = null;\n                            extendNumberAfterStr = null;\n                        } else if (_this.isChnWeek3(data['m'])) {\n                            str = 'chnWeek3';\n                            extendNumberBeforeStr = null;\n                            extendNumberAfterStr = null;\n                        } else {\n                            str = 'other';\n                            extendNumberBeforeStr = null;\n                            extendNumberAfterStr = null;\n                        }\n                    } else {\n                        str = 'other';\n                        extendNumberBeforeStr = null;\n                        extendNumberAfterStr = null;\n                    }\n                    if (str == 'extendNumber') {\n                        if (b == b1) {\n                            if (b1 == b2) {\n                                text = str;\n                                arrData.push(data);\n                                arrIndex.push(b - b1 + 1);\n                                obj[text] = [];\n                                obj[text].push({\n                                    'data': arrData,\n                                    'index': arrIndex\n                                });\n                            } else {\n                                text = str;\n                                arrData.push(data);\n                                arrIndex.push(b - b1 + 1);\n                            }\n                        } else if (b == b2) {\n                            if (text == str && isSameStr) {\n                                arrData.push(data);\n                                arrIndex.push(b - b1 + 1);\n                                if (text in obj) {\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                } else {\n                                    obj[text] = [];\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                }\n                            } else {\n                                if (text in obj) {\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                } else {\n                                    obj[text] = [];\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                }\n                                text = str;\n                                arrData = [];\n                                arrData.push(data);\n                                arrIndex = [];\n                                arrIndex.push(b - b1 + 1);\n                                if (text in obj) {\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                } else {\n                                    obj[text] = [];\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                }\n                            }\n                        } else {\n                            if (text == str && isSameStr) {\n                                arrData.push(data);\n                                arrIndex.push(b - b1 + 1);\n                            } else {\n                                if (text in obj) {\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                } else {\n                                    obj[text] = [];\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                }\n                                text = str;\n                                arrData = [];\n                                arrData.push(data);\n                                arrIndex = [];\n                                arrIndex.push(b - b1 + 1);\n                            }\n                        }\n                    } else {\n                        if (b == b1) {\n                            if (b1 == b2) {\n                                text = str;\n                                arrData.push(data);\n                                arrIndex.push(b - b1 + 1);\n                                obj[text] = [];\n                                obj[text].push({\n                                    'data': arrData,\n                                    'index': arrIndex\n                                });\n                            } else {\n                                text = str;\n                                arrData.push(data);\n                                arrIndex.push(b - b1 + 1);\n                            }\n                        } else if (b == b2) {\n                            if (text == str) {\n                                arrData.push(data);\n                                arrIndex.push(b - b1 + 1);\n                                if (text in obj) {\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                } else {\n                                    obj[text] = [];\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                }\n                            } else {\n                                if (text in obj) {\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                } else {\n                                    obj[text] = [];\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                }\n                                text = str;\n                                arrData = [];\n                                arrData.push(data);\n                                arrIndex = [];\n                                arrIndex.push(b - b1 + 1);\n                                if (text in obj) {\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                } else {\n                                    obj[text] = [];\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                }\n                            }\n                        } else {\n                            if (text == str) {\n                                arrData.push(data);\n                                arrIndex.push(b - b1 + 1);\n                            } else {\n                                if (text in obj) {\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                } else {\n                                    obj[text] = [];\n                                    obj[text].push({\n                                        'data': arrData,\n                                        'index': arrIndex\n                                    });\n                                }\n                                text = str;\n                                arrData = [];\n                                arrData.push(data);\n                                arrIndex = [];\n                                arrIndex.push(b - b1 + 1);\n                            }\n                        }\n                    }\n                }\n                copyData.push(obj);\n            }\n            return copyData;\n        },\n        getApplyData: function (copyD, csLen, asLen) {\n            let _this = this;\n            let applyData = [];\n            let direction = _this.direction;\n            let type = _this.applyType;\n            let num = Math.floor(asLen / csLen);\n            let rsd = asLen % csLen;    //纯数字类型\n            //纯数字类型\n            let copyD_number = copyD['number'];\n            let applyD_number = [];\n            if (!!copyD_number) {\n                for (let i = 0; i < copyD_number.length; i++) {\n                    let s = _this.getLenS(copyD_number[i]['index'], rsd);\n                    let len = copyD_number[i]['index'].length * num + s;\n                    let arrData;\n                    if (type == '1' || type == '3') {\n                        arrData = _this.getDataByType(copyD_number[i]['data'], len, direction, type, 'number');\n                    } else if (type == '2') {\n                        arrData = _this.getDataByType(copyD_number[i]['data'], len, direction, type);\n                    } else {\n                        arrData = _this.getDataByType(copyD_number[i]['data'], len, direction, '0');\n                    }\n                    let arrIndex = _this.getDataIndex(csLen, asLen, copyD_number[i]['index']);\n                    applyD_number.push({\n                        'data': arrData,\n                        'index': arrIndex\n                    });\n                }\n            }    //扩展数字型（即一串字符最后面的是数字）\n            //扩展数字型（即一串字符最后面的是数字）\n            let copyD_extendNumber = copyD['extendNumber'];\n            let applyD_extendNumber = [];\n            if (!!copyD_extendNumber) {\n                for (let i = 0; i < copyD_extendNumber.length; i++) {\n                    let s = _this.getLenS(copyD_extendNumber[i]['index'], rsd);\n                    let len = copyD_extendNumber[i]['index'].length * num + s;\n                    let arrData;\n                    if (type == '1' || type == '3') {\n                        arrData = _this.getDataByType(copyD_extendNumber[i]['data'], len, direction, type, 'extendNumber');\n                    } else if (type == '2') {\n                        arrData = _this.getDataByType(copyD_extendNumber[i]['data'], len, direction, type);\n                    } else {\n                        arrData = _this.getDataByType(copyD_extendNumber[i]['data'], len, direction, '0');\n                    }\n                    let arrIndex = _this.getDataIndex(csLen, asLen, copyD_extendNumber[i]['index']);\n                    applyD_extendNumber.push({\n                        'data': arrData,\n                        'index': arrIndex\n                    });\n                }\n            }    //日期类型\n            //日期类型\n            let copyD_date = copyD['date'];\n            let applyD_date = [];\n            if (!!copyD_date) {\n                for (let i = 0; i < copyD_date.length; i++) {\n                    let s = _this.getLenS(copyD_date[i]['index'], rsd);\n                    let len = copyD_date[i]['index'].length * num + s;\n                    let arrData;\n                    if (type == '1' || type == '3') {\n                        arrData = _this.getDataByType(copyD_date[i]['data'], len, direction, type, 'date');\n                    } else if (type == '8') {\n                        arrData = _this.getDataByType(copyD_date[i]['data'], len, direction, '0');\n                    } else {\n                        arrData = _this.getDataByType(copyD_date[i]['data'], len, direction, type);\n                    }\n                    let arrIndex = _this.getDataIndex(csLen, asLen, copyD_date[i]['index']);\n                    applyD_date.push({\n                        'data': arrData,\n                        'index': arrIndex\n                    });\n                }\n            }    //中文小写数字 或 一~日\n            //中文小写数字 或 一~日\n            let copyD_chnNumber = copyD['chnNumber'];\n            let applyD_chnNumber = [];\n            if (!!copyD_chnNumber) {\n                for (let i = 0; i < copyD_chnNumber.length; i++) {\n                    let s = _this.getLenS(copyD_chnNumber[i]['index'], rsd);\n                    let len = copyD_chnNumber[i]['index'].length * num + s;\n                    let arrData;\n                    if (type == '1' || type == '3') {\n                        arrData = _this.getDataByType(copyD_chnNumber[i]['data'], len, direction, type, 'chnNumber');\n                    } else if (type == '2' || type == '8') {\n                        arrData = _this.getDataByType(copyD_chnNumber[i]['data'], len, direction, type);\n                    } else {\n                        arrData = _this.getDataByType(copyD_chnNumber[i]['data'], len, direction, '0');\n                    }\n                    let arrIndex = _this.getDataIndex(csLen, asLen, copyD_chnNumber[i]['index']);\n                    applyD_chnNumber.push({\n                        'data': arrData,\n                        'index': arrIndex\n                    });\n                }\n            }    //周一~周日\n            //周一~周日\n            let copyD_chnWeek2 = copyD['chnWeek2'];\n            let applyD_chnWeek2 = [];\n            if (!!copyD_chnWeek2) {\n                for (let i = 0; i < copyD_chnWeek2.length; i++) {\n                    let s = _this.getLenS(copyD_chnWeek2[i]['index'], rsd);\n                    let len = copyD_chnWeek2[i]['index'].length * num + s;\n                    let arrData;\n                    if (type == '1' || type == '3') {\n                        arrData = _this.getDataByType(copyD_chnWeek2[i]['data'], len, direction, type, 'chnWeek2');\n                    } else if (type == '2') {\n                        arrData = _this.getDataByType(copyD_chnWeek2[i]['data'], len, direction, type);\n                    } else {\n                        arrData = _this.getDataByType(copyD_chnWeek2[i]['data'], len, direction, '0');\n                    }\n                    let arrIndex = _this.getDataIndex(csLen, asLen, copyD_chnWeek2[i]['index']);\n                    applyD_chnWeek2.push({\n                        'data': arrData,\n                        'index': arrIndex\n                    });\n                }\n            }    //星期一~星期日\n            //星期一~星期日\n            let copyD_chnWeek3 = copyD['chnWeek3'];\n            let applyD_chnWeek3 = [];\n            if (!!copyD_chnWeek3) {\n                for (let i = 0; i < copyD_chnWeek3.length; i++) {\n                    let s = _this.getLenS(copyD_chnWeek3[i]['index'], rsd);\n                    let len = copyD_chnWeek3[i]['index'].length * num + s;\n                    let arrData;\n                    if (type == '1' || type == '3') {\n                        arrData = _this.getDataByType(copyD_chnWeek3[i]['data'], len, direction, type, 'chnWeek3');\n                    } else if (type == '2') {\n                        arrData = _this.getDataByType(copyD_chnWeek3[i]['data'], len, direction, type);\n                    } else {\n                        arrData = _this.getDataByType(copyD_chnWeek3[i]['data'], len, direction, '0');\n                    }\n                    let arrIndex = _this.getDataIndex(csLen, asLen, copyD_chnWeek3[i]['index']);\n                    applyD_chnWeek3.push({\n                        'data': arrData,\n                        'index': arrIndex\n                    });\n                }\n            }    //其它\n            //其它\n            let copyD_other = copyD['other'];\n            let applyD_other = [];\n            if (!!copyD_other) {\n                for (let i = 0; i < copyD_other.length; i++) {\n                    let s = _this.getLenS(copyD_other[i]['index'], rsd);\n                    let len = copyD_other[i]['index'].length * num + s;\n                    let arrData;\n                    if (type == '2' || type == '3') {\n                        arrData = _this.getDataByType(copyD_other[i]['data'], len, direction, type);\n                    } else {\n                        arrData = _this.getDataByType(copyD_other[i]['data'], len, direction, '0');\n                    }\n                    let arrIndex = _this.getDataIndex(csLen, asLen, copyD_other[i]['index']);\n                    applyD_other.push({\n                        'data': arrData,\n                        'index': arrIndex\n                    });\n                }\n            }\n            for (let x = 1; x <= asLen; x++) {\n                if (applyD_number.length > 0) {\n                    for (let y = 0; y < applyD_number.length; y++) {\n                        if (x in applyD_number[y]['index']) {\n                            applyData.push(applyD_number[y]['data'][applyD_number[y]['index'][x]]);\n                        }\n                    }\n                }\n                if (applyD_extendNumber.length > 0) {\n                    for (let y = 0; y < applyD_extendNumber.length; y++) {\n                        if (x in applyD_extendNumber[y]['index']) {\n                            applyData.push(applyD_extendNumber[y]['data'][applyD_extendNumber[y]['index'][x]]);\n                        }\n                    }\n                }\n                if (applyD_date.length > 0) {\n                    for (let y = 0; y < applyD_date.length; y++) {\n                        if (x in applyD_date[y]['index']) {\n                            applyData.push(applyD_date[y]['data'][applyD_date[y]['index'][x]]);\n                        }\n                    }\n                }\n                if (applyD_chnNumber.length > 0) {\n                    for (let y = 0; y < applyD_chnNumber.length; y++) {\n                        if (x in applyD_chnNumber[y]['index']) {\n                            applyData.push(applyD_chnNumber[y]['data'][applyD_chnNumber[y]['index'][x]]);\n                        }\n                    }\n                }\n                if (applyD_chnWeek2.length > 0) {\n                    for (let y = 0; y < applyD_chnWeek2.length; y++) {\n                        if (x in applyD_chnWeek2[y]['index']) {\n                            applyData.push(applyD_chnWeek2[y]['data'][applyD_chnWeek2[y]['index'][x]]);\n                        }\n                    }\n                }\n                if (applyD_chnWeek3.length > 0) {\n                    for (let y = 0; y < applyD_chnWeek3.length; y++) {\n                        if (x in applyD_chnWeek3[y]['index']) {\n                            applyData.push(applyD_chnWeek3[y]['data'][applyD_chnWeek3[y]['index'][x]]);\n                        }\n                    }\n                }\n                if (applyD_other.length > 0) {\n                    for (let y = 0; y < applyD_other.length; y++) {\n                        if (x in applyD_other[y]['index']) {\n                            applyData.push(applyD_other[y]['data'][applyD_other[y]['index'][x]]);\n                        }\n                    }\n                }\n            }\n            return applyData;\n        },\n        getLenS: function (indexArr, rsd) {\n            let s = 0;\n            for (let j = 0; j < indexArr.length; j++) {\n                if (indexArr[j] <= rsd) {\n                    s++;\n                } else {\n                    break;\n                }\n            }\n            return s;\n        },\n        getDataIndex: function (csLen, asLen, indexArr) {\n            let obj = {};\n            let num = Math.floor(asLen / csLen);\n            let rsd = asLen % csLen;\n            let sum = 0;\n            if (num > 0) {\n                for (let i = 1; i <= num; i++) {\n                    for (let j = 0; j < indexArr.length; j++) {\n                        obj[indexArr[j] + (i - 1) * csLen] = sum;\n                        sum++;\n                    }\n                }\n                for (let a = 0; a < indexArr.length; a++) {\n                    if (indexArr[a] <= rsd) {\n                        obj[indexArr[a] + csLen * num] = sum;\n                        sum++;\n                    } else {\n                        break;\n                    }\n                }\n            } else {\n                for (let a = 0; a < indexArr.length; a++) {\n                    if (indexArr[a] <= rsd) {\n                        obj[indexArr[a]] = sum;\n                        sum++;\n                    } else {\n                        break;\n                    }\n                }\n            }\n            return obj;\n        },\n        getDataByType: function (data, len, direction, type, dataType) {\n            let _this = this;\n            let applyData = [];\n            if (type == '0') {\n                //复制单元格\n                if (direction == 'up' || direction == 'left') {\n                    data.reverse();\n                }\n                applyData = _this.FillCopy(data, len);\n            } else if (type == '1') {\n                //填充序列\n                if (dataType == 'number') {\n                    //数据类型是 数字\n                    applyData = _this.FillSeries(data, len, direction);\n                } else if (dataType == 'extendNumber') {\n                    //扩展数字\n                    if (data.length == 1) {\n                        let step;\n                        if (direction == 'down' || direction == 'right') {\n                            step = 1;\n                        } else if (direction == 'up' || direction == 'left') {\n                            step = -1;\n                        }\n                        applyData = _this.FillExtendNumber(data, len, step);\n                    } else {\n                        let dataNumArr = [];\n                        for (let i = 0; i < data.length; i++) {\n                            let txt = data[i]['m'];\n                            dataNumArr.push(Number(_this.isExtendNumber(txt)[1]));\n                        }\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                            dataNumArr.reverse();\n                        }\n                        if (_this.isEqualDiff(dataNumArr)) {\n                            //等差数列，以等差为step\n                            let step = dataNumArr[1] - dataNumArr[0];\n                            applyData = _this.FillExtendNumber(data, len, step);\n                        } else {\n                            //不是等差数列，复制数据\n                            applyData = _this.FillCopy(data, len);\n                        }\n                    }\n                } else if (dataType == 'date') {\n                    //数据类型是 日期\n                    if (data.length == 1) {\n                        //以一天为step\n                        let step;\n                        if (direction == 'down' || direction == 'right') {\n                            step = 1;\n                        } else if (direction == 'up' || direction == 'left') {\n                            step = -1;\n                        }\n                        applyData = _this.FillDays(data, len, step);\n                    } else {\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                        }\n                        let judgeDate = _this.judgeDate(data);\n                        if (judgeDate[0] && judgeDate[3]) {\n                            //日一样，月差为等差数列，以月差为step\n                            let step = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'months');\n                            applyData = _this.FillMonths(data, len, step);\n                        } else if (!judgeDate[0] && judgeDate[2]) {\n                            //日不一样，日差为等差数列，以日差为step\n                            let step = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'days');\n                            applyData = _this.FillDays(data, len, step);\n                        } else {\n                            //其它，复制数据\n                            applyData = _this.FillCopy(data, len);\n                        }\n                    }\n                } else if (dataType == 'chnNumber') {\n                    //数据类型是 中文小写数字\n                    if (data.length == 1) {\n                        if (data[0]['m'] == '日' || _this.ChineseToNumber(data[0]['m']) < 7) {\n                            //数字小于7，以周一~周日序列填充\n                            let step;\n                            if (direction == 'down' || direction == 'right') {\n                                step = 1;\n                            } else if (direction == 'up' || direction == 'left') {\n                                step = -1;\n                            }\n                            applyData = _this.FillChnWeek(data, len, step);\n                        } else {\n                            //数字大于7，以中文小写数字序列填充\n                            let step;\n                            if (direction == 'down' || direction == 'right') {\n                                step = 1;\n                            } else if (direction == 'up' || direction == 'left') {\n                                step = -1;\n                            }\n                            applyData = _this.FillChnNumber(data, len, step);\n                        }\n                    } else {\n                        let hasweek = false;\n                        for (let i = 0; i < data.length; i++) {\n                            if (data[i]['m'] == '日') {\n                                hasweek = true;\n                                break;\n                            }\n                        }\n                        let dataNumArr = [];\n                        let weekIndex = 0;\n                        for (let i = 0; i < data.length; i++) {\n                            if (data[i]['m'] == '日') {\n                                if (i == 0) {\n                                    dataNumArr.push(0);\n                                } else {\n                                    weekIndex++;\n                                    dataNumArr.push(weekIndex * 7);\n                                }\n                            } else if (hasweek && _this.ChineseToNumber(data[i]['m']) > 0 && _this.ChineseToNumber(data[i]['m']) < 7) {\n                                dataNumArr.push(_this.ChineseToNumber(data[i]['m']) + weekIndex * 7);\n                            } else {\n                                dataNumArr.push(_this.ChineseToNumber(data[i]['m']));\n                            }\n                        }\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                            dataNumArr.reverse();\n                        }\n                        if (_this.isEqualDiff(dataNumArr)) {\n                            if (hasweek || dataNumArr[dataNumArr.length - 1] < 6 && dataNumArr[0] > 0 || dataNumArr[0] < 6 && dataNumArr[dataNumArr.length - 1] > 0) {\n                                //以周一~周日序列填充\n                                let step = dataNumArr[1] - dataNumArr[0];\n                                applyData = _this.FillChnWeek(data, len, step);\n                            } else {\n                                //以中文小写数字序列填充\n                                let step = dataNumArr[1] - dataNumArr[0];\n                                applyData = _this.FillChnNumber(data, len, step);\n                            }\n                        } else {\n                            //不是等差数列，复制数据\n                            applyData = _this.FillCopy(data, len);\n                        }\n                    }\n                } else if (dataType == 'chnWeek2') {\n                    //周一~周日\n                    if (data.length == 1) {\n                        let step;\n                        if (direction == 'down' || direction == 'right') {\n                            step = 1;\n                        } else if (direction == 'up' || direction == 'left') {\n                            step = -1;\n                        }\n                        applyData = _this.FillChnWeek2(data, len, step);\n                    } else {\n                        let dataNumArr = [];\n                        let weekIndex = 0;\n                        for (let i = 0; i < data.length; i++) {\n                            let lastTxt = data[i]['m'].substr(data[i]['m'].length - 1, 1);\n                            if (data[i]['m'] == '周日') {\n                                if (i == 0) {\n                                    dataNumArr.push(0);\n                                } else {\n                                    weekIndex++;\n                                    dataNumArr.push(weekIndex * 7);\n                                }\n                            } else {\n                                dataNumArr.push(_this.ChineseToNumber(lastTxt) + weekIndex * 7);\n                            }\n                        }\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                            dataNumArr.reverse();\n                        }\n                        if (_this.isEqualDiff(dataNumArr)) {\n                            //等差数列，以等差为step\n                            let step = dataNumArr[1] - dataNumArr[0];\n                            applyData = _this.FillChnWeek2(data, len, step);\n                        } else {\n                            //不是等差数列，复制数据\n                            applyData = _this.FillCopy(data, len);\n                        }\n                    }\n                } else if (dataType == 'chnWeek3') {\n                    //星期一~星期日\n                    if (data.length == 1) {\n                        let step;\n                        if (direction == 'down' || direction == 'right') {\n                            step = 1;\n                        } else if (direction == 'up' || direction == 'left') {\n                            step = -1;\n                        }\n                        applyData = _this.FillChnWeek3(data, len, step);\n                    } else {\n                        let dataNumArr = [];\n                        let weekIndex = 0;\n                        for (let i = 0; i < data.length; i++) {\n                            let lastTxt = data[i]['m'].substr(data[i]['m'].length - 1, 1);\n                            if (data[i]['m'] == '星期日') {\n                                if (i == 0) {\n                                    dataNumArr.push(0);\n                                } else {\n                                    weekIndex++;\n                                    dataNumArr.push(weekIndex * 7);\n                                }\n                            } else {\n                                dataNumArr.push(_this.ChineseToNumber(lastTxt) + weekIndex * 7);\n                            }\n                        }\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                            dataNumArr.reverse();\n                        }\n                        if (_this.isEqualDiff(dataNumArr)) {\n                            //等差数列，以等差为step\n                            let step = dataNumArr[1] - dataNumArr[0];\n                            applyData = _this.FillChnWeek3(data, len, step);\n                        } else {\n                            //不是等差数列，复制数据\n                            applyData = _this.FillCopy(data, len);\n                        }\n                    }\n                } else {\n                    //数据类型是 其它\n                    if (direction == 'up' || direction == 'left') {\n                        data.reverse();\n                    }\n                    applyData = _this.FillCopy(data, len);\n                }\n            } else if (type == '2') {\n                //仅填充格式\n                if (direction == 'up' || direction == 'left') {\n                    data.reverse();\n                }\n                applyData = _this.FillOnlyFormat(data, len);\n            } else if (type == '3') {\n                //不带格式填充\n                let dataArr = _this.getDataByType(data, len, direction, '1', dataType);\n                applyData = _this.FillWithoutFormat(dataArr);\n            } else if (type == '4') {\n                //以天数填充\n                if (data.length == 1) {\n                    //以一天为step\n                    let step;\n                    if (direction == 'down' || direction == 'right') {\n                        step = 1;\n                    } else if (direction == 'up' || direction == 'left') {\n                        step = -1;\n                    }\n                    applyData = _this.FillDays(data, len, step);\n                } else if (data.length == 2) {\n                    //以日差为step\n                    if (direction == 'up' || direction == 'left') {\n                        data.reverse();\n                    }\n                    let step = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'days');\n                    applyData = _this.FillDays(data, len, step);\n                } else {\n                    if (direction == 'up' || direction == 'left') {\n                        data.reverse();\n                    }\n                    let judgeDate = _this.judgeDate(data);\n                    if (judgeDate[0] && judgeDate[3]) {\n                        //日一样，且月差为等差数列，以月差为step\n                        let step = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'months');\n                        applyData = _this.FillMonths(data, len, step);\n                    } else if (!judgeDate[0] && judgeDate[2]) {\n                        //日不一样，且日差为等差数列，以日差为step\n                        let step = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'days');\n                        applyData = _this.FillDays(data, len, step);\n                    } else {\n                        //日差不是等差数列，复制数据\n                        applyData = _this.FillCopy(data, len);\n                    }\n                }\n            } else if (type == '5') {\n                //以工作日填充\n                if (data.length == 1) {\n                    //以一天为step（若那天为休息日，则跳过）\n                    let step;\n                    if (direction == 'down' || direction == 'right') {\n                        step = 1;\n                    } else if (direction == 'up' || direction == 'left') {\n                        step = -1;\n                    }\n                    let newLen = Math.round(len * 1.5);\n                    for (let i = 1; i <= newLen; i++) {\n                        let d = $.extend(true, {}, data[0]);\n                        let day = dayjs(d['m']).add(i, 'days').day();\n                        if (day == 0 || day == 6) {\n                            continue;\n                        }\n                        let date = dayjs(d['m']).add(step * i, 'days').format('YYYY-MM-DD');\n                        d['m'] = date;\n                        d['v'] = genarate(date)[2];\n                        applyData.push(d);\n                        if (applyData.length == len) {\n                            break;\n                        }\n                    }\n                } else if (data.length == 2) {\n                    if (dayjs(data[1]['m']).date() == dayjs(data[0]['m']).date() && dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'months') != 0) {\n                        //日一样，且月差大于一月，以月差为step（若那天为休息日，则向前取最近的工作日）\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                        }\n                        let step = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'months');\n                        for (let i = 1; i <= len; i++) {\n                            let index = (i - 1) % data.length;\n                            let d = $.extend(true, {}, data[index]);\n                            let day = dayjs(data[data.length - 1]).add(step * i, 'months').day(), date;\n                            if (day == 0) {\n                                date = dayjs(data[data.length - 1]).add(step * i, 'months').subtract(2, 'days').format('YYYY-MM-DD');\n                            } else if (day == 6) {\n                                date = dayjs(data[data.length - 1]).add(step * i, 'months').subtract(1, 'days').format('YYYY-MM-DD');\n                            } else {\n                                date = dayjs(data[data.length - 1]).add(step * i, 'months').format('YYYY-MM-DD');\n                            }\n                            d['m'] = date;\n                            d['v'] = genarate(date)[2];\n                            applyData.push(d);\n                        }\n                    } else {\n                        //日不一样\n                        if (Math.abs(dayjs(data[1]['m']).diff(dayjs(data[0]['m']))) > 7) {\n                            //若日差大于7天，以一月为step（若那天是休息日，则向前取最近的工作日）\n                            let step_month;\n                            if (direction == 'down' || direction == 'right') {\n                                step_month = 1;\n                            } else if (direction == 'up' || direction == 'left') {\n                                step_month = -1;\n                                data.reverse();\n                            }\n                            let step;    //以数组第一个为对比\n                            //以数组第一个为对比\n                            for (let i = 1; i <= len; i++) {\n                                let index = (i - 1) % data.length;\n                                let d = $.extend(true, {}, data[index]);\n                                let num = Math.ceil(i / data.length);\n                                if (index == 0) {\n                                    step = dayjs(d['m']).add(step_month * num, 'months').diff(dayjs(d['m']), 'days');\n                                }\n                                let day = dayjs(d['m']).add(step, 'days').day(), date;\n                                if (day == 0) {\n                                    date = dayjs(d['m']).add(step, 'days').subtract(2, 'days').format('YYYY-MM-DD');\n                                } else if (day == 6) {\n                                    date = dayjs(d['m']).add(step, 'days').subtract(1, 'days').format('YYYY-MM-DD');\n                                } else {\n                                    date = dayjs(d['m']).add(step, 'days').format('YYYY-MM-DD');\n                                }\n                                d['m'] = date;\n                                d['v'] = genarate(date)[2];\n                                applyData.push(d);\n                            }\n                        } else {\n                            //若日差小于等于7天，以7天为step（若那天是休息日，则向前取最近的工作日）\n                            let step_day;\n                            if (direction == 'down' || direction == 'right') {\n                                step_day = 7;\n                            } else if (direction == 'up' || direction == 'left') {\n                                step_day = -7;\n                                data.reverse();\n                            }\n                            let step;    //以数组第一个为对比\n                            //以数组第一个为对比\n                            for (let i = 1; i <= len; i++) {\n                                let index = (i - 1) % data.length;\n                                let d = $.extend(true, {}, data[index]);\n                                let num = Math.ceil(i / data.length);\n                                if (index == 0) {\n                                    step = dayjs(d['m']).add(step_day * num, 'days').diff(dayjs(d['m']), 'days');\n                                }\n                                let day = dayjs(d['m']).add(step, 'days').day(), date;\n                                if (day == 0) {\n                                    date = dayjs(d['m']).add(step, 'days').subtract(2, 'days').format('YYYY-MM-DD');\n                                } else if (day == 6) {\n                                    date = dayjs(d['m']).add(step, 'days').subtract(1, 'days').format('YYYY-MM-DD');\n                                } else {\n                                    date = dayjs(d['m']).add(step, 'days').format('YYYY-MM-DD');\n                                }\n                                d['m'] = date;\n                                d['v'] = genarate(date)[2];\n                                applyData.push(d);\n                            }\n                        }\n                    }\n                } else {\n                    let judgeDate = _this.judgeDate(data);\n                    if (judgeDate[0] && judgeDate[3]) {\n                        //日一样，且月差为等差数列，以月差为step（若那天为休息日，则向前取最近的工作日）\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                        }\n                        let step = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'months');\n                        for (let i = 1; i <= len; i++) {\n                            let index = (i - 1) % data.length;\n                            let d = $.extend(true, {}, data[index]);\n                            let day = dayjs(data[data.length - 1]['m']).add(step * i, 'months').day(), date;\n                            if (day == 0) {\n                                date = dayjs(data[data.length - 1]['m']).add(step * i, 'months').subtract(2, 'days').format('YYYY-MM-DD');\n                            } else if (day == 6) {\n                                date = dayjs(data[data.length - 1]['m']).add(step * i, 'months').subtract(1, 'days').format('YYYY-MM-DD');\n                            } else {\n                                date = dayjs(data[data.length - 1]['m']).add(step * i, 'months').format('YYYY-MM-DD');\n                            }\n                            d['m'] = date;\n                            d['v'] = genarate(date)[2];\n                            applyData.push(d);\n                        }\n                    } else if (!judgeDate[0] && judgeDate[2]) {\n                        //日不一样，且日差为等差数列\n                        if (Math.abs(dayjs(data[1]['m']).diff(dayjs(data[0]['m']))) > 7) {\n                            //若日差大于7天，以一月为step（若那天是休息日，则向前取最近的工作日）\n                            let step_month;\n                            if (direction == 'down' || direction == 'right') {\n                                step_month = 1;\n                            } else if (direction == 'up' || direction == 'left') {\n                                step_month = -1;\n                                data.reverse();\n                            }\n                            let step;    //以数组第一个为对比\n                            //以数组第一个为对比\n                            for (let i = 1; i <= len; i++) {\n                                let index = (i - 1) % data.length;\n                                let d = $.extend(true, {}, data[index]);\n                                let num = Math.ceil(i / data.length);\n                                if (index == 0) {\n                                    step = dayjs(d['m']).add(step_month * num, 'months').diff(dayjs(d['m']), 'days');\n                                }\n                                let day = dayjs(d['m']).add(step, 'days').day(), date;\n                                if (day == 0) {\n                                    date = dayjs(d['m']).add(step, 'days').subtract(2, 'days').format('YYYY-MM-DD');\n                                } else if (day == 6) {\n                                    date = dayjs(d['m']).add(step, 'days').subtract(1, 'days').format('YYYY-MM-DD');\n                                } else {\n                                    date = dayjs(d['m']).add(step, 'days').format('YYYY-MM-DD');\n                                }\n                                d['m'] = date;\n                                d['v'] = genarate(date)[2];\n                                applyData.push(d);\n                            }\n                        } else {\n                            //若日差小于等于7天，以7天为step（若那天是休息日，则向前取最近的工作日）\n                            let step_day;\n                            if (direction == 'down' || direction == 'right') {\n                                step_day = 7;\n                            } else if (direction == 'up' || direction == 'left') {\n                                step_day = -7;\n                                data.reverse();\n                            }\n                            let step;    //以数组第一个为对比\n                            //以数组第一个为对比\n                            for (let i = 1; i <= len; i++) {\n                                let index = (i - 1) % data.length;\n                                let d = $.extend(true, {}, data[index]);\n                                let num = Math.ceil(i / data.length);\n                                if (index == 0) {\n                                    step = dayjs(d['m']).add(step_day * num, 'days').diff(dayjs(d['m']), 'days');\n                                }\n                                let day = dayjs(d['m']).add(step, 'days').day(), date;\n                                if (day == 0) {\n                                    date = dayjs(d['m']).add(step, 'days').subtract(2, 'days').format('YYYY-MM-DD');\n                                } else if (day == 6) {\n                                    date = dayjs(d['m']).add(step, 'days').subtract(1, 'days').format('YYYY-MM-DD');\n                                } else {\n                                    date = dayjs(d['m']).add(step, 'days').format('YYYY-MM-DD');\n                                }\n                                d['m'] = date;\n                                d['v'] = genarate(date)[2];\n                                applyData.push(d);\n                            }\n                        }\n                    } else {\n                        //日差不是等差数列，复制数据\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                        }\n                        applyData = _this.FillCopy(data, len);\n                    }\n                }\n            } else if (type == '6') {\n                //以月填充\n                if (data.length == 1) {\n                    //以一月为step\n                    let step;\n                    if (direction == 'down' || direction == 'right') {\n                        step = 1;\n                    } else if (direction == 'up' || direction == 'left') {\n                        step = -1;\n                    }\n                    applyData = _this.FillMonths(data, len, step);\n                } else if (data.length == 2) {\n                    if (dayjs(data[1]['m']).date() == dayjs(data[0]['m']).date() && dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'months') != 0) {\n                        //日一样，且月差大于一月，以月差为step\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                        }\n                        let step = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'months');\n                        applyData = _this.FillMonths(data, len, step);\n                    } else {\n                        //以一月为step\n                        let step_month;\n                        if (direction == 'down' || direction == 'right') {\n                            step_month = 1;\n                        } else if (direction == 'up' || direction == 'left') {\n                            step_month = -1;\n                            data.reverse();\n                        }\n                        let step;    //以数组第一个为对比\n                        //以数组第一个为对比\n                        for (let i = 1; i <= len; i++) {\n                            let index = (i - 1) % data.length;\n                            let d = $.extend(true, {}, data[index]);\n                            let num = Math.ceil(i / data.length);\n                            if (index == 0) {\n                                step = dayjs(d['m']).add(step_month * num, 'months').diff(dayjs(d['m']), 'days');\n                            }\n                            let date = dayjs(d['m']).add(step, 'days').format('YYYY-MM-DD');\n                            d['m'] = date;\n                            d['v'] = genarate(date)[2];\n                            applyData.push(d);\n                        }\n                    }\n                } else {\n                    let judgeDate = _this.judgeDate(data);\n                    if (judgeDate[0] && judgeDate[3]) {\n                        //日一样，且月差为等差数列，以月差为step\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                        }\n                        let step = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'months');\n                        applyData = _this.FillMonths(data, len, step);\n                    } else if (!judgeDate[0] && judgeDate[2]) {\n                        //日不一样，且日差为等差数列，以一月为step\n                        let step_month;\n                        if (direction == 'down' || direction == 'right') {\n                            step_month = 1;\n                        } else if (direction == 'up' || direction == 'left') {\n                            step_month = -1;\n                            data.reverse();\n                        }\n                        let step;    //以数组第一个为对比\n                        //以数组第一个为对比\n                        for (let i = 1; i <= len; i++) {\n                            let index = (i - 1) % data.length;\n                            let d = $.extend(true, {}, data[index]);\n                            let num = Math.ceil(i / data.length);\n                            if (index == 0) {\n                                step = dayjs(d['m']).add(step_month * num, 'months').diff(dayjs(d['m']), 'days');\n                            }\n                            let date = dayjs(d['m']).add(step, 'days').format('YYYY-MM-DD');\n                            d['m'] = date;\n                            d['v'] = genarate(date)[2];\n                            applyData.push(d);\n                        }\n                    } else {\n                        //日差不是等差数列，复制数据\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                        }\n                        applyData = _this.FillCopy(data, len);\n                    }\n                }\n            } else if (type == '7') {\n                //以年填充\n                if (data.length == 1) {\n                    //以一年为step\n                    let step;\n                    if (direction == 'down' || direction == 'right') {\n                        step = 1;\n                    } else if (direction == 'up' || direction == 'left') {\n                        step = -1;\n                    }\n                    applyData = _this.FillYears(data, len, step);\n                } else if (data.length == 2) {\n                    if (dayjs(data[1]['m']).date() == dayjs(data[0]['m']).date() && dayjs(data[1]['m']).month() == dayjs(data[0]['m']).month() && dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'years') != 0) {\n                        //日月一样，且年差大于一年，以年差为step\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                        }\n                        let step = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'years');\n                        applyData = _this.FillYears(data, len, step);\n                    } else {\n                        //以一年为step\n                        let step_year;\n                        if (direction == 'down' || direction == 'right') {\n                            step_year = 1;\n                        } else if (direction == 'up' || direction == 'left') {\n                            step_year = -1;\n                            data.reverse();\n                        }\n                        let step;    //以数组第一个为对比\n                        //以数组第一个为对比\n                        for (let i = 1; i <= len; i++) {\n                            let index = (i - 1) % data.length;\n                            let d = $.extend(true, {}, data[index]);\n                            let num = Math.ceil(i / data.length);\n                            if (index == 0) {\n                                step = dayjs(d['m']).add(step_year * num, 'years').diff(dayjs(d['m']), 'days');\n                            }\n                            let date = dayjs(d['m']).add(step, 'days').format('YYYY-MM-DD');\n                            d['m'] = date;\n                            d['v'] = genarate(date)[2];\n                            applyData.push(d);\n                        }\n                    }\n                } else {\n                    let judgeDate = _this.judgeDate(data);\n                    if (judgeDate[0] && judgeDate[1] && judgeDate[4]) {\n                        //日月一样，且年差为等差数列，以年差为step\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                        }\n                        let step = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'years');\n                        applyData = _this.FillYears(data, len, step);\n                    } else if (judgeDate[0] && judgeDate[3] || judgeDate[2]) {\n                        //日一样且月差为等差数列，或天差为等差数列，以一年为step\n                        let step_year;\n                        if (direction == 'down' || direction == 'right') {\n                            step_year = 1;\n                        } else if (direction == 'up' || direction == 'left') {\n                            step_year = -1;\n                            data.reverse();\n                        }\n                        let step;    //以数组第一个为对比\n                        //以数组第一个为对比\n                        for (let i = 1; i <= len; i++) {\n                            let index = (i - 1) % data.length;\n                            let d = $.extend(true, {}, data[index]);\n                            let num = Math.ceil(i / data.length);\n                            if (index == 0) {\n                                step = dayjs(d['m']).add(step_year * num, 'years').diff(dayjs(d['m']), 'days');\n                            }\n                            let date = dayjs(d['m']).add(step, 'days').format('YYYY-MM-DD');\n                            d['m'] = date;\n                            d['v'] = genarate(date)[2];\n                            applyData.push(d);\n                        }\n                    } else {\n                        //日差不是等差数列，复制数据\n                        if (direction == 'up' || direction == 'left') {\n                            data.reverse();\n                        }\n                        applyData = _this.FillCopy(data, len);\n                    }\n                }\n            } else if (type == '8') {\n                //以中文小写数字序列填充\n                if (data.length == 1) {\n                    let step;\n                    if (direction == 'down' || direction == 'right') {\n                        step = 1;\n                    } else if (direction == 'up' || direction == 'left') {\n                        step = -1;\n                    }\n                    applyData = _this.FillChnNumber(data, len, step);\n                } else {\n                    let dataNumArr = [];\n                    for (let i = 0; i < data.length; i++) {\n                        dataNumArr.push(_this.ChineseToNumber(data[i]['m']));\n                    }\n                    if (direction == 'up' || direction == 'left') {\n                        data.reverse();\n                        dataNumArr.reverse();\n                    }\n                    if (_this.isEqualDiff(dataNumArr)) {\n                        let step = dataNumArr[1] - dataNumArr[0];\n                        applyData = _this.FillChnNumber(data, len, step);\n                    } else {\n                        //不是等差数列，复制数据\n                        applyData = _this.FillCopy(data, len);\n                    }\n                }\n            }\n            return applyData;\n        },\n        FillCopy: function (data, len) {\n            let applyData = [];\n            for (let i = 1; i <= len; i++) {\n                let index = (i - 1) % data.length;\n                let d = $.extend(true, {}, data[index]);\n                applyData.push(d);\n            }\n            return applyData;\n        },\n        FillSeries: function (data, len, direction) {\n            let _this = this;\n            let applyData = [];\n            let dataNumArr = [];\n            for (let j = 0; j < data.length; j++) {\n                dataNumArr.push(Number(data[j]['v']));\n            }\n            if (data.length > 2 && _this.isEqualRatio(dataNumArr)) {\n                //等比数列\n                for (let i = 1; i <= len; i++) {\n                    let index = (i - 1) % data.length;\n                    let d = $.extend(true, {}, data[index]);\n                    let num;\n                    if (direction == 'down' || direction == 'right') {\n                        num = Number(data[data.length - 1]['v']) * Math.pow(Number(data[1]['v']) / Number(data[0]['v']), i);\n                    } else if (direction == 'up' || direction == 'left') {\n                        num = Number(data[0]['v']) / Math.pow(Number(data[1]['v']) / Number(data[0]['v']), i);\n                    }\n                    d['v'] = num;\n                    d['m'] = update(d['ct']['fa'], num);\n                    applyData.push(d);\n                }\n            } else {\n                //线性数列\n                let xArr = _this.getXArr(data.length);\n                for (let i = 1; i <= len; i++) {\n                    let index = (i - 1) % data.length;\n                    let d = $.extend(true, {}, data[index]);\n                    let y;\n                    if (direction == 'down' || direction == 'right') {\n                        y = _this.forecast(data.length + i, dataNumArr, xArr);\n                    } else if (direction == 'up' || direction == 'left') {\n                        y = _this.forecast(1 - i, dataNumArr, xArr);\n                    }\n                    d['v'] = y;\n                    d['m'] = update(d['ct']['fa'], y);\n                    applyData.push(d);\n                }\n            }\n            return applyData;\n        },\n        FillExtendNumber: function (data, len, step) {\n            let _this = this;\n            let applyData = [];\n            let reg = /0|([1-9]+[0-9]*)/g;\n            for (let i = 1; i <= len; i++) {\n                let index = (i - 1) % data.length;\n                let d = $.extend(true, {}, data[index]);\n                let last = data[data.length - 1]['m'];\n                let match = last.match(reg);\n                let lastTxt = match[match.length - 1];\n                let num = Math.abs(Number(lastTxt) + step * i);\n                let lastIndex = last.lastIndexOf(lastTxt);\n                let valueTxt = last.substr(0, lastIndex) + num.toString() + last.substr(lastIndex + lastTxt.length);\n                d['v'] = valueTxt;\n                d['m'] = valueTxt;\n                applyData.push(d);\n            }\n            return applyData;\n        },\n        FillOnlyFormat: function (data, len) {\n            let applyData = [];\n            for (let i = 1; i <= len; i++) {\n                let index = (i - 1) % data.length;\n                let d = $.extend(true, {}, data[index]);\n                delete d['f'];\n                delete d['m'];\n                delete d['v'];\n                applyData.push(d);\n            }\n            return applyData;\n        },\n        FillWithoutFormat: function (dataArr) {\n            let applyData = [];\n            for (let i = 0; i < dataArr.length; i++) {\n                let d = $.extend(true, {}, dataArr[i]);\n                let obj;\n                if (d['f'] == null) {\n                    obj = {\n                        'm': d['v'].toString(),\n                        'v': d['v']\n                    };\n                } else {\n                    obj = {\n                        'f': d['f'],\n                        'm': d['v'].toString(),\n                        'v': d['v']\n                    };\n                }\n                applyData.push(obj);\n            }\n            return applyData;\n        },\n        FillDays: function (data, len, step) {\n            let applyData = [];\n            for (let i = 1; i <= len; i++) {\n                let index = (i - 1) % data.length;\n                let d = $.extend(true, {}, data[index]);\n                let date = update('yyyy-MM-dd', d['v']);\n                date = dayjs(date).add(step * i, 'days').format('YYYY-MM-DD');\n                d['v'] = genarate(date)[2];\n                d['m'] = update(d['ct']['fa'], d['v']);\n                applyData.push(d);\n            }\n            return applyData;\n        },\n        FillMonths: function (data, len, step) {\n            let applyData = [];\n            for (let i = 1; i <= len; i++) {\n                let index = (i - 1) % data.length;\n                let d = $.extend(true, {}, data[index]);\n                let date = update('yyyy-MM-dd', d['v']);\n                date = dayjs(date).add(step * i, 'months').format('YYYY-MM-DD');\n                d['v'] = genarate(date)[2];\n                d['m'] = update(d['ct']['fa'], d['v']);\n                applyData.push(d);\n            }\n            return applyData;\n        },\n        FillYears: function (data, len, step) {\n            let applyData = [];\n            for (let i = 1; i <= len; i++) {\n                let index = (i - 1) % data.length;\n                let d = $.extend(true, {}, data[index]);\n                let date = update('yyyy-MM-dd', d['v']);\n                date = dayjs(date).add(step * i, 'years').format('YYYY-MM-DD');\n                d['v'] = genarate(date)[2];\n                d['m'] = update(d['ct']['fa'], d['v']);\n                applyData.push(d);\n            }\n            return applyData;\n        },\n        FillChnWeek: function (data, len, step) {\n            let _this = this;\n            let applyData = [];\n            for (let i = 1; i <= len; i++) {\n                let index = (i - 1) % data.length;\n                let d = $.extend(true, {}, data[index]);\n                let num;\n                if (data[data.length - 1]['m'] == '日') {\n                    num = 7 + step * i;\n                } else {\n                    num = _this.ChineseToNumber(data[data.length - 1]['m']) + step * i;\n                }\n                if (num < 0) {\n                    num = Math.ceil(Math.abs(num) / 7) * 7 + num;\n                }\n                let rsd = num % 7;\n                if (rsd == 0) {\n                    d['m'] = '日';\n                    d['v'] = '日';\n                } else if (rsd == 1) {\n                    d['m'] = '一';\n                    d['v'] = '一';\n                } else if (rsd == 2) {\n                    d['m'] = '二';\n                    d['v'] = '二';\n                } else if (rsd == 3) {\n                    d['m'] = '三';\n                    d['v'] = '三';\n                } else if (rsd == 4) {\n                    d['m'] = '四';\n                    d['v'] = '四';\n                } else if (rsd == 5) {\n                    d['m'] = '五';\n                    d['v'] = '五';\n                } else if (rsd == 6) {\n                    d['m'] = '六';\n                    d['v'] = '六';\n                }\n                applyData.push(d);\n            }\n            return applyData;\n        },\n        FillChnWeek2: function (data, len, step) {\n            let _this = this;\n            let applyData = [];\n            for (let i = 1; i <= len; i++) {\n                let index = (i - 1) % data.length;\n                let d = $.extend(true, {}, data[index]);\n                let num;\n                if (data[data.length - 1]['m'] == '周日') {\n                    num = 7 + step * i;\n                } else {\n                    let last = data[data.length - 1]['m'];\n                    let txt = last.substr(last.length - 1, 1);\n                    num = _this.ChineseToNumber(txt) + step * i;\n                }\n                if (num < 0) {\n                    num = Math.ceil(Math.abs(num) / 7) * 7 + num;\n                }\n                let rsd = num % 7;\n                if (rsd == 0) {\n                    d['m'] = '周日';\n                    d['v'] = '周日';\n                } else if (rsd == 1) {\n                    d['m'] = '周一';\n                    d['v'] = '周一';\n                } else if (rsd == 2) {\n                    d['m'] = '周二';\n                    d['v'] = '周二';\n                } else if (rsd == 3) {\n                    d['m'] = '周三';\n                    d['v'] = '周三';\n                } else if (rsd == 4) {\n                    d['m'] = '周四';\n                    d['v'] = '周四';\n                } else if (rsd == 5) {\n                    d['m'] = '周五';\n                    d['v'] = '周五';\n                } else if (rsd == 6) {\n                    d['m'] = '周六';\n                    d['v'] = '周六';\n                }\n                applyData.push(d);\n            }\n            return applyData;\n        },\n        FillChnWeek3: function (data, len, step) {\n            let _this = this;\n            let applyData = [];\n            for (let i = 1; i <= len; i++) {\n                let index = (i - 1) % data.length;\n                let d = $.extend(true, {}, data[index]);\n                let num;\n                if (data[data.length - 1]['m'] == '星期日') {\n                    num = 7 + step * i;\n                } else {\n                    let last = data[data.length - 1]['m'];\n                    let txt = last.substr(last.length - 1, 1);\n                    num = _this.ChineseToNumber(txt) + step * i;\n                }\n                if (num < 0) {\n                    num = Math.ceil(Math.abs(num) / 7) * 7 + num;\n                }\n                let rsd = num % 7;\n                if (rsd == 0) {\n                    d['m'] = '星期日';\n                    d['v'] = '星期日';\n                } else if (rsd == 1) {\n                    d['m'] = '星期一';\n                    d['v'] = '星期一';\n                } else if (rsd == 2) {\n                    d['m'] = '星期二';\n                    d['v'] = '星期二';\n                } else if (rsd == 3) {\n                    d['m'] = '星期三';\n                    d['v'] = '星期三';\n                } else if (rsd == 4) {\n                    d['m'] = '星期四';\n                    d['v'] = '星期四';\n                } else if (rsd == 5) {\n                    d['m'] = '星期五';\n                    d['v'] = '星期五';\n                } else if (rsd == 6) {\n                    d['m'] = '星期六';\n                    d['v'] = '星期六';\n                }\n                applyData.push(d);\n            }\n            return applyData;\n        },\n        FillChnNumber: function (data, len, step) {\n            let _this = this;\n            let applyData = [];\n            for (let i = 1; i <= len; i++) {\n                let index = (i - 1) % data.length;\n                let d = $.extend(true, {}, data[index]);\n                let num = _this.ChineseToNumber(data[data.length - 1]['m']) + step * i, txt;\n                if (num <= 0) {\n                    txt = '零';\n                } else {\n                    txt = _this.NumberToChinese(num);\n                }\n                d['v'] = txt;\n                d['m'] = txt.toString();\n                applyData.push(d);\n            }\n            return applyData;\n        },\n        isEqualDiff: function (arr) {\n            let diff = true;\n            let step = arr[1] - arr[0];\n            for (let i = 1; i < arr.length; i++) {\n                if (arr[i] - arr[i - 1] != step) {\n                    diff = false;\n                    break;\n                }\n            }\n            return diff;\n        },\n        isEqualRatio: function (arr) {\n            let ratio = true;\n            let step = arr[1] / arr[0];\n            for (let i = 1; i < arr.length; i++) {\n                if (arr[i] / arr[i - 1] != step) {\n                    ratio = false;\n                    break;\n                }\n            }\n            return ratio;\n        },\n        getXArr: function (len) {\n            let xArr = [];\n            for (let i = 1; i <= len; i++) {\n                xArr.push(i);\n            }\n            return xArr;\n        },\n        forecast: function (x, yArr, xArr) {\n            function getAverage(arr) {\n                let sum = 0;\n                for (let i = 0; i < arr.length; i++) {\n                    sum += arr[i];\n                }\n                return sum / arr.length;\n            }\n            let ax = getAverage(xArr);    //x数组 平均值\n            //x数组 平均值\n            let ay = getAverage(yArr);    //y数组 平均值\n            //y数组 平均值\n            let sum_d = 0, sum_n = 0;\n            for (let j = 0; j < xArr.length; j++) {\n                //分母和\n                sum_d += (xArr[j] - ax) * (yArr[j] - ay);    //分子和\n                //分子和\n                sum_n += (xArr[j] - ax) * (xArr[j] - ax);\n            }\n            let b;\n            if (sum_n == 0) {\n                b = 1;\n            } else {\n                b = sum_d / sum_n;\n            }\n            let a = ay - b * ax;\n            return Math.round((a + b * x) * 100000) / 100000;\n        },\n        judgeDate: function (data) {\n            let isSameDay = true, isSameMonth = true, isEqualDiffDays = true, isEqualDiffMonths = true, isEqualDiffYears = true;\n            let sameDay = dayjs(data[0]['m']).date(), sameMonth = dayjs(data[0]['m']).month();\n            let equalDiffDays = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'days');\n            let equalDiffMonths = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'months');\n            let equalDiffYears = dayjs(data[1]['m']).diff(dayjs(data[0]['m']), 'years');\n            for (let i = 1; i < data.length; i++) {\n                //日是否一样\n                if (dayjs(data[i]['m']).date() != sameDay) {\n                    isSameDay = false;\n                }    //月是否一样\n                //月是否一样\n                if (dayjs(data[i]['m']).month() != sameMonth) {\n                    isSameMonth = false;\n                }    //日差是否是 等差数列\n                //日差是否是 等差数列\n                if (dayjs(data[i]['m']).diff(dayjs(data[i - 1]['m']), 'days') != equalDiffDays) {\n                    isEqualDiffDays = false;\n                }    //月差是否是 等差数列\n                //月差是否是 等差数列\n                if (dayjs(data[i]['m']).diff(dayjs(data[i - 1]['m']), 'months') != equalDiffMonths) {\n                    isEqualDiffMonths = false;\n                }    //年差是否是 等差数列\n                //年差是否是 等差数列\n                if (dayjs(data[i]['m']).diff(dayjs(data[i - 1]['m']), 'years') != equalDiffYears) {\n                    isEqualDiffYears = false;\n                }\n            }\n            if (equalDiffDays == 0) {\n                isEqualDiffDays = false;\n            }\n            if (equalDiffMonths == 0) {\n                isEqualDiffMonths = false;\n            }\n            if (equalDiffYears == 0) {\n                isEqualDiffYears = false;\n            }\n            return [\n                isSameDay,\n                isSameMonth,\n                isEqualDiffDays,\n                isEqualDiffMonths,\n                isEqualDiffYears\n            ];\n        }\n    };\n    return luckysheetDropCell;\n});"]}