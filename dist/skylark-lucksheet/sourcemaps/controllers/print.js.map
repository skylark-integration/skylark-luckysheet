{"version":3,"sources":["controllers/print.js"],"names":["define","luckysheetConfigsetting","m_zoom","m_location","Store","zoomChange","rowLocationByIndex","colLocationByIndex","mouseposition","rowLocation","colLocation","viewChange","curType","preType","currentSheet","getSheetByIndex","config","sheetViewZoom","defaultZoom","type","curZoom","curentsheetView","clearjfundo","jfredo","push","sheetIndex","currentSheetIndex","saveParam","k","currentSheetView","printInitial","container","$","find","click","$t","parent","attr","removeClass","addClass","switchViewBtn","this"],"mappings":";;;;;;;AAAAA,QACI,qCACA,SACA,sBACA,YACD,SAAUC,EAAyBC,EAASC,EAAYC,GACvD,aACA,MAAMC,WAACA,GAAcH,GACfI,mBAACA,EAAkBC,mBAAEA,EAAkBC,cAAEA,EAAaC,YAAEA,EAAWC,YAAEA,GAAeP,EAsB1F,SAASQ,EAAWC,EAASC,GACzB,IAAIC,EAAeV,EAAMW,kBACE,MAAvBD,EAAaE,SACbF,EAAaE,WAEwB,MAArCF,EAAaE,OAAOC,gBACpBH,EAAaE,OAAOC,kBAExB,IAAIC,EAAc,EAAGC,EAAO,kBAEb,cAAXP,EACAO,EAAO,sBACW,cAAXP,EACPO,EAAO,sBACW,YAAXP,IACPO,EAAO,oBACPD,EAAc,IAGlB,IAAIE,EAAUN,EAAaE,OAAOC,cAAcE,GACjC,MAAXC,IACAA,EAAUF,GAEdJ,EAAaE,OAAOK,gBAAkBT,EAClCR,EAAMkB,aACNlB,EAAMmB,OAAOC,MACTL,KAAQ,aACRP,QAAWA,EACXC,QAAWA,EACXY,WAAcrB,EAAMsB,oBAM5BtB,EAAMuB,UAAU,KAAMvB,EAAMsB,kBAAmBd,GAAWgB,EAAK,oBAC/DxB,EAAMyB,iBAAmBjB,EACzBP,EAAWe,GA2Bf,OACIT,WAAYA,EACZmB,aATJ,WACI,IAAIC,EAAY9B,EAAwB8B,UAExCC,EAAE,IAAMD,GAAWE,KAAK,6BAA6BC,MAAM,YAjB/D,SAAuBC,GACnB,IAA6BtB,EAAbsB,EAAGC,SAA8BH,KAAK,mCAAmCI,KAAK,QAC9F,GAAIF,EAAGE,KAAK,SAAWxB,EACnB,OAEJ,IAAID,EAAUuB,EAAGE,KAAK,QACP,MAAXzB,IACAD,EAAWC,EAASC,GAIxBsB,EAAGC,SAASH,KAAK,6BAA6BK,YAAY,mCAC1DH,EAAGI,SAAS,oCAMRC,CAAcR,EAAES","file":"../../controllers/print.js","sourcesContent":["define([\n    '../methods/luckysheetConfigsetting',\n    './zoom',\n    '../methods/location',\n    '../store'\n], function (luckysheetConfigsetting, m_zoom,  m_location, Store) {\n    'use strict';\n    const {zoomChange} = m_zoom;\n    const {rowLocationByIndex, colLocationByIndex, mouseposition, rowLocation, colLocation} = m_location;\n    let ExcelPlaceholder = {\n        '[tabName]': '&A',\n        '[CurrentDate]': '&D',\n        '[fileName]': '&F',\n        '[background]': '&G',\n        '[Shadow]': '&H',\n        '[TotalPages]': '&N',\n        '[pageNumber]': '&P',\n        '[CurrentTime]': '&T',\n        '[filePath]': '&Z'\n    };    // Get the pixel value per millimeter\n    // Get the pixel value per millimeter\n    function getOneMmsPx() {\n        let div = document.createElement('div');\n        div.style.width = '1mm';\n        document.querySelector('body').appendChild(div);\n        let mm1 = div.getBoundingClientRect();\n        let w = mm1.width;\n        $(div).remove();\n        return mm1.width;\n    }\n    function viewChange(curType, preType) {\n        let currentSheet = Store.getSheetByIndex();\n        if (currentSheet.config == null) {\n            currentSheet.config = {};\n        }\n        if (currentSheet.config.sheetViewZoom == null) {\n            currentSheet.config.sheetViewZoom = {};\n        }\n        let defaultZoom = 1, type = 'zoomScaleNormal';\n        printLineAndNumberDelete(currentSheet);\n        if (curType == 'viewNormal') {\n            type = 'viewNormalZoomScale';\n        } else if (curType == 'viewLayout') {\n            type = 'viewLayoutZoomScale';\n        } else if (curType == 'viewPage') {\n            type = 'viewPageZoomScale';\n            defaultZoom = 0.6;\n            printLineAndNumberCreate(currentSheet);\n        }\n        let curZoom = currentSheet.config.sheetViewZoom[type];\n        if (curZoom == null) {\n            curZoom = defaultZoom;\n        }\n        currentSheet.config.curentsheetView = curType;\n        if (Store.clearjfundo) {\n            Store.jfredo.push({\n                'type': 'viewChange',\n                'curType': curType,\n                'preType': preType,\n                'sheetIndex': Store.currentSheetIndex\n            });\n        }    // Store.zoomRatio = curZoom;\n             // Store.saveParam(\"all\", Store.currentSheetIndex, curZoom, { \"k\": \"zoomRatio\" });\n        // Store.zoomRatio = curZoom;\n        // Store.saveParam(\"all\", Store.currentSheetIndex, curZoom, { \"k\": \"zoomRatio\" });\n        Store.saveParam('cg', Store.currentSheetIndex, curType, { 'k': 'curentsheetView' });\n        Store.currentSheetView = curType;\n        zoomChange(curZoom);\n    }\n    function printLineAndNumberDelete(sheet) {\n    }\n    function printLineAndNumberCreate(sheet) {\n    }\n    function switchViewBtn($t) {\n        let $viewList = $t.parent(), preType = $viewList.find('luckysheet-print-viewBtn-active').attr('type');\n        if ($t.attr('type') == preType) {\n            return;\n        }\n        let curType = $t.attr('type');\n        if (curType != null) {\n            viewChange(curType, preType);\n        } else {\n            return;\n        }\n        $t.parent().find('.luckysheet-print-viewBtn').removeClass('luckysheet-print-viewBtn-active');\n        $t.addClass('luckysheet-print-viewBtn-active');\n    }\n    function printInitial() {\n        let container = luckysheetConfigsetting.container;\n        let _this = this;\n        $('#' + container).find('.luckysheet-print-viewBtn').click(function () {\n            switchViewBtn($(this));\n        });\n    }\n    return {\n        viewChange: viewChange,\n        printInitial: printInitial\n    };\n});"]}