{"version":3,"sources":["controllers/scroll.js"],"names":["define","luckysheetFreezen","m_sheetSearch","Store","luckysheetConfigsetting","luckysheet_searcharray","isadjust","$t","$","scrollLeft","scrollTop","canvasHeight","height","freezenhorizontaldata","freezenverticaldata","css","left","top","parseInt","z-index","show","refresh","scrollAdapt","createHookFunction"],"mappings":";;;;;;;AAAAA,QACI,yBACA,yBACA,WACA,sCACD,SAAUC,EAAmBC,EAAeC,EAAOC,GAClD,aACA,MAAMC,uBAACA,GAA0BH,EASjC,OAAO,SAA+BI,GAClC,IAAIC,EAAKC,EAAE,yBACPC,EAAaD,EAAE,2BAA2BC,aAAcC,EAAYF,EAAE,2BAA2BE,YAAaC,EAAeH,EAAE,2BAA2BI,SAqC9J,OAAmC,MAA/BT,EAAMU,uBACFH,EAAYP,EAAMU,sBAAsB,IACxCH,EAAYP,EAAMU,sBAAsB,QACxCL,EAAE,2BAA2BE,UAAUA,IAId,MAA7BP,EAAMW,qBACFL,EAAaN,EAAMW,oBAAoB,IACvCL,EAAaN,EAAMW,oBAAoB,QACvCN,EAAE,2BAA2BC,WAAWA,KAIhDD,EAAE,wBAAwBC,WAAWA,GAErCD,EAAE,sBAAsBE,UAAUA,GAElCH,EAAGE,WAAWA,GAAYC,UAAUA,GACpCF,EAAE,+BAA+BO,KAC7BC,KAAQR,EAAE,yBAAyBO,IAAI,QACvCE,IAAOC,SAASV,EAAE,yBAAyBO,IAAI,QAAU,GAAK,KAC9DI,UAAWX,EAAE,yBAAyBO,IAAI,aAC3CK,OASHjB,EAAMkB,QAAQZ,EAAWC,GAEzBF,EAAE,mCAAmCO,IAAI,OAAQN,GAEd,MAA/BN,EAAMU,uBAA8D,MAA7BV,EAAMW,qBAC7Cb,EAAkBqB,mBAEjBlB,EAAwBmB,mBAAmB,UACxCd,WAAAA,EACAC,UAAAA,EACAC,aAAAA","file":"../../controllers/scroll.js","sourcesContent":["define([\n    '../controllers/freezen',\n    '../methods/sheetSearch',\n    '../store',\n    '../methods/luckysheetConfigsetting'\n], function (luckysheetFreezen, m_sheetSearch, Store, luckysheetConfigsetting) {\n    'use strict';\n    const {luckysheet_searcharray} = m_sheetSearch;\n    let scrollRequestAnimationFrameIni = true, scrollRequestAnimationFrame = false, scrollTimeOutCancel = null;\n    function execScroll() {\n        let scrollLeft = $('#luckysheet-scrollbar-x').scrollLeft(), scrollTop = $('#luckysheet-scrollbar-y').scrollTop();\n        ///luckysheetrefreshgrid(scrollLeft, scrollTop);\n        Store.refresh(scrollLeft,scrollTop)\n        scrollRequestAnimationFrame = window.requestAnimationFrame(execScroll);\n    } \n    //全局滚动事件\n    return function luckysheetscrollevent(isadjust) {\n        let $t = $('#luckysheet-cell-main');\n        let scrollLeft = $('#luckysheet-scrollbar-x').scrollLeft(), scrollTop = $('#luckysheet-scrollbar-y').scrollTop(), canvasHeight = $('#luckysheetTableContent').height();                                                                             // }\n        // canvas高度\n        // clearTimeout(scrollTimeOutCancel);\n        // scrollTimeOutCancel = setTimeout(() => {\n        //     scrollRequestAnimationFrameIni  = true;\n        //     window.cancelAnimationFrame(scrollRequestAnimationFrame);\n        // }, 500);\n        // if (!!isadjust) {\n        //     let scrollHeight = $t.get(0).scrollHeight;\n        //     let windowHeight = $t.height();\n        //     let scrollWidth = $t.get(0).scrollWidth;\n        //     let windowWidth = $t.width();\n        //     let maxScrollLeft = scrollWidth - windowWidth;\n        //     let maxScrollTop = scrollHeight - windowHeight;\n        //     let visibledatacolumn_c = Store.visibledatacolumn, visibledatarow_c = Store.visibledatarow;\n        //     if (Store.freezenhorizontaldata != null) {\n        //         visibledatarow_c = Store.freezenhorizontaldata[3];\n        //     }\n        //     if (Store.freezenverticaldata != null) {\n        //         visibledatacolumn_c = Store.freezenverticaldata[3];\n        //     }\n        //     let col_ed = luckysheet_searcharray(visibledatacolumn_c, scrollLeft);\n        //     let row_ed = luckysheet_searcharray(visibledatarow_c, scrollTop);\n        //     let refreshLeft = scrollLeft , refreshTop = scrollTop;\n        //     if (col_ed <= 0) {\n        //         scrollLeft = 0;\n        //     }\n        //     else {\n        //         scrollLeft = visibledatacolumn_c[col_ed - 1];\n        //     }\n        //     if (row_ed <= 0) {\n        //         scrollTop = 0;\n        //     }\n        //     else {\n        //         scrollTop = visibledatarow_c[row_ed - 1];\n        //     }\n        // }\n        if (Store.freezenhorizontaldata != null) {\n            if (scrollTop < Store.freezenhorizontaldata[2]) {\n                scrollTop = Store.freezenhorizontaldata[2];\n                $('#luckysheet-scrollbar-y').scrollTop(scrollTop);\n                return;\n            }\n        }\n        if (Store.freezenverticaldata != null) {\n            if (scrollLeft < Store.freezenverticaldata[2]) {\n                scrollLeft = Store.freezenverticaldata[2];\n                $('#luckysheet-scrollbar-x').scrollLeft(scrollLeft);\n                return;\n            }\n        }\n        $('#luckysheet-cols-h-c').scrollLeft(scrollLeft);    //列标题\n        //列标题\n        $('#luckysheet-rows-h').scrollTop(scrollTop);    //行标题\n        //行标题\n        $t.scrollLeft(scrollLeft).scrollTop(scrollTop);\n        $('#luckysheet-input-box-index').css({\n            'left': $('#luckysheet-input-box').css('left'),\n            'top': parseInt($('#luckysheet-input-box').css('top')) - 20 + 'px',\n            'z-index': $('#luckysheet-input-box').css('z-index')\n        }).show();    // if(scrollRequestAnimationFrameIni && Store.scrollRefreshSwitch){\n                      //     execScroll();\n                      //     scrollRequestAnimationFrameIni = false;\n                      // }\n        // if(scrollRequestAnimationFrameIni && Store.scrollRefreshSwitch){\n        //     execScroll();\n        //     scrollRequestAnimationFrameIni = false;\n        // }\n        ///luckysheetrefreshgrid(scrollLeft, scrollTop);\n        Store.refresh(scrollLeft,scrollTop)\n\n        $('#luckysheet-bottom-controll-row').css('left', scrollLeft);    //有选区且有冻结时，滚动适应\n        //有选区且有冻结时，滚动适应\n        if (Store.freezenhorizontaldata != null || Store.freezenverticaldata != null) {\n            luckysheetFreezen.scrollAdapt();\n        }\n        if (!luckysheetConfigsetting.createHookFunction('scroll', {\n                scrollLeft,\n                scrollTop,\n                canvasHeight\n            })) {\n            return;\n        }\n    };\n});"]}