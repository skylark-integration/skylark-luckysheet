{"version":3,"sources":["controllers/rowColumnOperation.js"],"names":["define","pivotTable","luckysheetPostil","imageCtrl","menuButton","server","m_select","m_util","m_get","m_location","m_validate","m_count","formula","m_extend","m_refresh","m_getdata","tooltip","editor","locale","m_getRowlen","m_sheetSearch","m_inlineString","m_protection","Store","luckysheetConfigsetting","selectHightlightShow","luckysheet_count_show","selectHelpboxFill","getObjType","showrightclickmenu","luckysheetContainerFocus","luckysheetfontformat","$$","getSheetIndex","getRangetxt","rowLocation","rowLocationByIndex","colLocation","colLocationByIndex","mouseposition","isRealNull","isRealNum","hasPartMC","isEditMode","countfunc","luckysheetextendtable","luckysheetdeletetable","luckysheetDeleteCell","jfrefreshgrid","jfrefreshgridall","jfrefreshgrid_rhcw","getcellvalue","getMeasureText","getCellTextInfo","luckysheet_searcharray","isInlineStringCell","checkProtectionLockedRangeList","checkProtectionAllSelected","checkProtectionAuthorityNormal","rowColumnOperationInitial","$","mousedown","event","currentSheetIndex","removeActivePs","is","cancelActiveImgItem","y","pageX","pageY","scrollTop","row_location","row","row_pre","row_index","col_index","visibledatacolumn","length","col","hide","which","isright","s","luckysheet_select_save","obj_s","flowdata","top","height","rowseleted","luckysheet_scroll_status","$input","parseInt","css","rangestart","rangedrag_column_start","rangedrag_row_start","israngeseleciton","changeparam","mergeMoveMain","row_focus","column_focus","shiftKey","last","func_selectedrange","ctrlKey","find","text","vText","substr","functionHTMLGenerate","window","getSelection","currSelection","functionRangeIndex","anchorNode","parent","index","anchorOffset","textRange","document","selection","createRange","html","canceFunctionrangeSelected","createRangeHightlight","rangeHightlightselected","left","width","left_move","width_move","top_move","height_move","column","rangeSetValue","range","val","show","setTimeout","$editor","rangechangeindex","data_parm_index","closest","$span","setCaretPosition","get","updatecell","luckysheetCellUpdate","luckysheet_rows_selected_status","extend","push","row_select","saveParam","clearTimeout","countfuncTimeout","mousemove","luckysheet_rows_change_size","luckysheet_select_status","display","opacity","mouseleave","mouseup","luckysheetRightHeadClickIs","rightclick","bottom","style","cellRightClickConfig","copy","copyAs","paste","insertRow","deleteRow","hideRow","rowHeight","clear","matrix","sort","filter","chart","image","link","data","cellFormat","this","offset","luckysheet_cols_menu_status","cfg","config","first_rowlen","defaultrowlen","isSame","i","r1","r2","r","x","scrollLeft","visibledatarow","col_location","col_pre","orderbyindex","columnseleted","luckysheet_cols_selected_status","column_select","stopPropagation","luckysheet_cols_change_size","right","insertColumn","deleteColumn","hideColumn","columnWidth","first_collen","defaultcollen","c1","c2","c","winW","border-width","cursor","luckysheet_rows_change_size_start","mouse","winH","luckysheet_cols_change_size_start","luckysheet_cols_dbclick_times","dblclick","colIndex","d","deepCopyFlowData","canvas","getContext","matchColumn","drawHeight","luckysheetTableContentHW","dataset_row_st","dataset_row_ed","currentColLen","cell","v","cellWidth","textInfo","computeRowlen","textWidthAll","luckysheetcolsdbclick","click","$menu","target","nodeName","_locale","locale_drag","drag","locale_info","info","alert","noMulti","value","tipInputNumber","tipInputNumberLimit","st_index","allowEdit","ed_index","clearjfundo","redo","type","jfundo","jfredo","luckysheetfile","k","str","edr","stc","edc","has_PartMC","noPartMerge","isPivotRange","delFunctionGroup","t","size","trim","images","tipRowHeightLimit","moveChangeSize","tipColumnWidthLimit","ctrlType","sheetIndex","curconfig","curImages","allImagesShow","deleteRows","deleteColumns"],"mappings":"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","file":"../../controllers/rowColumnOperation.js","sourcesContent":["define([\n    './pivotTable',\n    './postil',\n    './imageCtrl',\n    './menuButton',\n    './server',\n    './select',\n    '../utils/util',\n    '../methods/get',\n    '../global/location',\n    '../global/validate',\n    '../global/count',\n    '../global/formula',\n    '../global/extend',\n    '../global/refresh',\n    '../global/getdata',\n    '../global/tooltip',\n    '../global/editor',\n    '../locale/locale',\n    '../global/getRowlen',\n    '../controllers/sheetSearch',\n    './inlineString',\n    './protection',\n    '../store',\n    './luckysheetConfigsetting'\n], function (pivotTable, luckysheetPostil, imageCtrl, menuButton, server, m_select, m_util, m_get, m_location, m_validate, m_count, formula, m_extend, m_refresh, m_getdata, tooltip, editor, locale, m_getRowlen, m_sheetSearch, m_inlineString, m_protection, Store, luckysheetConfigsetting) {\n    'use strict';\n    const {selectHightlightShow, luckysheet_count_show, selectHelpboxFill} = m_select;\n    const {getObjType, showrightclickmenu, luckysheetContainerFocus, luckysheetfontformat, $$} = m_util;\n    const {getSheetIndex, getRangetxt} = m_get;\n    const {rowLocation, rowLocationByIndex, colLocation, colLocationByIndex, mouseposition} = m_location;\n    const {isRealNull, isRealNum, hasPartMC, isEditMode} = m_validate;\n    const {countfunc} = m_count;\n    const {luckysheetextendtable, luckysheetdeletetable, luckysheetDeleteCell} = m_extend;\n    const {jfrefreshgrid, jfrefreshgridall, jfrefreshgrid_rhcw} = m_refresh;\n    const {getcellvalue} = m_getdata;\n    const {getMeasureText, getCellTextInfo} = m_getRowlen;\n    const {luckysheet_searcharray} = m_sheetSearch;\n    const {isInlineStringCell} = m_inlineString;\n    const {checkProtectionLockedRangeList, checkProtectionAllSelected, checkProtectionAuthorityNormal} = m_protection;\n    function rowColumnOperationInitial() {\n        //表格行标题 mouse事件\n        $('#luckysheet-rows-h').mousedown(function (event) {\n            if (!checkProtectionAllSelected(Store.currentSheetIndex)) {\n                return;\n            }    //有批注在编辑时\n            //有批注在编辑时\n            luckysheetPostil.removeActivePs();    //图片 active/cropping\n            //图片 active/cropping\n            if ($('#luckysheet-modal-dialog-activeImage').is(':visible') || $('#luckysheet-modal-dialog-cropping').is(':visible')) {\n                imageCtrl.cancelActiveImgItem();\n            }\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let y = mouse[1] + $('#luckysheet-rows-h').scrollTop();\n            let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n            let col_index = Store.visibledatacolumn.length - 1, col = Store.visibledatacolumn[col_index], col_pre = 0;\n            $('#luckysheet-rightclick-menu').hide();\n            $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();    //mousedown是右键\n            //mousedown是右键\n            if (event.which == '3') {\n                let isright = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let obj_s = Store.luckysheet_select_save[s];\n                    if (obj_s['row'] != null && (row_index >= obj_s['row'][0] && row_index <= obj_s['row'][1]) && (obj_s['column'][0] == 0 && obj_s['column'][1] == Store.flowdata[0].length - 1)) {\n                        isright = true;\n                        break;\n                    }\n                }\n                if (isright) {\n                    return;\n                }\n            }\n            let top = row_pre, height = row - row_pre - 1;\n            let rowseleted = [\n                row_index,\n                row_index\n            ];\n            Store.luckysheet_scroll_status = true;    //公式相关\n            //公式相关\n            let $input = $('#luckysheet-input-box');\n            if (parseInt($input.css('top')) > 0) {\n                if (formula.rangestart || formula.rangedrag_column_start || formula.rangedrag_row_start || formula.israngeseleciton() || $('#luckysheet-ifFormulaGenerator-multiRange-dialog').is(':visible')) {\n                    //公式选区\n                    let changeparam = menuButton.mergeMoveMain([\n                        0,\n                        col_index\n                    ], rowseleted, {\n                        'row_focus': row_index,\n                        'column_focus': 0\n                    }, top, height, col_pre, col);\n                    if (changeparam != null) {\n                        //columnseleted = changeparam[0];\n                        rowseleted = changeparam[1];\n                        top = changeparam[2];\n                        height = changeparam[3];    //left = changeparam[4];\n                                                    //width = changeparam[5];\n                    }\n                    //left = changeparam[4];\n                    //width = changeparam[5];\n                    if (event.shiftKey) {\n                        let last = formula.func_selectedrange;\n                        let top = 0, height = 0, rowseleted = [];\n                        if (last.top > row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            if (last.row[1] > last.row_focus) {\n                                last.row[1] = last.row_focus;\n                            }\n                            rowseleted = [\n                                row_index,\n                                last.row[1]\n                            ];\n                        } else if (last.top == row_pre) {\n                            top = row_pre;\n                            height = last.top + last.height - row_pre;\n                            rowseleted = [\n                                row_index,\n                                last.row[0]\n                            ];\n                        } else {\n                            top = last.top;\n                            height = row - last.top - 1;\n                            if (last.row[0] < last.row_focus) {\n                                last.row[0] = last.row_focus;\n                            }\n                            rowseleted = [\n                                last.row[0],\n                                row_index\n                            ];\n                        }\n                        let changeparam = menuButton.mergeMoveMain([\n                            0,\n                            col_index\n                        ], rowseleted, {\n                            'row_focus': row_index,\n                            'column_focus': 0\n                        }, top, height, col_pre, col);\n                        if (changeparam != null) {\n                            // columnseleted = changeparam[0];\n                            rowseleted = changeparam[1];\n                            top = changeparam[2];\n                            height = changeparam[3];    // left = changeparam[4];\n                                                        // width = changeparam[5];\n                        }\n                        // left = changeparam[4];\n                        // width = changeparam[5];\n                        last['row'] = rowseleted;\n                        last['top_move'] = top;\n                        last['height_move'] = height;\n                        formula.func_selectedrange = last;\n                    } else if (event.ctrlKey && $('#luckysheet-rich-text-editor').find('span').last().text() != ',') {\n                        //按住ctrl 选择选区时  先处理上一个选区\n                        let vText = $('#luckysheet-rich-text-editor').text() + ',';\n                        if (vText.length > 0 && vText.substr(0, 1) == '=') {\n                            vText = formula.functionHTMLGenerate(vText);\n                            if (window.getSelection) {\n                                // all browsers, except IE before version 9\n                                let currSelection = window.getSelection();\n                                formula.functionRangeIndex = [\n                                    $(currSelection.anchorNode).parent().index(),\n                                    currSelection.anchorOffset\n                                ];\n                            } else {\n                                // Internet Explorer before version 9\n                                let textRange = document.selection.createRange();\n                                formula.functionRangeIndex = textRange;\n                            }\n                            $('#luckysheet-rich-text-editor').html(vText);\n                            formula.canceFunctionrangeSelected();\n                            formula.createRangeHightlight();\n                        }\n                        formula.rangestart = false;\n                        formula.rangedrag_column_start = false;\n                        formula.rangedrag_row_start = false;\n                        $('#luckysheet-functionbox-cell').html(vText);\n                        formula.rangeHightlightselected($('#luckysheet-rich-text-editor'));    //再进行 选区的选择\n                        //再进行 选区的选择\n                        formula.israngeseleciton();\n                        formula.func_selectedrange = {\n                            'left': colLocationByIndex(0)[0],\n                            'width': colLocationByIndex(0)[1] - colLocationByIndex(0)[0] - 1,\n                            'top': top,\n                            'height': height,\n                            'left_move': col_pre,\n                            'width_move': col - col_pre - 1,\n                            'top_move': top,\n                            'height_move': height,\n                            'row': rowseleted,\n                            'column': [\n                                0,\n                                col_index\n                            ],\n                            'row_focus': row_index,\n                            'column_focus': 0\n                        };\n                    } else {\n                        formula.func_selectedrange = {\n                            'left': colLocationByIndex(0)[0],\n                            'width': colLocationByIndex(0)[1] - colLocationByIndex(0)[0] - 1,\n                            'top': top,\n                            'height': height,\n                            'left_move': col_pre,\n                            'width_move': col - col_pre - 1,\n                            'top_move': top,\n                            'height_move': height,\n                            'row': rowseleted,\n                            'column': [\n                                0,\n                                col_index\n                            ],\n                            'row_focus': row_index,\n                            'column_focus': 0\n                        };\n                    }\n                    if (formula.rangestart || formula.rangedrag_column_start || formula.rangedrag_row_start || formula.israngeseleciton()) {\n                        formula.rangeSetValue({\n                            'row': rowseleted,\n                            'column': [\n                                null,\n                                null\n                            ]\n                        });\n                    } else if ($('#luckysheet-ifFormulaGenerator-multiRange-dialog').is(':visible')) {\n                        //if公式生成器\n                        let range = getRangetxt(Store.currentSheetIndex, {\n                            'row': rowseleted,\n                            'column': [\n                                0,\n                                col_index\n                            ]\n                        }, Store.currentSheetIndex);\n                        $('#luckysheet-ifFormulaGenerator-multiRange-dialog input').val(range);\n                    }\n                    formula.rangedrag_row_start = true;\n                    formula.rangestart = false;\n                    formula.rangedrag_column_start = false;\n                    $('#luckysheet-formula-functionrange-select').css({\n                        'left': col_pre,\n                        'width': col - col_pre - 1,\n                        'top': top,\n                        'height': height\n                    }).show();\n                    $('#luckysheet-formula-help-c').hide();\n                    luckysheet_count_show(col_pre, top, col - col_pre - 1, height, rowseleted, [\n                        0,\n                        col_index\n                    ]);\n                    setTimeout(function () {\n                        let currSelection = window.getSelection();\n                        let anchorOffset = currSelection.anchorNode;\n                        let $editor;\n                        if ($('#luckysheet-search-formula-parm').is(':visible') || $('#luckysheet-search-formula-parm-select').is(':visible')) {\n                            $editor = $('#luckysheet-rich-text-editor');\n                            formula.rangechangeindex = formula.data_parm_index;\n                        } else {\n                            $editor = $(anchorOffset).closest('div');\n                        }\n                        let $span = $editor.find(\"span[rangeindex='\" + formula.rangechangeindex + \"']\");\n                        formula.setCaretPosition($span.get(0), 0, $span.html().length);\n                    }, 1);\n                    return;\n                } else {\n                    formula.updatecell(Store.luckysheetCellUpdate[0], Store.luckysheetCellUpdate[1]);\n                    Store.luckysheet_rows_selected_status = true;\n                }\n            } else {\n                Store.luckysheet_rows_selected_status = true;\n            }\n            if (Store.luckysheet_rows_selected_status) {\n                if (event.shiftKey) {\n                    //按住shift点击行索引选取范围\n                    let last = $.extend(true, {}, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]);    //选区最后一个\n                    //选区最后一个\n                    let top = 0, height = 0, rowseleted = [];\n                    if (last.top > row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        if (last.row[1] > last.row_focus) {\n                            last.row[1] = last.row_focus;\n                        }\n                        rowseleted = [\n                            row_index,\n                            last.row[1]\n                        ];\n                    } else if (last.top == row_pre) {\n                        top = row_pre;\n                        height = last.top + last.height - row_pre;\n                        rowseleted = [\n                            row_index,\n                            last.row[0]\n                        ];\n                    } else {\n                        top = last.top;\n                        height = row - last.top - 1;\n                        if (last.row[0] < last.row_focus) {\n                            last.row[0] = last.row_focus;\n                        }\n                        rowseleted = [\n                            last.row[0],\n                            row_index\n                        ];\n                    }\n                    last['row'] = rowseleted;\n                    last['top_move'] = top;\n                    last['height_move'] = height;\n                    Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1] = last;\n                } else if (event.ctrlKey) {\n                    Store.luckysheet_select_save.push({\n                        'left': colLocationByIndex(0)[0],\n                        'width': colLocationByIndex(0)[1] - colLocationByIndex(0)[0] - 1,\n                        'top': top,\n                        'height': height,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': top,\n                        'height_move': height,\n                        'row': rowseleted,\n                        'column': [\n                            0,\n                            col_index\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': 0,\n                        'row_select': true\n                    });\n                } else {\n                    Store.luckysheet_select_save.length = 0;\n                    Store.luckysheet_select_save.push({\n                        'left': colLocationByIndex(0)[0],\n                        'width': colLocationByIndex(0)[1] - colLocationByIndex(0)[0] - 1,\n                        'top': top,\n                        'height': height,\n                        'left_move': col_pre,\n                        'width_move': col - col_pre - 1,\n                        'top_move': top,\n                        'height_move': height,\n                        'row': rowseleted,\n                        'column': [\n                            0,\n                            col_index\n                        ],\n                        'row_focus': row_index,\n                        'column_focus': 0,\n                        'row_select': true\n                    });\n                }\n                selectHightlightShow();    //允许编辑后的后台更新时\n                //允许编辑后的后台更新时\n                server.saveParam('mv', Store.currentSheetIndex, Store.luckysheet_select_save);\n            }\n            selectHelpboxFill();\n            setTimeout(function () {\n                clearTimeout(Store.countfuncTimeout);\n                countfunc();\n            }, 101);\n        }).mousemove(function (event) {\n            if (Store.luckysheet_rows_selected_status || Store.luckysheet_rows_change_size || Store.luckysheet_select_status) {\n                $('#luckysheet-rows-h-hover').hide();\n                return;\n            }\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let y = mouse[1] + $('#luckysheet-rows-h').scrollTop();\n            let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n            $('#luckysheet-rows-h-hover').css({\n                'top': row_pre,\n                'height': row - row_pre - 1,\n                'display': 'block'\n            });\n            if (y < row - 1 && y >= row - 5) {\n                $('#luckysheet-rows-change-size').css({\n                    'top': row - 3,\n                    'opacity': 0\n                });\n            } else {\n                $('#luckysheet-rows-change-size').css('opacity', 0);\n            }\n        }).mouseleave(function (event) {\n            $('#luckysheet-rows-h-hover').hide();\n            $('#luckysheet-rows-change-size').css('opacity', 0);\n        }).mouseup(function (event) {\n            if (event.which == 3) {\n                if (isEditMode()) {\n                    //非编辑模式下禁止右键功能框\n                    return;\n                }\n                $('#luckysheet-cols-rows-shift').hide();\n                Store.luckysheetRightHeadClickIs = 'row';\n                $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word').text(locale().rightclick.row);\n                $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size').text(locale().rightclick.height);\n                $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left').text(locale().rightclick.top);\n                $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right').text(locale().rightclick.bottom);\n                $('#luckysheet-cols-rows-add').show();\n                $('#luckysheet-cols-rows-data').show();\n                $('#luckysheet-cols-rows-shift').hide();\n                $('#luckysheet-cols-rows-handleincell').hide();\n                $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'block';\n                $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'block';    // 自定义右键菜单：向上向下增加行，删除行，隐藏显示行，设置行高\n                // 自定义右键菜单：向上向下增加行，删除行，隐藏显示行，设置行高\n                const cellRightClickConfig = luckysheetConfigsetting.cellRightClickConfig;    // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n                // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n                if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste && !cellRightClickConfig.insertRow && !cellRightClickConfig.deleteRow && !cellRightClickConfig.hideRow && !cellRightClickConfig.rowHeight && !cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                    return;\n                }\n                $$('#luckysheet-top-left-add-selected').style.display = cellRightClickConfig.insertRow ? 'block' : 'none';\n                $$('#luckysheet-bottom-right-add-selected').style.display = cellRightClickConfig.insertRow ? 'block' : 'none';\n                $$('#luckysheet-del-selected').style.display = cellRightClickConfig.deleteRow ? 'block' : 'none';\n                $$('#luckysheet-hide-selected').style.display = cellRightClickConfig.hideRow ? 'block' : 'none';\n                $$('#luckysheet-show-selected').style.display = cellRightClickConfig.hideRow ? 'block' : 'none';\n                $$('#luckysheet-column-row-width-selected').style.display = cellRightClickConfig.rowHeight ? 'block' : 'none';    // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste) {\n                    $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                    if (!cellRightClickConfig.insertRow && !cellRightClickConfig.deleteRow && !cellRightClickConfig.hideRow && !cellRightClickConfig.rowHeight) {\n                        $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                    }\n                }    // 2. 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                // 2. 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                if (!cellRightClickConfig.insertRow && !cellRightClickConfig.deleteRow && !cellRightClickConfig.hideRow && !cellRightClickConfig.rowHeight) {\n                    $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                }\n                if (!cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                    $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                }\n                showrightclickmenu($('#luckysheet-rightclick-menu'), $(this).offset().left + 46, event.pageY);\n                Store.luckysheet_cols_menu_status = true;    //行高默认值\n                //行高默认值\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['rowlen'] == null) {\n                    cfg['rowlen'] = {};\n                }\n                let first_rowlen = cfg['rowlen'][Store.luckysheet_select_save[0].row[0]] == null ? Store.defaultrowlen : cfg['rowlen'][Store.luckysheet_select_save[0].row[0]];\n                let isSame = true;\n                for (let i = 0; i < Store.luckysheet_select_save.length; i++) {\n                    let s = Store.luckysheet_select_save[i];\n                    let r1 = s.row[0], r2 = s.row[1];\n                    for (let r = r1; r <= r2; r++) {\n                        let rowlen = cfg['rowlen'][r] == null ? Store.defaultrowlen : cfg['rowlen'][r];\n                        if (rowlen != first_rowlen) {\n                            isSame = false;\n                            break;\n                        }\n                    }\n                }\n                if (isSame) {\n                    $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val(first_rowlen);\n                } else {\n                    $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val('');\n                }\n            }\n        });    //表格列标题 mouse事件\n        //表格列标题 mouse事件\n        $('#luckysheet-cols-h-c').mousedown(function (event) {\n            if (!checkProtectionAllSelected(Store.currentSheetIndex)) {\n                return;\n            }    //有批注在编辑时\n            //有批注在编辑时\n            luckysheetPostil.removeActivePs();    //图片 active/cropping\n            //图片 active/cropping\n            if ($('#luckysheet-modal-dialog-activeImage').is(':visible') || $('#luckysheet-modal-dialog-cropping').is(':visible')) {\n                imageCtrl.cancelActiveImgItem();\n            }\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let x = mouse[0] + $(this).scrollLeft();\n            let row_index = Store.visibledatarow.length - 1, row = Store.visibledatarow[row_index], row_pre = 0;\n            let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n            Store.orderbyindex = col_index;    //排序全局函数\n            //排序全局函数\n            $('#luckysheet-rightclick-menu').hide();\n            $('#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu').hide();\n            $('#luckysheet-filter-menu, #luckysheet-filter-submenu').hide();    //mousedown是右键\n            //mousedown是右键\n            if (event.which == '3') {\n                let isright = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let obj_s = Store.luckysheet_select_save[s];\n                    if (obj_s['column'] != null && (col_index >= obj_s['column'][0] && col_index <= obj_s['column'][1]) && (obj_s['row'][0] == 0 && obj_s['row'][1] == Store.flowdata.length - 1)) {\n                        isright = true;\n                        break;\n                    }\n                }\n                if (isright) {\n                    return;\n                }\n            }\n            let left = col_pre, width = col - col_pre - 1;\n            let columnseleted = [\n                col_index,\n                col_index\n            ];\n            Store.luckysheet_scroll_status = true;    //公式相关\n            //公式相关\n            let $input = $('#luckysheet-input-box');\n            if (parseInt($input.css('top')) > 0) {\n                if (formula.rangestart || formula.rangedrag_column_start || formula.rangedrag_row_start || formula.israngeseleciton() || $('#luckysheet-ifFormulaGenerator-multiRange-dialog').is(':visible')) {\n                    //公式选区\n                    let changeparam = menuButton.mergeMoveMain(columnseleted, [\n                        0,\n                        row_index\n                    ], {\n                        'row_focus': 0,\n                        'column_focus': col_index\n                    }, row_pre, row, left, width);\n                    if (changeparam != null) {\n                        columnseleted = changeparam[0];    //rowseleted= changeparam[1];\n                                                           //top = changeparam[2];\n                                                           //height = changeparam[3];\n                        //rowseleted= changeparam[1];\n                        //top = changeparam[2];\n                        //height = changeparam[3];\n                        left = changeparam[4];\n                        width = changeparam[5];\n                    }\n                    if (event.shiftKey) {\n                        let last = formula.func_selectedrange;\n                        let left = 0, width = 0, columnseleted = [];\n                        if (last.left > col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            if (last.column[1] > last.column_focus) {\n                                last.column[1] = last.column_focus;\n                            }\n                            columnseleted = [\n                                col_index,\n                                last.column[1]\n                            ];\n                        } else if (last.left == col_pre) {\n                            left = col_pre;\n                            width = last.left + last.width - col_pre;\n                            columnseleted = [\n                                col_index,\n                                last.column[0]\n                            ];\n                        } else {\n                            left = last.left;\n                            width = col - last.left - 1;\n                            if (last.column[0] < last.column_focus) {\n                                last.column[0] = last.column_focus;\n                            }\n                            columnseleted = [\n                                last.column[0],\n                                col_index\n                            ];\n                        }\n                        let changeparam = menuButton.mergeMoveMain(columnseleted, [\n                            0,\n                            row_index\n                        ], {\n                            'row_focus': 0,\n                            'column_focus': col_index\n                        }, row_pre, row, left, width);\n                        if (changeparam != null) {\n                            columnseleted = changeparam[0];    //rowseleted= changeparam[1];\n                                                               //top = changeparam[2];\n                                                               //height = changeparam[3];\n                            //rowseleted= changeparam[1];\n                            //top = changeparam[2];\n                            //height = changeparam[3];\n                            left = changeparam[4];\n                            width = changeparam[5];\n                        }\n                        last['column'] = columnseleted;\n                        last['left_move'] = left;\n                        last['width_move'] = width;\n                        formula.func_selectedrange = last;\n                    } else if (event.ctrlKey && $('#luckysheet-rich-text-editor').find('span').last().text() != ',') {\n                        //按住ctrl 选择选区时  先处理上一个选区\n                        let vText = $('#luckysheet-rich-text-editor').text() + ',';\n                        if (vText.length > 0 && vText.substr(0, 1) == '=') {\n                            vText = formula.functionHTMLGenerate(vText);\n                            if (window.getSelection) {\n                                // all browsers, except IE before version 9\n                                let currSelection = window.getSelection();\n                                formula.functionRangeIndex = [\n                                    $(currSelection.anchorNode).parent().index(),\n                                    currSelection.anchorOffset\n                                ];\n                            } else {\n                                // Internet Explorer before version 9\n                                let textRange = document.selection.createRange();\n                                formula.functionRangeIndex = textRange;\n                            }\n                            $('#luckysheet-rich-text-editor').html(vText);\n                            formula.canceFunctionrangeSelected();\n                            formula.createRangeHightlight();\n                        }\n                        formula.rangestart = false;\n                        formula.rangedrag_column_start = false;\n                        formula.rangedrag_row_start = false;\n                        $('#luckysheet-functionbox-cell').html(vText);\n                        formula.rangeHightlightselected($('#luckysheet-rich-text-editor'));    //再进行 选区的选择\n                        //再进行 选区的选择\n                        formula.israngeseleciton();\n                        formula.func_selectedrange = {\n                            'left': left,\n                            'width': width,\n                            'top': rowLocationByIndex(0)[0],\n                            'height': rowLocationByIndex(0)[1] - rowLocationByIndex(0)[0] - 1,\n                            'left_move': left,\n                            'width_move': width,\n                            'top_move': row_pre,\n                            'height_move': row - row_pre - 1,\n                            'row': [\n                                0,\n                                row_index\n                            ],\n                            'column': columnseleted,\n                            'row_focus': 0,\n                            'column_focus': col_index\n                        };\n                    } else {\n                        formula.func_selectedrange = {\n                            'left': left,\n                            'width': width,\n                            'top': rowLocationByIndex(0)[0],\n                            'height': rowLocationByIndex(0)[1] - rowLocationByIndex(0)[0] - 1,\n                            'left_move': left,\n                            'width_move': width,\n                            'top_move': row_pre,\n                            'height_move': row - row_pre - 1,\n                            'row': [\n                                0,\n                                row_index\n                            ],\n                            'column': columnseleted,\n                            'row_focus': 0,\n                            'column_focus': col_index\n                        };\n                    }\n                    if (formula.rangestart || formula.rangedrag_column_start || formula.rangedrag_row_start || formula.israngeseleciton()) {\n                        formula.rangeSetValue({\n                            'row': [\n                                null,\n                                null\n                            ],\n                            'column': columnseleted\n                        });\n                    } else if ($('#luckysheet-ifFormulaGenerator-multiRange-dialog').is(':visible')) {\n                        //if公式生成器\n                        let range = getRangetxt(Store.currentSheetIndex, {\n                            'row': [\n                                0,\n                                row_index\n                            ],\n                            'column': columnseleted\n                        }, Store.currentSheetIndex);\n                        $('#luckysheet-ifFormulaGenerator-multiRange-dialog input').val(range);\n                    }\n                    formula.rangedrag_column_start = true;\n                    formula.rangestart = false;\n                    formula.rangedrag_row_start = false;\n                    $('#luckysheet-formula-functionrange-select').css({\n                        'left': left,\n                        'width': width,\n                        'top': row_pre,\n                        'height': row - row_pre - 1\n                    }).show();\n                    $('#luckysheet-formula-help-c').hide();\n                    luckysheet_count_show(left, row_pre, width, row - row_pre - 1, [\n                        0,\n                        row_index\n                    ], columnseleted);\n                    return;\n                } else {\n                    formula.updatecell(Store.luckysheetCellUpdate[0], Store.luckysheetCellUpdate[1]);\n                    Store.luckysheet_cols_selected_status = true;\n                }\n            } else {\n                Store.luckysheet_cols_selected_status = true;\n            }\n            if (Store.luckysheet_cols_selected_status) {\n                if (event.shiftKey) {\n                    //按住shift点击列索引选取范围\n                    let last = $.extend(true, {}, Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1]);    //选区最后一个\n                    //选区最后一个\n                    let left = 0, width = 0, columnseleted = [];\n                    if (last.left > col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        if (last.column[1] > last.column_focus) {\n                            last.column[1] = last.column_focus;\n                        }\n                        columnseleted = [\n                            col_index,\n                            last.column[1]\n                        ];\n                    } else if (last.left == col_pre) {\n                        left = col_pre;\n                        width = last.left + last.width - col_pre;\n                        columnseleted = [\n                            col_index,\n                            last.column[0]\n                        ];\n                    } else {\n                        left = last.left;\n                        width = col - last.left - 1;\n                        if (last.column[0] < last.column_focus) {\n                            last.column[0] = last.column_focus;\n                        }\n                        columnseleted = [\n                            last.column[0],\n                            col_index\n                        ];\n                    }\n                    last['column'] = columnseleted;\n                    last['left_move'] = left;\n                    last['width_move'] = width;\n                    Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1] = last;\n                } else if (event.ctrlKey) {\n                    //选区添加\n                    Store.luckysheet_select_save.push({\n                        'left': left,\n                        'width': width,\n                        'top': rowLocationByIndex(0)[0],\n                        'height': rowLocationByIndex(0)[1] - rowLocationByIndex(0)[0] - 1,\n                        'left_move': left,\n                        'width_move': width,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            0,\n                            row_index\n                        ],\n                        'column': columnseleted,\n                        'row_focus': 0,\n                        'column_focus': col_index,\n                        'column_select': true\n                    });\n                } else {\n                    Store.luckysheet_select_save.length = 0;\n                    Store.luckysheet_select_save.push({\n                        'left': left,\n                        'width': width,\n                        'top': rowLocationByIndex(0)[0],\n                        'height': rowLocationByIndex(0)[1] - rowLocationByIndex(0)[0] - 1,\n                        'left_move': left,\n                        'width_move': width,\n                        'top_move': row_pre,\n                        'height_move': row - row_pre - 1,\n                        'row': [\n                            0,\n                            row_index\n                        ],\n                        'column': columnseleted,\n                        'row_focus': 0,\n                        'column_focus': col_index,\n                        'column_select': true\n                    });\n                }\n                selectHightlightShow();    //允许编辑后的后台更新时\n                //允许编辑后的后台更新时\n                server.saveParam('mv', Store.currentSheetIndex, Store.luckysheet_select_save);\n            }\n            selectHelpboxFill();\n            setTimeout(function () {\n                clearTimeout(Store.countfuncTimeout);\n                countfunc();\n            }, 101);\n            if (Store.luckysheet_cols_menu_status) {\n                $('#luckysheet-rightclick-menu').hide();\n                $('#luckysheet-cols-h-hover').hide();\n                $('#luckysheet-cols-menu-btn').hide();\n                Store.luckysheet_cols_menu_status = false;\n            }\n            event.stopPropagation();\n        }).mousemove(function (event) {\n            if (Store.luckysheet_cols_selected_status || Store.luckysheet_select_status) {\n                $('#luckysheet-cols-h-hover').hide();\n                $('#luckysheet-cols-menu-btn').hide();\n                return;\n            }\n            if (Store.luckysheet_cols_menu_status || Store.luckysheet_cols_change_size) {\n                return;\n            }\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let x = mouse[0] + $('#luckysheet-cols-h-c').scrollLeft();\n            let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n            $('#luckysheet-cols-h-hover').css({\n                'left': col_pre,\n                'width': col - col_pre - 1,\n                'display': 'block'\n            });\n            $('#luckysheet-cols-menu-btn').css({\n                'left': col - 19,\n                'display': 'block'\n            });\n            $('#luckysheet-cols-change-size').css({ 'left': col - 5 });\n            if (x < col && x >= col - 5) {\n                $('#luckysheet-cols-change-size').css({ 'opacity': 0 });\n                $('#luckysheet-cols-menu-btn').hide();\n            } else {\n                $('#luckysheet-change-size-line').hide();\n                $('#luckysheet-cols-change-size').css('opacity', 0);\n            }\n        }).mouseleave(function (event) {\n            if (Store.luckysheet_cols_menu_status || Store.luckysheet_cols_change_size) {\n                return;\n            }\n            $('#luckysheet-cols-h-hover').hide();\n            $('#luckysheet-cols-menu-btn').hide();\n            $('#luckysheet-cols-change-size').css('opacity', 0);\n        }).mouseup(function (event) {\n            if (event.which == 3) {\n                if (isEditMode()) {\n                    //非编辑模式下禁止右键功能框\n                    return;\n                }\n                Store.luckysheetRightHeadClickIs = 'column';\n                $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word').text(locale().rightclick.column);\n                $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size').text(locale().rightclick.width);\n                $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left').text(locale().rightclick.left);\n                $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right').text(locale().rightclick.right);\n                $('#luckysheet-cols-rows-add').show();\n                $('#luckysheet-cols-rows-data').show();\n                $('#luckysheet-cols-rows-shift').hide();\n                $('#luckysheet-cols-rows-handleincell').hide();\n                $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'block';\n                $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'block';    // 自定义右键菜单：向左向右增加列，删除列，隐藏显示列，设置列宽\n                // 自定义右键菜单：向左向右增加列，删除列，隐藏显示列，设置列宽\n                const cellRightClickConfig = luckysheetConfigsetting.cellRightClickConfig;    // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n                // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n                if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste && !cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth && !cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                    return;\n                }\n                $$('#luckysheet-top-left-add-selected').style.display = cellRightClickConfig.insertColumn ? 'block' : 'none';\n                $$('#luckysheet-bottom-right-add-selected').style.display = cellRightClickConfig.insertColumn ? 'block' : 'none';\n                $$('#luckysheet-del-selected').style.display = cellRightClickConfig.deleteColumn ? 'block' : 'none';\n                $$('#luckysheet-hide-selected').style.display = cellRightClickConfig.hideColumn ? 'block' : 'none';\n                $$('#luckysheet-show-selected').style.display = cellRightClickConfig.hideColumn ? 'block' : 'none';\n                $$('#luckysheet-column-row-width-selected').style.display = cellRightClickConfig.columnWidth ? 'block' : 'none';    // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n                if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste) {\n                    $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                    if (!cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth) {\n                        $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                    }\n                }    // 2. 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                // 2. 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n                if (!cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth) {\n                    $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                }\n                if (!cellRightClickConfig.clear && !cellRightClickConfig.matrix && !cellRightClickConfig.sort && !cellRightClickConfig.filter && !cellRightClickConfig.chart && !cellRightClickConfig.image && !cellRightClickConfig.link && !cellRightClickConfig.data && !cellRightClickConfig.cellFormat) {\n                    $$('#luckysheet-cols-rows-data .luckysheet-menuseparator').style.display = 'none';\n                }\n                showrightclickmenu($('#luckysheet-rightclick-menu'), event.pageX, $(this).offset().top + 18);\n                Store.luckysheet_cols_menu_status = true;    //列宽默认值\n                //列宽默认值\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['columnlen'] == null) {\n                    cfg['columnlen'] = {};\n                }\n                let first_collen = cfg['columnlen'][Store.luckysheet_select_save[0].column[0]] == null ? Store.defaultcollen : cfg['columnlen'][Store.luckysheet_select_save[0].column[0]];\n                let isSame = true;\n                for (let i = 0; i < Store.luckysheet_select_save.length; i++) {\n                    let s = Store.luckysheet_select_save[i];\n                    let c1 = s.column[0], c2 = s.column[1];\n                    for (let c = c1; c <= c2; c++) {\n                        let collen = cfg['columnlen'][c] == null ? Store.defaultcollen : cfg['columnlen'][c];\n                        if (collen != first_collen) {\n                            isSame = false;\n                            break;\n                        }\n                    }\n                }\n                if (isSame) {\n                    $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val(first_collen);\n                } else {\n                    $('#luckysheet-cols-rows-add').find(\"input[type='number'].rcsize\").val('');\n                }\n            }\n        });    //表格行标题 改变行高按钮\n        //表格行标题 改变行高按钮\n        $('#luckysheet-rows-change-size').mousedown(function (event) {\n            //有批注在编辑时\n            luckysheetPostil.removeActivePs();    //图片 active/cropping\n            //图片 active/cropping\n            if ($('#luckysheet-modal-dialog-activeImage').is(':visible') || $('#luckysheet-modal-dialog-cropping').is(':visible')) {\n                imageCtrl.cancelActiveImgItem();\n            }\n            $('#luckysheet-input-box').hide();\n            $('#luckysheet-rows-change-size').css({ 'opacity': 1 });\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let y = mouse[1] + $('#luckysheet-rows-h').scrollTop();\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n            let winW = $('#luckysheet-cell-main').width();\n            let row_location = rowLocation(y), row = row_location[1], row_pre = row_location[0], row_index = row_location[2];\n            Store.luckysheet_rows_change_size = true;\n            Store.luckysheet_scroll_status = true;\n            $('#luckysheet-change-size-line').css({\n                'height': '1px',\n                'border-width': '0 0px 1px 0',\n                'top': row - 3,\n                'left': 0,\n                'width': scrollLeft + winW,\n                'display': 'block',\n                'cursor': 'ns-resize'\n            });\n            $('#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas').css('cursor', 'ns-resize');\n            Store.luckysheet_rows_change_size_start = [\n                row_pre,\n                row_index\n            ];\n            $('#luckysheet-rightclick-menu').hide();\n            $('#luckysheet-rows-h-hover').hide();\n            $('#luckysheet-cols-menu-btn').hide();\n            event.stopPropagation();\n        });    //表格列标题 改变列宽按钮\n        //表格列标题 改变列宽按钮\n        $('#luckysheet-cols-change-size').mousedown(function (event) {\n            //有批注在编辑时\n            luckysheetPostil.removeActivePs();    //图片 active/cropping\n            //图片 active/cropping\n            if ($('#luckysheet-modal-dialog-activeImage').is(':visible') || $('#luckysheet-modal-dialog-cropping').is(':visible')) {\n                imageCtrl.cancelActiveImgItem();\n            }\n            $('#luckysheet-input-box').hide();\n            $('#luckysheet-cols-change-size').css({ 'opacity': 1 });\n            let mouse = mouseposition(event.pageX, event.pageY);\n            let scrollLeft = $('#luckysheet-cols-h-c').scrollLeft();\n            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let winH = $('#luckysheet-cell-main').height();\n            let x = mouse[0] + scrollLeft;\n            let row_index = Store.visibledatarow.length - 1, row = Store.visibledatarow[row_index], row_pre = 0;\n            let col_location = colLocation(x), col = col_location[1], col_pre = col_location[0], col_index = col_location[2];\n            Store.luckysheet_cols_change_size = true;\n            Store.luckysheet_scroll_status = true;\n            $('#luckysheet-change-size-line').css({\n                'height': winH + scrollTop,\n                'border-width': '0 1px 0 0',\n                'top': 0,\n                'left': col - 3,\n                'width': '1px',\n                'display': 'block',\n                'cursor': 'ew-resize'\n            });\n            $('#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas').css('cursor', 'ew-resize');\n            Store.luckysheet_cols_change_size_start = [\n                col_pre,\n                col_index\n            ];\n            $('#luckysheet-rightclick-menu').hide();\n            $('#luckysheet-cols-h-hover').hide();\n            $('#luckysheet-cols-menu-btn').hide();\n            Store.luckysheet_cols_dbclick_times = 0;\n            event.stopPropagation();\n        }).dblclick(function () {\n            luckysheetcolsdbclick();\n        });    // 列标题的下拉箭头\n        // 列标题的下拉箭头\n        $('#luckysheet-cols-menu-btn').click(function (event) {\n            let $menu = $('#luckysheet-rightclick-menu');\n            let offset = $(this).offset();\n            $('#luckysheet-cols-rows-shift').show();\n            Store.luckysheetRightHeadClickIs = 'column';\n            $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word').text(locale().rightclick.column);\n            $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left').text(locale().rightclick.left);\n            $('#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right').text(locale().rightclick.right);\n            $('#luckysheet-cols-rows-add').show();\n            $('#luckysheet-cols-rows-data').hide();\n            $('#luckysheet-cols-rows-shift').show();\n            $('#luckysheet-cols-rows-handleincell').hide();\n            $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'block';\n            $$('#luckysheet-cols-rows-shift .luckysheet-menuseparator').style.display = 'block';    // 自定义右键菜单：向左向右增加列，删除列，隐藏显示列，设置列宽\n            // 自定义右键菜单：向左向右增加列，删除列，隐藏显示列，设置列宽\n            const cellRightClickConfig = luckysheetConfigsetting.cellRightClickConfig;    // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n            // 如果全部按钮都隐藏，则整个菜单容器也要隐藏\n            if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste && !cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth && !cellRightClickConfig.sort) {\n                return;\n            }\n            $$('#luckysheet-top-left-add-selected').style.display = cellRightClickConfig.insertColumn ? 'block' : 'none';\n            $$('#luckysheet-bottom-right-add-selected').style.display = cellRightClickConfig.insertColumn ? 'block' : 'none';\n            $$('#luckysheet-del-selected').style.display = cellRightClickConfig.deleteColumn ? 'block' : 'none';\n            $$('#luckysheet-hide-selected').style.display = cellRightClickConfig.hideColumn ? 'block' : 'none';\n            $$('#luckysheet-show-selected').style.display = cellRightClickConfig.hideColumn ? 'block' : 'none';\n            $$('#luckysheet-column-row-width-selected').style.display = cellRightClickConfig.columnWidth ? 'block' : 'none';    // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n            // 1. 当一个功能菜单块上方的功能块按钮都隐藏的时候，下方的功能块的顶部分割线也需要隐藏\n            if (!cellRightClickConfig.copy && !cellRightClickConfig.copyAs && !cellRightClickConfig.paste) {\n                $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n                if (!cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth) {\n                    $$('#luckysheet-cols-rows-shift .luckysheet-menuseparator').style.display = 'none';\n                }\n            }    // 2. 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n            // 2. 当一个功能菜单块内所有的按钮都隐藏的时候，它顶部的分割线也需要隐藏掉\n            if (!cellRightClickConfig.insertColumn && !cellRightClickConfig.deleteColumn && !cellRightClickConfig.hideColumn && !cellRightClickConfig.columnWidth) {\n                $$('#luckysheet-cols-rows-add .luckysheet-menuseparator').style.display = 'none';\n            }\n            if (!cellRightClickConfig.sort) {\n                $$('#luckysheet-cols-rows-shift .luckysheet-menuseparator').style.display = 'none';\n            }\n            showrightclickmenu($menu, offset.left, offset.top + 18);\n            Store.luckysheet_cols_menu_status = true;\n        });    //向左增加列，向上增加行\n               // $(\"#luckysheet-add-lefttop, #luckysheet-add-lefttop_t\").click(function (event) {\n        //向左增加列，向上增加行\n        // $(\"#luckysheet-add-lefttop, #luckysheet-add-lefttop_t\").click(function (event) {\n        $('#luckysheet-top-left-add-selected').click(function (event) {\n            // Click input element, don't comfirm \n            if (event.target.nodeName === 'INPUT') {\n                return;\n            }\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            const _locale = locale();\n            const locale_drag = _locale.drag;\n            const locale_info = _locale.info;\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let $t = $(this), value = $t.find('input').val();\n            if (!isRealNum(value)) {\n                if (isEditMode()) {\n                    alert(locale_info.tipInputNumber);\n                } else {\n                    tooltip.info(locale_info.tipInputNumber, '');\n                }\n                return;\n            }\n            value = parseInt(value);\n            if (value < 1 || value > 100) {\n                if (isEditMode()) {\n                    alert(locale_info.tipInputNumberLimit);\n                } else {\n                    tooltip.info(locale_info.tipInputNumberLimit, '');\n                }\n                return;\n            }\n            let st_index = Store.luckysheet_select_save[0][Store.luckysheetRightHeadClickIs][0];\n            luckysheetextendtable(Store.luckysheetRightHeadClickIs, st_index, value, 'lefttop');\n        });    // When you right-click a cell, a row is inserted before the row by default\n        // When you right-click a cell, a row is inserted before the row by default\n        $('#luckysheetColsRowsHandleAdd_row').click(function (event) {\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.allowEdit === false) {\n                return;\n            }\n            let st_index = Store.luckysheet_select_save[0].row[0];\n            luckysheetextendtable('row', st_index, 1, 'lefttop');\n        });\n        $('#luckysheetColsRowsHandleAdd_column').click(function (event) {\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.allowEdit === false) {\n                return;\n            }\n            let st_index = Store.luckysheet_select_save[0].column[0];\n            luckysheetextendtable('column', st_index, 1, 'lefttop');\n        });    // Add the row up, and click the text area to trigger the confirmation instead of clicking the confirmation button to enhance the experience\n               // $(\"#luckysheet-addTopRows\").click(function (event) {\n               // $(\"#luckysheetColsRowsHandleAdd_sub .luckysheet-cols-menuitem:first-child\").click(function (event) {\n               //     // Click input element, don't comfirm \n               //     if(event.target.nodeName === 'INPUT'){\n               //         return;\n               //     }\n               //     $(\"#luckysheet-rightclick-menu\").hide();\n               //     luckysheetContainerFocus();\n               //     const _locale = locale();\n               //     const locale_drag = _locale.drag;\n               //     const locale_info = _locale.info;\n               //     if(Store.luckysheet_select_save.length > 1){\n               //         if(isEditMode()){\n               //             alert(locale_drag.noMulti);\n               //         }\n               //         else{\n               //             tooltip.info(locale_drag.noMulti, \"\");\n               //         }\n               //         return;\n               //     }\n               //     let $t = $(this), value = $t.find(\"input\").val();\n               //     if (!isRealNum(value)) {\n               //         if(isEditMode()){\n               //             alert(locale_info.tipInputNumber);\n               //         }\n               //         else{\n               //             tooltip.info(locale_info.tipInputNumber, \"\");\n               //         }\n               //         return;\n               //     }\n               //     value = parseInt(value);\n               //     if (value < 1 || value > 100) {\n               //         if(isEditMode()){\n               //             alert(locale_info.tipInputNumberLimit);\n               //         }\n               //         else{\n               //             tooltip.info(locale_info.tipInputNumberLimit, \"\"); \n               //         }\n               //         return;\n               //     }\n               //     let st_index = Store.luckysheet_select_save[0].row[0];\n               //     luckysheetextendtable('row', st_index, value, \"lefttop\");\n               //     $(\"#luckysheetColsRowsHandleAdd_sub\").hide();\n               // })\n               // // input输入时阻止冒泡，禁止父级元素的确认事件触发\n               // $(\"input.luckysheet-mousedown-cancel\").click(function(event) {\n               //     event.stopPropagation;\n               // })\n               // $(\"#luckysheet-addLeftCols\").click(function (event) {\n               // $(\"#luckysheetColsRowsHandleAdd_sub .luckysheet-cols-menuitem:nth-child(3)\").click(function (event) {\n               //     // Click input element, don't comfirm \n               //     if(event.target.nodeName === 'INPUT'){\n               //         return;\n               //     }\n               //     $(\"#luckysheet-rightclick-menu\").hide();\n               //     luckysheetContainerFocus();\n               //     const _locale = locale();\n               //     const locale_drag = _locale.drag;\n               //     const locale_info = _locale.info;\n               //     if(Store.luckysheet_select_save.length > 1){\n               //         if(isEditMode()){\n               //             alert(locale_drag.noMulti);\n               //         }\n               //         else{\n               //             tooltip.info(locale_drag.noMulti, \"\");\n               //         }\n               //         return;\n               //     }\n               //     let $t = $(this), value = $t.find(\"input\").val();\n               //     if (!isRealNum(value)) {\n               //         if(isEditMode()){\n               //             alert(locale_info.tipInputNumber);\n               //         }\n               //         else{\n               //             tooltip.info(locale_info.tipInputNumber, \"\");\n               //         }\n               //         return;\n               //     }\n               //     value = parseInt(value);\n               //     if (value < 1 || value > 100) {\n               //         if(isEditMode()){\n               //             alert(locale_info.tipInputNumberLimit);\n               //         }\n               //         else{\n               //             tooltip.info(locale_info.tipInputNumberLimit, \"\"); \n               //         }\n               //         return;\n               //     }\n               //     let st_index = Store.luckysheet_select_save[0].column[0];\n               //     luckysheetextendtable('column', st_index, value, \"lefttop\");\n               //     $(\"#luckysheetColsRowsHandleAdd_sub\").hide();\n               // })\n               //向右增加列，向下增加行\n               // $(\"#luckysheet-add-rightbottom, #luckysheet-add-rightbottom_t\").click(function (event) {\n        // Add the row up, and click the text area to trigger the confirmation instead of clicking the confirmation button to enhance the experience\n        // $(\"#luckysheet-addTopRows\").click(function (event) {\n        // $(\"#luckysheetColsRowsHandleAdd_sub .luckysheet-cols-menuitem:first-child\").click(function (event) {\n        //     // Click input element, don't comfirm \n        //     if(event.target.nodeName === 'INPUT'){\n        //         return;\n        //     }\n        //     $(\"#luckysheet-rightclick-menu\").hide();\n        //     luckysheetContainerFocus();\n        //     const _locale = locale();\n        //     const locale_drag = _locale.drag;\n        //     const locale_info = _locale.info;\n        //     if(Store.luckysheet_select_save.length > 1){\n        //         if(isEditMode()){\n        //             alert(locale_drag.noMulti);\n        //         }\n        //         else{\n        //             tooltip.info(locale_drag.noMulti, \"\");\n        //         }\n        //         return;\n        //     }\n        //     let $t = $(this), value = $t.find(\"input\").val();\n        //     if (!isRealNum(value)) {\n        //         if(isEditMode()){\n        //             alert(locale_info.tipInputNumber);\n        //         }\n        //         else{\n        //             tooltip.info(locale_info.tipInputNumber, \"\");\n        //         }\n        //         return;\n        //     }\n        //     value = parseInt(value);\n        //     if (value < 1 || value > 100) {\n        //         if(isEditMode()){\n        //             alert(locale_info.tipInputNumberLimit);\n        //         }\n        //         else{\n        //             tooltip.info(locale_info.tipInputNumberLimit, \"\"); \n        //         }\n        //         return;\n        //     }\n        //     let st_index = Store.luckysheet_select_save[0].row[0];\n        //     luckysheetextendtable('row', st_index, value, \"lefttop\");\n        //     $(\"#luckysheetColsRowsHandleAdd_sub\").hide();\n        // })\n        // // input输入时阻止冒泡，禁止父级元素的确认事件触发\n        // $(\"input.luckysheet-mousedown-cancel\").click(function(event) {\n        //     event.stopPropagation;\n        // })\n        // $(\"#luckysheet-addLeftCols\").click(function (event) {\n        // $(\"#luckysheetColsRowsHandleAdd_sub .luckysheet-cols-menuitem:nth-child(3)\").click(function (event) {\n        //     // Click input element, don't comfirm \n        //     if(event.target.nodeName === 'INPUT'){\n        //         return;\n        //     }\n        //     $(\"#luckysheet-rightclick-menu\").hide();\n        //     luckysheetContainerFocus();\n        //     const _locale = locale();\n        //     const locale_drag = _locale.drag;\n        //     const locale_info = _locale.info;\n        //     if(Store.luckysheet_select_save.length > 1){\n        //         if(isEditMode()){\n        //             alert(locale_drag.noMulti);\n        //         }\n        //         else{\n        //             tooltip.info(locale_drag.noMulti, \"\");\n        //         }\n        //         return;\n        //     }\n        //     let $t = $(this), value = $t.find(\"input\").val();\n        //     if (!isRealNum(value)) {\n        //         if(isEditMode()){\n        //             alert(locale_info.tipInputNumber);\n        //         }\n        //         else{\n        //             tooltip.info(locale_info.tipInputNumber, \"\");\n        //         }\n        //         return;\n        //     }\n        //     value = parseInt(value);\n        //     if (value < 1 || value > 100) {\n        //         if(isEditMode()){\n        //             alert(locale_info.tipInputNumberLimit);\n        //         }\n        //         else{\n        //             tooltip.info(locale_info.tipInputNumberLimit, \"\"); \n        //         }\n        //         return;\n        //     }\n        //     let st_index = Store.luckysheet_select_save[0].column[0];\n        //     luckysheetextendtable('column', st_index, value, \"lefttop\");\n        //     $(\"#luckysheetColsRowsHandleAdd_sub\").hide();\n        // })\n        //向右增加列，向下增加行\n        // $(\"#luckysheet-add-rightbottom, #luckysheet-add-rightbottom_t\").click(function (event) {\n        $('#luckysheet-bottom-right-add-selected').click(function (event) {\n            // Click input element, don't comfirm \n            if (event.target.nodeName === 'INPUT') {\n                return;\n            }\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            const _locale = locale();\n            const locale_drag = _locale.drag;\n            const locale_info = _locale.info;\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let $t = $(this), value = $t.find('input').val();\n            if (!isRealNum(value)) {\n                if (isEditMode()) {\n                    alert(locale_info.tipInputNumber);\n                } else {\n                    tooltip.info(locale_info.tipInputNumber, '');\n                }\n                return;\n            }\n            value = parseInt(value);\n            if (value < 1 || value > 100) {\n                if (isEditMode()) {\n                    alert(locale_info.tipInputNumberLimit);\n                } else {\n                    tooltip.info(locale_info.tipInputNumberLimit, '');\n                }\n                return;\n            }\n            let st_index = Store.luckysheet_select_save[0][Store.luckysheetRightHeadClickIs][1];\n            luckysheetextendtable(Store.luckysheetRightHeadClickIs, st_index, value, 'rightbottom');\n        });    // $(\"#luckysheet-addBottomRows\").click(function (event) {\n               // $(\"#luckysheetColsRowsHandleAdd_sub .luckysheet-cols-menuitem:nth-child(2)\").click(function (event) {\n               //      // Click input element, don't comfirm \n               //      if(event.target.nodeName === 'INPUT'){\n               //         return;\n               //     }\n               //     $(\"#luckysheet-rightclick-menu\").hide();\n               //     luckysheetContainerFocus();\n               //     const _locale = locale();\n               //     const locale_drag = _locale.drag;\n               //     const locale_info = _locale.info;\n               //     if(Store.luckysheet_select_save.length > 1){\n               //         if(isEditMode()){\n               //             alert(locale_drag.noMulti);\n               //         }\n               //         else{\n               //             tooltip.info(locale_drag.noMulti, \"\");\n               //         }\n               //         return;\n               //     }\n               //     let $t = $(this), value = $t.find(\"input\").val();\n               //     if (!isRealNum(value)) {\n               //         if(isEditMode()){\n               //             alert(locale_info.tipInputNumber);\n               //         }\n               //         else{\n               //             tooltip.info(locale_info.tipInputNumber, \"\"); \n               //         }\n               //         return;\n               //     }\n               //     value = parseInt(value);\n               //     if (value < 1 || value > 100) {\n               //         if(isEditMode()){\n               //             alert(locale_info.tipInputNumberLimit);\n               //         }\n               //         else{\n               //             tooltip.info(locale_info.tipInputNumberLimit, \"\");\n               //         }\n               //         return;\n               //     }\n               //     let st_index = Store.luckysheet_select_save[0].row[1];\n               //     luckysheetextendtable('row', st_index, value, \"rightbottom\");\n               //     $(\"#luckysheetColsRowsHandleAdd_sub\").hide();\n               // });\n               // $(\"#luckysheet-addRightCols\").click(function (event) {\n               // $(\"#luckysheetColsRowsHandleAdd_sub .luckysheet-cols-menuitem:nth-child(4)\").click(function (event) {\n               //     // Click input element, don't comfirm \n               //     if(event.target.nodeName === 'INPUT'){\n               //         return;\n               //     }\n               //     $(\"#luckysheet-rightclick-menu\").hide();\n               //     luckysheetContainerFocus();\n               //     const _locale = locale();\n               //     const locale_drag = _locale.drag;\n               //     const locale_info = _locale.info;\n               //     if(Store.luckysheet_select_save.length > 1){\n               //         if(isEditMode()){\n               //             alert(locale_drag.noMulti);\n               //         }\n               //         else{\n               //             tooltip.info(locale_drag.noMulti, \"\");\n               //         }\n               //         return;\n               //     }\n               //     let $t = $(this), value = $t.find(\"input\").val();\n               //     if (!isRealNum(value)) {\n               //         if(isEditMode()){\n               //             alert(locale_info.tipInputNumber);\n               //         }\n               //         else{\n               //             tooltip.info(locale_info.tipInputNumber, \"\"); \n               //         }\n               //         return;\n               //     }\n               //     value = parseInt(value);\n               //     if (value < 1 || value > 100) {\n               //         if(isEditMode()){\n               //             alert(locale_info.tipInputNumberLimit);\n               //         }\n               //         else{\n               //             tooltip.info(locale_info.tipInputNumberLimit, \"\");\n               //         }\n               //         return;\n               //     }\n               //     let st_index = Store.luckysheet_select_save[0].column[1];\n               //     luckysheetextendtable('column', st_index, value, \"rightbottom\");\n               //     $(\"#luckysheetColsRowsHandleAdd_sub\").hide();\n               // });\n               //删除选中行列\n        // $(\"#luckysheet-addBottomRows\").click(function (event) {\n        // $(\"#luckysheetColsRowsHandleAdd_sub .luckysheet-cols-menuitem:nth-child(2)\").click(function (event) {\n        //      // Click input element, don't comfirm \n        //      if(event.target.nodeName === 'INPUT'){\n        //         return;\n        //     }\n        //     $(\"#luckysheet-rightclick-menu\").hide();\n        //     luckysheetContainerFocus();\n        //     const _locale = locale();\n        //     const locale_drag = _locale.drag;\n        //     const locale_info = _locale.info;\n        //     if(Store.luckysheet_select_save.length > 1){\n        //         if(isEditMode()){\n        //             alert(locale_drag.noMulti);\n        //         }\n        //         else{\n        //             tooltip.info(locale_drag.noMulti, \"\");\n        //         }\n        //         return;\n        //     }\n        //     let $t = $(this), value = $t.find(\"input\").val();\n        //     if (!isRealNum(value)) {\n        //         if(isEditMode()){\n        //             alert(locale_info.tipInputNumber);\n        //         }\n        //         else{\n        //             tooltip.info(locale_info.tipInputNumber, \"\"); \n        //         }\n        //         return;\n        //     }\n        //     value = parseInt(value);\n        //     if (value < 1 || value > 100) {\n        //         if(isEditMode()){\n        //             alert(locale_info.tipInputNumberLimit);\n        //         }\n        //         else{\n        //             tooltip.info(locale_info.tipInputNumberLimit, \"\");\n        //         }\n        //         return;\n        //     }\n        //     let st_index = Store.luckysheet_select_save[0].row[1];\n        //     luckysheetextendtable('row', st_index, value, \"rightbottom\");\n        //     $(\"#luckysheetColsRowsHandleAdd_sub\").hide();\n        // });\n        // $(\"#luckysheet-addRightCols\").click(function (event) {\n        // $(\"#luckysheetColsRowsHandleAdd_sub .luckysheet-cols-menuitem:nth-child(4)\").click(function (event) {\n        //     // Click input element, don't comfirm \n        //     if(event.target.nodeName === 'INPUT'){\n        //         return;\n        //     }\n        //     $(\"#luckysheet-rightclick-menu\").hide();\n        //     luckysheetContainerFocus();\n        //     const _locale = locale();\n        //     const locale_drag = _locale.drag;\n        //     const locale_info = _locale.info;\n        //     if(Store.luckysheet_select_save.length > 1){\n        //         if(isEditMode()){\n        //             alert(locale_drag.noMulti);\n        //         }\n        //         else{\n        //             tooltip.info(locale_drag.noMulti, \"\");\n        //         }\n        //         return;\n        //     }\n        //     let $t = $(this), value = $t.find(\"input\").val();\n        //     if (!isRealNum(value)) {\n        //         if(isEditMode()){\n        //             alert(locale_info.tipInputNumber);\n        //         }\n        //         else{\n        //             tooltip.info(locale_info.tipInputNumber, \"\"); \n        //         }\n        //         return;\n        //     }\n        //     value = parseInt(value);\n        //     if (value < 1 || value > 100) {\n        //         if(isEditMode()){\n        //             alert(locale_info.tipInputNumberLimit);\n        //         }\n        //         else{\n        //             tooltip.info(locale_info.tipInputNumberLimit, \"\");\n        //         }\n        //         return;\n        //     }\n        //     let st_index = Store.luckysheet_select_save[0].column[1];\n        //     luckysheetextendtable('column', st_index, value, \"rightbottom\");\n        //     $(\"#luckysheetColsRowsHandleAdd_sub\").hide();\n        // });\n        //删除选中行列\n        $('#luckysheet-del-selected, #luckysheet-del-selected_t').click(function (event) {\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            const locale_drag = locale().drag;\n            if (Store.luckysheet_select_save.length > 1) {\n                if (Store.luckysheetRightHeadClickIs == 'row') {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                } else if (Store.luckysheetRightHeadClickIs == 'column') {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                }\n                return;\n            }\n            let st_index = Store.luckysheet_select_save[0][Store.luckysheetRightHeadClickIs][0], ed_index = Store.luckysheet_select_save[0][Store.luckysheetRightHeadClickIs][1];\n            luckysheetdeletetable(Store.luckysheetRightHeadClickIs, st_index, ed_index);\n        });\n        $('#luckysheet-delRows').click(function (event) {\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            const locale_drag = locale().drag;\n            if (Store.luckysheet_select_save.length > 1) {\n                if (Store.luckysheetRightHeadClickIs == 'row') {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                } else if (Store.luckysheetRightHeadClickIs == 'column') {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                }\n                return;\n            }\n            let st_index = Store.luckysheet_select_save[0].row[0], ed_index = Store.luckysheet_select_save[0].row[1];\n            luckysheetdeletetable('row', st_index, ed_index);\n        });\n        $('#luckysheet-delCols').click(function (event) {\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            const locale_drag = locale().drag;\n            if (Store.luckysheet_select_save.length > 1) {\n                if (Store.luckysheetRightHeadClickIs == 'row') {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                } else if (Store.luckysheetRightHeadClickIs == 'column') {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                }\n                return;\n            }\n            let st_index = Store.luckysheet_select_save[0].column[0], ed_index = Store.luckysheet_select_save[0].column[1];\n            luckysheetdeletetable('column', st_index, ed_index);\n        });    //隐藏选中行列\n        //隐藏选中行列\n        $('#luckysheet-hide-selected').click(function (event) {\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            const locale_drag = locale().drag;\n            if (Store.luckysheet_select_save.length > 1) {\n                if (Store.luckysheetRightHeadClickIs == 'row') {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                } else if (Store.luckysheetRightHeadClickIs == 'column') {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                }\n                return;\n            }    // 隐藏行\n            // 隐藏行\n            if (Store.luckysheetRightHeadClickIs == 'row') {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'formatRows')) {\n                    return;\n                }\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['rowhidden'] == null) {\n                    cfg['rowhidden'] = {};\n                }\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    for (let r = r1; r <= r2; r++) {\n                        cfg['rowhidden'][r] = 0;\n                    }\n                }    //保存撤销\n                //保存撤销\n                if (Store.clearjfundo) {\n                    let redo = {};\n                    redo['type'] = 'showHidRows';\n                    redo['sheetIndex'] = Store.currentSheetIndex;\n                    redo['config'] = $.extend(true, {}, Store.config);\n                    redo['curconfig'] = cfg;\n                    Store.jfundo.length = 0;\n                    Store.jfredo.push(redo);\n                }    //config\n                //config\n                Store.config = cfg;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                server.saveParam('cg', Store.currentSheetIndex, cfg['rowhidden'], { 'k': 'rowhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            }    // 隐藏列\n            else // 隐藏列\n            if (Store.luckysheetRightHeadClickIs == 'column') {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'formatColumns')) {\n                    return;\n                }\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['colhidden'] == null) {\n                    cfg['colhidden'] = {};\n                }\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    for (let c = c1; c <= c2; c++) {\n                        cfg['colhidden'][c] = 0;\n                    }\n                }    //保存撤销\n                //保存撤销\n                if (Store.clearjfundo) {\n                    let redo = {};\n                    redo['type'] = 'showHidCols';\n                    redo['sheetIndex'] = Store.currentSheetIndex;\n                    redo['config'] = $.extend(true, {}, Store.config);\n                    redo['curconfig'] = cfg;\n                    Store.jfundo.length = 0;\n                    Store.jfredo.push(redo);\n                }    //config\n                //config\n                Store.config = cfg;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                server.saveParam('cg', Store.currentSheetIndex, cfg['colhidden'], { 'k': 'colhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            }\n        });    //取消隐藏选中行列\n        //取消隐藏选中行列\n        $('#luckysheet-show-selected').click(function (event) {\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            const locale_drag = locale().drag;\n            if (Store.luckysheet_select_save.length > 1) {\n                if (Store.luckysheetRightHeadClickIs == 'row') {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                } else if (Store.luckysheetRightHeadClickIs == 'column') {\n                    if (isEditMode()) {\n                        alert(locale_drag.noMulti);\n                    } else {\n                        tooltip.info(locale_drag.noMulti, '');\n                    }\n                }\n                return;\n            }    // 取消隐藏行\n            // 取消隐藏行\n            if (Store.luckysheetRightHeadClickIs == 'row') {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'formatRows')) {\n                    return;\n                }\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['rowhidden'] == null) {\n                    return;\n                }\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    for (let r = r1; r <= r2; r++) {\n                        delete cfg['rowhidden'][r];\n                    }\n                }    //保存撤销\n                //保存撤销\n                if (Store.clearjfundo) {\n                    let redo = {};\n                    redo['type'] = 'showHidRows';\n                    redo['sheetIndex'] = Store.currentSheetIndex;\n                    redo['config'] = $.extend(true, {}, Store.config);\n                    redo['curconfig'] = cfg;\n                    Store.jfundo.length = 0;\n                    Store.jfredo.push(redo);\n                }    //config\n                //config\n                Store.config = cfg;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                server.saveParam('cg', Store.currentSheetIndex, cfg['rowhidden'], { 'k': 'rowhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            } else if (Store.luckysheetRightHeadClickIs == 'column') {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'formatColumns')) {\n                    return;\n                }\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['colhidden'] == null) {\n                    return;\n                }\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    for (let c = c1; c <= c2; c++) {\n                        delete cfg['colhidden'][c];\n                    }\n                }    //保存撤销\n                //保存撤销\n                if (Store.clearjfundo) {\n                    let redo = {};\n                    redo['type'] = 'showHidCols';\n                    redo['sheetIndex'] = Store.currentSheetIndex;\n                    redo['config'] = $.extend(true, {}, Store.config);\n                    redo['curconfig'] = cfg;\n                    Store.jfundo.length = 0;\n                    Store.jfredo.push(redo);\n                }    //config\n                //config\n                Store.config = cfg;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                server.saveParam('cg', Store.currentSheetIndex, cfg['colhidden'], { 'k': 'colhidden' });    //行高、列宽 刷新  \n                //行高、列宽 刷新  \n                jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n            }\n        });    //隐藏、显示行\n               // $(\"#luckysheet-hidRows\").click(function (event) {\n               //     if(!checkProtectionAuthorityNormal(Store.currentSheetIndex, \"formatRows\")){\n               //         return;\n               //     }\n               //     $(\"#luckysheet-rightclick-menu\").hide();\n               //     luckysheetContainerFocus();\n               //     let cfg = $.extend(true, {}, Store.config);\n               //     if(cfg[\"rowhidden\"] == null){\n               //         cfg[\"rowhidden\"] = {};\n               //     }\n               //     for(let s = 0; s < Store.luckysheet_select_save.length; s++){\n               //         let r1 = Store.luckysheet_select_save[s].row[0],\n               //             r2 = Store.luckysheet_select_save[s].row[1];\n               //         for(let r = r1; r <= r2; r++){\n               //             cfg[\"rowhidden\"][r] = 0;\n               //         }\n               //     }\n               //     //保存撤销\n               //     if(Store.clearjfundo){\n               //         let redo = {};\n               //         redo[\"type\"] = \"showHidRows\";\n               //         redo[\"sheetIndex\"] = Store.currentSheetIndex;\n               //         redo[\"config\"] = $.extend(true, {}, Store.config);\n               //         redo[\"curconfig\"] = cfg;\n               //         Store.jfundo.length  = 0;\n               //         Store.jfredo.push(redo);\n               //     }\n               //     //config\n               //     Store.config = cfg;\n               //     Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n               //     server.saveParam(\"cg\", Store.currentSheetIndex, cfg[\"rowhidden\"], { \"k\": \"rowhidden\" });\n               //     //行高、列宽 刷新  \n               //     jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n               // })\n               // $(\"#luckysheet-showHidRows\").click(function (event) {\n               //     if(!checkProtectionAuthorityNormal(Store.currentSheetIndex, \"formatRows\")){\n               //         return;\n               //     }\n               //     $(\"#luckysheet-rightclick-menu\").hide();\n               //     luckysheetContainerFocus();\n               //     let cfg = $.extend(true, {}, Store.config);\n               //     if(cfg[\"rowhidden\"] == null){\n               //         return;\n               //     }\n               //     for(let s = 0; s < Store.luckysheet_select_save.length; s++){\n               //         let r1 = Store.luckysheet_select_save[s].row[0],\n               //             r2 = Store.luckysheet_select_save[s].row[1];\n               //         for(let r = r1; r <= r2; r++){\n               //             delete cfg[\"rowhidden\"][r];\n               //         }\n               //     }\n               //     //保存撤销\n               //     if(Store.clearjfundo){\n               //         let redo = {};\n               //         redo[\"type\"] = \"showHidRows\";\n               //         redo[\"sheetIndex\"] = Store.currentSheetIndex;\n               //         redo[\"config\"] = $.extend(true, {}, Store.config);\n               //         redo[\"curconfig\"] = cfg;\n               //         Store.jfundo.length  = 0;\n               //         Store.jfredo.push(redo);\n               //     }\n               //     //config\n               //     Store.config = cfg;\n               //     Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n               //     server.saveParam(\"cg\", Store.currentSheetIndex, cfg[\"rowhidden\"], { \"k\": \"rowhidden\" });\n               //     //行高、列宽 刷新  \n               //     jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n               // })\n               //隐藏、显示列\n               // $(\"#luckysheet-hidCols\").click(function (event) {\n               //     if(!checkProtectionAuthorityNormal(Store.currentSheetIndex, \"formatColumns\")){\n               //         return;\n               //     }\n               //     $(\"#luckysheet-rightclick-menu\").hide();\n               //     luckysheetContainerFocus();\n               //     let cfg = $.extend(true, {}, Store.config);\n               //     if(cfg[\"colhidden\"] == null){\n               //         cfg[\"colhidden\"] = {};\n               //     }\n               //     for(let s = 0; s < Store.luckysheet_select_save.length; s++){\n               //         let c1 = Store.luckysheet_select_save[s].column[0],\n               //             c2 = Store.luckysheet_select_save[s].column[1];\n               //         for(let c = c1; c <= c2; c++){\n               //             cfg[\"colhidden\"][c] = 0;\n               //         }\n               //     }\n               //     //保存撤销\n               //     if(Store.clearjfundo){\n               //         let redo = {};\n               //         redo[\"type\"] = \"showHidCols\";\n               //         redo[\"sheetIndex\"] = Store.currentSheetIndex;\n               //         redo[\"config\"] = $.extend(true, {}, Store.config);\n               //         redo[\"curconfig\"] = cfg;\n               //         Store.jfundo.length  = 0;\n               //         Store.jfredo.push(redo);\n               //     }\n               //     //config\n               //     Store.config = cfg;\n               //     Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n               //     server.saveParam(\"cg\", Store.currentSheetIndex, cfg[\"colhidden\"], { \"k\": \"colhidden\" });\n               //     //行高、列宽 刷新  \n               //     jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n               // })\n               // $(\"#luckysheet-showHidCols\").click(function (event) {\n               //     if(!checkProtectionAuthorityNormal(Store.currentSheetIndex, \"formatColumns\")){\n               //         return;\n               //     }\n               //     $(\"#luckysheet-rightclick-menu\").hide();\n               //     luckysheetContainerFocus();\n               //     let cfg = $.extend(true, {}, Store.config);\n               //     if(cfg[\"colhidden\"] == null){\n               //         return;\n               //     }\n               //     for(let s = 0; s < Store.luckysheet_select_save.length; s++){\n               //         let c1 = Store.luckysheet_select_save[s].column[0],\n               //             c2 = Store.luckysheet_select_save[s].column[1];\n               //         for(let c = c1; c <= c2; c++){\n               //             delete cfg[\"colhidden\"][c];\n               //         }\n               //     }\n               //     //保存撤销\n               //     if(Store.clearjfundo){\n               //         let redo = {};\n               //         redo[\"type\"] = \"showHidCols\";\n               //         redo[\"sheetIndex\"] = Store.currentSheetIndex;\n               //         redo[\"config\"] = $.extend(true, {}, Store.config);\n               //         redo[\"curconfig\"] = cfg;\n               //         Store.jfundo.length  = 0;\n               //         Store.jfredo.push(redo);\n               //     }\n               //     //config\n               //     Store.config = cfg;\n               //     Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n               //     server.saveParam(\"cg\", Store.currentSheetIndex, cfg[\"colhidden\"], { \"k\": \"colhidden\" });\n               //     //行高、列宽 刷新  \n               //     jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n               // })\n               //删除单元格（左移、上移）\n        //隐藏、显示行\n        // $(\"#luckysheet-hidRows\").click(function (event) {\n        //     if(!checkProtectionAuthorityNormal(Store.currentSheetIndex, \"formatRows\")){\n        //         return;\n        //     }\n        //     $(\"#luckysheet-rightclick-menu\").hide();\n        //     luckysheetContainerFocus();\n        //     let cfg = $.extend(true, {}, Store.config);\n        //     if(cfg[\"rowhidden\"] == null){\n        //         cfg[\"rowhidden\"] = {};\n        //     }\n        //     for(let s = 0; s < Store.luckysheet_select_save.length; s++){\n        //         let r1 = Store.luckysheet_select_save[s].row[0],\n        //             r2 = Store.luckysheet_select_save[s].row[1];\n        //         for(let r = r1; r <= r2; r++){\n        //             cfg[\"rowhidden\"][r] = 0;\n        //         }\n        //     }\n        //     //保存撤销\n        //     if(Store.clearjfundo){\n        //         let redo = {};\n        //         redo[\"type\"] = \"showHidRows\";\n        //         redo[\"sheetIndex\"] = Store.currentSheetIndex;\n        //         redo[\"config\"] = $.extend(true, {}, Store.config);\n        //         redo[\"curconfig\"] = cfg;\n        //         Store.jfundo.length  = 0;\n        //         Store.jfredo.push(redo);\n        //     }\n        //     //config\n        //     Store.config = cfg;\n        //     Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n        //     server.saveParam(\"cg\", Store.currentSheetIndex, cfg[\"rowhidden\"], { \"k\": \"rowhidden\" });\n        //     //行高、列宽 刷新  \n        //     jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n        // })\n        // $(\"#luckysheet-showHidRows\").click(function (event) {\n        //     if(!checkProtectionAuthorityNormal(Store.currentSheetIndex, \"formatRows\")){\n        //         return;\n        //     }\n        //     $(\"#luckysheet-rightclick-menu\").hide();\n        //     luckysheetContainerFocus();\n        //     let cfg = $.extend(true, {}, Store.config);\n        //     if(cfg[\"rowhidden\"] == null){\n        //         return;\n        //     }\n        //     for(let s = 0; s < Store.luckysheet_select_save.length; s++){\n        //         let r1 = Store.luckysheet_select_save[s].row[0],\n        //             r2 = Store.luckysheet_select_save[s].row[1];\n        //         for(let r = r1; r <= r2; r++){\n        //             delete cfg[\"rowhidden\"][r];\n        //         }\n        //     }\n        //     //保存撤销\n        //     if(Store.clearjfundo){\n        //         let redo = {};\n        //         redo[\"type\"] = \"showHidRows\";\n        //         redo[\"sheetIndex\"] = Store.currentSheetIndex;\n        //         redo[\"config\"] = $.extend(true, {}, Store.config);\n        //         redo[\"curconfig\"] = cfg;\n        //         Store.jfundo.length  = 0;\n        //         Store.jfredo.push(redo);\n        //     }\n        //     //config\n        //     Store.config = cfg;\n        //     Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n        //     server.saveParam(\"cg\", Store.currentSheetIndex, cfg[\"rowhidden\"], { \"k\": \"rowhidden\" });\n        //     //行高、列宽 刷新  \n        //     jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n        // })\n        //隐藏、显示列\n        // $(\"#luckysheet-hidCols\").click(function (event) {\n        //     if(!checkProtectionAuthorityNormal(Store.currentSheetIndex, \"formatColumns\")){\n        //         return;\n        //     }\n        //     $(\"#luckysheet-rightclick-menu\").hide();\n        //     luckysheetContainerFocus();\n        //     let cfg = $.extend(true, {}, Store.config);\n        //     if(cfg[\"colhidden\"] == null){\n        //         cfg[\"colhidden\"] = {};\n        //     }\n        //     for(let s = 0; s < Store.luckysheet_select_save.length; s++){\n        //         let c1 = Store.luckysheet_select_save[s].column[0],\n        //             c2 = Store.luckysheet_select_save[s].column[1];\n        //         for(let c = c1; c <= c2; c++){\n        //             cfg[\"colhidden\"][c] = 0;\n        //         }\n        //     }\n        //     //保存撤销\n        //     if(Store.clearjfundo){\n        //         let redo = {};\n        //         redo[\"type\"] = \"showHidCols\";\n        //         redo[\"sheetIndex\"] = Store.currentSheetIndex;\n        //         redo[\"config\"] = $.extend(true, {}, Store.config);\n        //         redo[\"curconfig\"] = cfg;\n        //         Store.jfundo.length  = 0;\n        //         Store.jfredo.push(redo);\n        //     }\n        //     //config\n        //     Store.config = cfg;\n        //     Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n        //     server.saveParam(\"cg\", Store.currentSheetIndex, cfg[\"colhidden\"], { \"k\": \"colhidden\" });\n        //     //行高、列宽 刷新  \n        //     jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n        // })\n        // $(\"#luckysheet-showHidCols\").click(function (event) {\n        //     if(!checkProtectionAuthorityNormal(Store.currentSheetIndex, \"formatColumns\")){\n        //         return;\n        //     }\n        //     $(\"#luckysheet-rightclick-menu\").hide();\n        //     luckysheetContainerFocus();\n        //     let cfg = $.extend(true, {}, Store.config);\n        //     if(cfg[\"colhidden\"] == null){\n        //         return;\n        //     }\n        //     for(let s = 0; s < Store.luckysheet_select_save.length; s++){\n        //         let c1 = Store.luckysheet_select_save[s].column[0],\n        //             c2 = Store.luckysheet_select_save[s].column[1];\n        //         for(let c = c1; c <= c2; c++){\n        //             delete cfg[\"colhidden\"][c];\n        //         }\n        //     }\n        //     //保存撤销\n        //     if(Store.clearjfundo){\n        //         let redo = {};\n        //         redo[\"type\"] = \"showHidCols\";\n        //         redo[\"sheetIndex\"] = Store.currentSheetIndex;\n        //         redo[\"config\"] = $.extend(true, {}, Store.config);\n        //         redo[\"curconfig\"] = cfg;\n        //         Store.jfundo.length  = 0;\n        //         Store.jfredo.push(redo);\n        //     }\n        //     //config\n        //     Store.config = cfg;\n        //     Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n        //     server.saveParam(\"cg\", Store.currentSheetIndex, cfg[\"colhidden\"], { \"k\": \"colhidden\" });\n        //     //行高、列宽 刷新  \n        //     jfrefreshgrid_rhcw(Store.flowdata.length, Store.flowdata[0].length);\n        // })\n        //删除单元格（左移、上移）\n        $('#luckysheet-delCellsMoveLeft').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            const locale_drag = locale().drag;\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let str = Store.luckysheet_select_save[0].row[0], edr = Store.luckysheet_select_save[0].row[1], stc = Store.luckysheet_select_save[0].column[0], edc = Store.luckysheet_select_save[0].column[1];\n            luckysheetDeleteCell('moveLeft', str, edr, stc, edc);\n        });\n        $('#luckysheet-delCellsMoveUp').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            const locale_drag = locale().drag;\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let str = Store.luckysheet_select_save[0].row[0], edr = Store.luckysheet_select_save[0].row[1], stc = Store.luckysheet_select_save[0].column[0], edc = Store.luckysheet_select_save[0].column[1];\n            luckysheetDeleteCell('moveUp', str, edr, stc, edc);\n        });    //清除单元格内容\n        //清除单元格内容\n        $('#luckysheet-delete-text').click(function () {\n            if (!checkProtectionLockedRangeList(Store.luckysheet_select_save, Store.currentSheetIndex)) {\n                return;\n            }\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.allowEdit === false) {\n                return;\n            }\n            if (Store.luckysheet_select_save.length > 0) {\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    if (hasPartMC(Store.config, r1, r2, c1, c2)) {\n                        has_PartMC = true;\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    const locale_drag = locale().drag;\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    for (let r = r1; r <= r2; r++) {\n                        for (let c = c1; c <= c2; c++) {\n                            if (pivotTable.isPivotRange(r, c)) {\n                                continue;\n                            }\n                            if (getObjType(d[r][c]) == 'object') {\n                                delete d[r][c]['m'];\n                                delete d[r][c]['v'];\n                                if (d[r][c]['f'] != null) {\n                                    delete d[r][c]['f'];\n                                    formula.delFunctionGroup(r, c, Store.currentSheetIndex);\n                                    delete d[r][c]['spl'];\n                                }\n                                if (d[r][c]['ct'] != null && d[r][c]['ct'].t == 'inlineStr') {\n                                    delete d[r][c]['ct'];\n                                }\n                            } else {\n                                d[r][c] = null;\n                            }\n                        }\n                    }\n                }\n                jfrefreshgrid(d, Store.luckysheet_select_save);\n            }\n        });    //行高列宽设置\n               // $(\"#luckysheet-rows-cols-changesize\").click(function(){\n        //行高列宽设置\n        // $(\"#luckysheet-rows-cols-changesize\").click(function(){\n        $('#luckysheet-column-row-width-selected').click(function (event) {\n            // Click input element, don't comfirm \n            if (event.target.nodeName === 'INPUT') {\n                return;\n            }\n            $('#luckysheet-rightclick-menu').hide();\n            luckysheetContainerFocus();    // let size = parseInt($(this).siblings(\"input[type='number']\").val().trim());\n            // let size = parseInt($(this).siblings(\"input[type='number']\").val().trim());\n            let size = parseInt($(this).closest('.luckysheet-cols-menuitem').find(\"input[type='number']\").val().trim());\n            const locale_info = locale().info;\n            let cfg = $.extend(true, {}, Store.config);\n            let type;\n            let images = null;\n            if (Store.luckysheetRightHeadClickIs == 'row') {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'formatRows')) {\n                    return;\n                }\n                if (size < 0 || size > 545) {\n                    if (isEditMode()) {\n                        alert(locale_info.tipRowHeightLimit);\n                    } else {\n                        tooltip.info(locale_info.tipRowHeightLimit, '');\n                    }\n                    return;\n                }\n                type = 'resizeR';\n                if (cfg['rowlen'] == null) {\n                    cfg['rowlen'] = {};\n                }\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0];\n                    let r2 = Store.luckysheet_select_save[s].row[1];\n                    for (let r = r1; r <= r2; r++) {\n                        cfg['rowlen'][r] = size;\n                        images = imageCtrl.moveChangeSize('row', r, size);\n                    }\n                }\n            } else if (Store.luckysheetRightHeadClickIs == 'column') {\n                if (!checkProtectionAuthorityNormal(Store.currentSheetIndex, 'formatColumns')) {\n                    return;\n                }\n                if (size < 0 || size > 2038) {\n                    if (isEditMode()) {\n                        alert(locale_info.tipColumnWidthLimit);\n                    } else {\n                        tooltip.info(locale_info.tipColumnWidthLimit, '');\n                    }\n                    return;\n                }\n                type = 'resizeC';\n                if (cfg['columnlen'] == null) {\n                    cfg['columnlen'] = {};\n                }\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let c1 = Store.luckysheet_select_save[s].column[0];\n                    let c2 = Store.luckysheet_select_save[s].column[1];\n                    for (let c = c1; c <= c2; c++) {\n                        cfg['columnlen'][c] = size;\n                        images = imageCtrl.moveChangeSize('column', c, size);\n                    }\n                }\n            }\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                Store.jfredo.push({\n                    'type': 'resize',\n                    'ctrlType': type,\n                    'sheetIndex': Store.currentSheetIndex,\n                    'config': $.extend(true, {}, Store.config),\n                    'curconfig': $.extend(true, {}, cfg),\n                    'images': $.extend(true, {}, imageCtrl.images),\n                    'curImages': $.extend(true, {}, images)\n                });\n            }    //config\n            //config\n            Store.config = cfg;\n            Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;    //images\n            //images\n            Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].images = images;\n            server.saveParam('all', Store.currentSheetIndex, images, { 'k': 'images' });\n            imageCtrl.images = images;\n            imageCtrl.allImagesShow();\n            if (Store.luckysheetRightHeadClickIs == 'row') {\n                server.saveParam('cg', Store.currentSheetIndex, cfg['rowlen'], { 'k': 'rowlen' });\n                jfrefreshgrid_rhcw(Store.flowdata.length, null);\n            } else if (Store.luckysheetRightHeadClickIs == 'column') {\n                server.saveParam('cg', Store.currentSheetIndex, cfg['columnlen'], { 'k': 'columnlen' });\n                jfrefreshgrid_rhcw(null, Store.flowdata[0].length);\n            }\n        });\n    }\n    function luckysheetcolsdbclick() {\n        Store.luckysheet_cols_change_size = false;\n        $('#luckysheet-change-size-line').hide();\n        $('#luckysheet-cols-change-size').css('opacity', 0);\n        $('#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas').css('cursor', 'default');\n        let mouse = mouseposition(event.pageX, event.pageY);\n        let scrollLeft = $('#luckysheet-cols-h-c').scrollLeft();\n        let x = mouse[0] + scrollLeft;\n        let colIndex = colLocation(x)[2];\n        let d = editor.deepCopyFlowData(Store.flowdata);\n        let canvas = $('#luckysheetTableContent').get(0).getContext('2d');\n        let cfg = $.extend(true, {}, Store.config);\n        if (cfg['columnlen'] == null) {\n            cfg['columnlen'] = {};\n        }\n        let matchColumn = {};\n        let scrollTop = $('#luckysheet-cell-main').scrollTop(), drawHeight = Store.luckysheetTableContentHW[1];\n        let dataset_row_st = luckysheet_searcharray(Store.visibledatarow, scrollTop);\n        let dataset_row_ed = luckysheet_searcharray(Store.visibledatarow, scrollTop + drawHeight);\n        dataset_row_ed += dataset_row_ed - dataset_row_st;\n        if (dataset_row_ed >= d.length) {\n            dataset_row_ed = d.length - 1;\n        }\n        for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n            let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n            if (colIndex < c1 || colIndex > c2) {\n                if (colIndex in matchColumn) {\n                    //此列已计算过\n                    continue;\n                }\n                let currentColLen = Store.defaultcollen;\n                for (let r = dataset_row_st; r <= dataset_row_ed; r++) {\n                    let cell = d[r][colIndex];\n                    if (cell == null || isRealNull(cell.v) && !isInlineStringCell(cell)) {\n                        continue;\n                    }    // let fontset = luckysheetfontformat(cell);\n                         // canvas.font = fontset;\n                         // let value = getcellvalue(r, colIndex, d, \"m\").toString(); //单元格文本\n                         // let textMetrics = getMeasureText(value, canvas).width; //文本宽度\n                    // let fontset = luckysheetfontformat(cell);\n                    // canvas.font = fontset;\n                    // let value = getcellvalue(r, colIndex, d, \"m\").toString(); //单元格文本\n                    // let textMetrics = getMeasureText(value, canvas).width; //文本宽度\n                    let cellWidth = colLocationByIndex(colIndex)[1] - colLocationByIndex(colIndex)[0] - 2;\n                    let textInfo = getCellTextInfo(cell, canvas, {\n                        r: r,\n                        c: colIndex,\n                        cellWidth: cellWidth\n                    });\n                    let computeRowlen = 0;    // console.log(\"rowlen\", textInfo);\n                    // console.log(\"rowlen\", textInfo);\n                    if (textInfo != null) {\n                        computeRowlen = textInfo.textWidthAll;\n                    }\n                    if (computeRowlen + 6 > currentColLen) {\n                        currentColLen = computeRowlen + 6;\n                    }\n                }\n                if (currentColLen != Store.defaultcollen) {\n                    cfg['columnlen'][colIndex] = currentColLen;\n                    if (cfg['customWidth']) {\n                        delete cfg['customWidth'][colIndex];\n                    }\n                }\n                matchColumn[colIndex] = 1;\n            } else {\n                for (let c = c1; c <= c2; c++) {\n                    if (c in matchColumn) {\n                        //此列已计算过\n                        continue;\n                    }\n                    let currentColLen = Store.defaultcollen;\n                    for (let r = dataset_row_st; r <= dataset_row_ed; r++) {\n                        let cell = d[r][c];\n                        if (cell == null || isRealNull(cell.v) && !isInlineStringCell(cell)) {\n                            continue;\n                        }    // let fontset = luckysheetfontformat(cell);\n                             // canvas.font = fontset;\n                             // let value = getcellvalue(r, c, d, \"m\").toString(); //单元格文本\n                             // let textMetrics = getMeasureText(value, canvas).width; //文本宽度\n                             // if(textMetrics + 6 > currentColLen){\n                             //     currentColLen = textMetrics + 6;\n                             // }\n                        // let fontset = luckysheetfontformat(cell);\n                        // canvas.font = fontset;\n                        // let value = getcellvalue(r, c, d, \"m\").toString(); //单元格文本\n                        // let textMetrics = getMeasureText(value, canvas).width; //文本宽度\n                        // if(textMetrics + 6 > currentColLen){\n                        //     currentColLen = textMetrics + 6;\n                        // }\n                        let cellWidth = colLocationByIndex(c)[1] - colLocationByIndex(c)[0] - 2;\n                        let textInfo = getCellTextInfo(cell, canvas, {\n                            r: r,\n                            c: c,\n                            cellWidth: cellWidth\n                        });\n                        let computeRowlen = 0;    // console.log(\"rowlen\", textInfo);\n                        // console.log(\"rowlen\", textInfo);\n                        if (textInfo != null) {\n                            computeRowlen = textInfo.textWidthAll;\n                        }\n                        if (computeRowlen + 6 > currentColLen) {\n                            currentColLen = computeRowlen + 6;\n                        }\n                    }\n                    if (currentColLen != Store.defaultcollen) {\n                        cfg['columnlen'][c] = currentColLen;\n                        if (cfg['customWidth']) {\n                            delete cfg['customWidth'][c];\n                        }\n                    }\n                    matchColumn[c] = 1;\n                }\n            }\n        }\n        jfrefreshgridall(Store.flowdata[0].length, Store.flowdata.length, Store.flowdata, cfg, Store.luckysheet_select_save, 'resizeC', 'columnlen');\n    }    /**\n * \n * @param {String} type:delete type, \n * @param {*} st_index \n * @param {*} ed_index \n */\n         // Delete row api\n    function deleteRows(type, st_index, ed_index) {\n        Store.luckysheetRightHeadClickIs = 'column';\n    }\n    function deleteColumns() {\n    }\n    return {\n        rowColumnOperationInitial: rowColumnOperationInitial,\n        deleteRows: deleteRows,\n        deleteColumns: deleteColumns\n    };\n});"]}