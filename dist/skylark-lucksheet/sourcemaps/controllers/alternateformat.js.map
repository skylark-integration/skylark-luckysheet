{"version":3,"sources":["controllers/alternateformat.js"],"names":["define","alternateformat_methods","m_get","m_util","formula","luckysheetConfigsetting","tooltip","m_constant","luckysheetsizeauto","m_select","Store","locale","getSheetIndex","getRangetxt","replaceHtml","isEditMode","luckysheetAlternateformatHtml","modelHTML","selectHightlightShow","Object","assign","rangefocus","modelfocusIndex","getModelBox","hasRowHeader","hasRowFooter","_this","this","$","empty","modelListHtml","i","FixedModelColor","length","color1","color2","color3","color4","obj","append","modelCustom","luckysheetfile","currentSheetIndex","modelCustomHtml","init","remove","click","hide","document","off","on","e","val","trim","keyCode","update","rangeValue","parents","find","rangeDialog","show","is","checkboxChange","modelboxOn","index","$id","attr","len","colorType","currenColor","source","$parent","closest","hasClass","data","colorSelectDialog","alternatingColors","text","selectionTextColor","selectionCellColor","css","format","file","extend","getFormatByIndex","addCustomModel","getIndexByFormat","allowUpdate","saveParam","k","dataIndex","ruleArr","historyRules","splice","currentRules","ref","perfect","range","luckysheet_select_save","existsIndex","rangeIsExists","cellrange","row","column","prop","removeAttr","removeClass","eq","addClass","modelToningColor","color","fc","background-color","bc","push","_locale","locale_button","button","locale_toolbar","toolbar","title","id","addclass","content","currentColor","botton","confirm","cancel","style","$t","end","myh","outerHeight","myw","outerWidth","winw","window","width","winh","height","scrollLeft","scrollTop","left","top","spectrum","showPalette","showPaletteOnly","preferredFormat","clickoutFiresChange","showInitial","showInput","flat","hideAfterPaletteSelect","showSelectionPalette","showButtons","maxPaletteSize","maxSelectionSize","cancelText","chooseText","confirmColor","togglePaletteMoreText","customColor","togglePaletteLessText","collapse","togglePaletteOnly","clearText","noColorSelectedText","localStorageKey","gridKey","palette","move","toHexString","value","selectRange","tipSelectRange","isExists","AFarr","undefined","arr","map","getRangeMap","rangeMap","x","j","st_r","ed_r","st_c","ed_c","r","c","modelList","new","iscelldata","alert","errorNoRange","info","getcellrange","errorExistColors","clearjfundo","jfundo","redo","type","jfredo","refresh"],"mappings":"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","file":"../../controllers/alternateformat.js","sourcesContent":["define([\n    '../methods/alternateformat_methods',\n    '../methods/get',\n    '../utils/util',\n    '../methods/formula_methods',\n    '../methods/luckysheetConfigsetting',\n    '../widgets/tooltip',\n    '../widgets/constant',\n    '../widgets/resize',\n    '../widgets/select',\n    '../store',\n    '../locale/locale'\n], function (alternateformat_methods,m_get, m_util, formula, luckysheetConfigsetting, tooltip,  m_constant, luckysheetsizeauto, m_select, Store, locale) {\n    'use strict';\n    const {getSheetIndex, getRangetxt} = m_get;\n    const {replaceHtml} = m_util;\n    const {isEditMode} = luckysheetConfigsetting;\n    const {luckysheetAlternateformatHtml, modelHTML} = m_constant;\n    const {selectHightlightShow} = m_select;\n    //交替颜色\n    const alternateformat = Object.assign(alternateformat_methods, {\n        rangefocus: false,\n        modelfocusIndex: null,\n\n        getModelBox: function (hasRowHeader, hasRowFooter) {\n            let _this = this;\n            $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList').empty();\n            $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom').empty();    //格式样式 模板\n            //格式样式 模板\n            let modelListHtml = '';\n            for (let i = 0; i < _this.FixedModelColor.length; i++) {\n                let obj = _this.FixedModelColor[i];\n                let color1, color2, color3, color4;\n                if (hasRowHeader && hasRowFooter) {\n                    color1 = obj['head'];\n                    color2 = obj['one'];\n                    color3 = obj['two'];\n                    color4 = obj['foot'];\n                } else if (hasRowHeader) {\n                    color1 = obj['head'];\n                    color2 = obj['one'];\n                    color3 = obj['two'];\n                    color4 = obj['one'];\n                } else if (hasRowFooter) {\n                    color1 = obj['one'];\n                    color2 = obj['two'];\n                    color3 = obj['one'];\n                    color4 = obj['foot'];\n                } else {\n                    color1 = obj['one'];\n                    color2 = obj['two'];\n                    color3 = obj['one'];\n                    color4 = obj['two'];\n                }\n                modelListHtml += '<div class=\"modelbox\">' + '<div class=\"box\">' + '<span style=\"color:' + color1['fc'] + ';background-color:' + color1['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color2['fc'] + ';background-color:' + color2['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color3['fc'] + ';background-color:' + color3['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color4['fc'] + ';background-color:' + color4['bc'] + '\"> \\u2014 </span>' + '</div>' + '</div>';\n            }\n            $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList').append(modelListHtml);    //自定义 模板\n            //自定义 模板\n            let modelCustom = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_alternateformat_save_modelCustom'];\n            if (modelCustom != null && modelCustom.length > 0) {\n                let modelCustomHtml = '';\n                for (let i = 0; i < modelCustom.length; i++) {\n                    let obj = modelCustom[i];\n                    let color1, color2, color3, color4;\n                    if (hasRowHeader && hasRowFooter) {\n                        color1 = obj['head'];\n                        color2 = obj['one'];\n                        color3 = obj['two'];\n                        color4 = obj['foot'];\n                    } else if (hasRowHeader) {\n                        color1 = obj['head'];\n                        color2 = obj['one'];\n                        color3 = obj['two'];\n                        color4 = obj['one'];\n                    } else if (hasRowFooter) {\n                        color1 = obj['one'];\n                        color2 = obj['two'];\n                        color3 = obj['one'];\n                        color4 = obj['foot'];\n                    } else {\n                        color1 = obj['one'];\n                        color2 = obj['two'];\n                        color3 = obj['one'];\n                        color4 = obj['two'];\n                    }\n                    modelCustomHtml += '<div class=\"modelbox\">' + '<div class=\"box\">' + '<span style=\"color:' + color1['fc'] + ';background-color:' + color1['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color2['fc'] + ';background-color:' + color2['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color3['fc'] + ';background-color:' + color3['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color4['fc'] + ';background-color:' + color4['bc'] + '\"> \\u2014 </span>' + '</div>' + '</div>';\n                }\n                $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom').append(modelCustomHtml);\n            }\n        },\n        init: function () {\n            let _this = this;\n            $('#luckysheet-modal-dialog-slider-alternateformat').remove();\n            $('body').append(luckysheetAlternateformatHtml());\n            luckysheetsizeauto();\n            //关闭\n            $('#luckysheet-modal-dialog-slider-alternateformat .luckysheet-model-close-btn').click(function () {\n                $('#luckysheet-modal-dialog-slider-alternateformat').hide();\n                luckysheetsizeauto();\n            }); \n            //应用范围\n            $(document).off('focus.AFrangeInput').on('focus.AFrangeInput', '#luckysheet-alternateformat-range input', function () {\n                _this.rangefocus = true;\n            });\n            $(document).off('blur.AFrangeInput').on('blur.AFrangeInput', '#luckysheet-alternateformat-range input', function () {\n                _this.rangefocus = false;\n            });\n            $(document).off('keydown.AFrangeInput').on('keydown.AFrangeInput', '#luckysheet-alternateformat-range input', function (e) {\n                let rangeValue = $(this).val().trim();\n                if (e.keyCode == 13) {\n                    _this.update();\n                }\n            });\n            $(document).off('click.AFrangeIcon').on('click.AFrangeIcon', '#luckysheet-alternateformat-range .fa-table', function () {\n                $('#luckysheet-modal-dialog-slider-alternateformat').hide();\n                luckysheetsizeauto();\n                let rangeValue = $(this).parents('#luckysheet-alternateformat-range').find('input').val().trim();\n                _this.rangeDialog(rangeValue);\n            });\n            $(document).off('click.AFrDCf').on('click.AFrDCf', '#luckysheet-alternateformat-rangeDialog-confirm', function () {\n                let rangeValue = $(this).parents('#luckysheet-alternateformat-rangeDialog').find('input').val().trim();\n                $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input').val(rangeValue);\n                $(this).parents('#luckysheet-alternateformat-rangeDialog').hide();\n                $('#luckysheet-modal-dialog-slider-alternateformat').show();\n                luckysheetsizeauto();\n                _this.update();\n            });\n            $(document).off('click.AFrDCl').on('click.AFrDCl', '#luckysheet-alternateformat-rangeDialog-close', function () {\n                $(this).parents('#luckysheet-alternateformat-rangeDialog').hide();\n                $('#luckysheet-modal-dialog-slider-alternateformat').show();\n                luckysheetsizeauto();\n            });\n            $(document).off('click.AFrDTitle').on('click.AFrDTitle', '#luckysheet-alternateformat-rangeDialog .luckysheet-modal-dialog-title-close', function () {\n                $(this).parents('#luckysheet-alternateformat-rangeDialog').hide();\n                $('#luckysheet-modal-dialog-slider-alternateformat').show();\n                luckysheetsizeauto();\n            });    //页眉、页脚选中\n            //页眉、页脚选中\n            $(document).off('change.AFrowHeader').on('change.AFrowHeader', '#luckysheet-alternateformat-rowHeader', function () {\n                let hasRowHeader;\n                if ($(this).is(':checked')) {\n                    hasRowHeader = true;\n                } else {\n                    hasRowHeader = false;\n                }\n                let hasRowFooter;\n                if ($('#luckysheet-alternateformat-rowFooter').is(':checked')) {\n                    hasRowFooter = true;\n                } else {\n                    hasRowFooter = false;\n                }\n                _this.checkboxChange(hasRowHeader, hasRowFooter);\n                _this.modelboxOn();\n                _this.update();\n            });\n            $(document).off('change.AFrowFooter').on('change.AFrowFooter', '#luckysheet-alternateformat-rowFooter', function () {\n                let hasRowHeader;\n                if ($('#luckysheet-alternateformat-rowHeader').is(':checked')) {\n                    hasRowHeader = true;\n                } else {\n                    hasRowHeader = false;\n                }\n                let hasRowFooter;\n                if ($(this).is(':checked')) {\n                    hasRowFooter = true;\n                } else {\n                    hasRowFooter = false;\n                }\n                _this.checkboxChange(hasRowHeader, hasRowFooter);\n                _this.modelboxOn();\n                _this.update();\n            });    //点击样式模板\n            //点击样式模板\n            $(document).off('click.AFmodelbox').on('click.AFmodelbox', '#luckysheet-modal-dialog-slider-alternateformat .modelbox', function () {\n                let index = $(this).index();\n                let $id = $(this).parents('.cf').attr('id');\n                if ($id == 'luckysheet-alternateformat-modelList') {\n                    _this.modelfocusIndex = index;\n                } else if ($id == 'luckysheet-alternateformat-modelCustom') {\n                    let len = _this.FixedModelColor.length;\n                    _this.modelfocusIndex = index + len;\n                }\n                _this.modelboxOn();\n                _this.update();\n            }); \n            //点击选择文本/单元格颜色\n            $(document).off('click.AFselectColor').on('click.AFselectColor', '#luckysheet-modal-dialog-slider-alternateformat .luckysheet-color-menu-button-indicator', function () {\n                let $parent = $(this).closest('.toningbox');\n                let colorType, currenColor;\n                if ($(this).find('.luckysheet-icon-img').hasClass('luckysheet-icon-text-color')) {\n                    colorType = 'fc';\n                    currenColor = $parent.find('.toningShow').data('fc');\n                } else if ($(this).find('.luckysheet-icon-img').hasClass('luckysheet-icon-cell-color')) {\n                    colorType = 'bc';\n                    currenColor = $parent.find('.toningShow').data('bc');\n                }    //source\n                //source\n                let source;\n                if ($parent.hasClass('header')) {\n                    source = '0';\n                } else if ($parent.hasClass('ctOne')) {\n                    source = '1';\n                } else if ($parent.hasClass('ctTwo')) {\n                    source = '2';\n                } else if ($parent.hasClass('footer')) {\n                    source = '3';\n                }\n                _this.colorSelectDialog(currenColor, colorType, source);\n            }); \n            //选择颜色 确定 添加自定义模板\n            $(document).off('click.AFselectColorConfirm').on('click.AFselectColorConfirm', '#luckysheet-alternateformat-colorSelect-dialog-confirm', function () {\n                let $parent = $(this).parents('#luckysheet-alternateformat-colorSelect-dialog');\n                const _locale = locale();\n                const alternatingColors = _locale.alternatingColors;\n                $('#luckysheet-modal-dialog-mask').hide();\n                $parent.hide();    //获取currenColor colorType source\n                //获取currenColor colorType source\n                let currenColor = $parent.find('.currenColor span').attr('title');\n                let colorType;\n                if ($parent.find('.luckysheet-modal-dialog-title-text').text() == alternatingColors.selectionTextColor) {\n                    colorType = 'fc';\n                } else if ($parent.find('.luckysheet-modal-dialog-title-text').text() == alternatingColors.selectionCellColor) {\n                    colorType = 'bc';\n                }\n                let source = $parent.find('.currenColor').attr('data-source');    //赋给颜色\n                //赋给颜色\n                if (source == '0') {\n                    if (colorType == 'fc') {\n                        $('#luckysheet-alternateformat-modelToning .header .toningShow').css('color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .header .toningShow').data('fc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                    if (colorType == 'bc') {\n                        $('#luckysheet-alternateformat-modelToning .header .toningShow').css('background-color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .header .toningShow').data('bc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                } else if (source == '1') {\n                    if (colorType == 'fc') {\n                        $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').css('color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').data('fc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                    if (colorType == 'bc') {\n                        $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').css('background-color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').data('bc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                } else if (source == '2') {\n                    if (colorType == 'fc') {\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').css('color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').data('fc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                    if (colorType == 'bc') {\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').css('background-color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').data('bc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                } else if (source == '3') {\n                    if (colorType == 'fc') {\n                        $('#luckysheet-alternateformat-modelToning .footer .toningShow').css('color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .footer .toningShow').data('fc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                    if (colorType == 'bc') {\n                        $('#luckysheet-alternateformat-modelToning .footer .toningShow').css('background-color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .footer .toningShow').data('bc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                }    //若模板聚焦在固有模板，则新加模板；若模板聚焦在自定义模板，则修改该模板\n                //若模板聚焦在固有模板，则新加模板；若模板聚焦在自定义模板，则修改该模板\n                let hasRowHeader;\n                if ($('#luckysheet-alternateformat-rowHeader').is(':checked')) {\n                    hasRowHeader = true;\n                } else {\n                    hasRowHeader = false;\n                }\n                let hasRowFooter;\n                if ($('#luckysheet-alternateformat-rowFooter').is(':checked')) {\n                    hasRowFooter = true;\n                } else {\n                    hasRowFooter = false;\n                }\n                let index = _this.modelfocusIndex;\n                let len = _this.FixedModelColor.length;\n                let format, file;\n                if (index < len) {\n                    format = $.extend(true, {}, _this.getFormatByIndex());\n                } else {\n                    file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n                    let modelCustom = file['luckysheet_alternateformat_save_modelCustom'];\n                    format = $.extend(true, {}, modelCustom[index - len]);\n                }\n                if (source == '0') {\n                    if (colorType == 'fc') {\n                        format['head']['fc'] = currenColor;\n                    } else if (colorType == 'bc') {\n                        format['head']['bc'] = currenColor;\n                    }\n                } else if (source == '1') {\n                    if (colorType == 'fc') {\n                        format['one']['fc'] = currenColor;\n                    } else if (colorType == 'bc') {\n                        format['one']['bc'] = currenColor;\n                    }\n                } else if (source == '2') {\n                    if (colorType == 'fc') {\n                        format['two']['fc'] = currenColor;\n                    } else if (colorType == 'bc') {\n                        format['two']['bc'] = currenColor;\n                    }\n                } else if (source == '3') {\n                    if (colorType == 'fc') {\n                        format['foot']['fc'] = currenColor;\n                    }\n                    if (colorType == 'bc') {\n                        format['foot']['bc'] = currenColor;\n                    }\n                }\n                if (_this.modelfocusIndex < len) {\n                    _this.addCustomModel(format);\n                    _this.modelfocusIndex = _this.getIndexByFormat(format);\n                } else {\n                    file['luckysheet_alternateformat_save_modelCustom'][index - len] = format;\n                    if (Store.allowUpdate) {\n                        Store.saveParam('all', Store.currentSheetIndex, file['luckysheet_alternateformat_save_modelCustom'], { 'k': 'luckysheet_alternateformat_save_modelCustom' });\n                    }\n                }\n                _this.getModelBox(hasRowHeader, hasRowFooter);\n                _this.modelboxOn();\n                _this.update();\n            });    //点击 移除交替颜色 按钮\n            //点击 移除交替颜色 按钮\n            $(document).off('click.AFremove').on('click.AFremove', '#luckysheet-alternateformat-remove', function () {\n                let dataIndex = $(this).data('index');\n                let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n                let ruleArr = file['luckysheet_alternateformat_save'];    //保存之前的规则\n                //保存之前的规则\n                let historyRules = $.extend(true, [], ruleArr);    //保存当前的规则\n                //保存当前的规则\n                if (ruleArr.length > 1) {\n                    ruleArr.splice(dataIndex, 1);\n                } else {\n                    ruleArr = [];\n                }\n                let currentRules = $.extend(true, [], ruleArr);    //刷新一次表格\n                //刷新一次表格\n                _this.ref(historyRules, currentRules);\n                if (Store.allowUpdate) {\n                    Store.saveParam('all', Store.currentSheetIndex, ruleArr, { 'k': 'luckysheet_alternateformat_save' });\n                }    //隐藏一些dom\n                //隐藏一些dom\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-modal-dialog-slider-alternateformat').hide();\n                luckysheetsizeauto();\n            });\n        },\n        perfect: function () {\n            let _this = this;\n            let range = $.extend(true, {}, Store.luckysheet_select_save[0]);\n            let existsIndex = _this.rangeIsExists(range)[1];\n            let obj = $.extend(true, {}, Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_alternateformat_save'][existsIndex]);    //应用范围\n            //应用范围\n            let cellrange = obj['cellrange'];\n            $('#luckysheet-alternateformat-range input').val(getRangetxt(Store.currentSheetIndex, {\n                'row': cellrange['row'],\n                'column': cellrange['column']\n            }, Store.currentSheetIndex));\n            Store.luckysheet_select_save = [{\n                    'row': cellrange['row'],\n                    'column': cellrange['column']\n                }];\n            selectHightlightShow();    //页眉、页脚\n            //页眉、页脚\n            let hasRowHeader = obj['hasRowHeader'];\n            let hasRowFooter = obj['hasRowFooter'];    //模板聚焦\n            //模板聚焦\n            let format = obj['format'];\n            _this.modelfocusIndex = _this.getIndexByFormat(format);\n            if (_this.modelfocusIndex == null) {\n                _this.addCustomModel(format);\n                _this.modelfocusIndex = _this.getIndexByFormat(format);\n            }\n            _this.checkboxChange(hasRowHeader, hasRowFooter);\n            _this.modelboxOn();    //标识 交替颜色的index\n            //标识 交替颜色的index\n            $('#luckysheet-alternateformat-remove').data('index', existsIndex);\n        },\n        checkboxChange: function (hasRowHeader, hasRowFooter) {\n            if (hasRowHeader) {\n                $('#luckysheet-alternateformat-rowHeader').prop('checked', true);\n                $('#luckysheet-alternateformat-modelToning .header').show();\n            } else {\n                $('#luckysheet-alternateformat-rowHeader').removeAttr('checked');\n                $('#luckysheet-alternateformat-modelToning .header').hide();\n            }\n            if (hasRowFooter) {\n                $('#luckysheet-alternateformat-rowFooter').prop('checked', true);\n                $('#luckysheet-alternateformat-modelToning .footer').show();\n            } else {\n                $('#luckysheet-alternateformat-rowFooter').removeAttr('checked');\n                $('#luckysheet-alternateformat-modelToning .footer').hide();\n            }\n            this.getModelBox(hasRowHeader, hasRowFooter);\n        },\n        modelboxOn: function () {\n            let _this = this;    //模板 foucs\n            //模板 foucs\n            $('#luckysheet-modal-dialog-slider-alternateformat .modelbox').removeClass('on');\n            let index = _this.modelfocusIndex;\n            let len = _this.FixedModelColor.length;\n            if (index < len) {\n                $('#luckysheet-alternateformat-modelList .modelbox').eq(index).addClass('on');\n            } else {\n                $('#luckysheet-alternateformat-modelCustom .modelbox').eq(index - len).addClass('on');\n            }    //编辑 对应颜色改变\n            //编辑 对应颜色改变\n            _this.modelToningColor();\n        },\n        modelToningColor: function () {\n            let format = this.getFormatByIndex();    //页眉\n            //页眉\n            $('#luckysheet-alternateformat-modelToning .header .toningShow').css({\n                'color': format['head'].fc,\n                'background-color': format['head'].bc\n            });\n            $('#luckysheet-alternateformat-modelToning .header .toningShow').data('fc', format['head'].fc).data('bc', format['head'].bc);\n            $('#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['head'].fc);\n            $('#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['head'].bc);    //颜色1\n            //颜色1\n            $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').css({\n                'color': format['one'].fc,\n                'background-color': format['one'].bc\n            });\n            $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').data('fc', format['one'].fc).data('bc', format['one'].bc);\n            $('#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['one'].fc);\n            $('#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['one'].bc);    //颜色2\n            //颜色2\n            $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').css({\n                'color': format['two'].fc,\n                'background-color': format['two'].bc\n            });\n            $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').data('fc', format['two'].fc).data('bc', format['two'].bc);\n            $('#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['two'].fc);\n            $('#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['two'].bc);    //页脚\n            //页脚\n            $('#luckysheet-alternateformat-modelToning .footer .toningShow').css({\n                'color': format['foot'].fc,\n                'background-color': format['foot'].bc\n            });\n            $('#luckysheet-alternateformat-modelToning .footer .toningShow').data('fc', format['foot'].fc).data('bc', format['foot'].bc);\n            $('#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['foot'].fc);\n            $('#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['foot'].bc);\n        },\n        addCustomModel: function (format) {\n            let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            if (file['luckysheet_alternateformat_save_modelCustom'] == null) {\n                file['luckysheet_alternateformat_save_modelCustom'] = [];\n            }\n            file['luckysheet_alternateformat_save_modelCustom'].push(format);\n            if (Store.allowUpdate) {\n                Store.saveParam('all', Store.currentSheetIndex, file['luckysheet_alternateformat_save_modelCustom'], { 'k': 'luckysheet_alternateformat_save_modelCustom' });\n            }\n        },\n        colorSelectDialog: function (currenColor, colorType, source) {\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-alternateformat-colorSelect-dialog').remove();\n            const _locale = locale();\n            const alternatingColors = _locale.alternatingColors;\n            const locale_button = _locale.button;\n            const locale_toolbar = _locale.toolbar;\n            let title;\n            if (colorType == 'fc') {\n                title = alternatingColors.selectionTextColor;\n            } else if (colorType == 'bc') {\n                title = alternatingColors.selectionCellColor;\n            }\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-alternateformat-colorSelect-dialog',\n                'addclass': 'luckysheet-alternateformat-colorSelect-dialog',\n                'title': title,\n                'content': \"<div class='currenColor' data-source='\" + source + \"'>\" + alternatingColors.currentColor + \"\\uFF1A<span title='\" + currenColor + \"' style='background-color:\" + currenColor + \"'></span></div><div class='colorshowbox'></div>\",\n                'botton': '<button id=\"luckysheet-alternateformat-colorSelect-dialog-confirm\" class=\"btn btn-primary\">' + locale_button.confirm + '</button><button class=\"btn btn-default luckysheet-model-close-btn\">' + locale_button.cancel + '</button>',\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-alternateformat-colorSelect-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-alternateformat-colorSelect-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();    //初始化选择颜色插件\n            //初始化选择颜色插件\n            $('#luckysheet-alternateformat-colorSelect-dialog').find('.colorshowbox').spectrum({\n                showPalette: true,\n                showPaletteOnly: true,\n                preferredFormat: 'hex',\n                clickoutFiresChange: false,\n                showInitial: true,\n                showInput: true,\n                flat: true,\n                hideAfterPaletteSelect: true,\n                showSelectionPalette: true,\n                showButtons: false,\n                //隐藏选择取消按钮\n                maxPaletteSize: 8,\n                maxSelectionSize: 8,\n                color: currenColor,\n                cancelText: locale_button.cancel,\n                chooseText: locale_toolbar.confirmColor,\n                togglePaletteMoreText: locale_toolbar.customColor,\n                togglePaletteLessText: locale_toolbar.collapse,\n                togglePaletteOnly: true,\n                clearText: locale_toolbar.clearText,\n                noColorSelectedText: locale_toolbar.noColorSelectedText,\n                localStorageKey: 'spectrum.textcolor' + Store.gridKey,\n                palette: [\n                    [\n                        '#000',\n                        '#444',\n                        '#666',\n                        '#999',\n                        '#ccc',\n                        '#eee',\n                        '#f3f3f3',\n                        '#fff'\n                    ],\n                    [\n                        '#f00',\n                        '#f90',\n                        '#ff0',\n                        '#0f0',\n                        '#0ff',\n                        '#00f',\n                        '#90f',\n                        '#f0f'\n                    ],\n                    [\n                        '#f4cccc',\n                        '#fce5cd',\n                        '#fff2cc',\n                        '#d9ead3',\n                        '#d0e0e3',\n                        '#cfe2f3',\n                        '#d9d2e9',\n                        '#ead1dc'\n                    ],\n                    [\n                        '#ea9999',\n                        '#f9cb9c',\n                        '#ffe599',\n                        '#b6d7a8',\n                        '#a2c4c9',\n                        '#9fc5e8',\n                        '#b4a7d6',\n                        '#d5a6bd'\n                    ],\n                    [\n                        '#e06666',\n                        '#f6b26b',\n                        '#ffd966',\n                        '#93c47d',\n                        '#76a5af',\n                        '#6fa8dc',\n                        '#8e7cc3',\n                        '#c27ba0'\n                    ],\n                    [\n                        '#c00',\n                        '#e69138',\n                        '#f1c232',\n                        '#6aa84f',\n                        '#45818e',\n                        '#3d85c6',\n                        '#674ea7',\n                        '#a64d79'\n                    ],\n                    [\n                        '#900',\n                        '#b45f06',\n                        '#bf9000',\n                        '#38761d',\n                        '#134f5c',\n                        '#0b5394',\n                        '#351c75',\n                        '#741b47'\n                    ],\n                    [\n                        '#600',\n                        '#783f04',\n                        '#7f6000',\n                        '#274e13',\n                        '#0c343d',\n                        '#073763',\n                        '#20124d',\n                        '#4c1130'\n                    ]\n                ],\n                move: function (color) {\n                    if (color != null) {\n                        color = color.toHexString();\n                    } else {\n                        color = '#000';\n                    }\n                    $('#luckysheet-alternateformat-colorSelect-dialog .currenColor span').css('background-color', color).attr('title', color);\n                }\n            });\n        },\n        rangeDialog: function (value) {\n            $('#luckysheet-modal-dialog-mask').hide();\n            $('#luckysheet-alternateformat-rangeDialog').remove();\n            const _locale = locale();\n            const alternatingColors = _locale.alternatingColors;\n            const locale_button = _locale.button;\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-alternateformat-rangeDialog',\n                'addclass': 'luckysheet-alternateformat-rangeDialog',\n                'title': alternatingColors.selectRange,\n                'content': '<input readonly=\"readonly\" placeholder=\"' + alternatingColors.tipSelectRange + '\" value=\"' + value + '\"/>',\n                'botton': '<button id=\"luckysheet-alternateformat-rangeDialog-confirm\" class=\"btn btn-primary\">' + locale_button.confirm + '</button><button id=\"luckysheet-alternateformat-rangeDialog-close\" class=\"btn btn-default\">' + locale_button.cancel + '</button>',\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-alternateformat-rangeDialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-alternateformat-rangeDialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n        },\n        rangeIsExists: function (range, index) {\n            let _this = this;\n            let isExists = false;\n            let existsIndex = null;    //获取已有交替颜色所有应用范围\n            //获取已有交替颜色所有应用范围\n            let AFarr = $.extend(true, [], Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_alternateformat_save']);\n            if (index != undefined && index != null) {\n                if (AFarr.length > 1) {\n                    AFarr.splice(index, 1);\n                } else {\n                    AFarr = [];\n                }\n            }\n            if (AFarr.length > 0) {\n                let arr = [];\n                for (let i = 0; i < AFarr.length; i++) {\n                    let obj = {\n                        'index': i,\n                        'map': _this.getRangeMap(AFarr[i]['cellrange']['row'], AFarr[i]['cellrange']['column'])\n                    };\n                    arr.push(obj);\n                }    //获取当前选区\n                //获取当前选区\n                let rangeMap = _this.getRangeMap(range['row'], range['column']);    //遍历\n                //遍历\n                for (let x in rangeMap) {\n                    if (isExists) {\n                        break;\n                    }\n                    for (let j = 0; j < arr.length; j++) {\n                        if (x in arr[j]['map']) {\n                            isExists = true;\n                            existsIndex = arr[j]['index'];\n                            break;\n                        }\n                    }\n                }\n            }\n            return [\n                isExists,\n                existsIndex\n            ];\n        },\n        getRangeMap: function (row, column) {\n            let map = {};\n            let st_r = row[0], ed_r = row[1], st_c = column[0], ed_c = column[1];\n            for (let r = st_r; r <= ed_r; r++) {\n                for (let c = st_c; c <= ed_c; c++) {\n                    map[r + '_' + c] = 0;\n                }\n            }\n            return map;\n        },\n        getIndexByFormat: function (format) {\n            let _this = this;\n            let index = null;    //格式样式 模板\n            //格式样式 模板\n            let modelList = _this.FixedModelColor;\n            for (let i = 0; i < modelList.length; i++) {\n                let obj = modelList[i];\n                if (format['head'].fc == obj['head'].fc && format['head'].bc == obj['head'].bc) {\n                    if (format['one'].fc == obj['one'].fc && format['one'].bc == obj['one'].bc) {\n                        if (format['two'].fc == obj['two'].fc && format['two'].bc == obj['two'].bc) {\n                            if (format['foot'].fc == obj['foot'].fc && format['foot'].bc == obj['foot'].bc) {\n                                index = i;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }    //自定义 模板\n            //自定义 模板\n            let modelCustom = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_alternateformat_save_modelCustom'];\n            if (modelCustom != null && modelCustom.length > 0) {\n                for (let j = 0; j < modelCustom.length; j++) {\n                    let obj = modelCustom[j];\n                    if (format['head'].fc == obj['head'].fc && format['head'].bc == obj['head'].bc) {\n                        if (format['one'].fc == obj['one'].fc && format['one'].bc == obj['one'].bc) {\n                            if (format['two'].fc == obj['two'].fc && format['two'].bc == obj['two'].bc) {\n                                if (format['foot'].fc == obj['foot'].fc && format['foot'].bc == obj['foot'].bc) {\n                                    index = modelList.length + j;\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return index;\n        },\n        getFormatByIndex: function () {\n            let _this = this;\n            let index = _this.modelfocusIndex;\n            let len = _this.FixedModelColor.length;\n            let format = {};\n            if (index < len) {\n                format = _this.FixedModelColor[index];\n            } else {\n                format = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_alternateformat_save_modelCustom'][index - len];\n            }\n            return format;\n        },\n        new: function (cellrange) {\n            let _this = this;\n            let format = _this.getFormatByIndex();\n            let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            let ruleArr = file['luckysheet_alternateformat_save'];\n            if (ruleArr == null) {\n                ruleArr = [];\n            }    //保存之前的规则\n            //保存之前的规则\n            let historyRules = $.extend(true, [], ruleArr);    //保存当前的规则\n            //保存当前的规则\n            let obj = {\n                'cellrange': {\n                    'row': cellrange['row'],\n                    'column': cellrange['column']\n                },\n                'format': format,\n                'hasRowHeader': true,\n                'hasRowFooter': false\n            };\n            ruleArr.push(obj);\n            let currentRules = $.extend(true, [], ruleArr);    //刷新一次表格\n            //刷新一次表格\n            _this.ref(historyRules, currentRules);\n            if (Store.allowUpdate) {\n                Store.saveParam('all', Store.currentSheetIndex, ruleArr, { 'k': 'luckysheet_alternateformat_save' });\n            }\n        },\n        update: function () {\n            let _this = this;\n            const _locale = locale();\n            const alternatingColors = _locale.alternatingColors;    //获取标识\n            //获取标识\n            let dataIndex = $('#luckysheet-alternateformat-remove').data('index');    //应用范围\n            //应用范围\n            let rangeValue = $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input').val().trim();\n            if (!formula.iscelldata(rangeValue)) {\n                if (isEditMode()) {\n                    alert(alternatingColors.errorNoRange);\n                } else {\n                    tooltip.info(alternatingColors.errorNoRange, '');\n                }\n                return;\n            }\n            let cellrange = formula.getcellrange(rangeValue);\n            let isExists = _this.rangeIsExists(cellrange, dataIndex)[0];\n            if (isExists) {\n                if (isEditMode()) {\n                    alert(alternatingColors.errorExistColors);\n                } else {\n                    tooltip.info(alternatingColors.errorExistColors, '');\n                }\n                return;\n            }    //页眉、页脚\n            //页眉、页脚\n            let hasRowHeader;\n            if ($('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowHeader').is(':checked')) {\n                hasRowHeader = true;\n            } else {\n                hasRowHeader = false;\n            }\n            let hasRowFooter;\n            if ($('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowFooter').is(':checked')) {\n                hasRowFooter = true;\n            } else {\n                hasRowFooter = false;\n            }    //获取选中样式模板的颜色\n            //获取选中样式模板的颜色\n            let format = _this.getFormatByIndex();\n            let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            let ruleArr = file['luckysheet_alternateformat_save'];\n            if (ruleArr == null) {\n                ruleArr = [];\n            } \n            //保存之前的规则\n            let historyRules = $.extend(true, [], ruleArr);    //保存当前的规则\n            //保存当前的规则\n            let obj = {\n                'cellrange': {\n                    'row': cellrange['row'],\n                    'column': cellrange['column']\n                },\n                'format': format,\n                'hasRowHeader': hasRowHeader,\n                'hasRowFooter': hasRowFooter\n            };\n            ruleArr[dataIndex] = obj;\n            let currentRules = $.extend(true, [], ruleArr);    //刷新一次表格\n            //刷新一次表格\n            _this.ref(historyRules, currentRules);\n            if (Store.allowUpdate) {\n                Store.saveParam('all', Store.currentSheetIndex, ruleArr, { 'k': 'luckysheet_alternateformat_save' });\n            }\n        },\n\n        ref: function (historyRules, currentRules) {\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                let redo = {};\n                redo['type'] = 'updateAF';\n                redo['sheetIndex'] = Store.currentSheetIndex;\n                redo['data'] = {\n                    'historyRules': historyRules,\n                    'currentRules': currentRules\n                };\n                Store.jfredo.push(redo);\n            }\n            let index = getSheetIndex(Store.currentSheetIndex);\n            Store.luckysheetfile[index]['luckysheet_alternateformat_save'] = currentRules;\n            ///setTimeout(function () {\n            ///    luckysheetrefreshgrid();\n            ///}, 1);\n            Store.refresh();\n        }\n    });\n    return alternateformat;\n});"]}