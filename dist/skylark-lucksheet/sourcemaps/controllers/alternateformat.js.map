{"version":3,"sources":["controllers/alternateformat.js"],"names":["define","m_get","m_util","formula","m_validate","tooltip","m_refresh","m_constant","luckysheetsizeauto","server","m_select","Store","locale","getSheetIndex","getRangetxt","replaceHtml","isEditMode","luckysheetrefreshgrid","luckysheetAlternateformatHtml","modelHTML","selectHightlightShow","rangefocus","modelfocusIndex","FixedModelColor","head","fc","bc","one","two","foot","getModelBox","hasRowHeader","hasRowFooter","_this","this","$","empty","modelListHtml","i","length","color1","color2","color3","color4","obj","append","modelCustom","luckysheetfile","currentSheetIndex","modelCustomHtml","init","remove","click","hide","document","off","on","e","val","trim","keyCode","update","rangeValue","parents","find","rangeDialog","show","is","checkboxChange","modelboxOn","index","$id","attr","len","colorType","currenColor","source","$parent","closest","hasClass","data","colorSelectDialog","alternatingColors","text","selectionTextColor","selectionCellColor","css","format","file","extend","getFormatByIndex","addCustomModel","getIndexByFormat","allowUpdate","saveParam","k","dataIndex","ruleArr","historyRules","splice","currentRules","ref","perfect","range","luckysheet_select_save","existsIndex","rangeIsExists","cellrange","row","column","prop","removeAttr","removeClass","eq","addClass","modelToningColor","color","background-color","push","_locale","locale_button","button","locale_toolbar","toolbar","title","id","addclass","content","currentColor","botton","confirm","cancel","style","$t","end","myh","outerHeight","myw","outerWidth","winw","window","width","winh","height","scrollLeft","scrollTop","left","top","spectrum","showPalette","showPaletteOnly","preferredFormat","clickoutFiresChange","showInitial","showInput","flat","hideAfterPaletteSelect","showSelectionPalette","showButtons","maxPaletteSize","maxSelectionSize","cancelText","chooseText","confirmColor","togglePaletteMoreText","customColor","togglePaletteLessText","collapse","togglePaletteOnly","clearText","noColorSelectedText","localStorageKey","gridKey","palette","move","toHexString","value","selectRange","tipSelectRange","isExists","AFarr","undefined","arr","map","getRangeMap","rangeMap","x","j","st_r","ed_r","st_c","ed_c","r","c","modelList","new","iscelldata","alert","errorNoRange","info","getcellrange","errorExistColors","checksAF","computeMap","getComputeMap","compute","clearjfundo","jfundo","redo","type","jfredo","setTimeout"],"mappings":"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","file":"../../controllers/alternateformat.js","sourcesContent":["define([\n    '../methods/get',\n    '../utils/util',\n    '../global/formula',\n    '../global/validate',\n    '../global/tooltip',\n    '../global/refresh',\n    './constant',\n    './resize',\n    './server',\n    './select',\n    '../store',\n    '../locale/locale'\n], function (m_get, m_util, formula, m_validate, tooltip, m_refresh, m_constant, luckysheetsizeauto, server, m_select, Store, locale) {\n    'use strict';\n    const {getSheetIndex, getRangetxt} = m_get;\n    const {replaceHtml} = m_util;\n    const {isEditMode} = m_validate;\n    const {luckysheetrefreshgrid} = m_refresh;\n    const {luckysheetAlternateformatHtml, modelHTML} = m_constant;\n    const {selectHightlightShow} = m_select;\n    //交替颜色\n    const alternateformat = {\n        rangefocus: false,\n        modelfocusIndex: null,\n        FixedModelColor: [\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#bfbdbe'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#f8f3f7'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#dde2de'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#4bd4e7'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#eaf7ff'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#aae9f8'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#5ed593'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#e5fbee'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#a5efcc'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#f6cb4b'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#fff9e7'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#ffebac'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#f96420'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#ffe5d9'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#ffcfba'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#5599fc'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#ecf2fe'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#afcbfa'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#22a69b'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#dff2f8'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#8dd4d0'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#7a939a'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#f0eff7'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#bdcad0'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#d7a270'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#fdf3f1'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#ead2b6'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#89c54b'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#f1f7e9'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#c5e3a7'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#8f88f0'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#f0e5ff'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#c6c4f6'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#fd1664'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#feddee'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#f98ab5'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#da96d3'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#fce8fb'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#f2caee'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#b49191'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#f5ebe8'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#d8c3c3'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#91b493'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#f0fbf0'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#b4cfb6'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#b4a891'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#f8f6f1'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#d3cab8'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#91abb4'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#eff7fa'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#b7cbd3'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#b7ba82'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#fafbeb'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#dadcb4'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#df3e3e'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#fde9e9'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#f89292'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#f2711c'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#fef0d7'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#fbb335'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#b5cc18'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#f9fbd4'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#e2ed2a'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#00b5ad'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#ccfaf9'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#00e4df'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#2185d0'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#d8f3fc'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#3cc4f0'\n                }\n            },\n            {\n                'head': {\n                    'fc': '#000',\n                    'bc': '#a5673f'\n                },\n                'one': {\n                    'fc': '#000',\n                    'bc': '#ffffff'\n                },\n                'two': {\n                    'fc': '#000',\n                    'bc': '#f6ede5'\n                },\n                'foot': {\n                    'fc': '#000',\n                    'bc': '#d3a47c'\n                }\n            }\n        ],\n        getModelBox: function (hasRowHeader, hasRowFooter) {\n            let _this = this;\n            $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList').empty();\n            $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom').empty();    //格式样式 模板\n            //格式样式 模板\n            let modelListHtml = '';\n            for (let i = 0; i < _this.FixedModelColor.length; i++) {\n                let obj = _this.FixedModelColor[i];\n                let color1, color2, color3, color4;\n                if (hasRowHeader && hasRowFooter) {\n                    color1 = obj['head'];\n                    color2 = obj['one'];\n                    color3 = obj['two'];\n                    color4 = obj['foot'];\n                } else if (hasRowHeader) {\n                    color1 = obj['head'];\n                    color2 = obj['one'];\n                    color3 = obj['two'];\n                    color4 = obj['one'];\n                } else if (hasRowFooter) {\n                    color1 = obj['one'];\n                    color2 = obj['two'];\n                    color3 = obj['one'];\n                    color4 = obj['foot'];\n                } else {\n                    color1 = obj['one'];\n                    color2 = obj['two'];\n                    color3 = obj['one'];\n                    color4 = obj['two'];\n                }\n                modelListHtml += '<div class=\"modelbox\">' + '<div class=\"box\">' + '<span style=\"color:' + color1['fc'] + ';background-color:' + color1['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color2['fc'] + ';background-color:' + color2['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color3['fc'] + ';background-color:' + color3['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color4['fc'] + ';background-color:' + color4['bc'] + '\"> \\u2014 </span>' + '</div>' + '</div>';\n            }\n            $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList').append(modelListHtml);    //自定义 模板\n            //自定义 模板\n            let modelCustom = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_alternateformat_save_modelCustom'];\n            if (modelCustom != null && modelCustom.length > 0) {\n                let modelCustomHtml = '';\n                for (let i = 0; i < modelCustom.length; i++) {\n                    let obj = modelCustom[i];\n                    let color1, color2, color3, color4;\n                    if (hasRowHeader && hasRowFooter) {\n                        color1 = obj['head'];\n                        color2 = obj['one'];\n                        color3 = obj['two'];\n                        color4 = obj['foot'];\n                    } else if (hasRowHeader) {\n                        color1 = obj['head'];\n                        color2 = obj['one'];\n                        color3 = obj['two'];\n                        color4 = obj['one'];\n                    } else if (hasRowFooter) {\n                        color1 = obj['one'];\n                        color2 = obj['two'];\n                        color3 = obj['one'];\n                        color4 = obj['foot'];\n                    } else {\n                        color1 = obj['one'];\n                        color2 = obj['two'];\n                        color3 = obj['one'];\n                        color4 = obj['two'];\n                    }\n                    modelCustomHtml += '<div class=\"modelbox\">' + '<div class=\"box\">' + '<span style=\"color:' + color1['fc'] + ';background-color:' + color1['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color2['fc'] + ';background-color:' + color2['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color3['fc'] + ';background-color:' + color3['bc'] + '\"> \\u2014 </span>' + '<span style=\"color:' + color4['fc'] + ';background-color:' + color4['bc'] + '\"> \\u2014 </span>' + '</div>' + '</div>';\n                }\n                $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom').append(modelCustomHtml);\n            }\n        },\n        init: function () {\n            let _this = this;\n            $('#luckysheet-modal-dialog-slider-alternateformat').remove();\n            $('body').append(luckysheetAlternateformatHtml());\n            luckysheetsizeauto();    //关闭\n            //关闭\n            $('#luckysheet-modal-dialog-slider-alternateformat .luckysheet-model-close-btn').click(function () {\n                $('#luckysheet-modal-dialog-slider-alternateformat').hide();\n                luckysheetsizeauto();\n            });    //应用范围\n            //应用范围\n            $(document).off('focus.AFrangeInput').on('focus.AFrangeInput', '#luckysheet-alternateformat-range input', function () {\n                _this.rangefocus = true;\n            });\n            $(document).off('blur.AFrangeInput').on('blur.AFrangeInput', '#luckysheet-alternateformat-range input', function () {\n                _this.rangefocus = false;\n            });\n            $(document).off('keydown.AFrangeInput').on('keydown.AFrangeInput', '#luckysheet-alternateformat-range input', function (e) {\n                let rangeValue = $(this).val().trim();\n                if (e.keyCode == 13) {\n                    _this.update();\n                }\n            });\n            $(document).off('click.AFrangeIcon').on('click.AFrangeIcon', '#luckysheet-alternateformat-range .fa-table', function () {\n                $('#luckysheet-modal-dialog-slider-alternateformat').hide();\n                luckysheetsizeauto();\n                let rangeValue = $(this).parents('#luckysheet-alternateformat-range').find('input').val().trim();\n                _this.rangeDialog(rangeValue);\n            });\n            $(document).off('click.AFrDCf').on('click.AFrDCf', '#luckysheet-alternateformat-rangeDialog-confirm', function () {\n                let rangeValue = $(this).parents('#luckysheet-alternateformat-rangeDialog').find('input').val().trim();\n                $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input').val(rangeValue);\n                $(this).parents('#luckysheet-alternateformat-rangeDialog').hide();\n                $('#luckysheet-modal-dialog-slider-alternateformat').show();\n                luckysheetsizeauto();\n                _this.update();\n            });\n            $(document).off('click.AFrDCl').on('click.AFrDCl', '#luckysheet-alternateformat-rangeDialog-close', function () {\n                $(this).parents('#luckysheet-alternateformat-rangeDialog').hide();\n                $('#luckysheet-modal-dialog-slider-alternateformat').show();\n                luckysheetsizeauto();\n            });\n            $(document).off('click.AFrDTitle').on('click.AFrDTitle', '#luckysheet-alternateformat-rangeDialog .luckysheet-modal-dialog-title-close', function () {\n                $(this).parents('#luckysheet-alternateformat-rangeDialog').hide();\n                $('#luckysheet-modal-dialog-slider-alternateformat').show();\n                luckysheetsizeauto();\n            });    //页眉、页脚选中\n            //页眉、页脚选中\n            $(document).off('change.AFrowHeader').on('change.AFrowHeader', '#luckysheet-alternateformat-rowHeader', function () {\n                let hasRowHeader;\n                if ($(this).is(':checked')) {\n                    hasRowHeader = true;\n                } else {\n                    hasRowHeader = false;\n                }\n                let hasRowFooter;\n                if ($('#luckysheet-alternateformat-rowFooter').is(':checked')) {\n                    hasRowFooter = true;\n                } else {\n                    hasRowFooter = false;\n                }\n                _this.checkboxChange(hasRowHeader, hasRowFooter);\n                _this.modelboxOn();\n                _this.update();\n            });\n            $(document).off('change.AFrowFooter').on('change.AFrowFooter', '#luckysheet-alternateformat-rowFooter', function () {\n                let hasRowHeader;\n                if ($('#luckysheet-alternateformat-rowHeader').is(':checked')) {\n                    hasRowHeader = true;\n                } else {\n                    hasRowHeader = false;\n                }\n                let hasRowFooter;\n                if ($(this).is(':checked')) {\n                    hasRowFooter = true;\n                } else {\n                    hasRowFooter = false;\n                }\n                _this.checkboxChange(hasRowHeader, hasRowFooter);\n                _this.modelboxOn();\n                _this.update();\n            });    //点击样式模板\n            //点击样式模板\n            $(document).off('click.AFmodelbox').on('click.AFmodelbox', '#luckysheet-modal-dialog-slider-alternateformat .modelbox', function () {\n                let index = $(this).index();\n                let $id = $(this).parents('.cf').attr('id');\n                if ($id == 'luckysheet-alternateformat-modelList') {\n                    _this.modelfocusIndex = index;\n                } else if ($id == 'luckysheet-alternateformat-modelCustom') {\n                    let len = _this.FixedModelColor.length;\n                    _this.modelfocusIndex = index + len;\n                }\n                _this.modelboxOn();\n                _this.update();\n            });    //点击选择文本/单元格颜色\n            //点击选择文本/单元格颜色\n            $(document).off('click.AFselectColor').on('click.AFselectColor', '#luckysheet-modal-dialog-slider-alternateformat .luckysheet-color-menu-button-indicator', function () {\n                let $parent = $(this).closest('.toningbox');\n                let colorType, currenColor;\n                if ($(this).find('.luckysheet-icon-img').hasClass('luckysheet-icon-text-color')) {\n                    colorType = 'fc';\n                    currenColor = $parent.find('.toningShow').data('fc');\n                } else if ($(this).find('.luckysheet-icon-img').hasClass('luckysheet-icon-cell-color')) {\n                    colorType = 'bc';\n                    currenColor = $parent.find('.toningShow').data('bc');\n                }    //source\n                //source\n                let source;\n                if ($parent.hasClass('header')) {\n                    source = '0';\n                } else if ($parent.hasClass('ctOne')) {\n                    source = '1';\n                } else if ($parent.hasClass('ctTwo')) {\n                    source = '2';\n                } else if ($parent.hasClass('footer')) {\n                    source = '3';\n                }\n                _this.colorSelectDialog(currenColor, colorType, source);\n            });    //选择颜色 确定 添加自定义模板\n            //选择颜色 确定 添加自定义模板\n            $(document).off('click.AFselectColorConfirm').on('click.AFselectColorConfirm', '#luckysheet-alternateformat-colorSelect-dialog-confirm', function () {\n                let $parent = $(this).parents('#luckysheet-alternateformat-colorSelect-dialog');\n                const _locale = locale();\n                const alternatingColors = _locale.alternatingColors;\n                $('#luckysheet-modal-dialog-mask').hide();\n                $parent.hide();    //获取currenColor colorType source\n                //获取currenColor colorType source\n                let currenColor = $parent.find('.currenColor span').attr('title');\n                let colorType;\n                if ($parent.find('.luckysheet-modal-dialog-title-text').text() == alternatingColors.selectionTextColor) {\n                    colorType = 'fc';\n                } else if ($parent.find('.luckysheet-modal-dialog-title-text').text() == alternatingColors.selectionCellColor) {\n                    colorType = 'bc';\n                }\n                let source = $parent.find('.currenColor').attr('data-source');    //赋给颜色\n                //赋给颜色\n                if (source == '0') {\n                    if (colorType == 'fc') {\n                        $('#luckysheet-alternateformat-modelToning .header .toningShow').css('color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .header .toningShow').data('fc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                    if (colorType == 'bc') {\n                        $('#luckysheet-alternateformat-modelToning .header .toningShow').css('background-color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .header .toningShow').data('bc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                } else if (source == '1') {\n                    if (colorType == 'fc') {\n                        $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').css('color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').data('fc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                    if (colorType == 'bc') {\n                        $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').css('background-color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').data('bc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                } else if (source == '2') {\n                    if (colorType == 'fc') {\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').css('color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').data('fc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                    if (colorType == 'bc') {\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').css('background-color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').data('bc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                } else if (source == '3') {\n                    if (colorType == 'fc') {\n                        $('#luckysheet-alternateformat-modelToning .footer .toningShow').css('color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .footer .toningShow').data('fc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                    if (colorType == 'bc') {\n                        $('#luckysheet-alternateformat-modelToning .footer .toningShow').css('background-color', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .footer .toningShow').data('bc', currenColor);\n                        $('#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', currenColor);\n                    }\n                }    //若模板聚焦在固有模板，则新加模板；若模板聚焦在自定义模板，则修改该模板\n                //若模板聚焦在固有模板，则新加模板；若模板聚焦在自定义模板，则修改该模板\n                let hasRowHeader;\n                if ($('#luckysheet-alternateformat-rowHeader').is(':checked')) {\n                    hasRowHeader = true;\n                } else {\n                    hasRowHeader = false;\n                }\n                let hasRowFooter;\n                if ($('#luckysheet-alternateformat-rowFooter').is(':checked')) {\n                    hasRowFooter = true;\n                } else {\n                    hasRowFooter = false;\n                }\n                let index = _this.modelfocusIndex;\n                let len = _this.FixedModelColor.length;\n                let format, file;\n                if (index < len) {\n                    format = $.extend(true, {}, _this.getFormatByIndex());\n                } else {\n                    file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n                    let modelCustom = file['luckysheet_alternateformat_save_modelCustom'];\n                    format = $.extend(true, {}, modelCustom[index - len]);\n                }\n                if (source == '0') {\n                    if (colorType == 'fc') {\n                        format['head']['fc'] = currenColor;\n                    } else if (colorType == 'bc') {\n                        format['head']['bc'] = currenColor;\n                    }\n                } else if (source == '1') {\n                    if (colorType == 'fc') {\n                        format['one']['fc'] = currenColor;\n                    } else if (colorType == 'bc') {\n                        format['one']['bc'] = currenColor;\n                    }\n                } else if (source == '2') {\n                    if (colorType == 'fc') {\n                        format['two']['fc'] = currenColor;\n                    } else if (colorType == 'bc') {\n                        format['two']['bc'] = currenColor;\n                    }\n                } else if (source == '3') {\n                    if (colorType == 'fc') {\n                        format['foot']['fc'] = currenColor;\n                    }\n                    if (colorType == 'bc') {\n                        format['foot']['bc'] = currenColor;\n                    }\n                }\n                if (_this.modelfocusIndex < len) {\n                    _this.addCustomModel(format);\n                    _this.modelfocusIndex = _this.getIndexByFormat(format);\n                } else {\n                    file['luckysheet_alternateformat_save_modelCustom'][index - len] = format;\n                    if (server.allowUpdate) {\n                        server.saveParam('all', Store.currentSheetIndex, file['luckysheet_alternateformat_save_modelCustom'], { 'k': 'luckysheet_alternateformat_save_modelCustom' });\n                    }\n                }\n                _this.getModelBox(hasRowHeader, hasRowFooter);\n                _this.modelboxOn();\n                _this.update();\n            });    //点击 移除交替颜色 按钮\n            //点击 移除交替颜色 按钮\n            $(document).off('click.AFremove').on('click.AFremove', '#luckysheet-alternateformat-remove', function () {\n                let dataIndex = $(this).data('index');\n                let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n                let ruleArr = file['luckysheet_alternateformat_save'];    //保存之前的规则\n                //保存之前的规则\n                let historyRules = $.extend(true, [], ruleArr);    //保存当前的规则\n                //保存当前的规则\n                if (ruleArr.length > 1) {\n                    ruleArr.splice(dataIndex, 1);\n                } else {\n                    ruleArr = [];\n                }\n                let currentRules = $.extend(true, [], ruleArr);    //刷新一次表格\n                //刷新一次表格\n                _this.ref(historyRules, currentRules);\n                if (server.allowUpdate) {\n                    server.saveParam('all', Store.currentSheetIndex, ruleArr, { 'k': 'luckysheet_alternateformat_save' });\n                }    //隐藏一些dom\n                //隐藏一些dom\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-modal-dialog-slider-alternateformat').hide();\n                luckysheetsizeauto();\n            });\n        },\n        perfect: function () {\n            let _this = this;\n            let range = $.extend(true, {}, Store.luckysheet_select_save[0]);\n            let existsIndex = _this.rangeIsExists(range)[1];\n            let obj = $.extend(true, {}, Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_alternateformat_save'][existsIndex]);    //应用范围\n            //应用范围\n            let cellrange = obj['cellrange'];\n            $('#luckysheet-alternateformat-range input').val(getRangetxt(Store.currentSheetIndex, {\n                'row': cellrange['row'],\n                'column': cellrange['column']\n            }, Store.currentSheetIndex));\n            Store.luckysheet_select_save = [{\n                    'row': cellrange['row'],\n                    'column': cellrange['column']\n                }];\n            selectHightlightShow();    //页眉、页脚\n            //页眉、页脚\n            let hasRowHeader = obj['hasRowHeader'];\n            let hasRowFooter = obj['hasRowFooter'];    //模板聚焦\n            //模板聚焦\n            let format = obj['format'];\n            _this.modelfocusIndex = _this.getIndexByFormat(format);\n            if (_this.modelfocusIndex == null) {\n                _this.addCustomModel(format);\n                _this.modelfocusIndex = _this.getIndexByFormat(format);\n            }\n            _this.checkboxChange(hasRowHeader, hasRowFooter);\n            _this.modelboxOn();    //标识 交替颜色的index\n            //标识 交替颜色的index\n            $('#luckysheet-alternateformat-remove').data('index', existsIndex);\n        },\n        checkboxChange: function (hasRowHeader, hasRowFooter) {\n            if (hasRowHeader) {\n                $('#luckysheet-alternateformat-rowHeader').prop('checked', true);\n                $('#luckysheet-alternateformat-modelToning .header').show();\n            } else {\n                $('#luckysheet-alternateformat-rowHeader').removeAttr('checked');\n                $('#luckysheet-alternateformat-modelToning .header').hide();\n            }\n            if (hasRowFooter) {\n                $('#luckysheet-alternateformat-rowFooter').prop('checked', true);\n                $('#luckysheet-alternateformat-modelToning .footer').show();\n            } else {\n                $('#luckysheet-alternateformat-rowFooter').removeAttr('checked');\n                $('#luckysheet-alternateformat-modelToning .footer').hide();\n            }\n            this.getModelBox(hasRowHeader, hasRowFooter);\n        },\n        modelboxOn: function () {\n            let _this = this;    //模板 foucs\n            //模板 foucs\n            $('#luckysheet-modal-dialog-slider-alternateformat .modelbox').removeClass('on');\n            let index = _this.modelfocusIndex;\n            let len = _this.FixedModelColor.length;\n            if (index < len) {\n                $('#luckysheet-alternateformat-modelList .modelbox').eq(index).addClass('on');\n            } else {\n                $('#luckysheet-alternateformat-modelCustom .modelbox').eq(index - len).addClass('on');\n            }    //编辑 对应颜色改变\n            //编辑 对应颜色改变\n            _this.modelToningColor();\n        },\n        modelToningColor: function () {\n            let format = this.getFormatByIndex();    //页眉\n            //页眉\n            $('#luckysheet-alternateformat-modelToning .header .toningShow').css({\n                'color': format['head'].fc,\n                'background-color': format['head'].bc\n            });\n            $('#luckysheet-alternateformat-modelToning .header .toningShow').data('fc', format['head'].fc).data('bc', format['head'].bc);\n            $('#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['head'].fc);\n            $('#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['head'].bc);    //颜色1\n            //颜色1\n            $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').css({\n                'color': format['one'].fc,\n                'background-color': format['one'].bc\n            });\n            $('#luckysheet-alternateformat-modelToning .ctOne .toningShow').data('fc', format['one'].fc).data('bc', format['one'].bc);\n            $('#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['one'].fc);\n            $('#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['one'].bc);    //颜色2\n            //颜色2\n            $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').css({\n                'color': format['two'].fc,\n                'background-color': format['two'].bc\n            });\n            $('#luckysheet-alternateformat-modelToning .ctTwo .toningShow').data('fc', format['two'].fc).data('bc', format['two'].bc);\n            $('#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['two'].fc);\n            $('#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['two'].bc);    //页脚\n            //页脚\n            $('#luckysheet-alternateformat-modelToning .footer .toningShow').css({\n                'color': format['foot'].fc,\n                'background-color': format['foot'].bc\n            });\n            $('#luckysheet-alternateformat-modelToning .footer .toningShow').data('fc', format['foot'].fc).data('bc', format['foot'].bc);\n            $('#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['foot'].fc);\n            $('#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color').parents('.luckysheet-color-menu-button-indicator').css('border-bottom-color', format['foot'].bc);\n        },\n        addCustomModel: function (format) {\n            let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            if (file['luckysheet_alternateformat_save_modelCustom'] == null) {\n                file['luckysheet_alternateformat_save_modelCustom'] = [];\n            }\n            file['luckysheet_alternateformat_save_modelCustom'].push(format);\n            if (server.allowUpdate) {\n                server.saveParam('all', Store.currentSheetIndex, file['luckysheet_alternateformat_save_modelCustom'], { 'k': 'luckysheet_alternateformat_save_modelCustom' });\n            }\n        },\n        colorSelectDialog: function (currenColor, colorType, source) {\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-alternateformat-colorSelect-dialog').remove();\n            const _locale = locale();\n            const alternatingColors = _locale.alternatingColors;\n            const locale_button = _locale.button;\n            const locale_toolbar = _locale.toolbar;\n            let title;\n            if (colorType == 'fc') {\n                title = alternatingColors.selectionTextColor;\n            } else if (colorType == 'bc') {\n                title = alternatingColors.selectionCellColor;\n            }\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-alternateformat-colorSelect-dialog',\n                'addclass': 'luckysheet-alternateformat-colorSelect-dialog',\n                'title': title,\n                'content': \"<div class='currenColor' data-source='\" + source + \"'>\" + alternatingColors.currentColor + \"\\uFF1A<span title='\" + currenColor + \"' style='background-color:\" + currenColor + \"'></span></div><div class='colorshowbox'></div>\",\n                'botton': '<button id=\"luckysheet-alternateformat-colorSelect-dialog-confirm\" class=\"btn btn-primary\">' + locale_button.confirm + '</button><button class=\"btn btn-default luckysheet-model-close-btn\">' + locale_button.cancel + '</button>',\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-alternateformat-colorSelect-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-alternateformat-colorSelect-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();    //初始化选择颜色插件\n            //初始化选择颜色插件\n            $('#luckysheet-alternateformat-colorSelect-dialog').find('.colorshowbox').spectrum({\n                showPalette: true,\n                showPaletteOnly: true,\n                preferredFormat: 'hex',\n                clickoutFiresChange: false,\n                showInitial: true,\n                showInput: true,\n                flat: true,\n                hideAfterPaletteSelect: true,\n                showSelectionPalette: true,\n                showButtons: false,\n                //隐藏选择取消按钮\n                maxPaletteSize: 8,\n                maxSelectionSize: 8,\n                color: currenColor,\n                cancelText: locale_button.cancel,\n                chooseText: locale_toolbar.confirmColor,\n                togglePaletteMoreText: locale_toolbar.customColor,\n                togglePaletteLessText: locale_toolbar.collapse,\n                togglePaletteOnly: true,\n                clearText: locale_toolbar.clearText,\n                noColorSelectedText: locale_toolbar.noColorSelectedText,\n                localStorageKey: 'spectrum.textcolor' + server.gridKey,\n                palette: [\n                    [\n                        '#000',\n                        '#444',\n                        '#666',\n                        '#999',\n                        '#ccc',\n                        '#eee',\n                        '#f3f3f3',\n                        '#fff'\n                    ],\n                    [\n                        '#f00',\n                        '#f90',\n                        '#ff0',\n                        '#0f0',\n                        '#0ff',\n                        '#00f',\n                        '#90f',\n                        '#f0f'\n                    ],\n                    [\n                        '#f4cccc',\n                        '#fce5cd',\n                        '#fff2cc',\n                        '#d9ead3',\n                        '#d0e0e3',\n                        '#cfe2f3',\n                        '#d9d2e9',\n                        '#ead1dc'\n                    ],\n                    [\n                        '#ea9999',\n                        '#f9cb9c',\n                        '#ffe599',\n                        '#b6d7a8',\n                        '#a2c4c9',\n                        '#9fc5e8',\n                        '#b4a7d6',\n                        '#d5a6bd'\n                    ],\n                    [\n                        '#e06666',\n                        '#f6b26b',\n                        '#ffd966',\n                        '#93c47d',\n                        '#76a5af',\n                        '#6fa8dc',\n                        '#8e7cc3',\n                        '#c27ba0'\n                    ],\n                    [\n                        '#c00',\n                        '#e69138',\n                        '#f1c232',\n                        '#6aa84f',\n                        '#45818e',\n                        '#3d85c6',\n                        '#674ea7',\n                        '#a64d79'\n                    ],\n                    [\n                        '#900',\n                        '#b45f06',\n                        '#bf9000',\n                        '#38761d',\n                        '#134f5c',\n                        '#0b5394',\n                        '#351c75',\n                        '#741b47'\n                    ],\n                    [\n                        '#600',\n                        '#783f04',\n                        '#7f6000',\n                        '#274e13',\n                        '#0c343d',\n                        '#073763',\n                        '#20124d',\n                        '#4c1130'\n                    ]\n                ],\n                move: function (color) {\n                    if (color != null) {\n                        color = color.toHexString();\n                    } else {\n                        color = '#000';\n                    }\n                    $('#luckysheet-alternateformat-colorSelect-dialog .currenColor span').css('background-color', color).attr('title', color);\n                }\n            });\n        },\n        rangeDialog: function (value) {\n            $('#luckysheet-modal-dialog-mask').hide();\n            $('#luckysheet-alternateformat-rangeDialog').remove();\n            const _locale = locale();\n            const alternatingColors = _locale.alternatingColors;\n            const locale_button = _locale.button;\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-alternateformat-rangeDialog',\n                'addclass': 'luckysheet-alternateformat-rangeDialog',\n                'title': alternatingColors.selectRange,\n                'content': '<input readonly=\"readonly\" placeholder=\"' + alternatingColors.tipSelectRange + '\" value=\"' + value + '\"/>',\n                'botton': '<button id=\"luckysheet-alternateformat-rangeDialog-confirm\" class=\"btn btn-primary\">' + locale_button.confirm + '</button><button id=\"luckysheet-alternateformat-rangeDialog-close\" class=\"btn btn-default\">' + locale_button.cancel + '</button>',\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-alternateformat-rangeDialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-alternateformat-rangeDialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n        },\n        rangeIsExists: function (range, index) {\n            let _this = this;\n            let isExists = false;\n            let existsIndex = null;    //获取已有交替颜色所有应用范围\n            //获取已有交替颜色所有应用范围\n            let AFarr = $.extend(true, [], Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_alternateformat_save']);\n            if (index != undefined && index != null) {\n                if (AFarr.length > 1) {\n                    AFarr.splice(index, 1);\n                } else {\n                    AFarr = [];\n                }\n            }\n            if (AFarr.length > 0) {\n                let arr = [];\n                for (let i = 0; i < AFarr.length; i++) {\n                    let obj = {\n                        'index': i,\n                        'map': _this.getRangeMap(AFarr[i]['cellrange']['row'], AFarr[i]['cellrange']['column'])\n                    };\n                    arr.push(obj);\n                }    //获取当前选区\n                //获取当前选区\n                let rangeMap = _this.getRangeMap(range['row'], range['column']);    //遍历\n                //遍历\n                for (let x in rangeMap) {\n                    if (isExists) {\n                        break;\n                    }\n                    for (let j = 0; j < arr.length; j++) {\n                        if (x in arr[j]['map']) {\n                            isExists = true;\n                            existsIndex = arr[j]['index'];\n                            break;\n                        }\n                    }\n                }\n            }\n            return [\n                isExists,\n                existsIndex\n            ];\n        },\n        getRangeMap: function (row, column) {\n            let map = {};\n            let st_r = row[0], ed_r = row[1], st_c = column[0], ed_c = column[1];\n            for (let r = st_r; r <= ed_r; r++) {\n                for (let c = st_c; c <= ed_c; c++) {\n                    map[r + '_' + c] = 0;\n                }\n            }\n            return map;\n        },\n        getIndexByFormat: function (format) {\n            let _this = this;\n            let index = null;    //格式样式 模板\n            //格式样式 模板\n            let modelList = _this.FixedModelColor;\n            for (let i = 0; i < modelList.length; i++) {\n                let obj = modelList[i];\n                if (format['head'].fc == obj['head'].fc && format['head'].bc == obj['head'].bc) {\n                    if (format['one'].fc == obj['one'].fc && format['one'].bc == obj['one'].bc) {\n                        if (format['two'].fc == obj['two'].fc && format['two'].bc == obj['two'].bc) {\n                            if (format['foot'].fc == obj['foot'].fc && format['foot'].bc == obj['foot'].bc) {\n                                index = i;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }    //自定义 模板\n            //自定义 模板\n            let modelCustom = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_alternateformat_save_modelCustom'];\n            if (modelCustom != null && modelCustom.length > 0) {\n                for (let j = 0; j < modelCustom.length; j++) {\n                    let obj = modelCustom[j];\n                    if (format['head'].fc == obj['head'].fc && format['head'].bc == obj['head'].bc) {\n                        if (format['one'].fc == obj['one'].fc && format['one'].bc == obj['one'].bc) {\n                            if (format['two'].fc == obj['two'].fc && format['two'].bc == obj['two'].bc) {\n                                if (format['foot'].fc == obj['foot'].fc && format['foot'].bc == obj['foot'].bc) {\n                                    index = modelList.length + j;\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return index;\n        },\n        getFormatByIndex: function () {\n            let _this = this;\n            let index = _this.modelfocusIndex;\n            let len = _this.FixedModelColor.length;\n            let format = {};\n            if (index < len) {\n                format = _this.FixedModelColor[index];\n            } else {\n                format = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)]['luckysheet_alternateformat_save_modelCustom'][index - len];\n            }\n            return format;\n        },\n        new: function (cellrange) {\n            let _this = this;\n            let format = _this.getFormatByIndex();\n            let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            let ruleArr = file['luckysheet_alternateformat_save'];\n            if (ruleArr == null) {\n                ruleArr = [];\n            }    //保存之前的规则\n            //保存之前的规则\n            let historyRules = $.extend(true, [], ruleArr);    //保存当前的规则\n            //保存当前的规则\n            let obj = {\n                'cellrange': {\n                    'row': cellrange['row'],\n                    'column': cellrange['column']\n                },\n                'format': format,\n                'hasRowHeader': true,\n                'hasRowFooter': false\n            };\n            ruleArr.push(obj);\n            let currentRules = $.extend(true, [], ruleArr);    //刷新一次表格\n            //刷新一次表格\n            _this.ref(historyRules, currentRules);\n            if (server.allowUpdate) {\n                server.saveParam('all', Store.currentSheetIndex, ruleArr, { 'k': 'luckysheet_alternateformat_save' });\n            }\n        },\n        update: function () {\n            let _this = this;\n            const _locale = locale();\n            const alternatingColors = _locale.alternatingColors;    //获取标识\n            //获取标识\n            let dataIndex = $('#luckysheet-alternateformat-remove').data('index');    //应用范围\n            //应用范围\n            let rangeValue = $('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input').val().trim();\n            if (!formula.iscelldata(rangeValue)) {\n                if (isEditMode()) {\n                    alert(alternatingColors.errorNoRange);\n                } else {\n                    tooltip.info(alternatingColors.errorNoRange, '');\n                }\n                return;\n            }\n            let cellrange = formula.getcellrange(rangeValue);\n            let isExists = _this.rangeIsExists(cellrange, dataIndex)[0];\n            if (isExists) {\n                if (isEditMode()) {\n                    alert(alternatingColors.errorExistColors);\n                } else {\n                    tooltip.info(alternatingColors.errorExistColors, '');\n                }\n                return;\n            }    //页眉、页脚\n            //页眉、页脚\n            let hasRowHeader;\n            if ($('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowHeader').is(':checked')) {\n                hasRowHeader = true;\n            } else {\n                hasRowHeader = false;\n            }\n            let hasRowFooter;\n            if ($('#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowFooter').is(':checked')) {\n                hasRowFooter = true;\n            } else {\n                hasRowFooter = false;\n            }    //获取选中样式模板的颜色\n            //获取选中样式模板的颜色\n            let format = _this.getFormatByIndex();\n            let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            let ruleArr = file['luckysheet_alternateformat_save'];\n            if (ruleArr == null) {\n                ruleArr = [];\n            }    //保存之前的规则\n            //保存之前的规则\n            let historyRules = $.extend(true, [], ruleArr);    //保存当前的规则\n            //保存当前的规则\n            let obj = {\n                'cellrange': {\n                    'row': cellrange['row'],\n                    'column': cellrange['column']\n                },\n                'format': format,\n                'hasRowHeader': hasRowHeader,\n                'hasRowFooter': hasRowFooter\n            };\n            ruleArr[dataIndex] = obj;\n            let currentRules = $.extend(true, [], ruleArr);    //刷新一次表格\n            //刷新一次表格\n            _this.ref(historyRules, currentRules);\n            if (server.allowUpdate) {\n                server.saveParam('all', Store.currentSheetIndex, ruleArr, { 'k': 'luckysheet_alternateformat_save' });\n            }\n        },\n        checksAF: function (r, c, computeMap) {\n            if (r + '_' + c in computeMap) {\n                //返回值（fc  bc）\n                return computeMap[r + '_' + c];\n            } else {\n                return null;\n            }\n        },\n        getComputeMap: function () {\n            let file = Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)];\n            let ruleArr = file['luckysheet_alternateformat_save'];\n            let computeMap = this.compute(ruleArr);\n            return computeMap;\n        },\n        compute: function (obj) {\n            //计算存储\n            let computeMap = {};\n            if (obj != null && obj.length > 0) {\n                for (let i = 0; i < obj.length; i++) {\n                    let cellrange = obj[i]['cellrange'];\n                    let format = obj[i]['format'];\n                    let hasRowHeader = obj[i]['hasRowHeader'];\n                    let hasRowFooter = obj[i]['hasRowFooter'];\n                    let st_r = cellrange['row'][0], ed_r = cellrange['row'][1], st_c = cellrange['column'][0], ed_c = cellrange['column'][1];\n                    if (hasRowHeader && hasRowFooter) {\n                        //页眉所在行\n                        for (let c = st_c; c <= ed_c; c++) {\n                            computeMap[st_r + '_' + c] = [\n                                format['head'].fc,\n                                format['head'].bc\n                            ];\n                        }    //中间行\n                        //中间行\n                        if (ed_r - st_r > 1) {\n                            for (let r = st_r + 1; r < ed_r; r++) {\n                                let fc, bc;\n                                if ((r - st_r) % 2 != 0) {\n                                    fc = format['one'].fc;\n                                    bc = format['one'].bc;\n                                } else {\n                                    fc = format['two'].fc;\n                                    bc = format['two'].bc;\n                                }\n                                for (let c = st_c; c <= ed_c; c++) {\n                                    computeMap[r + '_' + c] = [\n                                        fc,\n                                        bc\n                                    ];\n                                }\n                            }\n                        }    //页脚所在行\n                        //页脚所在行\n                        if (ed_r > st_r) {\n                            for (let c = st_c; c <= ed_c; c++) {\n                                computeMap[ed_r + '_' + c] = [\n                                    format['foot'].fc,\n                                    format['foot'].bc\n                                ];\n                            }\n                        }\n                    } else if (hasRowHeader) {\n                        //页眉所在行\n                        for (let c = st_c; c <= ed_c; c++) {\n                            computeMap[st_r + '_' + c] = [\n                                format['head'].fc,\n                                format['head'].bc\n                            ];\n                        }    //中间行\n                        //中间行\n                        if (ed_r > st_r) {\n                            for (let r = st_r + 1; r <= ed_r; r++) {\n                                let fc, bc;\n                                if ((r - st_r) % 2 != 0) {\n                                    fc = format['one'].fc;\n                                    bc = format['one'].bc;\n                                } else {\n                                    fc = format['two'].fc;\n                                    bc = format['two'].bc;\n                                }\n                                for (let c = st_c; c <= ed_c; c++) {\n                                    computeMap[r + '_' + c] = [\n                                        fc,\n                                        bc\n                                    ];\n                                }\n                            }\n                        }\n                    } else if (hasRowFooter) {\n                        //中间行\n                        if (ed_r > st_r) {\n                            for (let r = st_r; r < ed_r; r++) {\n                                let fc, bc;\n                                if ((r - st_r) % 2 == 0) {\n                                    fc = format['one'].fc;\n                                    bc = format['one'].bc;\n                                } else {\n                                    fc = format['two'].fc;\n                                    bc = format['two'].bc;\n                                }\n                                for (let c = st_c; c <= ed_c; c++) {\n                                    computeMap[r + '_' + c] = [\n                                        fc,\n                                        bc\n                                    ];\n                                }\n                            }\n                        }    //页脚所在行\n                        //页脚所在行\n                        for (let c = st_c; c <= ed_c; c++) {\n                            computeMap[ed_r + '_' + c] = [\n                                format['foot'].fc,\n                                format['foot'].bc\n                            ];\n                        }\n                    } else {\n                        //中间行\n                        for (let r = st_r; r <= ed_r; r++) {\n                            let fc, bc;\n                            if ((r - st_r) % 2 == 0) {\n                                fc = format['one'].fc;\n                                bc = format['one'].bc;\n                            } else {\n                                fc = format['two'].fc;\n                                bc = format['two'].bc;\n                            }\n                            for (let c = st_c; c <= ed_c; c++) {\n                                computeMap[r + '_' + c] = [\n                                    fc,\n                                    bc\n                                ];\n                            }\n                        }\n                    }\n                }\n            }\n            return computeMap;\n        },\n        ref: function (historyRules, currentRules) {\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                let redo = {};\n                redo['type'] = 'updateAF';\n                redo['sheetIndex'] = Store.currentSheetIndex;\n                redo['data'] = {\n                    'historyRules': historyRules,\n                    'currentRules': currentRules\n                };\n                Store.jfredo.push(redo);\n            }\n            let index = getSheetIndex(Store.currentSheetIndex);\n            Store.luckysheetfile[index]['luckysheet_alternateformat_save'] = currentRules;\n            setTimeout(function () {\n                luckysheetrefreshgrid();\n            }, 1);\n        }\n    };\n    return alternateformat;\n});"]}