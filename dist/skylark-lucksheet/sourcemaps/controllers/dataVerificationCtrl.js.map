{"version":3,"sources":["controllers/dataVerificationCtrl.js"],"names":["define","m_util","formula","m_validate","m_datecontroll","m_refresh","tooltip","m_setdata","m_getdata","editor","m_constant","m_select","server","menuButton","sheetmanage","m_get","locale","Store","replaceHtml","isRealNum","isRealNull","isdatetime","diff","luckysheetrefreshgrid","setcellvalue","getcellvalue","modelHTML","selectionCopyShow","getSheetIndex","getRangetxt","defaultItem","type","type2","value1","value2","checked","remote","prohibitInput","hintShow","hintText","curItem","dataVerification","selectRange","selectStatus","optionLabel","number","number_integer","number_decimal","bw","nb","eq","ne","gt","lt","gte","lte","include","exclude","equal","bf","nbf","af","naf","card","phone","optionLabel_en","createDialog","_locale","dvText","toolbarText","toolbar","buttonText","button","$","show","remove","content","cellRange","selectCellRange","verificationCondition","dropdown","checkbox","text_content","text_length","date","validity","placeholder1","selected","placeholder2","notSelected","between","notBetween","notEqualTo","moreThanThe","lessThan","greaterOrEqualTo","lessThanOrEqualTo","placeholder3","placeholder4","earlierThan","noEarlierThan","laterThan","noLaterThan","identificationNumber","phoneNumber","placeholder5","append","id","addclass","title","botton","confirm","deleteVerification","cancel","style","$t","find","css","end","myh","outerHeight","myw","outerWidth","winw","window","width","winh","height","scrollLeft","document","scrollTop","left","top","this","dataAllocation","init","_this","off","on","e","dropdownListShow","stopPropagation","hide","value","target","innerText","last","luckysheet_select_save","length","rowIndex","row_focus","colIndex","column_focus","text","updatecell","txt","siblings","val","trim","rangeDialog","range","getRangeByTxt","rangetosheet","currentSheetIndex","sheetIndex","changeSheetExec","s","r1","row","r2","c1","column","c2","visibledatarow","row_pre","col","visibledatacolumn","col_pre","push","left_move","width_move","top_move","height_move","dataSource","attr","parents","info","item","rangeTxt","selectCellRange2","str","edr","stc","edc","d","deepCopyFlowData","flowdata","tooltipInfo1","tooltipInfo2","tooltipInfo3","Number","tooltipInfo4","tooltipInfo5","tooltipInfo6","tooltipInfo7","is","historyDataVerification","extend","currentDataVerification","r","c","refOfCheckbox","ref","prop","close","getTxtByRange","join","indexOf","arr","split","i","iscelldata","getcellrange","cellFocus","clickMode","margeset","mergeborer","checkboxChange","max-width","max-height","lang","getHintText","html","cellValue","validateCellData","failureText","getFailureText","list","getDropdownList","result","toString","test","optionHtml","forEach","scrollHeight","luckysheetfile","data","cell","v","m","includes","clearjfundo","jfundo","redo","jfredo","allowUpdate","saveParam","k","setTimeout","webWorkerFlowDataCache","historyParam"],"mappings":"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","file":"../../controllers/dataVerificationCtrl.js","sourcesContent":["define([\n    '../utils/util',\n    '../global/formula',\n    '../global/validate',\n    '../global/datecontroll',\n    '../global/refresh',\n    '../global/tooltip',\n    '../global/setdata',\n    '../global/getdata',\n    '../global/editor',\n    './constant',\n    './select',\n    './server',\n    './menuButton',\n    './sheetmanage',\n    '../methods/get',\n    '../locale/locale',\n    '../store'\n], function (m_util, formula, m_validate, m_datecontroll, m_refresh, tooltip, m_setdata, m_getdata, editor, m_constant, m_select, server, menuButton, sheetmanage, m_get, locale, Store) {\n    'use strict';\n    const {replaceHtml} = m_util;\n    const {isRealNum, isRealNull} = m_validate;\n    const {isdatetime, diff} = m_datecontroll;\n    const {luckysheetrefreshgrid} = m_refresh;\n    const {setcellvalue} = m_setdata;\n    const {getcellvalue} = m_getdata;\n    const {modelHTML} = m_constant;\n    const {selectionCopyShow} = m_select;\n    const {getSheetIndex, getRangetxt} = m_get;\n    const dataVerificationCtrl = {\n        defaultItem: {\n            type: 'dropdown',\n            //类型\n            type2: null,\n            //\n            value1: '',\n            //\n            value2: '',\n            //\n            checked: false,\n            remote: false,\n            //自动远程获取选项\n            prohibitInput: false,\n            //输入数据无效时禁止输入\n            hintShow: false,\n            //选中单元格时显示提示语\n            hintText: ''\n        },\n        //\n        curItem: null,\n        dataVerification: null,\n        selectRange: [],\n        selectStatus: false,\n        optionLabel: {\n            'number': '数值',\n            'number_integer': '整数',\n            'number_decimal': '小数',\n            'bw': '介于',\n            'nb': '不介于',\n            'eq': '等于',\n            'ne': '不等于',\n            'gt': '大于',\n            'lt': '小于',\n            'gte': '大于等于',\n            'lte': '小于等于',\n            'include': '包括',\n            'exclude': '不包括',\n            'equal': '等于',\n            'bf': '早于',\n            'nbf': '不早于',\n            'af': '晚于',\n            'naf': '不晚于',\n            'card': '身份证号码',\n            'phone': '手机号'\n        },\n        optionLabel_en: {\n            'number': 'numeric',\n            'number_integer': 'integer',\n            'number_decimal': 'decimal',\n            'bw': 'between',\n            'nb': 'not between',\n            'eq': 'equal to',\n            'ne': 'not equal to',\n            'gt': 'greater',\n            'lt': 'less than',\n            'gte': 'greater or equal to',\n            'lte': 'less than or equal to',\n            'include': 'include',\n            'exclude': 'not include',\n            'equal': 'equal to',\n            'bf': 'earlier than',\n            'nbf': 'not earlier than',\n            'af': 'later than',\n            'naf': 'not later than',\n            'card': 'identification number',\n            'phone': 'phone number'\n        },\n        createDialog: function () {\n            let _this = this;\n            const _locale = locale();\n            const dvText = _locale.dataVerification;\n            const toolbarText = _locale.toolbar;\n            const buttonText = _locale.button;\n            $('#luckysheet-modal-dialog-mask').show();\n            $('#luckysheet-dataVerification-dialog').remove();\n            let content = `<div class=\"box\">\n                            <div class=\"box-item\" style=\"border-top:1px solid #E1E4E8;\">\n                                <div class=\"box-item-title\">${ dvText.cellRange }</div>\n                                <div id=\"data-verification-range\" class=\"range\">\n                                    <input class=\"formulaInputFocus\" spellcheck=\"false\">\n                                    <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ dvText.selectCellRange }\"></i>\n                                </div>\n                            </div>\n                            <div class=\"box-item\">\n                                <div class=\"box-item-title\">${ dvText.verificationCondition }</div>\n                                <select id=\"data-verification-type-select\">\n                                    <option value=\"dropdown\">${ dvText.dropdown }</option>\n                                    <option value=\"checkbox\">${ dvText.checkbox }</option>\n                                    <option value=\"number\">${ dvText.number }</option>\n                                    <option value=\"number_integer\">${ dvText.number_integer }</option>\n                                    <option value=\"number_decimal\">${ dvText.number_decimal }</option>\n                                    <option value=\"text_content\">${ dvText.text_content }</option>\n                                    <option value=\"text_length\">${ dvText.text_length }</option>\n                                    <option value=\"date\">${ dvText.date }</option>\n                                    <option value=\"validity\">${ dvText.validity }</option>\n                                </select>\n                                <div class=\"show-box\">\n                                    <div class=\"show-box-item show-box-item-dropdown\">\n                                        <div class=\"range\">\n                                            <input class=\"formulaInputFocus data-verification-value1\" placeholder=\"${ dvText.placeholder1 }\" spellcheck=\"false\">\n                                            <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ dvText.selectCellRange }\"></i>\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-checkbox\">\n                                        <div class=\"check-box\">\n                                            <span>${ dvText.selected } ——</span>\n                                            <input type=\"text\" class=\"data-verification-value1\" placeholder=\"${ dvText.placeholder2 }\">\n                                        </div>\n                                        <div class=\"check-box\">\n                                            <span>${ dvText.notSelected } ——</span>\n                                            <input type=\"text\" class=\"data-verification-value2\" placeholder=\"${ dvText.placeholder2 }\">\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-number\">\n                                        <select id=\"data-verification-number-select\">\n                                            <option value=\"bw\">${ dvText.between }</option>\n                                            <option value=\"nb\">${ dvText.notBetween }</option>\n                                            <option value=\"eq\">${ dvText.equal }</option>\n                                            <option value=\"ne\">${ dvText.notEqualTo }</option>\n                                            <option value=\"gt\">${ dvText.moreThanThe }</option>\n                                            <option value=\"lt\">${ dvText.lessThan }</option>\n                                            <option value=\"gte\">${ dvText.greaterOrEqualTo }</option>\n                                            <option value=\"lte\">${ dvText.lessThanOrEqualTo }</option>\n                                        </select>\n                                        <div class=\"input input1\">\n                                            <input type=\"number\" class=\"data-verification-value1\" placeholder=\"1\">\n                                            <span>-</span>\n                                            <input type=\"number\" class=\"data-verification-value2\" placeholder=\"100\">\n                                        </div>\n                                        <div class=\"input input2\">\n                                            <input type=\"number\" class=\"data-verification-value1\" placeholder=\"${ dvText.placeholder3 }\">\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-text\">\n                                        <select id=\"data-verification-text-select\">\n                                            <option value=\"include\">${ dvText.include }</option>\n                                            <option value=\"exclude\">${ dvText.exclude }</option>\n                                            <option value=\"equal\">${ dvText.equal }</option>\n                                        </select>\n                                        <div class=\"input input2\">\n                                            <input type=\"text\" class=\"data-verification-value1\" placeholder=\"${ dvText.placeholder4 }\"/>\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-textLength\">\n                                        <select id=\"data-verification-textLength-select\">\n                                            <option value=\"bw\">${ dvText.between }</option>\n                                            <option value=\"nb\">${ dvText.notBetween }</option>\n                                            <option value=\"eq\">${ dvText.equal }</option>\n                                            <option value=\"ne\">${ dvText.notEqualTo }</option>\n                                            <option value=\"gt\">${ dvText.moreThanThe }</option>\n                                            <option value=\"lt\">${ dvText.lessThan }</option>\n                                            <option value=\"gte\">${ dvText.greaterOrEqualTo }</option>\n                                            <option value=\"lte\">${ dvText.lessThanOrEqualTo }</option>\n                                        </select>\n                                        <div class=\"input input1\">\n                                            <input type=\"number\" class=\"data-verification-value1\" placeholder=\"1\">\n                                            <span>-</span>\n                                            <input type=\"number\" class=\"data-verification-value2\" placeholder=\"100\">\n                                        </div>\n                                        <div class=\"input input2\">\n                                            <input type=\"number\" class=\"data-verification-value1\" placeholder=\"${ dvText.placeholder3 }\">\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-date\">\n                                        <select id=\"data-verification-date-select\">\n                                            <option value=\"bw\">${ dvText.between }</option>\n                                            <option value=\"nb\">${ dvText.notBetween }</option>\n                                            <option value=\"eq\">${ dvText.equal }</option>\n                                            <option value=\"ne\">${ dvText.notEqualTo }</option>\n                                            <option value=\"bf\">${ dvText.earlierThan }</option>\n                                            <option value=\"nbf\">${ dvText.noEarlierThan }</option>\n                                            <option value=\"af\">${ dvText.laterThan }</option>\n                                            <option value=\"naf\">${ dvText.noLaterThan }</option>\n                                        </select>\n                                        <div class=\"input input1\">\n                                            <input type=\"date\" class=\"data-verification-value1\" placeholder=\"2020/9/10\">\n                                            <span>-</span>\n                                            <input type=\"date\" class=\"data-verification-value2\" placeholder=\"2020/9/10\">\n                                        </div>\n                                        <div class=\"input input2\">\n                                            <input type=\"date\" class=\"data-verification-value1\" placeholder=\"2020/9/10\">\n                                        </div>\n                                    </div>\n                                    <div class=\"show-box-item show-box-item-validity\">\n                                        <select id=\"data-verification-validity-select\">\n                                            <option value=\"card\">${ dvText.identificationNumber }</option>\n                                            <option value=\"phone\">${ dvText.phoneNumber }</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"box-item\">\n                                <div class=\"check\">\n                                    <input type=\"checkbox\" id=\"data-verification-remote\" class=\"data-verification-remote\">\n                                    <label for=\"data-verification-remote\">${ dvText.remote }</label>\n                                </div>\n                                <div class=\"check\">\n                                    <input type=\"checkbox\" id=\"data-verification-prohibitInput\">\n                                    <label for=\"data-verification-prohibitInput\">${ dvText.prohibitInput }</label>\n                                </div>\n                                <div class=\"check\">\n                                    <input type=\"checkbox\" id=\"data-verification-hint-show\">\n                                    <label for=\"data-verification-hint-show\">${ dvText.hintShow }</label>\n                                </div>\n                                <div class=\"data-verification-hint-text\">\n                                    <input type=\"text\" placeholder=\"${ dvText.placeholder5 }\">\n                                </div>\n                            </div>\n                        </div>`;\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-dataVerification-dialog',\n                'addclass': 'luckysheet-dataVerification-dialog',\n                'title': toolbarText.dataVerification,\n                'content': content,\n                'botton': `<button id=\"luckysheet-dataVerification-dialog-confirm\" class=\"btn btn-primary\">${ buttonText.confirm }</button>\n                        <button id=\"luckysheet-dataVerification-dialog-delete\" class=\"btn btn-default\">${ dvText.deleteVerification }</button>\n                        <button class=\"btn btn-default luckysheet-model-close-btn\">${ buttonText.cancel }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-dataVerification-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 350).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-dataVerification-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n            _this.dataAllocation();\n        },\n        init: function () {\n            let _this = this;\n            const dvText = locale().dataVerification;    //单元格数据验证 类型是 下拉列表\n            //单元格数据验证 类型是 下拉列表\n            $(document).off('click.dropdownBtn').on('click.dropdownBtn', '#luckysheet-dataVerification-dropdown-btn', function (e) {\n                _this.dropdownListShow();\n                e.stopPropagation();\n            });\n            $(document).off('click.dropdownListItem').on('click.dropdownListItem', '#luckysheet-dataVerification-dropdown-List .dropdown-List-item', function (e) {\n                $('#luckysheet-dataVerification-dropdown-List').hide();\n                let value = e.target.innerText;\n                let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                let rowIndex = last.row_focus;\n                let colIndex = last.column_focus;\n                $('#luckysheet-rich-text-editor').text(value);\n                formula.updatecell(rowIndex, colIndex);\n                e.stopPropagation();\n            });    //单元格范围\n            //单元格范围\n            $(document).off('click.dvRange').on('click.dvRange', '#data-verification-range .fa-table', function (e) {\n                $('#luckysheet-dataVerification-dialog').hide();\n                let dataSource = '0';\n                let txt = $(this).siblings('input').val().trim();\n                _this.rangeDialog(dataSource, txt);\n                _this.selectRange = [];\n                let range = _this.getRangeByTxt(txt);\n                formula.rangetosheet = Store.currentSheetIndex;\n                if (range[0].sheetIndex != Store.currentSheetIndex) {\n                    sheetmanage.changeSheetExec(range[0].sheetIndex);\n                }\n                if (range.length > 0) {\n                    for (let s = 0; s < range.length; s++) {\n                        let r1 = range[s].row[0], r2 = range[s].row[1];\n                        let c1 = range[s].column[0], c2 = range[s].column[1];\n                        let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                        let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                        _this.selectRange.push({\n                            'left': col_pre,\n                            'width': col - col_pre - 1,\n                            'top': row_pre,\n                            'height': row - row_pre - 1,\n                            'left_move': col_pre,\n                            'width_move': col - col_pre - 1,\n                            'top_move': row_pre,\n                            'height_move': row - row_pre - 1,\n                            'row': [\n                                r1,\n                                r2\n                            ],\n                            'column': [\n                                c1,\n                                c2\n                            ],\n                            'row_focus': r1,\n                            'column_focus': c1\n                        });\n                    }\n                }\n                selectionCopyShow(_this.selectRange);\n            });\n            $(document).off('click.dvRange2').on('click.dvRange2', '#luckysheet-dataVerification-dialog .show-box-item-dropdown .range .fa-table', function (e) {\n                $('#luckysheet-dataVerification-dialog').hide();\n                let dataSource = '1';\n                let txt = $(this).siblings('input').val().trim();\n                _this.rangeDialog(dataSource, txt);\n                _this.selectRange = [];\n                let range = _this.getRangeByTxt(txt);\n                formula.rangetosheet = Store.currentSheetIndex;\n                if (range[0].sheetIndex != Store.currentSheetIndex) {\n                    sheetmanage.changeSheetExec(range[0].sheetIndex);\n                }\n                if (range.length > 0) {\n                    for (let s = 0; s < range.length; s++) {\n                        let r1 = range[s].row[0], r2 = range[s].row[1];\n                        let c1 = range[s].column[0], c2 = range[s].column[1];\n                        let row = Store.visibledatarow[r2], row_pre = r1 - 1 == -1 ? 0 : Store.visibledatarow[r1 - 1];\n                        let col = Store.visibledatacolumn[c2], col_pre = c1 - 1 == -1 ? 0 : Store.visibledatacolumn[c1 - 1];\n                        _this.selectRange.push({\n                            'left': col_pre,\n                            'width': col - col_pre - 1,\n                            'top': row_pre,\n                            'height': row - row_pre - 1,\n                            'left_move': col_pre,\n                            'width_move': col - col_pre - 1,\n                            'top_move': row_pre,\n                            'height_move': row - row_pre - 1,\n                            'row': [\n                                r1,\n                                r2\n                            ],\n                            'column': [\n                                c1,\n                                c2\n                            ],\n                            'row_focus': r1,\n                            'column_focus': c1\n                        });\n                    }\n                }\n                selectionCopyShow(_this.selectRange);\n            });\n            $(document).off('click.dvRangeConfirm').on('click.dvRangeConfirm', '#luckysheet-dataVerificationRange-dialog-confirm', function (e) {\n                let dataSource = $(this).attr('data-source');\n                let txt = $(this).parents('#luckysheet-dataVerificationRange-dialog').find('input').val();\n                if (_this.getRangeByTxt(txt).length > 1) {\n                    tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', '不能对多重选择区域执行此操作\\uFF0C请选择单个区域\\uFF0C然后再试');\n                    return;\n                }\n                if (dataSource == '0') {\n                    $('#luckysheet-dataVerification-dialog #data-verification-range input').val(txt);\n                } else if (dataSource == '1') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-dropdown .range input').val(txt);\n                }\n                $('#luckysheet-dataVerificationRange-dialog').hide();\n                $('#luckysheet-modal-dialog-mask').show();\n                $('#luckysheet-dataVerification-dialog').show();\n                if (formula.rangetosheet != null && formula.rangetosheet != Store.currentSheetIndex) {\n                    sheetmanage.changeSheetExec(formula.rangetosheet);\n                    formula.rangetosheet = null;\n                }\n                let range = [];\n                selectionCopyShow(range);\n            });\n            $(document).off('click.dvRangeClose').on('click.dvRangeClose', '#luckysheet-dataVerificationRange-dialog-close', function (e) {\n                $('#luckysheet-dataVerificationRange-dialog').hide();\n                $('#luckysheet-modal-dialog-mask').show();\n                $('#luckysheet-dataVerification-dialog').show();\n                if (formula.rangetosheet != null && formula.rangetosheet != Store.currentSheetIndex) {\n                    sheetmanage.changeSheetExec(formula.rangetosheet);\n                    formula.rangetosheet = null;\n                }\n                let range = [];\n                selectionCopyShow(range);\n            });\n            $(document).on('click', '#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close', function (e) {\n                $('#luckysheet-dataVerificationRange-dialog').hide();\n                $('#luckysheet-modal-dialog-mask').show();\n                $('#luckysheet-dataVerification-dialog').show();\n                if (formula.rangetosheet != null && formula.rangetosheet != Store.currentSheetIndex) {\n                    sheetmanage.changeSheetExec(formula.rangetosheet);\n                    formula.rangetosheet = null;\n                }\n                let range = [];\n                selectionCopyShow(range);\n            });    //验证条件 下拉框\n            //验证条件 下拉框\n            $(document).off('change.typeSelect').on('change.typeSelect', '#data-verification-type-select', function (e) {\n                $('#luckysheet-dataVerification-dialog .show-box .show-box-item').hide();\n                let value = this.value;\n                let item = _this.curItem;\n                if (value == 'dropdown') {\n                    $('#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown').show();\n                    let value1 = '';\n                    if (value == item.type) {\n                        value1 = item.value1;\n                    }\n                    $('#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1').val(value1);\n                } else if (value == 'checkbox') {\n                    $('#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox').show();\n                    let value1 = '';\n                    let value2 = '';\n                    if (value == item.type) {\n                        value1 = item.value1;\n                        value2 = item.value2;\n                    }\n                    $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1').val(value1);\n                    $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2').val(value2);\n                } else if (value == 'number' || value == 'number_integer' || value == 'number_decimal') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number').show();\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .input').hide();\n                    let type2 = 'bw';\n                    let value1 = '';\n                    let value2 = '';\n                    if (item.type == 'number' || item.type == 'number_integer' || item.type == 'number_decimal') {\n                        type2 = item.type2;\n                        value1 = item.value1;\n                        value2 = item.value2;\n                    }\n                    $('#luckysheet-dataVerification-dialog #data-verification-number-select').val(type2);\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-number .input1').show();\n                    } else {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-number .input2').show();\n                    }\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1').val(value1);\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2').val(value2);\n                } else if (value == 'text_content') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-text').show();\n                    let type2 = 'include';\n                    let value1 = '';\n                    if (value == item.type) {\n                        type2 = item.type2;\n                        value1 = item.value1;\n                    }\n                    $('#luckysheet-dataVerification-dialog #data-verification-text-select').val(type2);\n                    $('#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1').val(value1);\n                } else if (value == 'text_length') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength').show();\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input').hide();\n                    let type2 = 'bw';\n                    let value1 = '';\n                    let value2 = '';\n                    if (value == item.type) {\n                        type2 = item.type2;\n                        value1 = item.value1;\n                        value2 = item.value2;\n                    }\n                    $('#luckysheet-dataVerification-dialog #data-verification-textLength-select').val(type2);\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input1').show();\n                    } else {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input2').show();\n                    }\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1').val(value1);\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2').val(value2);\n                } else if (value == 'date') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date').show();\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .input').hide();\n                    let type2 = 'bw';\n                    let value1 = '';\n                    let value2 = '';\n                    if (value == item.type) {\n                        type2 = item.type2;\n                        value1 = item.value1;\n                        value2 = item.value2;\n                    }\n                    $('#luckysheet-dataVerification-dialog #data-verification-date-select').val(type2);\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-date .input1').show();\n                    } else {\n                        $('#luckysheet-dataVerification-dialog .show-box-item-date .input2').show();\n                    }\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1').val(value1);\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2').val(value2);\n                } else if (value == 'validity') {\n                    $('#luckysheet-dataVerification-dialog .show-box .show-box-item-validity').show();\n                    let type2 = 'card';\n                    if (value == item.type) {\n                        type2 = item.type2;\n                    }\n                    $('#luckysheet-dataVerification-dialog #data-verification-validity-select').val(type2);\n                }\n            });\n            $(document).off('change.numberSelect').on('change.numberSelect', '#data-verification-number-select', function (e) {\n                $('#luckysheet-dataVerification-dialog .show-box-item-number .input').hide();\n                let value = this.value;\n                if (value == 'bw' || value == 'nb') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .input1').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .input2').show();\n                }\n            });\n            $(document).off('change.dateSelect').on('change.dateSelect', '#data-verification-date-select', function (e) {\n                $('#luckysheet-dataVerification-dialog .show-box-item-date .input').hide();\n                let value = this.value;\n                if (value == 'bw' || value == 'nb') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .input1').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .input2').show();\n                }\n            });    //选中单元格时显示提示语\n            //选中单元格时显示提示语\n            $(document).off('change.hintShow').on('change.hintShow', '#data-verification-hint-show', function (e) {\n                if (this.checked) {\n                    $('#luckysheet-dataVerification-dialog .data-verification-hint-text').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .data-verification-hint-text').hide();\n                }\n            });    //确认按钮\n            //确认按钮\n            $(document).off('click.dvSaveConfirm').on('click.dvSaveConfirm', '#luckysheet-dataVerification-dialog-confirm', function (e) {\n                let rangeTxt = $('#luckysheet-dataVerification-dialog #data-verification-range input').val().trim();\n                let range = _this.getRangeByTxt(rangeTxt);\n                if (range.length == 0) {\n                    tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.selectCellRange2);\n                    return;\n                }\n                let str = range[range.length - 1].row[0], edr = range[range.length - 1].row[1], stc = range[range.length - 1].column[0], edc = range[range.length - 1].column[1];\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                if (str < 0) {\n                    str = 0;\n                }\n                if (edr > d.length - 1) {\n                    edr = d.length - 1;\n                }\n                if (stc < 0) {\n                    stc = 0;\n                }\n                if (edc > d[0].length - 1) {\n                    edc = d[0].length - 1;\n                }\n                let type = $('#luckysheet-dataVerification-dialog #data-verification-type-select').val();\n                let type2 = null, value1 = '', value2 = '';\n                if (type == 'dropdown') {\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1').val().trim();\n                    if (value1.length == 0) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo1);\n                        return;\n                    }\n                } else if (type == 'checkbox') {\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1').val().trim();\n                    value2 = $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2').val().trim();\n                    if (value1.length == 0 || value2.length == 0) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo2);\n                        return;\n                    }\n                } else if (type == 'number' || type == 'number_integer' || type == 'number_decimal') {\n                    type2 = $('#luckysheet-dataVerification-dialog #data-verification-number-select').val();\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value1').val().trim();\n                    if (!isRealNum(value1)) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo3);\n                        return;\n                    }\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        value2 = $('#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value2').val().trim();\n                        if (!isRealNum(value2)) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo3);\n                            return;\n                        }\n                        if (Number(value2) < Number(value1)) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo4);\n                            return;\n                        }\n                    }\n                } else if (type == 'text_content') {\n                    type2 = $('#luckysheet-dataVerification-dialog #data-verification-text-select').val();\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1').val().trim();\n                    if (value1.length == 0) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo5);\n                        return;\n                    }\n                } else if (type == 'text_length') {\n                    type2 = $('#luckysheet-dataVerification-dialog #data-verification-textLength-select').val();\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value1').val().trim();\n                    if (!isRealNum(value1)) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo3);\n                        return;\n                    }\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        value2 = $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value2').val().trim();\n                        if (!isRealNum(value2)) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo3);\n                            return;\n                        }\n                        if (Number(value2) < Number(value1)) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo4);\n                            return;\n                        }\n                    }\n                } else if (type == 'date') {\n                    type2 = $('#luckysheet-dataVerification-dialog #data-verification-date-select').val();\n                    value1 = $('#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value1').val().trim();\n                    if (!isdatetime(value1)) {\n                        tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo6);\n                        return;\n                    }\n                    if (type2 == 'bw' || type2 == 'nb') {\n                        value2 = $('#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value2').val().trim();\n                        if (!isdatetime(value2)) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo6);\n                            return;\n                        }\n                        if (diff(value1, value2) > 0) {\n                            tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.tooltipInfo7);\n                            return;\n                        }\n                    }\n                } else if (type == 'validity') {\n                    type2 = $('#luckysheet-dataVerification-dialog #data-verification-validity-select').val();\n                }\n                let remote = $('#luckysheet-dataVerification-dialog #data-verification-remote').is(':checked');\n                let prohibitInput = $('#luckysheet-dataVerification-dialog #data-verification-prohibitInput').is(':checked');\n                let hintShow = $('#luckysheet-dataVerification-dialog #data-verification-hint-show').is(':checked');\n                let hintText = '';\n                if (hintShow) {\n                    hintText = $('#luckysheet-dataVerification-dialog .data-verification-hint-text input').val().trim();\n                }\n                let item = {\n                    type: type,\n                    type2: type2,\n                    value1: value1,\n                    value2: value2,\n                    checked: false,\n                    remote: remote,\n                    prohibitInput: prohibitInput,\n                    hintShow: hintShow,\n                    hintText: hintText\n                };\n                let historyDataVerification = $.extend(true, {}, _this.dataVerification);\n                let currentDataVerification = $.extend(true, {}, _this.dataVerification);\n                for (let r = str; r <= edr; r++) {\n                    for (let c = stc; c <= edc; c++) {\n                        currentDataVerification[r + '_' + c] = item;\n                        if (type == 'checkbox') {\n                            setcellvalue(r, c, d, item.value2);\n                        }\n                    }\n                }\n                if (type == 'checkbox') {\n                    _this.refOfCheckbox(historyDataVerification, currentDataVerification, Store.currentSheetIndex, d, range[range.length - 1]);\n                } else {\n                    _this.ref(historyDataVerification, currentDataVerification, Store.currentSheetIndex);\n                }\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-dataVerification-dialog').hide();\n            });    //删除验证按钮\n            //删除验证按钮\n            $(document).off('click.delete').on('click.delete', '#luckysheet-dataVerification-dialog-delete', function (e) {\n                let rangeTxt = $('#luckysheet-dataVerification-dialog #data-verification-range input').val().trim();\n                let range = _this.getRangeByTxt(rangeTxt);\n                if (range.length == 0) {\n                    tooltip.info('<i class=\"fa fa-exclamation-triangle\"></i>', dvText.selectCellRange2);\n                    return;\n                }\n                let historyDataVerification = $.extend(true, {}, _this.dataVerification);\n                let currentDataVerification = $.extend(true, {}, _this.dataVerification);\n                let str = range[range.length - 1].row[0], edr = range[range.length - 1].row[1], stc = range[range.length - 1].column[0], edc = range[range.length - 1].column[1];\n                for (let r = str; r <= edr; r++) {\n                    for (let c = stc; c <= edc; c++) {\n                        delete currentDataVerification[r + '_' + c];\n                    }\n                }\n                _this.ref(historyDataVerification, currentDataVerification, Store.currentSheetIndex);\n                $('#luckysheet-modal-dialog-mask').hide();\n                $('#luckysheet-dataVerification-dialog').hide();\n            });    //info提示弹框 关闭\n            //info提示弹框 关闭\n            $(document).on('click', '#luckysheet-info .luckysheet-modal-dialog-title-close, #luckysheet-info .luckysheet-model-close-btn', function (e) {\n                $(this).parents('#luckysheet-info').hide();\n                if ($('#luckysheet-dataVerification-dialog').is(':visible')) {\n                    $('#luckysheet-modal-dialog-mask').show();\n                }\n                e.stopPropagation();\n            });\n        },\n        dataAllocation: function () {\n            let _this = this;    //单元格范围\n            //单元格范围\n            let range = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n            let rangeTxt = getRangetxt(Store.currentSheetIndex, range, Store.currentSheetIndex);\n            $('#luckysheet-dataVerification-dialog #data-verification-range input').val(rangeTxt);    //focus单元格\n            //focus单元格\n            let rowIndex = range.row_focus || range.row[0];\n            let colIndex = range.column_focus || range.column[0];\n            let dataVerification = $.extend(true, {}, _this.dataVerification);\n            let item = dataVerification[rowIndex + '_' + colIndex];\n            if (item == null) {\n                item = $.extend(true, {}, _this.defaultItem);\n            }\n            _this.curItem = item;    //验证条件\n            //验证条件\n            $('#luckysheet-dataVerification-dialog #data-verification-type-select').val(item.type);\n            $('#luckysheet-dataVerification-dialog .show-box .show-box-item').hide();\n            if (item.type == 'dropdown') {\n                $('#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown').show();\n                $('#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1').val(item.value1);\n            } else if (item.type == 'checkbox') {\n                $('#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox').show();\n                $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1').val(item.value1);\n                $('#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2').val(item.value2);\n            } else if (item.type == 'number' || item.type == 'number_integer' || item.type == 'number_decimal') {\n                $('#luckysheet-dataVerification-dialog .show-box-item-number').show();\n                $('#luckysheet-dataVerification-dialog #data-verification-number-select').val(item.type2);\n                $('#luckysheet-dataVerification-dialog .show-box-item-number .input').hide();\n                if (item.type2 == 'bw' || item.type2 == 'nb') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .input1').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-number .input2').show();\n                }\n                $('#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1').val(item.value1);\n                $('#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2').val(item.value2);\n            } else if (item.type == 'text_content') {\n                $('#luckysheet-dataVerification-dialog .show-box-item-text').show();\n                $('#luckysheet-dataVerification-dialog #data-verification-text-select').val(item.type2);\n                $('#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1').val(item.value1);\n            } else if (item.type == 'text_length') {\n                $('#luckysheet-dataVerification-dialog .show-box-item-textLength').show();\n                $('#luckysheet-dataVerification-dialog #data-verification-textLength-select').val(item.type2);\n                $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input').hide();\n                if (item.type2 == 'bw' || item.type2 == 'nb') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input1').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-textLength .input2').show();\n                }\n                $('#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1').val(item.value1);\n                $('#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2').val(item.value2);\n            } else if (item.type == 'date') {\n                $('#luckysheet-dataVerification-dialog .show-box-item-date').show();\n                $('#luckysheet-dataVerification-dialog #data-verification-date-select').val(item.type2);\n                $('#luckysheet-dataVerification-dialog .show-box-item-date .input').hide();\n                if (item.type2 == 'bw' || item.type2 == 'nb') {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .input1').show();\n                } else {\n                    $('#luckysheet-dataVerification-dialog .show-box-item-date .input2').show();\n                }\n                $('#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1').val(item.value1);\n                $('#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2').val(item.value2);\n            } else if (item.type == 'validity') {\n                $('#luckysheet-dataVerification-dialog .show-box .show-box-item-validity').show();\n                $('#luckysheet-dataVerification-dialog #data-verification-validity-select').val(item.type2);\n            }    //自动远程获取选项\n            //自动远程获取选项\n            $('#luckysheet-dataVerification-dialog #data-verification-remote').prop('checked', item.remote);    //输入数据无效时禁止输入\n            //输入数据无效时禁止输入\n            $('#luckysheet-dataVerification-dialog #data-verification-prohibitInput').prop('checked', item.prohibitInput);    //选中单元格时显示提示语\n            //选中单元格时显示提示语\n            $('#luckysheet-dataVerification-dialog #data-verification-hint-show').prop('checked', item.hintShow);\n            if (item.hintShow) {\n                $('#luckysheet-dataVerification-dialog .data-verification-hint-text').show();\n            } else {\n                $('#luckysheet-dataVerification-dialog .data-verification-hint-text').hide();\n            }\n            $('#luckysheet-dataVerification-dialog .data-verification-hint-text input').val(item.hintText);\n        },\n        rangeDialog: function (dataSource, txt) {\n            let _this = this;\n            const _locale = locale();\n            const dvText = _locale.dataVerification;\n            const buttonText = _locale.button;\n            $('#luckysheet-modal-dialog-mask').hide();\n            $('#luckysheet-dataVerificationRange-dialog').remove();\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-dataVerificationRange-dialog',\n                'addclass': 'luckysheet-dataVerificationRange-dialog',\n                'title': dvText.selectCellRange,\n                'content': `<input readonly=\"readonly\" placeholder=\"${ dvText.selectCellRange2 }\" value=\"${ txt }\"/>`,\n                'botton': `<button id=\"luckysheet-dataVerificationRange-dialog-confirm\" class=\"btn btn-primary\" data-source=\"${ dataSource }\">${ buttonText.confirm }</button>\n                        <button id=\"luckysheet-dataVerificationRange-dialog-close\" class=\"btn btn-default\">${ buttonText.close }</button>`,\n                'style': 'z-index:100003'\n            }));\n            let $t = $('#luckysheet-dataVerificationRange-dialog').find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-dataVerificationRange-dialog').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n        },\n        getTxtByRange: function (range) {\n            if (range.length > 0) {\n                let txt = [];\n                for (let s = 0; s < range.length; s++) {\n                    let r1 = range[s].row[0], r2 = range[s].row[1];\n                    let c1 = range[s].column[0], c2 = range[s].column[1];\n                    txt.push(getRangetxt(Store.currentSheetIndex, {\n                        'row': [\n                            r1,\n                            r2\n                        ],\n                        'column': [\n                            c1,\n                            c2\n                        ]\n                    }, Store.currentSheetIndex));\n                }\n                return txt.join(',');\n            }\n        },\n        getRangeByTxt: function (txt) {\n            let range = [];\n            if (txt.indexOf(',') != -1) {\n                let arr = txt.split(',');\n                for (let i = 0; i < arr.length; i++) {\n                    if (formula.iscelldata(arr[i])) {\n                        range.push(formula.getcellrange(arr[i]));\n                    } else {\n                        range = [];\n                        break;\n                    }\n                }\n            } else {\n                if (formula.iscelldata(txt)) {\n                    range.push(formula.getcellrange(txt));\n                }\n            }\n            return range;\n        },\n        cellFocus: function (r, c, clickMode) {\n            $('#luckysheet-dataVerification-dropdown-btn').hide();\n            $('#luckysheet-dataVerification-showHintBox').hide();\n            let _this = this;\n            if (_this.dataVerification == null || _this.dataVerification[r + '_' + c] == null) {\n                $('#luckysheet-dataVerification-dropdown-List').hide();\n                return;\n            }\n            let row = Store.visibledatarow[r], row_pre = r == 0 ? 0 : Store.visibledatarow[r - 1];\n            let col = Store.visibledatacolumn[c], col_pre = c == 0 ? 0 : Store.visibledatacolumn[c - 1];\n            let margeset = menuButton.mergeborer(Store.flowdata, r, c);\n            if (!!margeset) {\n                row = margeset.row[1];\n                row_pre = margeset.row[0];\n                col = margeset.column[1];\n                col_pre = margeset.column[0];\n            }\n            let item = _this.dataVerification[r + '_' + c];    //单元格数据验证 类型是 复选框\n            //单元格数据验证 类型是 复选框\n            if (clickMode && item.type == 'checkbox') {\n                _this.checkboxChange(r, c);\n                return;\n            }    //单元格数据验证 类型是 下拉列表\n            //单元格数据验证 类型是 下拉列表\n            if (item.type == 'dropdown') {\n                $('#luckysheet-dataVerification-dropdown-btn').show().css({\n                    'max-width': col - col_pre,\n                    'max-height': row - row_pre,\n                    'left': col - 20,\n                    'top': row_pre + (row - row_pre - 20) / 2\n                });\n                if ($('#luckysheet-dataVerification-dropdown-List').is(':visible')) {\n                    let dataIndex = $('#luckysheet-dataVerification-dropdown-List').prop('data-index');\n                    if (dataIndex != r + '_' + c) {\n                        $('#luckysheet-dataVerification-dropdown-List').hide();\n                    }\n                }\n            } else {\n                $('#luckysheet-dataVerification-dropdown-List').hide();\n            }    //提示语\n            //提示语\n            if (item.hintShow) {\n                let hintText;\n                if (Store.lang == 'en') {\n                    hintText = '<span style=\"color:#f5a623;\">Hint: </span>';\n                } else {\n                    hintText = '<span style=\"color:#f5a623;\">提示\\uFF1A</span>';\n                }\n                hintText += _this.getHintText(item);\n                $('#luckysheet-dataVerification-showHintBox').html(hintText).show().css({\n                    'left': col_pre,\n                    'top': row\n                });\n                return;\n            }    //数据验证未通过\n            //数据验证未通过\n            let cellValue = getcellvalue(r, c, null);\n            if (isRealNull(cellValue)) {\n                return;\n            }\n            let validate = _this.validateCellData(cellValue, item);\n            if (!validate) {\n                let failureText;\n                if (Store.lang == 'en') {\n                    failureText = '<span style=\"color:#f72626;\">Failure: </span>';\n                } else {\n                    failureText = '<span style=\"color:#f72626;\">失效\\uFF1A</span>';\n                }\n                failureText += _this.getFailureText(item);\n                $('#luckysheet-dataVerification-showHintBox').html(failureText).show().css({\n                    'left': col_pre,\n                    'top': row\n                });\n            }\n        },\n        getHintText: function (item) {\n            let _this = this;\n            let hintText = item.hintText || '';\n            if (hintText.length == 0) {\n                if (Store.lang == 'en') {\n                    if (item.type == 'dropdown') {\n                        hintText += 'please select an option in the drop-down list';\n                    } else if (item.type == 'checkbox') {\n                    } else if (item.type == 'number' || item.type == 'number_integer' || item.type == 'number_decimal') {\n                        hintText += 'please enter a ' + _this.optionLabel_en[item.type] + ' ' + _this.optionLabel_en[item.type2] + ' ' + item.value1;\n                        if (item.type2 == 'bw' || item.type2 == 'nb') {\n                            hintText += ' and ' + item.value2;\n                        }\n                    } else if (item.type == 'text_content') {\n                        hintText += 'please enter text ' + _this.optionLabel_en[item.type2] + ' ' + item.value1;\n                    } else if (item.type == 'text_length') {\n                        hintText += 'please enter text with length ' + _this.optionLabel_en[item.type2] + ' ' + item.value1;\n                        if (item.type2 == 'bw' || item.type2 == 'nb') {\n                            hintText += ' and ' + item.value2;\n                        }\n                    } else if (item.type == 'date') {\n                        hintText += 'please enter a date ' + _this.optionLabel_en[item.type2] + ' ' + item.value1;\n                        if (item.type2 == 'bw' || item.type2 == 'nb') {\n                            hintText += ' and ' + item.value2;\n                        }\n                    } else if (item.type == 'validity') {\n                        hintText += 'please enter the correct ' + _this.optionLabel_en[item.type2];\n                    }\n                } else {\n                    if (item.type == 'dropdown') {\n                        hintText += '请选择下拉列表中的选项';\n                    } else if (item.type == 'checkbox') {\n                    } else if (item.type == 'number' || item.type == 'number_integer' || item.type == 'number_decimal') {\n                        hintText += '请输入' + _this.optionLabel[item.type2] + item.value1;\n                        if (item.type2 == 'bw' || item.type2 == 'nb') {\n                            hintText += '和' + item.value2 + '之间';\n                        }\n                        hintText += '的' + _this.optionLabel[item.type];\n                    } else if (item.type == 'text_content') {\n                        hintText += '请输入内容' + _this.optionLabel[item.type2] + item.value1 + '的文本';\n                    } else if (item.type == 'text_length') {\n                        hintText += '请输入长度' + _this.optionLabel[item.type2] + item.value1;\n                        if (item.type2 == 'bw' || item.type2 == 'nb') {\n                            hintText += '和' + item.value2 + '之间';\n                        }\n                        hintText += '的文本';\n                    } else if (item.type == 'date') {\n                        hintText += '请输入' + _this.optionLabel[item.type2] + item.value1;\n                        if (item.type2 == 'bw' || item.type2 == 'nb') {\n                            hintText += '和' + item.value2 + '之间';\n                        }\n                        hintText += '的日期';\n                    } else if (item.type == 'validity') {\n                        hintText += '请输入正确的' + _this.optionLabel[item.type2];\n                    }\n                }\n            }\n            return hintText;\n        },\n        getFailureText: function (item) {\n            let _this = this;\n            let failureText = '';\n            if (Store.lang == 'en') {\n                if (item.type == 'dropdown') {\n                    failureText += 'what you selected is not an option in the drop-down list';\n                } else if (item.type == 'checkbox') {\n                } else if (item.type == 'number' || item.type == 'number_integer' || item.type == 'number_decimal') {\n                    failureText += 'what you entered is not a ' + _this.optionLabel_en[item.type] + ' ' + _this.optionLabel_en[item.type2] + ' ' + item.value1;\n                    if (item.type2 == 'bw' || item.type2 == 'nb') {\n                        failureText += ' and ' + item.value2;\n                    }\n                } else if (item.type == 'text_content') {\n                    failureText += 'what you entered is not text that ' + _this.optionLabel_en[item.type2] + ' ' + item.value1;\n                } else if (item.type == 'text_length') {\n                    failureText += 'the text you entered is not length ' + _this.optionLabel_en[item.type2] + ' ' + item.value1;\n                    if (item.type2 == 'bw' || item.type2 == 'nb') {\n                        failureText += ' and ' + item.value2;\n                    }\n                } else if (item.type == 'date') {\n                    failureText += 'the date you entered is not ' + _this.optionLabel_en[item.type2] + ' ' + item.value1;\n                    if (item.type2 == 'bw' || item.type2 == 'nb') {\n                        failureText += ' and ' + item.value2;\n                    }\n                } else if (item.type == 'validity') {\n                    failureText += 'what you entered is not a correct ' + _this.optionLabel_en[item.type2];\n                }\n            } else {\n                if (item.type == 'dropdown') {\n                    failureText += '你选择的不是下拉列表中的选项';\n                } else if (item.type == 'checkbox') {\n                } else if (item.type == 'number' || item.type == 'number_integer' || item.type == 'number_decimal') {\n                    failureText += '你输入的不是' + _this.optionLabel[item.type2] + item.value1;\n                    if (item.type2 == 'bw' || item.type2 == 'nb') {\n                        failureText += '和' + item.value2 + '之间';\n                    }\n                    failureText += '的' + _this.optionLabel[item.type];\n                } else if (item.type == 'text_content') {\n                    failureText += '你输入的不是内容' + _this.optionLabel[item.type2] + item.value1 + '的文本';\n                } else if (item.type == 'text_length') {\n                    failureText += '你输入的不是长度' + _this.optionLabel[item.type2] + item.value1;\n                    if (item.type2 == 'bw' || item.type2 == 'nb') {\n                        failureText += '和' + item.value2 + '之间';\n                    }\n                    failureText += '的文本';\n                } else if (item.type == 'date') {\n                    failureText += '你输入的不是' + _this.optionLabel[item.type2] + item.value1;\n                    if (item.type2 == 'bw' || item.type2 == 'nb') {\n                        failureText += '和' + item.value2 + '之间';\n                    }\n                    failureText += '的日期';\n                } else if (item.type == 'validity') {\n                    failureText += '你输入的不是一个正确的' + _this.optionLabel[item.type2];\n                }\n            }\n            return failureText;\n        },\n        validateCellData: function (cellValue, item) {\n            let _this = this;\n            let type = item.type, type2 = item.type2, value1 = item.value1, value2 = item.value2;\n            if (type == 'dropdown') {\n                let list = _this.getDropdownList(value1);\n                let result = false;\n                for (let i = 0; i < list.length; i++) {\n                    if (list[i] == cellValue) {\n                        result = true;\n                        break;\n                    }\n                }\n                return result;\n            } else if (type == 'checkbox') {\n            } else if (type == 'number' || type == 'number_integer' || type == 'number_decimal') {\n                if (!isRealNum(cellValue)) {\n                    return false;\n                }\n                cellValue = Number(cellValue);\n                if (type == 'number_integer' && cellValue % 1 !== 0) {\n                    return false;\n                }\n                if (type == 'number_decimal' && cellValue % 1 === 0) {\n                    return false;\n                }\n                value1 = Number(value1);\n                value2 = Number(value2);\n                if (type2 == 'bw' && (cellValue < value1 || cellValue > value2)) {\n                    return false;\n                }\n                if (type2 == 'nb' && (cellValue >= value1 && cellValue <= value2)) {\n                    return false;\n                }\n                if (type2 == 'eq' && cellValue != value1) {\n                    return false;\n                }\n                if (type2 == 'ne' && cellValue == value1) {\n                    return false;\n                }\n                if (type2 == 'gt' && cellValue <= value1) {\n                    return false;\n                }\n                if (type2 == 'lt' && cellValue >= value1) {\n                    return false;\n                }\n                if (type2 == 'gte' && cellValue < value1) {\n                    return false;\n                }\n                if (type2 == 'lte' && cellValue > value1) {\n                    return false;\n                }\n            } else if (type == 'text_content') {\n                cellValue = cellValue.toString();\n                value1 = value1.toString();\n                if (type2 == 'include' && cellValue.indexOf(value1) == -1) {\n                    return false;\n                }\n                if (type2 == 'exclude' && cellValue.indexOf(value1) > -1) {\n                    return false;\n                }\n                if (type2 == 'equal' && cellValue != value1) {\n                    return false;\n                }\n            } else if (type == 'text_length') {\n                cellValue = cellValue.toString().length;\n                value1 = Number(value1);\n                value2 = Number(value2);\n                if (type2 == 'bw' && (cellValue < value1 || cellValue > value2)) {\n                    return false;\n                }\n                if (type2 == 'nb' && (cellValue >= value1 && cellValue <= value2)) {\n                    return false;\n                }\n                if (type2 == 'eq' && cellValue != value1) {\n                    return false;\n                }\n                if (type2 == 'ne' && cellValue == value1) {\n                    return false;\n                }\n                if (type2 == 'gt' && cellValue <= value1) {\n                    return false;\n                }\n                if (type2 == 'lt' && cellValue >= value1) {\n                    return false;\n                }\n                if (type2 == 'gte' && cellValue < value1) {\n                    return false;\n                }\n                if (type2 == 'lte' && cellValue > value1) {\n                    return false;\n                }\n            } else if (type == 'date') {\n                if (!isdatetime(cellValue)) {\n                    return false;\n                }\n                if (type2 == 'bw' && (diff(cellValue, value1) < 0 || diff(cellValue, value2) > 0)) {\n                    return false;\n                }\n                if (type2 == 'nb' && (diff(cellValue, value1) >= 0 && diff(cellValue, value2) <= 0)) {\n                    return false;\n                }\n                if (type2 == 'eq' && diff(cellValue, value1) != 0) {\n                    return false;\n                }\n                if (type2 == 'ne' && diff(cellValue, value1) == 0) {\n                    return false;\n                }\n                if (type2 == 'bf' && diff(cellValue, value1) >= 0) {\n                    return false;\n                }\n                if (type2 == 'nbf' && diff(cellValue, value1) < 0) {\n                    return false;\n                }\n                if (type2 == 'af' && diff(cellValue, value1) <= 0) {\n                    return false;\n                }\n                if (type2 == 'naf' && diff(cellValue, value1) > 0) {\n                    return false;\n                }\n            } else if (type == 'validity') {\n                if (type2 == 'card' && !/(^\\d{15}$)|(^\\d{18}$)|(^\\d{17}(\\d|X|x)$)/.test(cellValue)) {\n                    return false;\n                }\n                if (type2 == 'phone' && !/^[1][3,4,5,7,8][0-9]{9}$/.test(cellValue)) {\n                    return false;\n                }\n            }\n            return true;\n        },\n        dropdownListShow: function () {\n            $('#luckysheet-dataVerification-showHintBox').hide();\n            let _this = this;\n            let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n            let rowIndex = last.row_focus;\n            let colIndex = last.column_focus;\n            let row = Store.visibledatarow[rowIndex], row_pre = rowIndex == 0 ? 0 : Store.visibledatarow[rowIndex - 1];\n            let col = Store.visibledatacolumn[colIndex], col_pre = colIndex == 0 ? 0 : Store.visibledatacolumn[colIndex - 1];\n            let margeset = menuButton.mergeborer(Store.flowdata, rowIndex, colIndex);\n            if (!!margeset) {\n                row = margeset.row[1];\n                row_pre = margeset.row[0];\n                col = margeset.column[1];\n                col_pre = margeset.column[0];\n            }\n            let item = _this.dataVerification[rowIndex + '_' + colIndex];\n            let list = _this.getDropdownList(item.value1);\n            let optionHtml = '';\n            list.forEach(i => {\n                optionHtml += `<div class=\"dropdown-List-item luckysheet-mousedown-cancel\">${ i }</div>`;\n            });\n            $('#luckysheet-dataVerification-dropdown-List').html(optionHtml).prop('data-index', rowIndex + '_' + colIndex).show().css({\n                'width': col - col_pre - 1,\n                'left': col_pre,\n                'top': row\n            });\n            let myh = $('#luckysheet-dataVerification-dropdown-List').outerHeight();\n            let currentWinH = $('#luckysheet-cell-main')[0].scrollHeight;\n            if (row + myh > currentWinH - 42 - 6) {\n                $('#luckysheet-dataVerification-dropdown-List').css({ 'top': row_pre - myh });\n            }\n        },\n        getDropdownList: function (txt) {\n            let list = [];\n            if (formula.iscelldata(txt)) {\n                let range = formula.getcellrange(txt);\n                let d = Store.luckysheetfile[getSheetIndex(range.sheetIndex)].data;\n                for (let r = range.row[0]; r <= range.row[1]; r++) {\n                    for (let c = range.column[0]; c <= range.column[1]; c++) {\n                        if (d[r] == null) {\n                            continue;\n                        }\n                        let cell = d[r][c];\n                        if (cell == null || cell.v == null) {\n                            continue;\n                        }\n                        let v = cell.m || cell.v;\n                        if (!list.includes(v)) {\n                            list.push(v);\n                        }\n                    }\n                }\n            } else {\n                let arr = txt.split(',');\n                for (let i = 0; i < arr.length; i++) {\n                    let v = arr[i];\n                    if (v.length == 0) {\n                        continue;\n                    }\n                    if (!list.includes(v)) {\n                        list.push(v);\n                    }\n                }\n            }\n            return list;\n        },\n        checkboxChange: function (r, c) {\n            let _this = this;\n            let historyDataVerification = $.extend(true, {}, _this.dataVerification);\n            let currentDataVerification = $.extend(true, {}, _this.dataVerification);\n            let item = currentDataVerification[r + '_' + c];\n            item.checked = !item.checked;\n            let value = item.value2;\n            if (item.checked) {\n                value = item.value1;\n            }\n            let d = editor.deepCopyFlowData(Store.flowdata);\n            setcellvalue(r, c, d, value);\n            _this.refOfCheckbox(historyDataVerification, currentDataVerification, Store.currentSheetIndex, d, {\n                'row': [\n                    r,\n                    r\n                ],\n                'column': [\n                    c,\n                    c\n                ]\n            });\n        },\n        ref: function (historyDataVerification, currentDataVerification, sheetIndex) {\n            let _this = this;\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                let redo = {};\n                redo['type'] = 'updateDataVerification';\n                redo['sheetIndex'] = sheetIndex;\n                redo['historyDataVerification'] = historyDataVerification;\n                redo['currentDataVerification'] = currentDataVerification;\n                Store.jfredo.push(redo);\n            }\n            _this.dataVerification = currentDataVerification;\n            Store.luckysheetfile[getSheetIndex(sheetIndex)].dataVerification = currentDataVerification;    //共享编辑模式\n            //共享编辑模式\n            if (server.allowUpdate) {\n                server.saveParam('all', sheetIndex, currentDataVerification, { 'k': 'dataVerification' });\n            }\n            setTimeout(function () {\n                luckysheetrefreshgrid();\n            }, 1);\n        },\n        refOfCheckbox: function (historyDataVerification, currentDataVerification, sheetIndex, d, range) {\n            let _this = this;\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                let redo = {};\n                redo['type'] = 'updateDataVerificationOfCheckbox';\n                redo['sheetIndex'] = sheetIndex;\n                redo['historyDataVerification'] = historyDataVerification;\n                redo['currentDataVerification'] = currentDataVerification;\n                redo['data'] = Store.flowdata;\n                redo['curData'] = d;\n                redo['range'] = range;\n                Store.jfredo.push(redo);\n            }\n            _this.dataVerification = currentDataVerification;\n            Store.luckysheetfile[getSheetIndex(sheetIndex)].dataVerification = currentDataVerification;\n            Store.flowdata = d;\n            editor.webWorkerFlowDataCache(Store.flowdata);    //worker存数据\n            //worker存数据\n            Store.luckysheetfile[getSheetIndex(sheetIndex)].data = Store.flowdata;    //共享编辑模式\n            //共享编辑模式\n            if (server.allowUpdate) {\n                server.saveParam('all', sheetIndex, currentDataVerification, { 'k': 'dataVerification' });\n                server.historyParam(Store.flowdata, sheetIndex, range);\n            }\n            setTimeout(function () {\n                luckysheetrefreshgrid();\n            }, 1);\n        }\n    };\n    return dataVerificationCtrl;\n});"]}