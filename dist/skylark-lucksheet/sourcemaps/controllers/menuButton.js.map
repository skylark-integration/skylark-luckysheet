{"version":3,"sources":["controllers/menuButton.js"],"names":["define","m_select","m_constant","luckysheetConfigsetting","luckysheetMoreFormat","alternateformat","conditionformat","server","m_sheetSearch","luckysheetFreezen","luckysheetsizeauto","m_filter","luckysheetSearchReplace","luckysheetLocationCell","ifFormulaGenerator","m_updateCell","insertFormula","sheetmanage","luckysheetPostil","m_validate","tooltip","editor","m_format","m_refresh","m_sort","luckysheetformula","m_location","m_datecontroll","m_getRowlen","m_setdata","m_getdata","m_count","m_cursorPos","m_get","m_set","m_inlineString","m_util","m_protection","Store","locale","selectionCopyShow","selectIsOverlap","luckyColor","iconfontObjects","luckysheet_searcharray","createFilter","luckysheetupdateCell","isRealNum","isRealNull","isEditMode","hasPartMC","genarate","update","is_date","jfrefreshgrid","luckysheetrefreshgrid","sortSelection","rowLocationByIndex","colLocationByIndex","isdatatypemulti","rowlenByRange","getCellTextSplitArr","setcellvalue","getFontStyleByCell","checkstatusByCell","countfunc","hideMenuByCancel","getSheetIndex","getRangetxt","getluckysheetfile","setluckysheetfile","isInlineStringCell","updateInlineStringFormat","convertCssToStyleList","inlineStyleAffectAttribute","updateInlineStringFormatOutside","replaceHtml","getObjType","rgbTohex","mouseclickposition","luckysheetfontformat","luckysheetContainerFocus","openProtectionModal","checkProtectionFormatCells","checkProtectionNotEnable","menu","item","split","color","coloritem","subcolor","rightclickmenu","submenuhide","focus","$obj","value","attr","fontarray","parseInt","this","defualtFont","itemvalue","find","html","eq","createButtonMenu","itemdata","itemset","_this","i","length","example","name","text","sub","iconClass","cancelPaintModel","$","removeClass","luckysheet_copy_save","currentSheetIndex","luckysheet_selection_range","luckysheetfile","luckysheetPaintModelOn","fadeOut","remove","luckysheetPaintSingle","initialMenuButton","click","locale_paint","paint","luckysheet_select_save","alert","tipSelectRange","info","tipNotMulti","popover","start","end","addClass","row","column","RowlChange","HasMC","r","config","c","cell","flowdata","mc","rs","dataSheetIndex","copyRange","dblclick","d","deepCopyFlowData","updateFormat","row_index","col_index","foucsStatus","checkstatus","t","fa","v","test","indexOf","substr","prefix","main","tail","isNaN","fmt","suffix","replace","pos","_locale","locale_format","format","locale_defaultFmt","defaultFmt","menuButtonId","$menuButton","id","subclass","subitemdata","moreCurrency","moreDateTime","moreNumber","subitemset","submenu","append","width","hide","$t","itemname","createDialog","init","trim","f","userlen","outerWidth","tlen","menuleft","offset","left","container","top","mousedown","e","stopPropagation","fontSelectList","on","locale_toolbar","toolbar","locale_button","button","locale_alternatingColors","alternatingColors","subid","class","colorself","resetColor","spectrum","showPalette","showPaletteOnly","preferredFormat","clickoutFiresChange","showInitial","showInput","flat","hideAfterPaletteSelect","showSelectionPalette","maxPaletteSize","maxSelectionSize","cancelText","cancel","chooseText","confirm","togglePaletteMoreText","customColor","togglePaletteLessText","collapse","togglePaletteOnly","clearText","defaultTextColor","noColorSelectedText","localStorageKey","gridKey","palette","change","toHexString","css","$input","val","errorInfo","range","extend","rangeIsExists","modelfocusIndex","new","perfect","offsetTop","setTimeout","defaultCellColor","luckysheet_fs_setTimeout","w","window","getSelection","type","getRangeAt","collapsed","inlineStringEditRange","cloneRange","clearTimeout","defualtvalue","keydown","keyup","keyCode","$this","blur","style","cfg","borderInfo","rangeType","borderType","push","clearjfundo","jfundo","redo","jfredo","saveParam","k","canvasH","canvasW","locale_border","border","borderTop","borderBottom","borderLeft","borderRight","borderNone","borderAll","borderOutside","borderInside","borderHorizontal","borderVertical","borderColor","borderSize","iconfontObject","submenuid","subcolormenuid","colormenu","each","closest","canvasborder","get","getContext","translate","setLineDash","strokeStyle","stroke","closePath","bg","toDataURL","removeAttr","has_PartMC","s","r1","r2","c1","c2","updateFormat_mc","locale_merge","merge","mergeAll","mergeV","mergeH","mergeCancel","overlappingError","partiallyError","locale_align","align","center","right","middle","bottom","locale_textWrap","textWrap","overflow","wrap","clip","locale_rotation","rotation","none","angleup","angledown","vertical","rotationUp","rotationDown","locale_freezen","freezen","freezenRow","freezenColumn","freezenRC","freezenRowRange","freezenColumnRange","freezenRCRange","freezenCancel","saveFrozen","scrollTop","row_st","visibledatarow","columnHeaderHeight","freezenhorizontaldata","cutVolumn","saveFreezen","freezenverticaldata","cancelFreezenVertical","createAssistCanvas","createFreezenHorizontal","scrollLeft","col_st","visibledatacolumn","rowHeaderWidth","cancelFreezenHorizontal","createFreezenVertical","noSeletionError","last","row_focus","column_focus","scrollAdapt","locale_sort","sort","locale_filter","filter","asc","desc","custom","clearFilter","locale_findAndReplace","findAndReplace","location","formula","locationExample","date","number","string","error","condition","rowSpan","columnSpan","apply","lessTwoRowTip","lessTwoColumnTip","autoSelectionFormula","locale_formula","sum","average","count","max","min","ifGenerate","fp","toString","tipNotBelongToIf","ifFormulaDialog","tipSelectCell","functionStr","getfunctionParam","fn","formulaParmDialog","param","formulaListDialog","menuButtonFocus","conditionformat_text","highlightCellRules","itemSelectionRules","dataBar","colorGradation","icons","newRule","deleteRule","manageRules","greaterThan","lessThan","between","equal","textContains","occurrence","yesterday","duplicateValue","subitemdata2","top10","top10_percent","last10","last10_percent","aboveAverage","above","belowAverage","below","subitemset2","submenu2","submenu3","gradientDataBar_1","gradientDataBar_2","gradientDataBar_3","gradientDataBar_4","gradientDataBar_5","gradientDataBar_6","solidColorDataBar_1","solidColorDataBar_2","solidColorDataBar_3","solidColorDataBar_4","solidColorDataBar_5","solidColorDataBar_6","submenu4","colorGradation_1","colorGradation_2","colorGradation_3","colorGradation_4","colorGradation_5","colorGradation_6","colorGradation_7","colorGradation_8","colorGradation_9","colorGradation_10","colorGradation_11","colorGradation_12","subitemdata6","deleteSheetRule","subitemset6","submenu6","pleaseSelectRange","CFiconsDialog","newConditionRuleDialog","loadSheetUrl","file","sheetindex","index","post","join","dataset","Function","otherfile","celldata","buildGridData","fileClone","administerRuleDialog","document","off","title","content","textCellColorHtml","conditionformat_greaterThan","conditionformat_greaterThan_title","selectCell","setAs","conditionformat_lessThan","conditionformat_lessThan_title","conditionformat_betweenness","conditionformat_betweenness_title","to","conditionformat_equal","conditionformat_equal_title","conditionformat_textContains","conditionformat_textContains_title","conditionformat_occurrenceDate","conditionformat_occurrenceDate_title","pleaseSelectADate","conditionformat_duplicateValue","conditionformat_duplicateValue_title","uniqueValue","conditionformatDialog","conditionformat_top10","conditionformat_top10_title","oneself","conditionformat_top10_percent","conditionformat_last10","conditionformat_last10_title","conditionformat_last10_percent","conditionformat_AboveAverage","conditionformat_AboveAverage_title","setAsByArea","conditionformat_SubAverage","conditionformat_SubAverage_title","cellrange","dataBarList","updateItem","colorGradationList","locale_comment","comment","removeActivePs","ps","edit","delete","showOne","showAll","insert","newPs","editPs","delPs","showHidePs","showHideAllPs","sheetFile","getSheetByIndex","locale_print","print","menuItemPrint","menuItemAreas","menuItemRows","menuItemColumns","attrid","$attr","$con","parent","winW","winH","height","menuW","attrH","attrW","show","getQKBorder","bordertype","parseFloat","toLowerCase","updateFormatCell","row_ed","col_ed","mask","ct","m","allowEdit","createElement","luckysheetCellUpdate","rangeResizeTo","allParam","fv","mc_r","mc_c","cell_clone","JSON","parse","stringify","spl","isHasMc","isfirst","cs","sheetIndex","data","curData","curConfig","borderfix","changeMenuButtonDom","locale_fontarray","fontjson","addFontTolist","otherFormat","inputMenuButtonFocus","focusTarget","startContainer","parentNode","tagName","cssText","stylelist","key","foucsList","a","console","warn","hv","m_st","m_ed","line_st","line_ed","0","1","2","3","4","5","6","7","8","9","10","11","12","13","log","beginPath","moveTo","lineTo","lineWidth","moveMergeData","offset_r","offset_c","deleMC","insertMC","hasMC","getRangeInMerge","st_r","rlen","st_c","clen","mergelist","getSheetConfig","mergeborer","margeMaindata","start_r","end_r","row_pre","start_c","end_c","col","col_pre","col_rs","row_rs","margeMain","mergeMoveData","mergeMoveMain","columnseleted","rowseleted","mergesetting","getSheetMerge","mcset","offloop","changeparam","mergeMove","ismatch","margeset","getCellRealSize","cell_r","cell_c","defaultcollen","defaultrowlen","getTextHeightCache","getTextSize","font","appendTo","o","innerWidth","h","innerHeight","activeFormulaInput","rowh","columnh","isnull","formulaTxt","toUpperCase","$span","setCaretPosition","israngeseleciton","rangestart","rangedrag_column_start","rangedrag_row_start","rangechangeindex","rangeSetValue","func_selectedrange","left_move","width_move","top_move","height_move","backFormulaInput","execfunction","execFunctionExist","historyParam","checkNoNullValue","num","checkNoNullValueAll","getNoNullValue","st_x","ed","hasValueStart","nullNum","nullTime","hasValueSum","singleFormulaInput","_index","fix","st_m","ed_m","noNum","noNull","isNull","isNum","st_r_r","len","isfalse","execFormulaInput_c","ed_r","ed_c","st_c_c","execFormulaInput","st_r_c","r_false","c_false","reverse","execFunctionGroup","jfcountfuncTimeout","getStyleByCell","af_compute","getComputeMap","checksAF","cf_compute","checksCF","isInline","fontName","isNone","ret","fontInitial","fontList","fItem","fonts","check","url","fontface","FontFace","add","load","ready","then"],"mappings":"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","file":"../../controllers/menuButton.js","sourcesContent":["define([\n    './select',\n    './constant',\n    './luckysheetConfigsetting',\n    './moreFormat',\n    './alternateformat',\n    './conditionformat',\n    './server',\n    './sheetSearch',\n    './freezen',\n    './resize',\n    './filter',\n    './searchReplace',\n    './locationCell',\n    './ifFormulaGenerator',\n    './updateCell',\n    './insertFormula',\n    './sheetmanage',\n    './postil',\n    '../global/validate',\n    '../global/tooltip',\n    '../global/editor',\n    '../global/format',\n    '../global/refresh',\n    '../global/sort',\n    '../global/formula',\n    '../global/location',\n    '../global/datecontroll',\n    '../global/getRowlen',\n    '../global/setdata',\n    '../global/getdata',\n    '../global/count',\n    '../global/cursorPos',\n    '../methods/get',\n    '../methods/set',\n    './inlineString',\n    '../utils/util',\n    './protection',\n    '../store',\n    '../locale/locale'\n], function (m_select, m_constant, luckysheetConfigsetting, luckysheetMoreFormat, alternateformat, conditionformat, server, m_sheetSearch, luckysheetFreezen, luckysheetsizeauto, m_filter, luckysheetSearchReplace, luckysheetLocationCell, ifFormulaGenerator, m_updateCell, insertFormula, sheetmanage, luckysheetPostil, m_validate, tooltip, editor, m_format, m_refresh, m_sort, luckysheetformula, m_location, m_datecontroll, m_getRowlen, m_setdata, m_getdata, m_count, m_cursorPos, m_get, m_set, m_inlineString, m_util, m_protection, Store, locale) {\n    'use strict';\n    const {selectionCopyShow, selectIsOverlap} = m_select;\n    const {luckyColor, iconfontObjects} = m_constant;\n    const {luckysheet_searcharray} = m_sheetSearch;\n    const {createFilter} = m_filter;\n    const {luckysheetupdateCell} = m_updateCell;\n    const {isRealNum, isRealNull, isEditMode, hasPartMC} = m_validate;\n    const {genarate, update, is_date} = m_format;\n    const {jfrefreshgrid, luckysheetrefreshgrid} = m_refresh;\n    const {sortSelection} = m_sort;\n    const {rowLocationByIndex, colLocationByIndex} = m_location;\n    const {isdatatypemulti} = m_datecontroll;\n    const {rowlenByRange, getCellTextSplitArr} = m_getRowlen;\n    const {setcellvalue} = m_setdata;\n    const {getFontStyleByCell, checkstatusByCell} = m_getdata;\n    const {countfunc} = m_count;\n    const {hideMenuByCancel} = m_cursorPos;\n    const {getSheetIndex, getRangetxt, getluckysheetfile} = m_get;\n    const {setluckysheetfile} = m_set;\n    const {isInlineStringCell, updateInlineStringFormat, convertCssToStyleList, inlineStyleAffectAttribute, updateInlineStringFormatOutside} = m_inlineString;\n    const {replaceHtml, getObjType, rgbTohex, mouseclickposition, luckysheetfontformat, luckysheetContainerFocus} = m_util;\n    const {openProtectionModal, checkProtectionFormatCells, checkProtectionNotEnable} = m_protection;\n    const menuButton = {\n        'menu': '<div class=\"luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton ${subclass} luckysheet-mousedown-cancel\" id=\"luckysheet-icon-${id}-menuButton\">${item}</div>',\n        // \"item\": '<div itemvalue=\"${value}\" itemname=\"${name}\" class=\"luckysheet-cols-menuitem ${sub} luckysheet-mousedown-cancel\"><div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\" style=\"padding: 3px 0px 3px 1px;\"><span style=\"margin-right:3px;width:13px;display:inline-block;\" class=\"icon luckysheet-mousedown-cancel\"></span> ${name} <span class=\"luckysheet-submenu-arrow luckysheet-mousedown-cancel\" style=\"user-select: none;\">${example}</span></div></div>',\n        'item': '<div itemvalue=\"${value}\" itemname=\"${name}\" class=\"luckysheet-cols-menuitem ${sub} luckysheet-mousedown-cancel\"><div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\" style=\"padding: 3px 0px 3px 1px;\"><span style=\"margin-right:3px;width:13px;display:inline-block;\" class=\"icon luckysheet-mousedown-cancel\"></span> ${name} <span class=\"luckysheet-submenu-arrow luckysheet-mousedown-cancel ${iconClass}\" style=\"user-select: none;\">${example}</span></div></div>',\n        'split': '<div class=\"luckysheet-menuseparator luckysheet-mousedown-cancel\" role=\"separator\"></div>',\n        'color': '<div class=\"luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel luckysheet-menuButton ${sub}\" id=\"${id}\"><div class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel luckysheet-color-reset\"><div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\">${resetColor}</div></div> <div class=\"luckysheet-mousedown-cancel\"> <div class=\"luckysheet-mousedown-cancel\"> <input type=\"text\" class=\"luckysheet-color-selected\" /> </div> </div> <div class=\"luckysheet-menuseparator luckysheet-mousedown-cancel\" role=\"separator\"></div> ${coloritem}</div>',\n        'coloritem': '<div class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel ${class}\"><div class=\"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel\">${name}</div></div>',\n        'subcolor': '<div id=\"luckysheet-icon-${id}-menuButton\" class=\"luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-menuButton-sub luckysheet-mousedown-cancel\"> <div class=\"luckysheet-mousedown-cancel\"> <div class=\"luckysheet-mousedown-cancel\"> <input type=\"text\" class=\"luckysheet-color-selected\" /> </div> </div></div>',\n        'rightclickmenu': null,\n        'submenuhide': {},\n        focus: function ($obj, value) {\n            if ($obj.attr('id') == 'luckysheet-icon-font-family-menuButton') {\n                if (isdatatypemulti(value)['num']) {\n                    let _locale = locale();\n                    const locale_fontarray = _locale.fontarray;\n                    value = locale_fontarray[parseInt(value)];\n                    if (value == null) {\n                        value = this.defualtFont[itemvalue];\n                    }\n                }\n            }\n            $obj.find('.luckysheet-cols-menuitem').find('span.icon').html('');\n            if (value == null) {\n                $obj.find('.luckysheet-cols-menuitem').eq(0).find('span.icon').html('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n            } else {\n                $obj.find(\".luckysheet-cols-menuitem[itemvalue='\" + value + \"']\").find('span.icon').html('<i class=\"fa fa-check luckysheet-mousedown-cancel\"></i>');\n            }\n        },\n        createButtonMenu: function (itemdata) {\n            let itemset = '';\n            let _this = this;\n            for (let i = 0; i < itemdata.length; i++) {\n                let item = itemdata[i];\n                if (item.value == 'split') {\n                    itemset += _this.split;\n                } else {\n                    if (item.example == 'more') {\n                        // itemset += replaceHtml(_this.item, {\"value\": item.value, \"name\": item.text, \"example\": \"\", \"sub\": \"luckysheet-cols-submenu\"});\n                        itemset += replaceHtml(_this.item, {\n                            'value': item.value,\n                            'name': item.text,\n                            'example': '',\n                            'sub': 'luckysheet-cols-submenu',\n                            'iconClass': 'iconfont luckysheet-iconfont-youjiantou'\n                        });\n                    } else {\n                        itemset += replaceHtml(_this.item, {\n                            'value': item.value,\n                            'name': item.text,\n                            'example': item.example,\n                            'sub': '',\n                            'iconClass': ''\n                        });\n                    }\n                }\n            }\n            return itemset;\n        },\n        cancelPaintModel: function () {\n            let _this = this;\n            $('#luckysheet-sheettable_0').removeClass('luckysheetPaintCursor');\n            if (Store.luckysheet_copy_save['dataSheetIndex'] == Store.currentSheetIndex) {\n                Store.luckysheet_selection_range = [];\n                selectionCopyShow();\n            } else {\n                Store.luckysheetfile[getSheetIndex(Store.luckysheet_copy_save['dataSheetIndex'])].luckysheet_selection_range = [];\n            }\n            Store.luckysheet_copy_save = {};\n            _this.luckysheetPaintModelOn = false;\n            $('#luckysheetpopover').fadeOut(200, function () {\n                $('#luckysheetpopover').remove();\n            });\n        },\n        luckysheetPaintModelOn: false,\n        luckysheetPaintSingle: false,\n        initialMenuButton: function () {\n            let _this = this;    //\n            //\n            $('#luckysheet-icon-paintformat').click(function () {\n                let _locale = locale();\n                let locale_paint = _locale.paint;\n                if (Store.luckysheet_select_save == null || Store.luckysheet_select_save.length == 0) {\n                    if (isEditMode()) {\n                        alert(locale_paint.tipSelectRange);\n                    } else {\n                        tooltip.info('', locale_paint.tipSelectRange);\n                    }\n                    return;\n                } else if (Store.luckysheet_select_save.length > 1) {\n                    if (isEditMode()) {\n                        alert(locale_paint.tipNotMulti);\n                    } else {\n                        tooltip.info('', locale_paint.tipNotMulti);\n                    }\n                    return;\n                }\n                tooltip.popover(\"<i class='fa fa-paint-brush'></i> \" + locale_paint.start + '', 'topCenter', true, null, locale_paint.end, function () {\n                    _this.cancelPaintModel();\n                });\n                $('#luckysheet-sheettable_0').addClass('luckysheetPaintCursor');\n                Store.luckysheet_selection_range = [{\n                        'row': Store.luckysheet_select_save[0].row,\n                        'column': Store.luckysheet_select_save[0].column\n                    }];\n                selectionCopyShow();\n                let RowlChange = false, HasMC = false;\n                for (let r = Store.luckysheet_select_save[0].row[0]; r <= Store.luckysheet_select_save[0].row[1]; r++) {\n                    if (Store.config['rowhidden'] != null && Store.config['rowhidden'][r] != null) {\n                        continue;\n                    }\n                    if (Store.config['rowlen'] != null && r in Store.config['rowlen']) {\n                        RowlChange = true;\n                    }\n                    for (let c = Store.luckysheet_select_save[0].column[0]; c <= Store.luckysheet_select_save[0].column[1]; c++) {\n                        let cell = Store.flowdata[r][c];\n                        if (getObjType(cell) == 'object' && 'mc' in cell && cell.mc.rs != null) {\n                            HasMC = true;\n                        }\n                    }\n                }\n                Store.luckysheet_copy_save = {\n                    'dataSheetIndex': Store.currentSheetIndex,\n                    'copyRange': [{\n                            'row': Store.luckysheet_select_save[0].row,\n                            'column': Store.luckysheet_select_save[0].column\n                        }],\n                    'RowlChange': RowlChange,\n                    'HasMC': HasMC\n                };\n                _this.luckysheetPaintModelOn = true;\n                _this.luckysheetPaintSingle = true;\n            });\n            $('#luckysheet-icon-paintformat').dblclick(function () {\n                let _locale = locale();\n                let locale_paint = _locale.paint;\n                if (Store.luckysheet_select_save == null || Store.luckysheet_select_save.length == 0) {\n                    if (isEditMode()) {\n                        alert(locale_paint.tipSelectRange);\n                    } else {\n                        tooltip.info('', locale_paint.tipSelectRange);\n                    }\n                    return;\n                } else if (Store.luckysheet_select_save.length > 1) {\n                    if (isEditMode()) {\n                        alert(locale_paint.tipNotMulti);\n                    } else {\n                        tooltip.info('', locale_paint.tipNotMulti);\n                    }\n                    return;\n                }\n                tooltip.popover(\"<i class='fa fa-paint-brush'></i> \" + locale_paint.start, 'topCenter', true, null, locale_paint.end, function () {\n                    _this.cancelPaintModel();\n                });\n                $('#luckysheet-sheettable_0').addClass('luckysheetPaintCursor');\n                Store.luckysheet_selection_range = [{\n                        'row': Store.luckysheet_select_save[0].row,\n                        'column': Store.luckysheet_select_save[0].column\n                    }];\n                selectionCopyShow();\n                let RowlChange = false, HasMC = false;\n                for (let r = Store.luckysheet_select_save[0].row[0]; r <= Store.luckysheet_select_save[0].row[1]; r++) {\n                    if (Store.config['rowhidden'] != null && Store.config['rowhidden'][r] != null) {\n                        continue;\n                    }\n                    if (Store.config['rowlen'] != null && r in Store.config['rowlen']) {\n                        RowlChange = true;\n                    }\n                    for (let c = Store.luckysheet_select_save[0].column[0]; c <= Store.luckysheet_select_save[0].column[1]; c++) {\n                        let cell = Store.flowdata[r][c];\n                        if (getObjType(cell) == 'object' && 'mc' in cell && cell.mc.rs != null) {\n                            HasMC = true;\n                        }\n                    }\n                }\n                Store.luckysheet_copy_save = {\n                    'dataSheetIndex': Store.currentSheetIndex,\n                    'copyRange': [{\n                            'row': Store.luckysheet_select_save[0].row,\n                            'column': Store.luckysheet_select_save[0].column\n                        }],\n                    'RowlChange': RowlChange,\n                    'HasMC': HasMC\n                };\n                _this.luckysheetPaintModelOn = true;\n                _this.luckysheetPaintSingle = false;\n            });    //\n            //\n            $('#luckysheet-icon-currency').click(function () {\n                let d = editor.deepCopyFlowData(Store.flowdata);    //\n                //\n                _this.updateFormat(d, 'ct', '\\xA5 #.00');\n            });    //\n            //\n            $('#luckysheet-icon-percent').click(function () {\n                let d = editor.deepCopyFlowData(Store.flowdata);    //\n                //\n                _this.updateFormat(d, 'ct', '0.00%');\n            });    //\n            //\n            $('#luckysheet-icon-fmt-decimal-decrease').click(function () {\n                let d = editor.deepCopyFlowData(Store.flowdata);    //\n                //\n                let row_index = Store.luckysheet_select_save[0]['row_focus'], col_index = Store.luckysheet_select_save[0]['column_focus'];\n                let foucsStatus = _this.checkstatus(d, row_index, col_index, 'ct');\n                let cell = d[row_index][col_index];\n                if (foucsStatus == null || foucsStatus.t != 'n') {\n                    return;\n                }\n                if (foucsStatus.fa == 'General') {\n                    let mask = genarate(cell.v);\n                    foucsStatus = mask[1];\n                }    //\n                //\n                let reg = /^(w|W)((0?)|(0\\.0+))$/;\n                if (reg.test(foucsStatus.fa)) {\n                    if (foucsStatus.fa.indexOf('.') > -1) {\n                        if (foucsStatus.fa.substr(-2) == '.0') {\n                            _this.updateFormat(d, 'ct', foucsStatus.fa.split('.')[0]);\n                        } else {\n                            _this.updateFormat(d, 'ct', foucsStatus.fa.substr(0, foucsStatus.fa.length - 1));\n                        }\n                    } else {\n                        _this.updateFormat(d, 'ct', foucsStatus.fa);\n                    }\n                    return;\n                }\n                let prefix = '', main = '';\n                if (foucsStatus.fa.indexOf('.') > -1) {\n                    fa = foucsStatus.fa.split('.');\n                    prefix = fa[0];\n                    main = fa[1];\n                } else {\n                    return;\n                }\n                let fa = main.split('');\n                let tail = '';\n                for (let i = fa.length - 1; i >= 0; i--) {\n                    let c = fa[i];\n                    if (c != '#' && c != '0' && c != ',' && isNaN(parseInt(c))) {\n                        tail = c + tail;\n                    } else {\n                        break;\n                    }\n                }\n                let fmt = '';\n                if (foucsStatus.fa.indexOf('.') > -1) {\n                    let suffix = main;\n                    if (tail.length > 0) {\n                        suffix = main.replace(tail, '');\n                    }\n                    let pos = suffix.replace(/#/g, '0');\n                    pos = pos.substr(0, pos.length - 1);\n                    if (pos == '') {\n                        fmt = prefix + tail;\n                    } else {\n                        fmt = prefix + '.' + pos + tail;\n                    }\n                }\n                _this.updateFormat(d, 'ct', fmt);\n            });    //\n            //\n            $('#luckysheet-icon-fmt-decimal-increase').click(function () {\n                let d = editor.deepCopyFlowData(Store.flowdata);    //\n                //\n                let row_index = Store.luckysheet_select_save[0]['row_focus'], col_index = Store.luckysheet_select_save[0]['column_focus'];\n                let foucsStatus = _this.checkstatus(d, row_index, col_index, 'ct');\n                let cell = d[row_index][col_index];\n                if (foucsStatus == null || foucsStatus.t != 'n') {\n                    return;\n                }\n                if (foucsStatus.fa == 'General') {\n                    let mask = genarate(cell.v);\n                    foucsStatus = mask[1];\n                }\n                if (foucsStatus.fa == 'General') {\n                    _this.updateFormat(d, 'ct', '#.0');\n                    return;\n                }    //\n                //\n                let reg = /^(w|W)((0?)|(0\\.0+))$/;\n                if (reg.test(foucsStatus.fa)) {\n                    if (foucsStatus.fa.indexOf('.') > -1) {\n                        _this.updateFormat(d, 'ct', foucsStatus.fa + '0');\n                    } else {\n                        if (foucsStatus.fa.substr(-1) == '0') {\n                            _this.updateFormat(d, 'ct', foucsStatus.fa + '.0');\n                        } else {\n                            _this.updateFormat(d, 'ct', foucsStatus.fa + '0.0');\n                        }\n                    }\n                    return;\n                }\n                let prefix = '', main = '';\n                if (foucsStatus.fa.indexOf('.') > -1) {\n                    fa = foucsStatus.fa.split('.');\n                    prefix = fa[0];\n                    main = fa[1];\n                } else {\n                    main = foucsStatus.fa;\n                }\n                let fa = main.split('');\n                let tail = '';\n                for (let i = fa.length - 1; i >= 0; i--) {\n                    let c = fa[i];\n                    if (c != '#' && c != '0' && c != ',' && isNaN(parseInt(c))) {\n                        tail = c + tail;\n                    } else {\n                        break;\n                    }\n                }\n                let fmt = '';\n                if (foucsStatus.fa.indexOf('.') > -1) {\n                    let suffix = main;\n                    if (tail.length > 0) {\n                        suffix = main.replace(tail, '');\n                    }\n                    let pos = suffix.replace(/#/g, '0');\n                    pos += '0';\n                    fmt = prefix + '.' + pos + tail;\n                } else {\n                    if (tail.length > 0) {\n                        fmt = main.replace(tail, '') + '.0' + tail;\n                    } else {\n                        fmt = main + '.0' + tail;\n                    }\n                }\n                _this.updateFormat(d, 'ct', fmt);\n            });    //\n            //\n            $('#luckysheet-icon-fmt-other').click(function () {\n                const _locale = locale();\n                const locale_format = _locale.format;\n                const locale_defaultFmt = _locale.defaultFmt;\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    let itemdata = locale_defaultFmt;\n                    let itemset = _this.createButtonMenu(itemdata);    // luckysheet-menuButton-sub\n                    // luckysheet-menuButton-sub\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'fmt-other',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    let subitemdata = [\n                        {\n                            'text': locale_format.moreCurrency + '...',\n                            'value': 'morecurrency',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_format.moreDateTime + '...',\n                            'value': 'moredatetime',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_format.moreNumber + '...',\n                            'value': 'moredigit',\n                            'example': ''\n                        }\n                    ];\n                    let subitemset = _this.createButtonMenu(subitemdata);\n                    let submenu = replaceHtml(_this.menu, {\n                        'id': 'fmtOtherSelf',\n                        'item': subitemset,\n                        'subclass': 'luckysheet-menuButton-sub'\n                    });    //luckysheet-icon-fmt-other-menuButton_sub\n                    //luckysheet-icon-fmt-other-menuButton_sub\n                    $('body').append(menu + submenu);\n                    $menuButton = $('#' + menuButtonId).width(250);\n                    _this.focus($menuButton);\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue'), itemname = $t.attr('itemname');\n                        $('#luckysheet-icon-fmt-other').find('.luckysheet-toolbar-menu-button-caption').html(' ' + itemname + ' ');\n                        if (itemvalue == 'fmtOtherSelf') {\n                            return;\n                        }\n                        let d = editor.deepCopyFlowData(Store.flowdata);    //\n                        //\n                        _this.focus($menuButton, itemvalue);\n                        _this.updateFormat(d, 'ct', itemvalue);\n                    });    //\n                    //\n                    $('#luckysheet-icon-fmtOtherSelf-menuButton').find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        $('#luckysheet-icon-fmtOtherSelf-menuButton').hide();\n                        luckysheetContainerFocus();\n                        let itemvalue = $(this).attr('itemvalue');\n                        luckysheetMoreFormat.createDialog(itemvalue);\n                        luckysheetMoreFormat.init();\n                    });\n                } else {\n                    const text = $(this).find('.luckysheet-toolbar-menu-button-caption').text().trim();\n                    const format = locale_defaultFmt.find(f => f.text === text);\n                    if (format) {\n                        _this.focus($menuButton, format.value);\n                    }\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-font-family').mousedown(function (e) {\n                hideMenuByCancel(e);\n                e.stopPropagation();\n            }).click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    // const locale_fontarray = locale().fontarray;\n                    // let itemdata = [];\n                    // for(let a=0;a<locale_fontarray.length;a++){\n                    //     let fItem = locale_fontarray[a];\n                    //     let ret = {};\n                    //     ret.value = a;\n                    //     ret.text = \"<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:\"+fItem+\"'>\"+fItem+\"</span>\";\n                    //     ret.example = \"\";\n                    //     itemdata.push(ret);\n                    // }\n                    let itemset = _this.createButtonMenu(_this.fontSelectList);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'font-family',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId).width(200);\n                    _this.focus($menuButton);\n                    $menuButton.on('click', '.luckysheet-cols-menuitem', function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue'), itemname = $t.attr('itemname');\n                        _this.focus($menuButton, itemvalue);\n                        $('#luckysheet-icon-font-family').find('.luckysheet-toolbar-menu-button-caption').html(' ' + itemname + ' ');\n                        let d = editor.deepCopyFlowData(Store.flowdata);\n                        _this.updateFormat(d, 'ff', itemvalue);\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-text-color').mousedown(function (e) {\n                hideMenuByCancel(e);\n                e.stopPropagation();\n            }).click(function () {\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                let color = $(this).attr('color');\n                if (color == null) {\n                    color = '#000000';\n                }\n                _this.updateFormat(d, 'fc', color);\n            });\n            $('#luckysheet-icon-text-color-menu').mousedown(function (e) {\n                hideMenuByCancel(e);\n                e.stopPropagation();\n            }).click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    const _locale = locale();\n                    const locale_toolbar = _locale.toolbar;\n                    const locale_button = _locale.button;\n                    const locale_alternatingColors = _locale.alternatingColors;\n                    let itemdata = [{\n                            'name': locale_toolbar.alternatingColors + '...',\n                            'id': 'luckysheet-color-alternate',\n                            'example': ''\n                        }];\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let subid = 'text-color-self';\n                    let coloritem = replaceHtml(_this.coloritem, {\n                        'class': 'luckysheet-icon-alternateformat',\n                        'name': locale_toolbar.alternatingColors + '...'\n                    });\n                    let menu = replaceHtml(_this.color, {\n                        'id': menuButtonId,\n                        'coloritem': coloritem,\n                        'colorself': subid,\n                        'sub': '',\n                        'resetColor': locale_toolbar.resetColor\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId);\n                    $('#' + menuButtonId).find('.luckysheet-color-selected').spectrum({\n                        showPalette: true,\n                        showPaletteOnly: true,\n                        preferredFormat: 'hex',\n                        clickoutFiresChange: false,\n                        showInitial: true,\n                        showInput: true,\n                        flat: true,\n                        hideAfterPaletteSelect: true,\n                        showSelectionPalette: true,\n                        maxPaletteSize: 8,\n                        maxSelectionSize: 8,\n                        cancelText: locale_button.cancel,\n                        chooseText: locale_button.confirm,\n                        togglePaletteMoreText: locale_toolbar.customColor,\n                        togglePaletteLessText: locale_toolbar.collapse,\n                        togglePaletteOnly: true,\n                        clearText: locale_toolbar.clearText,\n                        color: luckysheetConfigsetting.defaultTextColor,\n                        noColorSelectedText: locale_toolbar.noColorSelectedText,\n                        localStorageKey: 'spectrum.textcolor' + server.gridKey,\n                        palette: [\n                            [\n                                '#000',\n                                '#444',\n                                '#666',\n                                '#999',\n                                '#ccc',\n                                '#eee',\n                                '#f3f3f3',\n                                '#fff'\n                            ],\n                            [\n                                '#f00',\n                                '#f90',\n                                '#ff0',\n                                '#0f0',\n                                '#0ff',\n                                '#00f',\n                                '#90f',\n                                '#f0f'\n                            ],\n                            [\n                                '#f4cccc',\n                                '#fce5cd',\n                                '#fff2cc',\n                                '#d9ead3',\n                                '#d0e0e3',\n                                '#cfe2f3',\n                                '#d9d2e9',\n                                '#ead1dc'\n                            ],\n                            [\n                                '#ea9999',\n                                '#f9cb9c',\n                                '#ffe599',\n                                '#b6d7a8',\n                                '#a2c4c9',\n                                '#9fc5e8',\n                                '#b4a7d6',\n                                '#d5a6bd'\n                            ],\n                            [\n                                '#e06666',\n                                '#f6b26b',\n                                '#ffd966',\n                                '#93c47d',\n                                '#76a5af',\n                                '#6fa8dc',\n                                '#8e7cc3',\n                                '#c27ba0'\n                            ],\n                            [\n                                '#c00',\n                                '#e69138',\n                                '#f1c232',\n                                '#6aa84f',\n                                '#45818e',\n                                '#3d85c6',\n                                '#674ea7',\n                                '#a64d79'\n                            ],\n                            [\n                                '#900',\n                                '#b45f06',\n                                '#bf9000',\n                                '#38761d',\n                                '#134f5c',\n                                '#0b5394',\n                                '#351c75',\n                                '#741b47'\n                            ],\n                            [\n                                '#600',\n                                '#783f04',\n                                '#7f6000',\n                                '#274e13',\n                                '#0c343d',\n                                '#073763',\n                                '#20124d',\n                                '#4c1130'\n                            ]\n                        ],\n                        change: function (color) {\n                            if (color != null) {\n                                color = color.toHexString();\n                            } else {\n                                color = '#000';\n                            }    // $(\"#luckysheet-icon-text-color .luckysheet-color-menu-button-indicator\").css(\"border-bottom-color\", color);\n                                 // DIV\n                            // $(\"#luckysheet-icon-text-color .luckysheet-color-menu-button-indicator\").css(\"border-bottom-color\", color);\n                            // DIV\n                            $('#luckysheet-icon-text-color .text-color-bar').css('background-color', color);\n                            $('#luckysheet-icon-text-color').attr('color', color);\n                            let d = editor.deepCopyFlowData(Store.flowdata);\n                            _this.updateFormat(d, 'fc', color);\n                            $menuButton.hide();\n                            luckysheetContainerFocus();    /* bugcolor */\n                            /* bugcolor */\n                            $('#luckysheet-input-box').css('color', color);\n                        }\n                    });\n                    $menuButton.find('.luckysheet-color-reset').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $input = $('#' + menuButtonId).find('.luckysheet-color-selected');\n                        $input.val('#000000');\n                        $('#luckysheet-icon-text-color').attr('color', null);\n                        $input.spectrum('set', '#000000');\n                        $('#luckysheet-icon-text-color .luckysheet-color-menu-button-indicator').css('border-bottom-color', '#000000');\n                        let d = editor.deepCopyFlowData(Store.flowdata);\n                        _this.updateFormat(d, 'fc', null);\n                    });    //\n                    //\n                    $menuButton.find('.luckysheet-icon-alternateformat').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        if (Store.luckysheet_select_save.length > 1) {\n                            if (isEditMode()) {\n                                alert(locale_alternatingColors.errorInfo);\n                            } else {\n                                tooltip.info(locale_alternatingColors.errorInfo, '');\n                            }\n                            return;\n                        }\n                        let range = $.extend(true, {}, Store.luckysheet_select_save[0]);\n                        let isExists = alternateformat.rangeIsExists(range)[0];\n                        if (!isExists) {\n                            alternateformat.modelfocusIndex = 0;\n                            alternateformat.new(range);\n                        }\n                        alternateformat.init();\n                        alternateformat.perfect();\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                let offsetTop = $(this).offset().top + 26;\n                setTimeout(function () {\n                    let $input = $('#' + menuButtonId).find('.luckysheet-color-selected');\n                    $input.spectrum('set', $input.val());\n                    mouseclickposition($menuButton, menuleft - 28, offsetTop, 'lefttop');\n                }, 1);\n            });    //\n            //\n            $('#luckysheet-icon-cell-color').click(function () {\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                let color = $(this).attr('color');\n                if (color == null) {\n                    color = '#ffffff';\n                }\n                _this.updateFormat(d, 'bg', color);\n            });\n            $('#luckysheet-icon-cell-color-menu').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    let subid = 'cell-color-self';\n                    const _locale = locale();\n                    const locale_toolbar = _locale.toolbar;\n                    const locale_button = _locale.button;\n                    const locale_alternatingColors = _locale.alternatingColors;\n                    let coloritem = replaceHtml(_this.coloritem, {\n                        'class': 'luckysheet-icon-alternateformat',\n                        'name': locale_toolbar.alternatingColors + '...'\n                    });\n                    let menu = replaceHtml(_this.color, {\n                        'id': menuButtonId,\n                        'coloritem': coloritem,\n                        'colorself': subid,\n                        'sub': '',\n                        'resetColor': locale_toolbar.resetColor\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId);\n                    $('#' + menuButtonId).find('.luckysheet-color-selected').spectrum({\n                        showPalette: true,\n                        showPaletteOnly: true,\n                        preferredFormat: 'hex',\n                        clickoutFiresChange: false,\n                        showInitial: true,\n                        showInput: true,\n                        flat: true,\n                        hideAfterPaletteSelect: true,\n                        showSelectionPalette: true,\n                        maxPaletteSize: 8,\n                        maxSelectionSize: 8,\n                        color: luckysheetConfigsetting.defaultCellColor,\n                        cancelText: locale_button.cancel,\n                        chooseText: locale_button.confirm,\n                        togglePaletteMoreText: locale_toolbar.customColor,\n                        togglePaletteLessText: locale_toolbar.collapse,\n                        togglePaletteOnly: true,\n                        clearText: locale_toolbar.clearText,\n                        noColorSelectedText: locale_toolbar.noColorSelectedText,\n                        localStorageKey: 'spectrum.bgcolor' + server.gridKey,\n                        palette: [\n                            [\n                                '#000',\n                                '#444',\n                                '#666',\n                                '#999',\n                                '#ccc',\n                                '#eee',\n                                '#f3f3f3',\n                                '#fff'\n                            ],\n                            [\n                                '#f00',\n                                '#f90',\n                                '#ff0',\n                                '#0f0',\n                                '#0ff',\n                                '#00f',\n                                '#90f',\n                                '#f0f'\n                            ],\n                            [\n                                '#f4cccc',\n                                '#fce5cd',\n                                '#fff2cc',\n                                '#d9ead3',\n                                '#d0e0e3',\n                                '#cfe2f3',\n                                '#d9d2e9',\n                                '#ead1dc'\n                            ],\n                            [\n                                '#ea9999',\n                                '#f9cb9c',\n                                '#ffe599',\n                                '#b6d7a8',\n                                '#a2c4c9',\n                                '#9fc5e8',\n                                '#b4a7d6',\n                                '#d5a6bd'\n                            ],\n                            [\n                                '#e06666',\n                                '#f6b26b',\n                                '#ffd966',\n                                '#93c47d',\n                                '#76a5af',\n                                '#6fa8dc',\n                                '#8e7cc3',\n                                '#c27ba0'\n                            ],\n                            [\n                                '#c00',\n                                '#e69138',\n                                '#f1c232',\n                                '#6aa84f',\n                                '#45818e',\n                                '#3d85c6',\n                                '#674ea7',\n                                '#a64d79'\n                            ],\n                            [\n                                '#900',\n                                '#b45f06',\n                                '#bf9000',\n                                '#38761d',\n                                '#134f5c',\n                                '#0b5394',\n                                '#351c75',\n                                '#741b47'\n                            ],\n                            [\n                                '#600',\n                                '#783f04',\n                                '#7f6000',\n                                '#274e13',\n                                '#0c343d',\n                                '#073763',\n                                '#20124d',\n                                '#4c1130'\n                            ]\n                        ],\n                        change: function (color) {\n                            if (color != null) {\n                                color = color.toHexString();\n                            } else {\n                                color = '#fff';\n                            }    // $(\"#luckysheet-icon-cell-color .luckysheet-color-menu-button-indicator\").css(\"border-bottom-color\", color);\n                                 // DIV\n                            // $(\"#luckysheet-icon-cell-color .luckysheet-color-menu-button-indicator\").css(\"border-bottom-color\", color);\n                            // DIV\n                            $('#luckysheet-icon-cell-color .text-color-bar').css('background-color', color);\n                            $('#luckysheet-icon-cell-color').attr('color', color);\n                            let d = editor.deepCopyFlowData(Store.flowdata);\n                            _this.updateFormat(d, 'bg', color);\n                            $menuButton.hide();\n                            luckysheetContainerFocus();\n                        }\n                    });\n                    $menuButton.find('.luckysheet-color-reset').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $input = $('#' + menuButtonId).find('.luckysheet-color-selected');\n                        $input.val('#ffffff');\n                        $('#luckysheet-icon-cell-color').attr('color', null);\n                        $input.spectrum('set', '#ffffff');\n                        $('#luckysheet-icon-cell-color .luckysheet-color-menu-button-indicator').css('border-bottom-color', '#ffffff');\n                        let d = editor.deepCopyFlowData(Store.flowdata);\n                        _this.updateFormat(d, 'bg', null);\n                    });    //\n                    //\n                    $menuButton.find('.luckysheet-icon-alternateformat').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        if (Store.luckysheet_select_save.length > 1) {\n                            if (isEditMode()) {\n                                alert(locale_alternatingColors.errorInfo);\n                            } else {\n                                tooltip.info(locale_alternatingColors.errorInfo, '');\n                            }\n                            return;\n                        }\n                        let range = $.extend(true, {}, Store.luckysheet_select_save[0]);\n                        let isExists = alternateformat.rangeIsExists(range)[0];\n                        if (!isExists) {\n                            alternateformat.modelfocusIndex = 0;\n                            alternateformat.new(range);\n                        }\n                        alternateformat.init();\n                        alternateformat.perfect();\n                    });\n                    $('#' + menuButtonId).find('.luckysheet-color-selected').val('#fff');\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                let offsetTop = $(this).offset().top + 26;\n                setTimeout(function () {\n                    let $input = $('#' + menuButtonId).find('.luckysheet-color-selected');\n                    $input.spectrum('set', $input.val());\n                    mouseclickposition($menuButton, menuleft - 28, offsetTop, 'lefttop');\n                }, 1);\n            });    //\n            //\n            let luckysheet_fs_setTimeout = null;\n            $('#luckysheet-icon-font-size').mousedown(function (e) {\n                if (parseInt($('#luckysheet-input-box').css('top')) > 0) {\n                    let w = window.getSelection();\n                    if (w.type != 'None') {\n                        let range = w.getRangeAt(0);\n                        if (!range.collapsed) {\n                            Store.inlineStringEditRange = range.cloneRange();\n                        }\n                    }\n                }\n                hideMenuByCancel(e);\n                e.stopPropagation();\n            }).click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    let itemdata = [\n                        {\n                            'text': '9',\n                            'value': '9',\n                            'example': ''\n                        },\n                        {\n                            'text': '10',\n                            'value': '10',\n                            'example': ''\n                        },\n                        {\n                            'text': '11',\n                            'value': '11',\n                            'example': ''\n                        },\n                        {\n                            'text': '12',\n                            'value': '12',\n                            'example': ''\n                        },\n                        {\n                            'text': '14',\n                            'value': '14',\n                            'example': ''\n                        },\n                        {\n                            'text': '16',\n                            'value': '16',\n                            'example': ''\n                        },\n                        {\n                            'text': '18',\n                            'value': '18',\n                            'example': ''\n                        },\n                        {\n                            'text': '20',\n                            'value': '20',\n                            'example': ''\n                        },\n                        {\n                            'text': '22',\n                            'value': '22',\n                            'example': ''\n                        },\n                        {\n                            'text': '24',\n                            'value': '24',\n                            'example': ''\n                        },\n                        {\n                            'text': '26',\n                            'value': '26',\n                            'example': ''\n                        },\n                        {\n                            'text': '28',\n                            'value': '28',\n                            'example': ''\n                        },\n                        {\n                            'text': '36',\n                            'value': '36',\n                            'example': ''\n                        },\n                        {\n                            'text': '48',\n                            'value': '48',\n                            'example': ''\n                        },\n                        {\n                            'text': '72',\n                            'value': '72',\n                            'example': ''\n                        }\n                    ];\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'font-size',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId).width(150);\n                    _this.focus($menuButton, 10);\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue'), $input = $('#luckysheet-icon-font-size input');\n                        $('#luckysheet-icon-font-size').attr('itemvalue', itemvalue);\n                        _this.focus($menuButton, itemvalue);\n                        $input.val(itemvalue);\n                        let d = editor.deepCopyFlowData(Store.flowdata);\n                        _this.updateFormat(d, 'fs', itemvalue);\n                        clearTimeout(luckysheet_fs_setTimeout);\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let defualtvalue = $('#luckysheet-icon-font-size').attr('itemvalue');\n                if (defualtvalue == null) {\n                    defualtvalue = 10;\n                }\n                _this.focus($menuButton, defualtvalue);\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft, $(this).offset().top + 25, 'lefttop');\n            }).find('input.luckysheet-toolbar-textinput').keydown(function (e) {\n                hideMenuByCancel(e);\n                e.stopPropagation();\n            }).keyup(function (e) {\n                if (e.keyCode != 13) {\n                    //Enter\n                    return;\n                }\n                let $this = $(this);\n                let itemvalue = parseInt($this.val());\n                let $menuButton = $('#luckysheet-icon-font-size-menuButton');\n                _this.focus($menuButton, itemvalue);\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                _this.updateFormat(d, 'fs', itemvalue);\n                luckysheet_fs_setTimeout = setTimeout(function () {\n                    $menuButton.hide();\n                    $this.blur();\n                }, 200);\n            });    //\n            //\n            $('#luckysheet-icon-border-all').click(function () {\n                if (!checkProtectionFormatCells(Store.currentSheetIndex)) {\n                    return;\n                }\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                let type = $(this).attr('type');\n                if (type == null) {\n                    type = 'border-all';\n                }\n                let subcolormenuid = 'luckysheet-icon-borderColor-menuButton';\n                let color = $('#' + subcolormenuid).find('.luckysheet-color-selected').val();\n                let style = $('#luckysheetborderSizepreview').attr('itemvalue');\n                if (color == null || color == '') {\n                    color = '#000';\n                }\n                if (style == null || style == '') {\n                    style = '1';\n                }\n                let cfg = $.extend(true, {}, Store.config);\n                if (cfg['borderInfo'] == null) {\n                    cfg['borderInfo'] = [];\n                }\n                let borderInfo = {\n                    'rangeType': 'range',\n                    'borderType': type,\n                    'color': color,\n                    'style': style,\n                    'range': $.extend(true, [], Store.luckysheet_select_save)\n                };\n                cfg['borderInfo'].push(borderInfo);\n                if (Store.clearjfundo) {\n                    Store.jfundo.length = 0;\n                    let redo = [];\n                    redo['type'] = 'borderChange';\n                    redo['config'] = $.extend(true, {}, Store.config);\n                    redo['curconfig'] = $.extend(true, {}, cfg);\n                    redo['sheetIndex'] = Store.currentSheetIndex;\n                    Store.jfredo.push(redo);\n                }\n                server.saveParam('cg', Store.currentSheetIndex, cfg['borderInfo'], { 'k': 'borderInfo' });\n                Store.config = cfg;\n                Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                setTimeout(function () {\n                    luckysheetrefreshgrid();\n                }, 1);\n            });\n            $('#luckysheet-icon-border-menu').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    let canvasH = 10, canvasW = 120;\n                    const _locale = locale();\n                    const locale_border = _locale.border;\n                    const locale_toolbar = _locale.toolbar;\n                    const locale_button = _locale.button;\n                    let itemdata = [\n                        {\n                            'text': locale_border.borderTop,\n                            'value': 'border-top',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-top iconfont luckysheet-iconfont-shangbiankuang\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_border.borderBottom,\n                            'value': 'border-bottom',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-bottom iconfont luckysheet-iconfont-xiabiankuang\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_border.borderLeft,\n                            'value': 'border-left',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-left iconfont luckysheet-iconfont-zuobiankuang\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_border.borderRight,\n                            'value': 'border-right',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-right iconfont luckysheet-iconfont-youbiankuang\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_border.borderNone,\n                            'value': 'border-none',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-none iconfont luckysheet-iconfont-wubiankuang\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_border.borderAll,\n                            'value': 'border-all',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-all iconfont luckysheet-iconfont-quanjiabiankuang\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_border.borderOutside,\n                            'value': 'border-outside',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-outside iconfont luckysheet-iconfont-sizhoujiabiankuang\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_border.borderInside,\n                            'value': 'border-inside',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-inside iconfont luckysheet-iconfont-neikuangxian\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_border.borderHorizontal,\n                            'value': 'border-horizontal',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-horizontal iconfont luckysheet-iconfont-neikuanghengxian\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_border.borderVertical,\n                            'value': 'border-vertical',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-vertical iconfont luckysheet-iconfont-neikuangshuxian\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': \"<span id='luckysheet-icon-borderColor-linecolor' class='luckysheet-mousedown-cancel' style='border-bottom:3px solid #000;'>\" + locale_border.borderColor + '</span>',\n                            'value': 'borderColor',\n                            'example': 'more'\n                        },\n                        {\n                            'text': '' + locale_border.borderSize + \"<img id='luckysheetborderSizepreview' width=100 height=10 src='data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' style='position:absolute;bottom:-5px;right:0px;width:100px;height:10px;'>\",\n                            'value': 'borderSize',\n                            'example': 'more'\n                        }\n                    ];    // itemvalue to iconfont\n                    // itemvalue to iconfont\n                    const iconfontObject = iconfontObjects.border;\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'border-menu',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    let subitemdata = [\n                        {\n                            'text': locale_border.borderNone,\n                            'value': '0',\n                            'example': ''\n                        },\n                        {\n                            'text': \"<canvas type='Thin' class='border-Thin' width=\" + canvasW + ' height=' + canvasH + \" style='width:\" + canvasW + 'px;height:' + canvasH + \"px;position:static;'></canvas>\",\n                            'value': '1',\n                            'example': ''\n                        },\n                        {\n                            'text': \"<canvas type='Hair' class='border-Hair' width=\" + canvasW + ' height=' + canvasH + \" style='width:\" + canvasW + 'px;height:' + canvasH + \"px;position:static;'></canvas>\",\n                            'value': '2',\n                            'example': ''\n                        },\n                        {\n                            'text': \"<canvas type='Dotted' class='border-Dotted' width=\" + canvasW + ' height=' + canvasH + \" style='width:\" + canvasW + 'px;height:' + canvasH + \"px;position:static;'></canvas>\",\n                            'value': '3',\n                            'example': ''\n                        },\n                        {\n                            'text': \"<canvas type='Dashed' class='border-Dashed' width=\" + canvasW + ' height=' + canvasH + \" style='width:\" + canvasW + 'px;height:' + canvasH + \"px;position:static;'></canvas>\",\n                            'value': '4',\n                            'example': ''\n                        },\n                        {\n                            'text': \"<canvas type='DashDot' class='border-DashDot' width=\" + canvasW + ' height=' + canvasH + \" style='width:\" + canvasW + 'px;height:' + canvasH + \"px;position:static;'></canvas>\",\n                            'value': '5',\n                            'example': ''\n                        },\n                        {\n                            'text': \"<canvas type='DashDotDot' class='border-DashDotDot' width=\" + canvasW + ' height=' + canvasH + \" style='width:\" + canvasW + 'px;height:' + canvasH + \"px;position:static;'></canvas>\",\n                            'value': '6',\n                            'example': ''\n                        },\n                        // {\"text\":\"<canvas type='Double' class='border-Double' width=\"+ canvasW +\" height=\"+ canvasH +\" style='width:\"+ canvasW +\"px;height:\"+ canvasH +\"px;position:static;'></canvas>\", \"value\":\"7\", \"example\":\"\"},\n                        {\n                            'text': \"<canvas type='Medium' class='border-Medium' width=\" + canvasW + ' height=' + canvasH + \" style='width:\" + canvasW + 'px;height:' + canvasH + \"px;position:static;'></canvas>\",\n                            'value': '8',\n                            'example': ''\n                        },\n                        {\n                            'text': \"<canvas type='MediumDashed' class='border-MediumDashed' width=\" + canvasW + ' height=' + canvasH + \" style='width:\" + canvasW + 'px;height:' + canvasH + \"px;position:static;'></canvas>\",\n                            'value': '9',\n                            'example': ''\n                        },\n                        {\n                            'text': \"<canvas type='MediumDashDot' class='border-MediumDashDot' width=\" + canvasW + ' height=' + canvasH + \" style='width:\" + canvasW + 'px;height:' + canvasH + \"px;position:static;'></canvas>\",\n                            'value': '10',\n                            'example': ''\n                        },\n                        {\n                            'text': \"<canvas type='MediumDashDotDot' class='border-MediumDashDotDot' width=\" + canvasW + ' height=' + canvasH + \" style='width:\" + canvasW + 'px;height:' + canvasH + \"px;position:static;'></canvas>\",\n                            'value': '11',\n                            'example': ''\n                        },\n                        // {\"text\":\"<canvas type='SlantedDashDot' class='border-SlantedDashDot' width=\"+ canvasW +\" height=\"+ canvasH +\" style='width:\"+ canvasW +\"px;height:\"+ canvasH +\"px;position:static;'></canvas>\", \"value\":\"12\", \"example\":\"\"},\n                        {\n                            'text': \"<canvas type='Thick' class='border-Thick' width=\" + canvasW + ' height=' + canvasH + \" style='width:\" + canvasW + 'px;height:' + canvasH + \"px;position:static;'></canvas>\",\n                            'value': '13',\n                            'example': ''\n                        }\n                    ];\n                    let subitemset = _this.createButtonMenu(subitemdata);\n                    let submenu = replaceHtml(_this.menu, {\n                        'id': 'borderSize',\n                        'item': subitemset,\n                        'subclass': 'luckysheet-menuButton-sub'\n                    });\n                    let submenuid = 'luckysheet-icon-borderSize-menuButton';\n                    let subcolormenuid = 'luckysheet-icon-borderColor-menuButton';\n                    let colormenu = replaceHtml(_this.color, {\n                        'id': subcolormenuid,\n                        'coloritem': '',\n                        'colorself': '',\n                        'sub': 'luckysheet-menuButton-sub',\n                        resetColor: locale_toolbar.resetColor\n                    });\n                    $('body').append(menu + colormenu + submenu);\n                    $menuButton = $('#' + menuButtonId).width(170);\n                    _this.focus($menuButton, 'border-all');\n                    $('#' + submenuid + ' canvas').each(function (i) {\n                        let type = $(this).attr('type');\n                        let itemvalue = $(this).closest('.luckysheet-cols-menuitem').attr('itemvalue');\n                        let canvasborder = $(this).addClass('luckysheet-mousedown-cancel').get(0).getContext('2d');\n                        canvasborder.translate(0.5, 0.5);\n                        _this.setLineDash(canvasborder, itemvalue, 'h', 0, 5, 100, 5);\n                        canvasborder.strokeStyle = '#000000';\n                        canvasborder.stroke();\n                        canvasborder.closePath();\n                    });\n                    $('#' + submenuid + ' .luckysheet-cols-menuitem').click(function () {\n                        $('#' + submenuid).hide();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (itemvalue == 0) {\n                            $('#luckysheetborderSizepreview').attr('src', 'data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==').attr('itemvalue', null);\n                        } else {\n                            let bg = $t.find('canvas').get(0).toDataURL('image/png');\n                            $('#luckysheetborderSizepreview').attr('src', bg).attr('itemvalue', itemvalue);\n                        }\n                        _this.focus($('#' + submenuid), itemvalue);\n                    });    // border choose menu\n                    // border choose menu\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (itemvalue == 'borderColor' || itemvalue == 'borderSize') {\n                            return;\n                        }\n                        if (!checkProtectionFormatCells(Store.currentSheetIndex)) {\n                            return;\n                        }\n                        let d = editor.deepCopyFlowData(Store.flowdata);\n                        let color = $('#' + subcolormenuid).find('.luckysheet-color-selected').val();\n                        let style = $('#luckysheetborderSizepreview').attr('itemvalue');\n                        if (color == null || color == '') {\n                            color = '#000';\n                        }\n                        if (style == null || style == '') {\n                            style = '1';\n                        }\n                        let cfg = $.extend(true, {}, Store.config);\n                        if (cfg['borderInfo'] == null) {\n                            cfg['borderInfo'] = [];\n                        }\n                        let borderInfo = {\n                            'rangeType': 'range',\n                            'borderType': itemvalue,\n                            'color': color,\n                            'style': style,\n                            'range': $.extend(true, [], Store.luckysheet_select_save)\n                        };\n                        cfg['borderInfo'].push(borderInfo);\n                        if (Store.clearjfundo) {\n                            Store.jfundo.length = 0;\n                            let redo = [];\n                            redo['type'] = 'borderChange';\n                            redo['config'] = $.extend(true, {}, Store.config);\n                            redo['curconfig'] = $.extend(true, {}, cfg);\n                            redo['sheetIndex'] = Store.currentSheetIndex;\n                            Store.jfredo.push(redo);\n                        }\n                        server.saveParam('cg', Store.currentSheetIndex, cfg['borderInfo'], { 'k': 'borderInfo' });\n                        Store.config = cfg;\n                        Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].config = Store.config;\n                        setTimeout(function () {\n                            luckysheetrefreshgrid();\n                        }, 1);\n                        $('#luckysheet-icon-border-all').attr('type', itemvalue);\n                        let $icon = $('#luckysheet-icon-border-all').find('.luckysheet-icon-img-container');    // add iconfont\n                        // add iconfont\n                        $icon.removeAttr('class').addClass('luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-' + itemvalue + iconfontObject[itemvalue]);\n                        _this.focus($menuButton, itemvalue);\n                    });\n                    $('#' + subcolormenuid).find('.luckysheet-color-selected').spectrum({\n                        showPalette: true,\n                        showPaletteOnly: true,\n                        preferredFormat: 'hex',\n                        clickoutFiresChange: false,\n                        showInitial: true,\n                        showInput: true,\n                        flat: true,\n                        hideAfterPaletteSelect: true,\n                        showSelectionPalette: true,\n                        maxPaletteSize: 8,\n                        maxSelectionSize: 8,\n                        color: '#000',\n                        cancelText: locale_button.cancel,\n                        chooseText: locale_button.confirm,\n                        togglePaletteMoreText: locale_toolbar.customColor,\n                        togglePaletteLessText: locale_toolbar.collapse,\n                        togglePaletteOnly: true,\n                        clearText: locale_toolbar.clearText,\n                        noColorSelectedText: locale_toolbar.noColorSelectedText,\n                        localStorageKey: 'spectrum.bordercolor' + server.gridKey,\n                        palette: [\n                            [\n                                '#000',\n                                '#444',\n                                '#666',\n                                '#999',\n                                '#ccc',\n                                '#eee',\n                                '#f3f3f3',\n                                '#fff'\n                            ],\n                            [\n                                '#f00',\n                                '#f90',\n                                '#ff0',\n                                '#0f0',\n                                '#0ff',\n                                '#00f',\n                                '#90f',\n                                '#f0f'\n                            ],\n                            [\n                                '#f4cccc',\n                                '#fce5cd',\n                                '#fff2cc',\n                                '#d9ead3',\n                                '#d0e0e3',\n                                '#cfe2f3',\n                                '#d9d2e9',\n                                '#ead1dc'\n                            ],\n                            [\n                                '#ea9999',\n                                '#f9cb9c',\n                                '#ffe599',\n                                '#b6d7a8',\n                                '#a2c4c9',\n                                '#9fc5e8',\n                                '#b4a7d6',\n                                '#d5a6bd'\n                            ],\n                            [\n                                '#e06666',\n                                '#f6b26b',\n                                '#ffd966',\n                                '#93c47d',\n                                '#76a5af',\n                                '#6fa8dc',\n                                '#8e7cc3',\n                                '#c27ba0'\n                            ],\n                            [\n                                '#c00',\n                                '#e69138',\n                                '#f1c232',\n                                '#6aa84f',\n                                '#45818e',\n                                '#3d85c6',\n                                '#674ea7',\n                                '#a64d79'\n                            ],\n                            [\n                                '#900',\n                                '#b45f06',\n                                '#bf9000',\n                                '#38761d',\n                                '#134f5c',\n                                '#0b5394',\n                                '#351c75',\n                                '#741b47'\n                            ],\n                            [\n                                '#600',\n                                '#783f04',\n                                '#7f6000',\n                                '#274e13',\n                                '#0c343d',\n                                '#073763',\n                                '#20124d',\n                                '#4c1130'\n                            ]\n                        ],\n                        change: function (color) {\n                            let $input = $(this);\n                            if (color != null) {\n                                color = color.toHexString();\n                            } else {\n                                color = '#000';\n                            }\n                            let oldcolor = null;\n                            $('#luckysheet-icon-borderColor-linecolor').css('border-bottom-color', color);\n                            $('#' + subcolormenuid).find('.luckysheet-color-selected').val(color);\n                        }\n                    });\n                    $('#' + subcolormenuid).find('.luckysheet-color-reset').click(function () {\n                        let $input = $('#' + subcolormenuid).find('.luckysheet-color-selected');\n                        $input.val('#000');\n                        $('#luckysheet-icon-cell-color').attr('color', null);\n                        $input.spectrum('set', '#000');\n                        $('#luckysheet-icon-borderColor-linecolor').css('border-bottom-color', '#000');\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft - 28, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-merge-button').click(function () {\n                if (!checkProtectionNotEnable(Store.currentSheetIndex)) {\n                    return;\n                }\n                if (selectIsOverlap()) {\n                    if (isEditMode()) {\n                        alert('');\n                    } else {\n                        tooltip.info('', '');\n                    }\n                    return;\n                }\n                if (Store.config['merge'] != null) {\n                    let has_PartMC = false;\n                    for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                        let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                        let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                        has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                        if (has_PartMC) {\n                            break;\n                        }\n                    }\n                    if (has_PartMC) {\n                        if (isEditMode()) {\n                            alert('');\n                        } else {\n                            tooltip.info('', '');\n                        }\n                        return;\n                    }\n                }\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                _this.updateFormat_mc(d, 'mergeAll');\n            });\n            $('#luckysheet-icon-merge-menu').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    const _locale = locale();\n                    const locale_merge = _locale.merge;\n                    let itemdata = [\n                        {\n                            'text': locale_merge.mergeAll,\n                            'value': 'mergeAll',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_merge.mergeV,\n                            'value': 'mergeV',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_merge.mergeH,\n                            'value': 'mergeH',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_merge.mergeCancel,\n                            'value': 'mergeCancel',\n                            'example': ''\n                        }\n                    ];\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'merge-menu',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId).width(110);\n                    _this.focus($menuButton);\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        if (selectIsOverlap()) {\n                            if (isEditMode()) {\n                                alert(locale_merge.overlappingError);\n                            } else {\n                                tooltip.info(locale_merge.overlappingError, '');\n                            }\n                            return;\n                        }\n                        if (Store.config['merge'] != null) {\n                            let has_PartMC = false;\n                            for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                                let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                                let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                                has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                                if (has_PartMC) {\n                                    break;\n                                }\n                            }\n                            if (has_PartMC) {\n                                if (isEditMode()) {\n                                    alert(locale_merge.partiallyError);\n                                } else {\n                                    tooltip.info(locale_merge.partiallyError, '');\n                                }\n                                return;\n                            }\n                        }\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        _this.focus($menuButton, itemvalue);\n                        let d = editor.deepCopyFlowData(Store.flowdata);\n                        _this.updateFormat_mc(d, itemvalue);\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft - 28, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-align').click(function () {\n                let itemvalue = $('#luckysheet-icon-align').attr('type');\n                if (itemvalue == null) {\n                    itemvalue = 'left';\n                }\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                _this.updateFormat(d, 'ht', itemvalue);\n            });\n            $('#luckysheet-icon-align-menu').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    const _locale = locale();\n                    const locale_align = _locale.align;\n                    let itemdata = [\n                        {\n                            'text': locale_align.left,\n                            'value': 'left',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-left iconfont luckysheet-iconfont-wenbenzuoduiqi\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_align.center,\n                            'value': 'center',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-center iconfont luckysheet-iconfont-wenbenjuzhongduiqi\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_align.right,\n                            'value': 'right',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-right iconfont luckysheet-iconfont-wenbenyouduiqi\" style=\"user-select: none;\"> </div> </div>'\n                        }\n                    ];    // itemvalue to iconfont\n                    // itemvalue to iconfont\n                    const iconfontObject = iconfontObjects.align;\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'align-menu',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId).width(120);\n                    _this.focus($menuButton);\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        _this.focus($menuButton, itemvalue);\n                        let $icon = $('#luckysheet-icon-align').attr('type', itemvalue).find('.luckysheet-icon-img-container');    // add iconfont\n                        // add iconfont\n                        $icon.removeAttr('class').addClass('luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-' + itemvalue + iconfontObject[itemvalue]);\n                        let d = editor.deepCopyFlowData(Store.flowdata);\n                        _this.updateFormat(d, 'ht', itemvalue);\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft - 28, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-valign').click(function () {\n                let itemvalue = $('#luckysheet-icon-valign').attr('type');\n                if (itemvalue == null) {\n                    itemvalue = 'bottom';\n                }\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                _this.updateFormat(d, 'vt', itemvalue);\n            });\n            $('#luckysheet-icon-valign-menu').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                const _locale = locale();\n                const locale_align = _locale.align;\n                if ($menuButton.length == 0) {\n                    let itemdata = [\n                        {\n                            'text': locale_align.top,\n                            'value': 'top',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-top iconfont luckysheet-iconfont-dingbuduiqi\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_align.middle,\n                            'value': 'middle',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-middle iconfont luckysheet-iconfont-shuipingduiqi\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_align.bottom,\n                            'value': 'bottom',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-bottom iconfont luckysheet-iconfont-dibuduiqi\" style=\"user-select: none;\"> </div> </div>'\n                        }\n                    ];    // itemvalue to iconfont\n                    // itemvalue to iconfont\n                    const iconfontObject = iconfontObjects.align;\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'valign-menu',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId).width(120);\n                    _this.focus($menuButton, 'bottom');\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        _this.focus($menuButton, itemvalue);\n                        let $icon = $('#luckysheet-icon-valign').attr('type', itemvalue).find('.luckysheet-icon-img-container');    // add iconfont\n                        // add iconfont\n                        $icon.removeAttr('class').addClass('luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-' + itemvalue + iconfontObject[itemvalue]);\n                        let d = editor.deepCopyFlowData(Store.flowdata);\n                        _this.updateFormat(d, 'vt', itemvalue);\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft - 28, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-textwrap-menu').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    const _locale = locale();\n                    const locale_textWrap = _locale.textWrap;\n                    let itemdata = [\n                        {\n                            'text': locale_textWrap.overflow,\n                            'value': 'overflow',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-overflow iconfont luckysheet-iconfont-yichu1\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_textWrap.wrap,\n                            'value': 'wrap',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-wrap iconfont luckysheet-iconfont-zidonghuanhang\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_textWrap.clip,\n                            'value': 'clip',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-clip iconfont luckysheet-iconfont-jieduan\" style=\"user-select: none;\"> </div> </div>'\n                        }\n                    ];    // itemvalue to iconfont\n                    // itemvalue to iconfont\n                    const iconfontObject = iconfontObjects.textWrap;\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'textwrap-menu',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId).width(120);\n                    _this.focus($menuButton, 'clip');\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        _this.focus($menuButton, itemvalue);\n                        let $icon = $('#luckysheet-icon-textwrap').attr('type', itemvalue).find('.luckysheet-icon-img-container');    // add iconfont\n                        // add iconfont\n                        $icon.removeAttr('class').addClass('luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-' + itemvalue + iconfontObject[itemvalue]);\n                        let d = editor.deepCopyFlowData(Store.flowdata);\n                        _this.updateFormat(d, 'tb', itemvalue);\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft - 28, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-rotation-menu').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    const _locale = locale();\n                    const locale_rotation = _locale.rotation;\n                    let itemdata = [\n                        {\n                            'text': locale_rotation.none,\n                            'value': 'none',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wuxuanzhuang\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_rotation.angleup,\n                            'value': 'angleup',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angleup iconfont luckysheet-iconfont-xiangshangqingxie\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_rotation.angledown,\n                            'value': 'angledown',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angledown iconfont luckysheet-iconfont-xiangxiaqingxie\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_rotation.vertical,\n                            'value': 'vertical',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-vertical iconfont luckysheet-iconfont-shupaiwenzi\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_rotation.rotationUp,\n                            'value': 'rotation-up',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-up iconfont luckysheet-iconfont-wenbenxiangshang\" style=\"user-select: none;\"> </div> </div>'\n                        },\n                        {\n                            'text': locale_rotation.rotationDown,\n                            'value': 'rotation-down',\n                            'example': '<div class=\"luckysheet-icon luckysheet-inline-block\" style=\"user-select: none;opacity:1;\"> <div aria-hidden=\"true\" class=\"luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-down iconfont luckysheet-iconfont-xiangxia90\" style=\"user-select: none;\"> </div> </div>'\n                        }\n                    ];    // itemvalue to iconfont\n                    // itemvalue to iconfont\n                    const iconfontObject = iconfontObjects.rotation;\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'rotation-menu',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);    //  Stack Vertically 160\n                    //  Stack Vertically 160\n                    $menuButton = $('#' + menuButtonId).width(160);\n                    _this.focus($menuButton);\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        _this.focus($menuButton, itemvalue);\n                        let $icon = $('#luckysheet-icon-rotation').attr('type', itemvalue).find('.luckysheet-icon-img-container');    // add iconfont\n                        // add iconfont\n                        $icon.removeAttr('class').addClass('luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-' + itemvalue + iconfontObject[itemvalue]);\n                        let d = editor.deepCopyFlowData(Store.flowdata);\n                        _this.updateFormat(d, 'tr', itemvalue);\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft - 28, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-freezen-menu').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    const _locale = locale();\n                    const locale_freezen = _locale.freezen;\n                    let itemdata = [\n                        {\n                            'text': locale_freezen.freezenRow,\n                            'value': 'freezenRow',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_freezen.freezenColumn,\n                            'value': 'freezenColumn',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_freezen.freezenRC,\n                            'value': 'freezenRC',\n                            'example': ''\n                        },\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_freezen.freezenRowRange,\n                            'value': 'freezenRowRange',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_freezen.freezenColumnRange,\n                            'value': 'freezenColumnRange',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_freezen.freezenRCRange,\n                            'value': 'freezenRCRange',\n                            'example': ''\n                        },\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_freezen.freezenCancel,\n                            'value': 'freezenCancel',\n                            'example': ''\n                        }\n                    ];\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'freezen-menu',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId).width(170);\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        _this.focus($menuButton, itemvalue);    // store frozen\n                        // store frozen\n                        luckysheetFreezen.saveFrozen(itemvalue);\n                        if (itemvalue == 'freezenRow') {\n                            //\n                            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                            let row_st = luckysheet_searcharray(Store.visibledatarow, scrollTop);\n                            if (row_st == -1) {\n                                row_st = 0;\n                            }\n                            let top = Store.visibledatarow[row_st] - 2 - scrollTop + Store.columnHeaderHeight;\n                            let freezenhorizontaldata = [\n                                Store.visibledatarow[row_st],\n                                row_st + 1,\n                                scrollTop,\n                                luckysheetFreezen.cutVolumn(Store.visibledatarow, row_st + 1),\n                                top\n                            ];\n                            luckysheetFreezen.saveFreezen(freezenhorizontaldata, top, null, null);\n                            if (luckysheetFreezen.freezenverticaldata != null) {\n                                luckysheetFreezen.cancelFreezenVertical();\n                                luckysheetFreezen.createAssistCanvas();\n                                luckysheetrefreshgrid();\n                            }\n                            luckysheetFreezen.createFreezenHorizontal(freezenhorizontaldata, top);\n                            luckysheetFreezen.createAssistCanvas();\n                            luckysheetrefreshgrid();\n                        } else if (itemvalue == 'freezenColumn') {\n                            //\n                            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                            let col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollLeft);\n                            if (col_st == -1) {\n                                col_st = 0;\n                            }\n                            let left = Store.visibledatacolumn[col_st] - 2 - scrollLeft + Store.rowHeaderWidth;\n                            let freezenverticaldata = [\n                                Store.visibledatacolumn[col_st],\n                                col_st + 1,\n                                scrollLeft,\n                                luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_st + 1),\n                                left\n                            ];\n                            luckysheetFreezen.saveFreezen(null, null, freezenverticaldata, left);\n                            if (luckysheetFreezen.freezenhorizontaldata != null) {\n                                luckysheetFreezen.cancelFreezenHorizontal();\n                                luckysheetFreezen.createAssistCanvas();\n                                luckysheetrefreshgrid();\n                            }\n                            luckysheetFreezen.createFreezenVertical(freezenverticaldata, left);\n                            luckysheetFreezen.createAssistCanvas();\n                            luckysheetrefreshgrid();\n                        } else if (itemvalue == 'freezenRC') {\n                            //\n                            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                            let row_st = luckysheet_searcharray(Store.visibledatarow, scrollTop);\n                            if (row_st == -1) {\n                                row_st = 0;\n                            }\n                            let top = Store.visibledatarow[row_st] - 2 - scrollTop + Store.columnHeaderHeight;\n                            let freezenhorizontaldata = [\n                                Store.visibledatarow[row_st],\n                                row_st + 1,\n                                scrollTop,\n                                luckysheetFreezen.cutVolumn(Store.visibledatarow, row_st + 1),\n                                top\n                            ];\n                            luckysheetFreezen.saveFreezen(freezenhorizontaldata, top, null, null);\n                            luckysheetFreezen.createFreezenHorizontal(freezenhorizontaldata, top);\n                            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                            let col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollLeft);\n                            if (col_st == -1) {\n                                col_st = 0;\n                            }\n                            let left = Store.visibledatacolumn[col_st] - 2 - scrollLeft + Store.rowHeaderWidth;\n                            let freezenverticaldata = [\n                                Store.visibledatacolumn[col_st],\n                                col_st + 1,\n                                scrollLeft,\n                                luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_st + 1),\n                                left\n                            ];\n                            luckysheetFreezen.saveFreezen(null, null, freezenverticaldata, left);\n                            luckysheetFreezen.createFreezenVertical(freezenverticaldata, left);\n                            luckysheetFreezen.createAssistCanvas();\n                            luckysheetrefreshgrid();\n                        } else if (itemvalue == 'freezenRowRange') {\n                            //\n                            if (Store.luckysheet_select_save == null || Store.luckysheet_select_save.length == 0) {\n                                if (isEditMode()) {\n                                    alert(locale_freezen.noSeletionError);\n                                } else {\n                                    tooltip.info(locale_freezen.noSeletionError, '');\n                                }\n                                return;\n                            }\n                            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                            let row_st = luckysheet_searcharray(Store.visibledatarow, scrollTop);\n                            let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                            let row_focus = last['row_focus'] == null ? last['row'][0] : last['row_focus'];\n                            if (row_focus > row_st) {\n                                row_st = row_focus;\n                            }\n                            if (row_st == -1) {\n                                row_st = 0;\n                            }\n                            let top = Store.visibledatarow[row_st] - 2 - scrollTop + Store.columnHeaderHeight;\n                            let freezenhorizontaldata = [\n                                Store.visibledatarow[row_st],\n                                row_st + 1,\n                                scrollTop,\n                                luckysheetFreezen.cutVolumn(Store.visibledatarow, row_st + 1),\n                                top\n                            ];\n                            luckysheetFreezen.saveFreezen(freezenhorizontaldata, top, null, null);\n                            if (luckysheetFreezen.freezenverticaldata != null) {\n                                luckysheetFreezen.cancelFreezenVertical();\n                                luckysheetFreezen.createAssistCanvas();\n                                luckysheetrefreshgrid();\n                            }\n                            luckysheetFreezen.createFreezenHorizontal(freezenhorizontaldata, top);\n                            luckysheetFreezen.createAssistCanvas();\n                            luckysheetrefreshgrid();\n                        } else if (itemvalue == 'freezenColumnRange') {\n                            //\n                            if (Store.luckysheet_select_save == null || Store.luckysheet_select_save.length == 0) {\n                                if (isEditMode()) {\n                                    alert(locale_freezen.noSeletionError);\n                                } else {\n                                    tooltip.info(locale_freezen.noSeletionError, '');\n                                }\n                                return;\n                            }\n                            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                            let col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollLeft);\n                            let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                            let column_focus = last['column_focus'] == null ? last['column'][0] : last['column_focus'];\n                            if (column_focus > col_st) {\n                                col_st = column_focus;\n                            }\n                            if (col_st == -1) {\n                                col_st = 0;\n                            }\n                            let left = Store.visibledatacolumn[col_st] - 2 - scrollLeft + Store.rowHeaderWidth;\n                            let freezenverticaldata = [\n                                Store.visibledatacolumn[col_st],\n                                col_st + 1,\n                                scrollLeft,\n                                luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_st + 1),\n                                left\n                            ];\n                            luckysheetFreezen.saveFreezen(null, null, freezenverticaldata, left);\n                            if (luckysheetFreezen.freezenhorizontaldata != null) {\n                                luckysheetFreezen.cancelFreezenHorizontal();\n                                luckysheetFreezen.createAssistCanvas();\n                                luckysheetrefreshgrid();\n                            }\n                            luckysheetFreezen.createFreezenVertical(freezenverticaldata, left);\n                            luckysheetFreezen.createAssistCanvas();\n                            luckysheetrefreshgrid();\n                        } else if (itemvalue == 'freezenRCRange') {\n                            //\n                            if (Store.luckysheet_select_save == null || Store.luckysheet_select_save.length == 0) {\n                                if (isEditMode()) {\n                                    alert(locale_freezen.noSeletionError);\n                                } else {\n                                    tooltip.info(locale_freezen.noSeletionError, '');\n                                }\n                                return;\n                            }\n                            let scrollTop = $('#luckysheet-cell-main').scrollTop();\n                            let row_st = luckysheet_searcharray(Store.visibledatarow, scrollTop);\n                            let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                            let row_focus = last['row_focus'] == null ? last['row'][0] : last['row_focus'];\n                            if (row_focus > row_st) {\n                                row_st = row_focus;\n                            }\n                            if (row_st == -1) {\n                                row_st = 0;\n                            }\n                            let top = Store.visibledatarow[row_st] - 2 - scrollTop + Store.columnHeaderHeight;\n                            let freezenhorizontaldata = [\n                                Store.visibledatarow[row_st],\n                                row_st + 1,\n                                scrollTop,\n                                luckysheetFreezen.cutVolumn(Store.visibledatarow, row_st + 1),\n                                top\n                            ];\n                            luckysheetFreezen.saveFreezen(freezenhorizontaldata, top, null, null);\n                            luckysheetFreezen.createFreezenHorizontal(freezenhorizontaldata, top);\n                            let scrollLeft = $('#luckysheet-cell-main').scrollLeft();\n                            let col_st = luckysheet_searcharray(Store.visibledatacolumn, scrollLeft);\n                            let column_focus = last['column_focus'] == null ? last['column'][0] : last['column_focus'];\n                            if (column_focus > col_st) {\n                                col_st = column_focus;\n                            }\n                            if (col_st == -1) {\n                                col_st = 0;\n                            }\n                            let left = Store.visibledatacolumn[col_st] - 2 - scrollLeft + Store.rowHeaderWidth;\n                            let freezenverticaldata = [\n                                Store.visibledatacolumn[col_st],\n                                col_st + 1,\n                                scrollLeft,\n                                luckysheetFreezen.cutVolumn(Store.visibledatacolumn, col_st + 1),\n                                left\n                            ];\n                            luckysheetFreezen.saveFreezen(null, null, freezenverticaldata, left);\n                            luckysheetFreezen.createFreezenVertical(freezenverticaldata, left);\n                            luckysheetFreezen.createAssistCanvas();\n                            luckysheetrefreshgrid();\n                        } else if (itemvalue == 'freezenCancel') {\n                            //Cancel freezen\n                            if (luckysheetFreezen.freezenverticaldata != null) {\n                                luckysheetFreezen.cancelFreezenVertical();\n                                luckysheetFreezen.createAssistCanvas();\n                                luckysheetrefreshgrid();\n                            }\n                            if (luckysheetFreezen.freezenhorizontaldata != null) {\n                                luckysheetFreezen.cancelFreezenHorizontal();\n                                luckysheetFreezen.createAssistCanvas();\n                                luckysheetrefreshgrid();\n                            }\n                            luckysheetFreezen.scrollAdapt();\n                        }\n                        setTimeout(function () {\n                            luckysheetsizeauto();\n                        }, 0);\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft - 68, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-autofilter').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                if ($menuButton.length == 0) {\n                    const _locale = locale();\n                    const locale_sort = _locale.sort;\n                    const locale_filter = _locale.filter;\n                    let itemdata = [\n                        {\n                            'text': locale_sort.asc,\n                            'value': 'asc',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-shengxu\" aria-hidden=\"true\"></i>'\n                        },\n                        {\n                            'text': locale_sort.desc,\n                            'value': 'desc',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-jiangxu\" aria-hidden=\"true\"></i>'\n                        },\n                        {\n                            'text': locale_sort.custom + '...',\n                            'value': 'diysort',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-zidingyipaixu\" aria-hidden=\"true\"></i>'\n                        },\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_filter.filter,\n                            'value': 'filter',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-shaixuan2\" aria-hidden=\"true\"></i>'\n                        },\n                        {\n                            'text': locale_filter.clearFilter,\n                            'value': 'clearfilter',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-qingchushaixuan\" aria-hidden=\"true\"></i>'\n                        }\n                    ];\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'autofilter',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId).width(150);\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (itemvalue == 'diysort') {\n                            $('#luckysheetorderby').click();\n                        } else if (itemvalue == 'asc') {\n                            sortSelection(true);\n                        } else if (itemvalue == 'desc') {\n                            sortSelection(false);\n                        } else if (itemvalue == 'filter') {\n                            if ($('#luckysheet-filter-options-sheet' + Store.currentSheetIndex).length > 0) {\n                                $('#luckysheet-filter-initial').click();\n                            } else {\n                                createFilter();\n                            }\n                        } else if (itemvalue == 'clearfilter') {\n                            $('#luckysheet-filter-initial').click();\n                        }\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-seachmore').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                const _locale = locale();\n                const locale_findAndReplace = _locale.findAndReplace;\n                if ($menuButton.length == 0) {\n                    let itemdata = [\n                        {\n                            'text': locale_findAndReplace.find + ' ...',\n                            'value': 'search',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-sousuo\" aria-hidden=\"true\"></i>'\n                        },\n                        {\n                            'text': locale_findAndReplace.replace + ' ...',\n                            'value': 'replace',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-tihuan\" aria-hidden=\"true\"></i>'\n                        },\n                        // {\"text\": locale_findAndReplace.goto+\" ...\", \"value\": \"goto\", \"example\": '<i class=\"iconfont luckysheet-iconfont-zhuandao1\" aria-hidden=\"true\"></i>'},\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_findAndReplace.location + ' ...',\n                            'value': 'location',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-dingwei\" aria-hidden=\"true\"></i>'\n                        },\n                        {\n                            'text': locale_findAndReplace.formula,\n                            'value': 'locationFormula',\n                            'example': locale_findAndReplace.locationExample\n                        },\n                        {\n                            'text': locale_findAndReplace.date,\n                            'value': 'locationConstantDate',\n                            'example': locale_findAndReplace.locationExample\n                        },\n                        {\n                            'text': locale_findAndReplace.number,\n                            'value': 'locationConstantNumber',\n                            'example': locale_findAndReplace.locationExample\n                        },\n                        {\n                            'text': locale_findAndReplace.string,\n                            'value': 'locationConstantString',\n                            'example': locale_findAndReplace.locationExample\n                        },\n                        {\n                            'text': locale_findAndReplace.error,\n                            'value': 'locationConstantError',\n                            'example': locale_findAndReplace.locationExample\n                        },\n                        {\n                            'text': locale_findAndReplace.condition,\n                            'value': 'locationCF',\n                            'example': locale_findAndReplace.locationExample\n                        },\n                        {\n                            'text': locale_findAndReplace.rowSpan,\n                            'value': 'locationStepRow',\n                            'example': locale_findAndReplace.locationExample\n                        },\n                        {\n                            'text': locale_findAndReplace.columnSpan,\n                            'value': 'locationStepColumn',\n                            'example': locale_findAndReplace.locationExample\n                        }\n                    ];\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'seachmore',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId).width(180);\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (itemvalue == 'search' || itemvalue == 'replace') {\n                            //\n                            if (itemvalue == 'search') {\n                                luckysheetSearchReplace.createDialog(0);\n                            } else if (itemvalue == 'replace') {\n                                luckysheetSearchReplace.createDialog(1);\n                            }\n                            luckysheetSearchReplace.init();\n                            $('#luckysheet-search-replace #searchInput input').focus();\n                        } else if (itemvalue == 'location') {\n                            //\n                            luckysheetLocationCell.createDialog();\n                            luckysheetLocationCell.init();\n                        } else if (itemvalue == 'locationFormula' || itemvalue == 'locationConstantDate' || itemvalue == 'locationConstantNumber' || itemvalue == 'locationConstantString' || itemvalue == 'locationConstantError' || itemvalue == 'locationCF') {\n                            let last = Store.luckysheet_select_save[0];\n                            let range;\n                            if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && last.row[0] == last.row[1] && last.column[0] == last.column[1]) {\n                                //\n                                range = [{\n                                        'row': [\n                                            0,\n                                            Store.flowdata.length - 1\n                                        ],\n                                        'column': [\n                                            0,\n                                            Store.flowdata[0].length - 1\n                                        ]\n                                    }];\n                            } else {\n                                range = $.extend(true, [], Store.luckysheet_select_save);\n                            }\n                            if (itemvalue == 'locationFormula') {\n                                //\n                                luckysheetLocationCell.apply(range, 'locationFormula', 'all');\n                            } else if (itemvalue == 'locationConstantDate') {\n                                //\n                                luckysheetLocationCell.apply(range, 'locationConstant', 'd');\n                            } else if (itemvalue == 'locationConstantNumber') {\n                                //\n                                luckysheetLocationCell.apply(range, 'locationConstant', 'n');\n                            } else if (itemvalue == 'locationConstantString') {\n                                //\n                                luckysheetLocationCell.apply(range, 'locationConstant', 's,g');\n                            } else if (itemvalue == 'locationConstantError') {\n                                //\n                                luckysheetLocationCell.apply(range, 'locationConstant', 'e');\n                            } else if (itemvalue == 'locationCF') {\n                                //\n                                luckysheetLocationCell.apply(range, 'locationCF');\n                            }\n                        } else if (itemvalue == 'locationStepRow') {\n                            //\n                            if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1]) {\n                                if (isEditMode()) {\n                                    alert(locale_findAndReplace.lessTwoRowTip);\n                                } else {\n                                    tooltip.info('', locale_findAndReplace.lessTwoRowTip);\n                                }\n                                return;\n                            }\n                            let range = $.extend(true, [], Store.luckysheet_select_save);\n                            luckysheetLocationCell.apply(range, 'locationStepRow');\n                        } else if (itemvalue == 'locationStepColumn') {\n                            //\n                            if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                                if (isEditMode()) {\n                                    alert(locale_findAndReplace.lessTwoColumnTip);\n                                } else {\n                                    tooltip.info('', locale_findAndReplace.lessTwoColumnTip);\n                                }\n                                return;\n                            }\n                            let range = $.extend(true, [], Store.luckysheet_select_save);\n                            luckysheetLocationCell.apply(range, 'locationStepColumn');\n                        }\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-function').click(function () {\n                _this.autoSelectionFormula('SUM');\n            });    //\n            //\n            $('#luckysheet-icon-function-menu').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                const _locale = locale();\n                const locale_formula = _locale.formula;\n                if ($menuButton.length == 0) {\n                    let itemdata = [\n                        {\n                            'text': locale_formula.sum,\n                            'value': 'SUM',\n                            'example': 'SUM'\n                        },\n                        {\n                            'text': locale_formula.average,\n                            'value': 'AVERAGE',\n                            'example': 'AVERAGE'\n                        },\n                        {\n                            'text': locale_formula.count,\n                            'value': 'COUNT',\n                            'example': 'COUNT'\n                        },\n                        {\n                            'text': locale_formula.max,\n                            'value': 'MAX',\n                            'example': 'MAX'\n                        },\n                        {\n                            'text': locale_formula.min,\n                            'value': 'MIN',\n                            'example': 'MIN'\n                        },\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_formula.ifGenerate,\n                            'value': 'if',\n                            'example': 'IF'\n                        },\n                        {\n                            'text': locale_formula.find + ' ...',\n                            'value': 'formula',\n                            'example': ''\n                        }\n                    ];\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'function-menu',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId).width(180);\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (itemvalue == 'if') {\n                            let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                            let r = last['row_focus'] == null ? last['row'][0] : last['row_focus'];\n                            let c = last['column_focus'] == null ? last['column'][0] : last['column_focus'];\n                            if (!!Store.flowdata[r] && !!Store.flowdata[r][c] && !!Store.flowdata[r][c]['f']) {\n                                let fp = Store.flowdata[r][c]['f'].toString();\n                                if (fp.indexOf('=if(') != -1) {\n                                    ifFormulaGenerator.ifFormulaDialog(fp);\n                                } else {\n                                    if (isEditMode()) {\n                                        alert(locale_formula.tipNotBelongToIf);\n                                    } else {\n                                        tooltip.info(locale_formula.tipNotBelongToIf, '');\n                                    }\n                                    return;\n                                }\n                            } else {\n                                ifFormulaGenerator.ifFormulaDialog();\n                            }\n                            ifFormulaGenerator.init();\n                        } else if (itemvalue == 'formula') {\n                            //\n                            if (Store.luckysheet_select_save.length == 0) {\n                                if (isEditMode()) {\n                                    alert(locale_formula.tipSelectCell);\n                                } else {\n                                    tooltip.info(locale_formula.tipSelectCell, '');\n                                }\n                                return;\n                            }\n                            let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                            let row_index = last['row_focus'], col_index = last['column_focus'];\n                            luckysheetupdateCell(row_index, col_index, Store.flowdata);\n                            let cell = Store.flowdata[row_index][col_index];\n                            if (cell != null && cell.f != null) {\n                                //\n                                let functionStr = luckysheetformula.getfunctionParam(cell.f);\n                                if (functionStr.fn != null) {\n                                    //\n                                    insertFormula.formulaParmDialog(functionStr.fn, functionStr.param);\n                                } else {\n                                    //\n                                    insertFormula.formulaListDialog();\n                                }\n                            } else {\n                                //\n                                $('#luckysheet-rich-text-editor').html('<span dir=\"auto\" class=\"luckysheet-formula-text-color\">=</span>');\n                                $('#luckysheet-functionbox-cell').html($('#luckysheet-rich-text-editor').html());\n                                insertFormula.formulaListDialog();\n                            }\n                            insertFormula.init();\n                        } else {\n                            _this.autoSelectionFormula(itemvalue);\n                        }\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft - 48, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-bold').mousedown(function (e) {\n                hideMenuByCancel(e);\n                e.stopPropagation();\n            }).click(function (e) {\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                let row_index = Store.luckysheet_select_save[0]['row_focus'], col_index = Store.luckysheet_select_save[0]['column_focus'];\n                let foucsStatus = _this.checkstatus(d, row_index, col_index, 'bl');\n                if (foucsStatus == 1) {\n                    foucsStatus = 0;\n                } else {\n                    foucsStatus = 1;\n                }\n                _this.updateFormat(d, 'bl', foucsStatus);\n                _this.menuButtonFocus(d, row_index, col_index);\n            });    //\n            //\n            $('#luckysheet-icon-italic').mousedown(function (e) {\n                hideMenuByCancel(e);\n                e.stopPropagation();\n            }).click(function () {\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                let row_index = Store.luckysheet_select_save[0]['row_focus'], col_index = Store.luckysheet_select_save[0]['column_focus'];\n                let foucsStatus = _this.checkstatus(d, row_index, col_index, 'it');\n                if (foucsStatus == 1) {\n                    foucsStatus = 0;\n                } else {\n                    foucsStatus = 1;\n                }\n                _this.updateFormat(d, 'it', foucsStatus);\n                _this.menuButtonFocus(d, row_index, col_index);\n            });    //\n            //\n            $('#luckysheet-icon-strikethrough').mousedown(function (e) {\n                hideMenuByCancel(e);\n                e.stopPropagation();\n            }).click(function () {\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                let row_index = Store.luckysheet_select_save[0]['row_focus'], col_index = Store.luckysheet_select_save[0]['column_focus'];\n                let foucsStatus = _this.checkstatus(d, row_index, col_index, 'cl');\n                if (foucsStatus == 1) {\n                    foucsStatus = 0;\n                } else {\n                    foucsStatus = 1;\n                }\n                _this.updateFormat(d, 'cl', foucsStatus);\n                _this.menuButtonFocus(d, row_index, col_index);\n            });    //\n            //\n            $('#luckysheet-icon-underline').mousedown(function (e) {\n                hideMenuByCancel(e);\n                e.stopPropagation();\n            }).click(function () {\n                let d = editor.deepCopyFlowData(Store.flowdata);\n                let row_index = Store.luckysheet_select_save[0]['row_focus'], col_index = Store.luckysheet_select_save[0]['column_focus'];\n                let foucsStatus = _this.checkstatus(d, row_index, col_index, 'un');\n                if (foucsStatus == 1) {\n                    foucsStatus = 0;\n                } else {\n                    foucsStatus = 1;\n                }\n                _this.updateFormat(d, 'un', foucsStatus);\n                _this.menuButtonFocus(d, row_index, col_index);\n            });    //\n            //\n            $('#luckysheet-icon-conditionformat').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                const conditionformat_text = locale().conditionformat;\n                if ($menuButton.length == 0) {\n                    let itemdata = [\n                        {\n                            'text': conditionformat_text.highlightCellRules,\n                            'value': 'highlightCellRule',\n                            'example': 'more'\n                        },\n                        {\n                            'text': conditionformat_text.itemSelectionRules,\n                            'value': 'projectSelectRule',\n                            'example': 'more'\n                        },\n                        {\n                            'text': conditionformat_text.dataBar,\n                            'value': 'dataBar',\n                            'example': 'more'\n                        },\n                        {\n                            'text': conditionformat_text.colorGradation,\n                            'value': 'colorGradation',\n                            'example': 'more'\n                        },\n                        {\n                            'text': conditionformat_text.icons,\n                            'value': 'icons',\n                            'example': ''\n                        },\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': conditionformat_text.newRule,\n                            'value': 'newRule',\n                            'example': ''\n                        },\n                        {\n                            'text': conditionformat_text.deleteRule,\n                            'value': 'deleteRule',\n                            'example': 'more'\n                        },\n                        {\n                            'text': conditionformat_text.manageRules,\n                            'value': 'administerRule',\n                            'example': ''\n                        }\n                    ];\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'conditionformat',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });    //\n                    //\n                    let subitemdata = [\n                        {\n                            'text': conditionformat_text.greaterThan,\n                            'value': 'greaterThan',\n                            'example': '>'\n                        },\n                        {\n                            'text': conditionformat_text.lessThan,\n                            'value': 'lessThan',\n                            'example': '<'\n                        },\n                        {\n                            'text': conditionformat_text.between,\n                            'value': 'betweenness',\n                            'example': '[]'\n                        },\n                        {\n                            'text': conditionformat_text.equal,\n                            'value': 'equal',\n                            'example': '='\n                        },\n                        {\n                            'text': conditionformat_text.textContains,\n                            'value': 'textContains',\n                            'example': '()'\n                        },\n                        {\n                            'text': conditionformat_text.occurrence,\n                            'value': 'occurrenceDate',\n                            'example': conditionformat_text.yesterday\n                        },\n                        {\n                            'text': conditionformat_text.duplicateValue,\n                            'value': 'duplicateValue',\n                            'example': '##'\n                        }\n                    ];\n                    let subitemset = _this.createButtonMenu(subitemdata);\n                    let submenu = replaceHtml(_this.menu, {\n                        'id': 'highlightCellRule',\n                        'item': subitemset,\n                        'subclass': 'luckysheet-menuButton-sub'\n                    });    //\n                    //\n                    let subitemdata2 = [\n                        {\n                            'text': conditionformat_text.top10,\n                            'value': 'top10',\n                            'example': conditionformat_text.top10\n                        },\n                        {\n                            'text': conditionformat_text.top10_percent,\n                            'value': 'top10%',\n                            'example': conditionformat_text.top10_percent\n                        },\n                        {\n                            'text': conditionformat_text.last10,\n                            'value': 'last10',\n                            'example': conditionformat_text.last10\n                        },\n                        {\n                            'text': conditionformat_text.last10_percent,\n                            'value': 'last10%',\n                            'example': conditionformat_text.last10_percent\n                        },\n                        {\n                            'text': conditionformat_text.aboveAverage,\n                            'value': 'AboveAverage',\n                            'example': conditionformat_text.above\n                        },\n                        {\n                            'text': conditionformat_text.belowAverage,\n                            'value': 'SubAverage',\n                            'example': conditionformat_text.below\n                        }\n                    ];\n                    let subitemset2 = _this.createButtonMenu(subitemdata2);\n                    let submenu2 = replaceHtml(_this.menu, {\n                        'id': 'projectSelectRule',\n                        'item': subitemset2,\n                        'subclass': 'luckysheet-menuButton-sub'\n                    });    //\n                    //\n                    let submenu3 = `<div id=\"luckysheet-icon-dataBar-menuButton\" class=\"luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel\" style=\"width: 126px;padding: 5px;top: 118.5px;left: 1321.48px;display: none;\">\n                                    <div itemvalue=\"0\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: 0 0;\" title=\"${ conditionformat_text.gradientDataBar_1 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"1\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -38px 0;\" title=\"${ conditionformat_text.gradientDataBar_2 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"2\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -76px 0;\" title=\"${ conditionformat_text.gradientDataBar_3 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"3\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: 0 -36px;\" title=\"${ conditionformat_text.gradientDataBar_4 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"4\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -38px -36px;\" title=\"${ conditionformat_text.gradientDataBar_5 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"5\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -76px -36px;\" title=\"${ conditionformat_text.gradientDataBar_6 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"6\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: 0 -72px;\" title=\"${ conditionformat_text.solidColorDataBar_1 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"7\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -38px -72px;\" title=\"${ conditionformat_text.solidColorDataBar_2 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"8\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -76px -72px;\" title=\"${ conditionformat_text.solidColorDataBar_3 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"9\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: 0 -108px;\" title=\"${ conditionformat_text.solidColorDataBar_4 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"10\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -38px -108px;\" title=\"${ conditionformat_text.solidColorDataBar_5 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"11\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -76px -108px;\" title=\"${ conditionformat_text.solidColorDataBar_6 }\"></div>\n                                    </div>\n                                </div>`;    //\n                    //\n                    let submenu4 = `<div id=\"luckysheet-icon-colorGradation-menuButton\" class=\"luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel\" style=\"width: 126px;padding: 5px;top: 143.5px;left: 1321.48px;display: none;\">\n                                    <div itemvalue=\"0\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: 0 0;\" title=\"${ conditionformat_text.colorGradation_1 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"1\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -38px 0;\" title=\"${ conditionformat_text.colorGradation_2 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"2\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -76px 0;\" title=\"${ conditionformat_text.colorGradation_3 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"3\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -114px 0;\" title=\"${ conditionformat_text.colorGradation_4 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"4\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: 0 -36px;\" title=\"${ conditionformat_text.colorGradation_5 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"5\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -38px -36px;\" title=\"${ conditionformat_text.colorGradation_6 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"6\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -76px -36px;\" title=\"${ conditionformat_text.colorGradation_7 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"7\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -114px -36px;\" title=\"${ conditionformat_text.colorGradation_8 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"8\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: 0 -72px;\" title=\"${ conditionformat_text.colorGradation_9 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"9\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -38px -72px;\" title=\"${ conditionformat_text.colorGradation_10 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"10\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -76px -72px;\" title=\"${ conditionformat_text.colorGradation_11 }\"></div>\n                                    </div>\n                                    <div itemvalue=\"11\" class=\"luckysheet-cols-menuitem luckysheet-mousedown-cancel\" style=\"width: 28px; height: 26px;padding: 5px;float: left;\">\n                                        <div class=\"luckysheet-mousedown-cancel bgImgBox\" style=\"background-position: -114px -72px;\" title=\"${ conditionformat_text.colorGradation_12 }\"></div>\n                                    </div>\n                                </div>`;    //\n                    //\n                    let subitemdata6 = [{\n                            'text': conditionformat_text.deleteSheetRule,\n                            'value': 'delSheet',\n                            'example': ''\n                        }];\n                    let subitemset6 = _this.createButtonMenu(subitemdata6);\n                    let submenu6 = replaceHtml(_this.menu, {\n                        'id': 'deleteRule',\n                        'item': subitemset6,\n                        'subclass': 'luckysheet-menuButton-sub'\n                    });\n                    $('body').append(menu + submenu + submenu2 + submenu3 + submenu4 + submenu6);\n                    $menuButton = $('#' + menuButtonId).width(190);\n                    $('#luckysheet-icon-highlightCellRule-menuButton').width(160);\n                    $('#luckysheet-icon-projectSelectRule-menuButton').width(180);\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (itemvalue == 'icons') {\n                            if (Store.luckysheet_select_save.length == 0) {\n                                if (isEditMode()) {\n                                    alert(conditionformat_text.pleaseSelectRange);\n                                } else {\n                                    tooltip.info(conditionformat_text.pleaseSelectRange, '');\n                                }\n                                return;\n                            }\n                            conditionformat.CFiconsDialog();\n                            conditionformat.init();\n                        } else if (itemvalue == 'newRule') {\n                            if (Store.luckysheet_select_save.length == 0) {\n                                if (isEditMode()) {\n                                    alert(conditionformat_text.pleaseSelectRange);\n                                } else {\n                                    tooltip.info(conditionformat_text.pleaseSelectRange, '');\n                                }\n                                return;\n                            }\n                            conditionformat.newConditionRuleDialog(0);\n                            conditionformat.init();\n                        } else if (itemvalue == 'administerRule') {\n                            let loadSheetUrl = server.loadSheetUrl;\n                            let file = getluckysheetfile();\n                            if (loadSheetUrl != '' && loadSheetUrl != null) {\n                                let sheetindex = [];\n                                for (let i = 0; i < file.length; i++) {\n                                    sheetindex.push(file[i].index);\n                                }\n                                $.post(loadSheetUrl, {\n                                    'gridKey': server.gridKey,\n                                    'index': sheetindex.join(',')\n                                }, function (d) {\n                                    let dataset = new Function('return ' + d)();\n                                    setTimeout(function () {\n                                        $('#luckysheetloadingdata').fadeOut().remove();\n                                    }, 500);\n                                    for (let item in dataset) {\n                                        if (item == Store.currentSheetIndex) {\n                                            continue;\n                                        }\n                                        let otherfile = file[getSheetIndex(item)];\n                                        otherfile.celldata = dataset[item.toString()];\n                                        otherfile['data'] = sheetmanage.buildGridData(otherfile);\n                                    }\n                                    setluckysheetfile(file);\n                                    conditionformat.fileClone = $.extend(true, [], file);\n                                    conditionformat.administerRuleDialog();\n                                    conditionformat.init();\n                                });\n                            } else {\n                                conditionformat.fileClone = $.extend(true, [], file);\n                                conditionformat.administerRuleDialog();\n                                conditionformat.init();\n                            }\n                        }\n                    });    //\n                    //\n                    $(document).off('click.CFhighlightCellRule').on('click.CFhighlightCellRule', '#luckysheet-icon-highlightCellRule-menuButton .luckysheet-cols-menuitem', function () {\n                        $menuButton.hide();\n                        $('#luckysheet-icon-highlightCellRule-menuButton').hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (Store.luckysheet_select_save.length == 0) {\n                            if (isEditMode()) {\n                                alert(conditionformat_text.pleaseSelectRange);\n                            } else {\n                                tooltip.info(conditionformat_text.pleaseSelectRange, '');\n                            }\n                            return;\n                        } else {\n                            let textCellColorHtml = conditionformat.textCellColorHtml();\n                            let title, content;\n                            switch (itemvalue) {\n                            case 'greaterThan':\n                                title = conditionformat_text.conditionformat_greaterThan;\n                                content = `<div class=\"box\" data-itemvalue=\"greaterThan\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_greaterThan_title }</div>\n                                                <div class=\"inpbox range\">\n                                                    <input id=\"conditionVal\" class=\"formulaInputFocus\"/>\n                                                    <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ conditionformat_text.selectCell }\"></i>\n                                                </div>\n                                                <div style=\"margin: 5px 0;\">${ conditionformat_text.setAs }</div> \n                                                ${ textCellColorHtml } \n                                            </div>`;\n                                break;\n                            case 'lessThan':\n                                title = conditionformat_text.conditionformat_lessThan;\n                                content = `<div class=\"box\" data-itemvalue=\"lessThan\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_lessThan_title }</div>\n                                                <div class=\"inpbox range\">\n                                                    <input id=\"conditionVal\" class=\"formulaInputFocus\"/>\n                                                    <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ conditionformat_text.selectCell }\"></i>\n                                                </div>\n                                                <div style=\"margin: 5px 0;\">${ conditionformat_text.setAs }</div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            case 'betweenness':\n                                title = conditionformat_text.conditionformat_betweenness;\n                                content = `<div class=\"box\" data-itemvalue=\"betweenness\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_betweenness_title }</div>\n                                                <div style=\"height: 30px;line-height: 30px;\">\n                                                    <div class=\"inpbox2 range\">\n                                                        <input id=\"conditionVal\" class=\"formulaInputFocus\"/>\n                                                        <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ conditionformat_text.selectCell }\"></i>\n                                                    </div>\n                                                    <div style=\"float: left;height: 30px;line-height: 30px;margin: 0 5px;\">${ conditionformat_text.to }</div>\n                                                    <div class=\"inpbox2 range\">\n                                                        <input id=\"conditionVal2\" class=\"formulaInputFocus\"/>\n                                                        <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ conditionformat_text.selectCell }\"></i>\n                                                    </div>\n                                                </div>\n                                                <div style=\"margin: 5px 0;\">${ conditionformat_text.setAs }</div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            case 'equal':\n                                title = conditionformat_text.conditionformat_equal;\n                                content = `<div class=\"box\" data-itemvalue=\"equal\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_equal_title }</div>\n                                                <div class=\"inpbox range\">\n                                                    <input id=\"conditionVal\" class=\"formulaInputFocus\"/>\n                                                    <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ conditionformat_text.selectCell }\"></i>\n                                                </div>\n                                                <div style=\"margin: 5px 0;\">${ conditionformat_text.setAs }</div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            case 'textContains':\n                                title = conditionformat_text.conditionformat_textContains;\n                                content = `<div class=\"box\" data-itemvalue=\"textContains\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_textContains_title }</div>\n                                                <div class=\"inpbox range\">\n                                                    <input id=\"conditionVal\" class=\"formulaInputFocus\"/>\n                                                    <i class=\"fa fa-table\" aria-hidden=\"true\" title=\"${ conditionformat_text.selectCell }\"></i>\n                                                </div>\n                                                <div style=\"margin: 5px 0;\">${ conditionformat_text.setAs }</div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            case 'occurrenceDate':\n                                title = conditionformat_text.conditionformat_occurrenceDate;\n                                content = `<div class=\"box\" data-itemvalue=\"occurrenceDate\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_occurrenceDate_title }</div>\n                                                <div class=\"inpbox\">\n                                                    <input id=\"daterange-btn\" class=\"formulaInputFocus\" readonly=\"readonly\" placeholder=\"${ conditionformat_text.pleaseSelectADate }\"/>\n                                                </div>\n                                                <div style=\"margin: 5px 0;\">${ conditionformat_text.setAs }</div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            case 'duplicateValue':\n                                title = conditionformat_text.conditionformat_duplicateValue;\n                                content = `<div class=\"box\" data-itemvalue=\"duplicateValue\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_duplicateValue_title }</div>\n                                                <select id=\"conditionVal\" class=\"selectbox\">\n                                                    <option value=\"0\">${ conditionformat_text.duplicateValue }</option>\n                                                    <option value=\"1\">${ conditionformat_text.uniqueValue }</option>\n                                                </select>\n                                                <div style=\"margin:5px 0;\">${ conditionformat_text.setAs }</div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            }\n                            conditionformat.conditionformatDialog(title, content);\n                        }\n                    });    //\n                    //\n                    $(document).off('click.CFprojectSelectRule').on('click.CFprojectSelectRule', '#luckysheet-icon-projectSelectRule-menuButton .luckysheet-cols-menuitem', function () {\n                        $menuButton.hide();\n                        $('#luckysheet-icon-projectSelectRule-menuButton').hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (Store.luckysheet_select_save.length == 0) {\n                            if (isEditMode()) {\n                                alert(conditionformat_text.pleaseSelectRange);\n                            } else {\n                                tooltip.info(conditionformat_text.pleaseSelectRange, '');\n                            }\n                            return;\n                        } else {\n                            let textCellColorHtml = conditionformat.textCellColorHtml();\n                            let title, content;\n                            switch (itemvalue) {\n                            case 'top10':\n                                title = conditionformat_text.conditionformat_top10;\n                                content = `<div class=\"box\" data-itemvalue=\"top10\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_top10_title }</div>\n                                                <div style=\"height: 30px;line-height: 30px;\">\n                                                    <div style=\"float: left;height: 30px;line-height: 30px;margin: 0 5px;\">${ conditionformat_text.top }</div>\n                                                    <div class=\"inpbox2\">\n                                                        <input id=\"conditionVal\" class=\"formulaInputFocus\" type=\"number\" value=\"10\"/>\n                                                    </div>\n                                                    <div style=\"float: left;height: 30px;line-height: 30px;margin: 0 5px;\">${ conditionformat_text.oneself }</div>\n                                                </div>\n                                                <div style=\"margin: 5px 0;\">${ conditionformat_text.setAs }</div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            case 'top10%':\n                                title = conditionformat_text.conditionformat_top10_percent;\n                                content = `<div class=\"box\" data-itemvalue=\"top10%\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_top10_title }</div>\n                                                <div style=\"height: 30px;line-height: 30px;\">\n                                                    <div style=\"float: left;height: 30px;line-height: 30px;margin: 0 5px;\">${ conditionformat_text.top }</div>\n                                                    <div class=\"inpbox2\">\n                                                        <input id=\"conditionVal\" class=\"formulaInputFocus\" type=\"number\" value=\"10\"/>\n                                                    </div>\n                                                    <div style=\"float: left;height: 30px;line-height: 30px;margin: 0 5px;\">%</div>\n                                                </div>\n                                                <div style=\"margin: 5px 0;\">${ conditionformat_text.setAs }</div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            case 'last10':\n                                title = conditionformat_text.conditionformat_last10;\n                                content = `<div class=\"box\" data-itemvalue=\"last10\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_last10_title }</div>\n                                                <div style=\"height: 30px;line-height: 30px;\">\n                                                    <div style=\"float: left;height: 30px;line-height: 30px;margin: 0 5px;\">${ conditionformat_text.last }</div>\n                                                    <div class=\"inpbox2\">\n                                                        <input id=\"conditionVal\" class=\"formulaInputFocus\" type=\"number\" value=\"10\"/>\n                                                    </div>\n                                                    <div style=\"float: left;height: 30px;line-height: 30px;margin: 0 5px;\">${ conditionformat_text.oneself }</div>\n                                                </div>\n                                                <div style=\"margin: 5px 0;\">${ conditionformat_text.setAs }</div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            case 'last10%':\n                                title = conditionformat_text.conditionformat_last10_percent;\n                                content = `<div class=\"box\" data-itemvalue=\"last10%\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_last10_title }</div>\n                                                <div style=\"height: 30px;line-height: 30px;\">\n                                                    <div style=\"float: left;height: 30px;line-height: 30px;margin: 0 5px;\">${ conditionformat_text.last }</div>\n                                                    <div class=\"inpbox2\">\n                                                        <input id=\"conditionVal\" class=\"formulaInputFocus\" type=\"number\" value=\"10\"/>\n                                                    </div>\n                                                    <div style=\"float: left;height: 30px;line-height: 30px;margin: 0 5px;\">%</div>\n                                                </div>\n                                                <div style=\"margin:5px 0;\"></div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            case 'AboveAverage':\n                                title = conditionformat_text.conditionformat_AboveAverage;\n                                content = `<div class=\"box\" data-itemvalue=\"AboveAverage\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_AboveAverage_title }</div>\n                                                <div style=\"margin: 5px 0;\">${ conditionformat_text.setAsByArea }</div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            case 'SubAverage':\n                                title = conditionformat_text.conditionformat_SubAverage;\n                                content = `<div class=\"box\" data-itemvalue=\"SubAverage\">\n                                                <div class=\"boxTitleOne\">${ conditionformat_text.conditionformat_SubAverage_title }</div>\n                                                <div style=\"margin: 5px 0;\">${ conditionformat_text.setAsByArea }</div>\n                                                ${ textCellColorHtml }\n                                            </div>`;\n                                break;\n                            }\n                            conditionformat.conditionformatDialog(title, content);\n                        }\n                    });    //\n                    //\n                    $(document).off('click.CFdataBar').on('click.CFdataBar', '#luckysheet-icon-dataBar-menuButton .luckysheet-cols-menuitem', function () {\n                        $menuButton.hide();\n                        $('#luckysheet-icon-dataBar-menuButton').hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (Store.luckysheet_select_save.length > 0) {\n                            let cellrange = $.extend(true, [], Store.luckysheet_select_save);\n                            let format = conditionformat.dataBarList[itemvalue]['format'];\n                            conditionformat.updateItem('dataBar', cellrange, format);\n                        }\n                    });    //\n                    //\n                    $(document).off('click.CFcolorGradation').on('click.CFcolorGradation', '#luckysheet-icon-colorGradation-menuButton .luckysheet-cols-menuitem', function () {\n                        $menuButton.hide();\n                        $('#luckysheet-icon-colorGradation-menuButton').hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (Store.luckysheet_select_save.length > 0) {\n                            let cellrange = $.extend(true, [], Store.luckysheet_select_save);\n                            let format = conditionformat.colorGradationList[itemvalue]['format'];\n                            conditionformat.updateItem('colorGradation', cellrange, format);\n                        }\n                    });    //\n                    //\n                    $(document).off('click.CFdeleteRule').on('click.CFdeleteRule', '#luckysheet-icon-deleteRule-menuButton .luckysheet-cols-menuitem', function () {\n                        $menuButton.hide();\n                        $('#luckysheet-icon-deleteRule-menuButton').hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (itemvalue == 'delSheet') {\n                            conditionformat.updateItem('delSheet');\n                        }\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft, $(this).offset().top + 25, 'lefttop');\n            });    //\n            //\n            $('#luckysheet-icon-postil').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                const locale_comment = locale().comment;\n                $menuButton.remove();    // if($menuButton.length == 0){\n                // if($menuButton.length == 0){\n                luckysheetPostil.removeActivePs();\n                let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n                let row_index = last['row_focus'];\n                if (row_index == null) {\n                    row_index = last['row'][0];\n                }\n                let col_index = last['column_focus'];\n                if (col_index == null) {\n                    col_index = last['column'][0];\n                }\n                let itemdata;\n                if (Store.flowdata[row_index][col_index] != null && Store.flowdata[row_index][col_index].ps != null) {\n                    itemdata = [\n                        {\n                            'text': locale_comment.edit,\n                            'value': 'editPs',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_comment.delete,\n                            'value': 'delPs',\n                            'example': ''\n                        },\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_comment.showOne,\n                            'value': 'showHidePs',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_comment.showAll,\n                            'value': 'showHideAllPs',\n                            'example': ''\n                        }\n                    ];\n                } else {\n                    itemdata = [\n                        {\n                            'text': locale_comment.insert,\n                            'value': 'newPs',\n                            'example': ''\n                        },\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_comment.showAll,\n                            'value': 'showHideAllPs',\n                            'example': ''\n                        }\n                    ];\n                }\n                let itemset = _this.createButtonMenu(itemdata);\n                let menu = replaceHtml(_this.menu, {\n                    'id': 'postil',\n                    'item': itemset,\n                    'subclass': '',\n                    'sub': ''\n                });\n                $('body').append(menu);\n                $menuButton = $('#' + menuButtonId).width(150);\n                $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                    $menuButton.hide();\n                    luckysheetContainerFocus();\n                    let $t = $(this), itemvalue = $t.attr('itemvalue');\n                    if (itemvalue == 'newPs') {\n                        luckysheetPostil.newPs(row_index, col_index);\n                    } else if (itemvalue == 'editPs') {\n                        luckysheetPostil.editPs(row_index, col_index);\n                    } else if (itemvalue == 'delPs') {\n                        luckysheetPostil.delPs(row_index, col_index);\n                    } else if (itemvalue == 'showHidePs') {\n                        luckysheetPostil.showHidePs(row_index, col_index);\n                    } else if (itemvalue == 'showHideAllPs') {\n                        luckysheetPostil.showHideAllPs();\n                    }\n                });    // }\n                // }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft, $(this).offset().top + 25, 'lefttop');\n            });    //sheet protection\n            //sheet protection\n            $('#luckysheet-icon-protection').click(function () {\n                let sheetFile = sheetmanage.getSheetByIndex();\n                openProtectionModal(sheetFile);\n            });    //print\n            //print\n            $('#luckysheet-icon-print').click(function () {\n                let menuButtonId = $(this).attr('id') + '-menuButton';\n                let $menuButton = $('#' + menuButtonId);\n                const _locale = locale();\n                const locale_print = _locale.print;\n                if ($menuButton.length == 0) {\n                    let itemdata = [\n                        {\n                            'text': locale_print.menuItemPrint,\n                            'value': 'print',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-dayin\" aria-hidden=\"true\"></i>'\n                        },\n                        {\n                            'text': '',\n                            'value': 'split',\n                            'example': ''\n                        },\n                        {\n                            'text': locale_print.menuItemAreas,\n                            'value': 'areas',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-tihuan\" aria-hidden=\"true\"></i>'\n                        },\n                        {\n                            'text': locale_print.menuItemRows,\n                            'value': 'rows',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-zhuandao1\" aria-hidden=\"true\"></i>'\n                        },\n                        {\n                            'text': locale_print.menuItemColumns,\n                            'value': 'columns',\n                            'example': '<i class=\"iconfont luckysheet-iconfont-dingwei\" aria-hidden=\"true\"></i>'\n                        }\n                    ];\n                    let itemset = _this.createButtonMenu(itemdata);\n                    let menu = replaceHtml(_this.menu, {\n                        'id': 'print',\n                        'item': itemset,\n                        'subclass': '',\n                        'sub': ''\n                    });\n                    $('body').append(menu);\n                    $menuButton = $('#' + menuButtonId).width(180);\n                    $menuButton.find('.luckysheet-cols-menuitem').click(function () {\n                        $menuButton.hide();\n                        luckysheetContainerFocus();\n                        let $t = $(this), itemvalue = $t.attr('itemvalue');\n                        if (itemvalue == 'print') {\n                            //Print config\n                            alert('print');\n                        } else if (itemvalue == 'areas' || itemvalue == 'rows' || itemvalue == 'columns') {\n                            //range\n                            alert('areas');\n                        }\n                    });\n                }\n                let userlen = $(this).outerWidth();\n                let tlen = $menuButton.outerWidth();\n                let menuleft = $(this).offset().left;\n                if (tlen > userlen && tlen + menuleft > $('#' + Store.container).width()) {\n                    menuleft = menuleft - tlen + userlen;\n                }\n                mouseclickposition($menuButton, menuleft, $(this).offset().top + 25, 'lefttop');\n            });\n            $('body').on('mouseover mouseleave', '.luckysheet-menuButton .luckysheet-cols-submenu', function (e) {\n                let $t = $(this), attrid = $t.attr('itemvalue'), $attr = $('#luckysheet-icon-' + attrid + '-menuButton');\n                if (e.type === 'mouseover') {\n                    let $con = $t.parent();\n                    let winW = $(window).width(), winH = $(window).height();\n                    let menuW = $con.width(), attrH = $attr.height() + 25, attrW = $attr.width() + 5;\n                    let offset = $t.offset();\n                    let top = offset.top, left = offset.left + menuW;\n                    if (left + attrW > winW) {\n                        left = offset.left - attrW;\n                    }\n                    if (top + attrH > winH) {\n                        top = winH - attrH;\n                    }\n                    $attr.css({\n                        'top': top,\n                        'left': left\n                    }).show();\n                    _this.rightclickmenu = $t;\n                } else {\n                    clearTimeout(_this.submenuhide[$attr.attr('id')]);\n                    _this.submenuhide[$attr.attr('id')] = setTimeout(function () {\n                        $attr.hide();\n                    }, 200);\n                }\n            }).on('mouseover mouseleave', '.luckysheet-menuButton-sub', function (e) {\n                if (e.type === 'mouseover') {\n                    _this.rightclickmenu.addClass('luckysheet-cols-menuitem-hover');\n                    clearTimeout(_this.submenuhide[$(this).attr('id')]);\n                } else {\n                    _this.rightclickmenu.removeClass('luckysheet-cols-menuitem-hover');\n                    $(this).hide();\n                }\n            });\n        },\n        getQKBorder: function (width, type, color) {\n            let bordertype = '';\n            if (width.indexOf('pt') > -1) {\n                width = parseFloat(width);\n                if (width < 1) {\n                } else if (width < 1.5) {\n                    bordertype = 'Medium';\n                } else {\n                    bordertype = 'Thick';\n                }\n            } else {\n                width = parseFloat(width);\n                if (width < 2) {\n                } else if (width < 3) {\n                    bordertype = 'Medium';\n                } else {\n                    bordertype = 'Thick';\n                }\n            }\n            let style = 0;\n            type = type.toLowerCase();\n            if (type == 'double') {\n                style = 2;\n            } else if (type == 'dotted') {\n                if (bordertype == 'Medium' || bordertype == 'Thick') {\n                    style = 3;\n                } else {\n                    style = 10;\n                }\n            } else if (type == 'dashed') {\n                if (bordertype == 'Medium' || bordertype == 'Thick') {\n                    style = 4;\n                } else {\n                    style = 9;\n                }\n            } else if (type == 'solid') {\n                if (bordertype == 'Medium') {\n                    style = 8;\n                } else if (bordertype == 'Thick') {\n                    style = 13;\n                } else {\n                    style = 1;\n                }\n            }\n            return [\n                style,\n                color\n            ];\n        },\n        updateFormatCell: function (d, attr, foucsStatus, row_st, row_ed, col_st, col_ed) {\n            if (d == null || attr == null) {\n                return;\n            }\n            if (attr == 'ct') {\n                for (let r = row_st; r <= row_ed; r++) {\n                    if (Store.config['rowhidden'] != null && Store.config['rowhidden'][r] != null) {\n                        continue;\n                    }\n                    for (let c = col_st; c <= col_ed; c++) {\n                        let cell = d[r][c], value = null;\n                        if (getObjType(cell) == 'object') {\n                            value = d[r][c]['v'];\n                        } else {\n                            value = d[r][c];\n                        }\n                        if (foucsStatus != '@' && isRealNum(value)) {\n                            value = parseFloat(value);\n                        }\n                        let mask = update(foucsStatus, value);\n                        let type = 'n';\n                        if (is_date(foucsStatus) || foucsStatus === 14 || foucsStatus === 15 || foucsStatus === 16 || foucsStatus === 17 || foucsStatus === 18 || foucsStatus === 19 || foucsStatus === 20 || foucsStatus === 21 || foucsStatus === 22 || foucsStatus === 45 || foucsStatus === 46 || foucsStatus === 47) {\n                            type = 'd';\n                        } else if (foucsStatus == '@' || foucsStatus === 49) {\n                            type = 's';\n                        } else if (foucsStatus == 'General' || foucsStatus === 0) {\n                            type = 'g';\n                        }\n                        if (getObjType(cell) == 'object') {\n                            d[r][c]['m'] = mask;\n                            if (d[r][c]['ct'] == null) {\n                                d[r][c]['ct'] = {};\n                            }\n                            d[r][c]['ct']['fa'] = foucsStatus;\n                            d[r][c]['ct']['t'] = type;\n                        } else {\n                            d[r][c] = {\n                                'ct': {\n                                    'fa': foucsStatus,\n                                    't': type\n                                },\n                                'v': value,\n                                'm': mask\n                            };\n                        }\n                    }\n                }\n            } else {\n                if (attr == 'ht') {\n                    if (foucsStatus == 'left') {\n                        foucsStatus = '1';\n                    } else if (foucsStatus == 'center') {\n                        foucsStatus = '0';\n                    } else if (foucsStatus == 'right') {\n                        foucsStatus = '2';\n                    }\n                } else if (attr == 'vt') {\n                    if (foucsStatus == 'top') {\n                        foucsStatus = '1';\n                    } else if (foucsStatus == 'middle') {\n                        foucsStatus = '0';\n                    } else if (foucsStatus == 'bottom') {\n                        foucsStatus = '2';\n                    }\n                } else if (attr == 'tb') {\n                    if (foucsStatus == 'overflow') {\n                        foucsStatus = '1';\n                    } else if (foucsStatus == 'clip') {\n                        foucsStatus = '0';\n                    } else if (foucsStatus == 'wrap') {\n                        foucsStatus = '2';\n                    }\n                } else if (attr == 'tr') {\n                    if (foucsStatus == 'none') {\n                        foucsStatus = '0';\n                    } else if (foucsStatus == 'angleup') {\n                        foucsStatus = '1';\n                    } else if (foucsStatus == 'angledown') {\n                        foucsStatus = '2';\n                    } else if (foucsStatus == 'vertical') {\n                        foucsStatus = '3';\n                    } else if (foucsStatus == 'rotation-up') {\n                        foucsStatus = '4';\n                    } else if (foucsStatus == 'rotation-down') {\n                        foucsStatus = '5';\n                    }\n                }\n                for (let r = row_st; r <= row_ed; r++) {\n                    if (Store.config['rowhidden'] != null && Store.config['rowhidden'][r] != null) {\n                        continue;\n                    }\n                    for (let c = col_st; c <= col_ed; c++) {\n                        let value = d[r][c];\n                        if (getObjType(value) == 'object') {\n                            // if(attr in inlineStyleAffectAttribute && isInlineStringCell(value)){\n                            updateInlineStringFormatOutside(value, attr, foucsStatus);    // }\n                                                                                          // else{\n                            // }\n                            // else{\n                            d[r][c][attr] = foucsStatus;    // }\n                        } else\n                            // }\n                            {\n                                d[r][c] = { v: value };\n                                d[r][c][attr] = foucsStatus;\n                            }    // if(attr == \"tr\" && d[r][c].tb != null){\n                                 //     d[r][c].tb = \"0\";\n                                 // }\n                    }\n                }\n            }\n        },\n        // if(attr == \"tr\" && d[r][c].tb != null){\n        //     d[r][c].tb = \"0\";\n        // }\n        updateFormat: function (d, attr, foucsStatus) {\n            let _this = this;\n            if (!checkProtectionFormatCells(Store.currentSheetIndex)) {\n                return;\n            }\n            if (Store.allowEdit === false) {\n                return;\n            }\n            let canvasElement = document.createElement('canvas');\n            let canvas = canvasElement.getContext('2d');\n            if (attr in inlineStyleAffectAttribute) {\n                if (parseInt($('#luckysheet-input-box').css('top')) > 0) {\n                    let value = $('#luckysheet-input-box').text();\n                    if (value.substr(0, 1) != '=') {\n                        let cell = d[Store.luckysheetCellUpdate[0]][Store.luckysheetCellUpdate[1]];\n                        updateInlineStringFormat(cell, attr, foucsStatus, luckysheetformula.rangeResizeTo);    // return;\n                    }\n                }\n            }\n            // return;\n            let cfg = $.extend(true, {}, Store.config);\n            if (cfg['rowlen'] == null) {\n                cfg['rowlen'] = {};\n            }\n            for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                let row_st = Store.luckysheet_select_save[s]['row'][0], row_ed = Store.luckysheet_select_save[s]['row'][1];\n                let col_st = Store.luckysheet_select_save[s]['column'][0], col_ed = Store.luckysheet_select_save[s]['column'][1];\n                this.updateFormatCell(d, attr, foucsStatus, row_st, row_ed, col_st, col_ed);\n                if (attr == 'tb' || attr == 'tr' || attr == 'fs') {\n                    cfg = rowlenByRange(d, row_st, row_ed, cfg);\n                }\n            }\n            let allParam = {};\n            if (attr == 'tb' || attr == 'tr' || attr == 'fs') {\n                allParam = {\n                    'cfg': cfg,\n                    'RowlChange': true\n                };\n            }\n            jfrefreshgrid(d, Store.luckysheet_select_save, allParam, false);\n        },\n        updateFormat_mc: function (d, foucsStatus) {\n            let cfg = $.extend(true, {}, Store.config);\n            if (cfg['merge'] == null) {\n                cfg['merge'] = {};\n            }\n            if (!checkProtectionNotEnable(Store.currentSheetIndex)) {\n                return;\n            }\n            if (foucsStatus == 'mergeCancel') {\n                for (let i = 0; i < Store.luckysheet_select_save.length; i++) {\n                    let range = Store.luckysheet_select_save[i];\n                    let r1 = range['row'][0], r2 = range['row'][1];\n                    let c1 = range['column'][0], c2 = range['column'][1];\n                    if (r1 == r2 && c1 == c2) {\n                        continue;\n                    }\n                    let fv = {};\n                    for (let r = r1; r <= r2; r++) {\n                        for (let c = c1; c <= c2; c++) {\n                            let cell = d[r][c];\n                            if (cell != null && cell.mc != null) {\n                                let mc_r = cell.mc.r, mc_c = cell.mc.c;\n                                if ('rs' in cell.mc) {\n                                    delete cell.mc;\n                                    delete cfg['merge'][mc_r + '_' + mc_c];\n                                    fv[mc_r + '_' + mc_c] = $.extend(true, {}, cell);\n                                } else {\n                                    // let cell_clone = fv[mc_r + \"_\" + mc_c];\n                                    let cell_clone = JSON.parse(JSON.stringify(fv[mc_r + '_' + mc_c]));\n                                    delete cell_clone.v;\n                                    delete cell_clone.m;\n                                    delete cell_clone.ct;\n                                    delete cell_clone.f;\n                                    delete cell_clone.spl;\n                                    d[r][c] = cell_clone;\n                                }\n                            }\n                        }\n                    }\n                }\n            } else {\n                let isHasMc = false;    // \n                // \n                for (let i = 0; i < Store.luckysheet_select_save.length; i++) {\n                    let range = Store.luckysheet_select_save[i];\n                    let r1 = range['row'][0], r2 = range['row'][1];\n                    let c1 = range['column'][0], c2 = range['column'][1];\n                    for (let r = r1; r <= r2; r++) {\n                        for (let c = c1; c <= c2; c++) {\n                            let cell = d[r][c];\n                            if (getObjType(cell) == 'object' && 'mc' in cell) {\n                                isHasMc = true;\n                                break;\n                            }\n                        }\n                    }\n                }\n                if (isHasMc) {\n                    // \n                    for (let i = 0; i < Store.luckysheet_select_save.length; i++) {\n                        let range = Store.luckysheet_select_save[i];\n                        let r1 = range['row'][0], r2 = range['row'][1];\n                        let c1 = range['column'][0], c2 = range['column'][1];\n                        if (r1 == r2 && c1 == c2) {\n                            continue;\n                        }\n                        let fv = {};\n                        for (let r = r1; r <= r2; r++) {\n                            for (let c = c1; c <= c2; c++) {\n                                let cell = d[r][c];\n                                if (cell != null && cell.mc != null) {\n                                    let mc_r = cell.mc.r, mc_c = cell.mc.c;\n                                    if ('rs' in cell.mc) {\n                                        delete cell.mc;\n                                        delete cfg['merge'][mc_r + '_' + mc_c];\n                                        fv[mc_r + '_' + mc_c] = $.extend(true, {}, cell);\n                                    } else {\n                                        // let cell_clone = fv[mc_r + \"_\" + mc_c];\n                                        let cell_clone = JSON.parse(JSON.stringify(fv[mc_r + '_' + mc_c]));\n                                        delete cell_clone.v;\n                                        delete cell_clone.m;\n                                        delete cell_clone.ct;\n                                        delete cell_clone.f;\n                                        delete cell_clone.spl;\n                                        d[r][c] = cell_clone;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                } else {\n                    for (let i = 0; i < Store.luckysheet_select_save.length; i++) {\n                        let range = Store.luckysheet_select_save[i];\n                        let r1 = range['row'][0], r2 = range['row'][1];\n                        let c1 = range['column'][0], c2 = range['column'][1];\n                        if (r1 == r2 && c1 == c2) {\n                            continue;\n                        }\n                        if (foucsStatus == 'mergeAll') {\n                            let fv = {}, isfirst = false;\n                            for (let r = r1; r <= r2; r++) {\n                                for (let c = c1; c <= c2; c++) {\n                                    let cell = d[r][c];\n                                    if (cell != null && (!isRealNull(cell.v) || cell.f != null) && !isfirst) {\n                                        fv = $.extend(true, {}, cell);\n                                        isfirst = true;\n                                    }\n                                    d[r][c] = {\n                                        'mc': {\n                                            'r': r1,\n                                            'c': c1\n                                        }\n                                    };\n                                }\n                            }\n                            d[r1][c1] = fv;\n                            d[r1][c1].mc = {\n                                'r': r1,\n                                'c': c1,\n                                'rs': r2 - r1 + 1,\n                                'cs': c2 - c1 + 1\n                            };\n                            cfg['merge'][r1 + '_' + c1] = {\n                                'r': r1,\n                                'c': c1,\n                                'rs': r2 - r1 + 1,\n                                'cs': c2 - c1 + 1\n                            };\n                        } else if (foucsStatus == 'mergeV') {\n                            for (let c = c1; c <= c2; c++) {\n                                let fv = {}, isfirst = false;\n                                for (let r = r1; r <= r2; r++) {\n                                    let cell = d[r][c];\n                                    if (cell != null && (!isRealNull(cell.v) || cell.f != null) && !isfirst) {\n                                        fv = $.extend(true, {}, cell);\n                                        isfirst = true;\n                                    }\n                                    d[r][c] = {\n                                        'mc': {\n                                            'r': r1,\n                                            'c': c\n                                        }\n                                    };\n                                }\n                                d[r1][c] = fv;\n                                d[r1][c].mc = {\n                                    'r': r1,\n                                    'c': c,\n                                    'rs': r2 - r1 + 1,\n                                    'cs': 1\n                                };\n                                cfg['merge'][r1 + '_' + c] = {\n                                    'r': r1,\n                                    'c': c,\n                                    'rs': r2 - r1 + 1,\n                                    'cs': 1\n                                };\n                            }\n                        } else if (foucsStatus == 'mergeH') {\n                            for (let r = r1; r <= r2; r++) {\n                                let fv = {}, isfirst = false;\n                                for (let c = c1; c <= c2; c++) {\n                                    let cell = d[r][c];\n                                    if (cell != null && (!isRealNull(cell.v) || cell.f != null) && !isfirst) {\n                                        fv = $.extend(true, {}, cell);\n                                        isfirst = true;\n                                    }\n                                    d[r][c] = {\n                                        'mc': {\n                                            'r': r,\n                                            'c': c1\n                                        }\n                                    };\n                                }\n                                d[r][c1] = fv;\n                                d[r][c1].mc = {\n                                    'r': r,\n                                    'c': c1,\n                                    'rs': 1,\n                                    'cs': c2 - c1 + 1\n                                };\n                                cfg['merge'][r + '_' + c1] = {\n                                    'r': r,\n                                    'c': c1,\n                                    'rs': 1,\n                                    'cs': c2 - c1 + 1\n                                };\n                            }\n                        }\n                    }\n                }\n            }\n            if (Store.clearjfundo) {\n                Store.jfundo.length = 0;\n                Store.jfredo.push({\n                    'type': 'mergeChange',\n                    'sheetIndex': Store.currentSheetIndex,\n                    'data': Store.flowdata,\n                    'curData': d,\n                    'range': $.extend(true, [], Store.luckysheet_select_save),\n                    'config': $.extend(true, {}, Store.config),\n                    'curConfig': cfg\n                });\n            }\n            Store.clearjfundo = false;\n            jfrefreshgrid(d, Store.luckysheet_select_save, { 'cfg': cfg });\n            Store.clearjfundo = true;\n        },\n        borderfix: function (d, r, c) {\n            // return [-1, -1, 2, 2];\n            let cell = d[r][c];\n            let bg = null;\n            if (cell == null) {\n                return [\n                    -1,\n                    0,\n                    0,\n                    -1\n                ];\n            } else if (d[r][c].bg == null || d[r][c].bg == '') {\n                return [\n                    -1,\n                    0,\n                    0,\n                    -1\n                ];\n            } else {\n                return [\n                    -2,\n                    -1,\n                    1,\n                    0\n                ];    //return [-2, -2, 1, 0];\n            }\n        },\n        //return [-2, -2, 1, 0];\n        changeMenuButtonDom: function (attr, foucsStatus, _locale) {\n            let _this = this;\n            if (_locale == null) {\n                _locale = locale();\n            }\n            const locale_fontarray = _locale.fontarray;\n            const locale_fontjson = _locale.fontjson;\n            if (attr == 'bl') {\n                if (foucsStatus != '0') {\n                    $('#luckysheet-icon-bold').addClass('luckysheet-toolbar-button-hover');\n                } else {\n                    $('#luckysheet-icon-bold').removeClass('luckysheet-toolbar-button-hover');\n                }\n            } else if (attr == 'it') {\n                if (foucsStatus != '0') {\n                    $('#luckysheet-icon-italic').addClass('luckysheet-toolbar-button-hover');\n                } else {\n                    $('#luckysheet-icon-italic').removeClass('luckysheet-toolbar-button-hover');\n                }\n            } else if (attr == 'cl') {\n                if (foucsStatus != '0') {\n                    $('#luckysheet-icon-strikethrough').addClass('luckysheet-toolbar-button-hover');\n                } else {\n                    $('#luckysheet-icon-strikethrough').removeClass('luckysheet-toolbar-button-hover');\n                }\n            } else if (attr == 'un') {\n                if (foucsStatus != '0') {\n                    $('#luckysheet-icon-underline').addClass('luckysheet-toolbar-button-hover');\n                } else {\n                    $('#luckysheet-icon-underline').removeClass('luckysheet-toolbar-button-hover');\n                }\n            } else if (attr == 'ff') {\n                let menuButtonId = 'luckysheet-icon-font-family-menuButton';\n                let $menuButton = $('#' + menuButtonId);    // const locale_fontarray = locale().fontarray;\n                // const locale_fontarray = locale().fontarray;\n                let itemname = locale_fontarray[0], itemvalue = 0;\n                if (foucsStatus != null) {\n                    if (isdatatypemulti(foucsStatus)['num']) {\n                        itemvalue = parseInt(foucsStatus);\n                        itemname = locale_fontarray[itemvalue];\n                        if (itemname == null) {\n                            itemvalue = _this.defualtFont[itemvalue];\n                            itemname = itemvalue;\n                            if (itemvalue != null) {\n                                _this.addFontTolist(itemvalue);\n                            }\n                        }\n                    } else {\n                        foucsStatus = foucsStatus.replace(/\"/g, '').replace(/'/g, '');\n                        itemvalue = foucsStatus;\n                        itemname = foucsStatus;\n                        _this.addFontTolist(itemvalue);\n                    }\n                }\n                _this.focus($menuButton, itemvalue);\n                $('#luckysheet-icon-font-family').find('.luckysheet-toolbar-menu-button-caption').html(' ' + itemname + ' ');\n            } else if (attr == 'fs') {\n                let $menuButton = $('#luckysheet-icon-font-size-menuButton');\n                let itemvalue = foucsStatus, $input = $('#luckysheet-icon-font-size input');\n                _this.focus($menuButton, itemvalue);\n                $('#luckysheet-icon-font-size').attr('itemvalue', itemvalue);\n                $input.val(itemvalue);\n            } else if (attr == 'ht') {\n                let $menuButton = $('#luckysheet-icon-align-menu-menuButton');\n                let $t = $('luckysheet-icon-align'), itemvalue = 'left';\n                if (foucsStatus == '0') {\n                    itemvalue = 'center';\n                } else if (foucsStatus == '2') {\n                    itemvalue = 'right';\n                }\n                _this.focus($menuButton, itemvalue);    // add iconfont\n                // add iconfont\n                const iconfontObject = iconfontObjects.align;\n                let $icon = $('#luckysheet-icon-align').attr('type', itemvalue).find('.luckysheet-icon-img-container');\n                $icon.removeAttr('class').addClass('luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-' + itemvalue + iconfontObject[itemvalue]);\n                $menuButton.hide();\n            } else if (attr == 'vt') {\n                let $menuButton = $('#luckysheet-icon-valign-menu-menuButton');\n                let $t = $('luckysheet-icon-valign'), itemvalue = 'bottom';\n                if (foucsStatus == '1') {\n                    itemvalue = 'top';\n                } else if (foucsStatus == '0') {\n                    itemvalue = 'middle';\n                }\n                _this.focus($menuButton, itemvalue);    // add iconfont\n                // add iconfont\n                const iconfontObject = iconfontObjects.align;\n                let $icon = $('#luckysheet-icon-valign').attr('type', itemvalue).find('.luckysheet-icon-img-container');\n                $icon.removeAttr('class').addClass('luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-' + itemvalue + iconfontObject[itemvalue]);\n                $menuButton.hide();\n            } else if (attr == 'tb') {\n                let $menuButton = $('#luckysheet-icon-textwrap-menu-menuButton');\n                let $t = $('luckysheet-icon-textwrap'), itemvalue = 'clip';\n                if (foucsStatus == '1') {\n                    itemvalue = 'overflow';\n                } else if (foucsStatus == '2') {\n                    itemvalue = 'wrap';\n                }\n                _this.focus($menuButton, itemvalue);    // add iconfont\n                // add iconfont\n                const iconfontObject = iconfontObjects.textWrap;\n                let $icon = $('#luckysheet-icon-textwrap').attr('type', itemvalue).find('.luckysheet-icon-img-container');\n                $icon.removeAttr('class').addClass('luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-' + itemvalue + iconfontObject[itemvalue]);\n                $menuButton.hide();\n            } else if (attr == 'tr') {\n                let $menuButton = $('#luckysheet-icon-rotation-menu-menuButton');\n                let $t = $('luckysheet-icon-rotation'), itemvalue = 'none';\n                if (foucsStatus == '1') {\n                    itemvalue = 'angleup';\n                } else if (foucsStatus == '2') {\n                    itemvalue = 'angledown';\n                } else if (foucsStatus == '3') {\n                    itemvalue = 'vertical';\n                } else if (foucsStatus == '4') {\n                    itemvalue = 'rotation-up';\n                } else if (foucsStatus == '5') {\n                    itemvalue = 'rotation-down';\n                }\n                _this.focus($menuButton, itemvalue);    // add iconfont\n                // add iconfont\n                const iconfontObject = iconfontObjects.rotation;\n                let $icon = $('#luckysheet-icon-rotation').attr('type', itemvalue).find('.luckysheet-icon-img-container');\n                $icon.removeAttr('class').addClass('luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-' + itemvalue + iconfontObject[itemvalue]);\n                $menuButton.hide();\n            } else if (attr == 'ct') {\n                let $menuButton = $('#luckysheet-icon-fmt-other');\n                const _locale = locale();\n                const locale_defaultFmt = _locale.defaultFmt;\n                if (!foucsStatus) {\n                    $menuButton.find('.luckysheet-toolbar-menu-button-caption').html(' ' + locale_defaultFmt[0].text + ' ');\n                    return;\n                }\n                const {fa} = foucsStatus;\n                const format = locale_defaultFmt.find(f => f.value === fa);\n                if (format) {\n                    $menuButton.find('.luckysheet-toolbar-menu-button-caption').html(' ' + format.text + ' ');\n                } else {\n                    const otherFormat = locale_defaultFmt.find(f => f.value === 'fmtOtherSelf');\n                    $menuButton.find('.luckysheet-toolbar-menu-button-caption').html(' ' + otherFormat.text + ' ');\n                }\n            }\n        },\n        inputMenuButtonFocus: function (focusTarget) {\n            var w = window.getSelection();\n            var range = w.getRangeAt(0);\n            let startContainer = range.startContainer;\n            Store.inlineStringEditRange = null;\n            const _locale = locale();\n            if (startContainer.parentNode.tagName == 'SPAN') {\n                let cssText = startContainer.parentNode.style.cssText;\n                let stylelist = convertCssToStyleList(cssText);\n                for (let key in stylelist) {\n                    this.changeMenuButtonDom(key, stylelist[key], _locale);\n                }\n            }\n        },\n        menuButtonFocus: function (d, r, c) {\n            let _this = this;\n            let foucsList = [\n                'bl',\n                'it',\n                'cl',\n                'ff',\n                'ht',\n                'vt',\n                'fs',\n                'tb',\n                'tr',\n                'ct',\n                'un'\n            ];\n            const _locale = locale();\n            for (let i = 0; i < foucsList.length; i++) {\n                let attr = foucsList[i];\n                let foucsStatus = _this.checkstatus(d, r, c, attr);\n                this.changeMenuButtonDom(attr, foucsStatus, _locale);\n            }\n        },\n        checkstatus: function (d, r, c, a) {\n            if (d == null || d[r] == null) {\n                console.warn(\"It's incorrect data\", r, c);\n                return null;\n            }\n            let foucsStatus = d[r][c];\n            return checkstatusByCell(foucsStatus, a);\n        },\n        setLineDash: function (canvasborder, type, hv, m_st, m_ed, line_st, line_ed) {\n            let borderType = {\n                '0': 'none',\n                '1': 'Thin',\n                '2': 'Hair',\n                '3': 'Dotted',\n                '4': 'Dashed',\n                '5': 'DashDot',\n                '6': 'DashDotDot',\n                '7': 'Double',\n                '8': 'Medium',\n                '9': 'MediumDashed',\n                '10': 'MediumDashDot',\n                '11': 'MediumDashDotDot',\n                '12': 'SlantedDashDot',\n                '13': 'Thick'\n            };\n            type = borderType[type.toString()];\n            try {\n                if (type == 'Hair') {\n                    canvasborder.setLineDash([\n                        1,\n                        2\n                    ]);\n                } else if (type.indexOf('DashDotDot') > -1) {\n                    canvasborder.setLineDash([\n                        2,\n                        2,\n                        5,\n                        2,\n                        2\n                    ]);\n                } else if (type.indexOf('DashDot') > -1) {\n                    canvasborder.setLineDash([\n                        2,\n                        5,\n                        2\n                    ]);\n                } else if (type.indexOf('Dotted') > -1) {\n                    canvasborder.setLineDash([2]);\n                } else if (type.indexOf('Dashed') > -1) {\n                    canvasborder.setLineDash([3]);\n                } else {\n                    canvasborder.setLineDash([0]);\n                }\n            } catch (e) {\n                console.log(e);\n            }\n            canvasborder.beginPath();\n            if (type.indexOf('Medium') > -1) {\n                if (hv == 'h') {\n                    canvasborder.moveTo(m_st, m_ed - 0.5);\n                    canvasborder.lineTo(line_st, line_ed - 0.5);\n                } else {\n                    canvasborder.moveTo(m_st - 0.5, m_ed);\n                    canvasborder.lineTo(line_st - 0.5, line_ed);\n                }\n                canvasborder.lineWidth = 2;\n            } else if (type == 'Thick') {\n                canvasborder.moveTo(m_st, m_ed);\n                canvasborder.lineTo(line_st, line_ed);\n                canvasborder.lineWidth = 3;\n            } else {\n                canvasborder.moveTo(m_st, m_ed);\n                canvasborder.lineTo(line_st, line_ed);\n                canvasborder.lineWidth = 1;\n            }\n        },\n        moveMergeData: function (d, offset_r, offset_c) {\n            if (isRealNull(d)) {\n                return d;\n            }\n            let deleMC = [], insertMC = [], hasMC = false;\n            for (let r = 0; r < d.length; r++) {\n                for (let c = 0; c < d[0].length; c++) {\n                    let cell = d[r][c];\n                    if (getObjType(cell) == 'object' && 'mc' in cell) {\n                        if (cell.mc.rs != null) {\n                            deleMC.push({\n                                rs: cell.mc.rs,\n                                cs: cell.mc.cs,\n                                r: cell.mc.r,\n                                c: cell.mc.c\n                            });\n                            insertMC.push({\n                                rs: cell.mc.rs,\n                                cs: cell.mc.cs,\n                                r: cell.mc.r + offset_r,\n                                c: cell.mc.c + offset_c\n                            });\n                            hasMC = true;\n                        }\n                        d[r][c].mc.r += offset_r;\n                        d[r][c].mc.c += offset_c;\n                    }\n                }\n            }\n            return {\n                'deleMC': deleMC,\n                'insertMC': insertMC,\n                'hasMC': hasMC\n            };\n        },\n        getRangeInMerge: function (st_r, rlen, st_c, clen, sheetIndex) {\n            let _this = this;\n            let mergelist = [];\n            let cfg = null;\n            if (sheetIndex != null) {\n                cfg = $.extend(true, {}, _this.getSheetConfig());\n            } else {\n                cfg = $.extend(true, {}, Store.config);\n            }\n            if (cfg != null && cfg['merge'] != null) {\n                for (let key in cfg['merge']) {\n                    let mc = cfg['merge'][key];\n                    if (!(st_r + rlen - 1 < mc.r || st_r > mc.r + mc.rs - 1) && !(st_c + clen - 1 < mc.c || st_c > mc.c + mc.cs - 1)) {\n                        mergelist.push(mc);\n                    }\n                }\n            }\n            return mergelist;\n        },\n        mergeborer: function (d, row_index, col_index) {\n            if (d == null || d[row_index] == null) {\n                console.warn('Merge info is null', row_index, col_index);\n                return null;\n            }\n            let value = d[row_index][col_index];\n            if (getObjType(value) == 'object' && 'mc' in value) {\n                let margeMaindata = value['mc'];\n                if (margeMaindata == null) {\n                    console.warn('Merge info is null', row_index, col_index);\n                    return null;\n                }\n                col_index = margeMaindata.c;\n                row_index = margeMaindata.r;\n                if (d[row_index][col_index] == null) {\n                    console.warn('Main merge Cell info is null', row_index, col_index);\n                    return null;\n                }\n                let col_rs = d[row_index][col_index].mc.cs;\n                let row_rs = d[row_index][col_index].mc.rs;\n                let margeMain = d[row_index][col_index].mc;\n                let start_r, end_r, row, row_pre;\n                for (let r = row_index; r < margeMain.rs + row_index; r++) {\n                    if (r == 0) {\n                        start_r = -1;\n                    } else {\n                        start_r = Store.visibledatarow[r - 1] - 1;\n                    }\n                    end_r = Store.visibledatarow[r];\n                    if (row_pre == null) {\n                        row_pre = start_r;\n                        row = end_r;\n                    } else {\n                        row += end_r - start_r - 1;\n                    }\n                }\n                let start_c, end_c, col, col_pre;\n                for (let c = col_index; c < margeMain.cs + col_index; c++) {\n                    if (c == 0) {\n                        start_c = 0;\n                    } else {\n                        start_c = Store.visibledatacolumn[c - 1];\n                    }\n                    end_c = Store.visibledatacolumn[c];\n                    if (col_pre == null) {\n                        col_pre = start_c;\n                        col = end_c;\n                    } else {\n                        col += end_c - start_c;\n                    }\n                }\n                return {\n                    'row': [\n                        row_pre,\n                        row,\n                        row_index,\n                        row_index + row_rs - 1\n                    ],\n                    'column': [\n                        col_pre,\n                        col,\n                        col_index,\n                        col_index + col_rs - 1\n                    ]\n                };\n            } else {\n                return null;\n            }\n        },\n        mergeMoveData: {},\n        mergeMoveMain: function (columnseleted, rowseleted, s, top, height, left, width) {\n            let _this = this;\n            let mergesetting = sheetmanage.getSheetMerge();\n            if (mergesetting == null) {\n                return;\n            }\n            let mcset = [];\n            for (let key in mergesetting) {\n                mcset.push(key);\n            }\n            if (rowseleted[0] > rowseleted[1]) {\n                rowseleted[1] = rowseleted[0];\n            }\n            if (columnseleted[0] > columnseleted[1]) {\n                columnseleted[1] = columnseleted[0];\n            }\n            let offloop = true;\n            _this.mergeMoveData = {};\n            while (offloop) {\n                offloop = false;\n                for (let i = 0; i < mcset.length; i++) {\n                    let key = mcset[i];\n                    let mc = mergesetting[key];\n                    if (key in _this.mergeMoveData) {\n                        continue;\n                    }\n                    let changeparam = _this.mergeMove(mc, columnseleted, rowseleted, s, top, height, left, width);\n                    if (changeparam != null) {\n                        _this.mergeMoveData[key] = mc;\n                        columnseleted = changeparam[0];\n                        rowseleted = changeparam[1];\n                        top = changeparam[2];\n                        height = changeparam[3];\n                        left = changeparam[4];\n                        width = changeparam[5];\n                        offloop = true;\n                    } else {\n                        delete _this.mergeMoveData[key];\n                    }\n                }\n            }\n            return [\n                columnseleted,\n                rowseleted,\n                top,\n                height,\n                left,\n                width\n            ];\n        },\n        mergeMove: function (mc, columnseleted, rowseleted, s, top, height, left, width) {\n            let _this = this;\n            let row_st = mc.r, row_ed = mc.r + mc.rs - 1;\n            let col_st = mc.c, col_ed = mc.c + mc.cs - 1;\n            let ismatch = false;\n            if (columnseleted[1] < columnseleted[0]) {\n                columnseleted[0] = columnseleted[1];\n            }\n            if (rowseleted[1] < rowseleted[0]) {\n                rowseleted[0] = rowseleted[1];\n            }\n            if (columnseleted[0] <= col_st && columnseleted[1] >= col_ed && rowseleted[0] <= row_st && rowseleted[1] >= row_ed || !(columnseleted[1] < col_st || columnseleted[0] > col_ed) && !(rowseleted[1] < row_st || rowseleted[0] > row_ed)) {\n                let margeset = _this.mergeborer(Store.flowdata, mc.r, mc.c);\n                if (!!margeset) {\n                    let row = margeset.row[1], row_pre = margeset.row[0], row_index = margeset.row[2], col = margeset.column[1], col_pre = margeset.column[0], col_index = margeset.column[2];\n                    if (!(columnseleted[1] < col_st || columnseleted[0] > col_ed)) {\n                        //\n                        if (rowseleted[0] <= row_ed && rowseleted[0] >= row_st) {\n                            height += top - row_pre;\n                            top = row_pre;\n                            rowseleted[0] = row_st;\n                        }    //\n                        //\n                        if (rowseleted[1] >= row_st && rowseleted[1] <= row_ed) {\n                            if (s.row_focus >= row_st && s.row_focus <= row_ed) {\n                                height = row - top;\n                            } else {\n                                height = row - top;\n                            }\n                            rowseleted[1] = row_ed;\n                        }\n                    }\n                    if (!(rowseleted[1] < row_st || rowseleted[0] > row_ed)) {\n                        if (columnseleted[0] <= col_ed && columnseleted[0] >= col_st) {\n                            width += left - col_pre;\n                            left = col_pre;\n                            columnseleted[0] = col_st;\n                        }    //\n                        //\n                        if (columnseleted[1] >= col_st && columnseleted[1] <= col_ed) {\n                            if (s.column_focus >= col_st && s.column_focus <= col_ed) {\n                                width = col - left;\n                            } else {\n                                width = col - left;\n                            }\n                            columnseleted[1] = col_ed;\n                        }\n                    }\n                    ismatch = true;\n                }\n            }\n            if (ismatch) {\n                return [\n                    columnseleted,\n                    rowseleted,\n                    top,\n                    height,\n                    left,\n                    width\n                ];\n            } else {\n                return null;\n            }\n        },\n        getCellRealSize: function (d, cell_r, cell_c) {\n            let _this = this;\n            let width = Store.defaultcollen;\n            let height = Store.defaultrowlen;\n            let celldata = d[cell_r][cell_c];\n            if (!!celldata && celldata['mc'] != null) {\n                let mc = celldata['mc'];\n                let margeset = _this.mergeborer(d, mc.r, mc.c);\n                if (!!margeset) {\n                    let row = margeset.row[1];\n                    let row_pre = margeset.row[0];\n                    let row_index = margeset.row[2];\n                    let row_index_ed = margeset.row[3];\n                    let col = margeset.column[1];\n                    let col_pre = margeset.column[0];\n                    let col_index = margeset.column[2];\n                    let col_index_ed = margeset.column[3];\n                    width = col - col_pre - 1;\n                    height = row - row_pre - 1;\n                }\n            } else {\n                let config = getluckysheetfile()[getSheetIndex(Store.currentSheetIndex)]['config'];\n                if (config['columnlen'] != null && config['columnlen'][cell_c] != null) {\n                    width = config['columnlen'][cell_c];\n                }\n                if (config['rowlen'] != null && config['rowlen'][cell_r] != null) {\n                    height = config['rowlen'][cell_r];\n                }\n            }\n            return [\n                width,\n                height\n            ];\n        },\n        getTextHeightCache: {},\n        getTextSize: function (text, font) {\n            let fontarray = locale().fontarray;\n            let f = font || '10pt ' + fontarray[0];\n            let _this = this;\n            if (f in _this.getTextHeightCache) {\n                return _this.getTextHeightCache[f];\n            }\n            if ($('#luckysheetTextSizeTest').length == 0) {\n                $('<span id=\"luckysheetTextSizeTest\" style=\"float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;\">' + text + '</span>').appendTo($('body'));\n            }\n            let o = $('#luckysheetTextSizeTest').text(text).css({ 'font': f }), w = o.innerWidth(), h = o.innerHeight();\n            _this.getTextHeightCache[f] = [\n                w,\n                h\n            ];\n            return [\n                w,\n                h\n            ];\n        },\n        activeFormulaInput: function (row_index, col_index, rowh, columnh, formula, isnull) {\n            let _this = this;\n            if (isnull == null) {\n                isnull = false;\n            }\n            luckysheetupdateCell(row_index, col_index, Store.flowdata, true);\n            if (isnull) {\n                let formulaTxt = '<span dir=\"auto\" class=\"luckysheet-formula-text-color\">=</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">' + formula.toUpperCase() + '</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">(</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">)</span>';\n                $('#luckysheet-rich-text-editor').html(formulaTxt);\n                let currSelection = window.getSelection();\n                let $span = $('#luckysheet-rich-text-editor').find('span');\n                luckysheetformula.setCaretPosition($span.get($span.length - 2), 0, 1);\n                return;\n            }\n            let row_pre = rowLocationByIndex(rowh[0])[0], row = rowLocationByIndex(rowh[1])[1], col_pre = colLocationByIndex(columnh[0])[0], col = colLocationByIndex(columnh[1])[1];\n            let formulaTxt = '<span dir=\"auto\" class=\"luckysheet-formula-text-color\">=</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">' + formula.toUpperCase() + '</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">(</span><span class=\"luckysheet-formula-functionrange-cell\" rangeindex=\"0\" dir=\"auto\" style=\"color:' + luckyColor[0] + ';\">' + getRangetxt(Store.currentSheetIndex, {\n                'row': rowh,\n                'column': columnh\n            }, Store.currentSheetIndex) + '</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">)</span>';\n            $('#luckysheet-rich-text-editor').html(formulaTxt);\n            luckysheetformula.israngeseleciton();\n            luckysheetformula.rangestart = true;\n            luckysheetformula.rangedrag_column_start = false;\n            luckysheetformula.rangedrag_row_start = false;\n            luckysheetformula.rangechangeindex = 0;\n            luckysheetformula.rangeSetValue({\n                'row': rowh,\n                'column': columnh\n            });\n            luckysheetformula.func_selectedrange = {\n                'left': col_pre,\n                'width': col - col_pre - 1,\n                'top': row_pre,\n                'height': row - row_pre - 1,\n                'left_move': col_pre,\n                'width_move': col - col_pre - 1,\n                'top_move': row_pre,\n                'height_move': row - row_pre - 1,\n                'row': [\n                    row_index,\n                    row_index\n                ],\n                'column': [\n                    col_index,\n                    col_index\n                ]\n            };\n            $('#luckysheet-formula-functionrange-select').css({\n                'left': col_pre,\n                'width': col - col_pre - 1,\n                'top': row_pre,\n                'height': row - row_pre - 1\n            }).show();\n            $('#luckysheet-formula-help-c').hide();\n        },\n        backFormulaInput: function (d, r, c, rowh, columnh, formula) {\n            let _this = this;\n            let f = '=' + formula.toUpperCase() + '(' + getRangetxt(Store.currentSheetIndex, {\n                'row': rowh,\n                'column': columnh\n            }, Store.currentSheetIndex) + ')';\n            let v = luckysheetformula.execfunction(f, r, c);\n            let value = {\n                'v': v[1],\n                'f': v[2]\n            };\n            setcellvalue(r, c, d, value);\n            luckysheetformula.execFunctionExist.push({\n                'r': r,\n                'c': c,\n                'i': Store.currentSheetIndex\n            });\n            server.historyParam(d, Store.currentSheetIndex, {\n                'row': [\n                    r,\n                    r\n                ],\n                'column': [\n                    c,\n                    c\n                ]\n            });\n        },\n        checkNoNullValue: function (cell) {\n            let v = cell;\n            if (getObjType(v) == 'object') {\n                v = v.v;\n            }\n            if (!isRealNull(v) && isdatatypemulti(v).num && (cell.ct == null || cell.ct.t == null || cell.ct.t == 'n' || cell.ct.t == 'g')) {\n                return true;\n            } else {\n                return false;\n            }\n        },\n        checkNoNullValueAll: function (cell) {\n            let v = cell;\n            if (getObjType(v) == 'object') {\n                v = v.v;\n            }\n            if (!isRealNull(v)) {\n                return true;\n            } else {\n                return false;\n            }\n        },\n        getNoNullValue: function (d, st_x, ed, type) {\n            let _this = this;\n            let hasValueSum = 0, hasValueStart = null;\n            let nullNum = 0, nullTime = 0;\n            for (let r = ed - 1; r >= 0; r--) {\n                let cell;\n                if (type == 'c') {\n                    cell = d[st_x][r];\n                } else {\n                    cell = d[r][st_x];\n                }\n                if (_this.checkNoNullValue(cell)) {\n                    hasValueSum++;\n                    hasValueStart = r;\n                } else if (cell == null || cell.v == null || cell.v == '') {\n                    nullNum++;\n                    if (nullNum >= 40) {\n                        if (nullTime <= 0) {\n                            nullTime = 1;\n                        } else {\n                            break;\n                        }\n                    }\n                } else {\n                    break;\n                }\n            }\n            return hasValueStart;\n        },\n        singleFormulaInput: function (d, _index, fix, st_m, ed_m, formula, type, noNum, noNull) {\n            let _this = this;\n            if (type == null) {\n                type = 'r';\n            }\n            if (noNum == null) {\n                noNum = true;\n            }\n            if (noNull == null) {\n                noNull = true;\n            }\n            let isNull = true, isNum = false;\n            for (let c = st_m; c <= ed_m; c++) {\n                let cell = null;\n                if (type == 'c') {\n                    cell = d[c][fix];\n                } else {\n                    cell = d[fix][c];\n                }\n                if (_this.checkNoNullValue(cell)) {\n                    isNull = false;\n                    isNum = true;\n                } else if (_this.checkNoNullValueAll(cell)) {\n                    isNull = false;\n                }\n            }\n            if (isNull && noNull) {\n                let st_r_r = _this.getNoNullValue(d, _index, fix, type);\n                if (st_r_r == null) {\n                    if (type == 'c') {\n                        _this.activeFormulaInput(_index, fix, null, null, formula, true);\n                    } else {\n                        _this.activeFormulaInput(fix, _index, null, null, formula, true);\n                    }\n                } else {\n                    if (_index == st_m) {\n                        for (let c = st_m; c <= ed_m; c++) {\n                            let st_r_r = _this.getNoNullValue(d, c, fix, type);\n                            if (st_r_r == null) {\n                                break;\n                            }\n                            if (type == 'c') {\n                                _this.backFormulaInput(d, c, fix, [\n                                    c,\n                                    c\n                                ], [\n                                    st_r_r,\n                                    fix - 1\n                                ], formula);\n                            } else {\n                                _this.backFormulaInput(d, fix, c, [\n                                    st_r_r,\n                                    fix - 1\n                                ], [\n                                    c,\n                                    c\n                                ], formula);\n                            }\n                        }\n                    } else {\n                        for (let c = ed_m; c >= st_m; c--) {\n                            let st_r_r = _this.getNoNullValue(d, c, fix, type);\n                            if (st_r_r == null) {\n                                break;\n                            }\n                            if (type == 'c') {\n                                _this.backFormulaInput(d, c, fix, [\n                                    c,\n                                    c\n                                ], [\n                                    st_r_r,\n                                    fix - 1\n                                ], formula);\n                            } else {\n                                _this.backFormulaInput(d, fix, c, [\n                                    st_r_r,\n                                    fix - 1\n                                ], [\n                                    c,\n                                    c\n                                ], formula);\n                            }\n                        }\n                    }\n                }\n            } else if (isNum && noNum) {\n                let cell = null;\n                if (type == 'c') {\n                    cell = d[ed_m][fix];\n                } else {\n                    cell = d[fix][ed_m];\n                }\n                if (cell != null && cell.v != null && cell.v.toString().length > 0) {\n                    let c = ed_m;\n                    if (type == 'c') {\n                        cell = d[ed_m][fix];\n                    } else {\n                        cell = d[fix][ed_m];\n                    }\n                    while (cell != null && cell.v != null && cell.v.toString().length > 0) {\n                        c++;\n                        let len = null;\n                        if (type == 'c') {\n                            len = d.length;\n                        } else {\n                            len = d[0].length;\n                        }\n                        if (c >= len) {\n                            return;\n                        }\n                        if (type == 'c') {\n                            cell = d[c][fix];\n                        } else {\n                            cell = d[fix][c];\n                        }\n                    }\n                    if (type == 'c') {\n                        _this.backFormulaInput(d, c, fix, [\n                            st_m,\n                            ed_m\n                        ], [\n                            fix,\n                            fix\n                        ], formula);\n                    } else {\n                        _this.backFormulaInput(d, fix, c, [\n                            fix,\n                            fix\n                        ], [\n                            st_m,\n                            ed_m\n                        ], formula);\n                    }\n                } else {\n                    if (type == 'c') {\n                        _this.backFormulaInput(d, ed_m, fix, [\n                            st_m,\n                            ed_m\n                        ], [\n                            fix,\n                            fix\n                        ], formula);\n                    } else {\n                        _this.backFormulaInput(d, fix, ed_m, [\n                            fix,\n                            fix\n                        ], [\n                            st_m,\n                            ed_m\n                        ], formula);\n                    }\n                }\n            } else {\n                return true;\n            }\n        },\n        autoSelectionFormula: function (formula) {\n            let _this = this;\n            let d = editor.deepCopyFlowData(Store.flowdata);\n            let nullfindnum = 40;\n            let isfalse = true;\n            luckysheetformula.execFunctionExist = [];\n            let execFormulaInput_c = function (d, st_r, ed_r, st_c, ed_c, formula) {\n                let st_c_c = _this.getNoNullValue(d, st_r, ed_c, 'c');\n                if (st_c_c == null) {\n                    _this.activeFormulaInput(st_r, st_c, null, null, formula, true);\n                } else {\n                    _this.activeFormulaInput(st_r, st_c, [\n                        st_r,\n                        ed_r\n                    ], [\n                        st_c_c,\n                        ed_c - 1\n                    ], formula);\n                }\n            };\n            let execFormulaInput = function (d, st_r, ed_r, st_c, ed_c, formula) {\n                let st_r_c = _this.getNoNullValue(d, st_c, ed_r, 'r');\n                if (st_r_c == null) {\n                    execFormulaInput_c(d, st_r, ed_r, st_c, ed_c, formula);\n                } else {\n                    _this.activeFormulaInput(st_r, st_c, [\n                        st_r_c,\n                        ed_r - 1\n                    ], [\n                        st_c,\n                        ed_c\n                    ], formula);\n                }\n            };\n            for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                let st_r = Store.luckysheet_select_save[s].row[0], ed_r = Store.luckysheet_select_save[s].row[1];\n                let st_c = Store.luckysheet_select_save[s].column[0], ed_c = Store.luckysheet_select_save[s].column[1];\n                let row_index = Store.luckysheet_select_save[s].row_focus, col_index = Store.luckysheet_select_save[s].column_focus;\n                if (st_r == ed_r && st_c == ed_c) {\n                    if (ed_r - 1 < 0 && ed_c - 1 < 0) {\n                        _this.activeFormulaInput(st_r, st_c, null, null, formula, true);\n                        return;\n                    }\n                    if (ed_r - 1 >= 0 && _this.checkNoNullValue(d[ed_r - 1][st_c])) {\n                        execFormulaInput(d, st_r, ed_r, st_c, ed_c, formula);\n                    } else if (ed_c - 1 >= 0 && _this.checkNoNullValue(d[st_r][ed_c - 1])) {\n                        execFormulaInput_c(d, st_r, ed_r, st_c, ed_c, formula);\n                    } else {\n                        execFormulaInput(d, st_r, ed_r, st_c, ed_c, formula);\n                    }\n                } else if (st_r == ed_r) {\n                    isfalse = _this.singleFormulaInput(d, col_index, st_r, st_c, ed_c, formula, 'r');\n                } else if (st_c == ed_c) {\n                    isfalse = _this.singleFormulaInput(d, row_index, st_c, st_r, ed_r, formula, 'c');\n                } else {\n                    let r_false = true;\n                    for (let r = st_r; r <= ed_r; r++) {\n                        r_false = _this.singleFormulaInput(d, col_index, r, st_c, ed_c, formula, 'r', true, false) && r_false;\n                    }\n                    let c_false = true;\n                    for (let c = st_c; c <= ed_c; c++) {\n                        c_false = _this.singleFormulaInput(d, row_index, c, st_r, ed_r, formula, 'c', true, false) && c_false;\n                    }\n                    isfalse = !!r_false && !!c_false;\n                }\n                isfalse = isfalse && isfalse;\n            }\n            if (!isfalse) {\n                luckysheetformula.execFunctionExist.reverse();\n                luckysheetformula.execFunctionGroup(null, null, null, null, d);\n                jfrefreshgrid(d, Store.luckysheet_select_save);\n                clearTimeout(Store.jfcountfuncTimeout);\n                Store.jfcountfuncTimeout = setTimeout(function () {\n                    countfunc();\n                }, 500);\n            }\n        },\n        getStyleByCell: function (d, r, c) {\n            let _this = this;\n            let style = '';    //\n            //\n            let af_compute = alternateformat.getComputeMap();\n            let checksAF = alternateformat.checksAF(r, c, af_compute);    //\n            //\n            let cf_compute = conditionformat.getComputeMap();\n            let checksCF = conditionformat.checksCF(r, c, cf_compute);\n            const locale_fontarray = locale().fontarray;\n            let cell = d[r][c];\n            let ct = cell.ct, isInline = false;\n            if (isInlineStringCell(cell)) {\n                isInline = true;\n            }\n            for (let key in cell) {\n                let value = _this.checkstatus(d, r, c, key);\n                if (checksAF != null || checksCF != null && checksCF['cellColor'] != null) {\n                    if (checksCF != null && checksCF['cellColor'] != null) {\n                        style += 'background: ' + checksCF['cellColor'] + ';';\n                    } else if (checksAF != null) {\n                        style += 'background: ' + checksAF[1] + ';';\n                    }\n                }\n                if (getObjType(value) == 'object') {\n                    continue;\n                }\n                if (key == 'bg' || checksAF != null || checksCF != null && checksCF['cellColor'] != null) {\n                    if (checksCF != null && checksCF['cellColor'] != null) {\n                        style += 'background: ' + checksCF['cellColor'] + ';';\n                    } else if (checksAF != null) {\n                        style += 'background: ' + checksAF[1] + ';';\n                    } else {\n                        style += 'background: ' + value + ';';\n                    }\n                }    // if(!isInline){\n                     //     if(key == \"bl\" && value != \"0\"){\n                     //         style += \"font-weight: bold;\";\n                     //     }\n                     //     if(key == \"it\" && value != \"0\"){\n                     //         style += \"font-style:italic;\";\n                     //     }\n                     //     if(key == \"ff\" && value != \"0\"){\n                     //         let f = value;\n                     //         if(!isNaN(parseInt(value))){\n                     //             f = locale_fontarray[parseInt(value)];\n                     //         }\n                     //         style += \"font-family: \" + f + \";\";\n                     //     }\n                     //     if(key == \"fs\" && value != \"10\"){\n                     //         style += \"font-size: \"+ value + \"pt;\";\n                     //     }\n                     //     if((key == \"fc\" && value != \"#000000\") || checksAF != null || (checksCF != null && checksCF[\"textColor\"] != null)){\n                     //         if(checksCF != null && checksCF[\"textColor\"] != null){\n                     //             style += \"color: \" + checksCF[\"textColor\"] + \";\";\n                     //         }\n                     //         else if(checksAF != null){\n                     //             style += \"color: \" + checksAF[0] + \";\";\n                     //         }\n                     //         else{\n                     //             style += \"color: \" + value + \";\";  \n                     //         }\n                     //     }\n                     // }\n                // if(!isInline){\n                //     if(key == \"bl\" && value != \"0\"){\n                //         style += \"font-weight: bold;\";\n                //     }\n                //     if(key == \"it\" && value != \"0\"){\n                //         style += \"font-style:italic;\";\n                //     }\n                //     if(key == \"ff\" && value != \"0\"){\n                //         let f = value;\n                //         if(!isNaN(parseInt(value))){\n                //             f = locale_fontarray[parseInt(value)];\n                //         }\n                //         style += \"font-family: \" + f + \";\";\n                //     }\n                //     if(key == \"fs\" && value != \"10\"){\n                //         style += \"font-size: \"+ value + \"pt;\";\n                //     }\n                //     if((key == \"fc\" && value != \"#000000\") || checksAF != null || (checksCF != null && checksCF[\"textColor\"] != null)){\n                //         if(checksCF != null && checksCF[\"textColor\"] != null){\n                //             style += \"color: \" + checksCF[\"textColor\"] + \";\";\n                //         }\n                //         else if(checksAF != null){\n                //             style += \"color: \" + checksAF[0] + \";\";\n                //         }\n                //         else{\n                //             style += \"color: \" + value + \";\";  \n                //         }\n                //     }\n                // }\n                if (key == 'ht' && value != '1') {\n                    if (value == '0') {\n                        style += 'text-align: center;';\n                    } else if (value == '2') {\n                        style += 'text-align: right;';\n                    }\n                }\n                if (key == 'vt' && value != '1') {\n                    if (value == '0') {\n                        style += 'align-items: center;';\n                    } else if (value == '2') {\n                        style += 'align-items: flex-end;';\n                    }\n                }\n            }\n            if (!isInline) {\n                style += getFontStyleByCell(cell, checksAF, checksCF);\n            }\n            return style;\n        },\n        fontSelectList: [],\n        defualtFont: [\n            'Times New Roman',\n            'Arial',\n            'Tahoma',\n            'Verdana',\n            '',\n            '',\n            '',\n            '',\n            '',\n            '',\n            '',\n            '',\n            ''\n        ],\n        addFontTolist: function (fontName) {\n            fontName = fontName.replace(/\"/g, '').replace(/'/g, '');\n            let isNone = true;\n            for (let a = 0; a < this.fontSelectList.length; a++) {\n                let fItem = this.fontSelectList[a];\n                if (fItem.value == fontName) {\n                    isNone = false;\n                    break;\n                }\n            }\n            let _locale = locale();\n            const locale_fontjson = _locale.fontjson;\n            if (fontName in locale_fontjson) {\n                isNone = false;\n            }\n            if (isNone) {\n                let ret = {};\n                ret.value = fontName;\n                ret.index = this.fontSelectList.length;\n                ret.type = 'userDefined';\n                ret.text = \"<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:\" + fontName + \"'>\" + fontName + '</span>';\n                ret.example = '';\n                this.fontSelectList.push(ret);\n                let $menuButton = $('#luckysheet-icon-font-family-menuButton');\n                let itemset = this.createButtonMenu(this.fontSelectList);\n                $menuButton.html(itemset);\n            }\n        },\n        fontInitial: function (fontList) {\n            let itemdata = [];\n            const locale_fontarray = locale().fontarray;\n            for (let a = 0; a < locale_fontarray.length; a++) {\n                let fItem = locale_fontarray[a];\n                let ret = {};\n                ret.value = fItem;\n                ret.index = a;\n                ret.type = 'inner';\n                ret.text = \"<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:\" + fItem + \"'>\" + fItem + '</span>';\n                ret.example = '';\n                itemdata.push(ret);\n            }\n            if (fontList != null) {\n                for (let a = 0; a < fontList.length; a++) {\n                    let fItem = fontList[a];\n                    let ret = {};\n                    ret.value = fItem.fontName;\n                    ret.index = a;\n                    ret.type = 'userDefined';\n                    ret.text = \"<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:\" + fItem.fontName + \"'>\" + fItem.fontName + '</span>';\n                    ret.example = '';\n                    itemdata.push(ret);\n                    if (document.fonts && !document.fonts.check('12px ' + fItem.fontName)) {\n                        if (fItem.url) {\n                            const fontface = new FontFace(fItem.fontName, `url(${ fItem.url })`);\n                            document.fonts.add(fontface);\n                            fontface.load();\n                        }\n                    }\n                }\n                document.fonts && document.fonts.ready.then(function () {\n                });\n            }\n            this.fontSelectList = itemdata;\n        }\n    };\n    return menuButton;\n});"]}