{"version":3,"sources":["controllers/searchReplace.js"],"names":["define","m_util","m_get","m_constant","m_select","luckysheetConfigsetting","m_format","m_setdata","tooltip","func_methods","Store","locale","replaceHtml","chatatABC","getSheetIndex","modelHTML","keycode","selectHightlightShow","isEditMode","valueShowEs","setcellvalue","createDialog","source","$","hide","remove","_locale","locale_findAndReplace","findAndReplace","locale_button","button","content","find","replace","findTextbox","replaceTextbox","regexTextbox","wholeTextbox","distinguishTextbox","allReplaceBtn","replaceBtn","allFindBtn","findBtn","append","id","addclass","title","botton","close","style","$t","css","end","myh","outerHeight","myw","outerWidth","winw","window","width","winh","height","scrollLeft","document","scrollTop","left","top","show","addClass","siblings","removeClass","init","_this","this","off","on","$id","attr","focus","event","keyCode","ENTER","searchNext","searchAll","r","c","sheetIndex","currentSheetIndex","changeSheet","luckysheet_select_save","row","column","winH","winW","visibledatarow","row_pre","col","visibledatacolumn","col_pre","replaceAll","searchText","val","range","length","flowdata","extend","searchIndexArr","getSearchIndexArr","alert","noFindTip","info","count","i","rf","row_focus","cf","column_focus","s","r1","r2","c1","c2","obj","splice","push","is","searchAllHtml","value_ShowEs","toString","indexOf","luckysheetfile","name","searchTargetSheet","searchTargetCell","searchTargetValue","appendTo","eq","arr","regCheck","wordCheck","caseCheck","value","toLowerCase","reg","RegExp","getRegExpStr","test","allowEdit","modeTip","searchInputTip","noReplceTip","last","noMatchTip","replaceText","d","deepCopyFlowData","v","refeshRange","refreshRange","succeedInfo","successTip","xlength"],"mappings":"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","file":"../../controllers/searchReplace.js","sourcesContent":["define([\n    '../utils/util',\n    '../methods/get',\n    '../widgets/constant',\n    '../widgets/select',\n    '../methods/luckysheetConfigsetting',\n    '../methods/format',\n    '../methods/setdata',\n    '../widgets/tooltip',\n    '../methods/func_methods',\n    '../store',\n    '../locale/locale'\n], function (m_util, m_get, m_constant, m_select, luckysheetConfigsetting, m_format, m_setdata, tooltip, func_methods, Store, locale) {\n    'use strict';\n    const {replaceHtml, chatatABC} = m_util;\n    const {getSheetIndex} = m_get;\n    const {modelHTML, keycode} = m_constant;\n    const {selectHightlightShow} = m_select;\n    const {isEditMode} = luckysheetConfigsetting;\n    const {valueShowEs} = m_format;\n    const {setcellvalue} = m_setdata;\n    //查找替换\n    const luckysheetSearchReplace = {\n        createDialog: function (source) {\n            $('#luckysheet-modal-dialog-mask').hide();\n            $('#luckysheet-search-replace').remove();\n            const _locale = locale();\n            const locale_findAndReplace = _locale.findAndReplace;\n            const locale_button = _locale.button;\n            let content = '<div class=\"tabBox\">' + '<span id=\"searchTab\">' + locale_findAndReplace.find + '</span>' + '<span id=\"replaceTab\">' + locale_findAndReplace.replace + '</span>' + '</div>' + '<div class=\"ctBox\">' + '<div class=\"inputBox\">' + '<div class=\"textboxs\" id=\"searchInput\">' + locale_findAndReplace.findTextbox + '\\uFF1A<input class=\"formulaInputFocus\" spellcheck=\"false\" value=\"\"/></div>' + '<div class=\"textboxs\" id=\"replaceInput\">' + locale_findAndReplace.replaceTextbox + '\\uFF1A<input class=\"formulaInputFocus\" spellcheck=\"false\" value=\"\"/></div>' + '<div class=\"checkboxs\">' + '<div id=\"regCheck\">' + '<input type=\"checkbox\"/>' + '<span>' + locale_findAndReplace.regexTextbox + '</span>' + '</div>' + '<div id=\"wordCheck\">' + '<input type=\"checkbox\"/>' + '<span>' + locale_findAndReplace.wholeTextbox + '</span>' + '</div>' + '<div id=\"caseCheck\">' + '<input type=\"checkbox\"/>' + '<span>' + locale_findAndReplace.distinguishTextbox + '</span>' + '</div>' + '</div>' + '</div>' + '<div class=\"btnBox\">' + '<button id=\"replaceAllBtn\" class=\"btn btn-default\">' + locale_findAndReplace.allReplaceBtn + '</button>' + '<button id=\"replaceBtn\" class=\"btn btn-default\">' + locale_findAndReplace.replaceBtn + '</button>' + '<button id=\"searchAllBtn\" class=\"btn btn-default\">' + locale_findAndReplace.allFindBtn + '</button>' + '<button id=\"searchNextBtn\" class=\"btn btn-default\">' + locale_findAndReplace.findBtn + '</button>' + '</div>' + '</div>';\n            $('body').append(replaceHtml(modelHTML, {\n                'id': 'luckysheet-search-replace',\n                'addclass': 'luckysheet-search-replace',\n                'title': '',\n                'content': content,\n                'botton': '<button class=\"btn btn-default luckysheet-model-close-btn\">' + locale_button.close + '</button>',\n                'style': 'z-index:100003',\n                'close': locale_button.close\n            }));\n            let $t = $('#luckysheet-search-replace').find('.luckysheet-modal-dialog-content').css('min-width', 500).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n            let winw = $(window).width(), winh = $(window).height();\n            let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n            $('#luckysheet-search-replace').css({\n                'left': (winw + scrollLeft - myw) / 2,\n                'top': (winh + scrollTop - myh) / 3\n            }).show();\n            if (source == '0') {\n                $('#luckysheet-search-replace #searchTab').addClass('on').siblings().removeClass('on');\n                $('#luckysheet-search-replace #replaceInput').hide();\n                $('#luckysheet-search-replace #replaceAllBtn').hide();\n                $('#luckysheet-search-replace #replaceBtn').hide();\n            } else if (source == '1') {\n                $('#luckysheet-search-replace #replaceTab').addClass('on').siblings().removeClass('on');\n                $('#luckysheet-search-replace #replaceInput').show();\n                $('#luckysheet-search-replace #replaceAllBtn').show();\n                $('#luckysheet-search-replace #replaceBtn').show();\n            }\n        },\n        init: function () {\n            let _this = this;    //查找替换 切换\n            //查找替换 切换\n            $(document).off('click.SRtabBoxspan').on('click.SRtabBoxspan', '#luckysheet-search-replace .tabBox span', function () {\n                $(this).addClass('on').siblings().removeClass('on');\n                let $id = $(this).attr('id');\n                if ($id == 'searchTab') {\n                    $('#luckysheet-search-replace #replaceInput').hide();\n                    $('#luckysheet-search-replace #replaceAllBtn').hide();\n                    $('#luckysheet-search-replace #replaceBtn').hide();\n                    $('#luckysheet-search-replace #searchInput input').focus();\n                } else if ($id == 'replaceTab') {\n                    $('#luckysheet-search-replace #replaceInput').show();\n                    $('#luckysheet-search-replace #replaceAllBtn').show();\n                    $('#luckysheet-search-replace #replaceBtn').show();\n                    $('#luckysheet-search-replace #replaceInput input').focus();\n                }\n            });    //查找下一个\n            //查找下一个\n            $(document).off('keyup.SRsearchInput').on('keyup.SRsearchInput', '#luckysheet-search-replace #searchInput input', function (event) {\n                let kcode = event.keyCode;\n                if (kcode == keycode.ENTER) {\n                    _this.searchNext();\n                }\n            });\n            $(document).off('click.SRsearchNextBtn').on('click.SRsearchNextBtn', '#luckysheet-search-replace #searchNextBtn', function () {\n                _this.searchNext();\n            });    //查找全部\n            //查找全部\n            $(document).off('click.SRsearchAllBtn').on('click.SRsearchAllBtn', '#luckysheet-search-replace #searchAllBtn', function () {\n                _this.searchAll();\n            });\n            $(document).off('click.SRsearchAllboxItem').on('click.SRsearchAllboxItem', '#luckysheet-search-replace #searchAllbox .boxItem', function () {\n                $(this).addClass('on').siblings().removeClass('on');\n                let r = $(this).attr('data-row');\n                let c = $(this).attr('data-col');\n                let sheetIndex = $(this).attr('data-sheetIndex');\n                if (sheetIndex != Store.currentSheetIndex) {\n                    Store.changeSheet(sheetIndex);\n                }\n                Store.luckysheet_select_save = [{\n                        'row': [\n                            r,\n                            r\n                        ],\n                        'column': [\n                            c,\n                            c\n                        ]\n                    }];\n                selectHightlightShow();\n                let scrollLeft = $('#luckysheet-cell-main').scrollLeft(), scrollTop = $('#luckysheet-cell-main').scrollTop();\n                let winH = $('#luckysheet-cell-main').height(), winW = $('#luckysheet-cell-main').width();\n                let row = Store.visibledatarow[r], row_pre = r - 1 == -1 ? 0 : Store.visibledatarow[r - 1];\n                let col = Store.visibledatacolumn[c], col_pre = c - 1 == -1 ? 0 : Store.visibledatacolumn[c - 1];\n                if (col - scrollLeft - winW + 20 > 0) {\n                    $('#luckysheet-scrollbar-x').scrollLeft(col - winW + 20);\n                } else if (col_pre - scrollLeft - 20 < 0) {\n                    $('#luckysheet-scrollbar-x').scrollLeft(col_pre - 20);\n                }\n                if (row - scrollTop - winH + 20 > 0) {\n                    $('#luckysheet-scrollbar-y').scrollTop(row - winH + 20);\n                } else if (row_pre - scrollTop - 20 < 0) {\n                    $('#luckysheet-scrollbar-y').scrollTop(row_pre - 20);\n                }\n            });    //替换\n            //替换\n            $(document).off('click.SRreplaceBtn').on('click.SRreplaceBtn', '#luckysheet-search-replace #replaceBtn', function () {\n                _this.replace();\n            });    //全部替换\n            //全部替换\n            $(document).off('click.SRreplaceAllBtn').on('click.SRreplaceAllBtn', '#luckysheet-search-replace #replaceAllBtn', function () {\n                _this.replaceAll();\n            });\n        },\n        searchNext: function () {\n            let _this = this;\n            let searchText = $('#luckysheet-search-replace #searchInput input').val();\n            if (searchText == '' || searchText == null) {\n                return;\n            }\n            const _locale = locale();\n            const locale_findAndReplace = _locale.findAndReplace;\n            let range;\n            if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1] && Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                range = [{\n                        'row': [\n                            0,\n                            Store.flowdata.length - 1\n                        ],\n                        'column': [\n                            0,\n                            Store.flowdata[0].length - 1\n                        ]\n                    }];\n            } else {\n                range = $.extend(true, [], Store.luckysheet_select_save);\n            }\n            let searchIndexArr = _this.getSearchIndexArr(searchText, range);\n            if (searchIndexArr.length == 0) {\n                if (isEditMode()) {\n                    alert(locale_findAndReplace.noFindTip);\n                } else {\n                    tooltip.info(locale_findAndReplace.noFindTip, '');\n                }\n                return;\n            }\n            let count = 0;\n            if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1] && Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                if (Store.luckysheet_select_save.length == 0) {\n                    count = 0;\n                } else {\n                    for (let i = 0; i < searchIndexArr.length; i++) {\n                        if (searchIndexArr[i].r == Store.luckysheet_select_save[0].row[0] && searchIndexArr[i].c == Store.luckysheet_select_save[0].column[0]) {\n                            if (i == searchIndexArr.length - 1) {\n                                count = 0;\n                            } else {\n                                count = i + 1;\n                            }\n                            break;\n                        }\n                    }\n                }\n                Store.luckysheet_select_save = [{\n                        'row': [\n                            searchIndexArr[count].r,\n                            searchIndexArr[count].r\n                        ],\n                        'column': [\n                            searchIndexArr[count].c,\n                            searchIndexArr[count].c\n                        ]\n                    }];\n            } else {\n                let rf = range[range.length - 1].row_focus;\n                let cf = range[range.length - 1].column_focus;\n                for (let i = 0; i < searchIndexArr.length; i++) {\n                    if (searchIndexArr[i].r == rf && searchIndexArr[i].c == cf) {\n                        if (i == searchIndexArr.length - 1) {\n                            count = 0;\n                        } else {\n                            count = i + 1;\n                        }\n                        break;\n                    }\n                }\n                for (let s = 0; s < range.length; s++) {\n                    let r1 = range[s].row[0], r2 = range[s].row[1];\n                    let c1 = range[s].column[0], c2 = range[s].column[1];\n                    if (searchIndexArr[count].r >= r1 && searchIndexArr[count].r <= r2 && searchIndexArr[count].c >= c1 && searchIndexArr[count].c <= c2) {\n                        let obj = range[s];\n                        obj['row_focus'] = searchIndexArr[count].r;\n                        obj['column_focus'] = searchIndexArr[count].c;\n                        range.splice(s, 1);\n                        range.push(obj);\n                        break;\n                    }\n                }\n                Store.luckysheet_select_save = range;\n            }\n            selectHightlightShow();\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft(), scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let winH = $('#luckysheet-cell-main').height(), winW = $('#luckysheet-cell-main').width();\n            let row = Store.visibledatarow[searchIndexArr[count].r], row_pre = searchIndexArr[count].r - 1 == -1 ? 0 : Store.visibledatarow[searchIndexArr[count].r - 1];\n            let col = Store.visibledatacolumn[searchIndexArr[count].c], col_pre = searchIndexArr[count].c - 1 == -1 ? 0 : Store.visibledatacolumn[searchIndexArr[count].c - 1];\n            if (col - scrollLeft - winW + 20 > 0) {\n                $('#luckysheet-scrollbar-x').scrollLeft(col - winW + 20);\n            } else if (col_pre - scrollLeft - 20 < 0) {\n                $('#luckysheet-scrollbar-x').scrollLeft(col_pre - 20);\n            }\n            if (row - scrollTop - winH + 20 > 0) {\n                $('#luckysheet-scrollbar-y').scrollTop(row - winH + 20);\n            } else if (row_pre - scrollTop - 20 < 0) {\n                $('#luckysheet-scrollbar-y').scrollTop(row_pre - 20);\n            }\n            if ($('#searchAllbox').is(':visible')) {\n                $('#luckysheet-search-replace #searchAllbox .boxItem').removeClass('on');\n            }\n        },\n        searchAll: function () {\n            let _this = this;\n            const _locale = locale();\n            const locale_findAndReplace = _locale.findAndReplace;\n            $('#luckysheet-search-replace #searchAllbox').remove();\n            let searchText = $('#luckysheet-search-replace #searchInput input').val();\n            if (searchText == '' || searchText == null) {\n                return;\n            }\n            let range;\n            if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1] && Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                range = [{\n                        'row': [\n                            0,\n                            Store.flowdata.length - 1\n                        ],\n                        'column': [\n                            0,\n                            Store.flowdata[0].length - 1\n                        ]\n                    }];\n            } else {\n                range = $.extend(true, [], Store.luckysheet_select_save);\n            }\n            let searchIndexArr = _this.getSearchIndexArr(searchText, range);\n            if (searchIndexArr.length == 0) {\n                if (isEditMode()) {\n                    alert(locale_findAndReplace.noFindTip);\n                } else {\n                    tooltip.info(locale_findAndReplace.noFindTip, '');\n                }\n                return;\n            }\n            let searchAllHtml = '';\n            for (let i = 0; i < searchIndexArr.length; i++) {\n                let value_ShowEs = valueShowEs(searchIndexArr[i].r, searchIndexArr[i].c, Store.flowdata).toString();\n                if (value_ShowEs.indexOf('</') > -1 && value_ShowEs.indexOf('>') > -1) {\n                    searchAllHtml += '<div class=\"boxItem\" data-row=\"' + searchIndexArr[i].r + '\" data-col=\"' + searchIndexArr[i].c + '\" data-sheetIndex=\"' + Store.currentSheetIndex + '\">' + '<span>' + Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].name + '</span>' + '<span>' + chatatABC(searchIndexArr[i].c) + (searchIndexArr[i].r + 1) + '</span>' + '<span>' + value_ShowEs + '</span>' + '</div>';\n                } else {\n                    searchAllHtml += '<div class=\"boxItem\" data-row=\"' + searchIndexArr[i].r + '\" data-col=\"' + searchIndexArr[i].c + '\" data-sheetIndex=\"' + Store.currentSheetIndex + '\">' + '<span>' + Store.luckysheetfile[getSheetIndex(Store.currentSheetIndex)].name + '</span>' + '<span>' + chatatABC(searchIndexArr[i].c) + (searchIndexArr[i].r + 1) + '</span>' + '<span title=\"' + value_ShowEs + '\">' + value_ShowEs + '</span>' + '</div>';\n                }\n            }\n            $('<div id=\"searchAllbox\"><div class=\"boxTitle\"><span>' + locale_findAndReplace.searchTargetSheet + '</span><span>' + locale_findAndReplace.searchTargetCell + '</span><span>' + locale_findAndReplace.searchTargetValue + '</span></div><div class=\"boxMain\">' + searchAllHtml + '</div></div>').appendTo($('#luckysheet-search-replace'));\n            $('#luckysheet-search-replace #searchAllbox .boxItem').eq(0).addClass('on').siblings().removeClass('on');\n            Store.luckysheet_select_save = [{\n                    'row': [\n                        searchIndexArr[0].r,\n                        searchIndexArr[0].r\n                    ],\n                    'column': [\n                        searchIndexArr[0].c,\n                        searchIndexArr[0].c\n                    ]\n                }];\n            selectHightlightShow();\n        },\n        getSearchIndexArr: function (searchText, range) {\n            let arr = [];\n            let obj = {};    //正则表达式匹配\n            //正则表达式匹配\n            let regCheck = false;\n            if ($(\"#luckysheet-search-replace #regCheck input[type='checkbox']\").is(':checked')) {\n                regCheck = true;\n            }    //整词匹配\n            //整词匹配\n            let wordCheck = false;\n            if ($(\"#luckysheet-search-replace #wordCheck input[type='checkbox']\").is(':checked')) {\n                wordCheck = true;\n            }    //区分大小写匹配\n            //区分大小写匹配\n            let caseCheck = false;\n            if ($(\"#luckysheet-search-replace #caseCheck input[type='checkbox']\").is(':checked')) {\n                caseCheck = true;\n            }\n            for (let s = 0; s < range.length; s++) {\n                let r1 = range[s].row[0], r2 = range[s].row[1];\n                let c1 = range[s].column[0], c2 = range[s].column[1];\n                for (let r = r1; r <= r2; r++) {\n                    for (let c = c1; c <= c2; c++) {\n                        let cell = Store.flowdata[r][c];\n                        if (cell != null) {\n                            let value = valueShowEs(r, c, Store.flowdata);\n                            if (value == 0) {\n                                value = value.toString();\n                            }\n                            if (value != null && value != '') {\n                                value = value.toString();\n                                if (wordCheck) {\n                                    //整词\n                                    if (caseCheck) {\n                                        if (searchText == value) {\n                                            if (!(r + '_' + c in obj)) {\n                                                obj[r + '_' + c] = 0;\n                                                arr.push({\n                                                    'r': r,\n                                                    'c': c\n                                                });\n                                            }\n                                        }\n                                    } else {\n                                        let txt = searchText.toLowerCase();\n                                        if (txt == value.toLowerCase()) {\n                                            if (!(r + '_' + c in obj)) {\n                                                obj[r + '_' + c] = 0;\n                                                arr.push({\n                                                    'r': r,\n                                                    'c': c\n                                                });\n                                            }\n                                        }\n                                    }\n                                } else if (regCheck) {\n                                    //正则表达式\n                                    let reg;\n                                    if (caseCheck) {\n                                        reg = new RegExp(func_methods.getRegExpStr(searchText), 'g');\n                                    } else {\n                                        reg = new RegExp(func_methods.getRegExpStr(searchText), 'ig');\n                                    }\n                                    if (reg.test(value)) {\n                                        if (!(r + '_' + c in obj)) {\n                                            obj[r + '_' + c] = 0;\n                                            arr.push({\n                                                'r': r,\n                                                'c': c\n                                            });\n                                        }\n                                    }\n                                } else if (caseCheck) {\n                                    //区分大小写\n                                    let reg = new RegExp(func_methods.getRegExpStr(searchText), 'g');\n                                    if (reg.test(value)) {\n                                        if (!(r + '_' + c in obj)) {\n                                            obj[r + '_' + c] = 0;\n                                            arr.push({\n                                                'r': r,\n                                                'c': c\n                                            });\n                                        }\n                                    }\n                                } else {\n                                    let reg = new RegExp(func_methods.getRegExpStr(searchText), 'ig');\n                                    if (reg.test(value)) {\n                                        if (!(r + '_' + c in obj)) {\n                                            obj[r + '_' + c] = 0;\n                                            arr.push({\n                                                'r': r,\n                                                'c': c\n                                            });\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return arr;\n        },\n        replace: function () {\n            let _this = this;\n            const _locale = locale();\n            const locale_findAndReplace = _locale.findAndReplace;\n            if (!Store.allowEdit) {\n                tooltip.info(locale_findAndReplace.modeTip, '');\n                return;\n            }\n            let searchText = $('#luckysheet-search-replace #searchInput input').val();\n            if (searchText == '' || searchText == null) {\n                if (isEditMode()) {\n                    alert(locale_findAndReplace.searchInputTip);\n                } else {\n                    tooltip.info(locale_findAndReplace.searchInputTip, '');\n                }\n                return;\n            }\n            let range;\n            if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1] && Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                range = [{\n                        'row': [\n                            0,\n                            Store.flowdata.length - 1\n                        ],\n                        'column': [\n                            0,\n                            Store.flowdata[0].length - 1\n                        ]\n                    }];\n            } else {\n                range = $.extend(true, [], Store.luckysheet_select_save);\n            }\n            let searchIndexArr = _this.getSearchIndexArr(searchText, range);\n            if (searchIndexArr.length == 0) {\n                if (isEditMode()) {\n                    alert(locale_findAndReplace.noReplceTip);\n                } else {\n                    tooltip.info(locale_findAndReplace.noReplceTip, '');\n                }\n                return;\n            }\n            let count = null;\n            let last = Store.luckysheet_select_save[Store.luckysheet_select_save.length - 1];\n            let rf = last.row_focus;\n            let cf = last.column_focus;\n            for (let i = 0; i < searchIndexArr.length; i++) {\n                if (searchIndexArr[i].r == rf && searchIndexArr[i].c == cf) {\n                    count = i;\n                    break;\n                }\n            }\n            if (count == null) {\n                if (searchIndexArr.length == 0) {\n                    if (isEditMode()) {\n                        alert(locale_findAndReplace.noMatchTip);\n                    } else {\n                        tooltip.info(locale_findAndReplace.noMatchTip, '');\n                    }\n                    return;\n                } else {\n                    count = 0;\n                }\n            }    //正则表达式匹配\n            //正则表达式匹配\n            let regCheck = false;\n            if ($(\"#luckysheet-search-replace #regCheck input[type='checkbox']\").is(':checked')) {\n                regCheck = true;\n            }    //整词匹配\n            //整词匹配\n            let wordCheck = false;\n            if ($(\"#luckysheet-search-replace #wordCheck input[type='checkbox']\").is(':checked')) {\n                wordCheck = true;\n            }    //区分大小写匹配\n            //区分大小写匹配\n            let caseCheck = false;\n            if ($(\"#luckysheet-search-replace #caseCheck input[type='checkbox']\").is(':checked')) {\n                caseCheck = true;\n            }\n            let replaceText = $('#luckysheet-search-replace #replaceInput input').val();\n            let d = Store.deepCopyFlowData(Store.flowdata);\n            let r, c;\n            if (wordCheck) {\n                r = searchIndexArr[count].r;\n                c = searchIndexArr[count].c;\n                let v = replaceText;\n                setcellvalue(r, c, d, v);\n            } else {\n                let reg;\n                if (caseCheck) {\n                    reg = new RegExp(func_methods.getRegExpStr(searchText), 'g');\n                } else {\n                    reg = new RegExp(func_methods.getRegExpStr(searchText), 'ig');\n                }\n                r = searchIndexArr[count].r;\n                c = searchIndexArr[count].c;\n                let v = valueShowEs(r, c, d).toString().replace(reg, replaceText);\n                setcellvalue(r, c, d, v);\n            }\n            Store.luckysheet_select_save = [{\n                    'row': [\n                        r,\n                        r\n                    ],\n                    'column': [\n                        c,\n                        c\n                    ]\n                }];\n            if ($('#luckysheet-search-replace #searchAllbox').is(':visible')) {\n                $('#luckysheet-search-replace #searchAllbox').hide();\n            }\n            ///jfrefreshgrid(d, Store.luckysheet_select_save);\n            Store.refeshRange(d, Store.luckysheet_select_save);\n            selectHightlightShow();\n            let scrollLeft = $('#luckysheet-cell-main').scrollLeft(), scrollTop = $('#luckysheet-cell-main').scrollTop();\n            let winH = $('#luckysheet-cell-main').height(), winW = $('#luckysheet-cell-main').width();\n            let row = Store.visibledatarow[r], row_pre = r - 1 == -1 ? 0 : Store.visibledatarow[r - 1];\n            let col = Store.visibledatacolumn[c], col_pre = c - 1 == -1 ? 0 : Store.visibledatacolumn[c - 1];\n            if (col - scrollLeft - winW + 20 > 0) {\n                $('#luckysheet-scrollbar-x').scrollLeft(col - winW + 20);\n            } else if (col_pre - scrollLeft - 20 < 0) {\n                $('#luckysheet-scrollbar-x').scrollLeft(col_pre - 20);\n            }\n            if (row - scrollTop - winH + 20 > 0) {\n                $('#luckysheet-scrollbar-y').scrollTop(row - winH + 20);\n            } else if (row_pre - scrollTop - 20 < 0) {\n                $('#luckysheet-scrollbar-y').scrollTop(row_pre - 20);\n            }\n        },\n        replaceAll: function () {\n            let _this = this;\n            const _locale = locale();\n            const locale_findAndReplace = _locale.findAndReplace;\n            if (!Store.allowEdit) {\n                tooltip.info(locale_findAndReplace.modeTip, '');\n                return;\n            }\n            let searchText = $('#luckysheet-search-replace #searchInput input').val();\n            if (searchText == '' || searchText == null) {\n                if (isEditMode()) {\n                    alert(locale_findAndReplace.searchInputTip);\n                } else {\n                    tooltip.info(locale_findAndReplace.searchInputTip, '');\n                }\n                return;\n            }\n            let range;\n            if (Store.luckysheet_select_save.length == 0 || Store.luckysheet_select_save.length == 1 && Store.luckysheet_select_save[0].row[0] == Store.luckysheet_select_save[0].row[1] && Store.luckysheet_select_save[0].column[0] == Store.luckysheet_select_save[0].column[1]) {\n                range = [{\n                        'row': [\n                            0,\n                            Store.flowdata.length - 1\n                        ],\n                        'column': [\n                            0,\n                            Store.flowdata[0].length - 1\n                        ]\n                    }];\n            } else {\n                range = $.extend(true, [], Store.luckysheet_select_save);\n            }\n            let searchIndexArr = _this.getSearchIndexArr(searchText, range);\n            if (searchIndexArr.length == 0) {\n                if (isEditMode()) {\n                    alert(locale_findAndReplace.noReplceTip);\n                } else {\n                    tooltip.info(locale_findAndReplace.noReplceTip, '');\n                }\n                return;\n            }    //正则表达式匹配\n            //正则表达式匹配\n            let regCheck = false;\n            if ($(\"#luckysheet-search-replace #regCheck input[type='checkbox']\").is(':checked')) {\n                regCheck = true;\n            }    //整词匹配\n            //整词匹配\n            let wordCheck = false;\n            if ($(\"#luckysheet-search-replace #wordCheck input[type='checkbox']\").is(':checked')) {\n                wordCheck = true;\n            }    //区分大小写匹配\n            //区分大小写匹配\n            let caseCheck = false;\n            if ($(\"#luckysheet-search-replace #caseCheck input[type='checkbox']\").is(':checked')) {\n                caseCheck = true;\n            }\n            let replaceText = $('#luckysheet-search-replace #replaceInput input').val();\n            let d = Store.deepCopyFlowData(Store.flowdata);\n            if (wordCheck) {\n                for (let i = 0; i < searchIndexArr.length; i++) {\n                    let r = searchIndexArr[i].r;\n                    let c = searchIndexArr[i].c;\n                    let v = replaceText;\n                    setcellvalue(r, c, d, v);\n                    range.push({\n                        'row': [\n                            r,\n                            r\n                        ],\n                        'column': [\n                            c,\n                            c\n                        ]\n                    });\n                }\n            } else {\n                let reg;\n                if (caseCheck) {\n                    reg = new RegExp(func_methods.getRegExpStr(searchText), 'g');\n                } else {\n                    reg = new RegExp(func_methods.getRegExpStr(searchText), 'ig');\n                }\n                for (let i = 0; i < searchIndexArr.length; i++) {\n                    let r = searchIndexArr[i].r;\n                    let c = searchIndexArr[i].c;\n                    let v = valueShowEs(r, c, d).toString().replace(reg, replaceText);\n                    setcellvalue(r, c, d, v);\n                    range.push({\n                        'row': [\n                            r,\n                            r\n                        ],\n                        'column': [\n                            c,\n                            c\n                        ]\n                    });\n                }\n            }\n            if ($('#luckysheet-search-replace #searchAllbox').is(':visible')) {\n                $('#luckysheet-search-replace #searchAllbox').hide();\n            }\n            ///jfrefreshgrid(d, range);\n            Store.refreshRange(d, range);\n            Store.luckysheet_select_save = $.extend(true, [], range);\n            selectHightlightShow();\n            let succeedInfo = replaceHtml(locale_findAndReplace.successTip, { 'xlength': searchIndexArr.length });\n            if (isEditMode()) {\n                alert(succeedInfo);\n            } else {\n                tooltip.info(succeedInfo, '');\n            }\n        }\n    };\n    return luckysheetSearchReplace;\n});"]}