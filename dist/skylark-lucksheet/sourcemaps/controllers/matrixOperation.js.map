{"version":3,"sources":["controllers/matrixOperation.js"],"names":["define","selection","m_util","m_validate","m_getdata","tooltip","editor","locale","Store","getObjType","chatatABC","numFormat","luckysheetContainerFocus","hasPartMC","isEditMode","getdatabyselection","getcellvalue","initialMatrixOperation","locale_drag","drag","$","click","event","hide","luckysheet_select_save","length","alert","noMulti","info","config","has_PartMC","s","r1","row","r2","c1","column","c2","noPartMerge","getdata","arr","obj","i","push","r","c","undefined","copybyformat","JSON","stringify","st","a","target","nodeName","val","col","parseInt","toString","inputCorrect","notLessOne","arrlen","ret","clen","offset","offsetColumnLessZero","v","bool","value","controlHandler","controlHandlerD","jfnqrt","x","p","x0","x1","Math","pow","abs","caltype","calvalue","ct","t","sqrt","cbrt","log","m","getdatalen","stdel","eddel","a1","unshift","l","collen","arr1","repeat"],"mappings":"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","file":"../../controllers/matrixOperation.js","sourcesContent":["define([\n    './selection',\n    '../utils/util',\n    '../global/validate',\n    '../global/getdata',\n    '../global/tooltip',\n    '../global/editor',\n    '../locale/locale',\n    '../store'\n], function (selection, m_util, m_validate, m_getdata, tooltip, editor, locale, Store) {\n    'use strict';\n    const {getObjType, chatatABC, numFormat, luckysheetContainerFocus} = m_util;\n    const {hasPartMC, isEditMode} = m_validate;\n    const {getdatabyselection, getcellvalue} = m_getdata;\n    function initialMatrixOperation() {\n        const locale_drag = locale().drag;    //右键功能键\n                                              //复制为json格式字符串，首行为标题\n        //右键功能键\n        //复制为json格式字符串，首行为标题\n        $('#luckysheet-copy-json-head').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }    //复制范围内包含部分合并单元格，提示\n            //复制范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            let arr = [];\n            if (getdata.length == 0) {\n                return;\n            }\n            if (getdata.length == 1) {\n                let obj = {};\n                for (let i = 0; i < getdata[0].length; i++) {\n                    obj[getcellvalue(0, i, getdata)] = '';\n                }\n                arr.push(obj);\n            } else {\n                for (let r = 1; r < getdata.length; r++) {\n                    let obj = {};\n                    for (let c = 0; c < getdata[0].length; c++) {\n                        if (getcellvalue(0, c, getdata) == undefined) {\n                            obj[''] = getcellvalue(r, c, getdata);\n                        } else {\n                            obj[getcellvalue(0, c, getdata)] = getcellvalue(r, c, getdata);\n                        }\n                    }\n                    arr.push(obj);\n                }\n            }\n            selection.copybyformat(event, JSON.stringify(arr));\n        });    //复制为json格式字符串，无标题，采用ABCD作为标题\n        //复制为json格式字符串，无标题，采用ABCD作为标题\n        $('#luckysheet-copy-json-nohead').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }    //复制范围内包含部分合并单元格，提示\n            //复制范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            let arr = [];\n            if (getdata.length == 0) {\n                return;\n            }\n            let st = Store.luckysheet_select_save[0]['column'][0];\n            for (let r = 0; r < getdata.length; r++) {\n                let obj = {};\n                for (let c = 0; c < getdata[0].length; c++) {\n                    obj[chatatABC(c + st)] = getcellvalue(r, c, getdata);\n                }\n                arr.push(obj);\n            }\n            selection.copybyformat(event, JSON.stringify(arr));\n        });    //复制为一维数组\n        //复制为一维数组\n        $('#luckysheet-copy-array1').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }    //复制范围内包含部分合并单元格，提示\n            //复制范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            let arr = [];\n            if (getdata.length == 0) {\n                return;\n            }\n            for (let r = 0; r < getdata.length; r++) {\n                for (let c = 0; c < getdata[0].length; c++) {\n                    arr.push(getcellvalue(r, c, getdata));\n                }\n            }\n            selection.copybyformat(event, JSON.stringify(arr));\n        });    //复制为二维数组\n        //复制为二维数组\n        $('#luckysheet-copy-array2').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }    //复制范围内包含部分合并单元格，提示\n            //复制范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            let arr = [];\n            if (getdata.length == 0) {\n                return;\n            }\n            for (let r = 0; r < getdata.length; r++) {\n                let a = [];\n                for (let c = 0; c < getdata[0].length; c++) {\n                    a.push(getcellvalue(r, c, getdata));\n                }\n                arr.push(a);\n            }\n            selection.copybyformat(event, JSON.stringify(arr));\n        });    //复制为多维数组\n        //复制为多维数组\n        $('#luckysheet-copy-arraymore-confirm').click(function (event) {\n            // Click input element, don't comfirm \n            if (event.target.nodeName === 'INPUT') {\n                return;\n            }\n            $('body .luckysheet-cols-menu').hide();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }    //复制范围内包含部分合并单元格，提示\n            //复制范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            let arr = [];\n            if (getdata.length == 0) {\n                return;\n            }\n            for (let r = 0; r < getdata.length; r++) {\n                for (let c = 0; c < getdata[0].length; c++) {\n                    arr.push(getdata[r][c]);\n                }\n            }\n            let row = $('#luckysheet-copy-arraymore-row').val(), col = $('#luckysheet-copy-arraymore-col').val();\n            if (row == '' && col == '') {\n                selection.copybyformat(event, JSON.stringify(arr));\n                $('body .luckysheet-cols-menu').hide();\n                return;\n            }\n            if (row == '') {\n                row = 1;\n            } else {\n                row = parseInt(row);\n                if (row == null) {\n                    row = 1;\n                }\n            }\n            if (col == '') {\n                col = 1;\n            } else {\n                col = parseInt(col);\n                if (col == null) {\n                    col = 1;\n                }\n            }\n            if (row.toString() == 'NaN' || col.toString() == 'NaN') {\n                if (isEditMode()) {\n                    alert(locale_drag.inputCorrect);\n                } else {\n                    tooltip.info(locale_drag.inputCorrect, '');\n                }\n                return;\n            }\n            if (row < 1 || col < 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.notLessOne);\n                } else {\n                    tooltip.info(locale_drag.notLessOne, '');\n                }\n                return;\n            }\n            let arrlen = arr.length, i = 0, ret = [];\n            for (let r = 0; r < row; r++) {\n                let a = [];\n                for (let c = 0; c < col; c++) {\n                    a.push(arr[i++]);\n                    if (i >= arrlen) {\n                        selection.copybyformat(event, JSON.stringify(ret));\n                        $('body .luckysheet-cols-menu').hide();\n                        return;\n                    }\n                }\n                ret.push(a);\n            }\n            selection.copybyformat(event, JSON.stringify(ret));\n        });    //复制为对角线\n        //复制为对角线\n        $('#luckysheet-copy-diagonal').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }    //复制范围内包含部分合并单元格，提示\n            //复制范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            let arr = [];\n            if (getdata.length == 0) {\n                return;\n            }\n            let clen = getdata[0].length;\n            for (let r = 0; r < getdata.length; r++) {\n                if (r >= clen) {\n                    break;\n                }\n                arr.push(getdata[r][r]);\n            }\n            selection.copybyformat(event, JSON.stringify(arr));\n        });    //复制为反对角线\n        //复制为反对角线\n        $('#luckysheet-copy-antidiagonal').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }    //复制范围内包含部分合并单元格，提示\n            //复制范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            let arr = [];\n            if (getdata.length == 0) {\n                return;\n            }\n            let clen = getdata[0].length;\n            for (let r = 0; r < getdata.length; r++) {\n                if (r >= clen) {\n                    break;\n                }\n                arr.push(getdata[r][clen - r - 1]);\n            }\n            selection.copybyformat(event, JSON.stringify(arr));\n        });    //复制为对角偏移n列\n        //复制为对角偏移n列\n        $('#luckysheet-copy-diagonaloffset').click(function (event) {\n            // Click input element, don't comfirm \n            if (event.target.nodeName === 'INPUT') {\n                return;\n            }\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }    //复制范围内包含部分合并单元格，提示\n            //复制范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            let arr = [];\n            if (getdata.length == 0) {\n                return;\n            }\n            let clen = getdata[0].length, offset = parseInt($('#luckysheet-copy-diagonaloffset-value').val());\n            if (offset.toString() == 'NaN') {\n                if (isEditMode()) {\n                    alert(locale_drag.inputCorrect);\n                } else {\n                    tooltip.info(locale_drag.inputCorrect, '');\n                }\n                return;\n            }\n            if (offset < 0) {\n                if (isEditMode()) {\n                    alert(locale_drag.offsetColumnLessZero);\n                } else {\n                    tooltip.info(locale_drag.offsetColumnLessZero, '');\n                }\n                return;\n            }\n            if (offset == null) {\n                offset = 1;\n            }\n            for (let r = 0; r < getdata.length; r++) {\n                if (r + offset >= clen) {\n                    break;\n                }\n                arr.push(getdata[r][r + offset]);\n            }\n            selection.copybyformat(event, JSON.stringify(arr));\n        });    //复制为布尔值\n        //复制为布尔值\n        $('#luckysheet-copy-boolvalue').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }    //复制范围内包含部分合并单元格，提示\n            //复制范围内包含部分合并单元格，提示\n            if (Store.config['merge'] != null) {\n                let has_PartMC = false;\n                for (let s = 0; s < Store.luckysheet_select_save.length; s++) {\n                    let r1 = Store.luckysheet_select_save[s].row[0], r2 = Store.luckysheet_select_save[s].row[1];\n                    let c1 = Store.luckysheet_select_save[s].column[0], c2 = Store.luckysheet_select_save[s].column[1];\n                    has_PartMC = hasPartMC(Store.config, r1, r2, c1, c2);\n                    if (has_PartMC) {\n                        break;\n                    }\n                }\n                if (has_PartMC) {\n                    if (isEditMode()) {\n                        alert(locale_drag.noPartMerge);\n                    } else {\n                        tooltip.info(locale_drag.noPartMerge, '');\n                    }\n                    return;\n                }\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            let arr = [];\n            if (getdata.length == 0) {\n                return;\n            }\n            for (let r = 0; r < getdata.length; r++) {\n                let a = [];\n                for (let c = 0; c < getdata[0].length; c++) {\n                    let bool = false;\n                    let v;\n                    if (getObjType(getdata[r][c]) == 'object') {\n                        v = getdata[r][c].v;\n                    } else {\n                        v = getdata[r][c];\n                    }\n                    if (v == null || v == '') {\n                        bool = false;\n                    } else {\n                        v = parseInt(v);\n                        if (v == null || v > 0) {\n                            bool = true;\n                        } else {\n                            bool = false;\n                        }\n                    }\n                    a.push(bool);\n                }\n                arr.push(a);\n            }\n            selection.copybyformat(event, JSON.stringify(arr));\n        });    //矩阵操作选区 翻转 上下\n        //矩阵操作选区 翻转 上下\n        $('#luckysheet-matrix-turn-up').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            if (getdata.length == 0) {\n                return;\n            }\n            let arr = [];\n            for (let r = getdata.length - 1; r >= 0; r--) {\n                let a = [];\n                for (let c = 0; c < getdata[0].length; c++) {\n                    let value = '';\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                    }\n                    a.push(value);\n                }\n                arr.push(a);\n            }\n            editor.controlHandler(arr);\n        });    //矩阵操作选区 翻转 左右\n        //矩阵操作选区 翻转 左右\n        $('#luckysheet-matrix-turn-left').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            if (getdata.length == 0) {\n                return;\n            }\n            let arr = [];\n            for (let r = 0; r < getdata.length; r++) {\n                let a = [];\n                for (let c = getdata[0].length - 1; c >= 0; c--) {\n                    let value = '';\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                    }\n                    a.push(value);\n                }\n                arr.push(a);\n            }\n            editor.controlHandler(arr);\n        });    //矩阵操作选区 翻转 顺时针\n        //矩阵操作选区 翻转 顺时针\n        $('#luckysheet-matrix-turn-cw').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            if (getdata.length == 0) {\n                return;\n            }\n            let arr = [];\n            for (let c = 0; c < getdata[0].length; c++) {\n                let a = [];\n                for (let r = getdata.length - 1; r >= 0; r--) {\n                    let value = '';\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                    }\n                    a.push(value);\n                }\n                arr.push(a);\n            }\n            editor.controlHandlerD(arr);\n        });    //矩阵操作选区 翻转 逆时针\n        //矩阵操作选区 翻转 逆时针\n        $('#luckysheet-matrix-turn-anticw').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            if (getdata.length == 0) {\n                return;\n            }\n            let arr = [];\n            for (let c = getdata[0].length - 1; c >= 0; c--) {\n                let a = [];\n                for (let r = 0; r < getdata.length; r++) {\n                    let value = '';\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                    }\n                    a.push(value);\n                }\n                arr.push(a);\n            }\n            editor.controlHandlerD(arr);\n        });    //矩阵操作选区 转置\n        //矩阵操作选区 转置\n        $('#luckysheet-matrix-turn-trans').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            if (getdata.length == 0) {\n                return;\n            }\n            let arr = [];\n            for (let c = 0; c < getdata[0].length; c++) {\n                let a = [];\n                for (let r = 0; r < getdata.length; r++) {\n                    let value = '';\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                    }\n                    a.push(value);\n                }\n                arr.push(a);\n            }\n            editor.controlHandlerD(arr);\n        });\n        let jfnqrt = function (x, p) {\n            if (x == 0)\n                return 0;\n            let x0, x1;\n            x0 = x;\n            x1 = (p - 1) * x0 / p + x / (Math.pow(x0, p - 1) * p);    //利用迭代法求解\n            //利用迭代法求解\n            while (Math.abs(x1 - x0) > 0.000001) {\n                x0 = x1;\n                x1 = (p - 1) * x0 / p + x / (Math.pow(x0, p - 1) * p);\n            }\n            return x1;\n        };    //矩阵操作选区 矩阵计算\n        //矩阵操作选区 矩阵计算\n        $('#luckysheet-matrix-cal-confirm').click(function (event) {\n            // Click input element, don't comfirm \n            if (event.target.nodeName === 'INPUT' || event.target.nodeName === 'SELECT') {\n                return;\n            }\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            if (getdata.length == 0) {\n                return;\n            }\n            let caltype = $('#luckysheet-matrix-cal-type').val(), calvalue = parseInt($('#luckysheet-matrix-cal-value').val());\n            if (calvalue.toString() == 'NaN') {\n                if (isEditMode()) {\n                    alert(locale_drag.inputCorrect);\n                } else {\n                    tooltip.info(locale_drag.inputCorrect, '');\n                }\n                return;\n            }\n            if (calvalue == null) {\n                calvalue = 2;\n            }\n            let arr = [];\n            for (let r = 0; r < getdata.length; r++) {\n                let a = [];\n                for (let c = 0; c < getdata[0].length; c++) {\n                    let value = '';\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                        if (parseInt(value) != null && getdata[r][c].ct != undefined && getdata[r][c].ct.t == 'n') {\n                            if (caltype == 'minus') {\n                                value.v = value.v - calvalue;\n                            } else if (caltype == 'multiply') {\n                                value.v = value.v * calvalue;\n                            } else if (caltype == 'divided') {\n                                value.v = numFormat(value.v / calvalue, 4);\n                            } else if (caltype == 'power') {\n                                value.v = Math.pow(value.v, calvalue);\n                            } else if (caltype == 'root') {\n                                if (calvalue == 2) {\n                                    value.v = numFormat(Math.sqrt(value.v), 4);\n                                } else if (calvalue == 3 && Math.cbrt) {\n                                    value.v = numFormat(Math.cbrt(value.v), 4);\n                                } else {\n                                    value.v = numFormat(jfnqrt(value.v, calvalue), 4);\n                                }\n                            } else if (caltype == 'log') {\n                                value.v = numFormat(Math.log(value.v) * 10000 / Math.log(Math.abs(calvalue)), 4);\n                            } else {\n                                value.v = value.v + calvalue;\n                            }\n                            if (value.v == null) {\n                                value.m = '';\n                            } else {\n                                value.m = value.v.toString();\n                            }\n                        }\n                    }\n                    a.push(value);\n                }\n                arr.push(a);\n            }\n            editor.controlHandler(arr);\n        });    //矩阵操作选区 删除两端0值 按行\n        //矩阵操作选区 删除两端0值 按行\n        $('#luckysheet-matrix-delezero-row').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            if (getdata.length == 0) {\n                return;\n            }\n            let arr = [];\n            let getdatalen = getdata[0].length;\n            for (let r = 0; r < getdata.length; r++) {\n                let a = [], stdel = true, eddel = true;\n                for (let c = 0; c < getdatalen; c++) {\n                    let value = '';\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                        if ((value.v == '0' || value.v == 0) && stdel) {\n                            continue;\n                        } else {\n                            stdel = false;\n                        }\n                    }\n                    a.push(value);\n                }\n                let a1 = [];\n                if (a.length == getdatalen) {\n                    a1 = a;\n                } else {\n                    for (let c = a.length - 1; c >= 0; c--) {\n                        let value = '';\n                        if (a[c] != null) {\n                            value = a[c];\n                            if ((value.v == '0' || value.v == 0) && eddel) {\n                                continue;\n                            } else {\n                                eddel = false;\n                            }\n                        }\n                        a1.unshift(value);\n                    }\n                    let l = getdatalen - a1.length;\n                    for (let c1 = 0; c1 < l; c1++) {\n                        a1.push('');\n                    }\n                }\n                arr.push(a1);\n            }\n            editor.controlHandler(arr);\n        });    //矩阵操作选区 删除两端0值 按列\n        //矩阵操作选区 删除两端0值 按列\n        $('#luckysheet-matrix-delezero-column').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            if (getdata.length == 0) {\n                return;\n            }\n            let arr = [];\n            let getdatalen = getdata.length, collen = getdata[0].length;\n            for (let c = 0; c < collen; c++) {\n                let a = [], stdel = true, eddel = true;\n                for (let r = 0; r < getdatalen; r++) {\n                    let value = '';\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                        if ((value.v == '0' || value.v == 0) && stdel) {\n                            continue;\n                        } else {\n                            stdel = false;\n                        }\n                    }\n                    a.push(value);\n                }\n                let a1 = [];\n                if (a.length == getdatalen) {\n                    a1 = a;\n                } else {\n                    for (let r = a.length - 1; r >= 0; r--) {\n                        let value = '';\n                        if (a[r] != null) {\n                            value = a[r];\n                            if ((value.v == '0' || value.v == 0) && eddel) {\n                                continue;\n                            } else {\n                                eddel = false;\n                            }\n                        }\n                        a1.unshift(value);\n                    }\n                    let l = getdatalen - a1.length;\n                    for (let r1 = 0; r1 < l; r1++) {\n                        a1.push('');\n                    }\n                }\n                arr.push(a1);\n            }\n            let arr1 = [];\n            for (let c = 0; c < arr[0].length; c++) {\n                let a = [];\n                for (let r = 0; r < arr.length; r++) {\n                    let value = '';\n                    if (arr[r] != null && arr[r][c] != null) {\n                        value = arr[r][c];\n                    }\n                    a.push(value);\n                }\n                arr1.push(a);\n            }\n            editor.controlHandler(arr1);\n        });    //矩阵操作选区 删除重复值 按行\n        //矩阵操作选区 删除重复值 按行\n        $('#luckysheet-matrix-delerpt-row').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            if (getdata.length == 0) {\n                return;\n            }\n            let arr = [];\n            let getdatalen = getdata[0].length;\n            for (let r = 0; r < getdata.length; r++) {\n                let a = [], repeat = {};\n                for (let c = 0; c < getdatalen; c++) {\n                    let value = null;\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                        if (value.v in repeat) {\n                            repeat[value.v].push(value);\n                        } else {\n                            repeat[value.v] = [];\n                            repeat[value.v].push(value);\n                        }\n                    }\n                }\n                for (let c = 0; c < getdatalen; c++) {\n                    let value = null;\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                        if (repeat[value.v].length == 1) {\n                            a.push(value);\n                        }\n                    }\n                }\n                let l = getdatalen - a.length;\n                for (let c1 = 0; c1 < l; c1++) {\n                    a.push(null);\n                }\n                arr.push(a);\n            }\n            editor.controlHandler(arr);\n        });    //矩阵操作选区 删除重复值 按列\n        //矩阵操作选区 删除重复值 按列\n        $('#luckysheet-matrix-delerpt-column').click(function (event) {\n            $('body .luckysheet-cols-menu').hide();\n            luckysheetContainerFocus();\n            if (Store.luckysheet_select_save.length > 1) {\n                if (isEditMode()) {\n                    alert(locale_drag.noMulti);\n                } else {\n                    tooltip.info(locale_drag.noMulti, '');\n                }\n                return;\n            }\n            let getdata = getdatabyselection(Store.luckysheet_select_save[0]);\n            if (getdata.length == 0) {\n                return;\n            }\n            let arr = [];\n            let getdatalen = getdata.length, collen = getdata[0].length;\n            for (let c = 0; c < collen; c++) {\n                let a = [], repeat = {};\n                for (let r = 0; r < getdatalen; r++) {\n                    let value = null;\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                        if (value.v in repeat) {\n                            repeat[value.v].push(value);\n                        } else {\n                            repeat[value.v] = [];\n                            repeat[value.v].push(value);\n                        }\n                    }\n                }\n                for (let r = 0; r < getdatalen; r++) {\n                    let value = null;\n                    if (getdata[r] != null && getdata[r][c] != null) {\n                        value = getdata[r][c];\n                        if (repeat[value.v].length == 1) {\n                            a.push(value);\n                        }\n                    }\n                }\n                a1 = a;\n                let l = getdatalen - a1.length;\n                for (let r1 = 0; r1 < l; r1++) {\n                    a1.push(null);\n                }\n                arr.push(a1);\n            }\n            let arr1 = [];\n            for (let c = 0; c < arr[0].length; c++) {\n                let a = [];\n                for (let r = 0; r < arr.length; r++) {\n                    let value = null;\n                    if (arr[r] != null && arr[r][c] != null) {\n                        value = arr[r][c];\n                    }\n                    a.push(value);\n                }\n                arr1.push(a);\n            }\n            editor.controlHandler(arr1);\n        });\n    }\n    return { initialMatrixOperation: initialMatrixOperation };\n});"]}