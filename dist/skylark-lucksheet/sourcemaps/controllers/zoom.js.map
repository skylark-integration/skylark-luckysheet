{"version":3,"sources":["controllers/zoom.js"],"names":["define","Store","locale","m_util","replaceHtml","positionToRatio","pos","ratio","Math","round","zoomNumberDomBind","r","$","html","domPos","css","zoomSlierDomBind","zoomInitial","click","currentRatio","zoomRatio","ceil","changeZoom","floor","zoomChange","mousedown","e","xoffset","this","offset","left","pageX","curentX","cursorLeft","parseFloat","document","off","on","event","moveX","stopPropagation"],"mappings":";;;;;;;AAAAA,QACI,WACA,mBACA,iBACD,SAAUC,EAAOC,EAAQC,GACxB,aACA,MAAMC,YAACA,GAAeD,EAyFtB,SAASE,EAAgBC,GACrB,IAAIC,EAAQ,EAMZ,OALID,EAAM,GACNC,EAAQC,KAAKC,MAAgC,KAAnB,IAANH,EAAY,IAAM,KAAc,IAC7CA,EAAM,KACbC,EAAQC,KAAKC,MAAmC,KAAf,GAAZH,EAAM,IAAU,IAAM,IAAY,KAEpDC,EAWX,SAASG,EAAkBH,GACvB,IAAII,EAAIH,KAAKC,MAAc,IAARF,GAAe,IAClCK,EAAE,8BAA8BC,KAAKF,GAXzC,SAA0BJ,GACtB,IAAIO,EAAS,GACTP,EAAQ,EACRO,EAASN,KAAKC,MAAsB,KAAfF,EAAQ,IAAa,KAAQ,GAC3CA,EAAQ,IACfO,EAASN,KAAKC,MAAoB,KAAbF,EAAQ,GAAW,IAAO,GAAK,IAExDK,EAAE,2BAA2BG,IAAI,OAAQD,EAAS,GAKlDE,CAAiBT,GAErB,OACIU,YAhHJ,WACIL,EAAE,0BAA0BM,MAAM,WAC9B,IAAIC,EAEAA,EADmB,MAAnBlB,EAAMmB,UACSnB,EAAMmB,UAAY,EAElBZ,KAAKa,KAAuB,GAAlBpB,EAAMmB,WAAkB,IAErDD,GAA8B,KACVlB,EAAMmB,YACtBD,GAA8B,IAE9BA,GAAgB,KAChBA,EAAe,IAGnBlB,EAAMqB,WAAWH,GACjBT,EAAkBS,KAEtBP,EAAE,yBAAyBM,MAAM,WAC7B,IAAIC,EAEAA,EADmB,MAAnBlB,EAAMmB,UACSnB,EAAMmB,UAAY,EAElBZ,KAAKe,MAAwB,GAAlBtB,EAAMmB,WAAkB,IAEtDD,GAA8B,KACVlB,EAAMmB,YACtBD,GAA8B,IAE9BA,GAAgB,IAChBA,EAAe,GAGnBK,WAAWL,GACXT,EAAkBS,KAEtBP,EAAE,2BAA2Ba,UAAU,SAAUC,GAC7C,IAAIC,EAAUf,EAAEgB,MAAMC,SAASC,KAC3BX,EAAed,EAD0BqB,EAAEK,MACJJ,GAE3C1B,EAAMqB,WAAWH,GACjBT,EAAkBS,KAEtBP,EAAE,2BAA2Ba,UAAU,SAAUC,GAC7C,IAAIM,EAAUN,EAAEK,MAAOE,EAAaC,WAAWtB,EAAE,2BAA2BG,IAAI,SAChFH,EAAE,2BAA2BG,IAAI,aAAc,QAC/CH,EAAEuB,UAAUC,IAAI,wBAAwBC,GAAG,uBAAwB,SAAUC,GACzE,IAAIC,EAAQD,EAAMP,MAOdzB,EAAM2B,GANIM,EAAQP,GAOlBb,EAAed,EAAgBC,GAC/Ba,EAAe,IACfA,EAAe,EACfb,EAAM,KAENa,EAAe,KACfA,EAAe,GACfb,EAAM,GAGVL,EAAMqB,WAAWH,GACjB,IAAIR,EAAIH,KAAKC,MAAqB,IAAfU,GAAsB,IACzCP,EAAE,8BAA8BC,KAAKF,GACrCC,EAAE,2BAA2BG,IAAI,OAAQT,EAAM,KAEnDM,EAAEuB,UAAUC,IAAI,sBAAsBC,GAAG,qBAAsB,SAAUC,GACrE1B,EAAEuB,UAAUC,IAAI,eAChBxB,EAAE,2BAA2BG,IAAI,aAAc,cAEnDW,EAAEc,oBACHtB,MAAM,SAAUQ,GACfA,EAAEc,oBAEN5B,EAAE,8BAA8BM,MAAM,WAElCjB,EAAMqB,WAAW,GACjBZ,EAAkB,KAEtBA,EAAkBT,EAAMmB,YA6BxBV,kBAAmBA","file":"../../controllers/zoom.js","sourcesContent":["define([\n    '../store',\n    '../locale/locale',\n    '../utils/util'\n], function (Store, locale, m_util) {\n    'use strict';\n    const {replaceHtml} = m_util;\n    function zoomInitial() {\n        $('#luckysheet-zoom-minus').click(function () {\n            let currentRatio;\n            if (Store.zoomRatio == null) {\n                currentRatio = Store.zoomRatio = 1;\n            } else {\n                currentRatio = Math.ceil(Store.zoomRatio * 10) / 10;\n            }\n            currentRatio = currentRatio - 0.1;\n            if (currentRatio == Store.zoomRatio) {\n                currentRatio = currentRatio - 0.1;\n            }\n            if (currentRatio <= 0.1) {\n                currentRatio = 0.1;\n            }    // Store.zoomRatio = currentRatio;\n            // Store.zoomRatio = currentRatio;\n            Store.changeZoom(currentRatio);\n            zoomNumberDomBind(currentRatio);\n        });\n        $('#luckysheet-zoom-plus').click(function () {\n            let currentRatio;\n            if (Store.zoomRatio == null) {\n                currentRatio = Store.zoomRatio = 1;\n            } else {\n                currentRatio = Math.floor(Store.zoomRatio * 10) / 10;\n            }\n            currentRatio = currentRatio + 0.1;\n            if (currentRatio == Store.zoomRatio) {\n                currentRatio = currentRatio + 0.1;\n            }\n            if (currentRatio >= 4) {\n                currentRatio = 4;\n            }    // Store.zoomRatio = currentRatio;\n            // Store.zoomRatio = currentRatio;\n            zoomChange(currentRatio);\n            zoomNumberDomBind(currentRatio);\n        });\n        $('#luckysheet-zoom-slider').mousedown(function (e) {\n            let xoffset = $(this).offset().left, pageX = e.pageX;\n            let currentRatio = positionToRatio(pageX - xoffset);    // Store.zoomRatio = currentRatio;\n            // Store.zoomRatio = currentRatio;\n            Store.changeZoom(currentRatio);\n            zoomNumberDomBind(currentRatio);\n        });\n        $('#luckysheet-zoom-cursor').mousedown(function (e) {\n            let curentX = e.pageX, cursorLeft = parseFloat($('#luckysheet-zoom-cursor').css('left'));\n            $('#luckysheet-zoom-cursor').css('transition', 'none');\n            $(document).off('mousemove.zoomCursor').on('mousemove.zoomCursor', function (event) {\n                let moveX = event.pageX;\n                let offsetX = moveX - curentX;    // console.log(moveX, curentX, offsetX);\n                                                  // curentX = moveX;\n                                                  // let left = parseFloat($(\"#luckysheet-zoom-cursor\").css(\"left\"));\n                // console.log(moveX, curentX, offsetX);\n                // curentX = moveX;\n                // let left = parseFloat($(\"#luckysheet-zoom-cursor\").css(\"left\"));\n                let pos = cursorLeft + offsetX;\n                let currentRatio = positionToRatio(pos);\n                if (currentRatio > 4) {\n                    currentRatio = 4;\n                    pos = 100;\n                }\n                if (currentRatio < 0.1) {\n                    currentRatio = 0.1;\n                    pos = 0;\n                }    // Store.zoomRatio = currentRatio;\n                // Store.zoomRatio = currentRatio;\n                Store.changeZoom(currentRatio);\n                let r = Math.round(currentRatio * 100) + '%';\n                $('#luckysheet-zoom-ratioText').html(r);\n                $('#luckysheet-zoom-cursor').css('left', pos - 4);\n            });\n            $(document).off('mouseup.zoomCursor').on('mouseup.zoomCursor', function (event) {\n                $(document).off('.zoomCursor');\n                $('#luckysheet-zoom-cursor').css('transition', 'all 0.3s');\n            });\n            e.stopPropagation();\n        }).click(function (e) {\n            e.stopPropagation();\n        });\n        $('#luckysheet-zoom-ratioText').click(function () {\n            // Store.zoomRatio = 1;\n            Store.changeZoom(1);\n            zoomNumberDomBind(1);\n        });\n        zoomNumberDomBind(Store.zoomRatio);\n    }\n    function zoomSlierDown() {\n    }\n    function positionToRatio(pos) {\n        let ratio = 1;\n        if (pos < 50) {\n            ratio = Math.round((pos * 1.8 / 100 + 0.1) * 100) / 100;\n        } else if (pos > 50) {\n            ratio = Math.round(((pos - 50) * 6 / 100 + 1) * 100) / 100;\n        }\n        return ratio;\n    }\n    function zoomSlierDomBind(ratio) {\n        let domPos = 50;\n        if (ratio < 1) {\n            domPos = Math.round((ratio - 0.1) * 100 / 0.18) / 10;\n        } else if (ratio > 1) {\n            domPos = Math.round((ratio - 1) * 100 / 0.6) / 10 + 50;\n        }\n        $('#luckysheet-zoom-cursor').css('left', domPos - 4);\n    }\n    function zoomNumberDomBind(ratio) {\n        let r = Math.round(ratio * 100) + '%';\n        $('#luckysheet-zoom-ratioText').html(r);\n        zoomSlierDomBind(ratio);\n    }\n    return {\n        zoomInitial: zoomInitial,\n        zoomNumberDomBind: zoomNumberDomBind\n    };\n});"]}