{"version":3,"sources":["utils/util.js"],"names":["define","m_constant","menuButton","m_datecontroll","m_validate","Store","locale","numeral","columeHeader_word","columeHeader_word_index","luckysheetdefaultFont","isdatatype","isdatatypemulti","hasChinaword","isRealNum","getObjType","obj","[object Boolean]","[object Number]","[object String]","[object Function]","[object Array]","[object Date]","[object RegExp]","[object Undefined]","[object Null]","[object Object]","Object","prototype","toString","call","createABCdim","x","count","chwl","length","ret","c","i","b","n","bq","push","index","bb","w","aa","bqa","key","value","callback","isJsonString","str","JSON","parse","e","common_extend","jsonbject1","jsonbject2","resultJsonObject","attr","undefined","replaceHtml","temp","dataarry","replace","s1","s2","s","getNowDateTime","format","now","Date","year","getFullYear","month","getMonth","date","getDate","hour","getDay","getHours","minu","getMinutes","sec","getSeconds","time","hexToRgb","hex","color","rgb","tmp","charAt","join","substr","parseInt","Number","rgbTohex","indexOf","split","slice","ABCatNum","a","NaN","toLowerCase","al","numout","charCodeAt","Math","pow","chatatABC","orda","len","String","fromCharCode","floor","toUpperCase","ceateABC","wordlen","relist","concat","getByteLen","val","subLen","match","substring","ArrayUnique","dataArr","result","item","luckysheetfontformat","fontarray","font","it","bl","fs","ceil","defaultFontSize","ff","fontfamily","fontjson","document","fonts","check","addFontTolist","showrightclickmenu","$menu","y","winH","$","window","height","winW","width","menuW","menuH","top","left","css","show","luckysheetactiveCell","fullscreenmode","setTimeout","focus","select","numFormat","num","type","isNaN","parseFloat","Infinity","floatlen","ismustfloat","numfloatlen","lens","mouseclickposition","p","bottom","$$","selector","context","elements","querySelectorAll","Array","seriesLoadScripts","scripts","options","HEAD","getElementsByTagName","documentElement","last","recursiveLoad","createElement","setAttribute","onload","onreadystatechange","this","parentNode","removeChild","appendChild","parallelLoadScripts","loaded","loadLinks","urls","forEach","url","doc","link","heads","loadLink","luckysheetContainerFocus","container","transformRangeToAbsolute","txt1","txtArray","txtSplit","sheetName","rangeTxt","rangeTxtArray","rangeRet","t","row","col","rangeTT","openSelfModel","id","isshowMask","$t","find","end","myh","outerHeight","myw","outerWidth","winw","winh","scrollLeft","scrollTop","createProxy","data","k","hasOwnProperty","Proxy","set","target","property","receiver","Reflect","defineProperty","enumerable","configurable","get","newValue","console","log","defineBasicReactive","info","arrayRemoveItem","array","some","curr","arr","splice"],"mappings":"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","file":"../../utils/util.js","sourcesContent":["define([\n    '../controllers/constant',\n    '../controllers/menuButton',\n    '../global/datecontroll',\n    '../global/validate',\n    '../store',\n    '../locale/locale',\n    '../vendors/numeral'\n], function (m_constant, menuButton, m_datecontroll, m_validate, Store, locale, numeral) {\n    'use strict';\n    const {columeHeader_word, columeHeader_word_index, luckysheetdefaultFont} = m_constant;\n    const {isdatatype, isdatatypemulti} = m_datecontroll;\n    const {hasChinaword, isRealNum} = m_validate;\n    // import method from '../global/method';\n    /**\n * Common tool methods\n */\n    /**\n * Determine whether a string is in standard JSON format\n * @param {String} str \n */\n    function isJsonString(str) {\n        try {\n            if (typeof JSON.parse(str) == 'object') {\n                return true;\n            }\n        } catch (e) {\n        }\n        return false;\n    }    /**\n * extend two objects\n * @param {Object } jsonbject1\n * @param {Object } jsonbject2 \n */\n    /**\n * extend two objects\n * @param {Object } jsonbject1\n * @param {Object } jsonbject2 \n */\n    function common_extend(jsonbject1, jsonbject2) {\n        let resultJsonObject = {};\n        for (let attr in jsonbject1) {\n            resultJsonObject[attr] = jsonbject1[attr];\n        }\n        for (let attr in jsonbject2) {\n            // undefined is equivalent to no setting\n            if (jsonbject2[attr] == undefined) {\n                continue;\n            }\n            resultJsonObject[attr] = jsonbject2[attr];\n        }\n        return resultJsonObject;\n    }\n    ;    // 替换temp中的${xxx}为指定内容 ,temp:字符串，这里指html代码，dataarry：一个对象{\"xxx\":\"替换的内容\"}\n         // 例：luckysheet.replaceHtml(\"${image}\",{\"image\":\"abc\",\"jskdjslf\":\"abc\"})   ==>  abc\n    // 替换temp中的${xxx}为指定内容 ,temp:字符串，这里指html代码，dataarry：一个对象{\"xxx\":\"替换的内容\"}\n    // 例：luckysheet.replaceHtml(\"${image}\",{\"image\":\"abc\",\"jskdjslf\":\"abc\"})   ==>  abc\n    function replaceHtml(temp, dataarry) {\n        return temp.replace(/\\$\\{([\\w]+)\\}/g, function (s1, s2) {\n            let s = dataarry[s2];\n            if (typeof s != 'undefined') {\n                return s;\n            } else {\n                return s1;\n            }\n        });\n    }\n    ;    //获取数据类型\n    //获取数据类型\n    function getObjType(obj) {\n        let toString = Object.prototype.toString;\n        let map = {\n            '[object Boolean]': 'boolean',\n            '[object Number]': 'number',\n            '[object String]': 'string',\n            '[object Function]': 'function',\n            '[object Array]': 'array',\n            '[object Date]': 'date',\n            '[object RegExp]': 'regExp',\n            '[object Undefined]': 'undefined',\n            '[object Null]': 'null',\n            '[object Object]': 'object'\n        };    // if(obj instanceof Element){\n              //     return 'element';\n              // }\n        // if(obj instanceof Element){\n        //     return 'element';\n        // }\n        return map[toString.call(obj)];\n    }    //获取当前日期时间\n    //获取当前日期时间\n    function getNowDateTime(format) {\n        let now = new Date();\n        let year = now.getFullYear();    //得到年份\n        //得到年份\n        let month = now.getMonth();    //得到月份\n        //得到月份\n        let date = now.getDate();    //得到日期\n        //得到日期\n        let day = now.getDay();    //得到周几\n        //得到周几\n        let hour = now.getHours();    //得到小时\n        //得到小时\n        let minu = now.getMinutes();    //得到分钟\n        //得到分钟\n        let sec = now.getSeconds();    //得到秒\n        //得到秒\n        month = month + 1;\n        if (month < 10)\n            month = '0' + month;\n        if (date < 10)\n            date = '0' + date;\n        if (hour < 10)\n            hour = '0' + hour;\n        if (minu < 10)\n            minu = '0' + minu;\n        if (sec < 10)\n            sec = '0' + sec;\n        let time = '';    //日期\n        //日期\n        if (format == 1) {\n            time = year + '-' + month + '-' + date;\n        }    //日期时间\n        else //日期时间\n        if (format == 2) {\n            time = year + '-' + month + '-' + date + ' ' + hour + ':' + minu + ':' + sec;\n        }\n        return time;\n    }    //颜色 16进制转rgb\n    //颜色 16进制转rgb\n    function hexToRgb(hex) {\n        let color = [], rgb = [];\n        hex = hex.replace(/#/, '');\n        if (hex.length == 3) {\n            // 处理 \"#abc\" 成 \"#aabbcc\"\n            let tmp = [];\n            for (let i = 0; i < 3; i++) {\n                tmp.push(hex.charAt(i) + hex.charAt(i));\n            }\n            hex = tmp.join('');\n        }\n        for (let i = 0; i < 3; i++) {\n            color[i] = '0x' + hex.substr(i + 2, 2);\n            rgb.push(parseInt(Number(color[i])));\n        }\n        return 'rgb(' + rgb.join(',') + ')';\n    }\n    ;    //颜色 rgb转16进制\n    //颜色 rgb转16进制\n    function rgbTohex(color) {\n        let rgb;\n        if (color.indexOf('rgba') > -1) {\n            rgb = color.replace('rgba(', '').replace(')', '').split(',');\n        } else {\n            rgb = color.replace('rgb(', '').replace(')', '').split(',');\n        }\n        let r = parseInt(rgb[0]);\n        let g = parseInt(rgb[1]);\n        let b = parseInt(rgb[2]);\n        let hex = '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\n        return hex;\n    }\n    ;    //列下标  字母转数字\n    //列下标  字母转数字\n    function ABCatNum(a) {\n        // abc = abc.toUpperCase();\n        // let abc_len = abc.length;\n        // if (abc_len == 0) {\n        //     return NaN;\n        // }\n        // let abc_array = abc.split(\"\");\n        // let wordlen = columeHeader_word.length;\n        // let ret = 0;\n        // for (let i = abc_len - 1; i >= 0; i--) {\n        //     if (i == abc_len - 1) {\n        //         ret += columeHeader_word_index[abc_array[i]];\n        //     }\n        //     else {\n        //         ret += Math.pow(wordlen, abc_len - i - 1) * (columeHeader_word_index[abc_array[i]] + 1);\n        //     }\n        // }\n        // return ret;\n        if (a == null || a.length == 0) {\n            return NaN;\n        }\n        var str = a.toLowerCase().split('');\n        var num = 0;\n        var al = str.length;\n        var getCharNumber = function (charx) {\n            return charx.charCodeAt() - 96;\n        };\n        var numout = 0;\n        var charnum = 0;\n        for (var i = 0; i < al; i++) {\n            charnum = getCharNumber(str[i]);\n            numout += charnum * Math.pow(26, al - i - 1);\n        }\n        ;    // console.log(a, numout-1);\n        // console.log(a, numout-1);\n        if (numout == 0) {\n            return NaN;\n        }\n        return numout - 1;\n    }\n    ;    //列下标  数字转字母\n    //列下标  数字转字母\n    function chatatABC(n) {\n        // let wordlen = columeHeader_word.length;\n        // if (index < wordlen) {\n        //     return columeHeader_word[index];\n        // }\n        // else {\n        //     let last = 0, pre = 0, ret = \"\";\n        //     let i = 1, n = 0;\n        //     while (index >= (wordlen / (wordlen - 1)) * (Math.pow(wordlen, i++) - 1)) {\n        //         n = i;\n        //     }\n        //     let index_ab = index - (wordlen / (wordlen - 1)) * (Math.pow(wordlen, n - 1) - 1);//970\n        //     last = index_ab + 1;\n        //     for (let x = n; x > 0; x--) {\n        //         let last1 = last, x1 = x;//-702=268, 3\n        //         if (x == 1) {\n        //             last1 = last1 % wordlen;\n        //             if (last1 == 0) {\n        //                 last1 = 26;\n        //             }\n        //             return ret + columeHeader_word[last1 - 1];\n        //         }\n        //         last1 = Math.ceil(last1 / Math.pow(wordlen, x - 1));\n        //         //last1 = last1 % wordlen;\n        //         ret += columeHeader_word[last1 - 1];\n        //         if (x > 1) {\n        //             last = last - (last1 - 1) * wordlen;\n        //         }\n        //     }\n        // }\n        var orda = 'a'.charCodeAt(0);\n        var ordz = 'z'.charCodeAt(0);\n        var len = ordz - orda + 1;\n        var s = '';\n        while (n >= 0) {\n            s = String.fromCharCode(n % len + orda) + s;\n            n = Math.floor(n / len) - 1;\n        }\n        return s.toUpperCase();\n    }\n    ;\n    function ceateABC(index) {\n        let wordlen = columeHeader_word.length;\n        if (index < wordlen) {\n            return columeHeader_word;\n        } else {\n            let relist = [];\n            let i = 2, n = 0;\n            while (index < wordlen / (wordlen - 1) * (Math.pow(wordlen, i) - 1)) {\n                n = i;\n                i++;\n            }\n            for (let x = 0; x < n; x++) {\n                if (x == 0) {\n                    relist = relist.concat(columeHeader_word);\n                } else {\n                    relist = relist.concat(createABCdim(x), index);\n                }\n            }\n        }\n    }\n    ;\n    function createABCdim(x, count) {\n        let chwl = columeHeader_word.length;\n        if (x == 1) {\n            let ret = [];\n            let c = 0, con = true;\n            for (let i = 0; i < chwl; i++) {\n                let b = columeHeader_word[i];\n                for (let n = 0; n < chwl; n++) {\n                    let bq = b + columeHeader_word[n];\n                    ret.push(bq);\n                    c++;\n                    if (c > index) {\n                        return ret;\n                    }\n                }\n            }\n        } else if (x == 2) {\n            let ret = [];\n            let c = 0, con = true;\n            for (let i = 0; i < chwl; i++) {\n                let bb = columeHeader_word[i];\n                for (let w = 0; w < chwl; w++) {\n                    let aa = columeHeader_word[w];\n                    for (let n = 0; n < chwl; n++) {\n                        let bqa = bb + aa + columeHeader_word[n];\n                        ret.push(bqa);\n                        c++;\n                        if (c > index) {\n                            return ret;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    ;    /**\n * 计算字符串字节长度\n * @param {*} val 字符串\n * @param {*} subLen 要截取的字符串长度\n */\n    /**\n * 计算字符串字节长度\n * @param {*} val 字符串\n * @param {*} subLen 要截取的字符串长度\n */\n    function getByteLen(val, subLen) {\n        if (subLen === 0) {\n            return '';\n        }\n        if (val == null) {\n            return 0;\n        }\n        let len = 0;\n        for (let i = 0; i < val.length; i++) {\n            let a = val.charAt(i);\n            if (a.match(/[^\\x00-\\xff]/ig) != null) {\n                len += 2;\n            } else {\n                len += 1;\n            }\n            if (isRealNum(subLen) && len === ~~subLen) {\n                return val.substring(0, i);\n            }\n        }\n        return len;\n    }\n    ;    //数组去重\n    //数组去重\n    function ArrayUnique(dataArr) {\n        let result = [];\n        let obj = {};\n        if (dataArr.length > 0) {\n            for (let i = 0; i < dataArr.length; i++) {\n                let item = dataArr[i];\n                if (!obj[item]) {\n                    result.push(item);\n                    obj[item] = 1;\n                }\n            }\n        }\n        return result;\n    }    //获取字体配置\n    //获取字体配置\n    function luckysheetfontformat(format) {\n        let fontarray = locale().fontarray;\n        if (getObjType(format) == 'object') {\n            let font = '';    //font-style\n            //font-style\n            if (format.it == '0' || format.it == null) {\n                font += 'normal ';\n            } else {\n                font += 'italic ';\n            }    //font-variant\n            //font-variant\n            font += 'normal ';    //font-weight\n            //font-weight\n            if (format.bl == '0' || format.bl == null) {\n                font += 'normal ';\n            } else {\n                font += 'bold ';\n            }    //font-size/line-height\n            //font-size/line-height\n            if (!format.fs) {\n                font += Store.defaultFontSize + 'pt ';\n            } else {\n                font += Math.ceil(format.fs) + 'pt ';\n            }\n            if (!format.ff) {\n                font += fontarray[0] + ', \"Helvetica Neue\", Helvetica, Arial, \"PingFang SC\", \"Hiragino Sans GB\", \"Heiti SC\", \"Microsoft YaHei\", \"WenQuanYi Micro Hei\", sans-serif';\n            } else {\n                let fontfamily = null;\n                let fontjson = locale().fontjson;\n                if (isdatatypemulti(format.ff)['num']) {\n                    fontfamily = fontarray[parseInt(format.ff)];\n                } else {\n                    // fontfamily = fontarray[fontjson[format.ff]];\n                    fontfamily = format.ff;\n                    fontfamily = fontfamily.replace(/\"/g, '').replace(/'/g, '');\n                    if (fontfamily.indexOf(' ') > -1) {\n                        fontfamily = '\"' + fontfamily + '\"';\n                    }\n                    if (fontfamily != null && document.fonts && !document.fonts.check('12px ' + fontfamily)) {\n                        menuButton.addFontTolist(fontfamily);\n                    }\n                }\n                if (fontfamily == null) {\n                    fontfamily = fontarray[0];\n                }\n                font += fontfamily + ', \"Helvetica Neue\", Helvetica, Arial, \"PingFang SC\", \"Hiragino Sans GB\", \"Heiti SC\", \"Microsoft YaHei\", \"WenQuanYi Micro Hei\", sans-serif';\n            }\n            return font;\n        } else {\n            return luckysheetdefaultFont();\n        }\n    }    //右键菜单\n    //右键菜单\n    function showrightclickmenu($menu, x, y) {\n        let winH = $(window).height(), winW = $(window).width();\n        let menuW = $menu.width(), menuH = $menu.height();\n        let top = y, left = x;\n        if (x + menuW > winW) {\n            left = x - menuW;\n        }\n        if (y + menuH > winH) {\n            top = y - menuH;\n        }\n        if (top < 0) {\n            top = 0;\n        }\n        $menu.css({\n            'top': top,\n            'left': left\n        }).show();\n    }    //单元格编辑聚焦\n    //单元格编辑聚焦\n    function luckysheetactiveCell() {\n        if (!!Store.fullscreenmode) {\n            setTimeout(function () {\n                $('#luckysheet-rich-text-editor').focus().select();\n            }, 50);\n        }\n    }    //单元格编辑聚焦\n    //单元格编辑聚焦\n    function luckysheetContainerFocus() {\n        // $(\"#\" + Store.container).focus({ \n        //     preventScroll: true \n        // });\n        // fix jquery error: Uncaught TypeError: ((n.event.special[g.origType] || {}).handle || g.handler).apply is not a function\n        $('#' + Store.container).attr('tabindex', 0).focus();\n    }    //数字格式\n    //数字格式\n    function numFormat(num, type) {\n        if (num == null || isNaN(parseFloat(num)) || hasChinaword(num) || num == -Infinity || num == Infinity) {\n            return null;\n        }\n        let floatlen = 6, ismustfloat = false;\n        if (type == null || type == 'auto') {\n            if (num < 1) {\n                floatlen = 6;\n            } else {\n                floatlen = 1;\n            }\n        } else {\n            if (isdatatype(type) == 'num') {\n                floatlen = parseInt(type);\n                ismustfloat = true;\n            } else {\n                floatlen = 6;\n            }\n        }\n        let format = '', value = null;\n        for (let i = 0; i < floatlen; i++) {\n            format += '0';\n        }\n        if (!ismustfloat) {\n            format = '[' + format + ']';\n        }\n        if (num >= 1e+21) {\n            value = parseFloat(numeral(num).value());\n        } else {\n            value = parseFloat(numeral(num).format('0.' + format));\n        }\n        return value;\n    }\n    function numfloatlen(n) {\n        if (n != null && !isNaN(parseFloat(n)) && !hasChinaword(n)) {\n            let value = numeral(n).value();\n            let lens = value.toString().split('.');\n            if (lens.length == 1) {\n                lens = 0;\n            } else {\n                lens = lens[1].length;\n            }\n            return lens;\n        } else {\n            return null;\n        }\n    }    //二级菜单显示位置\n    //二级菜单显示位置\n    function mouseclickposition($menu, x, y, p) {\n        let winH = $(window).height(), winW = $(window).width();\n        let menuW = $menu.width(), menuH = $menu.height();\n        let top = y, left = x;\n        if (p == null) {\n            p = 'lefttop';\n        }\n        if (p == 'lefttop') {\n            $menu.css({\n                'top': y,\n                'left': x\n            }).show();\n        } else if (p == 'righttop') {\n            $menu.css({\n                'top': y,\n                'left': x - menuW\n            }).show();\n        } else if (p == 'leftbottom') {\n            $menu.css({\n                'bottom': winH - y - 12,\n                'left': x\n            }).show();\n        } else if (p == 'rightbottom') {\n            $menu.css({\n                'bottom': winH - y - 12,\n                'left': x - menuW\n            }).show();\n        }\n    }    /**\n * 元素选择器\n * @param {String}  selector css选择器\n * @param {String}  context  指定父级DOM\n */\n    /**\n * 元素选择器\n * @param {String}  selector css选择器\n * @param {String}  context  指定父级DOM\n */\n    function $$(selector, context) {\n        context = context || document;\n        var elements = context.querySelectorAll(selector);\n        return elements.length == 1 ? Array.prototype.slice.call(elements)[0] : Array.prototype.slice.call(elements);\n    }    /** \n * 串行加载指定的脚本\n * 串行加载[异步]逐个加载，每个加载完成后加载下一个\n * 全部加载完成后执行回调\n * @param {Array|String}  scripts 指定要加载的脚本\n * @param {Object} options 属性设置\n * @param {Function} callback 成功后回调的函数\n * @return {Array} 所有生成的脚本元素对象数组\n */\n    /** \n * 串行加载指定的脚本\n * 串行加载[异步]逐个加载，每个加载完成后加载下一个\n * 全部加载完成后执行回调\n * @param {Array|String}  scripts 指定要加载的脚本\n * @param {Object} options 属性设置\n * @param {Function} callback 成功后回调的函数\n * @return {Array} 所有生成的脚本元素对象数组\n */\n    function seriesLoadScripts(scripts, options, callback) {\n        if (typeof scripts !== 'object') {\n            var scripts = [scripts];\n        }\n        var HEAD = document.getElementsByTagName('head')[0] || document.documentElement;\n        var s = [];\n        var last = scripts.length - 1;    //递归\n        //递归\n        var recursiveLoad = function (i) {\n            s[i] = document.createElement('script');\n            s[i].setAttribute('type', 'text/javascript');    // Attach handlers for all browsers\n                                                             // 异步\n            // Attach handlers for all browsers\n            // 异步\n            s[i].onload = s[i].onreadystatechange = function () {\n                if (!/*@cc_on!@*/\n                    0 || this.readyState === 'loaded' || this.readyState === 'complete') {\n                    this.onload = this.onreadystatechange = null;\n                    this.parentNode.removeChild(this);\n                    if (i !== last) {\n                        recursiveLoad(i + 1);\n                    } else if (typeof callback === 'function') {\n                        callback();\n                    }\n                    ;\n                }\n            };    // 同步\n            // 同步\n            s[i].setAttribute('src', scripts[i]);    // 设置属性\n            // 设置属性\n            if (typeof options === 'object') {\n                for (var attr in options) {\n                    s[i].setAttribute(attr, options[attr]);\n                }\n            }\n            HEAD.appendChild(s[i]);\n        };\n        recursiveLoad(0);\n    }    /**\n * 并行加载指定的脚本\n * 并行加载[同步]同时加载，不管上个是否加载完成，直接加载全部\n * 全部加载完成后执行回调\n * @param {Array|String}  scripts 指定要加载的脚本\n * @param {Object} options 属性设置\n * @param {Function} callback 成功后回调的函数\n * @return {Array} 所有生成的脚本元素对象数组\n */\n    /**\n * 并行加载指定的脚本\n * 并行加载[同步]同时加载，不管上个是否加载完成，直接加载全部\n * 全部加载完成后执行回调\n * @param {Array|String}  scripts 指定要加载的脚本\n * @param {Object} options 属性设置\n * @param {Function} callback 成功后回调的函数\n * @return {Array} 所有生成的脚本元素对象数组\n */\n    function parallelLoadScripts(scripts, options, callback) {\n        if (typeof scripts !== 'object') {\n            var scripts = [scripts];\n        }\n        var HEAD = document.getElementsByTagName('head')[0] || document.documentElement;\n        var s = [];\n        var loaded = 0;\n        for (var i = 0; i < scripts.length; i++) {\n            s[i] = document.createElement('script');\n            s[i].setAttribute('type', 'text/javascript');    // Attach handlers for all browsers\n                                                             // 异步\n            // Attach handlers for all browsers\n            // 异步\n            s[i].onload = s[i].onreadystatechange = function () {\n                if (!/*@cc_on!@*/\n                    0 || this.readyState === 'loaded' || this.readyState === 'complete') {\n                    loaded++;\n                    this.onload = this.onreadystatechange = null;\n                    this.parentNode.removeChild(this);\n                    if (loaded === scripts.length && typeof callback === 'function')\n                        callback();\n                }\n            };    // 同步\n            // 同步\n            s[i].setAttribute('src', scripts[i]);    // 设置属性\n            // 设置属性\n            if (typeof options === 'object') {\n                for (var attr in options) {\n                    s[i].setAttribute(attr, options[attr]);\n                }\n            }\n            HEAD.appendChild(s[i]);\n        }\n    }    /**\n* 动态添加css\n* @param {String}  url 指定要加载的css地址\n*/\n    /**\n* 动态添加css\n* @param {String}  url 指定要加载的css地址\n*/\n    function loadLink(url) {\n        var doc = document;\n        var link = doc.createElement('link');\n        link.setAttribute('rel', 'stylesheet');\n        link.setAttribute('type', 'text/css');\n        link.setAttribute('href', url);\n        var heads = doc.getElementsByTagName('head');\n        if (heads.length) {\n            heads[0].appendChild(link);\n        } else {\n            doc.documentElement.appendChild(link);\n        }\n    }    /**\n* 动态添加一组css\n* @param {String}  url 指定要加载的css地址\n*/\n    /**\n* 动态添加一组css\n* @param {String}  url 指定要加载的css地址\n*/\n    function loadLinks(urls) {\n        if (typeof urls !== 'object') {\n            urls = [urls];\n        }\n        if (urls.length) {\n            urls.forEach(url => {\n                loadLink(url);\n            });\n        }\n    }\n    function transformRangeToAbsolute(txt1) {\n        if (txt1 == null || txt1.length == 0) {\n            return null;\n        }\n        let txtArray = txt1.split(',');\n        let ret = '';\n        for (let i = 0; i < txtArray.length; i++) {\n            let txt = txtArray[i];\n            let txtSplit = txt.split('!'), sheetName = '', rangeTxt = '';\n            if (txtSplit.length > 1) {\n                sheetName = txtSplit[0];\n                rangeTxt = txtSplit[1];\n            } else {\n                rangeTxt = txtSplit[0];\n            }\n            let rangeTxtArray = rangeTxt.split(':');\n            let rangeRet = '';\n            for (let a = 0; a < rangeTxtArray.length; a++) {\n                let t = rangeTxtArray[a];\n                let row = t.replace(/[^0-9]/g, '');\n                let col = t.replace(/[^A-Za-z]/g, '');\n                let rangeTT = '';\n                if (col != '') {\n                    rangeTT += '$' + col;\n                }\n                if (row != '') {\n                    rangeTT += '$' + row;\n                }\n                rangeRet += rangeTT + ':';\n            }\n            rangeRet = rangeRet.substr(0, rangeRet.length - 1);\n            ret += sheetName + rangeRet + ',';\n        }\n        return ret.substr(0, ret.length - 1);\n    }\n    function openSelfModel(id, isshowMask = true) {\n        let $t = $('#' + id).find('.luckysheet-modal-dialog-content').css('min-width', 300).end(), myh = $t.outerHeight(), myw = $t.outerWidth();\n        let winw = $(window).width(), winh = $(window).height();\n        let scrollLeft = $(document).scrollLeft(), scrollTop = $(document).scrollTop();\n        $t.css({\n            'left': (winw + scrollLeft - myw) / 2,\n            'top': (winh + scrollTop - myh) / 3\n        }).show();\n        if (isshowMask) {\n            $('#luckysheet-modal-dialog-mask').show();\n        }\n    }    /**\n * 监控对象变更\n * @param {*} data \n */\n         // const createProxy = (data,list=[]) => {\n         //     if (typeof data === 'object' && data.toString() === '[object Object]') {\n         //       for (let k in data) {\n         //         if(list.includes(k)){\n         //             if (typeof data[k] === 'object') {\n         //               defineObjectReactive(data, k, data[k])\n         //             } else {\n         //               defineBasicReactive(data, k, data[k])\n         //             }\n         //         }\n         //       }\n         //     }\n         // }\n    /**\n * 监控对象变更\n * @param {*} data \n */\n    // const createProxy = (data,list=[]) => {\n    //     if (typeof data === 'object' && data.toString() === '[object Object]') {\n    //       for (let k in data) {\n    //         if(list.includes(k)){\n    //             if (typeof data[k] === 'object') {\n    //               defineObjectReactive(data, k, data[k])\n    //             } else {\n    //               defineBasicReactive(data, k, data[k])\n    //             }\n    //         }\n    //       }\n    //     }\n    // }\n    const createProxy = (data, k, callback) => {\n        if (!data.hasOwnProperty(k)) {\n            console.info('No %s in data', k);\n            return;\n        }\n        ;\n        if (getObjType(data) === 'object') {\n            if (getObjType(data[k]) === 'object' || getObjType(data[k]) === 'array') {\n                defineObjectReactive(data, k, data[k], callback);\n            } else {\n                defineBasicReactive(data, k, data[k], callback);\n            }\n        }\n    };\n    function defineObjectReactive(obj, key, value, callback) {\n        // 递归\n        obj[key] = new Proxy(value, {\n            set(target, property, val, receiver) {\n                setTimeout(() => {\n                    callback(target, property, val, receiver);\n                }, 0);\n                return Reflect.set(target, property, val, receiver);\n            }\n        });\n    }\n    function defineBasicReactive(obj, key, value, callback) {\n        Object.defineProperty(obj, key, {\n            enumerable: true,\n            configurable: false,\n            get() {\n                return value;\n            },\n            set(newValue) {\n                if (value === newValue)\n                    return;\n                console.log(`发现 ${ key } 属性 ${ value } -> ${ newValue }`);\n                setTimeout(() => {\n                    callback(value, newValue);\n                }, 0);\n                value = newValue;\n            }\n        });\n    }    /**\n * Remove an item in the specified array\n * @param {array} array Target array \n * @param {string} item What needs to be removed\n */\n    /**\n * Remove an item in the specified array\n * @param {array} array Target array \n * @param {string} item What needs to be removed\n */\n    function arrayRemoveItem(array, item) {\n        array.some((curr, index, arr) => {\n            if (curr === item) {\n                arr.splice(index, 1);\n                return curr === item;\n            }\n        });\n    }\n    return {\n        isJsonString,\n        common_extend,\n        replaceHtml,\n        getObjType,\n        getNowDateTime,\n        hexToRgb,\n        rgbTohex,\n        ABCatNum,\n        chatatABC,\n        ceateABC,\n        createABCdim,\n        getByteLen,\n        ArrayUnique,\n        luckysheetfontformat,\n        showrightclickmenu,\n        luckysheetactiveCell,\n        numFormat,\n        numfloatlen,\n        mouseclickposition,\n        $$,\n        seriesLoadScripts,\n        parallelLoadScripts,\n        loadLinks,\n        luckysheetContainerFocus,\n        transformRangeToAbsolute,\n        openSelfModel,\n        createProxy,\n        arrayRemoveItem\n    };\n});"]}