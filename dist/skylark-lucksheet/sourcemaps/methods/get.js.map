{"version":3,"sources":["methods/get.js"],"names":["define","m_util","Store","chatatABC","getSheetIndex","index","i","luckysheetfile","length","getRangetxt","sheetIndex","range","currentIndex","sheettxt","currentSheetIndex","name","replace","test","row0","row1","column0","column1","getluckysheet_select_save","luckysheet_select_save","getluckysheet_scroll_status","luckysheet_scroll_status","getluckysheetfile","plugin","forEach","file","chart","chartObj","chartJson","getChartJson","chart_id","chartOptions","getconfig","config","getvisibledatarow","visibledatarow","getvisibledatacolumn","visibledatacolumn"],"mappings":";;;;;;;AAAAA,QACI,gBACA,YACD,SAAUC,EAAQC,GACjB,aACA,MAAMC,UAACA,GAAaF,EACpB,SAASG,EAAcC,GACnB,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAMK,eAAeC,OAAQF,IAC7C,GAAIJ,EAAMK,eAAeD,GAAU,OAAKD,EACpC,OAAOC,EAGf,OAAO,KA4DX,OACIF,cAAAA,EACAK,YA5DJ,SAAqBC,EAAYC,EAAOC,GACpC,IAAIC,EAAW,GACK,MAAhBD,IACAA,EAAeV,EAAMY,mBAErBJ,GAAcE,IAEdC,EAAWX,EAAMK,eAAeH,EAAcM,IAAaK,KAAKC,QAAQ,KAAM,MAE1E,8VAA8VC,KAAKJ,GACnWA,GAAsB,IAEtBA,EAAW,IAAMA,EAAW,MAGpC,IAAIK,EAAOP,EAAW,IAAE,GAAIQ,EAAOR,EAAW,IAAE,GAC5CS,EAAUT,EAAc,OAAE,GAAIU,EAAUV,EAAc,OAAE,GAC5D,OAAY,MAARO,GAAwB,MAARC,EACTN,EAAWV,EAAUiB,GAAW,IAAMjB,EAAUkB,GACrC,MAAXD,GAA8B,MAAXC,EACnBR,GAAYK,EAAO,GAAK,KAAOC,EAAO,GAEzCC,GAAWC,GAAWH,GAAQC,EACvBN,EAAWV,EAAUiB,IAAYF,EAAO,GAExCL,EAAWV,EAAUiB,IAAYF,EAAO,GAAK,IAAMf,EAAUkB,IAAYF,EAAO,IAoC/FG,0BAhCJ,WACI,OAAOpB,EAAMqB,wBAgCbC,4BA9BJ,WACI,OAAOtB,EAAMuB,0BA8BbC,kBA5BJ,SAA2BC,GAYvB,OAVIA,GACAzB,EAAMK,eAAeqB,QAAQC,IACnBA,EAAKC,OACPD,EAAKC,MAAMF,QAAQG,IACf,MAAMC,EAAY9B,EAAM+B,aAAaF,EAASG,UAC9CH,EAASI,aAAeH,MAKjC9B,EAAMK,gBAiBb6B,UAfJ,WACI,OAAOlC,EAAMmC,QAebC,kBAbJ,WACI,OAAOpC,EAAMqC,gBAabC,qBAXJ,WACI,OAAOtC,EAAMuC","file":"../../methods/get.js","sourcesContent":["define([\n    '../utils/util',\n    '../store'\n], function (m_util, Store) {\n    'use strict';\n    const {chatatABC} = m_util;\n    function getSheetIndex(index) {\n        for (let i = 0; i < Store.luckysheetfile.length; i++) {\n            if (Store.luckysheetfile[i]['index'] == index) {\n                return i;\n            }\n        }\n        return null;\n    }\n    function getRangetxt(sheetIndex, range, currentIndex) {\n        let sheettxt = '';\n        if (currentIndex == null) {\n            currentIndex = Store.currentSheetIndex;\n        }\n        if (sheetIndex != currentIndex) {\n            //sheet名字包含'的，引用时应该替换为''\n            sheettxt = Store.luckysheetfile[getSheetIndex(sheetIndex)].name.replace(/'/g, \"''\");    //如果包含除a-z、A-Z、0-9、下划线等以外的字符那么就用单引号包起来\n            //如果包含除a-z、A-Z、0-9、下划线等以外的字符那么就用单引号包起来\n            if (/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/.test(sheettxt)) {\n                sheettxt = sheettxt + '!';\n            } else {\n                sheettxt = \"'\" + sheettxt + \"'!\";\n            }\n        }\n        let row0 = range['row'][0], row1 = range['row'][1];\n        let column0 = range['column'][0], column1 = range['column'][1];\n        if (row0 == null && row1 == null) {\n            return sheettxt + chatatABC(column0) + ':' + chatatABC(column1);\n        } else if (column0 == null && column1 == null) {\n            return sheettxt + (row0 + 1) + ':' + (row1 + 1);\n        } else {\n            if (column0 == column1 && row0 == row1) {\n                return sheettxt + chatatABC(column0) + (row0 + 1);\n            } else {\n                return sheettxt + chatatABC(column0) + (row0 + 1) + ':' + chatatABC(column1) + (row1 + 1);\n            }\n        }\n    }\n    function getluckysheet_select_save() {\n        return Store.luckysheet_select_save;\n    }\n    function getluckysheet_scroll_status() {\n        return Store.luckysheet_scroll_status;\n    }\n    function getluckysheetfile(plugin) {\n        // 获取图表数据\n        if (plugin) {\n            Store.luckysheetfile.forEach(file => {\n                if (!!file.chart) {\n                    file.chart.forEach(chartObj => {\n                        const chartJson = Store.getChartJson(chartObj.chart_id);\n                        chartObj.chartOptions = chartJson;\n                    });\n                }\n            });\n        }\n        return Store.luckysheetfile;\n    }\n    function getconfig() {\n        return Store.config;\n    }\n    function getvisibledatarow() {\n        return Store.visibledatarow;\n    }\n    function getvisibledatacolumn() {\n        return Store.visibledatacolumn;\n    }\n    return {\n        getSheetIndex,\n        getRangetxt,\n        getluckysheet_select_save,\n        getluckysheet_scroll_status,\n        getluckysheetfile,\n        getconfig,\n        getvisibledatarow,\n        getvisibledatacolumn\n    };\n});"]}