{"version":3,"sources":["methods/validate.js"],"names":["define","m_util","Store","error","v","n","na","r","d","nm","nl","sp","isRealNull","isRealNum","hasChinaword","valueIsError","value","isError","x","hasPartMC","cfg","r1","r2","c1","c2","config","mc","rs","c","cs","checkWordByteLength","Math","ceil","charCodeAt","toString","length"],"mappings":"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","file":"../../methods/validate.js","sourcesContent":["define([\n    \"../utils/util\",\n    '../store'\n], function (m_util,Store) {\n    'use strict';\n    const error = {\n        v: '#VALUE!',\n        //错误的参数或运算符\n        n: '#NAME?',\n        //公式名称错误\n        na: '#N/A',\n        //函数或公式中没有可用数值\n        r: '#REF!',\n        //删除了由其他公式引用的单元格\n        d: '#DIV/0!',\n        //除数是0或空单元格\n        nm: '#NUM!',\n        //当公式或函数中某个数字有问题时\n        nl: '#NULL!',\n        //交叉运算符（空格）使用不正确\n        sp: '#SPILL!'    //数组范围有其它值\n    };\n    //数组范围有其它值\n    \n    const {isRealNull,isRealNum,hasChinaword} = m_util;\n\n    //是否是错误类型\n    function valueIsError(value) {\n        let isError = false;\n        for (let x in error) {\n            if (value == error[x]) {\n                isError = true;\n                break;\n            }\n        }\n        return isError;\n    }   \n\n    //范围是否只包含部分合并单元格\n    function hasPartMC(cfg, r1, r2, c1, c2) {\n        let hasPartMC = false;\n        for (let x in Store.config['merge']) {\n            let mc = cfg['merge'][x];\n            if (r1 < mc.r) {\n                if (r2 >= mc.r && r2 < mc.r + mc.rs - 1) {\n                    if (c1 >= mc.c && c1 <= mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c2 >= mc.c && c2 <= mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c1 < mc.c && c2 > mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    }\n                } else if (r2 >= mc.r && r2 == mc.r + mc.rs - 1) {\n                    if (c1 > mc.c && c1 < mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c2 > mc.c && c2 < mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c1 == mc.c && c2 < mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c1 > mc.c && c2 == mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    }\n                } else if (r2 > mc.r + mc.rs - 1) {\n                    if (c1 > mc.c && c1 <= mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c2 >= mc.c && c2 < mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c1 == mc.c && c2 < mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c1 > mc.c && c2 == mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    }\n                }\n            } else if (r1 == mc.r) {\n                if (r2 < mc.r + mc.rs - 1) {\n                    if (c1 >= mc.c && c1 <= mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c2 >= mc.c && c2 <= mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c1 < mc.c && c2 > mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    }\n                } else if (r2 >= mc.r + mc.rs - 1) {\n                    if (c1 > mc.c && c1 <= mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c2 >= mc.c && c2 < mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c1 == mc.c && c2 < mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    } else if (c1 > mc.c && c2 == mc.c + mc.cs - 1) {\n                        hasPartMC = true;\n                        break;\n                    }\n                }\n            } else if (r1 <= mc.r + mc.rs - 1) {\n                if (c1 >= mc.c && c1 <= mc.c + mc.cs - 1) {\n                    hasPartMC = true;\n                    break;\n                } else if (c2 >= mc.c && c2 <= mc.c + mc.cs - 1) {\n                    hasPartMC = true;\n                    break;\n                } else if (c1 < mc.c && c2 > mc.c + mc.cs - 1) {\n                    hasPartMC = true;\n                    break;\n                }\n            }\n        }\n        return hasPartMC;\n    }    //获取单个字符的字节数\n    //获取单个字符的字节数\n    function checkWordByteLength(value) {\n        return Math.ceil(value.charCodeAt().toString(2).length / 8);\n    }\n    return {\n        error: error,\n        isRealNull,\n        isRealNum,\n        valueIsError,\n        hasChinaword,\n        hasPartMC,\n        checkWordByteLength\n    };\n});"]}