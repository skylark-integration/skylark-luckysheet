/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define([],function(){function e(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]}const t={container:null,luckysheetfile:null,defaultcolumnNum:60,defaultrowNum:84,fullscreenmode:!0,devicePixelRatio:1,currentSheetIndex:0,calculateSheetIndex:0,flowdata:[],config:{},visibledatarow:[],visibledatacolumn:[],ch_width:0,rh_height:0,cellmainWidth:0,cellmainHeight:0,toolbarHeight:0,infobarHeight:0,calculatebarHeight:0,rowHeaderWidth:46,columnHeaderHeight:20,cellMainSrollBarSize:12,sheetBarHeight:31,statisticBarHeight:23,luckysheetTableContentHW:[0,0],defaultcollen:73,defaultrowlen:19,jfcountfuncTimeout:null,jfautoscrollTimeout:null,luckysheet_select_status:!1,luckysheet_select_save:[{row:[0,0],column:[0,0]}],luckysheet_selection_range:[],luckysheet_copy_save:{},luckysheet_paste_iscut:!1,filterchage:!0,luckysheet_filter_save:{row:[],column:[]},luckysheet_sheet_move_status:!1,luckysheet_sheet_move_data:[],luckysheet_scroll_status:!1,luckysheetisrefreshdetail:!0,luckysheetisrefreshtheme:!0,luckysheetcurrentisPivotTable:!1,luckysheet_rows_selected_status:!1,luckysheet_cols_selected_status:!1,luckysheet_rows_change_size:!1,luckysheet_rows_change_size_start:[],luckysheet_cols_change_size:!1,luckysheet_cols_change_size_start:[],luckysheet_cols_dbclick_timeout:null,luckysheet_cols_dbclick_times:0,luckysheetCellUpdate:[],luckysheet_shiftpositon:null,iscopyself:!0,orderbyindex:0,luckysheet_model_move_state:!1,luckysheet_model_xy:[0,0],luckysheet_model_move_obj:null,luckysheet_cell_selected_move:!1,luckysheet_cell_selected_move_index:[],luckysheet_cell_selected_extend:!1,luckysheet_cell_selected_extend_index:[],luckysheet_cell_selected_extend_time:null,clearjfundo:!0,jfundo:[],jfredo:[],lang:"en",createChart:"",highlightChart:"",zIndex:15,chartparam:{luckysheetCurrentChart:null,luckysheetCurrentChartActive:!1,luckysheetCurrentChartMove:null,luckysheetCurrentChartMoveTimeout:null,luckysheetCurrentChartMoveObj:null,luckysheetCurrentChartMoveXy:null,luckysheetCurrentChartMoveWinH:null,luckysheetCurrentChartMoveWinW:null,luckysheetCurrentChartResize:null,luckysheetCurrentChartResizeObj:null,luckysheetCurrentChartResizeXy:null,luckysheetCurrentChartResizeWinH:null,luckysheetCurrentChartResizeWinW:null,luckysheetInsertChartTosheetChange:!0,luckysheetCurrentChartZIndexRank:100,luckysheet_chart_redo_click:!1,luckysheetCurrentChartMaxState:!1,jfrefreshchartall:"",changeChartCellData:"",renderChart:"",getChartJson:""},functionList:null,luckysheet_function:null,chart_selection:{},currentChart:"",scrollRefreshSwitch:!0,measureTextCache:{},measureTextCellInfoCache:{},measureTextCacheTimeOut:null,cellOverflowMapCache:{},zoomRatio:1,visibledatacolumn_unique:null,visibledatarow_unique:null,showGridLines:!0,toobarObject:{},inlineStringEditCache:null,inlineStringEditRange:null,fontList:[],defaultFontSize:10,currentSheetView:"viewNormal",cooperativeEdit:{usernameTimeout:{},changeCollaborationSize:[],allDataColumnlen:[],merge_range:{},checkoutData:[]},asyncLoad:["core"],deepCopyFlowDataState:!1,deepCopyFlowDataCache:"",deepCopyFlowDataWorker:null,deepCopyFlowData:function(e){let l=this;return l.deepCopyFlowDataState?(null!=l.deepCopyFlowDataWorker&&l.deepCopyFlowDataWorker.terminate(),l.deepCopyFlowDataCache):(null==e&&(e=t.flowdata),$.extend(!0,[],e))},webWorkerFlowDataCache:function(e){let t=this;try{null!=t.deepCopyFlowDataWorker&&t.deepCopyFlowDataWorker.terminate();let l,n="data:text/javascript;chartset=US-ASCII,onmessage = function (e) { postMessage(e.data); };";if(t.deepCopyFlowDataState=!1,1==browser.isIE()){let e="self.onmessage=function(e){postMessage(e.data);}";(l=new Worker("./plugins/Worker-helper.js")).postMessage(e)}else l=new Worker(n);t.deepCopyFlowDataWorker=l,l.postMessage(e),l.onmessage=function(e){t.deepCopyFlowDataCache=e.data,t.deepCopyFlowDataState=!0}}catch(l){t.deepCopyFlowDataCache=$.extend(!0,[],e)}},getGridData:function(e){let t=[];for(let l=0;l<e.length;l++)for(let n=0;n<e[0].length;n++)null!=e[l][n]&&t.push({r:l,c:n,v:e[l][n]});return t},getSheetMerge:function(){return null==t.config.merge?null:t.config.merge},getSheetByName:function(e){if(null==e)return null;for(let l=0;l<t.luckysheetfile.length;l++){let n=t.luckysheetfile[l];if(n.name==e)return n}return null},getCurSheetnoset:function(){let e=0;for(let l=0;l<t.luckysheetfile.length;l++)if(1==t.luckysheetfile[l].status){e=t.luckysheetfile[l].index;break}return e},getCurSheet:function(){if(t.luckysheetfile.length){let e=!1,l=[];t.luckysheetfile.forEach(t=>{void 0===t.index&&(t.index=this.generateRandomSheetIndex()),l.includes(t.index)?t.index=this.generateRandomSheetIndex():l.push(t.index),void 0===t.status&&(t.status=0),1==t.status&&(e?t.status=0:e=!0)}),e||(t.luckysheetfile[0].status=1)}t.currentSheetIndex=t.luckysheetfile[0].index;for(let e=0;e<t.luckysheetfile.length;e++)if(1==t.luckysheetfile[e].status){t.currentSheetIndex=t.luckysheetfile[e].index;break}return t.currentSheetIndex},getSheetByIndex:function(e){null==e&&(e=t.currentSheetIndex);let l=this.getSheetIndex(e);return t.luckysheetfile[l]},setCurSheet:function(e){for(let l=0;l<t.luckysheetfile.length;l++)t.luckysheetfile[l].index==e?t.luckysheetfile[l].status=1:t.luckysheetfile[l].status=0;t.currentSheetIndex=e},getSheetIndex:function(e){for(let l=0;l<t.luckysheetfile.length;l++)if(t.luckysheetfile[l].index==e)return l;return null},changeSheet:function(e,l,n){e!==t.currentSheetIndex&&(t.onSheetChanging&&t.onSheetChanging(e,l,n),t.setCurSheet(e))},hasSheet:function(e){return null!=e&&null!=(e=this.getSheetIndex(e))},dataVerification:null,historyParam:function(e,l,n){let r=n.row[0],o=n.row[1],a=n.column[0],u=n.column[1];if(r==o&&a==u){let n=e[r][a];t.saveParam("v",l,n,{r:r,c:a})}else{let n=o-r+1,s=u-a+1,i=Math.floor(1e3/s),c=Math.ceil(n/i);for(let n=0;n<c;n++){let s,h=r+i*n;s=n==c-1?o:r+i*(n+1)-1;let d=[];for(let t=h;t<=s;t++){let l=[];for(let n=a;n<=u;n++)null==e[t]?l.push(null):l.push(e[t][n]);d.push(l)}t.saveParam("rv",l,d,{range:{row:[h,s],column:[a,u]}}),n==c-1&&t.saveParam("rv_end",l,null)}}},saveParam:function(e,l,n,r){if(!this.allowUpdate)return;void 0==n&&(n=null);let o={};if(o.t=e,o.i=l,o.v=n,"shs"===e)return;"rv"==e?o.range=r.range:"v"==e||"fu"==e||"fm"==e?(o.r=r.r,o.c=r.c):"fc"==e?(o.op=r.op,o.pos=r.pos):"drc"==e||"arc"==e||"h"==e||"wh"==e?o.rc=r.rc:"c"==e?(o.cid=r.cid,o.op=r.op):"f"==e?(o.op=r.op,o.pos=r.pos):"s"==e||("sh"==e?(o.op=r.op,null!=r.cur&&(o.cur=r.cur)):"cg"==e?o.k=r.k:"all"==e&&(o.k=r.k));let a=pako.gzip(encodeURIComponent(JSON.stringify(o)),{to:"string"});null!=t.websocket&&t.websocket.send(a)},gridKey:null,loadUrl:null,updateUrl:null,updateImageUrl:null,title:null,loadSheetUrl:null,allowUpdate:!1,websocket:null,refresh:function(e,t){this.onRefresh&&setTimeout(()=>{this.onRefresh(e,t)},1)},refreshGrid:function(e,t,l,n=!0,r=!0){this.onRefresh&&setTimeout(()=>{this.onRefreshGrid(e,t,l,n,r)},1)},refreshGridAll:function(e,t,l,n,r,o,a,u,s=!0){this.onRefresh&&setTimeout(()=>{this.onRefreshGridAll(e,t,l,n,r,o,a,u,s)},1)},refreshRange:function(e,t,l,n=!0,r=!0){this.onRefreshRange&&this.onRefreshRange(e,t,l,n,r)},refreshGrid_adRC:function(e,t,l,n,r,o,a,u,s,i,c){this.onRefresh&&setTimeout(()=>{this.onRefreshGrid_adRC(e,t,l,n,r,o,a,u,s,i,c)},1)},refreshGrid_deleteCell:function(e,t,l,n,r,o,a,u){this.onRefresh&&setTimeout(()=>{this.onRefreshGrid_deleteCell(e,t,l,n,r,o,a,u)},1)},refreshGrid_pastcut:function(e,t,l){this.onRefresh&&setTimeout(()=>{this.onRefreshGrid_pastcut(e,t,l)},1)},refreshGrid_rhcw:function(e,t,l=!0){this.onRefresh&&setTimeout(()=>{this.onRefreshGrid_rhcw(e,t,l)},1)},getluckysheetfile:function(e){return e&&t.luckysheetfile.forEach(e=>{e.chart&&e.chart.forEach(e=>{const l=t.getChartJson(e.chart_id);e.chartOptions=l})}),t.luckysheetfile},getAllSheets:function(){let e=$.extend(!0,[],t.luckysheetfile);return e.forEach((e,l,n)=>{null!=e.data&&e.data.length>0&&(e.celldata=t.getGridData(e.data)),delete e.load,delete e.freezen}),e},toJson:function(){const l=t.toJsonOptions;return l.title=t.title,l.data=t.getAllSheets(),t.getluckysheetfile().forEach((t,n)=>{void 0!=t.data&&(l.data[n].row="array"===e(t.data)?t.data.length:0,l.data[n].column="array"===e(t.data[0])?t.data[0].length:0)}),l},active:function(){this.onActive&&setTimeout(()=>{this.onActive()},1)},invalidate:function(){this.onInvalidate&&setTimeout(()=>{this.onInvalidate()},1)},freezenhorizontaldata:null,freezenverticaldata:null,luckysheetZoomTimeout:null,changeZoom:function(e){null!=t.flowdata&&0!=t.flowdata.length&&(clearTimeout(t.luckysheetZoomTimeout),t.luckysheetZoomTimeout=setTimeout(()=>{t.clearjfundo&&t.jfredo.push({type:"zoomChange",zoomRatio:t.zoomRatio,curZoomRatio:e,sheetIndex:t.currentSheetIndex}),t.zoomRatio=e,t.onZoomChange&&t.onZoomChange(e)},100))}};return t});
//# sourceMappingURL=sourcemaps/store.js.map
