/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../controllers/constant","../controllers/menuButton","../global/datecontroll","../global/validate","../store","../locale/locale","../vendors/numeral"],function(t,e,n,o,l,r,i){"use strict";const{columeHeader_word:a,columeHeader_word_index:c,luckysheetdefaultFont:u}=t,{isdatatype:s,isdatatypemulti:f}=n,{hasChinaword:h,isRealNum:d}=o;function p(t){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(t)]}function g(t,e){let n=a.length;if(1==t){let t=[],e=0;for(let o=0;o<n;o++){let l=a[o];for(let o=0;o<n;o++){let n=l+a[o];if(t.push(n),++e>index)return t}}}else if(2==t){let t=[],e=0;for(let o=0;o<n;o++){let l=a[o];for(let o=0;o<n;o++){let r=a[o];for(let o=0;o<n;o++){let n=l+r+a[o];if(t.push(n),++e>index)return t}}}}}var m,b,y,w;return{isJsonString:function(t){try{if("object"==typeof JSON.parse(t))return!0}catch(t){}return!1},common_extend:function(t,e){let n={};for(let e in t)n[e]=t[e];for(let t in e)void 0!=e[t]&&(n[t]=e[t]);return n},replaceHtml:function(t,e){return t.replace(/\$\{([\w]+)\}/g,function(t,n){let o=e[n];return void 0!==o?o:t})},getObjType:p,getNowDateTime:function(t){let e=new Date,n=e.getFullYear(),o=e.getMonth(),l=e.getDate(),r=(e.getDay(),e.getHours()),i=e.getMinutes(),a=e.getSeconds();(o+=1)<10&&(o="0"+o),l<10&&(l="0"+l),r<10&&(r="0"+r),i<10&&(i="0"+i),a<10&&(a="0"+a);let c="";return 1==t?c=n+"-"+o+"-"+l:2==t&&(c=n+"-"+o+"-"+l+" "+r+":"+i+":"+a),c},hexToRgb:function(t){let e=[],n=[];if(3==(t=t.replace(/#/,"")).length){let e=[];for(let n=0;n<3;n++)e.push(t.charAt(n)+t.charAt(n));t=e.join("")}for(let o=0;o<3;o++)e[o]="0x"+t.substr(o+2,2),n.push(parseInt(Number(e[o])));return"rgb("+n.join(",")+")"},rgbTohex:function(t){let e;return e=t.indexOf("rgba")>-1?t.replace("rgba(","").replace(")","").split(","):t.replace("rgb(","").replace(")","").split(","),"#"+((1<<24)+(parseInt(e[0])<<16)+(parseInt(e[1])<<8)+parseInt(e[2])).toString(16).slice(1)},ABCatNum:function(t){if(null==t||0==t.length)return NaN;for(var e=t.toLowerCase().split(""),n=e.length,o=0,l=0;l<n;l++)o+=(e[l].charCodeAt()-96)*Math.pow(26,n-l-1);return 0==o?NaN:o-1},chatatABC:function(t){for(var e="a".charCodeAt(0),n="z".charCodeAt(0)-e+1,o="";t>=0;)o=String.fromCharCode(t%n+e)+o,t=Math.floor(t/n)-1;return o.toUpperCase()},ceateABC:function(t){let e=a.length;if(t<e)return a;{let n=[],o=2,l=0;for(;t<e/(e-1)*(Math.pow(e,o)-1);)l=o,o++;for(let e=0;e<l;e++)n=0==e?n.concat(a):n.concat(g(e),t)}},createABCdim:g,getByteLen:function(t,e){if(0===e)return"";if(null==t)return 0;let n=0;for(let o=0;o<t.length;o++)if(null!=t.charAt(o).match(/[^\x00-\xff]/gi)?n+=2:n+=1,d(e)&&n===~~e)return t.substring(0,o);return n},ArrayUnique:function(t){let e=[],n={};if(t.length>0)for(let o=0;o<t.length;o++){let l=t[o];n[l]||(e.push(l),n[l]=1)}return e},luckysheetfontformat:function(t){let n=r().fontarray;if("object"==p(t)){let o="";if("0"==t.it||null==t.it?o+="normal ":o+="italic ",o+="normal ","0"==t.bl||null==t.bl?o+="normal ":o+="bold ",t.fs?o+=Math.ceil(t.fs)+"pt ":o+=l.defaultFontSize+"pt ",t.ff){let l=null;r().fontjson,f(t.ff).num?l=n[parseInt(t.ff)]:((l=(l=t.ff).replace(/"/g,"").replace(/'/g,"")).indexOf(" ")>-1&&(l='"'+l+'"'),null!=l&&document.fonts&&!document.fonts.check("12px "+l)&&e.addFontTolist(l)),null==l&&(l=n[0]),o+=l+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif'}else o+=n[0]+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif';return o}return u()},showrightclickmenu:function(t,e,n){let o=$(window).height(),l=$(window).width(),r=t.width(),i=t.height(),a=n,c=e;e+r>l&&(c=e-r),n+i>o&&(a=n-i),a<0&&(a=0),t.css({top:a,left:c}).show()},luckysheetactiveCell:function(){l.fullscreenmode&&setTimeout(function(){$("#luckysheet-rich-text-editor").focus().select()},50)},numFormat:function(t,e){if(null==t||isNaN(parseFloat(t))||h(t)||t==-1/0||t==1/0)return null;let n=6,o=!1;null==e||"auto"==e?n=t<1?6:1:"num"==s(e)?(n=parseInt(e),o=!0):n=6;let l="",r=null;for(let t=0;t<n;t++)l+="0";return o||(l="["+l+"]"),r=t>=1e21?parseFloat(i(t).value()):parseFloat(i(t).format("0."+l))},numfloatlen:function(t){if(null==t||isNaN(parseFloat(t))||h(t))return null;{let e=i(t).value().toString().split(".");return e=1==e.length?0:e[1].length}},mouseclickposition:function(t,e,n,o){let l=$(window).height(),r=($(window).width(),t.width());t.height(),null==o&&(o="lefttop"),"lefttop"==o?t.css({top:n,left:e}).show():"righttop"==o?t.css({top:n,left:e-r}).show():"leftbottom"==o?t.css({bottom:l-n-12,left:e}).show():"rightbottom"==o&&t.css({bottom:l-n-12,left:e-r}).show()},$$:function(t,e){var n=(e=e||document).querySelectorAll(t);return 1==n.length?Array.prototype.slice.call(n)[0]:Array.prototype.slice.call(n)},seriesLoadScripts:function(t,e,n){"object"!=typeof t&&(t=[t]);var o=document.getElementsByTagName("head")[0]||document.documentElement,l=[],r=t.length-1,i=function(a){if(l[a]=document.createElement("script"),l[a].setAttribute("type","text/javascript"),l[a].onload=l[a].onreadystatechange=function(){this.onload=this.onreadystatechange=null,this.parentNode.removeChild(this),a!==r?i(a+1):"function"==typeof n&&n()},l[a].setAttribute("src",t[a]),"object"==typeof e)for(var c in e)l[a].setAttribute(c,e[c]);o.appendChild(l[a])};i(0)},parallelLoadScripts:function(t,e,n){"object"!=typeof t&&(t=[t]);for(var o=document.getElementsByTagName("head")[0]||document.documentElement,l=[],r=0,i=0;i<t.length;i++){if(l[i]=document.createElement("script"),l[i].setAttribute("type","text/javascript"),l[i].onload=l[i].onreadystatechange=function(){r++,this.onload=this.onreadystatechange=null,this.parentNode.removeChild(this),r===t.length&&"function"==typeof n&&n()},l[i].setAttribute("src",t[i]),"object"==typeof e)for(var a in e)l[i].setAttribute(a,e[a]);o.appendChild(l[i])}},loadLinks:function(t){"object"!=typeof t&&(t=[t]),t.length&&t.forEach(t=>{!function(t){var e=document,n=e.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",t);var o=e.getElementsByTagName("head");o.length?o[0].appendChild(n):e.documentElement.appendChild(n)}(t)})},luckysheetContainerFocus:function(){$("#"+l.container).attr("tabindex",0).focus()},transformRangeToAbsolute:function(t){if(null==t||0==t.length)return null;let e=t.split(","),n="";for(let t=0;t<e.length;t++){let o=e[t].split("!"),l="",r="";o.length>1?(l=o[0],r=o[1]):r=o[0];let i=r.split(":"),a="";for(let t=0;t<i.length;t++){let e=i[t],n=e.replace(/[^0-9]/g,""),o=e.replace(/[^A-Za-z]/g,""),l="";""!=o&&(l+="$"+o),""!=n&&(l+="$"+n),a+=l+":"}n+=l+(a=a.substr(0,a.length-1))+","}return n.substr(0,n.length-1)},openSelfModel:function(t,e=!0){let n=$("#"+t).find(".luckysheet-modal-dialog-content").css("min-width",300).end(),o=n.outerHeight(),l=n.outerWidth(),r=$(window).width(),i=$(window).height(),a=$(document).scrollLeft(),c=$(document).scrollTop();n.css({left:(r+a-l)/2,top:(i+c-o)/3}).show(),e&&$("#luckysheet-modal-dialog-mask").show()},createProxy:(t,e,n)=>{t.hasOwnProperty(e)?"object"===p(t)&&("object"===p(t[e])||"array"===p(t[e])?(m=t,b=e,y=t[e],n=n,m[b]=new Proxy(y,{set:(t,e,o,l)=>(setTimeout(()=>{n(t,e,o,l)},0),Reflect.set(t,e,o,l))})):function(t,e,n,o){Object.defineProperty(t,e,{enumerable:!0,configurable:!1,get:()=>n,set(t){n!==t&&(console.log(`发现 ${e} 属性 ${n} -> ${t}`),setTimeout(()=>{o(n,t)},0),n=t)}})}(t,e,t[e],n)):console.info("No %s in data",e)},arrayRemoveItem:function(t,e){t.some((t,n,o)=>{if(t===e)return o.splice(n,1),t===e})}}});
//# sourceMappingURL=../sourcemaps/utils/util.js.map
