/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../methods/dataVerificationCtrl_methods","../utils/util","../methods/formula_methods","../methods/validate","../methods/datecontroll","../widgets/tooltip","../methods/setdata","../methods/getdata","../widgets/constant","../widgets/select","../methods/cells","../methods/get","../locale/locale","../store"],function(e,t,i,a,o,n,l,c,d,s,r,h,u,f){"use strict";const{replaceHtml:v}=t,{isRealNum:p,isRealNull:g}=a,{isdatetime:m,diff:b}=o,{setcellvalue:w}=l,{getcellvalue:y}=c,{modelHTML:k}=d,{selectionCopyShow:x}=s,{getSheetIndex:V,getRangetxt:_}=h;return Object.assign(e,{createDialog:function(){const e=u(),t=e.dataVerification,i=e.toolbar,a=e.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").remove();let o=`<div class="box">\n                            <div class="box-item" style="border-top:1px solid #E1E4E8;">\n                                <div class="box-item-title">${t.cellRange}</div>\n                                <div id="data-verification-range" class="range">\n                                    <input class="formulaInputFocus" spellcheck="false">\n                                    <i class="fa fa-table" aria-hidden="true" title="${t.selectCellRange}"></i>\n                                </div>\n                            </div>\n                            <div class="box-item">\n                                <div class="box-item-title">${t.verificationCondition}</div>\n                                <select id="data-verification-type-select">\n                                    <option value="dropdown">${t.dropdown}</option>\n                                    <option value="checkbox">${t.checkbox}</option>\n                                    <option value="number">${t.number}</option>\n                                    <option value="number_integer">${t.number_integer}</option>\n                                    <option value="number_decimal">${t.number_decimal}</option>\n                                    <option value="text_content">${t.text_content}</option>\n                                    <option value="text_length">${t.text_length}</option>\n                                    <option value="date">${t.date}</option>\n                                    <option value="validity">${t.validity}</option>\n                                </select>\n                                <div class="show-box">\n                                    <div class="show-box-item show-box-item-dropdown">\n                                        <div class="range">\n                                            <input class="formulaInputFocus data-verification-value1" placeholder="${t.placeholder1}" spellcheck="false">\n                                            <i class="fa fa-table" aria-hidden="true" title="${t.selectCellRange}"></i>\n                                        </div>\n                                    </div>\n                                    <div class="show-box-item show-box-item-checkbox">\n                                        <div class="check-box">\n                                            <span>${t.selected} ——</span>\n                                            <input type="text" class="data-verification-value1" placeholder="${t.placeholder2}">\n                                        </div>\n                                        <div class="check-box">\n                                            <span>${t.notSelected} ——</span>\n                                            <input type="text" class="data-verification-value2" placeholder="${t.placeholder2}">\n                                        </div>\n                                    </div>\n                                    <div class="show-box-item show-box-item-number">\n                                        <select id="data-verification-number-select">\n                                            <option value="bw">${t.between}</option>\n                                            <option value="nb">${t.notBetween}</option>\n                                            <option value="eq">${t.equal}</option>\n                                            <option value="ne">${t.notEqualTo}</option>\n                                            <option value="gt">${t.moreThanThe}</option>\n                                            <option value="lt">${t.lessThan}</option>\n                                            <option value="gte">${t.greaterOrEqualTo}</option>\n                                            <option value="lte">${t.lessThanOrEqualTo}</option>\n                                        </select>\n                                        <div class="input input1">\n                                            <input type="number" class="data-verification-value1" placeholder="1">\n                                            <span>-</span>\n                                            <input type="number" class="data-verification-value2" placeholder="100">\n                                        </div>\n                                        <div class="input input2">\n                                            <input type="number" class="data-verification-value1" placeholder="${t.placeholder3}">\n                                        </div>\n                                    </div>\n                                    <div class="show-box-item show-box-item-text">\n                                        <select id="data-verification-text-select">\n                                            <option value="include">${t.include}</option>\n                                            <option value="exclude">${t.exclude}</option>\n                                            <option value="equal">${t.equal}</option>\n                                        </select>\n                                        <div class="input input2">\n                                            <input type="text" class="data-verification-value1" placeholder="${t.placeholder4}"/>\n                                        </div>\n                                    </div>\n                                    <div class="show-box-item show-box-item-textLength">\n                                        <select id="data-verification-textLength-select">\n                                            <option value="bw">${t.between}</option>\n                                            <option value="nb">${t.notBetween}</option>\n                                            <option value="eq">${t.equal}</option>\n                                            <option value="ne">${t.notEqualTo}</option>\n                                            <option value="gt">${t.moreThanThe}</option>\n                                            <option value="lt">${t.lessThan}</option>\n                                            <option value="gte">${t.greaterOrEqualTo}</option>\n                                            <option value="lte">${t.lessThanOrEqualTo}</option>\n                                        </select>\n                                        <div class="input input1">\n                                            <input type="number" class="data-verification-value1" placeholder="1">\n                                            <span>-</span>\n                                            <input type="number" class="data-verification-value2" placeholder="100">\n                                        </div>\n                                        <div class="input input2">\n                                            <input type="number" class="data-verification-value1" placeholder="${t.placeholder3}">\n                                        </div>\n                                    </div>\n                                    <div class="show-box-item show-box-item-date">\n                                        <select id="data-verification-date-select">\n                                            <option value="bw">${t.between}</option>\n                                            <option value="nb">${t.notBetween}</option>\n                                            <option value="eq">${t.equal}</option>\n                                            <option value="ne">${t.notEqualTo}</option>\n                                            <option value="bf">${t.earlierThan}</option>\n                                            <option value="nbf">${t.noEarlierThan}</option>\n                                            <option value="af">${t.laterThan}</option>\n                                            <option value="naf">${t.noLaterThan}</option>\n                                        </select>\n                                        <div class="input input1">\n                                            <input type="date" class="data-verification-value1" placeholder="2020/9/10">\n                                            <span>-</span>\n                                            <input type="date" class="data-verification-value2" placeholder="2020/9/10">\n                                        </div>\n                                        <div class="input input2">\n                                            <input type="date" class="data-verification-value1" placeholder="2020/9/10">\n                                        </div>\n                                    </div>\n                                    <div class="show-box-item show-box-item-validity">\n                                        <select id="data-verification-validity-select">\n                                            <option value="card">${t.identificationNumber}</option>\n                                            <option value="phone">${t.phoneNumber}</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="box-item">\n                                <div class="check">\n                                    <input type="checkbox" id="data-verification-remote" class="data-verification-remote">\n                                    <label for="data-verification-remote">${t.remote}</label>\n                                </div>\n                                <div class="check">\n                                    <input type="checkbox" id="data-verification-prohibitInput">\n                                    <label for="data-verification-prohibitInput">${t.prohibitInput}</label>\n                                </div>\n                                <div class="check">\n                                    <input type="checkbox" id="data-verification-hint-show">\n                                    <label for="data-verification-hint-show">${t.hintShow}</label>\n                                </div>\n                                <div class="data-verification-hint-text">\n                                    <input type="text" placeholder="${t.placeholder5}">\n                                </div>\n                            </div>\n                        </div>`;$("body").append(v(k,{id:"luckysheet-dataVerification-dialog",addclass:"luckysheet-dataVerification-dialog",title:i.dataVerification,content:o,botton:`<button id="luckysheet-dataVerification-dialog-confirm" class="btn btn-primary">${a.confirm}</button>\n                        <button id="luckysheet-dataVerification-dialog-delete" class="btn btn-default">${t.deleteVerification}</button>\n                        <button class="btn btn-default luckysheet-model-close-btn">${a.cancel}</button>`,style:"z-index:100003"}));let n=$("#luckysheet-dataVerification-dialog").find(".luckysheet-modal-dialog-content").css("min-width",350).end(),l=n.outerHeight(),c=n.outerWidth(),d=$(window).width(),s=$(window).height(),r=$(document).scrollLeft(),h=$(document).scrollTop();$("#luckysheet-dataVerification-dialog").css({left:(d+r-c)/2,top:(s+h-l)/3}).show(),this.dataAllocation()},init:function(){let e=this;const t=u().dataVerification;$(document).off("click.dropdownBtn").on("click.dropdownBtn","#luckysheet-dataVerification-dropdown-btn",function(t){e.dropdownListShow(),t.stopPropagation()}),$(document).off("click.dropdownListItem").on("click.dropdownListItem","#luckysheet-dataVerification-dropdown-List .dropdown-List-item",function(e){$("#luckysheet-dataVerification-dropdown-List").hide();let t=e.target.innerText,i=f.luckysheet_select_save[f.luckysheet_select_save.length-1];i.row_focus,i.column_focus;$("#luckysheet-rich-text-editor").text(t),e.stopPropagation()}),$(document).off("click.dvRange").on("click.dvRange","#data-verification-range .fa-table",function(t){$("#luckysheet-dataVerification-dialog").hide();let a=$(this).siblings("input").val().trim();e.rangeDialog("0",a),e.selectRange=[];let o=e.getRangeByTxt(a);if(i.rangetosheet=f.currentSheetIndex,o[0].sheetIndex!=f.currentSheetIndex&&f.changeSheet(o[0].sheetIndex),o.length>0)for(let t=0;t<o.length;t++){let i=o[t].row[0],a=o[t].row[1],n=o[t].column[0],l=o[t].column[1],c=f.visibledatarow[a],d=i-1==-1?0:f.visibledatarow[i-1],s=f.visibledatacolumn[l],r=n-1==-1?0:f.visibledatacolumn[n-1];e.selectRange.push({left:r,width:s-r-1,top:d,height:c-d-1,left_move:r,width_move:s-r-1,top_move:d,height_move:c-d-1,row:[i,a],column:[n,l],row_focus:i,column_focus:n})}x(e.selectRange)}),$(document).off("click.dvRange2").on("click.dvRange2","#luckysheet-dataVerification-dialog .show-box-item-dropdown .range .fa-table",function(t){$("#luckysheet-dataVerification-dialog").hide();let a=$(this).siblings("input").val().trim();e.rangeDialog("1",a),e.selectRange=[];let o=e.getRangeByTxt(a);if(i.rangetosheet=f.currentSheetIndex,o[0].sheetIndex!=f.currentSheetIndex&&f.changeSheet(o[0].sheetIndex),o.length>0)for(let t=0;t<o.length;t++){let i=o[t].row[0],a=o[t].row[1],n=o[t].column[0],l=o[t].column[1],c=f.visibledatarow[a],d=i-1==-1?0:f.visibledatarow[i-1],s=f.visibledatacolumn[l],r=n-1==-1?0:f.visibledatacolumn[n-1];e.selectRange.push({left:r,width:s-r-1,top:d,height:c-d-1,left_move:r,width_move:s-r-1,top_move:d,height_move:c-d-1,row:[i,a],column:[n,l],row_focus:i,column_focus:n})}x(e.selectRange)}),$(document).off("click.dvRangeConfirm").on("click.dvRangeConfirm","#luckysheet-dataVerificationRange-dialog-confirm",function(t){let a=$(this).attr("data-source"),o=$(this).parents("#luckysheet-dataVerificationRange-dialog").find("input").val();if(e.getRangeByTxt(o).length>1)return void n.info('<i class="fa fa-exclamation-triangle"></i>',"不能对多重选择区域执行此操作，请选择单个区域，然后再试");"0"==a?$("#luckysheet-dataVerification-dialog #data-verification-range input").val(o):"1"==a&&$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .range input").val(o),$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),null!=i.rangetosheet&&i.rangetosheet!=f.currentSheetIndex&&(f.changeSheet(i.rangetosheet),i.rangetosheet=null);x([])}),$(document).off("click.dvRangeClose").on("click.dvRangeClose","#luckysheet-dataVerificationRange-dialog-close",function(e){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),null!=i.rangetosheet&&i.rangetosheet!=f.currentSheetIndex&&(f.changeSheet(i.rangetosheet),i.rangetosheet=null);x([])}),$(document).on("click","#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close",function(e){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),null!=i.rangetosheet&&i.rangetosheet!=f.currentSheetIndex&&(f.changeSheet(i.rangetosheet),i.rangetosheet=null);x([])}),$(document).off("change.typeSelect").on("change.typeSelect","#data-verification-type-select",function(t){$("#luckysheet-dataVerification-dialog .show-box .show-box-item").hide();let i=this.value,a=e.curItem;if("dropdown"==i){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown").show();let e="";i==a.type&&(e=a.value1),$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val(e)}else if("checkbox"==i){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox").show();let e="",t="";i==a.type&&(e=a.value1,t=a.value2),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val(e),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val(t)}else if("number"==i||"number_integer"==i||"number_decimal"==i){$("#luckysheet-dataVerification-dialog .show-box-item-number").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide();let e="bw",t="",i="";"number"!=a.type&&"number_integer"!=a.type&&"number_decimal"!=a.type||(e=a.type2,t=a.value1,i=a.value2),$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(e),"bw"==e||"nb"==e?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1").val(t),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2").val(i)}else if("text_content"==i){$("#luckysheet-dataVerification-dialog .show-box-item-text").show();let e="include",t="";i==a.type&&(e=a.type2,t=a.value1),$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(e),$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val(t)}else if("text_length"==i){$("#luckysheet-dataVerification-dialog .show-box-item-textLength").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide();let e="bw",t="",o="";i==a.type&&(e=a.type2,t=a.value1,o=a.value2),$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(e),"bw"==e||"nb"==e?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1").val(t),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2").val(o)}else if("date"==i){$("#luckysheet-dataVerification-dialog .show-box-item-date").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide();let e="bw",t="",o="";i==a.type&&(e=a.type2,t=a.value1,o=a.value2),$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(e),"bw"==e||"nb"==e?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1").val(t),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2").val(o)}else if("validity"==i){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-validity").show();let e="card";i==a.type&&(e=a.type2),$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val(e)}}),$(document).off("change.numberSelect").on("change.numberSelect","#data-verification-number-select",function(e){$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide();let t=this.value;"bw"==t||"nb"==t?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show()}),$(document).off("change.dateSelect").on("change.dateSelect","#data-verification-date-select",function(e){$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide();let t=this.value;"bw"==t||"nb"==t?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show()}),$(document).off("change.hintShow").on("change.hintShow","#data-verification-hint-show",function(e){this.checked?$("#luckysheet-dataVerification-dialog .data-verification-hint-text").show():$("#luckysheet-dataVerification-dialog .data-verification-hint-text").hide()}),$(document).off("click.dvSaveConfirm").on("click.dvSaveConfirm","#luckysheet-dataVerification-dialog-confirm",function(i){let a=$("#luckysheet-dataVerification-dialog #data-verification-range input").val().trim(),o=e.getRangeByTxt(a);if(0==o.length)return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.selectCellRange2);let l=o[o.length-1].row[0],c=o[o.length-1].row[1],d=o[o.length-1].column[0],s=o[o.length-1].column[1],r=f.deepCopyFlowData(f.flowdata);l<0&&(l=0),c>r.length-1&&(c=r.length-1),d<0&&(d=0),s>r[0].length-1&&(s=r[0].length-1);let h=$("#luckysheet-dataVerification-dialog #data-verification-type-select").val(),u=null,v="",g="";if("dropdown"==h){if(0==(v=$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val().trim()).length)return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo1)}else if("checkbox"==h){if(v=$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val().trim(),g=$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val().trim(),0==v.length||0==g.length)return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo2)}else if("number"==h||"number_integer"==h||"number_decimal"==h){if(u=$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(),v=$("#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value1").val().trim(),!p(v))return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo3);if("bw"==u||"nb"==u){if(g=$("#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value2").val().trim(),!p(g))return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo3);if(Number(g)<Number(v))return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo4)}}else if("text_content"==h){if(u=$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(),0==(v=$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val().trim()).length)return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo5)}else if("text_length"==h){if(u=$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(),v=$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value1").val().trim(),!p(v))return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo3);if("bw"==u||"nb"==u){if(g=$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value2").val().trim(),!p(g))return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo3);if(Number(g)<Number(v))return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo4)}}else if("date"==h){if(u=$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(),v=$("#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value1").val().trim(),!m(v))return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo6);if("bw"==u||"nb"==u){if(g=$("#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value2").val().trim(),!m(g))return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo6);if(b(v,g)>0)return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo7)}}else"validity"==h&&(u=$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val());let y=$("#luckysheet-dataVerification-dialog #data-verification-remote").is(":checked"),k=$("#luckysheet-dataVerification-dialog #data-verification-prohibitInput").is(":checked"),x=$("#luckysheet-dataVerification-dialog #data-verification-hint-show").is(":checked"),V="";x&&(V=$("#luckysheet-dataVerification-dialog .data-verification-hint-text input").val().trim());let _={type:h,type2:u,value1:v,value2:g,checked:!1,remote:y,prohibitInput:k,hintShow:x,hintText:V},I=$.extend(!0,{},f.dataVerification),R=$.extend(!0,{},f.dataVerification);for(let e=l;e<=c;e++)for(let t=d;t<=s;t++)R[e+"_"+t]=_,"checkbox"==h&&w(e,t,r,_.value2);"checkbox"==h?e.refOfCheckbox(I,R,f.currentSheetIndex,r,o[o.length-1]):e.ref(I,R,f.currentSheetIndex),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerification-dialog").hide()}),$(document).off("click.delete").on("click.delete","#luckysheet-dataVerification-dialog-delete",function(i){let a=$("#luckysheet-dataVerification-dialog #data-verification-range input").val().trim(),o=e.getRangeByTxt(a);if(0==o.length)return void n.info('<i class="fa fa-exclamation-triangle"></i>',t.selectCellRange2);let l=$.extend(!0,{},f.dataVerification),c=$.extend(!0,{},f.dataVerification),d=o[o.length-1].row[0],s=o[o.length-1].row[1],r=o[o.length-1].column[0],h=o[o.length-1].column[1];for(let e=d;e<=s;e++)for(let t=r;t<=h;t++)delete c[e+"_"+t];e.ref(l,c,f.currentSheetIndex),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerification-dialog").hide()}),$(document).on("click","#luckysheet-info .luckysheet-modal-dialog-title-close, #luckysheet-info .luckysheet-model-close-btn",function(e){$(this).parents("#luckysheet-info").hide(),$("#luckysheet-dataVerification-dialog").is(":visible")&&$("#luckysheet-modal-dialog-mask").show(),e.stopPropagation()})},dataAllocation:function(){let e=this,t=f.luckysheet_select_save[f.luckysheet_select_save.length-1],i=_(f.currentSheetIndex,t,f.currentSheetIndex);$("#luckysheet-dataVerification-dialog #data-verification-range input").val(i);let a=t.row_focus||t.row[0],o=t.column_focus||t.column[0],n=$.extend(!0,{},f.dataVerification)[a+"_"+o];null==n&&(n=$.extend(!0,{},e.defaultItem)),e.curItem=n,$("#luckysheet-dataVerification-dialog #data-verification-type-select").val(n.type),$("#luckysheet-dataVerification-dialog .show-box .show-box-item").hide(),"dropdown"==n.type?($("#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown").show(),$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val(n.value1)):"checkbox"==n.type?($("#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox").show(),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val(n.value1),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val(n.value2)):"number"==n.type||"number_integer"==n.type||"number_decimal"==n.type?($("#luckysheet-dataVerification-dialog .show-box-item-number").show(),$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(n.type2),$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide(),"bw"==n.type2||"nb"==n.type2?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1").val(n.value1),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2").val(n.value2)):"text_content"==n.type?($("#luckysheet-dataVerification-dialog .show-box-item-text").show(),$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(n.type2),$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val(n.value1)):"text_length"==n.type?($("#luckysheet-dataVerification-dialog .show-box-item-textLength").show(),$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(n.type2),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide(),"bw"==n.type2||"nb"==n.type2?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1").val(n.value1),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2").val(n.value2)):"date"==n.type?($("#luckysheet-dataVerification-dialog .show-box-item-date").show(),$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(n.type2),$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide(),"bw"==n.type2||"nb"==n.type2?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1").val(n.value1),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2").val(n.value2)):"validity"==n.type&&($("#luckysheet-dataVerification-dialog .show-box .show-box-item-validity").show(),$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val(n.type2)),$("#luckysheet-dataVerification-dialog #data-verification-remote").prop("checked",n.remote),$("#luckysheet-dataVerification-dialog #data-verification-prohibitInput").prop("checked",n.prohibitInput),$("#luckysheet-dataVerification-dialog #data-verification-hint-show").prop("checked",n.hintShow),n.hintShow?$("#luckysheet-dataVerification-dialog .data-verification-hint-text").show():$("#luckysheet-dataVerification-dialog .data-verification-hint-text").hide(),$("#luckysheet-dataVerification-dialog .data-verification-hint-text input").val(n.hintText)},rangeDialog:function(e,t){const i=u(),a=i.dataVerification,o=i.button;$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerificationRange-dialog").remove(),$("body").append(v(k,{id:"luckysheet-dataVerificationRange-dialog",addclass:"luckysheet-dataVerificationRange-dialog",title:a.selectCellRange,content:`<input readonly="readonly" placeholder="${a.selectCellRange2}" value="${t}"/>`,botton:`<button id="luckysheet-dataVerificationRange-dialog-confirm" class="btn btn-primary" data-source="${e}">${o.confirm}</button>\n                        <button id="luckysheet-dataVerificationRange-dialog-close" class="btn btn-default">${o.close}</button>`,style:"z-index:100003"}));let n=$("#luckysheet-dataVerificationRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=n.outerHeight(),c=n.outerWidth(),d=$(window).width(),s=$(window).height(),r=$(document).scrollLeft(),h=$(document).scrollTop();$("#luckysheet-dataVerificationRange-dialog").css({left:(d+r-c)/2,top:(s+h-l)/3}).show()},getTxtByRange:function(e){if(e.length>0){let t=[];for(let i=0;i<e.length;i++){let a=e[i].row[0],o=e[i].row[1],n=e[i].column[0],l=e[i].column[1];t.push(_(f.currentSheetIndex,{row:[a,o],column:[n,l]},f.currentSheetIndex))}return t.join(",")}},getRangeByTxt:function(e){let t=[];if(-1!=e.indexOf(",")){let a=e.split(",");for(let e=0;e<a.length;e++){if(!i.iscelldata(a[e])){t=[];break}t.push(i.getcellrange(a[e]))}}else i.iscelldata(e)&&t.push(i.getcellrange(e));return t},cellFocus:function(e,t,i){$("#luckysheet-dataVerification-dropdown-btn").hide(),$("#luckysheet-dataVerification-showHintBox").hide();let a=this;if(null==f.dataVerification||null==f.dataVerification[e+"_"+t])return void $("#luckysheet-dataVerification-dropdown-List").hide();let o=f.visibledatarow[e],n=0==e?0:f.visibledatarow[e-1],l=f.visibledatacolumn[t],c=0==t?0:f.visibledatacolumn[t-1],d=r.mergeborer(f.flowdata,e,t);d&&(o=d.row[1],n=d.row[0],l=d.column[1],c=d.column[0]);let s=f.dataVerification[e+"_"+t];if(i&&"checkbox"==s.type)return void a.checkboxChange(e,t);if("dropdown"==s.type){if($("#luckysheet-dataVerification-dropdown-btn").show().css({"max-width":l-c,"max-height":o-n,left:l-20,top:n+(o-n-20)/2}),$("#luckysheet-dataVerification-dropdown-List").is(":visible")){$("#luckysheet-dataVerification-dropdown-List").prop("data-index")!=e+"_"+t&&$("#luckysheet-dataVerification-dropdown-List").hide()}}else $("#luckysheet-dataVerification-dropdown-List").hide();if(s.hintShow){let e;return e="en"==f.lang?'<span style="color:#f5a623;">Hint: </span>':'<span style="color:#f5a623;">提示：</span>',e+=a.getHintText(s),void $("#luckysheet-dataVerification-showHintBox").html(e).show().css({left:c,top:o})}let h=y(e,t,null);if(!g(h)&&!a.validateCellData(h,s)){let e;e="en"==f.lang?'<span style="color:#f72626;">Failure: </span>':'<span style="color:#f72626;">失效：</span>',e+=a.getFailureText(s),$("#luckysheet-dataVerification-showHintBox").html(e).show().css({left:c,top:o})}},dropdownListShow:function(){$("#luckysheet-dataVerification-showHintBox").hide();let e=f.luckysheet_select_save[f.luckysheet_select_save.length-1],t=e.row_focus,i=e.column_focus,a=f.visibledatarow[t],o=0==t?0:f.visibledatarow[t-1],n=f.visibledatacolumn[i],l=0==i?0:f.visibledatacolumn[i-1],c=r.mergeborer(f.flowdata,t,i);c&&(a=c.row[1],o=c.row[0],n=c.column[1],l=c.column[0]);let d=f.dataVerification[t+"_"+i],s="";this.getDropdownList(d.value1).forEach(e=>{s+=`<div class="dropdown-List-item luckysheet-mousedown-cancel">${e}</div>`}),$("#luckysheet-dataVerification-dropdown-List").html(s).prop("data-index",t+"_"+i).show().css({width:n-l-1,left:l,top:a});let h=$("#luckysheet-dataVerification-dropdown-List").outerHeight();a+h>$("#luckysheet-cell-main")[0].scrollHeight-42-6&&$("#luckysheet-dataVerification-dropdown-List").css({top:o-h})},checkboxChange:function(e,t){let i=$.extend(!0,{},f.dataVerification),a=$.extend(!0,{},f.dataVerification),o=a[e+"_"+t];o.checked=!o.checked;let n=o.value2;o.checked&&(n=o.value1);let l=f.deepCopyFlowData(f.flowdata);w(e,t,l,n),this.refOfCheckbox(i,a,f.currentSheetIndex,l,{row:[e,e],column:[t,t]})},ref:function(e,t,i){if(f.clearjfundo){f.jfundo.length=0;let a={type:"updateDataVerification"};a.sheetIndex=i,a.historyDataVerification=e,a.currentDataVerification=t,f.jfredo.push(a)}f.dataVerification=t,f.luckysheetfile[V(i)].dataVerification=t,f.allowUpdate&&f.saveParam("all",i,t,{k:"dataVerification"}),f.refresh()},refOfCheckbox:function(e,t,i,a,o){if(f.clearjfundo){f.jfundo.length=0;let n={type:"updateDataVerificationOfCheckbox"};n.sheetIndex=i,n.historyDataVerification=e,n.currentDataVerification=t,n.data=f.flowdata,n.curData=a,n.range=o,f.jfredo.push(n)}f.dataVerification=t,f.luckysheetfile[V(i)].dataVerification=t,f.flowdata=a,f.webWorkerFlowDataCache(f.flowdata),f.luckysheetfile[V(i)].data=f.flowdata,f.allowUpdate&&(f.saveParam("all",i,t,{k:"dataVerification"}),f.historyParam(f.flowdata,i,o)),f.refresh()}})});
//# sourceMappingURL=../sourcemaps/widgets/dataVerificationCtrl.js.map
