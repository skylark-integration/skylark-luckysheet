/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../widgets/constant","../utils/browser","../utils/util","../locale/locale"],function(t,e,o,n){"use strict";const{modelHTML:l,luckysheetchartpointconfigHTML:s,luckysheetToolHTML:i}=t,{replaceHtml:c}=o;return{info:function(t,e){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-info").remove();let o=n().button;$("body").append(c(l,{id:"luckysheet-info",addclass:"",title:t,content:e,botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;'+o.close+"&nbsp;&nbsp;</button>",style:"z-index:100003"}));let s=$("#luckysheet-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),i=s.outerHeight(),d=s.outerWidth(),p=$(window).width(),u=$(window).height(),h=$(document).scrollLeft(),r=$(document).scrollTop();$("#luckysheet-info").css({left:(p+h-d)/2,top:(u+r-i)/3}).show()},confirm:function(t,e,o,s,i,d){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove();const p=n().button;null==i&&(i=p.confirm),null==d&&(d=p.cancel),$("body").append(c(l,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:t,content:e,botton:'<button class="btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+i+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+d+"&nbsp;&nbsp;</button>"}));let u=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),h=u.outerHeight(),r=u.outerWidth(),a=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),b=$(document).scrollTop();$("#luckysheet-confirm").css({left:(a+m-r)/2,top:(f+b-h)/3}).show(),u.find(".luckysheet-model-conform-btn").click(function(){"function"==typeof o&&o(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),u.find(".luckysheet-model-cancel-btn").click(function(){"function"==typeof s&&s(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()})},screenshot:function(t,o,s){const i=n().screenshot;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove(),$("body").append(c(l,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:t,content:o,botton:'<a style="text-decoration:none;color:#fff;" class="download btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+i.downLoadBtn+'&nbsp;&nbsp;</a>&nbsp;&nbsp;<button class="btn btn-primary luckysheet-model-copy-btn">&nbsp;&nbsp;'+i.downLoadCopy+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+i.downLoadClose+"&nbsp;&nbsp;</button>"}));let d=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),p=d.outerHeight(),u=d.outerWidth(),h=$(window).width(),r=$(window).height(),a=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-confirm").css({left:(h+a-u)/2,top:(r+f-p)/3}).show(),d.find(".luckysheet-model-conform-btn").click(function(){"1"==e.isIE()?alert(i.browserNotTip):(window.ActiveXObject||"ActiveXObject"in window)&&(0===$("#IframeReportImg").length&&$('<iframe style="display:none;" id="IframeReportImg" name="IframeReportImg" onload="downloadImg();" width="0" height="0" src="about:blank"></iframe>').appendTo("body"),$("#IframeReportImg").attr("src")!=s?$("#IframeReportImg").attr("src",s):"about:blank"!=$("#IframeReportImg").src&&window.frames.IframeReportImg.document.execCommand("SaveAs"))}),d.find(".luckysheet-model-cancel-btn").click(function(){$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#luckysheet-confirm .luckysheet-model-copy-btn").click(function(){let t=new clipboard.DT;t.setData("text/html","<img src='"+s+"'>"),"1"==e.isIE()?alert(i.rightclickTip):(clipboard.write(t),alert(i.successTip))})},chartPointConfig:function(t,e,o){$("body").append(c(l,{id:t,addclass:"luckysheet-chart-point-config-c",title:"数据点批量设置",content:s,botton:'<button class="btn btn-danger luckysheet-model-save-btn">&nbsp;&nbsp;保存设置&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;取消&nbsp;&nbsp;</button>',style:"z-index:100003;height:80%;width:80%;top:10%;left:10%;"})),$("#luckysheet-modal-dialog-mask").show();let n=$(window).width(),i=$(window).height();$("#"+t).find(".luckysheet-chart-point-config").css("height",i-160),$("#"+t).css({height:i-90,width:n-100,left:7,top:14}).show().find(".luckysheet-model-save-btn").click(function(){"function"==typeof e&&e(),$("#"+t).hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#"+t).find(".luckysheet-model-save-btn").click(function(){"function"==typeof o&&o(),$("#"+t).hide(),$("#luckysheet-modal-dialog-mask").hide()})},sheetConfig:function(){},hoverTipshowState:!1,hoverTipshowTimeOut:null,createHoverTip:function(t,e){let o=this;$(t).on("mouseover",e,function(t){o.hoverTipshowState||(clearTimeout(o.hoverTipshowTimeOut),o.hoverTipshowTimeOut=setTimeout(function(){let e=$(t.currentTarget),o=e.offset(),n=$("#luckysheet-tooltip-up"),l=e.data("tips");if(!(null!=l&&0!=l.length||null!=(l=e.prev().data("tips"))&&0!=l.length))return;0==n.length&&($("body").append(i),n=$("#luckysheet-tooltip-up")),n.removeClass("jfk-tooltip-hide").find("div.jfk-tooltip-contentId").html(l);let s=n.outerWidth();n.find("div.jfk-tooltip-arrow").css("left",s/2);let c=o.left+(e.outerWidth()-s)/2;c<2&&(c=2,n.find("div.jfk-tooltip-arrow").css("left",e.outerWidth()/2)),n.css({top:o.top+e.outerHeight()+1,left:c})},300))}).on("mouseout",e,function(t){o.hoverTipshowState=!1,clearTimeout(o.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")}).on("click",e,function(t){o.hoverTipshowState=!0,clearTimeout(o.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")})},popover:function(t,e,o,l,s,i){let c=n(),d=c.button,p=c.paint;null==s&&(s=d.close);let u='<div id="luckysheetpopover" class="luckysheetpopover"><div class="luckysheetpopover-content">'+p.start+'</div><div class="luckysheetpopover-btn">'+s+"</div></div>";$("#luckysheetpopover").remove(),$("body").append(u),$("#luckysheetpopover .luckysheetpopover-content").html(t);let h=$("#luckysheetpopover").outerWidth(),r=$("#luckysheetpopover").outerHeight(),a={};"topLeft"==e?(a.top="20px",a.left="20px"):"topCenter"==e?(a.top="20px",a.left="50%",a["margin-left"]=-h/2):"topRight"==e?(a.top="20px",a.right="20px"):"midLeft"==e?(a.top="50%",a["margin-top"]=-r/2,a.left="20px"):"center"==e?(a.top="50%",a["margin-top"]=-r/2,a.left="50%",a["margin-left"]=-h/2):"midRight"==e?(a.top="50%",a["margin-top"]=-r/2,a.right="20px"):"bottomLeft"==e?(a.bottom="20px",a.left="20px"):"bottomCenter"==e?(a.bottom="20px",a.left="50%",a["margin-left"]=-h/2):"bottomRight"==e?(a.bottom="20px",a.right="20px"):(a.top="20px",a.left="50%",a["margin-left"]=-h/2),"white"==l&&(a.background="rgba(255, 255, 255, 0.65)",a.color="#000",$("#luckysheetpopover .luckysheetpopover-btn").css({border:"1px solid #000"})),setTimeout(function(){$("#luckysheetpopover .luckysheetpopover-content").css({"margin-left":-$("#luckysheetpopover .luckysheetpopover-btn").outerWidth()/2})},1),$("#luckysheetpopover").css(a).fadeIn(),$("#luckysheetpopover .luckysheetpopover-btn").click(function(){"function"==typeof i&&i()}),null!=o&&"number"==typeof o&&setTimeout(function(){$("#luckysheetpopover").fadeOut().remove(),"function"==typeof i&&i()},o)}}});
//# sourceMappingURL=../sourcemaps/widgets/tooltip.js.map
