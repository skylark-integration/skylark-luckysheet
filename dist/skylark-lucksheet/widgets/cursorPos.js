/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../store"],function(e){"use strict";function t(e){let t;if(document.createRange)if(e.innerHTML!=e.innerText||""==e.innerHTML)e.focus(),(t=window.getSelection()).selectAllChildren(e),t.collapseToEnd();else{let n=e.innerText.length;(t=document.createRange()).selectNodeContents(e),t.setStart(e.childNodes[0],n),t.collapse(!0);let o=window.getSelection();o.removeAllRanges(),o.addRange(t)}else document.selection&&((t=document.body.createTextRange()).moveToElementText(e),t.collapse(!1),t.select())}function n(e){return e!==document.body&&document.body.contains(e)}return{luckysheetRangeLast:t,getCursortPosition:function(e){let t=0;if(document.selection){e.focus();let n=document.selection.createRange();n.moveStart("character",-e.value.length),t=n.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t},hideMenuByCancel:function(t){t.target.classList.contains("luckysheet-cols-rows-shift-left")||t.target.classList.contains("luckysheet-cols-rows-shift-right")||$(t.target).hasClass("luckysheet-mousedown-cancel")||0!=$(t.target).filter("[class*='sp-palette']").length||0!=$(t.target).filter("[class*='sp-thumb']").length||0!=$(t.target).filter("[class*='sp-']").length||($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide(),e.luckysheet_cols_menu_status=!1)},selectTextContent:function(e){if(window.getSelection){let o=document.createRange();var t=e.firstChild;o.setStart(t,0),o.setEnd(t,t.length),o.startContainer&&n(o.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(o))}else if(document.selection){let t=document.body.createTextRange();t.moveToElementText(e),t.select()}},selectTextDom:function(e){if(window.getSelection){let t=document.createRange();t.selectNodeContents(e),t.startContainer&&n(t.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(t))}else if(document.selection){let t=document.body.createTextRange();t.moveToElementText(e),t.select()}},selectTextContentCross:function(e,t){if(window.getSelection){let s=document.createRange();var o=e.firstChild,l=t.firstChild;s.setStart(o,0),s.setEnd(l,l.length),s.startContainer&&n(s.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(s))}},selectTextContentCollapse:function(e,t){if(window.getSelection){let l=document.createRange();var o=e.firstChild;t>o.length?t=o.length:t<0&&(t=0),l.setStart(o,t),l.collapse(!0),l.startContainer&&n(l.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(l))}},setCaretPosition:function(e,n,o){try{let l=e,s=document.createRange(),c=window.getSelection();s.setStart(l.childNodes[n],o),s.collapse(!0),c.removeAllRanges(),c.addRange(s),l.focus()}catch(e){t(this.rangeResizeTo[0])}}}});
//# sourceMappingURL=../sourcemaps/widgets/cursorPos.js.map
