/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./func","./matrix_methods","../methods/get","../methods/cells","../widgets/sparkline","../methods/formula_methods","../methods/func_methods","../methods/datecontroll","../methods/validate","../methods/format","../controllers/sort","../methods/getdata","../utils/util","../store","skylark-moment","../vendors/numeral"],function(e,t,n,a,o,i,l,u,f,h,s,v,g,m,p,y){"use strict";const{luckysheet_getcelldata:d,luckysheet_parseData:C,luckysheet_getValue:F}=e,{inverse:I}=t,{getSheetIndex:w,getluckysheetfile:D,getRangetxt:k}=n,{isdatetime:A,diff:V,isdatatype:P}=u,{isRealNum:b,isRealNull:M,valueIsError:S,error:E}=f,{genarate:R,update:N}=h,{orderbydata:_}=s,{getcellvalue:x}=v,{getObjType:L,ABCatNum:T,chatatABC:j,numFormat:O}=g;return{SUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else if(b(t))e.push(t);else{if("boolean"!=L(t))return i.error.v;"true"==t.toString().toLowerCase()?e.push(1):"false"==t.toString().toLowerCase()&&e.push(0)}}var n=0;if(e.length>0)for(r=0;r<e.length;r++){if(S(e[r]))return e[r];b(e[r])&&(n=luckysheet_calcADPMM(n,"+",e[r]))}return n}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},AVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else e=e.concat(t);else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"text",!0)):e.push(t)}var n=0,a=0;for(r=0;r<e.length;r++){if(S(e[r]))return e[r];if(!b(e[r]))return i.error.v;n=luckysheet_calcADPMM(n,"+",e[r]),a++}return 0==a?i.error.d:luckysheet_calcADPMM(n,"/",a)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},COUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else e=e.concat(t);else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"text",!0)):"boolean"==L(t)?"true"==t.toString().toLowerCase()?e.push(1):"false"==t.toString().toLowerCase()&&e.push(0):e.push(t)}var n=0;for(r=0;r<e.length;r++)b(e[r])&&n++;return n}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},COUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t))}else e=e.concat(t);else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"text",!0)):e.push(t)}return e.length}catch(r){return r=i.errorInfo(r),[i.error.v,r]}},MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else e=e.concat(t);else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"number",!0)):e.push(t)}var n=null;for(r=0;r<e.length;r++){if(S(e[r]))return e[r];b(e[r])&&((null==n||parseFloat(e[r])>n)&&(n=parseFloat(e[r])))}return null==n?0:n}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else e=e.concat(t);else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"number",!0)):e.push(t)}var n=null;for(r=0;r<e.length;r++){if(S(e[r]))return e[r];b(e[r])&&((null==n||parseFloat(e[r])<n)&&(n=parseFloat(e[r])))}return null==n?0:n}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},AGE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!window.luckysheet_function.ISIDCARD.f(e))return i.error.v;var t=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(e);if(S(t))return t;t=p(t);var n=p();if(2==arguments.length){if(n=l.getFirstValue(arguments[1]),S(n))return n;n=p(n)}var a=n.diff(t,"years");return a<0||"NaN"==a.toString()?i.error.v:a}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},SEX_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]).toString();return S(e)?e:window.luckysheet_function.ISIDCARD.f(e)?parseInt(e.substr(16,1))%2==1?"男":"女":i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},BIRTHDAY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]).toString();if(S(e))return e;if(!window.luckysheet_function.ISIDCARD.f(e))return i.error.v;var t="";if(15==e.length)t="19"+e.substring(6,8)+"/"+e.substring(8,10)+"/"+e.substring(10,12);else if(18==e.length){t=e.substring(6,10)+"/"+e.substring(10,12)+"/"+e.substring(12,14)}var n=0;if(null!=arguments[1]&&(n=l.getFirstValue(arguments[1]),S(n)))return n;if(!b(n))return i.error.v;if((n=parseInt(n))<0||n>2)return i.error.v;if(0==parseInt(n))return t;if(1==parseInt(n))return p(t).format("YYYY-MM-DD");if(2==parseInt(n))return p(t).format("YYYY年M月D日")}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},PROVINCE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]).toString();if(S(e))return e;if(!window.luckysheet_function.ISIDCARD.f(e))return i.error.v;var t="未知",n=i.classlist.province;return e.substring(0,2)in n&&(t=n[e.substring(0,2)]),t}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},CITY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]).toString();if(S(e))return e;if(!window.luckysheet_function.ISIDCARD.f(e))return i.error.v;var t=cityData.length,n="未知";for(r=0;r<t;r++)if(e.substring(0,6)==cityData[r].code){n=cityData[r].title;break}return n}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},STAR_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!window.luckysheet_function.ISIDCARD.f(e))return i.error.v;var t=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(e);if(S(t))return t;var n=(t=new Date(t)).getMonth(),a=t.getDate(),o=new Date(1999,n,a,0,0,0),u=[];u.push(["魔羯座",new Date(1999,0,1,0,0,0)]),u.push(["水瓶座",new Date(1999,0,20,0,0,0)]),u.push(["双鱼座",new Date(1999,1,19,0,0,0)]),u.push(["白羊座",new Date(1999,2,21,0,0,0)]),u.push(["金牛座",new Date(1999,3,21,0,0,0)]),u.push(["双子座",new Date(1999,4,21,0,0,0)]),u.push(["巨蟹座",new Date(1999,5,22,0,0,0)]),u.push(["狮子座",new Date(1999,6,23,0,0,0)]),u.push(["处女座",new Date(1999,7,23,0,0,0)]),u.push(["天秤座",new Date(1999,8,23,0,0,0)]),u.push(["天蝎座",new Date(1999,9,23,0,0,0)]),u.push(["射手座",new Date(1999,10,22,0,0,0)]),u.push(["魔羯座",new Date(1999,11,22,0,0,0)]);for(r=u.length-1;r>=0;r--)if(o>=u[r][1])return u[r][0];return"未找到匹配星座信息"}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},ANIMAL_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!window.luckysheet_function.ISIDCARD.f(e))return i.error.v;var t=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(e);if(S(t))return t;t=new Date(t);var n=new Array("猪","鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗"),a=(parseInt(t.getFullYear())+9)%12;return null==a||isNaN(a)?"未找到匹配生肖信息":n[a]}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},ISIDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;return!!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(e)}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},DM_TEXT_CUTWORD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=window.luckysheetCurrentFunction,a=l.getFirstValue(arguments[0],"text");if(S(a))return a;var o=0;return null!=arguments[1]&&(o=l.getFirstValue(arguments[1]),S(o))?o:b(o)?0!=(o=parseInt(o))&&1!=o&&2!=o?i.error.v:($.post("/dataqk/tu/api/cutword",{text:a,type:o},function(r){var a=[].concat(m.flowdata);i.execFunctionGroup(e,t,r),a[e][t]={v:r,f:n},m.refreshRange(a,[{row:[e,e],column:[t,t]}])}),"loading..."):i.error.v}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},DM_TEXT_TFIDF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=window.luckysheetCurrentFunction,a=l.getFirstValue(arguments[0],"text");if(S(a))return a;var o=20;if(null!=arguments[1]&&(o=l.getFirstValue(arguments[1]),S(o)))return o;if(!b(o))return i.error.v;o=parseInt(o);var u=0;return null!=arguments[2]&&(u=l.getFirstValue(arguments[2]),S(u))?u:b(u)?(u=parseInt(u),o<0?i.error.v:0!=u&&1!=u&&2!=u?i.error.v:($.post("/dataqk/tu/api/tfidf",{text:a,count:o,set:u},function(r){var a=m.deepCopyFlowData(m.flowdata);i.execFunctionGroup(e,t,r),a[e][t]={v:r,f:n},m.refreshRange(a,[{row:[e,e],column:[t,t]}])}),"loading...")):i.error.v}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},DM_TEXT_TEXTRANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=window.luckysheetCurrentFunction,a=l.getFirstValue(arguments[0],"text");if(S(a))return a;var o=20;if(null!=arguments[1]&&(o=l.getFirstValue(arguments[1]),S(o)))return o;if(!b(o))return i.error.v;o=parseInt(o);var u=0;return null!=arguments[2]&&(u=l.getFirstValue(arguments[2]),S(u))?u:b(u)?(u=parseInt(u),o<0?i.error.v:0!=u&&1!=u&&2!=u?i.error.v:($.post("/dataqk/tu/api/tfidf",{text:a,count:o,set:u},function(r){var a=m.deepCopyFlowData(m.flowdata);i.execFunctionGroup(e,t,r),a[e][t]={v:r,f:n},m.refreshRange(a,[{row:[e,e],column:[t,t]}])}),"loading...")):i.error.v}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},DATA_CN_STOCK_CLOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=window.luckysheetCurrentFunction,a=l.getFirstValue(arguments[0]);if(S(a))return a;var o=null;if(null!=arguments[1]){var u=arguments[1];if("array"==L(u))return i.error.v;if("object"==L(u)&&null!=u.startCell){if(null==u.data||"array"==L(u.data)||null==u.data.ct||"d"!=u.data.ct.t)return i.error.v;o=N("yyyy-mm-dd",u.data.v)}else o=u;if(!A(o))return[i.error.v,"日期错误"];o=p(o).format("YYYY-MM-DD")}var f=0;return null!=arguments[2]&&(f=l.getFirstValue(arguments[2]),S(f))?f:b(f)?0!=(f=parseInt(f))&&1!=f&&2!=f?i.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:o,price:f,type:"0"},function(r){var a=m.deepCopyFlowData(m.flowdata),o=O(r);null==o&&(o=r),i.execFunctionGroup(e,t,o),a[e][t]={v:o,f:n},m.refreshRange(a,[{row:[e,e],column:[t,t]}])}),"loading..."):i.error.v}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},DATA_CN_STOCK_OPEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=window.luckysheetCurrentFunction,a=l.getFirstValue(arguments[0]);if(S(a))return a;var o=null;if(null!=arguments[1]){var u=arguments[1];if("array"==L(u))return i.error.v;if("object"==L(u)&&null!=u.startCell){if(null==u.data||"array"==L(u.data)||null==u.data.ct||"d"!=u.data.ct.t)return i.error.v;o=N("yyyy-mm-dd",u.data.v)}else o=u;if(!A(o))return[i.error.v,"日期错误"];o=p(o).format("YYYY-MM-DD")}var f=0;return null!=arguments[2]&&(f=l.getFirstValue(arguments[2]),S(f))?f:b(f)?0!=(f=parseInt(f))&&1!=f&&2!=f?i.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:o,price:f,type:"1"},function(r){var a=m.deepCopyFlowData(m.flowdata);i.execFunctionGroup(e,t,r),a[e][t]={v:r,f:n},m.refreshRange(a,[{row:[e,e],column:[t,t]}])}),"loading..."):i.error.v}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},DATA_CN_STOCK_MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=window.luckysheetCurrentFunction,a=l.getFirstValue(arguments[0]);if(S(a))return a;var o=null;if(null!=arguments[1]){var u=arguments[1];if("array"==L(u))return i.error.v;if("object"==L(u)&&null!=u.startCell){if(null==u.data||"array"==L(u.data)||null==u.data.ct||"d"!=u.data.ct.t)return i.error.v;o=N("yyyy-mm-dd",u.data.v)}else o=u;if(!A(o))return[i.error.v,"日期错误"];o=p(o).format("YYYY-MM-DD")}var f=0;return null!=arguments[2]&&(f=l.getFirstValue(arguments[2]),S(f))?f:b(f)?0!=(f=parseInt(f))&&1!=f&&2!=f?i.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:o,price:f,type:"2"},function(r){var a=m.deepCopyFlowData(m.flowdata);i.execFunctionGroup(e,t,r),a[e][t]={v:r,f:n},m.refreshRange(a,[{row:[e,e],column:[t,t]}])}),"loading..."):i.error.v}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},DATA_CN_STOCK_MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=window.luckysheetCurrentFunction,a=l.getFirstValue(arguments[0]);if(S(a))return a;var o=null;if(null!=arguments[1]){var u=arguments[1];if("array"==L(u))return i.error.v;if("object"==L(u)&&null!=u.startCell){if(null==u.data||"array"==L(u.data)||null==u.data.ct||"d"!=u.data.ct.t)return i.error.v;o=N("yyyy-mm-dd",u.data.v)}else o=u;if(!A(o))return[i.error.v,"日期错误"];o=p(o).format("YYYY-MM-DD")}var f=0;return null!=arguments[2]&&(f=l.getFirstValue(arguments[2]),S(f))?f:b(f)?0!=(f=parseInt(f))&&1!=f&&2!=f?i.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:o,price:f,type:"3"},function(r){var a=m.deepCopyFlowData(m.flowdata);i.execFunctionGroup(e,t,r),a[e][t]={v:r,f:n},m.refreshRange(a,[{row:[e,e],column:[t,t]}])}),"loading..."):i.error.v}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},DATA_CN_STOCK_VOLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=window.luckysheetCurrentFunction,a=l.getFirstValue(arguments[0]);if(S(a))return a;var o=null;if(null!=arguments[1]){var u=arguments[1];if("array"==L(u))return i.error.v;if("object"==L(u)&&null!=u.startCell){if(null==u.data||"array"==L(u.data)||null==u.data.ct||"d"!=u.data.ct.t)return i.error.v;o=N("yyyy-mm-dd",u.data.v)}else o=u;if(!A(o))return[i.error.v,"日期错误"];o=p(o).format("YYYY-MM-DD")}var f=0;return null!=arguments[2]&&(f=l.getFirstValue(arguments[2]),S(f))?f:b(f)?0!=(f=parseInt(f))&&1!=f&&2!=f?i.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:o,price:f,type:"4"},function(r){var a=m.deepCopyFlowData(m.flowdata);i.execFunctionGroup(e,t,r),a[e][t]={v:r,f:n},m.refreshRange(a,[{row:[e,e],column:[t,t]}])}),"loading..."):i.error.v}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},DATA_CN_STOCK_AMOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=window.luckysheetCurrentFunction,a=l.getFirstValue(arguments[0]);if(S(a))return a;var o=null;if(null!=arguments[1]){var u=arguments[1];if("array"==L(u))return i.error.v;if("object"==L(u)&&null!=u.startCell){if(null==u.data||"array"==L(u.data)||null==u.data.ct||"d"!=u.data.ct.t)return i.error.v;o=N("yyyy-mm-dd",u.data.v)}else o=u;if(!A(o))return[i.error.v,"日期错误"];o=p(o).format("YYYY-MM-DD")}var f=0;return null!=arguments[2]&&(f=l.getFirstValue(arguments[2]),S(f))?f:b(f)?0!=(f=parseInt(f))&&1!=f&&2!=f?i.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:o,price:f,type:"5"},function(r){var a=m.deepCopyFlowData(m.flowdata);i.execFunctionGroup(e,t,r),a[e][t]={v:r,f:n},m.refreshRange(a,[{row:[e,e],column:[t,t]}])}),"loading..."):i.error.v}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},ISDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:A(e)}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},SUMIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=0,t=arguments[0].data,n=arguments[0].rowl,a=arguments[0].coll,o=C(arguments[1]);if(t=i.getRangeArray(t)[0],arguments[2]){var l=[],u=arguments[2].startCell,f=arguments[2].rowl,h=arguments[2].coll,s=arguments[2].sheetName;if(n==f&&a==h)l=arguments[2].data;else{var v=[],c=[];v[0]=parseInt(u.replace(/[^0-9]/g,""))-1,c[0]=T(u.replace(/[^A-Za-z]/g,"")),v[1]=v[0]+n-1,c[1]=c[0]+a-1;var g=j(c[1]),m=v[1]+1;l=d(s+"!"+u+":"+(g+m)).data}l=i.getRangeArray(l)[0];for(r=0;r<t.length;r++){if((p=t[r])&&i.acompareb(p,o)){if(!b(l[r]))continue;e=luckysheet_calcADPMM(e,"+",l[r])}}}else for(r=0;r<t.length;r++){var p;if((p=t[r])&&i.acompareb(p,o)){if(!b(p))continue;e=luckysheet_calcADPMM(e,"",p)}}return e}catch(r){var y=r;return y=i.errorInfo(y),[i.error.v,y]}},TAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),Math.tan(e)):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},TANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=Math.exp(2*e);return(t-1)/(t+1)}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},CEILING:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?0==(t=parseFloat(t))?0:e>0&&t<0?i.error.nm:Math.ceil(e/t)*t:i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ATAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),Math.atan(e)):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},ASINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),Math.log(e+Math.sqrt(e*e+1))):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},ABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),Math.abs(e)):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},ACOS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))<-1||e>1?i.error.nm:Math.acos(e):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},ACOSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))<1?i.error.nm:Math.log(e+Math.sqrt(e*e-1)):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},MULTINOMIAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"number",!0)):e.push(t)}var n=0,a=1;for(r=0;r<e.length;r++){var o=e[r];if(!b(o))return i.error.v;if((o=parseFloat(o))<0)return i.error.nm;n+=o,a*=l.factorial(o)}return l.factorial(n)/a}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},ATANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))<=-1||e>=1?i.error.nm:Math.log((1+e)/(1-e))/2:i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},ATAN2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseFloat(t),0==e&&0==t?i.error.d:Math.atan2(t,e)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},COUNTBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=0;if("object"==L(e)&&null!=e.startCell){if(null==e.data)return 1;if("array"==L(e.data))for(var n=0;n<e.data.length;n++)for(var a=0;a<e.data[n].length;a++)(null==e.data[n][a]||M(e.data[n][a].v))&&t++;else M(e.data.v)&&t++}return t}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},COSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),(Math.exp(e)+Math.exp(-e))/2):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},INT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0];if("array"==L(e))return"array"==L(e[0])?l.isDyadicArr(e)&&b(e[0][0])?Math.floor(parseFloat(e[0][0])):i.error.v:b(e[0])?Math.floor(parseFloat(e[0])):i.error.v;if("object"==L(e)&&null!=e.startCell){if(e.coll>1)return i.error.v;if(e.rowl>1){var t=i.getcellrange(e.startCell).row[0];if(window.luckysheetCurrentRow<t||window.luckysheetCurrentRow>t+e.rowl-1)return i.error.v;var n=e.data[window.luckysheetCurrentRow-t][0]}else n=e.data;return null==n||M(n.v)?0:b(n.v)?Math.floor(parseFloat(n.v)):i.error.v}if("boolean"==L(e)){if("true"==e.toString().toLowerCase())return 1;if("false"==e.toString().toLowerCase())return 0}return b(e)?Math.floor(parseFloat(e)):i.error.v}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},ISEVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseInt(e),!(1&Math.abs(e))):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},ISODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseInt(e),!!(1&Math.abs(e))):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},LCM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t))}else e=e.concat(t);else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"number",!0)):e.push(t)}for(var n=0;n<e.length;n++){var a=e[n];if(!b(a))return i.error.v;if((a=parseInt(a))<0)return i.error.nm;e[n]=a}for(var o,u,f,h=1;void 0!==(u=e.pop());)for(0==u&&(h=0);u>1;){if(u%2){for(r=3,o=Math.floor(Math.sqrt(u));r<=o&&u%r;r+=2);f=r<=o?r:u}else f=2;for(u/=f,h*=f,r=e.length;r;e[--r]%f==0&&1==(e[r]/=f)&&e.splice(r,1));}return h>=Math.pow(2,53)?i.error.nm:h}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},LN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))<=0?i.error.nm:Math.log(e):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},LOG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;if((e=parseFloat(e))<=0)return i.error.nm;if(2==arguments.length){var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;if((t=parseFloat(t))<=0)return i.error.nm}else t=10;return Math.log(e)/Math.log(t)}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},LOG10:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))<=0?i.error.nm:Math.log(e)/Math.log(10):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},MOD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;if(0==(t=parseFloat(t)))return i.error.d;var n=Math.abs(e%t);return t>0?n:-n}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},MROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?e*(t=parseFloat(t))<0?i.error.nm:Math.round(e/t)*t:i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},SUMSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"number",!0)):e.push(t)}var n=0;if(e.length>0)for(r=0;r<e.length;r++){var a=e[r];if(!b(a))return i.error.v;n+=(a=parseFloat(a))*a}return n}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},COMBIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t),e<0||t<0||e<t?i.error.nm:l.factorial(e)/(l.factorial(t)*l.factorial(e-t))):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},SUBTOTAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=[];for(r=0;r<t.length;r++){for(var n=[],a=0;a<t[r].length;a++)n.push(t[r][a]);e.push(n)}}else{e=[];for(r=0;r<t.length;r++)e.push(t[r])}else e="object"==L(t)&&null!=t.startCell?l.getFirstValue(t):t;var o=Array.prototype.slice.apply(arguments);if(o.shift(),"array"==L(e)){var u=[];if("array"==L(e[0]))for(r=0;r<e.length;r++){for(n=[],a=0;a<e[r].length;a++){var f=e[r][a];S(f)?n.push(f):b(f)?(f=parseInt(f))<1||f>111||f>11&&f<101?n.push(i.error.v):n.push(h(f)):n.push(i.error.v)}u.push(n)}else for(r=0;r<e.length;r++){f=e[r];S(f)?u.push(f):b(f)?(f=parseInt(f))<1||f>111||f>11&&f<101?u.push(i.error.v):u.push(h(f)):u.push(i.error.v)}return u}return S(e)?e:b(e)?(e=parseInt(e))<1||e>111||e>11&&e<101?i.error.v:h(e):i.error.v;function h(r){switch(r){case 1:case 101:return window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o);case 2:case 102:return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,o);case 3:case 103:return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,o);case 4:case 104:return window.luckysheet_function.MAX.f.apply(window.luckysheet_function.MAX,o);case 5:case 105:return window.luckysheet_function.MIN.f.apply(window.luckysheet_function.MIN,o);case 6:case 106:return window.luckysheet_function.PRODUCT.f.apply(window.luckysheet_function.PRODUCT,o);case 7:case 107:return window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,o);case 8:case 108:return window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,o);case 9:case 109:return window.luckysheet_function.SUM.f.apply(window.luckysheet_function.SUM,o);case 10:case 110:return window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,o);case 11:case 111:return window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,o)}}}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},ASIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))<-1||e>1?i.error.nm:Math.asin(e):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},COUNTIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("object"!=L(t)||null==t.startCell)return i.error.v;e=t.data;var n,a=arguments[1];if("array"==L(a))if(n=[],"array"==L(a[0])){if(!l.isDyadicArr(a))return i.error.v;for(r=0;r<a.length;r++){for(var o=[],u=0;u<a[r].length;u++)o.push(a[r][u]);n.push(o)}}else for(r=0;r<a.length;r++)n.push(a[r]);else if("object"==L(a)&&null!=a.startCell){if(a.rowl>1||a.coll>1)return 0;n=a.data.v}else n=a;if("array"==L(n)){var f=[];if("array"==L(n[0]))for(r=0;r<n.length;r++){for(o=[],u=0;u<n[r].length;u++)o.push(h(e,n[r][u]));f.push(o)}else for(r=0;r<n.length;r++)f.push(h(e,n[r]));return f}return h(e,n);function h(r,e){/[<>=!*?]/.test(e)||(e='=="'+e+'"'),e=e.replace("<>","!=");var t=0;if("array"==L(r)){for(var n=0;n<r.length;n++)for(var a=0;a<r[n].length;a++)if(null!=r[n][a]&&!M(r[n][a].v)){var o=r[n][a].v;e.indexOf("*")>-1||e.indexOf("?")>-1?i.isWildcard(o,e)&&t++:"string"!=typeof o?new Function("return "+o+e)()&&t++:new Function('return "'+o+'"'+e)()&&t++}}else if(null!=r&&!M(r.v)){o=r.v;e.indexOf("*")>-1||e.indexOf("?")>-1?i.isWildcard(o,e)&&t++:"string"!=typeof o?new Function("return "+o+e)()&&t++:new Function('return "'+o+'"'+e)()&&t++}return t}}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},RADIANS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))*Math.PI/180:i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},RAND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;try{return Math.floor(1e9*Math.random())/1e9}catch(e){var r=e;return r=i.errorInfo(r),[i.error.v,r]}},COUNTUNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"text",!0)):e.push(t)}return window.luckysheet_function.UNIQUE.f(e)}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},DEGREES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?180*(e=parseFloat(e))/Math.PI:i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},ERFC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),jStat.erfc(e)):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},EVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=Math.ceil(Math.abs(e));return t=1&t?t+1:t,e>0?t:-t}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},EXP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),Math.exp(e)):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},FACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e)){if("boolean"!=L(e))return i.error.v;"true"==e.toString().toLowerCase()?e=1:"false"==e.toString().toLowerCase()&&(e=0)}return(e=parseInt(e))<0?i.error.nm:l.factorial(e)}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},FACTDOUBLE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e)){if("boolean"!=L(e))return i.error.v;"true"==e.toString().toLowerCase()?e=1:"false"==e.toString().toLowerCase()&&(e=0)}return(e=parseInt(e))<0?i.error.nm:l.factorialDouble(e)}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},PI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;try{return Math.PI}catch(e){var r=e;return r=i.errorInfo(r),[i.error.v,r]}},FLOOR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;if(0==(t=parseFloat(t)))return i.error.d;if(e>0&&t<0)return i.error.nm;var n=-Math.floor(Math.log(Math.abs(t))/Math.log(10));return e>=0?Math.floor(e/t)*t*Math.pow(10,n)/Math.pow(10,n):-Math.ceil(Math.abs(e)/t)*t*Math.pow(10,n)/Math.pow(10,n)}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},GCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!1))}else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"number",!1)):e.push(t)}if(!b(e[0]))return i.error.v;var n=parseInt(e[0]);if(n<0||n>=Math.pow(2,53))return i.error.nm;for(r=1;r<e.length;r++){var a=e[r];if(!b(a))return i.error.v;if((a=parseInt(a))<0||a>=Math.pow(2,53))return i.error.nm;for(;n&&a;)n>a?n%=a:a%=n;n+=a}return n}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},RANDBETWEEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?e>(t=parseInt(t))?i.error.nm:e+Math.ceil((t-e+1)*Math.random())-1:i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t),(e>0?1:-1)*Math.round(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ROUNDDOWN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t),(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ROUNDUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t),(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},SERIESSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=arguments[3],o=[];if("array"==L(a)){if("array"==L(a[0])&&!l.isDyadicArr(a))return i.error.v;o=o.concat(l.getDataArr(a,!1))}else"object"==L(a)&&null!=a.startCell?o=o.concat(l.getCellDataArr(a,"number",!1)):o.push(a);if(!b(o[0]))return i.error.v;var u=parseFloat(o[0])*Math.pow(e,t);for(r=1;r<o.length;r++){var f=o[r];if(!b(f))return i.error.v;u+=(f=parseFloat(f))*Math.pow(e,t+r*n)}return u}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},SIGN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;if((e=parseFloat(e))>0)return 1;if(0==e)return 0;if(e<0)return-1}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},SIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),Math.sin(e)):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},SINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),(Math.exp(e)-Math.exp(-e))/2):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},SQRT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))<0?i.error.nm:Math.sqrt(e):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},SQRTPI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))<0?i.error.nm:Math.sqrt(e*Math.PI):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},GAMMALN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))<=0?i.error.nm:jStat.gammaln(e):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},COS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),Math.cos(e)):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},TRUNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;if(e=parseFloat(e),2==arguments.length){var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}else t=0;return(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},QUOTIENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?0==(t=parseFloat(t))?i.error.d:parseInt(e/t,10):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},POWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseFloat(t),0==e&&0==t?i.error.nm:e<0&&t.toString().indexOf(".")>-1?i.error.nm:Math.pow(e,t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},SUMIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=0,t=arguments;F(t);var n=i.getRangeArray(t[0])[0],a=new Array(n.length);for(r=0;r<a.length;r++)a[r]=!0;for(r=1;r<t.length;r+=2)for(var o=i.getRangeArray(t[r])[0],l=t[r+1],u=0;u<o.length;u++){var f=o[u];a[u]=a[u]&&!!f&&i.acompareb(f,l)}for(r=0;r<n.length;r++)a[r]&&(e=luckysheet_calcADPMM(e,"+",n[r]));return e}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},COUNTIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments;F(e);var t=new Array(i.getRangeArray(e[0])[0].length);for(r=0;r<t.length;r++)t[r]=!0;for(r=0;r<e.length;r+=2)for(var n=i.getRangeArray(e[r])[0],a=e[r+1],o=0;o<n.length;o++){var l=n[o];t[o]=t[o]&&!!l&&i.acompareb(l,a)}var u=0;for(r=0;r<t.length;r++)t[r]&&u++;return u}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},PRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"number",!0)):e.push(t)}var n=1;for(r=0;r<e.length;r++){var a=e[r];if(!b(a))return i.error.v;n*=a=parseFloat(a)}return n}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},HARMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"number",!0)):e.push(t)}var n=0,a=0;for(r=0;r<e.length;r++){var o=e[r];if(!b(o))return i.error.v;if((o=parseFloat(o))<=0)return i.error.nm;n+=1/o,a++}return a/n}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},HYPGEOMDIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseInt(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseInt(a);var o=l.getCellBoolen(arguments[4]);if(S(o))return o;if(e<0||e>Math.min(t,n)||e<Math.max(0,t-a+n))return i.error.nm;if(t<=0||t>a)return i.error.nm;if(n<=0||n>a)return i.error.nm;if(a<=0)return i.error.nm;function u(r,e,t,n){return l.factorial(t)/(l.factorial(r)*l.factorial(t-r))*(l.factorial(n-t)/(l.factorial(e-r)*l.factorial(n-t-e+r)))/(l.factorial(n)/(l.factorial(e)*l.factorial(n-e)))}return o?function(r,e,t,n){for(var a=0,o=0;o<=r;o++)a+=u(o,e,t,n);return a}(e,t,n,a):u(e,t,n,a)}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},INTERCEPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"text",!1)):t.push(e);var n=arguments[1],a=[];if("array"==L(n)){if("array"==L(n[0])&&!l.isDyadicArr(n))return i.error.v;a=a.concat(l.getDataArr(n,!1))}else"object"==L(n)&&null!=n.startCell?a=a.concat(l.getCellDataArr(n,"text",!1)):a.push(n);if(t.length!=a.length)return i.error.na;var o=[],u=[];for(r=0;r<t.length;r++){var f=t[r],h=a[r];b(f)&&b(h)&&(o.push(parseFloat(f)),u.push(parseFloat(h)))}if(0==l.variance_s(u))return i.error.d;var s=jStat.mean(u),v=jStat.mean(o),c=u.length,g=0,m=0;for(r=0;r<c;r++)g+=(u[r]-s)*(o[r]-v),m+=Math.pow(u[r]-s,2);var p=g/m;return v-p*s+0*p}catch(r){var y=r;return y=i.errorInfo(y),[i.error.v,y]}},KURT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"text",!0)):e.push(t)}for(var n=[],a=0;a<e.length;a++){var o=e[a];if(!b(o))return i.error.v;o=parseFloat(o),n.push(o)}if(n.length<4||0==l.standardDeviation_s(n))return i.error.d;var u=jStat.mean(n),f=n.length,h=0;for(r=0;r<f;r++)h+=Math.pow(n[r]-u,4);return f*(f+1)/((f-1)*(f-2)*(f-3))*(h/=Math.pow(jStat.stdev(n,!0),4))-3*(f-1)*(f-1)/((f-2)*(f-3))}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},LARGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];if("array"==L(arguments[0])){if("array"==L(arguments[0][0])&&!l.isDyadicArr(arguments[0]))return i.error.v;e=e.concat(l.getDataArr(arguments[0],!0))}else"object"==L(arguments[0])&&null!=arguments[0].startCell?e=e.concat(l.getCellDataArr(arguments[0],"text",!0)):e.push(arguments[0]);for(var t=[],n=0;n<e.length;n++){var a=e[n];if(!b(a))return i.error.v;a=parseFloat(a),t.push(a)}if("array"==L(arguments[1])){if("array"==L(arguments[1][0])&&!l.isDyadicArr(arguments[1]))return i.error.v;u=l.getDataArr(arguments[1])}else if("object"==L(arguments[1])&&null!=arguments[1].startCell){if(arguments[1].rowl>1||arguments[1].coll>1)return i.error.v;var o=arguments[1].data;if(null==o||M(o.v))var u=0;else u=o.v}else u=arguments[1];if("array"==L(u)){if(0==t.length)return i.error.nm;var f=[];for(r=0;r<u.length;r++)b(u[r])?(u[r]=Math.ceil(parseFloat(u[r])),u[r]<=0||u[r]>t.length?f.push(i.error.nm):f.push(e.sort(function(r,e){return e-r})[u[r]-1])):f.push(i.error.v);return f}return b(u)?(u=Math.ceil(parseFloat(u)),0==t.length?i.error.nm:u<=0||u>t.length?i.error.nm:e.sort(function(r,e){return e-r})[u-1]):i.error.v}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},STDEVA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!1))}else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"text",!1)):e.push(t)}for(var n=[],a=0;a<e.length;a++){var o=e[a];o=b(o)?parseFloat(o):"true"==o.toString().toLowerCase()?1:0,n.push(o)}return 0==n.length?0:1==n.length?i.error.d:l.standardDeviation_s(n)}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},STDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else"object"==L(t)&&null!=t.startCell?e=e.concat(l.getCellDataArr(t,"text",!0)):e.push(t)}for(var n=[],a=0;a<e.length;a++){var o=e[a];if(!b(o))return i.error.v;o=parseFloat(o),n.push(o)}return 0==n.length?0:1==n.length?i.error.d:l.standardDeviation(n)}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},GEOMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"text",!0));else if("boolean"==L(t))"true"==t.toString().toLowerCase()?e.push(1):"false"==t.toString().toLowerCase()&&e.push(0);else{if(!b(t))return i.error.v;e.push(t)}}for(var n=[],a=0;a<e.length;a++){var o=e[a];if(b(o)){if((o=parseFloat(o))<=0)return i.error.nm;n.push(o)}}return 0==n.length?i.error.nm:jStat.geomean(n)}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},RANK_EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=arguments[1],n=[];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;n=n.concat(l.getDataArr(t,!0))}else"object"==L(t)&&null!=t.startCell?n=n.concat(l.getCellDataArr(t,"number",!0)):n.push(t);for(var a=[],o=0;o<n.length;o++){var u=n[o];if(!b(u))return i.error.v;u=parseFloat(u),a.push(u)}if(3==arguments.length){var f=l.getCellBoolen(arguments[2]);if(S(f))return f}else f=!1;var h=f?function(r,e){return r-e}:function(r,e){return e-r},s=(a=a.sort(h)).indexOf(e);return-1==s?i.error.na:s+1}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},RANK_AVG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=arguments[1],n=[];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;n=n.concat(l.getDataArr(t,!0))}else"object"==L(t)&&null!=t.startCell?n=n.concat(l.getCellDataArr(t,"number",!0)):n.push(t);for(var a=[],o=0;o<n.length;o++){var u=n[o];if(!b(u))return i.error.v;u=parseFloat(u),a.push(u)}if(3==arguments.length){var f=l.getFirstValue(arguments[2]);if(S(f))return f;if("boolean"==L(f));else if("string"!=L(f)||"true"!=f.toLowerCase()&&"false"!=f.toLowerCase()){if(!b(f))return i.error.v;f=0!=(f=parseFloat(f))}else"true"==f.toLowerCase()&&(f=!0),"false"==f.toLowerCase()&&(f=!1)}else f=!1;var h=f?function(r,e){return r-e}:function(r,e){return e-r};a=a.sort(h);var s=0;for(r=0;r<a.length;r++)a[r]==e&&s++;return s>1?(2*a.indexOf(e)+s+1)/2:a.indexOf(e)+1}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},PERCENTRANK_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!0))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"number",!0)):t.push(e);for(var n=[],a=0;a<t.length;a++){var o=t[a];if(!b(o))return i.error.v;o=parseFloat(o),n.push(o)}var u=l.getFirstValue(arguments[1]);if(S(u))return u;if(!b(u))return i.error.v;if(u=parseFloat(u),3==arguments.length){var f=l.getFirstValue(arguments[2]);if(S(f))return f;if(!b(f))return i.error.v;f=parseInt(f)}else f=3;if(0==n.length)return i.error.nm;if(f<1)return i.error.nm;if(1==n.length&&n[0]==u)return 1;n=n.sort(function(r,e){return r-e});var h=window.luckysheet_function.UNIQUE.f(n)[0],s=n.length,v=h.length,c=Math.pow(10,f),g=0,m=!1;for(r=0;!m&&r<v;)u===h[r]?(g=(n.indexOf(h[r])+1)/(s+1),m=!0):u>=h[r]&&(u<h[r+1]||r===v-1)&&(g=(n.lastIndexOf(h[r])+1+(u-h[r])/(h[r+1]-h[r]))/(s+1),m=!0),r++;return isNaN(g)?i.error.na:Math.floor(g*c)/c}catch(r){var p=r;return p=i.errorInfo(p),[i.error.v,p]}},PERCENTRANK_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!0))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"number",!0)):t.push(e);for(var n=[],a=0;a<t.length;a++){var o=t[a];if(!b(o))return i.error.v;o=parseFloat(o),n.push(o)}var u=l.getFirstValue(arguments[1]);if(S(u))return u;if(!b(u))return i.error.v;if(u=parseFloat(u),3==arguments.length){var f=l.getFirstValue(arguments[2]);if(S(f))return f;if(!b(f))return i.error.v;f=parseInt(f)}else f=3;if(0==n.length)return i.error.nm;if(f<1)return i.error.nm;if(1==n.length&&n[0]==u)return 1;n=n.sort(function(r,e){return r-e});var h=window.luckysheet_function.UNIQUE.f(n)[0],s=n.length,v=h.length,c=Math.pow(10,f),g=0,m=!1;for(r=0;!m&&r<v;)u===h[r]?(g=n.indexOf(h[r])/(s-1),m=!0):u>=h[r]&&(u<h[r+1]||r===v-1)&&(g=(n.lastIndexOf(h[r])+(u-h[r])/(h[r+1]-h[r]))/(s-1),m=!0),r++;return isNaN(g)?i.error.na:Math.floor(g*c)/c}catch(r){var p=r;return p=i.errorInfo(p),[i.error.v,p]}},FORECAST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=arguments[1],n=[];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;n=n.concat(l.getDataArr(t,!1))}else"object"==L(t)&&null!=t.startCell?n=n.concat(l.getCellDataArr(t,"text",!1)):n.push(t);var a=arguments[2],o=[];if("array"==L(a)){if("array"==L(a[0])&&!l.isDyadicArr(a))return i.error.v;o=o.concat(l.getDataArr(a,!1))}else"object"==L(a)&&null!=a.startCell?o=o.concat(l.getCellDataArr(a,"text",!1)):o.push(a);if(n.length!=o.length)return i.error.na;var u=[],f=[];for(r=0;r<n.length;r++){var h=n[r],s=o[r];b(h)&&b(s)&&(u.push(parseFloat(h)),f.push(parseFloat(s)))}if(0==l.variance_s(f))return i.error.d;var v=jStat.mean(f),c=jStat.mean(u),g=f.length,m=0,p=0;for(r=0;r<g;r++)m+=(f[r]-v)*(u[r]-c),p+=Math.pow(f[r]-v,2);var y=m/p;return c-y*v+y*e}catch(r){var d=r;return d=i.errorInfo(d),[i.error.v,d]}},FISHERINV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=Math.exp(2*e);return(t-1)/(t+1)}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},FISHER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))<=-1||e>=1?i.error.nm:Math.log((1+e)/(1-e))/2:i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},MODE_SNGL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else{if(!b(t))return i.error.v;e.push(t)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)&&n.push(parseFloat(a))}var o,u={},f=[],h=0;for(r=0;r<n.length;r++)u[o=n[r]]=u[o]?u[o]+1:1,u[o]>h&&(h=u[o],f=[]),u[o]==h&&(f[f.length]=o);if(h<=1)return i.error.na;for(var s=n.indexOf(f[0]),v=0;v<f.length;v++){var c=n.indexOf(f[v]);c<s&&(s=c)}return n[s]}catch(r){var g=r;return g=i.errorInfo(g),[i.error.v,g]}},WEIBULL_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getCellBoolen(arguments[3]);return S(a)?a:e<0||t<=0||n<=0?i.error.nm:a?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},AVEDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else{if(!b(t))return i.error.v;e.push(t)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)&&n.push(parseFloat(a))}return 0==n.length?i.error.nm:jStat.sum(jStat(n).subtract(jStat.mean(n)).abs()[0])/n.length}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},AVERAGEA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!1))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else if("true"==o.toString.toLowerCase())e.push(1);else if("false"==o.toString.toLowerCase())e.push(0);else{if(!b(t))return i.error.v;e.push(t)}}var n=0,a=0;for(r=0;r<e.length;r++){var o=e[r];b(o)?n+=parseFloat(o):"true"==o.toString().toLowerCase()?n+=1:n+=0,a++}return 0==a?i.error.d:n/a}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},BINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getCellBoolen(arguments[3]);return S(a)?a:e<0||e>t?i.error.nm:n<0||n>1?i.error.nm:a?jStat.binomial.cdf(e,t,n):jStat.binomial.pdf(e,t,n)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},BINOM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;if(n=parseFloat(n),e<0)return i.error.nm;if(t<0||t>1)return i.error.nm;if(n<0||n>1)return i.error.nm;for(var a=0;a<=e;){if(jStat.binomial.cdf(a,e,t)>=n)return a;a++}}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},CONFIDENCE_NORM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);return S(n)?n:b(n)?(n=parseInt(n),e<=0||e>=1?i.error.nm:t<=0?i.error.nm:n<1?i.error.nm:jStat.normalci(1,e,t,n)[1]-1):i.error.v}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},CORREL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"text",!1)):t.push(e);var n=arguments[1],a=[];if("array"==L(n)){if("array"==L(n[0])&&!l.isDyadicArr(n))return i.error.v;a=a.concat(l.getDataArr(n,!1))}else"object"==L(n)&&null!=n.startCell?a=a.concat(l.getCellDataArr(n,"text",!1)):a.push(n);if(t.length!=a.length)return i.error.na;var o=[],u=[];for(r=0;r<t.length;r++){var f=t[r],h=a[r];b(f)&&b(h)&&(o.push(parseFloat(f)),u.push(parseFloat(h)))}return 0==o.length||0==u.length||0==l.standardDeviation(o)||0==l.standardDeviation(u)?i.error.d:jStat.corrcoeff(o,u)}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},COVARIANCE_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"text",!1)):t.push(e);var n=arguments[1],a=[];if("array"==L(n)){if("array"==L(n[0])&&!l.isDyadicArr(n))return i.error.v;a=a.concat(l.getDataArr(n,!1))}else"object"==L(n)&&null!=n.startCell?a=a.concat(l.getCellDataArr(n,"text",!1)):a.push(n);if(t.length!=a.length)return i.error.na;var o=[],u=[];for(r=0;r<t.length;r++){var f=t[r],h=a[r];b(f)&&b(h)&&(o.push(parseFloat(f)),u.push(parseFloat(h)))}if(0==o.length||0==u.length)return i.error.d;var s=jStat.mean(o),v=jStat.mean(u),c=0;for(r=0;r<o.length;r++)c+=(o[r]-s)*(u[r]-v);return c/=o.length}catch(r){var g=r;return g=i.errorInfo(g),[i.error.v,g]}},COVARIANCE_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"text",!1)):t.push(e);var n=arguments[1],a=[];if("array"==L(n)){if("array"==L(n[0])&&!l.isDyadicArr(n))return i.error.v;a=a.concat(l.getDataArr(n,!1))}else"object"==L(n)&&null!=n.startCell?a=a.concat(l.getCellDataArr(n,"text",!1)):a.push(n);if(t.length!=a.length)return i.error.na;var o=[],u=[];for(r=0;r<t.length;r++){var f=t[r],h=a[r];b(f)&&b(h)&&(o.push(parseFloat(f)),u.push(parseFloat(h)))}return 0==o.length||0==u.length?i.error.d:jStat.covariance(o,u)}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},DEVSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else if(b(t))e.push(t);else{if("boolean"!=L(t))return i.error.v;"true"==t.toString().toLowerCase()?e.push(1):"false"==t.toString().toLowerCase()&&e.push(0)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)&&n.push(parseFloat(a))}var o=jStat.mean(n),u=0;for(r=0;r<n.length;r++)u+=Math.pow(n[r]-o,2);return u}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},EXPON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getCellBoolen(arguments[2]);return S(n)?n:e<0?i.error.nm:t<0?i.error.nm:n?jStat.exponential.cdf(e,t):jStat.exponential.pdf(e,t)}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},AVERAGEIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=0,t=0,n=arguments[0].data,a=arguments[0].rowl,o=arguments[0].coll,l=C(arguments[1]),u=[];if(arguments[2]){var f=arguments[2].startCell,h=arguments[2].rowl,s=arguments[2].coll,v=arguments[2].sheetName;if(a==h&&o==s)u=arguments[2].data;else{var c=[],g=[];c[0]=parseInt(f.replace(/[^0-9]/g,""))-1,g[0]=T(f.replace(/[^A-Za-z]/g,"")),c[1]=c[0]+a-1,g[1]=g[0]+o-1;var m=j(g[1]),p=c[1]+1;u=d(v+"!"+f+":"+(m+p)).data}u=i.getRangeArray(u)[0]}n=i.getRangeArray(n)[0];for(r=0;r<n.length;r++){var y=n[r];if(y&&i.acompareb(y,l)){var F=u[r]||y;if(!b(F))continue;e+=parseFloat(F),t++}}return 0==e||0==t?i.error.d:O(e/t)}catch(r){var I=r;return I=i.errorInfo(I),[i.error.v,I]}},AVERAGEIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=0,t=0,n=arguments;F(n);var a=i.getRangeArray(n[0])[0],o=new Array(a.length);for(r=0;r<o.length;r++)o[r]=!0;for(r=1;r<n.length;r+=2)for(var l=i.getRangeArray(n[r])[0],u=n[r+1],f=0;f<l.length;f++){var h=l[f];o[f]=o[f]&&!!h&&i.acompareb(h,u)}for(r=0;r<a.length;r++)o[r]&&b(a[r])&&(e+=parseFloat(a[r]),t++);return 0==e||0==t?i.error.d:O(e/t)}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},PERMUT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t),e<=0||t<0?i.error.nm:e<t?i.error.nm:l.factorial(e)/l.factorial(e-t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},TRIMMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"number",!1)):t.push(e);var n=[];for(r=0;r<t.length;r++){var a=t[r];b(a)&&n.push(parseFloat(a))}var o=l.getFirstValue(arguments[1]);if(S(o))return o;if(!b(o))return i.error.v;if(o=parseFloat(o),0==n.length)return i.error.nm;if(o<0||o>1)return i.error.nm;n.sort(function(r,e){return r-e});var u=window.luckysheet_function.FLOOR.f(n.length*o,2)/2,f=(s=n,v=(v=u)||1,s&&"function"==typeof s.slice?s.slice(v):s);return f=function(r,e){return e=e||1,r&&"function"==typeof r.slice?r.slice(0,r.length-e):r}(f,u),f=jStat.mean(f)}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}var s,v},PERCENTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"number",!1)):t.push(e);var n=[];for(r=0;r<t.length;r++){var a=t[r];b(a)&&n.push(parseFloat(a))}var o=l.getFirstValue(arguments[1]);if(S(o))return o;if(!b(o))return i.error.v;if(o=parseFloat(o),0==n.length)return i.error.nm;if(o<=0||o>=1)return i.error.nm;var u=(n=n.sort(function(r,e){return r-e})).length;if(o<1/(u+1)||o>1-1/(u+1))return i.error.nm;var f=o*(u+1)-1,h=Math.floor(f);return f===h?n[f]:n[h]+(f-h)*(n[h+1]-n[h])}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},PERCENTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"number",!1)):t.push(e);var n=[];for(r=0;r<t.length;r++){var a=t[r];b(a)&&n.push(parseFloat(a))}var o=l.getFirstValue(arguments[1]);if(S(o))return o;if(!b(o))return i.error.v;if(o=parseFloat(o),0==n.length)return i.error.nm;if(o<0||o>1)return i.error.nm;var u=o*((n=n.sort(function(r,e){return r-e})).length-1),f=Math.floor(u);return u===f?n[u]:n[f]+(u-f)*(n[f+1]-n[f])}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},PEARSON:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"text",!1)):t.push(e);var n=arguments[1],a=[];if("array"==L(n)){if("array"==L(n[0])&&!l.isDyadicArr(n))return i.error.v;a=a.concat(l.getDataArr(n,!1))}else"object"==L(n)&&null!=n.startCell?a=a.concat(l.getCellDataArr(n,"text",!1)):a.push(n);if(t.length!=a.length)return i.error.na;var o=[],u=[];for(r=0;r<t.length;r++){var f=t[r],h=a[r];b(f)&&b(h)&&(o.push(parseFloat(f)),u.push(parseFloat(h)))}if(0==u.length||0==o.length)return i.error.d;var s=jStat.mean(o),v=jStat.mean(u),c=o.length,g=0,m=0,p=0;for(r=0;r<c;r++)g+=(o[r]-s)*(u[r]-v),m+=Math.pow(o[r]-s,2),p+=Math.pow(u[r]-v,2);return g/Math.sqrt(m*p)}catch(r){var y=r;return y=i.errorInfo(y),[i.error.v,y]}},NORM_S_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e))<=0||e>=1?i.error.nm:jStat.normal.inv(e,0,1):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},NORM_S_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getCellBoolen(arguments[1]);return S(t)?t:t?jStat.normal.cdf(e,0,1):jStat.normal.pdf(e,0,1)}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},NORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e)){if("boolean"!=L(e))return i.error.v;"true"==e.toString().toLowerCase()?e=1:"false"==e.toString().toLowerCase()&&(e=0)}e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t)){if("boolean"!=L(t))return i.error.v;"true"==t.toString().toLowerCase()?t=1:"false"==t.toString().toLowerCase()&&(t=0)}t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n)){if("boolean"!=L(n))return i.error.v;"true"==n.toString().toLowerCase()?n=1:"false"==n.toString().toLowerCase()&&(n=0)}return n=parseFloat(n),e<=0||e>=1?i.error.nm:n<=0?i.error.nm:jStat.normal.inv(e,t,n)}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},NORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e)){if("boolean"!=L(e))return i.error.v;"true"==e.toString().toLowerCase()?e=1:"false"==e.toString().toLowerCase()&&(e=0)}e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getCellBoolen(arguments[3]);return S(a)?a:n<=0?i.error.nm:a?jStat.normal.cdf(e,t,n):jStat.normal.pdf(e,t,n)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},NEGBINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getCellBoolen(arguments[3]);return S(a)?a:n<0||n>1?i.error.nm:e<0||t<1?i.error.nm:a?jStat.negbin.cdf(e,t,n):jStat.negbin.pdf(e,t,n)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},MINA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!1))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else if("true"==a.toString.toLowerCase())e.push(1);else if("false"==a.toString.toLowerCase())e.push(0);else{if(!b(t))return i.error.v;e.push(t)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)?n.push(parseFloat(a)):"true"==a.toString().toLowerCase()?n.push(1):n.push(0)}return 0===n.length?0:Math.min.apply(Math,n)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},MEDIAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else{if(!b(t))return i.error.v;e.push(t)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)&&n.push(parseFloat(a))}return jStat.median(n)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},MAXA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!1))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else if("true"==a.toString.toLowerCase())e.push(1);else if("false"==a.toString.toLowerCase())e.push(0);else{if(!b(t))return i.error.v;e.push(t)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)?n.push(parseFloat(a)):"true"==a.toString().toLowerCase()?n.push(1):n.push(0)}return 0===n.length?0:Math.max.apply(Math,n)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},LOGNORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);return S(n)?n:b(n)?(n=parseFloat(n),e<=0||e>=1?i.error.nm:n<=0?i.error.nm:jStat.lognormal.inv(e,t,n)):i.error.v}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},LOGNORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getCellBoolen(arguments[3]);return S(a)?a:e<=0||n<=0?i.error.nm:a?jStat.lognormal.cdf(e,t,n):jStat.lognormal.pdf(e,t,n)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},Z_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];if("array"==L(arguments[0])){if("array"==L(arguments[0][0])&&!l.isDyadicArr(arguments[0]))return i.error.v;e=e.concat(l.getDataArr(arguments[0],!0))}else"object"==L(arguments[0])&&null!=arguments[0].startCell?e=e.concat(l.getCellDataArr(arguments[0],"text",!0)):e.push(arguments[0]);for(var t=[],n=0;n<e.length;n++){var a=e[n];b(a)&&t.push(parseFloat(a))}var o=l.getFirstValue(arguments[1]);if(S(o))return o;if(!b(o))return i.error.v;if(o=parseFloat(o),0==t.length)return i.error.na;var u=l.standardDeviation_s(t);if(3==arguments.length){if(u=l.getFirstValue(arguments[2]),S(u))return u;if(!b(u))return i.error.v;u=parseFloat(u)}var f=t.length,h=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,t);return 1-window.luckysheet_function.NORM_S_DIST.f((h-o)/(u/Math.sqrt(f)),"true")}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},PROB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];if("array"==L(arguments[0])){if("array"==L(arguments[0][0])&&!l.isDyadicArr(arguments[0]))return i.error.v;e=e.concat(l.getDataArr(arguments[0],!1))}else"object"==L(arguments[0])&&null!=arguments[0].startCell?e=e.concat(l.getCellDataArr(arguments[0],"text",!1)):e.push(arguments[0]);var t=[];if("array"==L(arguments[1])){if("array"==L(arguments[1][0])&&!l.isDyadicArr(arguments[1]))return i.error.v;t=t.concat(l.getDataArr(arguments[1],!1))}else"object"==L(arguments[1])&&null!=arguments[1].startCell?t=t.concat(l.getCellDataArr(arguments[1],"text",!1)):t.push(arguments[1]);if(e.length!=t.length)return i.error.na;var n=[],a=[],o=0;for(r=0;r<e.length;r++){var u=e[r],f=t[r];if(b(u)&&b(f)&&(n.push(parseFloat(u)),a.push(parseFloat(f)),o+=parseFloat(f),parseFloat(f)<=0||parseFloat(f)>1))return i.error.nm}if(1!=o)return i.error.nm;var h=l.getFirstValue(arguments[2]);if(S(h))return h;if(!b(h))return i.error.v;var s=h=parseFloat(h);if(4==arguments.length){if(s=l.getFirstValue(arguments[3]),S(s))return s;if(!b(s))return i.error.v;s=parseFloat(s)}var v=0;for(r=0;r<n.length;r++)n[r]>=h&&n[r]<=s&&(v+=a[r]);return v}catch(r){var c=r;return c=i.errorInfo(c),[i.error.v,c]}},QUARTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];if("array"==L(arguments[0])){if("array"==L(arguments[0][0])&&!l.isDyadicArr(arguments[0]))return i.error.v;e=e.concat(l.getDataArr(arguments[0],!0))}else if("object"==L(arguments[0])&&null!=arguments[0].startCell)e=e.concat(l.getCellDataArr(arguments[0],"text",!0));else{if(!b(arguments[0]))return i.error.v;e.push(arguments[0])}var t=[];for(r=0;r<e.length;r++){var n=e[r];b(n)&&t.push(parseFloat(n))}var a=l.getFirstValue(arguments[1]);if(S(a))return a;if(!b(a))return i.error.v;if(a=parseInt(a),0==t.length)return i.error.nm;if(a<=0||a>=4)return i.error.nm;switch(a){case 1:return window.luckysheet_function.PERCENTILE_EXC.f(t,.25);case 2:return window.luckysheet_function.PERCENTILE_EXC.f(t,.5);case 3:return window.luckysheet_function.PERCENTILE_EXC.f(t,.75)}}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},QUARTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];if("array"==L(arguments[0])){if("array"==L(arguments[0][0])&&!l.isDyadicArr(arguments[0]))return i.error.v;e=e.concat(l.getDataArr(arguments[0],!0))}else if("object"==L(arguments[0])&&null!=arguments[0].startCell)e=e.concat(l.getCellDataArr(arguments[0],"text",!0));else{if(!b(arguments[0]))return i.error.v;e.push(arguments[0])}var t=[];for(r=0;r<e.length;r++){var n=e[r];b(n)&&t.push(parseFloat(n))}var a=l.getFirstValue(arguments[1]);if(S(a))return a;if(!b(a))return i.error.v;if(a=parseInt(a),0==t.length)return i.error.nm;if(a<0||a>4)return i.error.nm;switch(a){case 0:return Math.min.apply(Math,t);case 1:return window.luckysheet_function.PERCENTILE_INC.f(t,.25);case 2:return window.luckysheet_function.PERCENTILE_INC.f(t,.5);case 3:return window.luckysheet_function.PERCENTILE_INC.f(t,.75);case 4:return Math.max.apply(Math,t)}}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},POISSON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getCellBoolen(arguments[2]);return S(n)?n:e<0||t<0?i.error.nm:n?jStat.poisson.cdf(e,t):jStat.poisson.pdf(e,t)}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},RSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else if("object"==L(e)&&null!=e.startCell)t=t.concat(l.getCellDataArr(e,"text",!1));else{if(!b(e))return i.error.v;t.push(e)}var n=arguments[1],a=[];if("array"==L(n)){if("array"==L(n[0])&&!l.isDyadicArr(n))return i.error.v;a=a.concat(l.getDataArr(n,!1))}else if("object"==L(n)&&null!=n.startCell)a=a.concat(l.getCellDataArr(n,"text",!1));else{if(!b(n))return i.error.v;a.push(n)}if(t.length!=a.length)return i.error.na;var o=[],u=[];for(r=0;r<t.length;r++){var f=t[r],h=a[r];b(f)&&b(h)&&(o.push(parseFloat(f)),u.push(parseFloat(h)))}return 0==o.length||0==u.length?i.error.d:Math.pow(window.luckysheet_function.PEARSON.f(o,u),2)}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},T_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=l.getCellBoolen(arguments[2]);return S(n)?n:t<1?i.error.nm:n?jStat.studentt.cdf(e,t):jStat.studentt.pdf(e,t)}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},T_DIST_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t),e<0||t<1?i.error.nm:2*(1-jStat.studentt.cdf(e,t))):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},T_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t))<1?i.error.nm:1-jStat.studentt.cdf(e,t):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},T_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t),e<=0||e>1?i.error.nm:t<1?i.error.nm:jStat.studentt.inv(e,t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},T_INV_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t),e<=0||e>1?i.error.nm:t<1?i.error.nm:Math.abs(jStat.studentt.inv(e/2,t))):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},T_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];if("array"==L(arguments[0])){if("array"==L(arguments[0][0])&&!l.isDyadicArr(arguments[0]))return i.error.v;e=e.concat(l.getDataArr(arguments[0],!1))}else if("object"==L(arguments[0])&&null!=arguments[0].startCell)e=e.concat(l.getCellDataArr(arguments[0],"text",!1));else{if(!b(arguments[0]))return i.error.v;e.push(arguments[0])}var t=e,n=[];if("array"==L(arguments[1])){if("array"==L(arguments[1][0])&&!l.isDyadicArr(arguments[1]))return i.error.v;n=n.concat(l.getDataArr(arguments[1],!1))}else if("object"==L(arguments[1])&&null!=arguments[1].startCell)n=n.concat(l.getCellDataArr(arguments[1],"text",!1));else{if(!b(arguments[1]))return i.error.v;n.push(arguments[1])}var a=n,o=l.getFirstValue(arguments[2]);if(S(o))return o;if(!b(o))return i.error.v;o=parseInt(o);var u=l.getFirstValue(arguments[3]);if(S(u))return u;if(!b(u))return i.error.v;if(u=parseInt(u),-1==[1,2].indexOf(o))return i.error.nm;if(-1==[1,2,3].indexOf(u))return i.error.nm;var f=null,h=null;if(1==u){var s=[];for(r=0;r<t.length;r++)s.push(t[r]-a[r]);f=Math.abs(jStat.mean(s))/(l.standardDeviation_s(s)/Math.sqrt(t.length)),h=t.length-1}else{var v=jStat.mean(t),c=jStat.mean(a),g=l.variance_s(t),m=l.variance_s(a);switch(f=Math.abs(v-c)/Math.sqrt(g/t.length+m/a.length),u){case 2:h=t.length+a.length-2;break;case 3:h=Math.pow(g/t.length+m/a.length,2)/(Math.pow(g/t.length,2)/(t.length-1)+Math.pow(m/a.length,2)/(a.length-1))}}if(1==o)var p=window.luckysheet_function.T_DIST_RT.f(f,h);else if(2==o)p=window.luckysheet_function.T_DIST_2T.f(f,h);return p}catch(r){var y=r;return y=i.errorInfo(y),[i.error.v,y]}},F_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseInt(n);var a=l.getCellBoolen(arguments[3]);return S(a)?a:e<0?i.error.nm:t<1?i.error.nm:n<1?i.error.nm:a?jStat.centralF.cdf(e,t,n):jStat.centralF.pdf(e,t,n)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},F_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=l.getFirstValue(arguments[2]);return S(n)?n:b(n)?(n=parseInt(n),e<0?i.error.nm:t<1?i.error.nm:n<1?i.error.nm:1-jStat.centralF.cdf(e,t,n)):i.error.v}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},VAR_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else{if(!b(t))return i.error.v;e.push(t)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)&&n.push(parseFloat(a))}if(0==n.length)return i.error.d;var o=n.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,n);for(r=0;r<o;r++)u+=Math.pow(n[r]-f,2);return u/o}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},VAR_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else{if(!b(t))return i.error.v;e.push(t)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)&&n.push(parseFloat(a))}if(0==n.length)return i.error.d;var o=n.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,n);for(r=0;r<o;r++)u+=Math.pow(n[r]-f,2);return u/(o-1)}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},VARA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!1))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else if("true"==a.toString.toLowerCase())e.push(1);else if("false"==a.toString.toLowerCase())e.push(0);else{if(!b(t))return i.error.v;e.push(t)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)?n.push(parseFloat(a)):"true"==a.toString().toLowerCase()?n.push(1):n.push(0)}var o=n.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,n);for(r=0;r<o;r++)u+=Math.pow(n[r]-f,2);return u/(o-1)}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},VARPA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!1))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else if("true"==a.toString.toLowerCase())e.push(1);else if("false"==a.toString.toLowerCase())e.push(0);else{if(!b(t))return i.error.v;e.push(t)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)?n.push(parseFloat(a)):"true"==a.toString().toLowerCase()?n.push(1):n.push(0)}var o=n.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,n);for(r=0;r<o;r++)u+=Math.pow(n[r]-f,2);return u/o}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},STEYX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];if("array"==L(arguments[0])){if("array"==L(arguments[0][0])&&!l.isDyadicArr(arguments[0]))return i.error.v;e=e.concat(l.getDataArr(arguments[0],!1))}else if("object"==L(arguments[0])&&null!=arguments[0].startCell)e=e.concat(l.getCellDataArr(arguments[0],"text",!1));else{if(!b(arguments[0]))return i.error.v;e.push(arguments[0])}var t=[];if("array"==L(arguments[1])){if("array"==L(arguments[1][0])&&!l.isDyadicArr(arguments[1]))return i.error.v;t=t.concat(l.getDataArr(arguments[1],!1))}else if("object"==L(arguments[1])&&null!=arguments[1].startCell)t=t.concat(l.getCellDataArr(arguments[1],"text",!1));else{if(!b(arguments[1]))return i.error.v;t.push(arguments[1])}if(e.length!=t.length)return i.error.na;var n=[],a=[];for(r=0;r<e.length;r++){var o=e[r],u=t[r];b(o)&&b(u)&&(n.push(parseFloat(o)),a.push(parseFloat(u)))}if(n.length<3||a.length<3)return i.error.d;var f=jStat.mean(a),h=jStat.mean(n),s=a.length,v=0,c=0,g=0;for(r=0;r<s;r++)v+=Math.pow(n[r]-h,2),c+=(a[r]-f)*(n[r]-h),g+=Math.pow(a[r]-f,2);return Math.sqrt((v-c*c/g)/(s-2))}catch(r){var m=r;return m=i.errorInfo(m),[i.error.v,m]}},STANDARDIZE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);return S(n)?n:b(n)?(n=parseFloat(n))<=0?i.error.nm:(e-t)/n:i.error.v}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},SMALL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];if("array"==L(arguments[0])){if("array"==L(arguments[0][0])&&!l.isDyadicArr(arguments[0]))return i.error.v;e=e.concat(l.getDataArr(arguments[0],!0))}else if("object"==L(arguments[0])&&null!=arguments[0].startCell)e=e.concat(l.getCellDataArr(arguments[0],"number",!0));else{if(!b(arguments[0]))return i.error.v;e.push(arguments[0])}var t=[];for(r=0;r<e.length;r++){var n=e[r];b(n)&&t.push(parseFloat(n))}var a=l.getFirstValue(arguments[1]);return S(a)?a:b(a)?(a=parseInt(a),0==t.length?i.error.nm:a<=0||a>t.length?i.error.nm:t.sort(function(r,e){return r-e})[a-1]):i.error.v}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},SLOPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];if("array"==L(arguments[0])){if("array"==L(arguments[0][0])&&!l.isDyadicArr(arguments[0]))return i.error.v;e=e.concat(l.getDataArr(arguments[0],!1))}else if("object"==L(arguments[0])&&null!=arguments[0].startCell)e=e.concat(l.getCellDataArr(arguments[0],"text",!1));else{if(!b(arguments[0]))return i.error.v;e.push(arguments[0])}var t=[];if("array"==L(arguments[1])){if("array"==L(arguments[1][0])&&!l.isDyadicArr(arguments[1]))return i.error.v;t=t.concat(l.getDataArr(arguments[1],!1))}else if("object"==L(arguments[1])&&null!=arguments[1].startCell)t=t.concat(l.getCellDataArr(arguments[1],"text",!1));else{if(!b(arguments[1]))return i.error.v;t.push(arguments[1])}if(e.length!=t.length)return i.error.na;var n=[],a=[];for(r=0;r<e.length;r++){var o=e[r],u=t[r];b(o)&&b(u)&&(n.push(parseFloat(o)),a.push(parseFloat(u)))}if(n.length<3||a.length<3)return i.error.d;var f=jStat.mean(a),h=jStat.mean(n),s=a.length,v=0,c=0;for(r=0;r<s;r++)v+=(a[r]-f)*(n[r]-h),c+=Math.pow(a[r]-f,2);return v/c}catch(r){var g=r;return g=i.errorInfo(g),[i.error.v,g]}},SKEW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else{if(!b(t))return i.error.v;e.push(t)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)&&n.push(parseFloat(a))}if(n.length<3||0==l.standardDeviation_s(n))return i.error.d;var o=jStat.mean(n),u=n.length,f=0;for(r=0;r<u;r++)f+=Math.pow(n[r]-o,3);return u*f/((u-1)*(u-2)*Math.pow(jStat.stdev(n,!0),3))}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},SKEW_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[];for(r=0;r<arguments.length;r++){var t=arguments[r];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;e=e.concat(l.getDataArr(t,!0))}else if("object"==L(t)&&null!=t.startCell)e=e.concat(l.getCellDataArr(t,"number",!0));else{if(!b(t))return i.error.v;e.push(t)}}var n=[];for(r=0;r<e.length;r++){var a=e[r];b(a)&&n.push(parseFloat(a))}if(n.length<3||0==l.standardDeviation_s(n))return i.error.d;var o=jStat.mean(n),u=n.length,f=0,h=0;for(r=0;r<u;r++)h+=Math.pow(n[r]-o,3),f+=Math.pow(n[r]-o,2);return f/=u,(h/=u)/Math.pow(f,1.5)}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},ADDRESS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=1;if(arguments.length>=3){if(n=l.getFirstValue(arguments[2]),S(n))return n;if(!b(n))return i.error.v;n=parseInt(n)}var a,o=!0;if(arguments.length>=4&&(o=l.getCellBoolen(arguments[3]),S(o)))return o;if(e<=0||t<=0)return i.error.v;if(-1==[1,2,3,4].indexOf(n))return i.error.v;if(o)switch(t=j(t-1),n){case 1:a="$"+t+"$"+e;break;case 2:a=t+"$"+e;break;case 3:a="$"+t+e;break;case 4:a=t+e}else switch(n){case 1:a="R"+e+"C"+t;break;case 2:a="R"+e+"C["+t+"]";break;case 3:a="R["+e+"]C"+t;break;case 4:a="R["+e+"]C["+t+"]"}if(5==arguments.length){var u=l.getFirstValue(arguments[4]);return S(u)?u:u+"!"+a}return a}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},INDIRECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;var t=!0;if(2==arguments.length&&(t=l.getCellBoolen(arguments[1]),S(t)))return t;let r=D()[w(m.calculateSheetIndex)],a=r.data;if(i.iscelldata(e)){let t=i.getcellrange(e),n=t.row[0],o=t.column[0];if(n<0||n>=a.length||o<0||o>=a[0].length)return i.error.r;if(null==a[n][o]||M(a[n][o].v))return 0;let l=a[n][o].v;if(null!=i.execFunctionGlobalData){let r=i.execFunctionGlobalData[n+"_"+o+"_"+m.calculateSheetIndex];null!=r&&(l=r.v)}return{sheetName:r.name,startCell:e,rowl:n,coll:o,data:l}}return i.error.r}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ROW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e;return 1==arguments.length?"array"==L(arguments[0])?i.error.v:(e="object"==L(arguments[0])&&null!=arguments[0].startCell?arguments[0].startCell:arguments[0],i.iscelldata(e)?i.getcellrange(e).row[0]+1:i.error.v):window.luckysheetCurrentRow+1}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},ROWS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return"array"==L(arguments[0])?"array"==L(arguments[0][0])?arguments[0].length:1:"object"==L(arguments[0])&&null!=arguments[0].startCell?arguments[0].rowl:1}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},COLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e;return 1==arguments.length?"array"==L(arguments[0])?i.error.v:(e="object"==L(arguments[0])&&null!=arguments[0].startCell?arguments[0].startCell:arguments[0],i.iscelldata(e)?i.getcellrange(e).column[0]+1:i.error.v):window.luckysheetCurrentColumn+1}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},COLUMNS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return"array"==L(arguments[0])?"array"==L(arguments[0][0])?arguments[0][0].length:arguments[0].length:"object"==L(arguments[0])&&null!=arguments[0].startCell?arguments[0].coll:1}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},OFFSET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{if("object"!=L(arguments[0])||null==arguments[0].startCell)return i.error.v;var e=arguments[0].startCell;let r=arguments[0].sheetName;var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseInt(n);var a=arguments[0].rowl;if(arguments.length>=4){if(a=l.getFirstValue(arguments[3]),S(a))return a;if(!b(a))return i.error.v;a=parseInt(a)}var o=arguments[0].coll;if(5==arguments.length){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseInt(o)}if(a<1||o<1)return i.error.r;var u=i.getcellrange(e),f=u.row[0],h=u.column[0],s=(f+=t)+a-1,v=(h+=n)+o-1;let C=D()[w(m.calculateSheetIndex)].data;if(f<0||s>=C.length||h<0||v>=C[0].length)return i.error.r;for(var c=[],g=f;g<=s;g++){for(var p=[],y=h;y<=v;y++)if(null!=i.execFunctionGlobalData&&null!=i.execFunctionGlobalData[g+"_"+y+"_"+m.calculateSheetIndex]){let r=i.execFunctionGlobalData[g+"_"+y+"_"+m.calculateSheetIndex];null!=r?p.push(r.v):p.push(0)}else null==C[g][y]||M(C[g][y].v)?p.push(0):p.push(C[g][y].v);c.push(p)}return{sheetName:r,startCell:k(m.calculateSheetIndex,{row:[f,s],column:[h,v]}),rowl:f,coll:h,data:c}}catch(r){var d=r;return d=i.errorInfo(d),[i.error.v,d]}},MATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;var t=arguments[1],n=[];if("array"==L(t)){if("array"==L(t[0]))return l.isDyadicArr(t)?i.error.na:i.error.v;for(r=0;r<t.length;r++)n.push(t[r])}else if("object"==L(t)&&null!=t.startCell){if(t.rowl>1&&t.coll>1)return i.error.na;if(null!=t.data)if("array"==L(t.data))for(r=0;r<t.data.length;r++)for(var a=0;a<t.data[r].length;a++)null==t.data[r][a]||M(t.data[r][a].v)||n.push(t.data[r][a].v);else n.push(t.data.v)}var o,u,f=1;if(3==arguments.length){if(f=l.getFirstValue(arguments[2]),S(f))return f;if(!b(f))return i.error.v;f=Math.ceil(parseFloat(f))}if(-1==[-1,0,1].indexOf(f))return i.error.na;for(var h=0;h<n.length;h++)if(1===f){if(n[h]===e)return h+1;n[h]<e&&(u?n[h]>u&&(o=h+1,u=n[h]):(o=h+1,u=n[h]))}else if(0===f){if("string"==typeof e){if(e=e.replace(/\?/g,"."),n[h].toLowerCase().match(e.toLowerCase()))return h+1}else if(n[h]===e)return h+1}else if(-1===f){if(n[h]===e)return h+1;n[h]>e&&(u?n[h]<u&&(o=h+1,u=n[h]):(o=h+1,u=n[h]))}return o||i.error.na}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},VLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;if(""==e.toString().replace(/\s/g,""))return i.error.na;var t=arguments[1],n=[];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;for(r=0;r<t.length;r++){for(var a=[],o=0;o<t[r].length;o++)a.push(t[r][o]);n.push(a)}}else{for(a=[],r=0;r<t.length;r++)a.push(t[r]);n.push(a)}else{if("object"!=L(t)||null==t.startCell)return i.error.v;n=l.getCellDataDyadicArr(t,"text")}var u=l.getFirstValue(arguments[2]);if(S(u))return u;if(!b(u))return i.error.v;u=parseInt(u);var f=!0;if(4==arguments.length&&(f=l.getCellBoolen(arguments[3]),S(f)))return f;if(u<1)return i.error.v;if(u>n[0].length)return i.error.r;if(!f){var h=null;for(s=0;s<n.length;s++)if(e.toString()==n[s][0].toString()){h=s;break}return null==h?i.error.na:n[h][u-1]}n=_(n,0,!0);for(var s=0;s<n.length;s++){var v,c=n[s][0];if(A(e)&&A(c)?v=V(e,c):b(e)&&b(c)?v=y(e).value()-y(c).value():b(e)||b(c)?b(e)?b(c)||(v=-1):v=1:v=e.localeCompare(c,"zh"),v<0)return 0==s?i.error.na:n[s-1][u-1];if(s==n.length-1)return n[s][u-1]}}catch(r){var g=r;return g=i.errorInfo(g),[i.error.v,g]}},HLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var e=0;e<arguments.length;e++){if(!i.errorParamCheck(this.p,arguments[e],e)[0])return i.error.v}try{window.luckysheetCurrentRow,window.luckysheetCurrentColumn;var t=arguments[0];"object"==typeof t&&(t=arguments[0].data,"array"==L(t)?(t=t[r],"array"==L(t)&&(t=t[u])):t=t.v);var n=arguments[1].data,a=arguments[2],o=!1;if(arguments.length>3&&(o=!!arguments[3]),a>n.rowl)return[i.error.v,"索引超过了范围的长度，"+n[0].length];if(a<1)return[i.error.v,"索引必须大于1"];for(var l=i.error.na,u=0;u<n[0].length;u++){var f=x(0,u,n),h=x(a-1,u,n);if(o)f.indexOf(t)>-1&&(l=h);else if(i.acompareb(f,t))return l=h}return l}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},LOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var e=0;e<arguments.length;e++){if(!i.errorParamCheck(this.p,arguments[e],e)[0])return i.error.v}try{window.luckysheetCurrentRow,window.luckysheetCurrentColumn;var t=arguments[0];"object"==typeof t&&(t=arguments[0].data,"array"==L(t)?(t=t[r],"array"==L(t)&&(t=t[c])):t=t.v);var n,a=arguments[1].data,o=i.error.na;if(a=i.getRangeArray(a)[0],arguments[2]&&(n=arguments[2].data,n=i.getRangeArray(n)[0]),"string"==typeof t)for(e=0;e<a.length;e++){var l=a[e];arguments[2]?(f=n[e],l==t&&(o=f)):i.acompareb(l,t)&&(o=l)}else if("num"==P(t)){var u=[];for(e=0;e<a.length;e++){var f;l=a[e];if(arguments[2]){if(f=n[e],l==t)return o=f;l!=t&&"num"==P(l)&&u.push(l)}else{if(l==t)return o=l;l!=t&&"num"==P(l)&&u.push(l)}}if(0!=u.length){u.push(t),u.sort(function(r,e){return e-r});var h=u.indexOf(t);if(h==u.length-1)return[i.error.na,"找不到对应参数"];var s=u[h+1];o=arguments[2]?n[e=a.indexOf(s)]:s}}return o}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},INDEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];let r=!1;if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=l.getDataDyadicArr(e)}else"object"==L(e)&&null!=e.startCell&&(t=l.getCellDataDyadicArr(e,"number"),r=!0);var n=t.length,a=t[0].length,o=l.getFirstValue(arguments[1]);if(S(o))return o;if(!b(o))return i.error.v;o=parseInt(o);var u=l.getFirstValue(arguments[2]);if(S(u))return u;if(o<0||b(u)&&u<0)return i.error.v;if(o>n||b(u)&&u>a)return i.error.r;if(r){var f=i.getcellrange(e.startCell),h=f.row[0],s=f.column[0];let r=t;0==o||0==u?(0==o?(r=t[0],o=1):r=t[o-1],b(u)?0==u?(r=r[0],u=1):r=r[u-1]:u=1):(b(o)||(o=1),b(u)||(u=1),r=t[o-1][u-1]);let n=h+o-1,a=s+u-1;return{sheetName:e.sheetName,startCell:k(m.calculateSheetIndex,{row:[n,n],column:[a,a]}),rowl:n,coll:a,data:r}}return b(u)?(u=parseInt(u),o<=0||u<=0?i.error.v:t[o-1][u-1]):i.error.v}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},GETPIVOTDATA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return i.error.v}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},CHOOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;if((e=parseInt(e))<1||e>arguments.length-1)return i.error.v;var t=arguments[e];return"array"==L(t)?"array"!=L(t[0])||l.isDyadicArr(t)?t:i.error.v:"object"!=L(t)||null==t.startCell?t:null==t.data?0:"array"==L(t.data)?l.getCellDataDyadicArr(t.data,"number"):M(t.data.v)?0:t.data.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},HYPERLINK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return i.error.v}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},TIME:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;if(n=parseInt(n),e<0||e>32767)return i.error.nm;if(e>24&&(e%=24),t<0||t>32767)return i.error.nm;if(n<0||n>32767)return i.error.nm;var a=p().set({hour:e,minute:t,second:n});return p(a).format("h:mm:ss a")}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},TIMEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);return S(e)?e:p(e).isValid()?(3600*p(e).get("hour")+60*p(e).get("minute")+p(e).get("second"))/86400:i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},EOMONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;if(t=parseInt(t),!p(e).isValid())return i.error.v;var n=p(e).add(t+1,"months").set("date",1).subtract(1,"days");return R(p(n).format("YYYY-MM-DD H:mm:ss"))[2]}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},EDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;if(t=parseInt(t),!p(e).isValid())return i.error.v;var n=p(e).add(t,"months");return R(p(n).format("YYYY-MM-DD h:mm:ss"))[2]}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},SECOND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);return S(e)?e:p(e).isValid()?p(e).seconds():i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},MINUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);return S(e)?e:p(e).isValid()?p(e).minutes():i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},HOUR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);return S(e)?e:p(e).isValid()?p(e).hours():i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},NOW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return p().format("YYYY-M-D HH:mm")}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},NETWORKDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{if(3==arguments.length)var e=window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1,arguments[2]);else e=window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1);return e}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},NETWORKDAYS_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],t=l.getCellDate(arguments[0]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getCellDate(arguments[1]);if(S(n))return n;if(!p(n).isValid())return i.error.v;var a=e[1];if(arguments.length>=3)if("string"==typeof(a=arguments[2])&&"7"==a.length&&/^[0-1]{7}$/g.test(a));else{if(a=l.getFirstValue(arguments[2]),S(a))return a;if(!b(a))return i.error.v;if((a=parseInt(a))<1||a>7&&a<11||a>17)return i.error.nm;a=e[a]}var o=[];if(4==arguments.length&&(o=l.getCellrangeDate(arguments[3]),S(o)))return o;for(r=0;r<o.length;r++)if(!p(o[r]).isValid())return i.error.v;var u=p(n).diff(p(t),"days")+1,f=u,h=p(t);for(r=0;r<u;r++){var s=p(h).weekday(),v=!1;"array"==L(a)?s!==a[0]&&s!==a[1]||(v=!0):(0==s&&(s=7),"0"==a.charAt(s-1)&&(v=!0));for(var c=0;c<o.length;c++)if(0===p(h).diff(p(o[c]),"days")){v=!0;break}v&&f--,h=p(h).add(1,"days")}return f}catch(r){var g=r;return g=i.errorInfo(g),[i.error.v,g]}},ISOWEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);return S(e)?e:p(e).isValid()?p(e).isoWeeks():i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},WEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[void 0,7,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,7],t=l.getCellDate(arguments[0]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=1;if(2==arguments.length){if(n=l.getFirstValue(arguments[1]),S(n))return n;if(!b(n))return i.error.v;n=parseInt(n)}if(21==n)return window.luckysheet_function.ISOWEEKNUM.f(arguments[0]);if(-1==[1,2,11,12,13,14,15,16,17].indexOf(n))return i.error.nm;var a=e[n],o=p(t).isoWeekday()>=a?1:0;return p(t).isoWeeks()+o}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},WEEKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=1;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}return-1==[1,2,3,11,12,13,14,15,16,17].indexOf(t)?i.error.nm:[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]][t][p(e).day()]}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},DAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);return S(e)?e:p(e).isValid()?p(e).date():i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},DAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);return S(t)?t:p(t).isValid()?p(e).diff(p(t),"days"):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},DAYS360:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=!1;if(3==arguments.length&&(n=l.getCellBoolen(arguments[2]),S(n)))return n;var a,o,u=p(e).month(),f=p(t).month();if(n)a=31===p(e).date()?30:p(e).date(),o=31===p(t).date()?30:p(t).date();else{var h=p().set({year:p(e).year(),month:u+1,date:0}).date(),s=p().set({year:p(t).year(),month:f+1,date:0}).date();a=p(e).date()===h?30:p(e).date(),p(t).date()===s?a<30?(f++,o=1):o=30:o=p(t).date()}return 360*p(t).diff(p(e),"years")+30*(f-u)+(o-a)}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;if(n=parseInt(n),e<0||e>=1e4)return i.error.nm;e>=0&&e<=1899&&(e+=1900);var a=p().set({year:e,month:t-1,date:n});return p(a).year()<1900?i.error.nm:p(a).format("YYYY-MM-DD")}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},DATEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);return S(e)?e:p(e).isValid()?(e=p(e).format("YYYY-MM-DD"),R(e)[2]):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},DATEDIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{F(arguments);for(r=0;r<arguments.length-1;r++)if(arguments[r]=moment.fromOADate(arguments[r]).format("l"),!A(arguments[r]))return i.error.v;var e=p(arguments[0]),t=p(arguments[1]),n=arguments[2],a=i.error.v;if(window.luckysheet_function.DAYS.f(t,e)<0)return i.error.v;switch(n){case"Y":case"y":a=t.diff(e,"years",!1);break;case"M":case"m":a=t.diff(e,"months",!1);break;case"D":case"d":a=t.diff(e,"days",!1);break;case"MD":case"md":a=t.format("DD")-e.format("DD");break;case"YM":case"ym":a=(o=parseInt(e.format("M")))<=(l=parseInt(t.format("M")))?l-o:l+12-o;break;case"YD":case"yd":var o,l;a=(o=R(e.format("MM-DD"))[2])<=(l=R(t.format("MM-DD"))[2])?l-o:l+365-o;break;default:a=i.error.v}return a}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},WORKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{if(3==arguments.length)var e=window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1,arguments[2]);else e=window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1);return e}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},WORKDAY_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],t=l.getCellDate(arguments[0]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[1]);if(S(n))return n;if(!b(n))return i.error.v;n=parseInt(n);var a=e[1];if(arguments.length>=3)if("string"==typeof(a=arguments[2])&&"7"==a.length&&/^[0-1]{7}$/g.test(a));else{if(a=l.getFirstValue(arguments[2]),S(a))return a;if(!b(a))return i.error.v;if((a=parseInt(a))<1||a>7&&a<11||a>17)return i.error.nm;a=e[a]}var o=[];if(4==arguments.length&&(o=l.getCellrangeDate(arguments[3]),S(o)))return o;for(r=0;r<o.length;r++)if(!p(o[r]).isValid())return i.error.v;for(var u=0;u<n;){t=p(t).add(1,"days");var f=p(t).weekday();if(L(a)){if(f===a[0]||f===a[1])continue}else if(0==f&&(f=7),"0"==a.charAt(f-1))continue;for(var h=0;h<o.length;h++)if(0===p(t).diff(p(o[h]),"days")){u--;break}u++}return p(t).format("YYYY-MM-DD")}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},YEAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);return S(e)?e:p(e).isValid()?p(e).year():i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},YEARFRAC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=0;if(3==arguments.length){if(n=l.getFirstValue(arguments[2]),S(n))return n;if(!b(n))return i.error.v;n=parseInt(n)}if(n<0||n>4)return i.error.nm;var a,o=p(e).date(),u=p(e).month()+1,f=p(e).year(),h=p(t).date(),s=p(t).month()+1,v=p(t).year();switch(n){case 0:31===o&&31===h?(o=30,h=30):31===o?o=30:30===o&&31===h&&(h=30),a=(h+30*s+360*v-(o+30*u+360*f))/360;break;case 1:var c=365;if(f===v||f+1===v&&(u>s||u===s&&o>=h))return(f===v&&l.isLeapYear(f)||l.feb29Between(e,t)||1===s&&29===h)&&(c=366),p(t).diff(p(e),"days")/c;var g=v-f+1,m=(p().set({year:v+1,month:0,date:1})-p().set({year:f,month:0,date:1}))/1e3/60/60/24/g;a=p(t).diff(p(e),"days")/m;break;case 2:a=p(t).diff(p(e),"days")/360;break;case 3:a=p(t).diff(p(e),"days")/365;break;case 4:a=(h+30*s+360*v-(o+30*u+360*f))/360}return a}catch(r){var y=r;return y=i.errorInfo(y),[i.error.v,y]}},TODAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return p().format("YYYY-MM-DD")}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},MONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);return S(e)?e:p(e).isValid()?p(e).month()+1:i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},EFFECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t),e<=0||t<1?i.error.nm:Math.pow(1+e/t,t)-1):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},DOLLAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=2;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}t>9&&(t=9);for(r=1;r<=t;r++)"0";return(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},DOLLARDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;if((t=parseInt(t))<0)return i.error.nm;if(0==t)return i.error.d;var n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var a=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return n=Math.round(n*a)/a}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},DOLLARFR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;if((t=parseInt(t))<0)return i.error.nm;if(0==t)return i.error.d;var n=parseInt(e,10);return n+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},DB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseInt(a);var o=12;if(5==arguments.length){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseInt(o)}if(e<0||t<0||n<0||a<0)return i.error.nm;if(o<1||o>12)return i.error.nm;if(a>n)return i.error.nm;if(t>=e)return 0;var u=(1-Math.pow(t/e,1/n)).toFixed(3),f=e*u*o/12,h=f,s=0,v=a===n?n-1:a;for(r=2;r<=v;r++)h+=s=(e-h)*u;if(1===a)var c=f;else if(a===n)c=(e-h)*u;else c=s;return c}catch(r){var g=r;return g=i.errorInfo(g),[i.error.v,g]}},DDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseInt(a);var o=2;if(5==arguments.length){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o)}if(e<0||t<0||n<0||a<0||o<=0)return i.error.nm;if(a>n)return i.error.nm;if(t>=e)return 0;var u=0,f=0;for(r=1;r<=a;r++)u+=f=Math.min(o/n*(e-u),e-t-u);return f}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},RATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=0;if(arguments.length>=4){if(a=l.getFirstValue(arguments[3]),S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a)}var o=0;if(arguments.length>=5){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o)}var u=.1;if(6==arguments.length){if(u=l.getFirstValue(arguments[5]),S(u))return u;if(!b(u))return i.error.v;u=parseFloat(u)}if(0!=o&&1!=o)return i.error.nm;for(var f=0,h=!1,s=u;f<100&&!h;){var v=Math.pow(s+1,e),c=Math.pow(s+1,e-1),g=s-(a+v*n+t*(v-1)*(s*o+1)/s)/(e*c*n-t*(v-1)*(s*o+1)/Math.pow(s,2)+(e*t*c*(s*o+1)/s+t*(v-1)*o/s));Math.abs(g-s)<1e-6&&(h=!0),f++,s=g}return h?s:i.error.nm}catch(r){var m=r;return m=i.errorInfo(m),[i.error.v,m]}},CUMPRINC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseInt(a);var o=l.getFirstValue(arguments[4]);if(S(o))return o;if(!b(o))return i.error.v;o=parseInt(o);var u=l.getFirstValue(arguments[5]);if(S(u))return u;if(!b(u))return i.error.v;if(u=parseFloat(u),e<=0||t<=0||n<=0)return i.error.nm;if(a<1||o<1||a>o)return i.error.nm;if(0!=u&&1!=u)return i.error.nm;var f=window.luckysheet_function.PMT.f(e,t,n,0,u),h=0;1===a&&(h=0===u?f+n*e:f,a++);for(r=a;r<=o;r++)h+=u>0?f-(window.luckysheet_function.FV.f(e,r-2,f,n,1)-f)*e:f-window.luckysheet_function.FV.f(e,r-1,f,n,0)*e;return h}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},COUPNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseInt(n);var a=0;if(4==arguments.length){a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseInt(a)}if(1!=n&&2!=n&&4!=n)return i.error.nm;if(a<0||a>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var o,u=p(e).date(),f=p(e).month()+1,h=p(e).year(),s=p(t).date(),v=p(t).month()+1,c=p(t).year();switch(a){case 0:31===u&&31===s?(u=30,s=30):31===u?u=30:30===u&&31===s&&(s=30),o=(s+30*v+360*c-(u+30*f+360*h))/(360/n);break;case 1:var g=365;if(h===c||h+1===c&&(f>v||f===v&&u>=s))return(h===c&&l.isLeapYear(h)||l.feb29Between(e,t)||1===v&&29===s)&&(g=366),p(t).diff(p(e),"days")/(g/n);var m=c-h+1,y=(p().set({year:c+1,month:0,date:1})-p().set({year:h,month:0,date:1}))/1e3/60/60/24/m;o=p(t).diff(p(e),"days")/(y/n);break;case 2:o=p(t).diff(p(e),"days")/(360/n);break;case 3:o=p(t).diff(p(e),"days")/(365/n);break;case 4:o=(s+30*v+360*c-(u+30*f+360*h))/(360/n)}return Math.round(o)}catch(r){var d=r;return d=i.errorInfo(d),[i.error.v,d]}},SYD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);return S(a)?a:b(a)?(a=parseInt(a),0==n?i.error.nm:a<1||a>n?i.error.nm:(e-t)*(n-a+1)*2/(n*(n+1))):i.error.v}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},TBILLEQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);return S(n)?n:b(n)?(n=parseFloat(n))<=0?i.error.nm:p(e)-p(t)>0?i.error.nm:p(t)-p(e)>31536e6?i.error.nm:365*n/(360-n*p(t).diff(p(e),"days")):i.error.v}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},TBILLYIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);return S(n)?n:b(n)?(n=parseFloat(n))<=0?i.error.nm:p(e)-p(t)>=0?i.error.nm:p(t)-p(e)>31536e6?i.error.nm:(100-n)/n*(360/p(t).diff(p(e),"days")):i.error.v}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},TBILLPRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);return S(n)?n:b(n)?(n=parseFloat(n))<=0?i.error.nm:p(e)-p(t)>0?i.error.nm:p(t)-p(e)>31536e6?i.error.nm:100*(1-n*p(t).diff(p(e),"days")/360):i.error.v}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},PV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=0;if(arguments.length>=4){if(a=l.getFirstValue(arguments[3]),S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a)}var o=0;if(arguments.length>=5){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o)}if(0!=o&&1!=o)return i.error.nm;if(0===e)var u=-n*t-a;else u=((1-Math.pow(1+e,t))/e*n*(1+e*o)-a)/Math.pow(1+e,t);return u}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},ACCRINT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getCellDate(arguments[2]);if(S(n))return n;if(!p(n).isValid())return i.error.v;var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=l.getFirstValue(arguments[4]);if(S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o);var u=l.getFirstValue(arguments[5]);if(S(u))return u;if(!b(u))return i.error.v;u=parseInt(u);var f=0;if(arguments.length>=7){if(f=l.getFirstValue(arguments[6]),S(f))return f;if(!b(f))return i.error.v;f=parseInt(f)}var h,s=!0;if(8==arguments.length&&(s=l.getCellBoolen(arguments[7]),S(s)))return s;if(a<=0||o<=0)return i.error.nm;if(1!=u&&2!=u&&4!=u)return i.error.nm;if(f<0||f>4)return i.error.nm;if(p(e)-p(n)>=0)return i.error.nm;if(p(n)-p(t)>=0&&!s){var v=p(t).date(),c=p(t).month()+1,g=p(t).year(),m=p(n).date(),y=p(n).month()+1,d=p(n).year();switch(f){case 0:31===v&&31===m?(v=30,m=30):31===v?v=30:30===v&&31===m&&(m=30),h=(m+30*y+360*d-(v+30*c+360*g))/360;break;case 1:var C=365;if(g===d||g+1===d&&(c>y||c===y&&v>=m))return(g===d&&l.isLeapYear(g)||l.feb29Between(t,n)||1===y&&29===m)&&(C=366),p(n).diff(p(t),"days")/C;var F=d-g+1,I=(p().set({year:d+1,month:0,date:1})-p().set({year:g,month:0,date:1}))/1e3/60/60/24/F;h=p(n).diff(p(t),"days")/I;break;case 2:h=p(n).diff(p(t),"days")/360;break;case 3:h=p(n).diff(p(t),"days")/365;break;case 4:h=(m+30*y+360*d-(v+30*c+360*g))/360}}else{v=p(e).date(),c=p(e).month()+1,g=p(e).year(),m=p(n).date(),y=p(n).month()+1,d=p(n).year();switch(f){case 0:31===v&&31===m?(v=30,m=30):31===v?v=30:30===v&&31===m&&(m=30),h=(m+30*y+360*d-(v+30*c+360*g))/360;break;case 1:C=365;if(g===d||g+1===d&&(c>y||c===y&&v>=m))return(g===d&&l.isLeapYear(g)||l.feb29Between(e,n)||1===y&&29===m)&&(C=366),p(n).diff(p(e),"days")/C;F=d-g+1,I=(p().set({year:d+1,month:0,date:1})-p().set({year:g,month:0,date:1}))/1e3/60/60/24/F;h=p(n).diff(p(e),"days")/I;break;case 2:h=p(n).diff(p(e),"days")/360;break;case 3:h=p(n).diff(p(e),"days")/365;break;case 4:h=(m+30*y+360*d-(v+30*c+360*g))/360}}return o*a*h}catch(r){var w=r;return w=i.errorInfo(w),[i.error.v,w]}},ACCRINTM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=0;if(5==arguments.length){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseInt(o)}if(n<=0||a<=0)return i.error.nm;if(o<0||o>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var u,f=p(e).date(),h=p(e).month()+1,s=p(e).year(),v=p(t).date(),c=p(t).month()+1,g=p(t).year();switch(o){case 0:31===f&&31===v?(f=30,v=30):31===f?f=30:30===f&&31===v&&(v=30),u=(v+30*c+360*g-(f+30*h+360*s))/360;break;case 1:var m=365;if(s===g||s+1===g&&(h>c||h===c&&f>=v))return(s===g&&l.isLeapYear(s)||l.feb29Between(e,t)||1===c&&29===v)&&(m=366),p(t).diff(p(e),"days")/m;var y=g-s+1,d=(p().set({year:g+1,month:0,date:1})-p().set({year:s,month:0,date:1}))/1e3/60/60/24/y;u=p(t).diff(p(e),"days")/d;break;case 2:u=p(t).diff(p(e),"days")/360;break;case 3:u=p(t).diff(p(e),"days")/365;break;case 4:u=(v+30*c+360*g-(f+30*h+360*s))/360}return a*n*u}catch(r){var C=r;return C=i.errorInfo(C),[i.error.v,C]}},COUPDAYBS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseInt(n);var a,o=0;if(4==arguments.length){if(o=l.getFirstValue(arguments[3]),S(o))return o;if(!b(o))return i.error.v;o=parseInt(o)}if(1!=n&&2!=n&&4!=n)return i.error.nm;if(o<0||o>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var u,f=Math.ceil(p(t).diff(p(e),"months")/(12/n))+1;for(r=1;r<=f;r++){var h=p(t).subtract(12/n*r,"months");if(h<=p(e)){a=h;break}}switch(o){case 0:var s=p(a).date(),v=p(a).month()+1,c=p(a).year(),g=p(e).date(),m=p(e).month()+1,y=p(e).year();31===s&&31===g?(s=30,g=30):31===s?s=30:30===s&&31===g&&(g=30),u=g+30*m+360*y-(s+30*v+360*c);break;case 1:case 2:case 3:u=p(e).diff(p(a),"days");break;case 4:s=p(a).date(),v=p(a).month()+1,c=p(a).year();u=(g=p(e).date())+30*(m=p(e).month()+1)+360*(y=p(e).year())-(s+30*v+360*c)}return u}catch(r){var d=r;return d=i.errorInfo(d),[i.error.v,d]}},COUPDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseInt(n);var a,o=0;if(4==arguments.length){if(o=l.getFirstValue(arguments[3]),S(o))return o;if(!b(o))return i.error.v;o=parseInt(o)}if(1!=n&&2!=n&&4!=n)return i.error.nm;if(o<0||o>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;switch(o){case 0:a=360/n;break;case 1:var u=Math.ceil(p(t).diff(p(e),"months")/(12/n))+1;for(r=1;r<=u;r++){var f=p(t).subtract(12/n*r,"months");if(f<=p(e)){var h=p(t).subtract(12/n*(r-1),"months");a=p(h).diff(p(f),"days");break}}break;case 2:a=360/n;break;case 3:a=365/n;break;case 4:a=360/n}return a}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},COUPDAYSNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseInt(n);var a,o=0;if(4==arguments.length){if(o=l.getFirstValue(arguments[3]),S(o))return o;if(!b(o))return i.error.v;o=parseInt(o)}if(1!=n&&2!=n&&4!=n)return i.error.nm;if(o<0||o>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var u,f=Math.ceil(p(t).diff(p(e),"months")/(12/n))+1;for(r=1;r<=f;r++){if(p(t).subtract(12/n*r,"months")<=p(e)){a=p(t).subtract(12/n*(r-1),"months");break}}switch(o){case 0:var h=p(e).date(),s=p(e).month()+1,v=p(e).year(),c=p(a).date(),g=p(a).month()+1,m=p(a).year();31===h&&31===c?(h=30,c=30):31===h?h=30:30===h&&31===c&&(c=30),u=c+30*g+360*m-(h+30*s+360*v);break;case 1:case 2:case 3:u=p(a).diff(p(e),"days");break;case 4:h=p(e).date(),s=p(e).month()+1,v=p(e).year();u=(c=p(a).date())+30*(g=p(a).month()+1)+360*(m=p(a).year())-(h+30*s+360*v)}return u}catch(r){var y=r;return y=i.errorInfo(y),[i.error.v,y]}},COUPNCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseInt(n);var a,o=0;if(4==arguments.length){if(o=l.getFirstValue(arguments[3]),S(o))return o;if(!b(o))return i.error.v;o=parseInt(o)}if(1!=n&&2!=n&&4!=n)return i.error.nm;if(o<0||o>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var u=Math.ceil(p(t).diff(p(e),"months")/(12/n))+1;for(r=1;r<=u;r++){if(p(t).subtract(12/n*r,"months")<=p(e)){a=p(t).subtract(12/n*(r-1),"months");break}}return p(a).format("YYYY-MM-DD")}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},COUPPCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseInt(n);var a,o=0;if(4==arguments.length){if(o=l.getFirstValue(arguments[3]),S(o))return o;if(!b(o))return i.error.v;o=parseInt(o)}if(1!=n&&2!=n&&4!=n)return i.error.nm;if(o<0||o>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var u=Math.ceil(p(t).diff(p(e),"months")/(12/n))+1;for(r=1;r<=u;r++){var f=p(t).subtract(12/n*r,"months");if(f<=p(e)){a=f;break}}return p(a).format("YYYY-MM-DD")}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},FV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=0;if(arguments.length>=4){if(a=l.getFirstValue(arguments[3]),S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a)}var o,u=0;if(arguments.length>=5){if(u=l.getFirstValue(arguments[4]),S(u))return u;if(!b(u))return i.error.v;u=parseFloat(u)}if(0!=u&&1!=u)return i.error.nm;if(0===e)o=a+n*t;else{var f=Math.pow(1+e,t);o=1===u?a*f+n*(1+e)*(f-1)/e:a*f+n*(f-1)/e}return-o}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},FVSCHEDULE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=arguments[1],n=[];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;n=n.concat(l.getDataArr(t,!1))}else"object"==L(t)&&null!=t.startCell?n=n.concat(l.getCellDataArr(t,"number",!1)):n.push(t);var a=[];for(r=0;r<n.length;r++){var o=n[r];if(!b(o))return i.error.v;a.push(parseFloat(o))}var u=a.length,f=e;for(r=0;r<u;r++)f*=1+a[r];return f}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},YIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=l.getFirstValue(arguments[4]);if(S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o);var u=l.getFirstValue(arguments[5]);if(S(u))return u;if(!b(u))return i.error.v;u=parseInt(u);var f=0;if(7==arguments.length){if(f=l.getFirstValue(arguments[6]),S(f))return f;if(!b(f))return i.error.v;f=parseInt(f)}if(n<0)return i.error.nm;if(a<=0||o<=0)return i.error.nm;if(1!=u&&2!=u&&4!=u)return i.error.nm;if(f<0||f>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;if(window.luckysheet_function.COUPNUM.f(e,t,u,f)>1){var h=1,s=0,v=h;for(r=1;r<=100;r++){var c=window.luckysheet_function.PRICE.f(e,t,n,v,o,u,f);if(Math.abs(c-a)<1e-6)break;c>a?s=v:h=v,v=(h+s)/2}var g=v}else{var m=window.luckysheet_function.COUPDAYSNC.f(e,t,u,f),y=window.luckysheet_function.COUPDAYS.f(e,t,u,f),d=a/100+window.luckysheet_function.COUPDAYBS.f(e,t,u,f)/y*(n/u);g=(o/100+n/u-d)/d*(u*y/m)}return g}catch(r){var C=r;return C=i.errorInfo(C),[i.error.v,C]}},YIELDDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=0;if(5==arguments.length){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseInt(o)}return n<=0||a<=0?i.error.nm:o<0||o>4?i.error.nm:p(e)-p(t)>=0?i.error.nm:(a/n-1)/window.luckysheet_function.YEARFRAC.f(e,t,o)}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},NOMINAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t),e<=0||t<1?i.error.nm:(Math.pow(e+1,1/t)-1)*t):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},XIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"number",!1)):t.push(e);var n=[];for(r=0;r<t.length;r++){var a=t[r];if(!b(a))return i.error.v;n.push(parseFloat(a))}var o=l.getCellrangeDate(arguments[1]);if(S(o))return o;for(r=0;r<o.length;r++)if(!p(o[r]).isValid())return i.error.v;var u=.1;if(3==arguments.length){if(u=l.getFirstValue(arguments[2]),S(u))return u;if(!b(u))return i.error.v;u=parseFloat(u)}var f=!1,h=!1;for(r=0;r<n.length&&(n[r]>0&&(f=!0),n[r]<0&&(h=!0),!f||!h);r++);if(!f||!h)return i.error.nm;if(n.length!=o.length)return i.error.nm;var s,v,c,g=function(r,e,t){for(var n=t+1,a=r[0],o=1;o<r.length;o++)a+=r[o]/Math.pow(n,window.luckysheet_function.DAYS.f(e[o],e[0])/365);return a},m=function(r,e,t){for(var n=t+1,a=0,o=1;o<r.length;o++){var i=window.luckysheet_function.DAYS.f(e[o],e[0])/365;a-=i*r[o]/Math.pow(n,i+1)}return a},y=u,d=!0;do{s=y-(c=g(n,o,y))/m(n,o,y),v=Math.abs(s-y),y=s,d=v>1e-10&&Math.abs(c)>1e-10}while(d);return y}catch(r){var C=r;return C=i.errorInfo(C),[i.error.v,C]}},MIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"number",!1)):t.push(e);var n=[];for(r=0;r<t.length;r++){var a=t[r];if(!b(a))return i.error.v;n.push(parseFloat(a))}var o=l.getFirstValue(arguments[1]);if(S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o);var u=l.getFirstValue(arguments[2]);if(S(u))return u;if(!b(u))return i.error.v;u=parseFloat(u);var f=n.length,h=[],s=[];for(r=0;r<f;r++)n[r]<0?h.push(n[r]):s.push(n[r]);if(0==h.length||0==s.length)return i.error.d;var v=-window.luckysheet_function.NPV.f(u,s)*Math.pow(1+u,f-1),c=window.luckysheet_function.NPV.f(o,h)*(1+o);return Math.pow(v/c,1/(f-1))-1}catch(r){var g=r;return g=i.errorInfo(g),[i.error.v,g]}},IRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"number",!0)):t.push(e);var n=[];for(r=0;r<t.length;r++){var a=t[r];if(!b(a))return i.error.v;n.push(parseFloat(a))}var o=.1;if(2==arguments.length){if(o=l.getFirstValue(arguments[1]),S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o)}var u=[],f=!1,h=!1;for(r=0;r<t.length;r++)u[r]=0===r?0:u[r-1]+365,t[r]>0&&(f=!0),t[r]<0&&(h=!0);if(!f||!h)return i.error.nm;var s,v,c,g=function(r,e,t){for(var n=t+1,a=r[0],o=1;o<r.length;o++)a+=r[o]/Math.pow(n,(e[o]-e[0])/365);return a},m=function(r,e,t){for(var n=t+1,a=0,o=1;o<r.length;o++){var i=(e[o]-e[0])/365;a-=i*r[o]/Math.pow(n,i+1)}return a},p=o,y=!0;do{s=p-(c=g(n,u,p))/m(n,u,p),v=Math.abs(s-p),p=s,y=v>1e-10&&Math.abs(c)>1e-10}while(y);return p}catch(r){var d=r;return d=i.errorInfo(d),[i.error.v,d]}},NPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=[];for(r=1;r<arguments.length;r++){var n=arguments[r];if("array"==L(n)){if("array"==L(n[0])&&!l.isDyadicArr(n))return i.error.v;t=t.concat(l.getDataArr(n,!0))}else"object"==L(n)&&null!=n.startCell?t=t.concat(l.getCellDataArr(n,"number",!0)):t.push(n)}var a=[];for(r=0;r<t.length;r++){var o=t[r];b(o)&&a.push(parseFloat(o))}var u=0;if(a.length>0)for(r=0;r<a.length;r++)u+=a[r]/Math.pow(1+e,r+1);return u}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},XNPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=arguments[1],n=[];if("array"==L(t)){if("array"==L(t[0])&&!l.isDyadicArr(t))return i.error.v;n=n.concat(l.getDataArr(t,!1))}else"object"==L(t)&&null!=t.startCell?n=n.concat(l.getCellDataArr(t,"number",!1)):n.push(t);var a=[];for(r=0;r<n.length;r++){var o=n[r];if(!b(o))return i.error.v;a.push(parseFloat(o))}var u=l.getCellrangeDate(arguments[2]);if(S(u))return u;for(r=0;r<u.length;r++)if(!p(u[r]).isValid())return i.error.v;if(a.length!=u.length)return i.error.nm;var f=0;for(r=0;r<a.length;r++)f+=a[r]/Math.pow(1+e,window.luckysheet_function.DAYS.f(u[r],u[0])/365);return f}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},CUMIPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseInt(a);var o=l.getFirstValue(arguments[4]);if(S(o))return o;if(!b(o))return i.error.v;o=parseInt(o);var u=l.getFirstValue(arguments[5]);if(S(u))return u;if(!b(u))return i.error.v;if(u=parseFloat(u),e<=0||t<=0||n<=0)return i.error.nm;if(a<1||o<1||a>o)return i.error.nm;if(0!=u&&1!=u)return i.error.nm;var f=window.luckysheet_function.PMT.f(e,t,n,0,u),h=0;1===a&&0===u&&(h=-n,a++);for(r=a;r<=o;r++)h+=1===u?window.luckysheet_function.FV.f(e,r-2,f,n,1)-f:window.luckysheet_function.FV.f(e,r-1,f,n,0);return h*=e}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},PMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=0;if(arguments.length>=4){if(a=l.getFirstValue(arguments[3]),S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a)}var o,u=0;if(5==arguments.length){if(u=l.getFirstValue(arguments[4]),S(u))return u;if(!b(u))return i.error.v;u=parseFloat(u)}if(0!=u&&1!=u)return i.error.nm;if(0===e)o=(n+a)/t;else{var f=Math.pow(1+e,t);o=1===u?(a*e/(f-1)+n*e/(1-1/f))/(1+e):a*e/(f-1)+n*e/(1-1/f)}return-o}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},IPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=0;if(arguments.length>=5){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o)}var u=0;if(arguments.length>=6){if(u=l.getFirstValue(arguments[5]),S(u))return u;if(!b(u))return i.error.v;u=parseFloat(u)}if(t<1||t>n)return i.error.nm;if(0!=u&&1!=u)return i.error.nm;var f=window.luckysheet_function.PMT.f(e,n,a,o,u);return(1===t?1===u?0:-a:1===u?window.luckysheet_function.FV.f(e,t-2,f,a,1)-f:window.luckysheet_function.FV.f(e,t-1,f,a,0))*e}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},PPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=0;if(arguments.length>=5){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o)}var u=0;if(arguments.length>=6){if(u=l.getFirstValue(arguments[5]),S(u))return u;if(!b(u))return i.error.v;u=parseFloat(u)}return t<1||t>n?i.error.nm:0!=u&&1!=u?i.error.nm:window.luckysheet_function.PMT.f(e,n,a,o,u)-window.luckysheet_function.IPMT.f(e,t,n,a,o,u)}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},INTRATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=0;if(5==arguments.length){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseInt(o)}if(n<=0||a<=0)return i.error.nm;if(o<0||o>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var u,f=p(e).date(),h=p(e).month()+1,s=p(e).year(),v=p(t).date(),c=p(t).month()+1,g=p(t).year();switch(o){case 0:31===f&&31===v?(f=30,v=30):31===f?f=30:30===f&&31===v&&(v=30),u=360/(v+30*c+360*g-(f+30*h+360*s));break;case 1:var m=365;if(s===g||s+1===g&&(h>c||h===c&&f>=v))return(s===g&&l.isLeapYear(s)||l.feb29Between(e,t)||1===c&&29===v)&&(m=366),u=m/p(t).diff(p(e),"days"),u*=(a-n)/n;var y=g-s+1;u=(p().set({year:g+1,month:0,date:1})-p().set({year:s,month:0,date:1}))/1e3/60/60/24/y/p(t).diff(p(e),"days");break;case 2:u=360/p(t).diff(p(e),"days");break;case 3:u=365/p(t).diff(p(e),"days");break;case 4:u=360/(v+30*c+360*g-(f+30*h+360*s))}return u*=(a-n)/n}catch(r){var d=r;return d=i.errorInfo(d),[i.error.v,d]}},PRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=l.getFirstValue(arguments[4]);if(S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o);var u=l.getFirstValue(arguments[5]);if(S(u))return u;if(!b(u))return i.error.v;u=parseInt(u);var f=0;if(7==arguments.length){if(f=l.getFirstValue(arguments[6]),S(f))return f;if(!b(f))return i.error.v;f=parseInt(f)}if(n<0||a<0)return i.error.nm;if(o<=0)return i.error.nm;if(1!=u&&2!=u&&4!=u)return i.error.nm;if(f<0||f>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var h=window.luckysheet_function.COUPDAYSNC.f(e,t,u,f),s=window.luckysheet_function.COUPDAYS.f(e,t,u,f),v=window.luckysheet_function.COUPDAYBS.f(e,t,u,f),c=window.luckysheet_function.COUPNUM.f(e,t,u,f);if(c>1){var g=o/Math.pow(1+a/u,c-1+h/s),m=0;for(r=1;r<=c;r++)m+=100*n/u/Math.pow(1+a/u,r-1+h/s);var y=g+m-n/u*100*(v/s)}else y=(g=n/u*100+o)/(m=a/u*((s-v)/s)+1)-n/u*100*(v/s);return y}catch(r){var d=r;return d=i.errorInfo(d),[i.error.v,d]}},PRICEDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=0;if(5==arguments.length){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseInt(o)}if(n<=0||a<=0)return i.error.nm;if(o<0||o>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var u,f=p(e).date(),h=p(e).month()+1,s=p(e).year(),v=p(t).date(),c=p(t).month()+1,g=p(t).year();switch(o){case 0:31===f&&31===v?(f=30,v=30):31===f?f=30:30===f&&31===v&&(v=30),u=(v+30*c+360*g-(f+30*h+360*s))/360;break;case 1:var m=365;if(s===g||s+1===g&&(h>c||h===c&&f>=v))return(s===g&&l.isLeapYear(s)||l.feb29Between(e,t)||1===c&&29===v)&&(m=366),u=a-n*a*(u=p(t).diff(p(e),"days")/m);var y=g-s+1,d=(p().set({year:g+1,month:0,date:1})-p().set({year:s,month:0,date:1}))/1e3/60/60/24/y;u=p(t).diff(p(e),"days")/d;break;case 2:u=p(t).diff(p(e),"days")/360;break;case 3:u=p(t).diff(p(e),"days")/365;break;case 4:u=(v+30*c+360*g-(f+30*h+360*s))/360}return u=a-n*a*u}catch(r){var C=r;return C=i.errorInfo(C),[i.error.v,C]}},PRICEMAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getCellDate(arguments[2]);if(S(n))return n;if(!p(n).isValid())return i.error.v;var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=l.getFirstValue(arguments[4]);if(S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o);var u=0;if(6==arguments.length){if(u=l.getFirstValue(arguments[5]),S(u))return u;if(!b(u))return i.error.v;u=parseInt(u)}if(a<0||o<0)return i.error.nm;if(u<0||u>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var f=p(e).date(),h=p(e).month()+1,s=p(e).year(),v=p(t).date(),c=p(t).month()+1,g=p(t).year(),m=p(n).date(),y=p(n).month()+1,d=p(n).year();switch(u){case 0:31==f&&(f=30),31==v&&(v=30),31==m&&(m=30);var C=360,F=v+30*c+360*g-(f+30*h+360*s),I=v+30*c+360*g-(m+30*y+360*d),w=f+30*h+360*s-(m+30*y+360*d);break;case 1:var D=365;if(s===g||s+1===g&&(h>c||h===c&&f>=v)){(s===g&&l.isLeapYear(s)||l.feb29Between(e,t)||1===c&&29===v)&&(D=366);C=D,F=p(t).diff(p(e),"days");return(100+(I=p(e).diff(p(n),"days"))/C*a*100)/(1+F/C*o)-(w=p(t).diff(p(n),"days"))/C*a*100}var k=g-s+1;C=(p().set({year:g+1,month:0,date:1})-p().set({year:s,month:0,date:1}))/1e3/60/60/24/k,F=p(t).diff(p(e),"days"),I=p(e).diff(p(n),"days"),w=p(t).diff(p(n),"days");break;case 2:C=360,F=p(t).diff(p(e),"days"),I=p(e).diff(p(n),"days"),w=p(t).diff(p(n),"days");break;case 3:C=365,F=p(t).diff(p(e),"days"),I=p(e).diff(p(n),"days"),w=p(t).diff(p(n),"days");break;case 4:C=360,F=v+30*c+360*g-(f+30*h+360*s),I=v+30*c+360*g-(m+30*y+360*d),w=f+30*h+360*s-(m+30*y+360*d)}return(100+I/C*a*100)/(1+F/C*o)-w/C*a*100}catch(r){var A=r;return A=i.errorInfo(A),[i.error.v,A]}},RECEIVED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=0;if(5==arguments.length){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o)}if(n<=0||a<=0)return i.error.nm;if(o<0||o>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var u=p(e).date(),f=p(e).month()+1,h=p(e).year(),s=p(t).date(),v=p(t).month()+1,c=p(t).year();switch(o){case 0:31==u&&(u=30),31==s&&(s=30);var g=360,m=s+30*v+360*c-(u+30*f+360*h);break;case 1:var y=365;if(h===c||h+1===c&&(f>v||f===v&&u>=s)){(h===c&&l.isLeapYear(h)||l.feb29Between(e,t)||1===v&&29===s)&&(y=366);g=y;return n/(1-a*(m=p(t).diff(p(e),"days"))/g)}var d=c-h+1;g=(p().set({year:c+1,month:0,date:1})-p().set({year:h,month:0,date:1}))/1e3/60/60/24/d,m=p(t).diff(p(e),"days");break;case 2:g=360,m=p(t).diff(p(e),"days");break;case 3:g=365,m=p(t).diff(p(e),"days");break;case 4:g=360,m=s+30*v+360*c-(u+30*f+360*h)}return n/(1-a*m/g)}catch(r){var C=r;return C=i.errorInfo(C),[i.error.v,C]}},DISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=0;if(5==arguments.length){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o)}if(n<=0||a<=0)return i.error.nm;if(o<0||o>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var u=p(e).date(),f=p(e).month()+1,h=p(e).year(),s=p(t).date(),v=p(t).month()+1,c=p(t).year();switch(o){case 0:31==u&&(u=30),31==s&&(s=30);var g=360,m=s+30*v+360*c-(u+30*f+360*h);break;case 1:var y=365;if(h===c||h+1===c&&(f>v||f===v&&u>=s))return(h===c&&l.isLeapYear(h)||l.feb29Between(e,t)||1===v&&29===s)&&(y=366),(a-n)/a*((g=y)/(m=p(t).diff(p(e),"days")));var d=c-h+1;g=(p().set({year:c+1,month:0,date:1})-p().set({year:h,month:0,date:1}))/1e3/60/60/24/d,m=p(t).diff(p(e),"days");break;case 2:g=360,m=p(t).diff(p(e),"days");break;case 3:g=365,m=p(t).diff(p(e),"days");break;case 4:g=360,m=s+30*v+360*c-(u+30*f+360*h)}return(a-n)/a*(g/m)}catch(r){var C=r;return C=i.errorInfo(C),[i.error.v,C]}},NPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=0;if(arguments.length>=4){if(a=l.getFirstValue(arguments[3]),S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a)}var o=0;if(arguments.length>=5){if(o=l.getFirstValue(arguments[4]),S(o))return o;if(!b(o))return i.error.v;o=parseFloat(o)}if(0!=o&&1!=o)return i.error.nm;var u=t*(1+e*o)-a*e,f=n*e+t*(1+e*o);return Math.log(u/f)/Math.log(1+e)}catch(r){var h=r;return h=i.errorInfo(h),[i.error.v,h]}},SLN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n=l.getFirstValue(arguments[2]);return S(n)?n:b(n)?0==(n=parseFloat(n))?i.error.d:(e-t)/n:i.error.v}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},DURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=l.getFirstValue(arguments[4]);if(S(o))return o;if(!b(o))return i.error.v;o=parseInt(o);var u=0;if(6==arguments.length){if(u=l.getFirstValue(arguments[5]),S(u))return u;if(!b(u))return i.error.v;u=parseInt(u)}if(n<0||a<0)return i.error.nm;if(1!=o&&2!=o&&4!=o)return i.error.nm;if(u<0||u>4)return i.error.nm;if(p(e)-p(t)>=0)return i.error.nm;var f=window.luckysheet_function.COUPNUM.f(e,t,o,u),h=0,s=0;for(r=1;r<=f;r++)h+=n/o*100*r/Math.pow(1+a/o,r),s+=n/o*100/Math.pow(1+a/o,r);var v=(h+100*f/Math.pow(1+a/o,f))/(s+100/Math.pow(1+a/o,f));return v/=o}catch(r){var c=r;return c=i.errorInfo(c),[i.error.v,c]}},MDURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellDate(arguments[0]);if(S(e))return e;if(!p(e).isValid())return i.error.v;var t=l.getCellDate(arguments[1]);if(S(t))return t;if(!p(t).isValid())return i.error.v;var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n);var a=l.getFirstValue(arguments[3]);if(S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a);var o=l.getFirstValue(arguments[4]);if(S(o))return o;if(!b(o))return i.error.v;o=parseInt(o);var u=0;if(6==arguments.length){if(u=l.getFirstValue(arguments[5]),S(u))return u;if(!b(u))return i.error.v;u=parseInt(u)}return n<0||a<0?i.error.nm:1!=o&&2!=o&&4!=o?i.error.nm:u<0||u>4?i.error.nm:p(e)-p(t)>=0?i.error.nm:window.luckysheet_function.DURATION.f(e,t,n,a,o,u)/(1+a/o)}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},BIN2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!/^[01]{1,10}$/g.test(e))return i.error.nm;var t=parseInt(e,2),n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:t}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},BIN2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;var t=null;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}if(!/^[01]{1,10}$/g.test(e))return i.error.nm;var n=parseInt(e,2).toString(16).toUpperCase();return null==t?n:t<0||t<n.length?i.error.nm:new Array(t-n.length+1).join("0")+n}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},BIN2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;var t=null;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}if(!/^[01]{1,10}$/g.test(e))return i.error.nm;var n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var a=parseInt(e,2).toString(8);return null==t?a:t<0||t<a.length?i.error.nm:new Array(t-a.length+1).join("0")+a}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},DEC2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=null;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return i.error.nm;if(e<0)return"1"+new Array(9-(512+e).toString(2).length).join("0")+(512+e).toString(2);var n=parseInt(e,10).toString(2);return null==t?n:t<0||t<n.length?i.error.nm:new Array(t-n.length+1).join("0")+n}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},DEC2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=null;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return i.error.nm;if(e<0)return(1099511627776+e).toString(16).toUpperCase();var n=parseInt(e,10).toString(16).toUpperCase();return null==t?n:t<0||t<n.length?i.error.nm:new Array(t-n.length+1).join("0")+n}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},DEC2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=null;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return i.error.nm;if(e<0)return(1073741824+e).toString(8);var n=parseInt(e,10).toString(8);return null==t?n:t<0||t<n.length?i.error.nm:new Array(t-n.length+1).join("0")+n}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},HEX2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;var t=null;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return i.error.nm;var n=10===e.length&&"f"===e.substring(0,1).toLowerCase(),a=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(a<-512||a>511)return i.error.nm;if(n)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var o=a.toString(2);return null==t?o:t<0||t<o.length?i.error.nm:new Array(t-o.length+1).join("0")+o}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},HEX2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return i.error.nm;var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},HEX2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;var t=null;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return i.error.nm;var n=parseInt(e,16);if(n>536870911&&n<0xffe0000000)return i.error.nm;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var a=n.toString(8);return null==t?a:t<0||t<a.length?i.error.nm:new Array(t-a.length+1).join("0")+a}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},OCT2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;var t=null;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}if(!/^[0-7]{1,10}$/.test(e))return i.error.nm;var n=10===(e=e.toString()).length&&"7"===e.substring(0,1),a=n?parseInt(e,8)-1073741824:parseInt(e,8);if(a<-512||a>511)return E.num;if(n)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var o=a.toString(2);return null==t?o:t<0||t<o.length?i.error.nm:new Array(t-o.length+1).join("0")+o}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},OCT2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!/^[0-7]{1,10}$/.test(e))return i.error.nm;var t=parseInt(e,8);return t>=536870912?t-1073741824:t}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},OCT2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;var t=null;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}if(!/^[0-7]{1,10}$/.test(e))return i.error.nm;var n=parseInt(e,8);if(n>=536870912)return"FF"+(n+3221225472).toString(16).toUpperCase();var a=n.toString(16).toUpperCase();return null==t?a:t<0||t<a.length?i.error.nm:new Array(t-a.length+1).join("0")+a}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},COMPLEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t);var n="i";if(3==arguments.length&&(n=arguments[2].toString()),"i"!=n&&"j"!=n)return i.error.v;if(0===e&&0===t)return 0;if(0===e)return 1===t?n:t.toString()+n;if(0===t)return e.toString();var a=t>0?"+":"";return e.toString()+a+(1===t?n:t.toString()+n)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},IMREAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if("true"==(e=e.toString()).toLowerCase()||"false"==e.toLowerCase())return i.error.v;if("0"==e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var t=e.indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var a=e.substring(e.length-1,e.length),o="i"===a||"j"===a;return t>=0||n>=0?o?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?i.error.nm:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?i.error.nm:Number(e.substring(0,n)):i.error.nm:o?isNaN(e.substring(0,e.length-1))?i.error.nm:0:isNaN(e)?i.error.nm:e}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},IMAGINARY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if("true"==(e=e.toString()).toLowerCase()||"false"==e.toLowerCase())return i.error.v;if("0"==e)return 0;if(["i","j"].indexOf(e)>=0)return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var a=e.substring(e.length-1,e.length),o="i"===a||"j"===a;return t>=0||n>=0?o?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?i.error.nm:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?i.error.nm:-Number(e.substring(n+1,e.length-1)):i.error.nm:o?isNaN(e.substring(0,e.length-1))?i.error.nm:e.substring(0,e.length-1):isNaN(e)?i.error.nm:0}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},IMCONJUGATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;e=e.toString();var t=window.luckysheet_function.IMREAL.f(e);if(S(t))return t;var n=window.luckysheet_function.IMAGINARY.f(e);if(S(n))return n;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",0!==n?window.luckysheet_function.COMPLEX.f(t,-n,a):e}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},IMABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheet_function.IMREAL.f(arguments[0]);if(S(e))return e;var t=window.luckysheet_function.IMAGINARY.f(arguments[0]);return S(t)?t:Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},DELTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=0;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseFloat(t)}return e===t?1:0}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},IMSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheet_function.IMREAL.f(arguments[0]);if(S(e))return e;var t=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(S(t))return t;var n=arguments[0];for(r=1;r<arguments.length;r++){var a=window.luckysheet_function.IMREAL.f(n);if(S(a))return a;var o=window.luckysheet_function.IMAGINARY.f(n);if(S(o))return o;var l=window.luckysheet_function.IMREAL.f(arguments[r]);if(S(l))return l;var u=window.luckysheet_function.IMAGINARY.f(arguments[r]);if(S(u))return u;n=window.luckysheet_function.COMPLEX.f(a+l,o+u)}return n}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},IMSUB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if("true"==(e=e.toString()).toLowerCase()||"false"==e.toLowerCase())return i.error.v;var t=window.luckysheet_function.IMREAL.f(e);if(S(t))return t;var n=window.luckysheet_function.IMAGINARY.f(e);if(S(n))return n;var a=l.getFirstValue(arguments[1]);if(S(a))return a;if("true"==(a=a.toString()).toLowerCase()||"false"==a.toLowerCase())return i.error.v;var o=window.luckysheet_function.IMREAL.f(a);if(S(o))return o;var u=window.luckysheet_function.IMAGINARY.f(a);if(S(u))return u;var f=e.substring(e.length-1),h=a.substring(a.length-1),s="i";return"j"===f?s="j":"j"===h&&(s="j"),window.luckysheet_function.COMPLEX.f(t-o,n-u,s)}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},IMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheet_function.IMREAL.f(arguments[0]);if(S(e))return e;var t=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(S(t))return t;var n=arguments[0];for(r=1;r<arguments.length;r++){var a=window.luckysheet_function.IMREAL.f(n);if(S(a))return a;var o=window.luckysheet_function.IMAGINARY.f(n);if(S(o))return o;var l=window.luckysheet_function.IMREAL.f(arguments[r]);if(S(l))return l;var u=window.luckysheet_function.IMAGINARY.f(arguments[r]);if(S(u))return u;n=window.luckysheet_function.COMPLEX.f(a*l-o*u,a*u+o*l)}return n}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},IMDIV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if("true"==(e=e.toString()).toLowerCase()||"false"==e.toLowerCase())return i.error.v;var t=window.luckysheet_function.IMREAL.f(e);if(S(t))return t;var n=window.luckysheet_function.IMAGINARY.f(e);if(S(n))return n;var a=l.getFirstValue(arguments[1]);if(S(a))return a;if("true"==(a=a.toString()).toLowerCase()||"false"==a.toLowerCase())return i.error.v;var o=window.luckysheet_function.IMREAL.f(a);if(S(o))return o;var u=window.luckysheet_function.IMAGINARY.f(a);if(S(u))return u;var f=e.substring(e.length-1),h=a.substring(a.length-1),s="i";if("j"===f?s="j":"j"===h&&(s="j"),0===o&&0===u)return i.error.nm;var v=o*o+u*u;return window.luckysheet_function.COMPLEX.f((t*o+n*u)/v,(n*o-t*u)/v,s)}catch(r){var c=r;return c=i.errorInfo(c),[i.error.v,c]}},NOT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellBoolen(arguments[0]);return S(e)?e:!e}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},TRUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return!0}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},FALSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return!1}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},AND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=!0;for(r=0;r<arguments.length;r++){var t=l.getCellBoolen(arguments[r]);if(S(t))return t;if(!t){e=!1;break}}return e}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},IFERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[1],"text"),t=l.getFirstValue(arguments[0],"text");return S(t)||"string"===L(t)&&""===$.trim(t)?e:t}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},IF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getCellBoolen(arguments[0]);if(S(e))return e;var t=l.getFirstValue(arguments[1],"text");if(S(t)&&n!=E.d)return t;var n="";return 3==arguments.length&&(n=l.getFirstValue(arguments[2],"text"),S(n)&&n!=E.d)?n:e?t:n}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},OR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=!1;for(r=0;r<arguments.length;r++){var t=l.getCellBoolen(arguments[r]);if(S(t))return t;if(t){e=!0;break}}return e}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},NE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;var t=l.getFirstValue(arguments[1]);return S(t)?t:e!=t}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;var t=l.getFirstValue(arguments[1]);return S(t)?t:e==t}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},GT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?e>(t=parseFloat(t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},GTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?e>=(t=parseFloat(t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},LT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?e<(t=parseFloat(t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},LTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?e<=(t=parseFloat(t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ADD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?e+(t=parseFloat(t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},MINUS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?e-(t=parseFloat(t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},MULTIPLY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?e*(t=parseFloat(t)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},DIVIDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?0==(t=parseFloat(t))?i.error.d:e/t:i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},CONCAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;var t=l.getFirstValue(arguments[1],"text");return S(t)?t:e+""+t}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},UNARY_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;var t=(e=parseFloat(e))/100;return Math.round(100*t)/100}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},CONCATENATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e="";for(r=0;r<arguments.length;r++){var t=l.getFirstValue(arguments[r],"text");if(S(t))return t;e=e+""+t}return e}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},CODE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:""==e?i.error.v:e.charCodeAt(0)}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},CHAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseInt(e))<1||e>255?i.error.v:String.fromCharCode(e):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},ARABIC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;if(e=e.toString().toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return i.error.v;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(r){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),t}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ROMAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;if(0==(e=parseInt(e)))return"";if(e<1||e>3999)return i.error.v;return n=e,(a=[["","I","II","III","IV","V","VI","VII","VIII","IX"],["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"],["","M","MM","MMM"]])[3][Math.floor(n/1e3)]+a[2][Math.floor(n%1e3/100)]+a[1][Math.floor(n%100/10)]+a[0][n%10]}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}var n,a},REGEXEXTRACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;var t=l.getFirstValue(arguments[1],"text");if(S(t))return t;var n=e.match(new RegExp(t));return n?n[n.length>1?n.length-1:0]:null}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},REGEXMATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;var t=l.getFirstValue(arguments[1],"text");return S(t)?t:!!e.match(new RegExp(t))}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},REGEXREPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;var t=l.getFirstValue(arguments[1],"text");if(S(t))return t;var n=l.getFirstValue(arguments[2],"text");return S(n)?n:e.replace(new RegExp(t),n)}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:"string"==L(e)?e:""}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},FIXED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=2;if(arguments.length>=2){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}var n=!1;if(3==arguments.length&&(n=l.getCellBoolen(arguments[2]),S(n)))return n;if(t>127)return i.error.v;var a=n?"0":"#,##0";return t<=0?e=Math.round(e*Math.pow(10,t))/Math.pow(10,t):t>0&&(a+="."+new Array(t+1).join("0")),N(a,e)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},FIND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;e=e.toString();var t=l.getFirstValue(arguments[1],"text");if(S(t))return t;t=t.toString();var n=1;if(3==arguments.length){if(n=l.getFirstValue(arguments[2]),S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n)}return n<0||n>t.length?i.error.v:""==e?n:-1==t.indexOf(e)?i.error.v:t.indexOf(e,n-1)+1}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},FINDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;e=e.toString();var t=l.getFirstValue(arguments[1],"text");if(S(t))return t;t=t.toString();var n=1;if(3==arguments.length){if(n=l.getFirstValue(arguments[2]),S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n)}if(n<0||n>t.length)return i.error.v;if(""==e)return n;if(-1==t.indexOf(e))return i.error.v;var a=t.split(""),o=t.indexOf(e,n-1),u=0;for(r=0;r<o;r++)/[^\x00-\xff]/g.test(a[r])?u+=2:u+=1;return u}catch(r){var f=r;return f=i.errorInfo(f),[i.error.v,f]}},JOIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;var t=[];for(r=1;r<arguments.length;r++){var n=arguments[r];if("array"==L(n)){if("array"==L(n[0])&&!l.isDyadicArr(n))return i.error.v;t=t.concat(l.getDataArr(n,!1))}else"object"==L(n)&&null!=n.startCell?t=t.concat(l.getCellDataArr(n,"text",!1)):t.push(n)}return t.join(e)}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},LEFT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;e=e.toString();var t=1;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}return t<0?i.error.v:t>=e.length?e:0==t?"":e.substr(0,t)}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},RIGHT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;e=e.toString();var t=1;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}return t<0?i.error.v:t>=e.length?e:0==t?"":e.substr(-t,t)}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},MID:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;e=e.toString();var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=l.getFirstValue(arguments[2]);return S(n)?n:b(n)?(n=parseInt(n),t<1||n<0?i.error.v:t>e.length?"":t+n>e.length?e.substr(t-1,e.length-t+1):e.substr(t-1,n)):i.error.v}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},LEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:(e=e.toString()).length}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},LENB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:(e=e.toString()).replace(/[^\x00-\xff]/g,"aa").length}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},LOWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:(e=e.toString())?e.toLowerCase():e}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},UPPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:(e=e.toString())?e.toUpperCase():e}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},EXACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;e=e.toString();var t=l.getFirstValue(arguments[1],"text");return S(t)?t:e===(t=t.toString())}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},REPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;e=e.toString();var t=l.getFirstValue(arguments[1]);if(S(t))return t;if(!b(t))return i.error.v;t=parseInt(t);var n=l.getFirstValue(arguments[2]);if(S(n))return n;if(!b(n))return i.error.v;n=parseInt(n);var a=l.getFirstValue(arguments[3],"text");return S(a)?a:(a=a.toString(),e.substr(0,t-1)+a+e.substr(t-1+n))}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},REPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;e=e.toString();var t=l.getFirstValue(arguments[1]);return S(t)?t:b(t)?(t=parseInt(t))<0?i.error.v:(t>100&&(t=100),new Array(t+1).join(e)):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},SEARCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;e=e.toString();var t=l.getFirstValue(arguments[1],"text");if(S(t))return t;t=t.toString();var n=1;if(3==arguments.length){if(n=l.getFirstValue(arguments[2]),S(n))return n;if(!b(n))return i.error.v;n=parseInt(n)}if(n<=0||n>t.length)return i.error.v;var a=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1;return 0===a?i.error.v:a}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},SUBSTITUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;e=e.toString();var t=l.getFirstValue(arguments[1],"text");if(S(t))return t;t=t.toString();var n=l.getFirstValue(arguments[2],"text");if(S(n))return n;n=n.toString();var a=null;if(4==arguments.length){if(a=l.getFirstValue(arguments[3]),S(a))return a;if(!b(a))return i.error.v;a=parseInt(a)}var o,u=new RegExp(t,"g");if(null==a)o=e.replace(u,n);else{if(a<=0)return i.error.v;var f=e.match(u);if(null==f||a>f.length)return e;var h=t.length,s=0;for(r=1;r<=a;r++)s=e.indexOf(t,s)+1;o=e.substring(0,s-1)+n+e.substring(s-1+h)}return o}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},CLEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");if(S(e))return e;e=e.toString();var t=[];for(r=0;r<e.length;r++){var n=e.charCodeAt(r);(/[\u4e00-\u9fa5]/g.test(e.charAt(r))||n>31&&n<127)&&t.push(e.charAt(r))}return t.join("")}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1],"text");return S(t)?t:(t=t.toString(),N(t,e))}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},TRIM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:(e=e.toString()).replace(/ +/g," ").trim()}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},VALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:(e=e.toString(),R(e)[2])}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},PROPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:(e=e.toString().toLowerCase()).replace(/[a-zA-Z]+/g,function(r){return r.substring(0,1).toUpperCase()+r.substring(1)})}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},CONVERT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseFloat(e);var t=l.getFirstValue(arguments[1],"text");if(S(t))return t;t=t.toString();var n=l.getFirstValue(arguments[2],"text");if(S(n))return n;n=n.toString();var a,o=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],u={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},f={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},h=null,s=null,v=t,c=n,g=1,m=1;for(r=0;r<o.length;r++)a=null===o[r][2]?[]:o[r][2],(o[r][1]===v||a.indexOf(v)>=0)&&(h=o[r]),(o[r][1]===c||a.indexOf(c)>=0)&&(s=o[r]);if(null===h){var p=u[t.substring(0,2)],y=f[t.substring(0,1)];"da"===t.substring(0,2)&&(y=["dekao",10,"da"]),p?(g=p[2],v=t.substring(2)):y&&(g=y[1],v=t.substring(y[2].length));for(var d=0;d<o.length;d++)a=null===o[d][2]?[]:o[d][2],(o[d][1]===v||a.indexOf(v)>=0)&&(h=o[d])}if(null===s){var C=u[n.substring(0,2)],F=f[n.substring(0,1)];"da"===n.substring(0,2)&&(F=["dekao",10,"da"]),C?(m=C[2],c=n.substring(2)):F&&(m=F[1],c=n.substring(F[2].length));for(var I=0;I<o.length;I++)a=null===o[I][2]?[]:o[I][2],(o[I][1]===c||a.indexOf(c)>=0)&&(s=o[I])}return null===h||null===s?i.error.na:h[3]!==s[3]?i.error.na:e*h[6]*g/(s[6]*m)}catch(r){var w=r;return w=i.errorInfo(w),[i.error.v,w]}},SUMX2MY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"text",!1)):t.push(e);var n=arguments[1],a=[];if("array"==L(n)){if("array"==L(n[0])&&!l.isDyadicArr(n))return i.error.v;a=a.concat(l.getDataArr(n,!1))}else"object"==L(n)&&null!=n.startCell?a=a.concat(l.getCellDataArr(n,"text",!1)):a.push(n);if(t.length!=a.length)return i.error.na;var o=[],u=[];for(r=0;r<t.length;r++){var f=t[r],h=a[r];b(f)&&b(h)&&(o.push(parseFloat(f)),u.push(parseFloat(h)))}var s=0;for(r=0;r<o.length;r++)s+=Math.pow(o[r],2)-Math.pow(u[r],2);return s}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},SUMX2PY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"text",!1)):t.push(e);var n=arguments[1],a=[];if("array"==L(n)){if("array"==L(n[0])&&!l.isDyadicArr(n))return i.error.v;a=a.concat(l.getDataArr(n,!1))}else"object"==L(n)&&null!=n.startCell?a=a.concat(l.getCellDataArr(n,"text",!1)):a.push(n);if(t.length!=a.length)return i.error.na;var o=[],u=[];for(r=0;r<t.length;r++){var f=t[r],h=a[r];b(f)&&b(h)&&(o.push(parseFloat(f)),u.push(parseFloat(h)))}var s=0;for(r=0;r<o.length;r++)s+=Math.pow(o[r],2)+Math.pow(u[r],2);return s}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},SUMXMY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!1))}else"object"==L(e)&&null!=e.startCell?t=t.concat(l.getCellDataArr(e,"text",!1)):t.push(e);var n=arguments[1],a=[];if("array"==L(n)){if("array"==L(n[0])&&!l.isDyadicArr(n))return i.error.v;a=a.concat(l.getDataArr(n,!1))}else"object"==L(n)&&null!=n.startCell?a=a.concat(l.getCellDataArr(n,"text",!1)):a.push(n);if(t.length!=a.length)return i.error.na;var o=[],u=[];for(r=0;r<t.length;r++){var f=t[r],h=a[r];b(f)&&b(h)&&(o.push(parseFloat(f)),u.push(parseFloat(h)))}var s=0;for(r=0;r<o.length;r++)s+=Math.pow(o[r]-u[r],2);return s}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},TRANSPOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=l.getDataDyadicArr(e)}else"object"==L(e)&&null!=e.startCell&&(t=l.getCellDataDyadicArr(e,"number"));return t=t[0].map(function(r,e){return t.map(function(r){return r[e]})})}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},TREND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=l.getDataDyadicArr(e)}else if("object"==L(e)&&null!=e.startCell)t=l.getCellDataDyadicArr(e,"text");else{if(!b(e))return i.error.v;(m=[]).push(parseFloat(e)),t.push(m)}var n=t.length,a=t[0].length;for(r=0;r<n;r++)for(var o=0;o<a;o++){if(!b(t[r][o]))return i.error.v;t[r][o]=parseFloat(t[r][o])}var u=[];for(r=1;r<=n;r++)for(o=1;o<=a;o++){var f=(r-1)*a+o;u.push(f)}if(arguments.length>=2){var h=arguments[1];if(u=[],"array"==L(h)){if("array"==L(h[0])&&!l.isDyadicArr(h))return i.error.v;u=l.getDataDyadicArr(h)}else if("object"==L(h)&&null!=h.startCell)u=l.getCellDataDyadicArr(h,"text");else{if(!b(h))return i.error.v;(m=[]).push(parseFloat(h)),u.push(m)}for(r=0;r<u.length;r++)for(o=0;o<u[0].length;o++){if(!b(u[r][o]))return i.error.v;u[r][o]=parseFloat(u[r][o])}}var s=u.length,v=u[0].length,c=u;if(arguments.length>=3){var g=arguments[2];if(c=[],"array"==L(g)){if("array"==L(g[0])&&!l.isDyadicArr(g))return i.error.v;c=l.getDataDyadicArr(g)}else if("object"==L(g)&&null!=g.startCell)c=l.getCellDataDyadicArr(g,"text");else{if(!b(g))return i.error.v;var m;(m=[]).push(parseFloat(g)),c.push(m)}for(r=0;r<c.length;r++)for(o=0;o<c[0].length;o++){if(!b(c[r][o]))return i.error.v;c[r][o]=parseFloat(c[r][o])}}var p=!0;if(4==arguments.length&&(p=l.getCellBoolen(arguments[3]),S(p)))return p;if(n!=s||a!=v)return i.error.r;var y=function(r,e){for(var t=0,n=0,a=0,o=0,i=0;i<r.length;i++)for(var l=0;l<r[i].length;l++)t+=r[i][l],n+=e[i][l],a+=r[i][l]*e[i][l],o+=r[i][l]*r[i][l];var u=r.length*r[0].length,f=t/u,h=n/u,s=(a/u-f*h)/(o/u-f*f);return[s,h-s*f]}(u,t),d=y[0];if(p)var C=y[1];else C=0;var F=[];for(r=0;r<c.length;r++)for(o=0;o<c[r].length;o++){var I=d*c[r][o]+C;F.push(Math.round(1e9*I)/1e9)}return F}catch(r){var w=r;return w=i.errorInfo(w),[i.error.v,w]}},FREQUENCY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=t.concat(l.getDataArr(e,!0))}else if("object"==L(e)&&null!=e.startCell)t=t.concat(l.getCellDataArr(e,"number",!0));else{if(!b(e))return i.error.v;t.push(e)}var n=[];for(r=0;r<t.length;r++)b(t[r])&&n.push(parseFloat(t[r]));var a=arguments[1],o=[];if("array"==L(a)){if("array"==L(a[0])&&!l.isDyadicArr(a))return i.error.v;o=o.concat(l.getDataArr(a,!0))}else if("object"==L(a)&&null!=a.startCell)o=o.concat(l.getCellDataArr(a,"number",!0));else{if(!b(a))return i.error.v;o.push(a)}var u=[];for(r=0;r<o.length;r++)b(o[r])&&u.push(parseFloat(o[r]));if(0==n.length&&0==u.length)return[[0],[0]];if(0==n.length){var f=[[0]];for(r=0;r<u.length;r++)f.push([0]);return f}if(0==u.length)return[[0],[n.length]];u.sort(function(r,e){return r-e});for(f=[],r=0;r<u.length;r++)if(0==r){for(var h=0,s=0;s<n.length;s++)n[s]<=u[0]&&h++;f.push([h])}else if(r==u.length-1){var v=0,c=0;for(s=0;s<n.length;s++)n[s]<=u[r]&&n[s]>u[r-1]&&v++,n[s]>u[r]&&c++;f.push([v]),f.push([c])}else{for(h=0,s=0;s<n.length;s++)n[s]<=u[r]&&n[s]>u[r-1]&&h++;f.push([h])}return f}catch(r){var g=r;return g=i.errorInfo(g),[i.error.v,g]}},GROWTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=l.getDataDyadicArr(e)}else if("object"==L(e)&&null!=e.startCell)t=l.getCellDataDyadicArr(e,"text");else{if(!b(e))return i.error.v;(m=[]).push(parseFloat(e)),t.push(m)}var n=t.length,a=t[0].length;for(r=0;r<n;r++)for(var o=0;o<a;o++){if(!b(t[r][o]))return i.error.v;t[r][o]=parseFloat(t[r][o])}var u=[];for(r=1;r<=n;r++)for(o=1;o<=a;o++){var f=(r-1)*a+o;u.push(f)}if(arguments.length>=2){var h=arguments[1];if(u=[],"array"==L(h)){if("array"==L(h[0])&&!l.isDyadicArr(h))return i.error.v;u=l.getDataDyadicArr(h)}else if("object"==L(h)&&null!=h.startCell)u=l.getCellDataDyadicArr(h,"text");else{if(!b(h))return i.error.v;(m=[]).push(parseFloat(h)),u.push(m)}for(r=0;r<u.length;r++)for(o=0;o<u[0].length;o++){if(!b(u[r][o]))return i.error.v;u[r][o]=parseFloat(u[r][o])}}var s=u.length,v=u[0].length,c=u;if(arguments.length>=3){var g=arguments[2];if(c=[],"array"==L(g)){if("array"==L(g[0])&&!l.isDyadicArr(g))return i.error.v;c=l.getDataDyadicArr(g)}else if("object"==L(g)&&null!=g.startCell)c=l.getCellDataDyadicArr(g,"text");else{if(!b(g))return i.error.v;var m;(m=[]).push(parseFloat(g)),c.push(m)}for(r=0;r<c.length;r++)for(o=0;o<c[0].length;o++){if(!b(c[r][o]))return i.error.v;c[r][o]=parseFloat(c[r][o])}}var p=!0;if(4==arguments.length&&(p=l.getCellBoolen(arguments[3]),S(p)))return p;if(n!=s||a!=v)return i.error.r;var y=function(r,e){for(var t=0,n=0,a=0,o=0,i=0;i<r.length;i++)for(var l=0;l<r[i].length;l++)t+=r[i][l],n+=Math.log(e[i][l]),a+=r[i][l]*Math.log(e[i][l]),o+=r[i][l]*r[i][l];var u=r.length*r[0].length,f=t/u,h=n/u,s=(a/u-f*h)/(o/u-f*f),v=h-s*f;return[Math.exp(s),Math.exp(v)]}(u,t),d=y[0];if(p)var C=y[1];else C=1;var F=[];for(r=0;r<c.length;r++)for(o=0;o<c[r].length;o++){var I=c[r][o],w=C*Math.pow(d,I);F.push(Math.round(1e9*w)/1e9)}return F}catch(r){var D=r;return D=i.errorInfo(D),[i.error.v,D]}},LINEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return i.error.v}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},LOGEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return i.error.v}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},MDETERM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=l.getDataDyadicArr(e)}else if("object"==L(e)&&null!=e.startCell)t=l.getCellDataDyadicArr(e,"text");else{var n=[];n.push(e),t.push(n)}for(r=0;r<t.length;r++)for(var a=0;a<t[r].length;a++){if(!b(t[r][a]))return i.error.v;t[r][a]=parseFloat(t[r][a])}if(t.length!=t[0].length)return i.error.v;return function(r,e){var t,n=new Array;if(1==e)return t=r[0][0];if(2==e)return t=r[0][0]*r[1][1]-r[0][1]*r[1][0];if(3==e)return t=r[0][0]*r[1][1]*r[2][2]+r[1][0]*r[2][1]*r[0][2]+r[2][0]*r[0][1]*r[1][2]-r[2][0]*r[1][1]*r[0][2]-r[0][0]*r[2][1]*r[1][2]-r[1][0]*r[0][1]*r[2][2];t=0;for(var a=new Array,o=new Array,i=0;i<e;i++)n[i]=r[i][0]*Math.pow(-1,i+1+1);for(i=0;i<e;i++){o[i]=new Array;for(var l=0;l<e-1;l++)o[i][l]=r[i][l+1]}for(i=0;i<e;i++){for(l=0;l<e;l++){a[l]=new Array;for(var u=0;u<e-1;u++)i>l?a[l][u]=o[l][u]:i<l&&(a[l-1][u]=o[l][u])}t+=n[i]*arguments.callee(a,e-1)}return t}(t,t.length)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},MINVERSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=l.getDataDyadicArr(e)}else if("object"==L(e)&&null!=e.startCell)t=l.getCellDataDyadicArr(e,"text");else{var n=[];n.push(e),t.push(n)}for(r=0;r<t.length;r++)for(var a=0;a<t[r].length;a++){if(!b(t[r][a]))return i.error.v;t[r][a]=parseFloat(t[r][a])}return t.length!=t[0].length?i.error.v:I(t)}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}},MMULT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!(m=i.errorParamCheck(this.p,arguments[r],r))[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=l.getDataDyadicArr(e)}else if("object"==L(e)&&null!=e.startCell)t=l.getCellDataDyadicArr(e,"text");else{(v=[]).push(e),t.push(v)}for(r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++){if(!b(t[r][n]))return i.error.v;t[r][n]=parseFloat(t[r][n])}var a=arguments[1],o=[];if("array"==L(a)){if("array"==L(a[0])&&!l.isDyadicArr(a))return i.error.v;o=l.getDataDyadicArr(a)}else if("object"==L(a)&&null!=a.startCell)o=l.getCellDataDyadicArr(a,"text");else{(v=[]).push(a),o.push(v)}for(r=0;r<o.length;r++)for(n=0;n<o[r].length;n++){if(!b(o[r][n]))return i.error.v;o[r][n]=parseFloat(o[r][n])}if(t[0].length!=o.length)return i.error.v;for(var u=t.length,f=o[0].length,h=[],s=0;s<u;s++){for(var v=[],c=0;c<f;c++){for(var g=0,m=0;m<t[0].length;m++)g+=t[s][m]*o[m][c];v.push(g)}h.push(v)}return h}catch(r){var p=r;return p=i.errorInfo(p),[i.error.v,p]}},SUMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=l.getDataDyadicArr(e)}else if("object"==L(e)&&null!=e.startCell)t=l.getCellDataDyadicArr(e,"text");else{(h=[]).push(e),t.push(h)}for(r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)b(t[r][n])?t[r][n]=parseFloat(t[r][n]):t[r][n]=0;var a=t.length,o=t[0].length;if(arguments.length>=2)for(r=1;r<arguments.length;r++){var u=arguments[r],f=[];if("array"==L(u)){if("array"==L(u[0])&&!l.isDyadicArr(u))return i.error.v;f=l.getDataDyadicArr(u)}else if("object"==L(u)&&null!=u.startCell)f=l.getCellDataDyadicArr(u,"text");else{var h;(h=[]).push(u),f.push(h)}if(f.length!=a||f[0].length!=o)return i.error.v;for(var s=0;s<a;s++)for(var v=0;v<o;v++)b(f[s][v])?t[s][v]=t[s][v]*parseFloat(f[s][v]):t[s][v]=0}var c=0;for(s=0;s<a;s++)for(v=0;v<o;v++)c+=t[s][v];return c}catch(r){var g=r;return g=i.errorInfo(g),[i.error.v,g]}},ISFORMULA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];return"object"==L(t)&&null!=t.startCell?null!=t.data&&(null!=(e="array"==L(t.data)?t.data[0][0]:t.data)&&null!=e.f):i.error.v}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},CELL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=t[0][0]}else e=t[0];else if("object"==L(t)&&null!=t.startCell){if(null==t.data)return i.error.v;if("array"==L(t.data))return i.error.v;if(e=t.data.v,M(e))return i.error.v}else e=t;var n,a=arguments[1];if("object"!=L(a)||null==a.startCell)return i.error.v;if(n=a.startCell,-1==["address","col","color","contents","filename","format","parentheses","prefix","protect","row","type","width"].indexOf(e))return i.error.v;var o=D()[w(m.currentSheetIndex)],u=i.getcellrange(n),f=u.row[0],h=u.column[0];let r,c=D()[w(m.calculateSheetIndex)].data;switch(null!=i.execFunctionGlobalData&&null!=i.execFunctionGlobalData[f+"_"+h+"_"+m.calculateSheetIndex]?r=i.execFunctionGlobalData[f+"_"+h+"_"+m.calculateSheetIndex].v:null!=c[f][h]&&null!=c[f][h].v&&""!=c[f][h].v?(r=c[f][h])instanceof Object&&(r=r.v):r=0,e){case"address":return n;case"col":return h+1;case"color":return 0;case"contents":return r;case"filename":return o.name;case"format":return null==c[f][h]||null==c[f][h].ct?"G":c[f][h].ct.fa;case"parentheses":return null==c[f][h]||null==c[f][h].v||""==c[f][h].v?0:c[f][h].v>0?1:0;case"prefix":return 0==r?"":0==c[f][h].ht?"^":1==c[f][h].ht?"'":2==c[f][h].ht?'"':"";case"protect":return 0;case"row":return f+1;case"type":return 0==r?"b":"l";case"width":var s=o.config;return null!=s.columnlen&&h in s.columnlen?s.columnlen[h]:m.defaultcollen}}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},NA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return i.error.na}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},ERROR_TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=t[0][0]}else e=t[0];else if("object"==L(t)&&null!=t.startCell){if(null==t.data)return i.error.na;if("array"==L(t.data)){if(null==(e=t.data[0][0])||M(e.v))return i.error.na;e=e.v}else{if(M(t.data.v))return i.error.na;e=t.data.v}}else e=t;var n={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7,"#GETTING_DATA":8};return e in n?n[e]:i.error.na}catch(r){var a=r;return a=i.errorInfo(a),[i.error.v,a]}},ISBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0];return"object"==L(e)&&null!=e.startCell&&null==e.data}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},ISERR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=t[0][0]}else e=t[0];else if("object"==L(t)&&null!=t.startCell){if("array"==L(t.data))return!0;if(null==t.data||M(t.data.v))return!1;e=t.data.v}else e=t;return["#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(e)>-1}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ISERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=t[0][0]}else e=t[0];else if("object"==L(t)&&null!=t.startCell){if("array"==L(t.data))return!0;if(null==t.data||M(t.data.v))return!1;e=t.data.v}else e=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(e)>-1}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ISLOGICAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=t[0][0]}else e=t[0];else if("object"==L(t)&&null!=t.startCell){if("array"==L(t.data))return!1;if(null==t.data||M(t.data.v))return!1;e=t.data.v}else e=t;return"true"==e.toString().toLowerCase()||"false"==e.toString().toLowerCase()}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ISNA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=t[0][0]}else e=t[0];else if("object"==L(t)&&null!=t.startCell){if("array"==L(t.data))return!1;if(null==t.data||M(t.data.v))return!1;e=t.data.v}else e=t;return"#N/A"==e.toString()}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ISNONTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=t[0][0]}else e=t[0];else if("object"==L(t)&&null!=t.startCell){if("array"==L(t.data))return!0;if(null==t.data||M(t.data.v))return!0;e=t.data.v}else e=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(e)>-1||("true"==e.toString().toLowerCase()||"false"==e.toString().toLowerCase()||!!b(e))}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ISNUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=t[0][0]}else e=t[0];else if("object"==L(t)&&null!=t.startCell){if("array"==L(t.data))return!1;if(null==t.data||M(t.data.v))return!1;e=t.data.v}else e=t;return!!b(e)}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},ISREF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{return"object"==L(arguments[0])&&null!=arguments[0].startCell}catch(r){var e=r;return e=i.errorInfo(e),[i.error.v,e]}},ISTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=t[0][0]}else e=t[0];else if("object"==L(t)&&null!=t.startCell){if("array"==L(t.data))return!1;if(null==t.data||M(t.data.v))return!1;e=t.data.v}else e=t;return!(["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(e)>-1)&&("true"!=e.toString().toLowerCase()&&"false"!=e.toString().toLowerCase()&&!b(e))}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))return 64;if("object"==L(t)&&null!=t.startCell){if("array"==L(t.data))return 16;if(null==t.data||M(t.data.v))return 1;e=t.data.v}else e=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(e)>-1?16:"true"==e.toString().toLowerCase()||"false"==e.toString().toLowerCase()?4:b(e)?1:2}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},N:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e,t=arguments[0];if("array"==L(t))if("array"==L(t[0])){if(!l.isDyadicArr(t))return i.error.v;e=t[0][0]}else e=t[0];else if("object"==L(t)&&null!=t.startCell)if("array"==L(t.data)){if(null==(e=t.data[0][0])||M(e.v))return 0;e=e.v}else{if(null==t.data||M(t.data.v))return 0;e=t.data.v}else e=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(e)>-1?e:"true"==e.toString().toLowerCase()||"false"==e.toString().toLowerCase()?"true"==e.toString().toLowerCase()?1:0:b(e)?parseFloat(e):0}catch(r){var n=r;return n=i.errorInfo(n),[i.error.v,n]}},TO_DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),N("yyyy-mm-dd",e)):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},TO_PURE_NUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:p(e).isValid()?R(e)[2]:null==y(e).value()?e:y(e).value()}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},TO_TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0],"text");return S(e)?e:N("@",e)}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},TO_DOLLARS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),N("$ 0.00",e)):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},TO_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);return S(e)?e:b(e)?(e=parseFloat(e),N("0%",e)):i.error.v}catch(r){var t=r;return t=i.errorInfo(t),[i.error.v,t]}},DGET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=l.findResultIndex(t,o),f=[];if("string"===L(n)){var h=l.findField(t,n);f=l.rest(t[h])}else f=l.rest(t[n]);return 0===u.length?i.error.v:u.length>1?i.error.nm:f[u[0]]}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},DMAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=l.findResultIndex(t,o),f=[];if("string"===L(n)){var h=l.findField(t,n);f=l.rest(t[h])}else f=l.rest(t[n]);var s=f[u[0]];for(r=1;r<u.length;r++)s<f[u[r]]&&(s=f[u[r]]);return s}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},DMIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=findResultIndex(t,o),f=[];if("string"===L(n)){var h=findField(t,n);f=rest(t[h])}else f=rest(t[n]);var s=f[u[0]];for(r=1;r<u.length;r++)s>f[u[r]]&&(s=f[u[r]]);return s}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},DAVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=l.findResultIndex(t,o),f=[];if("string"===L(n)){var h=l.findField(t,n);f=l.rest(t[h])}else f=l.rest(t[n]);var s=0;for(r=0;r<u.length;r++)s+=f[u[r]];return 0===u.length?i.error.d:s/u.length}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},DCOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=l.findResultIndex(t,o),f=[];if("string"===L(n)){var h=l.findField(t,n);f=l.rest(t[h])}else f=l.rest(t[n]);var s=[];for(r=0;r<u.length;r++)s[r]=f[u[r]];return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,s)}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},DCOUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=l.findResultIndex(t,o),f=[];if("string"===L(n)){var h=l.findField(t,n);f=l.rest(t[h])}else f=l.rest(t[n]);var s=[];for(r=0;r<u.length;r++)s[r]=f[u[r]];return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,s)}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},DPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=l.findResultIndex(t,o),f=[];if("string"===L(n)){var h=l.findField(t,n);f=l.rest(t[h])}else f=l.rest(t[n]);var s=[];for(r=0;r<u.length;r++)s[r]=f[u[r]];s=l.compact(s);var v=1;for(r=0;r<s.length;r++)v*=s[r];return v}catch(r){var c=r;return c=i.errorInfo(c),[i.error.v,c]}},DSTDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=l.findResultIndex(t,o),f=[];if("string"===L(n)){var h=l.findField(t,n);f=l.rest(t[h])}else f=l.rest(t[n]);var s=[];for(r=0;r<u.length;r++)s[r]=f[u[r]];return s=l.compact(s),window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,s)}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},DSTDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=l.findResultIndex(t,o),f=[];if("string"===L(n)){var h=l.findField(t,n);f=l.rest(t[h])}else f=l.rest(t[n]);var s=[];for(r=0;r<u.length;r++)s[r]=f[u[r]];return s=l.compact(s),window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,s)}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},DSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=l.findResultIndex(t,o),f=[];if("string"===L(n)){var h=l.findField(t,n);f=l.rest(t[h])}else f=l.rest(t[n]);var s=[];for(r=0;r<u.length;r++)s[r]=f[u[r]];s=l.compact(s);var v=0;for(r=0;r<s.length;r++)v+=s[r];return v}catch(r){var c=r;return c=i.errorInfo(c),[i.error.v,c]}},DVAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=l.findResultIndex(t,o),f=[];if("string"===L(n)){var h=l.findField(t,n);f=l.rest(t[h])}else f=l.rest(t[n]);var s=[];for(r=0;r<u.length;r++)s[r]=f[u[r]];return s=l.compact(s),window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,s)}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},DVARP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("object"!=L(e)||null==e.startCell)return i.error.v;if(null==e.data)return i.error.v;t=l.getCellDataDyadicArr(e,"text");var n=l.getFirstValue(arguments[1],"text");if(S(n))return n;if(M(n))return i.error.v;var a=arguments[2],o=[];if("object"!=L(a)||null==a.startCell)return i.error.v;if(null==a.data)return i.error.v;if(o=l.getCellDataDyadicArr(a,"text"),!b(n)&&"string"!==L(n))return i.error.v;var u=l.findResultIndex(t,o),f=[];if("string"===L(n)){var h=l.findField(t,n);f=l.rest(t[h])}else f=l.rest(t[n]);var s=[];for(r=0;r<u.length;r++)s[r]=f[u[r]];return s=l.compact(s),window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,s)}catch(r){var v=r;return v=i.errorInfo(v),[i.error.v,v]}},LINESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=(window.luckysheetCurrentFunction,i.colorList),l=arguments[0],u=arguments[1],f=arguments[2],h=arguments[3],s=arguments[4],v=arguments[5],c=arguments[6],g=arguments[7];let r=D()[w(m.calculateSheetIndex)].data;var p=i.readCellDataToOneArray(l),y=a.getCellRealSize(r,e,t),d=y[0],C=y[1],F={};null==f&&(f=1),F.lineWidth=f,F.offsetY=f+1,F.height=C-(f+1),F.width=d;var I=function(r,e){e&&("number"==typeof e&&(e>19&&(e%=20),e=n[e]),F[r]=e)};if(null==u&&(u="#2ec7c9"),I("lineColor",u),F.fillColor=0,h)if("string"==typeof h){var k=null;"min"==(h=h.toLowerCase())?k=window.luckysheet_function.MIN.f({data:p}):"max"==h?k=window.luckysheet_function.MAX.f({data:p}):"avg"==h||"mean"==h?k=window.luckysheet_function.AVERAGE.f({data:p}):"median"==h&&(k=window.luckysheet_function.MEDIAN.f({data:p})),k&&(F.normalRangeMin=k,F.normalRangeMax=k)}else F.normalRangeMin=h,F.normalRangeMax=h;return null==s&&(s="#000"),I("normalRangeColor",s),I("maxSpotColor",v),I("minSpotColor",c),null==g&&(g="1.5"),F.spotRadius=g,o.init(p,F)}catch(r){var A=r;return A=i.errorInfo(A),[i.error.v,A]}},AREASPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=(window.luckysheetCurrentFunction,i.colorList),l=arguments[0],u=arguments[1],f=arguments[2],h=arguments[3],s=arguments[4],v=arguments[5],c=i.readCellDataToOneArray(l);let r=D()[w(m.calculateSheetIndex)].data;var g=a.getCellRealSize(r,e,t),p=g[0],y=g[1],d={};null==h&&(h=1),d.lineWidth=h,d.offsetY=h+1,d.height=y-(h+1),d.width=p;var C=function(r,e){e&&("number"==typeof e&&(e>19&&(e%=20),e=n[e]),d[r]=e)};if(null==u&&(u="#2ec7c9"),C("lineColor",u),C("fillColor",f),null==h&&(h="1"),d.lineWidth=h,s)if("string"==typeof s){var F=null;"min"==(s=s.toLowerCase())?F=window.luckysheet_function.MIN.f({data:c}):"max"==s?F=window.luckysheet_function.MAX.f({data:c}):"avg"==s||"mean"==s?F=window.luckysheet_function.AVERAGE.f({data:c}):"median"==s&&(F=window.luckysheet_function.MEDIAN.f({data:c})),F&&(d.normalRangeMin=F,d.normalRangeMax=F)}else d.normalRangeMin=s,d.normalRangeMax=s;return null==v&&(v="#000"),C("normalRangeColor",v),o.init(c,d)}catch(r){var I=r;return I=i.errorInfo(I),[i.error.v,I]}},COLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=(window.luckysheetCurrentFunction,i.colorList),l=arguments[0],u=i.readCellDataToOneArray(l);let r=D()[w(m.calculateSheetIndex)].data;var f=a.getCellRealSize(r,e,t),h=f[0],s=f[1],v={};v.height=s,v.width=h;var c=function(r,e){e&&("number"==typeof e&&(e>19&&(e%=20),e=n[e]),v[r]=e)},g=arguments[1],p=arguments[2],y=arguments[3],d=arguments[4];v.type="column",null==g&&(g="1"),v.barSpacing=g,null==p&&(p="#fc5c5c"),c("barColor",p),null==y&&(y="#97b552"),c("negBarColor",y),v.chartRangeMax=null==d||!1===d||"number"!=typeof d?void 0:d;var C=i.sparklinesColorMap(arguments);return C&&(v.colorMap=C),o.init(u,v)}catch(r){var F=r;return F=i.errorInfo(F),[i.error.v,F]}},STACKCOLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=(window.luckysheetCurrentFunction,i.colorList,arguments[0]),l=[],u=[];if(null!=n&&null!=n.data&&(u=n.data),"array"==L(u))u=i.getPureValueByData(u);else{if("object"==L(u))return[u=u.v];/\{.*?\}/.test(u)&&(u=u.replace(/\{/g,"[").replace(/\}/g,"]")),u=new Function("return "+u)()}var f=arguments[1];u.length;if(null==f||f)for(var h=0;h<u[0].length;h++){for(var s="",v=0;v<u.length;v++)s+=u[v][h]+":";s=s.substr(0,s.length-1),l.push(s)}else{for(v=0;v<u.length;v++){var c="";for(h=0;h<u[0].length;h++)c+=u[v][h]+":";c=c.substr(0,c.length-1),l.push(c)}u[0].length}let r=D()[w(m.calculateSheetIndex)].data;var g=a.getCellRealSize(r,e,t),p=g[0],y=g[1],d={};d.height=y,d.width=p;var C=arguments[2],F=arguments[3];d.type="column",null==C&&(C="1"),d.barSpacing=C,d.chartRangeMax=null==F||!1===F||"number"!=typeof F?void 0:F;var I=i.sparklinesColorMap(arguments,4);return I&&(d.colorMap=I),o.init(l,d)}catch(r){var k=r;return k=i.errorInfo(k),[i.error.v,k]}},BARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=(window.luckysheetCurrentFunction,i.colorList),l=arguments[0],u=i.readCellDataToOneArray(l);let r=D()[w(m.calculateSheetIndex)].data;var f=a.getCellRealSize(r,e,t),h=f[0],s=f[1],v={};v.height=s,v.width=h;var c=function(r,e){e&&("number"==typeof e&&(e>19&&(e%=20),e=n[e]),v[r]=e)},g=arguments[1],p=arguments[2],y=arguments[3],d=arguments[4];v.type="bar",null==g&&(g="1"),v.barSpacing=g,null==p&&(p="#fc5c5c"),c("barColor",p),null==y&&(y="#97b552"),c("negBarColor",y),v.chartRangeMax=null==d||!1===d||"number"!=typeof d?void 0:d;var C=i.sparklinesColorMap(arguments);return C&&(v.colorMap=C),o.init(u,v)}catch(r){var F=r;return F=i.errorInfo(F),[i.error.v,F]}},STACKBARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=(window.luckysheetCurrentFunction,i.colorList,arguments[0]),l=[],u=[];if(null!=n&&null!=n.data&&(u=n.data),"array"==L(u))u=i.getPureValueByData(u);else{if("object"==L(u))return[u=u.v];/\{.*?\}/.test(u)&&(u=u.replace(/\{/g,"[").replace(/\}/g,"]")),u=new Function("return "+u)()}var f=arguments[1];u.length;if(null==f||f)for(var h=0;h<u[0].length;h++){for(var s="",v=0;v<u.length;v++)s+=u[v][h]+":";s=s.substr(0,s.length-1),l.push(s)}else{for(v=0;v<u.length;v++){var c="";for(h=0;h<u[0].length;h++)c+=u[v][h]+":";c=c.substr(0,c.length-1),l.push(c)}u[0].length}let r=D()[w(m.calculateSheetIndex)].data;var g=a.getCellRealSize(r,e,t),p=g[0],y=g[1],d={};d.height=y,d.width=p;var C=arguments[2],F=arguments[3];d.type="bar",null==C&&(C="1"),d.barSpacing=C,d.chartRangeMax=null==F||!1===F||"number"!=typeof F?void 0:F;var I=i.sparklinesColorMap(arguments,4);return I&&(d.colorMap=I),o.init(l,d)}catch(r){var k=r;return k=i.errorInfo(k),[i.error.v,k]}},DISCRETESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=(window.luckysheetCurrentFunction,i.colorList),l=arguments[0],u=i.readCellDataToOneArray(l);let r=D()[w(m.calculateSheetIndex)].data;var f=a.getCellRealSize(r,e,t),h=f[0],s=f[1],v={};v.height=s,v.width=h;var c=function(r,e){e&&("number"==typeof e&&(e>19&&(e%=20),e=n[e]),v[r]=e)},g=arguments[1],p=arguments[2],y=arguments[3];return v.type="discrete",null==g&&(g=0),v.thresholdValue=g,null==p&&(p="#2ec7c9"),c("lineColor",p),null==y&&(y="#fc5c5c"),c("thresholdColor",y),o.init(u,v)}catch(r){var d=r;return d=i.errorInfo(d),[i.error.v,d]}},TRISTATESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=(window.luckysheetCurrentFunction,i.colorList),l=arguments[0],u=i.readCellDataToOneArray(l);let r=D()[w(m.calculateSheetIndex)].data;var f=a.getCellRealSize(r,e,t),h=f[0],s=f[1],v={};v.height=s,v.width=h;var c=function(r,e){e&&("number"==typeof e&&(e>19&&(e%=20),e=n[e]),v[r]=e)},g=arguments[1],p=arguments[2],y=arguments[3],d=arguments[4];v.type="tristate",null==g&&(g="1"),v.barSpacing=g,null==p&&(p="#fc5c5c"),c("barColor",p),null==y&&(y="#97b552"),c("negBarColor",y),null==d&&(d="#999"),c("zeroBarColor",d);var C=i.sparklinesColorMap(arguments);return C&&(v.colorMap=C),o.init(u,v)}catch(r){var F=r;return F=i.errorInfo(F),[i.error.v,F]}},PIESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=(window.luckysheetCurrentFunction,i.colorList),l=arguments[0],u=i.readCellDataToOneArray(l);let r=D()[w(m.calculateSheetIndex)].data;var f=a.getCellRealSize(r,e,t),h=f[0],s=f[1],v={};v.height=s,v.width=h;var c=function(r,e){e&&("number"==typeof e&&(e>19&&(e%=20),e=n[e]),v[r]=e)},g=arguments[1],p=arguments[2],y=arguments[3];v.type="pie",null==g&&(g=0),v.offset=g,null==p&&(p=0),c("borderWidth",p),null==y&&(y="#97b552"),c("borderColor",y);var d=i.sparklinesColorMap(arguments,4);return d&&(v.colorMap=d),o.init(u,v)}catch(r){var C=r;return C=i.errorInfo(C),[i.error.v,C]}},BOXSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=(window.luckysheetCurrentFunction,i.colorList),l=arguments[0],u=i.readCellDataToOneArray(l);let r=D()[w(m.calculateSheetIndex)].data;var f=a.getCellRealSize(r,e,t),h=f[0],s=f[1],v={};v.height=s,v.width=h;var c=function(r,e){e&&("number"==typeof e&&(e>19&&(e%=20),e=n[e]),v[r]=e)},g=arguments[1],p=arguments[2],y=arguments[3];return v.type="box",null==g&&(g=1.5),v.outlierIQR=g,null==p?p=0:c("target",p),null==y&&(y=1.5),c("spotRadius",y),o.init(u,v)}catch(r){var d=r;return d=i.errorInfo(d),[i.error.v,d]}},BULLETSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn;window.luckysheetCurrentFunction,i.colorList;let g=D()[w(m.calculateSheetIndex)].data;var n=a.getCellRealSize(g,e,t),l=n[0],u=n[1],f={};f.height=u,f.width=l;var h=[];F(arguments);var s=i.getValueByFuncData(arguments[0]),v=i.getValueByFuncData(arguments[1]);h.push(s),h.push(v);for(r=2;r<arguments.length;r++)h.push(i.getValueByFuncData(arguments[r]));return f.type="bullet",o.init(h,f)}catch(r){var c=r;return c=i.errorInfo(c),[i.error.v,c]}},SORT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[],n=1,a=1;if("array"==L(e))if("array"==L(e[0])){if(!l.isDyadicArr(e))return i.error.v;for(r=0;r<e.length;r++){for(var o=[],u=0;u<e[r].length;u++){var f=e[r][u];o.push(f)}t.push(o)}n=t.length,a=t[0].length}else{for(r=0;r<e.length;r++){f=e[r];t.push(f)}n=t.length}else if("object"==L(e)&&null!=e.startCell)if(null!=e.data)if("array"==L(e.data)){for(r=0;r<e.data.length;r++){for(o=[],u=0;u<e.data[r].length;u++)if(null!=e.data[r][u]){f=e.data[r][u].v;M(f)&&(f=0),o.push(f)}else o.push(0);t.push(o)}n=t.length,a=t[0].length}else{f=e.data.v;M(f)&&(f=0),t.push(f)}else t.push(0);else{f=e;t.push(f)}var h=1;if(arguments.length>=2){if(h=l.getFirstValue(arguments[1]),S(h))return h;if(!b(h))return i.error.v;h=parseInt(h)}var s=1;if(arguments.length>=3){if(s=l.getFirstValue(arguments[2]),S(s))return s;if(!b(s))return i.error.v;s=Math.floor(parseFloat(s))}var v=!1;if(4==arguments.length&&(v=l.getCellBoolen(arguments[3]),S(v)))return v;if(v){if(h<1||h>n)return i.error.v}else if(h<1||h>a)return i.error.v;if(1!=s&&-1!=s)return i.error.v;var c=function(r,e){return"array"==L(r)&&(r=r[h-1]),"array"==L(e)&&(e=e[h-1]),isNaN(r)||isNaN(e)?isNaN(r)?isNaN(e)?r>e?1:r<e?-1:void 0:1:-1:r-e},g=function(r,e){return"array"==L(r)&&(r=r[h-1]),"array"==L(e)&&(e=e[h-1]),isNaN(r)||isNaN(e)?isNaN(r)?isNaN(e)?r>e?-1:r<e?1:void 0:-1:1:e-r};return v?(t=t[0].map(function(r,e){return t.map(function(r){return r[e]})}),1==s&&t.sort(c),-1==s&&t.sort(g),t=t[0].map(function(r,e){return t.map(function(r){return r[e]})})):(1==s&&t.sort(c),-1==s&&t.sort(g)),t}catch(r){var m=r;return m=i.errorInfo(m),[i.error.v,m]}},FILTER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=l.getDataDyadicArr(e)}else if("object"==L(e)&&null!=e.startCell)t=l.getCellDataDyadicArr(e,"number");else{(s=[]).push(parseFloat(e)),t.push(s)}t.length,t[0].length;var n=arguments[1],a=[],o="row";if("array"==L(n))if("array"==L(n[0])){if(!l.isDyadicArr(n))return i.error.v;if(n.length>1&&n[0].length>1)return i.error.v;if(n.length>1){if(n.length!=t.length)return i.error.v;o="row";for(r=0;r<n.length;r++){var u=n[r][0];if("boolean"==L(u));else if("string"!=L(u)||"true"!=u.toLowerCase()&&"false"!=u.toLowerCase()){if(!b(u))return i.error.v;u=0!=(u=parseFloat(u))}else"true"==u.toLowerCase()?u=!0:"false"==u.toLowerCase()&&(u=!1);a.push(u)}}if(n[0].length>1){if(n[0].length!=t[0].length)return i.error.v;o="col";for(r=0;r<n[0].length;r++){u=n[0][r];if("boolean"==L(u));else if("string"!=L(u)||"true"!=u.toLowerCase()&&"false"!=u.toLowerCase()){if(!b(u))return i.error.v;u=0!=(u=parseFloat(u))}else"true"==u.toLowerCase()?u=!0:"false"==u.toLowerCase()&&(u=!1);a.push(u)}}}else{if(n.length!=t[0].length)return i.error.v;o="col";for(r=0;r<n.length;r++){u=n[r];if("boolean"==L(u));else if("string"!=L(u)||"true"!=u.toLowerCase()&&"false"!=u.toLowerCase()){if(!b(u))return i.error.v;u=0!=(u=parseFloat(u))}else"true"==u.toLowerCase()?u=!0:"false"==u.toLowerCase()&&(u=!1);a.push(u)}}else{if("object"!=L(n)||null==n.data||"array"!=L(n.data))return i.error.v;if(n.data.length>1&&n.data[0].length>1)return i.error.v;if(n.data.length>1){if(n.data.length!=t.length)return i.error.v;o="row";for(r=0;r<n.data.length;r++){u=n.data[r][0].v;if(M(u)&&(u=0),"boolean"==L(u));else if("string"!=L(u)||"true"!=u.toLowerCase()&&"false"!=u.toLowerCase()){if(!b(u))return i.error.v;u=0!=(u=parseFloat(u))}else"true"==u.toLowerCase()?u=!0:"false"==u.toLowerCase()&&(u=!1);a.push(u)}}if(n.data[0].length>1){if(n.data[0].length!=t[0].length)return i.error.v;o="col";for(r=0;r<n.data[0].length;r++){u=n.data[0][r].v;if(M(u)&&(u=0),"boolean"==L(u));else if("string"!=L(u)||"true"!=u.toLowerCase()&&"false"!=u.toLowerCase()){if(!b(u))return i.error.v;u=0!=(u=parseFloat(u))}else"true"==u.toLowerCase()?u=!0:"false"==u.toLowerCase()&&(u=!1);a.push(u)}}}var f="";if(3==arguments.length&&(f=l.getFirstValue(arguments[2],"text"),S(f)))return f;var h=[];if("row"==o)for(r=0;r<t.length;r++)a[r]&&h.push(t[r]);else for(r=0;r<t.length;r++){for(var s=[],v=0;v<t[0].length;v++)a[v]&&s.push(t[r][v]);s.length>0&&h.push(s)}return 0==h.length?f:h}catch(r){var c=r;return c=i.errorInfo(c),[i.error.v,c]}},UNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=arguments[0],t=[];if("array"==L(e)){if("array"==L(e[0])&&!l.isDyadicArr(e))return i.error.v;t=l.getDataDyadicArr(e)}else if("object"==L(e)&&null!=e.startCell)t=l.getCellDataDyadicArr(e,"number");else{var n=[];n.push(parseFloat(e)),t.push(n)}var a=!1;if(arguments.length>=2&&(a=l.getCellBoolen(arguments[1]),S(a)))return a;var o=!1;if(3==arguments.length&&(o=l.getCellBoolen(arguments[2]),S(o)))return o;if(a){t=t[0].map(function(r,e){return t.map(function(r){return r[e]})});var u={},f=[],h=[];for(r=0;r<t.length;r++){for(var s="",v=0;v<t[r].length;v++)s+=t[r][v].toString()+"|||";f.push(s),s in u||(u[s]=0,h.push(t[r]))}if(o){var c=[];for(r=0;r<f.length;r++)f.indexOf(f[r])==f.lastIndexOf(f[r])&&c.push(t[r]);return c=c[0].map(function(r,e){return c.map(function(r){return r[e]})})}return h=h[0].map(function(r,e){return h.map(function(r){return r[e]})})}for(u={},f=[],h=[],r=0;r<t.length;r++){for(s="",v=0;v<t[r].length;v++)s+=t[r][v].toString()+"|||";f.push(s),s in u||(u[s]=0,h.push(t[r]))}if(o){for(c=[],r=0;r<f.length;r++)f.indexOf(f[r])==f.lastIndexOf(f[r])&&c.push(t[r]);return c}return h}catch(r){var g=r;return g=i.errorInfo(g),[i.error.v,g]}},RANDARRAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=1;if(arguments.length>=1){if(e=l.getFirstValue(arguments[0]),S(e))return e;if(!b(e))return i.error.v;e=parseInt(e)}var t=1;if(2==arguments.length){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}if(e<=0||t<=0)return i.error.v;var n=[];for(r=0;r<e;r++){for(var a=[],o=0;o<t;o++)a.push(Math.random().toFixed(9));n.push(a)}return n}catch(r){var u=r;return u=i.errorInfo(u),[i.error.v,u]}},SEQUENCE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=l.getFirstValue(arguments[0]);if(S(e))return e;if(!b(e))return i.error.v;e=parseInt(e);var t=1;if(arguments.length>=2){if(t=l.getFirstValue(arguments[1]),S(t))return t;if(!b(t))return i.error.v;t=parseInt(t)}var n=1;if(arguments.length>=3){if(n=l.getFirstValue(arguments[2]),S(n))return n;if(!b(n))return i.error.v;n=parseFloat(n)}var a=1;if(4==arguments.length){if(a=l.getFirstValue(arguments[3]),S(a))return a;if(!b(a))return i.error.v;a=parseFloat(a)}if(e<=0||t<=0)return i.error.v;var o=[];for(r=0;r<e;r++){for(var u=[],f=0;f<t;f++){var h=n+a*(f+t*r);u.push(h)}o.push(u)}return o}catch(r){var s=r;return s=i.errorInfo(s),[i.error.v,s]}},EVALUATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return i.error.na;for(var r=0;r<arguments.length;r++){if(!i.errorParamCheck(this.p,arguments[r],r)[0])return i.error.v}try{var e=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,n=window.luckysheetCurrentIndex,a=l.getFirstValue(arguments[0]).toString();return S(a)?a:(0!=a.trim().indexOf("=")&&(a="="+a),i.execstringformula(a,e,t,n)[1])}catch(r){var o=r;return o=i.errorInfo(o),[i.error.v,o]}}}});
//# sourceMappingURL=../sourcemaps/function/functionImplementation.js.map
