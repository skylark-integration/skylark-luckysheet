/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../methods/func_methods","../methods/formula_methods","../widgets/tooltip","../methods/validate","../methods/getdata","../methods/format","../function/matrix_methods","../methods/get","../utils/util","../store","../vendors/numeral"],function(e,t,l,r,a,n,h,s,u,f,o){"use strict";const{isRealNum:g,valueIsError:i,error:p}=r,{getdatabyselectionD:c}=a,{genarate:y}=n,{inverse:d}=h,{getSheetIndex:v,getluckysheetfile:F,getRangetxt:w}=s,{getObjType:_,ABCatNum:m}=u;function N(e,t,l){let r;return"+"==t?r=o(e).add(l).value():"-"==t?r=o(e).subtract(l).value():"%"==t?r=new Function("return "+parseFloat(e)+t+"("+parseFloat(l)+")")():"/"==t?r=o(e).divide(l).value():"*"==t&&(r=o(e).multiply(l).value()),r}function k(e){if(null==window.luckysheet_getcelldata_cache&&(window.luckysheet_getcelldata_cache={}),e in window.luckysheet_getcelldata_cache)return window.luckysheet_getcelldata_cache[e];let r=F(),a=e.split("!"),n="",h="",s=-1,u=null;if(a.length>1){n=a[0].replace(/''/g,"'"),h=a[1],"'"==n.substr(0,1)&&"'"==n.substr(n.length-1,1)&&(n=n.substring(1,n.length-1));for(let e in r)if(n==r[e].name){s=r[e].index,u=r[e].data;break}-1==s&&(s=0)}else{let e=v(f.calculateSheetIndex);n=r[e].name,s=r[e].index,u=r[e].data,h=a[0]}if(-1==h.indexOf(":")){let l=parseInt(h.replace(/[^0-9]/g,""))-1,r=m(h.replace(/[^A-Za-z]/g,""));if(isNaN(l)||isNaN(r))return[];{let a=c(u,{row:[l,l],column:[r,r]})[0][0];if(null!=t.execFunctionGlobalData){let e=t.execFunctionGlobalData[l+"_"+r+"_"+s];null!=e&&(a=e)}let f={sheetName:n,startCell:h,rowl:1,coll:1,data:a};return window.luckysheet_getcelldata_cache[e]=f,f}}{h=h.split(":");let r=[],a=[];if(r[0]=parseInt(h[0].replace(/[^0-9]/g,""))-1,r[1]=parseInt(h[1].replace(/[^0-9]/g,""))-1,isNaN(r[0])&&(r[0]=0),isNaN(r[1])&&(r[1]=u.length-1),r[0]>r[1])return l.info("选择失败","输入范围错误！"),[];if(a[0]=m(h[0].replace(/[^A-Za-z]/g,"")),a[1]=m(h[1].replace(/[^A-Za-z]/g,"")),isNaN(a[0])&&(a[0]=0),isNaN(a[1])&&(a[1]=u[0].length-1),a[0]>a[1])return l.info("选择失败","输入范围错误！"),[];let f=c(u,{row:r,column:a});if(null!=t.execFunctionGlobalData)for(let e=r[0];e<=r[1];e++)for(let l=a[0];l<=a[1];l++){let n=t.execFunctionGlobalData[e+"_"+l+"_"+s];null!=n&&(f[e-r[0]][l-a[0]]=n)}let o=r[1]-r[0]+1,g=a[1]-a[0]+1,i={sheetName:n,startCell:h[0],rowl:o,coll:g,data:f};return window.luckysheet_getcelldata_cache[e]=i,i}}return{luckysheet_compareWith:function(){let t,l=arguments[1],r=arguments[0];"object"==_(r)&&null!=r.startCell?1==(t="&"==l?e.getCellDataDyadicArr(r,"text"):e.getCellDataDyadicArr(r,"number")).length&&1==t[0].length&&(t=t[0][0]):t=r;let a,n=arguments[2];if("object"==_(n)&&null!=n.startCell?1==(a="&"==l?e.getCellDataDyadicArr(n,"text"):e.getCellDataDyadicArr(n,"number")).length&&1==a[0].length&&(a=a[0][0]):a=n,i(t))return t;if(i(a))return a;if("array"==_(t)&&"array"==_(t[0])&&!e.isDyadicArr(t))return p.v;if("array"==_(a)&&"array"==_(a[0])&&!e.isDyadicArr(a))return p.v;if("<>"==l&&(l="!="),"="==l&&(l="=="),null==t&&null==a)return"#INVERSE!";if("#INVERSE!"==t)t=0,"-"==l?l="+":"+"==l&&(l="-");else if("-"==l&&null==t)t=0;else if("/"==l&&(0==a||null==a))return p.d;function h(e,t,l){return g(e)&&(e=parseFloat(e)),g(l)&&(l=parseFloat(l)),"=="==t?e==l:"!="==t?e!=l:">="==t?e>=l:"<="==t?e<=l:">"==t?e>l:"<"==t?e<l:void 0}function s(e){return null==e?e:"true"==e.toString().toLowerCase()?1:"false"==e.toString().toLowerCase()?0:e}if("*"==l){if("array"==_(t)&&"array"==_(a)){let e=[];if("array"==_(t[0])&&"array"==_(a[0]))if(t.length==a.length&&t[0].length==a[0].length)for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let h;t[r][e]=s(t[r][e]),a[r][e]=s(a[r][e]),h=g(t[r][e])&&g(a[r][e])?N(t[r][e],l,a[r][e]):p.v,n.push(h)}e.push(n)}else if(t[0].length==a.length){let r=t.length,n=a[0].length;for(let h=0;h<r;h++){let r=[];for(let e=0;e<n;e++){let n=0;for(let r=0;r<t[0].length;r++)t[h][r]=s(t[h][r]),a[r][e]=s(a[r][e]),g(t[h][r])&&g(a[r][e])?n+=N(t[h][r],l,a[r][e]):n+=p.v;"NaN"==n.toString()&&(n=p.v),r.push(n)}e.push(r)}}else{if(t.length!=a[0].length)return p.na;{let r=a.length,n=t[0].length;for(let h=0;h<r;h++){let r=[];for(let e=0;e<n;e++){let n=0;for(let r=0;r<a[0].length;r++)t[r][e]=s(t[r][e]),a[h][r]=s(a[h][r]),g(a[h][r])&&g(t[r][e])?n+=N(t[r][e],l,a[h][r]):n+=p.v;"NaN"==n.toString()&&(n=p.v),r.push(n)}e.push(r)}}}else if("array"==_(t[0]))if(t[0].length==a.length)for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let h;t[r][e]=s(t[r][e]),a[e]=s(a[e]),h=g(t[r][e])&&g(a[e])?N(t[r][e],l,a[e]):p.v,n.push(h)}e.push(n)}else{if(1!=t[0].length)return p.na;{let r=t.length,n=a.length;for(let h=0;h<r;h++){let r=[];for(let e=0;e<n;e++){let n;t[h][0]=s(t[h][0]),a[e]=s(a[e]),n=g(t[h][0])&&g(a[e])?N(t[h][0],l,a[e]):p.v,r.push(n)}e.push(r)}}}else if("array"==_(a[0]))if(a[0].length==t.length)for(let r=0;r<a.length;r++){let n=[];for(let e=0;e<a[r].length;e++){let h;t[e]=s(t[e]),a[r][e]=s(a[r][e]),h=g(t[e])&&g(a[r][e])?N(t[e],l,a[r][e]):p.v,n.push(h)}e.push(n)}else{if(1!=a[0].length)return p.na;{let r=a.length,n=t.length;for(let h=0;h<r;h++){let r=[];for(let e=0;e<n;e++){let n;t[e]=s(t[e]),a[h][0]=s(a[h][0]),n=g(t[e])&&g(a[h][0])?N(t[e],l,a[h][0]):p.v,r.push(n)}e.push(r)}}}else{if(t.length!=a.length)return p.na;for(let r=0;r<t.length;r++){let n;t[r]=s(t[r]),a[r]=s(a[r]),n=g(t[r])&&g(a[r])?N(t[r],l,a[r]):p.v,e.push(n)}}return e}if("array"==_(t)){a=s(a);let e=[];if("array"==_(t[0]))for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let h;t[r][e]=s(t[r][e]),h=g(t[r][e])&&g(a)?N(t[r][e],l,a):p.v,n.push(h)}e.push(n)}else for(let r=0;r<t.length;r++){let n;t[r]=s(t[r]),n=g(t[r])&&g(a)?N(t[r],l,a):p.v,e.push(n)}return e}if("array"==_(a)){t=s(t);let e=[];if("array"==_(a[0]))for(let r=0;r<a.length;r++){let n=[];for(let e=0;e<a[r].length;e++){let h;a[r][e]=s(a[r][e]),h=g(t)&&g(a[r][e])?N(t,l,a[r][e]):p.v,n.push(h)}e.push(n)}else for(let r=0;r<a.length;r++){let n;a[r]=s(a[r]),n=g(t)&&g(a[r])?N(t,l,a[r]):p.v,e.push(n)}return e}{let e;return t=s(t),a=s(a),e=g(t)&&g(a)?N(t,l,a):p.v}}if("/"==l){if("array"==_(t)&&"array"==_(a)){let e=[];if("array"==_(t[0])&&"array"==_(a[0]))if(t.length==a.length&&t[0].length==a[0].length)for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let h;t[r][e]=s(t[r][e]),a[r][e]=s(a[r][e]),h=g(t[r][e])&&g(a[r][e])?0==parseFloat(a[r][e])?p.d:N(t[r][e],l,a[r][e]):p.v,n.push(h)}e.push(n)}else{if(t[0].length!=a.length)return p.na;{let l=d(a),r=t.length,n=l[0].length;for(let a=0;a<r;a++){let r=[];for(let e=0;e<n;e++){let n=0;for(let r=0;r<t[0].length;r++)t[a][r]=s(t[a][r]),l[r][e]=s(l[r][e]),g(t[a][r])&&g(l[r][e])?n+=N(t[a][r],"*",l[r][e]):n+=p.v;"NaN"==n.toString()&&(n=p.v),r.push(n)}e.push(r)}}}else if("array"==_(t[0]))if(t[0].length==a.length)for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let h;t[r][e]=s(t[r][e]),a[e]=s(a[e]),h=g(t[r][e])&&g(a[e])?0==parseFloat(a[e])?p.d:N(t[r][e],l,a[e]):p.v,n.push(h)}e.push(n)}else{if(1!=t[0].length)return p.na;{let r=t.length,n=a.length;for(let h=0;h<r;h++){let r=[];for(let e=0;e<n;e++){let n;t[h][0]=s(t[h][0]),a[e]=s(a[e]),n=g(t[h][0])&&g(a[e])?0==parseFloat(a[e])?p.d:N(t[h][0],l,a[e]):p.v,r.push(n)}e.push(r)}}}else if("array"==_(a[0]))if(a[0].length==t.length)for(let r=0;r<a.length;r++){let n=[];for(let e=0;e<a[r].length;e++){let h;t[e]=s(t[e]),a[r][e]=s(a[r][e]),h=g(t[e])&&g(a[r][e])?0==parseFloat(a[r][e])?p.d:N(t[e],l,a[r][e]):p.v,n.push(h)}e.push(n)}else{if(1!=a[0].length)return p.na;{let r=a.length,n=t.length;for(let h=0;h<r;h++){let r=[];for(let e=0;e<n;e++){let n;t[e]=s(t[e]),a[h][0]=s(a[h][0]),n=g(t[e])&&g(a[h][0])?0==parseFloat(a[h][0])?p.d:N(t[e],l,a[h][0]):p.v,r.push(n)}e.push(r)}}}else{if(t.length!=a.length)return p.na;for(let r=0;r<t.length;r++){let n;t[r]=s(t[r]),a[r]=s(a[r]),n=g(t[r])&&g(a[r])?0==parseFloat(a[r])?p.d:N(t[r],l,a[r]):p.v,e.push(n)}}return e}if("array"==_(t)){a=s(a);let e=[];if("array"==_(t[0]))for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let h;t[r][e]=s(t[r][e]),h=g(t[r][e])&&g(a)?0==parseFloat(a)?p.d:N(t[r][e],l,a):p.v,n.push(h)}e.push(n)}else for(let r=0;r<t.length;r++){let n;t[r]=s(t[r]),n=g(t[r])&&g(a)?0==parseFloat(a)?p.d:N(t[r],l,a):p.v,e.push(n)}return e}if("array"==_(a)){t=s(t);let e=[];if("array"==_(a[0]))for(let r=0;r<a.length;r++){let n=[];for(let e=0;e<a[r].length;e++){let h;a[r][e]=s(a[r][e]),h=g(t)&&g(a[r][e])?0==parseFloat(a[r][e])?p.d:N(t,l,a[r][e]):p.v,n.push(h)}e.push(n)}else for(let r=0;r<a.length;r++){let n;a[r]=s(a[r]),n=g(t)&&g(a[r])?0==parseFloat(a[r])?p.d:N(t,l,a[r]):p.v,e.push(n)}return e}{let e;return t=s(t),a=s(a),e=g(t)&&g(a)?0==parseFloat(a)?p.d:N(t,l,a):p.v}}if("+"==l||"-"==l||"%"==l){if("array"==_(t)&&"array"==_(a)){let e=[];if("array"==_(t[0])&&"array"==_(a[0])){if(t.length!=a.length&&t[0].length!=a[0].length)return p.na;for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let h;t[r][e]=s(t[r][e]),a[r][e]=s(a[r][e]),h=g(t[r][e])&&g(a[r][e])?"%"==l&&0==parseFloat(a[r][e])?p.d:N(t[r][e],l,a[r][e]):p.v,n.push(h)}e.push(n)}}else if("array"==_(t[0])){if(t[0].length!=a.length)return p.na;for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let h;t[r][e]=s(t[r][e]),a[e]=s(a[e]),h=g(t[r][e])&&g(a[e])?"%"==l&&0==parseFloat(a[e])?p.d:N(t[r][e],l,a[e]):p.v,n.push(h)}e.push(n)}}else if("array"==_(a[0])){if(a[0].length!=t.length)return p.na;for(let r=0;r<a.length;r++){let n=[];for(let e=0;e<a[r].length;e++){let h;t[e]=s(t[e]),a[r][e]=s(a[r][e]),h=g(t[e])&&g(a[r][e])?"%"==l&&0==parseFloat(a[r][e])?p.d:N(t[e],l,a[r][e]):p.v,n.push(h)}e.push(n)}}else{if(t.length!=a.length)return p.na;for(let r=0;r<t.length;r++){let n;t[r]=s(t[r]),a[r]=s(a[r]),n=g(t[r])&&g(a[r])?"%"==l&&0==parseFloat(a[r])?p.d:N(t[r],l,a[r]):p.v,e.push(n)}}return e}if("array"==_(t)){a=s(a);let e=[];if("array"==_(t[0]))for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let h;t[r][e]=s(t[r][e]),h=g(t[r][e])&&g(a)?"%"==l&&0==parseFloat(a)?p.d:N(t[r][e],l,a):p.v,n.push(h)}e.push(n)}else for(let r=0;r<t.length;r++){let n;t[r]=s(t[r]),n=g(t[r])&&g(a)?"%"==l&&0==parseFloat(a)?p.d:N(t[r],l,a):p.v,e.push(n)}return e}if("array"==_(a)){t=s(t);let e=[];if("array"==_(a[0]))for(let r=0;r<a.length;r++){let n=[];for(let e=0;e<a[r].length;e++){let h;a[r][e]=s(a[r][e]),h=g(t)&&g(a[r][e])?"%"==l&&0==parseFloat(a[r][e])?p.d:N(t,l,a[r][e]):p.v,n.push(h)}e.push(n)}else for(let r=0;r<a.length;r++){let n;a[r]=s(a[r]),n=g(t)&&g(a[r])?"%"==l&&0==parseFloat(a[r])?p.d:N(t,l,a[r]):p.v,e.push(n)}return e}{let e;return t=s(t),a=s(a),e=g(t)&&g(a)?"%"==l&&0==parseFloat(a)?p.d:N(t,l,a):p.v}}if("=="==l||"!="==l||">="==l||"<="==l||">"==l||"<"==l){if("array"==_(t)&&"array"==_(a)){let e=[];if("array"==_(t[0])&&"array"==_(a[0])){if(t.length!=a.length&&t[0].length!=a[0].length)return p.na;for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let s=h(t[r][e],l,a[r][e]);n.push(s)}e.push(n)}}else if("array"==_(t[0])){if(t[0].length!=a.length)return p.na;for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let s=h(t[r][e],l,a[e]);n.push(s)}e.push(n)}}else if("array"==_(a[0])){if(a[0].length!=t.length)return p.na;for(let r=0;r<a.length;r++){let n=[];for(let e=0;e<a[r].length;e++){let s=h(t[e],l,a[r][e]);n.push(s)}e.push(n)}}else{if(t.length!=a.length)return p.na;for(let r=0;r<t.length;r++){let n=h(t[r],l,a[r]);e.push(n)}}return e}if("array"==_(t)){let e=[];if("array"==_(t[0]))for(let r=0;r<t.length;r++){let n=[];for(let e=0;e<t[r].length;e++){let s=h(t[r][e],l,a);n.push(s)}e.push(n)}else for(let r=0;r<t.length;r++){let n=h(t[r],l,a);e.push(n)}return e}if("array"==_(a)){let e=[];if("array"==_(a[0]))for(let r=0;r<a.length;r++){let n=[];for(let e=0;e<a[r].length;e++){let s=h(t,l,a[r][e]);n.push(s)}e.push(n)}else for(let r=0;r<a.length;r++){let n=h(t,l,a[r]);e.push(n)}return e}return h(t,l,a)}if("&"==l){if("array"==_(t)&&"array"==_(a)){let e=[];if("array"==_(t[0])&&"array"==_(a[0])){if(t.length!=a.length&&t[0].length!=a[0].length)return p.na;for(let l=0;l<t.length;l++){let r=[];for(let e=0;e<t[l].length;e++)r.push(t[l][e]+""+a[l][e]);e.push(r)}}else if("array"==_(t[0])){if(t[0].length!=a.length)return p.na;for(let l=0;l<t.length;l++){let r=[];for(let e=0;e<t[l].length;e++)r.push(t[l][e]+""+a[e]);e.push(r)}}else if("array"==_(a[0])){if(a[0].length!=t.length)return p.na;for(let l=0;l<a.length;l++){let r=[];for(let e=0;e<a[l].length;e++)r.push(t[e]+""+a[l][e]);e.push(r)}}else{if(t.length!=a.length)return p.na;for(let l=0;l<t.length;l++)e.push(t[l]+""+a[l])}return e}if("array"==_(t)){let e=[];if("array"==_(t[0]))for(let l=0;l<t.length;l++){let r=[];for(let e=0;e<t[l].length;e++)r.push(t[l][e]+""+a);e.push(r)}else for(let l=0;l<t.length;l++)e.push(t[l]+""+a);return e}if("array"==_(a)){let e=[];if("array"==_(a[0]))for(let l=0;l<a.length;l++){let r=[];for(let e=0;e<a[l].length;e++)r.push(t+""+a[l][e]);e.push(r)}else for(let l=0;l<a.length;l++)e.push(t+""+a[l]);return e}return t+""+a}if("^"==l){if("array"==_(t)&&"array"==_(a)){let e=[];if("array"==_(t[0])&&"array"==_(a[0])){if(t.length!=a.length&&t[0].length!=a[0].length)return p.na;for(let l=0;l<t.length;l++){let r=[];for(let e=0;e<t[l].length;e++){let n;t[l][e]=s(t[l][e]),a[l][e]=s(a[l][e]),n=g(t[l][e])&&g(a[l][e])?Math.pow(parseFloat(t[l][e]),parseFloat(a[l][e])):p.v,r.push(n)}e.push(r)}}else if("array"==_(t[0])){if(t[0].length!=a.length)return p.na;for(let l=0;l<t.length;l++){let r=[];for(let e=0;e<t[l].length;e++){let n;t[l][e]=s(t[l][e]),a[e]=s(a[e]),n=g(t[l][e])&&g(a[e])?Math.pow(parseFloat(t[l][e]),parseFloat(a[e])):p.v,r.push(n)}e.push(r)}}else if("array"==_(a[0])){if(a[0].length!=t.length)return p.na;for(let l=0;l<a.length;l++){let r=[];for(let e=0;e<a[l].length;e++){let n;t[e]=s(t[e]),a[l][e]=s(a[l][e]),n=g(t[e])&&g(a[l][e])?Math.pow(parseFloat(t[e]),parseFloat(a[l][e])):p.v,r.push(n)}e.push(r)}}else{if(t.length!=a.length)return p.na;for(let l=0;l<t.length;l++){let r;t[l]=s(t[l]),a[l]=s(a[l]),r=g(t[l])&&g(a[l])?Math.pow(parseFloat(t[l]),parseFloat(a[l])):p.v,e.push(r)}}return e}if("array"==_(t)){a=s(a);let e=[];if("array"==_(t[0]))for(let l=0;l<t.length;l++){let r=[];for(let e=0;e<t[l].length;e++){let n;t[l][e]=s(t[l][e]),n=g(t[l][e])&&g(a)?Math.pow(parseFloat(t[l][e]),parseFloat(a)):p.v,r.push(n)}e.push(r)}else for(let l=0;l<t.length;l++){let r;t[l]=s(t[l]),r=g(t[l])&&g(a)?Math.pow(parseFloat(t[l]),parseFloat(a)):p.v,e.push(r)}return e}if("array"==_(a)){t=s(t);let e=[];if("array"==_(a[0]))for(let l=0;l<a.length;l++){let r=[];for(let e=0;e<a[l].length;e++){let n;a[l][e]=s(a[l][e]),n=g(t)&&g(a[l][e])?Math.pow(parseFloat(t),parseFloat(a[l][e])):p.v,r.push(n)}e.push(r)}else for(let l=0;l<a.length;l++){let r;a[l]=s(a[l]),r=g(t)&&g(a[l])?Math.pow(parseFloat(t),parseFloat(a[l])):p.v,e.push(r)}return e}{let e;return t=s(t),a=s(a),e=g(t)&&g(a)?Math.pow(parseFloat(t),parseFloat(a)):p.v}}},luckysheet_getarraydata:function(){let e=arguments[0],t=[];if((e=e.replace("{","").replace("}","").replace(/\"/g,"")).indexOf(";")>-1){t=e.split(";");for(let e=0;e<t.length;e++)t[e]=t[e].split(",")}else t=e.split(",");return t},luckysheet_getcelldata:k,luckysheet_parseData:function(e){if("object"==typeof e)return null==e?"":Array.isArray(e)?y(e[0])[2]:Array.isArray(e.data)?p.v:void 0===e.data.v?"":e.data.v;if(!t.isCompareOperator(e).flag)return y(e)[2];return"string"==typeof e||"number"==typeof e?e:p.v},luckysheet_getValue:function(){let e=arguments[0];for(let l=0;l<e.length;l++){let r=e[l];"object"==typeof r?r=null==r?"":Array.isArray(r)?y(r[0])[2]:Array.isArray(r.data)?r.data:void 0===r.data.v?"":r.data.v:t.isCompareOperator(r).flag||(r=y(r)[2]),e[l]=r}},luckysheet_indirect_check:function(){let e=arguments[0];return null==e||0==e.length?null:e},luckysheet_indirect_check_return:function(e){return e},luckysheet_offset_check:function(){if("object"!=_(arguments[0])||null==arguments[0].startCell)return t.error.v;var l=arguments[0].startCell,r=e.getFirstValue(arguments[1]);if(i(r))return r;if(!g(r))return t.error.v;r=parseInt(r);var a=e.getFirstValue(arguments[2]);if(i(a))return a;if(!g(a))return t.error.v;a=parseInt(a);var n=arguments[0].rowl;if(arguments.length>=4){if(n=e.getFirstValue(arguments[3]),i(n))return n;if(!g(n))return t.error.v;n=parseInt(n)}var h=arguments[0].coll;if(5==arguments.length){if(h=e.getFirstValue(arguments[4]),i(h))return h;if(!g(h))return t.error.v;h=parseInt(h)}if(n<1||h<1)return t.error.r;var s=t.getcellrange(l),u=s.row[0],o=s.column[0],p=(u+=r)+n-1,c=(o+=a)+h-1;return u<0||p>=f.flowdata.length||o<0||c>=f.flowdata[0].length?t.error.r:w(f.calculateSheetIndex,{row:[u,p],column:[o,c]})},luckysheet_calcADPMM:N,luckysheet_getSpecialReference:function(e,t,l){let r,a;if(e?(a=t,r=l):(r=t,a=l),r.startCell.indexOf(":")>-1||a.indexOf(":")>-1)return p.v;if(e)return k(a+":"+r.startCell);{let e=a,t="";if(a.indexOf("!")>-1){let l=a.split("!");t=l[0]+"!",e=l[1]}return k(t+r.startCell+":"+e)}}}});
//# sourceMappingURL=../sourcemaps/function/func.js.map
