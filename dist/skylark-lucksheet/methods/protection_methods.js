/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../store","../locale/locale","../methods/get","../methods/set","../utils/util"],function(e,t,l,n,o){"use strict";const{getSheetIndex:u}=l,{setluckysheet_scroll_status:r}=n,{replaceHtml:i,transformRangeToAbsolute:c,openSelfModel:f}=o;return{checkProtectionNotEnable:function(l){let n=e.getSheetByIndex(l);if(null==n)return!0;if(null==n.config||null==n.config.authority)return!0;let o=n.config.authority;if(null==o||null==o.sheet||0==o.sheet)return!0;const u=t().protection;let r;return r=null!=o.hintText&&o.hintText.length>0?o.hintText:u.defaultSheetHintText,tooltip.info("",r),!1},checkProtectionLocked:function(l,n,o){let u=e.getSheetByIndex(o);if(null==u)return!0;if(null==u.config||null==u.config.authority)return!0;let r=u.data[l][n],i=u.config.authority;if(null==i||null==i.sheet||0==i.sheet)return!0;if(r&&!r.lo)return!0;const c=t().protection;return checkProtectionLockedSqref(l,n,i,c)},checkProtectionCellHidden:function(t,l,n){let o=e.getSheetByIndex(n);if(!o||!o.data[t]||!o.data[t][l])return!0;if(null==o.config||null==o.config.authority)return!0;let u=o.data[t][l],r=o.config.authority;return null==r||null==r.sheet||0==r.sheet||null==u||null==u.hi||0==u.hi},checkProtectionLockedRangeList:function(l,n){if(l[0].column[0]!==l[0].column[1])return!0;let o=e.getSheetByIndex(n);if(null==o)return!0;if(null==o.config||null==o.config.authority)return!0;let u=o.config.authority;if(null==u||null==u.sheet||0==u.sheet)return!0;if(null==l||0==l.length)return!0;let r=o.data[l[0].row[0]][l[0].column[0]];if(r&&!r.lo)return!0;const i=t().protection;for(let e=0;e<l.length;e++){let t=l[e].row[0],n=l[e].row[1],o=l[e].column[0],r=l[e].column[1];for(let e=t;e<=n;e++)for(let t=o;t<=r;t++)if(0==checkProtectionLockedSqref(e,t,u,i))return!1}return!0},checkProtectionSelectLockedOrUnLockedCells:function(l,n,o){const u=t().protection;let r=e.getSheetByIndex(o);if(null==r)return!0;if(null==r.config||null==r.config.authority)return!0;let i=r.data[l][n],c=r.config.authority;return null==c||null==c.sheet||0==c.sheet||(i&&!i.lo?1==c.selectunLockedCells||null==c.selectunLockedCells:checkProtectionLockedSqref(l,n,c,u,!1)?1==c.selectunLockedCells||null==c.selectunLockedCells:1==c.selectLockedCells||null==c.selectLockedCells)},checkProtectionAllSelected:function(l){t().protection;let n=e.getSheetByIndex(l);if(null==n)return!0;if(null==n.config||null==n.config.authority)return!0;let o=n.config.authority;if(null==o||null==o.sheet||0==o.sheet)return!0;let u=!1;1!=o.selectunLockedCells&&null!=o.selectunLockedCells||(u=!0);let r=!1;return 1!=o.selectLockedCells&&null!=o.selectLockedCells||(r=!0),!(!u||!r)},checkProtectionFormatCells:function(l){let n=e.getSheetByIndex(l);if(null==n)return!0;if(null==n.config||null==n.config.authority)return!0;let o=n.config.authority;if(null==o||null==o.sheet||0==o.sheet)return!0;if(1==o.formatCells||null==o.formatCells)return!0;const u=t().protection;let r;return r=null!=o.hintText&&o.hintText.length>0?o.hintText:u.defaultSheetHintText,tooltip.info("",r),!1},checkProtectionAuthorityNormal:function(l,n="formatColumns",o=!0){let u=e.getSheetByIndex(l);if(null==u)return!0;if(null==u.config||null==u.config.authority)return!0;let r=u.config.authority;if(null==r||null==r.sheet||0==r.sheet)return!0;if(1==r[n]||null==r[n])return!0;if(o){const e=t().protection;let l;l=null!=r.hintText&&r.hintText.length>0?r.hintText:e.defaultSheetHintText,tooltip.info("",l)}return!1}}});
//# sourceMappingURL=../sourcemaps/methods/protection_methods.js.map
