/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./validate","./datecontroll","./getdata","../vendors/numeral"],function(e,t,r,a){"use strict";const{isRealNum:n,valueIsError:s}=e,{isdatetime:l}=t,{getcellvalue:c}=r;var h={};!function(e){function t(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function r(e,t){for(var r="";r.length<t;)r+=e;return r}function n(e,t){var a=""+e;return a.length>=t?a:r("0",t-a.length)+a}function s(e,t){var a=""+e;return a.length>=t?a:r(" ",t-a.length)+a}function l(e,t){var a=""+e;return a.length>=t?a:a+r(" ",t-a.length)}e.version="0.11.2";var c=Math.pow(2,32);function h(e,t){return e>c||e<-c?function(e,t){var a=""+Math.round(e);return a.length>=t?a:r("0",t-a.length)+a}(e,t):function(e,t){var a=""+e;return a.length>=t?a:r("0",t-a.length)+a}(Math.round(e),t)}function i(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var f=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],u=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function o(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e[65535]="General"}var g={};o(g);var d=[],b=0;for(b=5;b<=8;++b)d[b]=32+b;for(b=23;b<=26;++b)d[b]=0;for(b=27;b<=31;++b)d[b]=14;for(b=50;b<=58;++b)d[b]=14;for(b=59;b<=62;++b)d[b]=b-58;for(b=67;b<=68;++b)d[b]=b-58;for(b=72;b<=75;++b)d[b]=b-58;for(b=67;b<=68;++b)d[b]=b-57;for(b=76;b<=78;++b)d[b]=b-56;for(b=79;b<=81;++b)d[b]=b-34;var v=[];function m(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,l=1,c=0,h=1,i=0,f=0,u=Math.floor(n);i<t&&(c=(u=Math.floor(n))*l+s,f=u*i+h,!(n-u<5e-8));)n=1/(n-u),s=l,l=c,h=i,i=f;if(f>t&&(i>t?(f=h,c=s):(f=i,c=l)),!r)return[0,a*c,f];var o=Math.floor(a*c/f);return[o,a*c-o*f,f]}function p(e,t,r){if(e>2958465||e<0)return null;var a=0|e,n=Math.floor(86400*(e-a)),s=0,l=[],c={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,86400==++n&&(c.T=n=0,++a,++c.D)),60===a)l=r?[1317,10,29]:[1900,2,29],s=3;else if(0===a)l=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),l=[h.getFullYear(),h.getMonth()+1,h.getDate()],s=h.getDay(),a<60&&(s=(s+6)%7),r&&(s=function(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}(h,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=s,c}v[5]=v[63]='"$"#,##0_);\\("$"#,##0\\)',v[6]=v[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',v[7]=v[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',v[8]=v[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',v[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',v[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',v[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',v[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)',e.parse_date_code=p;var M=new Date(1899,11,31,0,0,0),O=M.getTime(),x=new Date(1900,2,1,0,0,0);function A(e,t){var r=e.getTime();return t?r-=1262304e5:e>=x&&(r+=864e5),(r-(O+6e4*(e.getTimezoneOffset()-M.getTimezoneOffset())))/864e5}e._general_int=function(e){return e.toString(10)};var $=function(){var e=/(?:\.0*|(\.\d*[1-9])0+)$/;function t(t){return-1==t.indexOf(".")?t:t.replace(e,"$1")}var r=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,a=/(E[+-])(\d)$/;return function(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t(function(e){return-1==e.indexOf("E")?e:e.replace(r,"$1E").replace(a,"$10$2")}((n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var r=e<0?12:11,a=t(e.toFixed(12));return a.length<=r?a:(a=e.toPrecision(10)).length<=r?a:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var r=t(e.toFixed(11));return r.length>(e<0?12:11)||"0"===r||"-0"===r?e.toPrecision(6):r}(e)).toUpperCase()))}}();function k(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):$(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return G(14,A(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}e._general_num=$,e._general=k;"๐๑๒๓๔๕๖๗๘๙".split("");function w(e,t,r,a){var s,l="",c=0,h=0,i=r.y,o=0;switch(e){case 98:i=r.y+543;case 121:switch(t.length){case 1:case 2:s=i%100,o=2;break;default:s=i%1e4,o=4}break;case 109:switch(t.length){case 1:case 2:s=r.m,o=t.length;break;case 3:return u[r.m-1][1];case 5:return u[r.m-1][0];default:return u[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:s=r.d,o=t.length;break;case 3:return f[r.q][0];default:return f[r.q][1]}break;case 104:switch(t.length){case 1:case 2:s=1+(r.H+11)%12,o=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:s=r.H,o=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:s=r.M,o=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(h=a>=2?3===a?1e3:100:1===a?10:1,(c=Math.round(h*(r.S+r.u)))>=60*h&&(c=0),"s"===t?0===c?"0":""+c/h:(l=n(c,2+a),"ss"===t?l.substr(0,2):"."+l.substr(2,t.length-1))):n(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":s=24*r.D+r.H;break;case"[m]":case"[mm]":s=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":s=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}o=3===t.length?1:2;break;case 101:s=i,o=1}return o>0?n(s,o):""}function S(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var E=function(){var e=/%/g,a=/# (\?+)( ?)\/( ?)(\d+)/,c=/^#*0*\.([0#]+)/,i=/\).*[0#]/,f=/\(###\) ###\\?-####/;function u(e){for(var t,r="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function o(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function g(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function d(b,v,p){if(40===b.charCodeAt(0)&&!v.match(i)){var M=v.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return p>=0?d("n",M,p):"("+d("n",M,-p)+")"}if(44===v.charCodeAt(v.length-1))return function(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return E(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(b,v,p);if(-1!==v.indexOf("%"))return function(t,a,n){var s=a.replace(e,""),l=a.length-s.length;return E(t,s,n*Math.pow(10,2*l))+r("%",l)}(b,v,p);if(-1!==v.indexOf("E"))return function e(t,r){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var s=t.indexOf(".");-1===s&&(s=t.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%s;if(l<0&&(l+=s),-1===(a=(r/Math.pow(10,l)).toPrecision(n+1+(s+l)%s)).indexOf("e")){var c=Math.floor(Math.log(r)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(c-a.length+l):a+="E+"+(c-l);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,s)+"."+a.substr(2+s)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(s+l)%s)+"."+a.substr(l)+"E"})}else a=r.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(v,p);if(36===v.charCodeAt(0))return"$"+d(b,v.substr(" "==v.charAt(1)?2:1),p);var O,x,A,$,k=Math.abs(p),w=p<0?"-":"";if(v.match(/^00+$/))return w+h(k,v.length);if(v.match(/^[#?]+$/))return"0"===(O=h(p,0))&&(O=""),O.length>v.length?O:u(v.substr(0,v.length-O.length))+O;if(x=v.match(a))return function(e,t,a){var l=parseInt(e[4],10),c=Math.round(t*l),h=Math.floor(c/l),i=c-h*l,f=l;return a+(0===h?"":""+h)+" "+(0===i?r(" ",e[1].length+1+e[4].length):s(i,e[1].length)+e[2]+"/"+e[3]+n(f,e[4].length))}(x,k,w);if(v.match(/^#+0+$/))return w+h(k,v.length-v.indexOf("0"));if(x=v.match(c))return O=o(p,x[1].length).replace(/^([^\.]+)$/,"$1."+u(x[1])).replace(/\.$/,"."+u(x[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+r("0",u(x[1]).length-t.length)}),-1!==v.indexOf("0.")?O:O.replace(/^0\./,".");if(v=v.replace(/^#+([0.])/,"$1"),x=v.match(/^(0*)\.(#*)$/))return w+o(k,x[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,x[1].length?"0.":".");if(x=v.match(/^#{1,3},##0(\.?)$/))return w+S(h(k,0));if(x=v.match(/^#,##0\.([#0]*0)$/))return p<0?"-"+d(b,v,-p):S(""+(Math.floor(p)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(p,x[1].length)))+"."+n(g(p,x[1].length),x[1].length);if(x=v.match(/^#,#*,#0/))return d(b,v.replace(/^#,#*,/,""),p);if(x=v.match(/^([0#]+)(\\?-([0#]+))+$/))return O=t(d(b,v.replace(/[\\-]/g,""),p)),A=0,t(t(v.replace(/\\/g,"")).replace(/[0#]/g,function(e){return A<O.length?O.charAt(A++):"0"===e?"0":""}));if(v.match(f))return"("+(O=d(b,"##########",p)).substr(0,3)+") "+O.substr(3,3)+"-"+O.substr(6);var _="";if(x=v.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(x[4].length,7),$=m(k,Math.pow(10,A)-1,!1),O=""+w," "==(_=E("n",x[1],$[1])).charAt(_.length-1)&&(_=_.substr(0,_.length-1)+"0"),O+=_+x[2]+"/"+x[3],(_=l($[2],A)).length<x[4].length&&(_=u(x[4].substr(x[4].length-_.length))+_),O+=_;if(x=v.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(Math.max(x[1].length,x[4].length),7),w+(($=m(k,Math.pow(10,A)-1,!0))[0]||($[1]?"":"0"))+" "+($[1]?s($[1],A)+x[2]+"/"+x[3]+l($[2],A):r(" ",2*A+1+x[2].length+x[3].length));if(x=v.match(/^[#0?]+$/))return O=h(p,0),v.length<=O.length?O:u(v.substr(0,v.length-O.length))+O;if(x=v.match(/^([#0?]+)\.([#0]+)$/)){O=""+p.toFixed(Math.min(x[2].length,10)).replace(/([^0])0+$/,"$1"),A=O.indexOf(".");var y=v.indexOf(".")-A,F=v.length-O.length-y;return u(v.substr(0,y)+O+v.substr(v.length-F))}if(x=v.match(/^00,000\.([#0]*0)$/))return A=g(p,x[1].length),p<0?"-"+d(b,v,-p):S(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(p)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?n(0,3-e.length):"")+e})+"."+n(A,x[1].length);switch(v){case"###,##0.00":return d(b,"#,##0.00",p);case"###,###":case"##,###":case"#,###":var C=S(h(k,0));return"0"!==C?w+C:"";case"###,###.00":return d(b,"###,##0.00",p).replace(/^0\./,".");case"#,###.00":return d(b,"#,##0.00",p).replace(/^0\./,".")}throw new Error("unsupported format |"+v+"|")}function b(h,o,g){if(40===h.charCodeAt(0)&&!o.match(i)){var d=o.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return g>=0?b("n",d,g):"("+b("n",d,-g)+")"}if(44===o.charCodeAt(o.length-1))return function(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return E(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(h,o,g);if(-1!==o.indexOf("%"))return function(t,a,n){var s=a.replace(e,""),l=a.length-s.length;return E(t,s,n*Math.pow(10,2*l))+r("%",l)}(h,o,g);if(-1!==o.indexOf("E"))return function e(t,r){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var s=t.indexOf(".");-1===s&&(s=t.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%s;if(l<0&&(l+=s),!(a=(r/Math.pow(10,l)).toPrecision(n+1+(s+l)%s)).match(/[Ee]/)){var c=Math.floor(Math.log(r)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(c-a.length+l):a+="E+"+(c-l),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(s+l)%s)+"."+a.substr(l)+"E"})}else a=r.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(o,g);if(36===o.charCodeAt(0))return"$"+b(h,o.substr(" "==o.charAt(1)?2:1),g);var v,p,M,O,x=Math.abs(g),A=g<0?"-":"";if(o.match(/^00+$/))return A+n(x,o.length);if(o.match(/^[#?]+$/))return v=""+g,0===g&&(v=""),v.length>o.length?v:u(o.substr(0,o.length-v.length))+v;if(p=o.match(a))return function(e,t,a){return a+(0===t?"":""+t)+r(" ",e[1].length+2+e[4].length)}(p,x,A);if(o.match(/^#+0+$/))return A+n(x,o.length-o.indexOf("0"));if(p=o.match(c))return v=(v=(""+g).replace(/^([^\.]+)$/,"$1."+u(p[1])).replace(/\.$/,"."+u(p[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+r("0",u(p[1]).length-t.length)}),-1!==o.indexOf("0.")?v:v.replace(/^0\./,".");if(o=o.replace(/^#+([0.])/,"$1"),p=o.match(/^(0*)\.(#*)$/))return A+(""+x).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,p[1].length?"0.":".");if(p=o.match(/^#{1,3},##0(\.?)$/))return A+S(""+x);if(p=o.match(/^#,##0\.([#0]*0)$/))return g<0?"-"+b(h,o,-g):S(""+g)+"."+r("0",p[1].length);if(p=o.match(/^#,#*,#0/))return b(h,o.replace(/^#,#*,/,""),g);if(p=o.match(/^([0#]+)(\\?-([0#]+))+$/))return v=t(b(h,o.replace(/[\\-]/g,""),g)),M=0,t(t(o.replace(/\\/g,"")).replace(/[0#]/g,function(e){return M<v.length?v.charAt(M++):"0"===e?"0":""}));if(o.match(f))return"("+(v=b(h,"##########",g)).substr(0,3)+") "+v.substr(3,3)+"-"+v.substr(6);var $="";if(p=o.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return M=Math.min(p[4].length,7),O=m(x,Math.pow(10,M)-1,!1),v=""+A," "==($=E("n",p[1],O[1])).charAt($.length-1)&&($=$.substr(0,$.length-1)+"0"),v+=$+p[2]+"/"+p[3],($=l(O[2],M)).length<p[4].length&&($=u(p[4].substr(p[4].length-$.length))+$),v+=$;if(p=o.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return M=Math.min(Math.max(p[1].length,p[4].length),7),A+((O=m(x,Math.pow(10,M)-1,!0))[0]||(O[1]?"":"0"))+" "+(O[1]?s(O[1],M)+p[2]+"/"+p[3]+l(O[2],M):r(" ",2*M+1+p[2].length+p[3].length));if(p=o.match(/^[#0?]+$/))return v=""+g,o.length<=v.length?v:u(o.substr(0,o.length-v.length))+v;if(p=o.match(/^([#0]+)\.([#0]+)$/)){v=""+g.toFixed(Math.min(p[2].length,10)).replace(/([^0])0+$/,"$1"),M=v.indexOf(".");var k=o.indexOf(".")-M,w=o.length-v.length-k;return u(o.substr(0,k)+v+o.substr(o.length-w))}if(p=o.match(/^00,000\.([#0]*0)$/))return g<0?"-"+b(h,o,-g):S(""+g).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?n(0,3-e.length):"")+e})+"."+n(0,p[1].length);switch(o){case"###,###":case"##,###":case"#,###":var _=S(""+x);return"0"!==_?A+_:"";default:if(o.match(/\.[0#?]*$/))return b(h,o.slice(0,o.lastIndexOf(".")),g)+u(o.slice(o.lastIndexOf(".")))}throw new Error("unsupported format |"+o+"|")}return function(e,t,r){return(0|r)===r?b(e,t,r):d(e,t,r)}}();function _(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}e._split=_;var y=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function F(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":i(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=r;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(y))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":default:++t}return!1}function C(e,t,r,a){for(var n,s,l,c=[],h="",f=0,u="",o="t",g="H";f<e.length;)switch(u=e.charAt(f)){case"G":if(!i(e,f))throw new Error("unrecognized character "+u+" in "+e);c[c.length]={t:"G",v:"General"},f+=7;break;case'"':for(h="";34!==(l=e.charCodeAt(++f))&&f<e.length;)h+=String.fromCharCode(l);c[c.length]={t:"t",v:h},++f;break;case"\\":var d=e.charAt(++f),b="("===d||")"===d?d:"t";c[c.length]={t:b,v:d},++f;break;case"_":c[c.length]={t:"t",v:" "},f+=2;break;case"@":c[c.length]={t:"T",v:t},++f;break;case"B":case"b":if("1"===e.charAt(f+1)||"2"===e.charAt(f+1)){if(null==n&&null==(n=p(t,r,"2"===e.charAt(f+1))))return"";c[c.length]={t:"X",v:e.substr(f,2)},o=u,f+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==n&&null==(n=p(t,r)))return"#####";for(h=u;++f<e.length&&e.charAt(f).toLowerCase()===u;)h+=u;"m"===u&&"h"===o.toLowerCase()&&(u="M"),"h"===u&&(u=g),c[c.length]={t:u,v:h},o=u;break;case"A":case"a":case"上":var v={t:u,v:u};if(null==n&&(n=p(t,r)),"A/P"===e.substr(f,3).toUpperCase()?(null!=n&&(v.v=n.H>=12?"P":"A"),v.t="T",g="h",f+=3):"AM/PM"===e.substr(f,5).toUpperCase()?(null!=n&&(v.v=n.H>=12?"PM":"AM"),v.t="T",f+=5,g="h"):"上午/下午"===e.substr(f,5).toUpperCase()?(null!=n&&(v.v=n.H>=12?"下午":"上午"),v.t="T",f+=5,g="h"):(v.t="t",++f),null==n&&"T"===v.t)return"";c[c.length]=v,o=u;break;case"[":for(h=u;"]"!==e.charAt(f++)&&f<e.length;)h+=e.charAt(f);if("]"!==h.slice(-1))throw'unterminated "[" block: |'+h+"|";if(h.match(y)){if(null==n&&null==(n=p(t,r)))return"";c[c.length]={t:"Z",v:h.toLowerCase()},o=h.charAt(1)}else h.indexOf("$")>-1&&(h=(h.match(/\$([^-\[\]]*)/)||[])[1]||"$",F(e)||(c[c.length]={t:"t",v:h}));break;case".":if(null!=n){for(h=u;++f<e.length&&"0"===(u=e.charAt(f));)h+=u;c[c.length]={t:"s",v:h};break}case"0":case"#":for(h=u;++f<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(f))>-1;)h+=u;c[c.length]={t:"n",v:h};break;case"?":for(h=u;e.charAt(++f)===u;)h+=u;c[c.length]={t:u,v:h},o=u;break;case"*":++f," "!=e.charAt(f)&&"*"!=e.charAt(f)||++f;break;case"(":case")":c[c.length]={t:1===a?"t":u,v:u},++f;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(h=u;f<e.length&&"0123456789".indexOf(e.charAt(++f))>-1;)h+=e.charAt(f);c[c.length]={t:"D",v:h};break;case" ":c[c.length]={t:u,v:u},++f;break;case"$":c[c.length]={t:"t",v:"$"},++f;break;default:if(-1==="¤฿BsBr₵₡₫ƒFtRs.₭kr£₤Lm₥₦₱PQRSkRp৲৳R$S/.〒₮₩¥NT￥zł₴₪៛руб€＄,$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP$￥LekdinAf$dhAflRial?￡BirrKzMOPPGKRsGsB/R$ррlevkrKMzBsPNuFBuKPkrRD$NfkCFA?CVEGMDFrCDHTGNAfLFdjKGSFGGHSRielKCFknKshLSLL￡LtRFRONArRfMWKRMMURsMROS/KMDLMTnRC$kr€GELCHFSLLSCRDbSZLSDGSOSSomFCFPTShT$VUVQUGXгрнsomWSTNT$FtDramRpZMWFCFA".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);c[c.length]={t:"t",v:u},++f}var m,M=0,O=0;for(f=c.length-1,o="t";f>=0;--f)switch(c[f].t){case"h":case"H":c[f].t=g,o="h",M<1&&(M=1);break;case"s":(m=c[f].v.match(/\.0+$/))&&(O=Math.max(O,m[0].length-1)),M<3&&(M=3);case"d":case"y":case"M":case"e":o=c[f].t;break;case"m":"s"===o&&(c[f].t="M",M<2&&(M=2));break;case"X":break;case"Z":M<1&&c[f].v.match(/[Hh]/)&&(M=1),M<2&&c[f].v.match(/[Mm]/)&&(M=2),M<3&&c[f].v.match(/[Ss]/)&&(M=3)}switch(M){case 0:break;case 1:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M),n.M>=60&&(n.M=0,++n.H);break;case 2:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M)}var x,A="";for(f=0;f<c.length;++f)switch(c[f].t){case"t":case"T":case" ":case"D":break;case"X":c[f].v="",c[f].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":c[f].v=w(c[f].t.charCodeAt(0),c[f].v,n,O),c[f].t="t";break;case"n":case"?":for(x=f+1;null!=c[x]&&("?"===(u=c[x].t)||"D"===u||(" "===u||"t"===u)&&null!=c[x+1]&&("?"===c[x+1].t||"t"===c[x+1].t&&"/"===c[x+1].v)||"("===c[f].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===c[x].v||" "===c[x].v&&null!=c[x+1]&&"?"==c[x+1].t));)c[f].v+=c[x].v,c[x]={v:"",t:";"},++x;A+=c[f].v,f=x-1;break;case"G":c[f].t="t",c[f].v=k(t,r)}var $,S,_="";if(A.length>0){40==A.charCodeAt(0)?($=t<0&&45===A.charCodeAt(0)?-t:t,S=E("n",A,$)):(S=E("n",A,$=t<0&&a>1?-t:t),$<0&&c[0]&&"t"==c[0].t&&(S=S.substr(1),c[0].v="-"+c[0].v)),x=S.length-1;var C=c.length;for(f=0;f<c.length;++f)if(null!=c[f]&&"t"!=c[f].t&&c[f].v.indexOf(".")>-1){C=f;break}var D=c.length;if(C===c.length&&-1===S.indexOf("E")){for(f=c.length-1;f>=0;--f)null!=c[f]&&-1!=="n?".indexOf(c[f].t)&&(x>=c[f].v.length-1?(x-=c[f].v.length,c[f].v=S.substr(x+1,c[f].v.length)):x<0?c[f].v="":(c[f].v=S.substr(0,x+1),x=-1),c[f].t="t",D=f);x>=0&&D<c.length&&(c[D].v=S.substr(0,x+1)+c[D].v)}else if(C!==c.length&&-1===S.indexOf("E")){for(x=S.indexOf(".")-1,f=C;f>=0;--f)if(null!=c[f]&&-1!=="n?".indexOf(c[f].t)){for(s=c[f].v.indexOf(".")>-1&&f===C?c[f].v.indexOf(".")-1:c[f].v.length-1,_=c[f].v.substr(s+1);s>=0;--s)x>=0&&("0"===c[f].v.charAt(s)||"#"===c[f].v.charAt(s))&&(_=S.charAt(x--)+_);c[f].v=_,c[f].t="t",D=f}for(x>=0&&D<c.length&&(c[D].v=S.substr(0,x+1)+c[D].v),x=S.indexOf(".")+1,f=C;f<c.length;++f)if(null!=c[f]&&(-1!=="n?(".indexOf(c[f].t)||f===C)){for(s=c[f].v.indexOf(".")>-1&&f===C?c[f].v.indexOf(".")+1:0,_=c[f].v.substr(0,s);s<c[f].v.length;++s)x<S.length&&(_+=S.charAt(x++));c[f].v=_,c[f].t="t",D=f}}}for(f=0;f<c.length;++f)null!=c[f]&&"n?".indexOf(c[f].t)>-1&&($=a>1&&t<0&&f>0&&"-"===c[f-1].v?-t:t,c[f].v=E(c[f].t,c[f].v,$),c[f].t="t");var T="";for(f=0;f!==c.length;++f)null!=c[f]&&(T+=c[f].v);return T}e.is_date=F,e._eval=C;var D=/\[[=<>]/,T=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function N(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function G(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:g)[e])&&(n=r.table&&r.table[d[e]]||g[d[e]]),null==n&&(n=v[e]||"General")}if(n.match(/^(w|W)((0?)|(0\.0+))$/)){if(isNaN(t))return t;var s=n.slice(1),l=!1;!isNaN(t)&&Number(t)<0&&(l=!0,t=Math.abs(t));var c=parseInt(t).toString().length;if(c>4){if(c>8){var h=parseInt(t/1e8),f=parseInt(parseFloat(t).subtract(1e8*h)/1e4),u=parseFloat(t).subtract(1e8*h+1e4*f);""!=s&&(u=a(u).format(s)),t=h+"亿"+f+"万"+u}else f=parseInt(t/1e4),u=parseFloat(t).subtract(1e4*f),""!=s&&(u=a(u).format(s)),t=f+"万"+u;if(-1!=t.indexOf("亿0万0")?t=t.replace("0万0",""):-1!=t.indexOf("亿0万")?t=t.replace("0万",""):-1!=t.indexOf("万0")&&(t=t.replace("万0","万")),-1!=t.indexOf("亿")&&-1==t.indexOf("万")){if("."!==(o=t.substring(t.indexOf("亿")+1)).substring(0,1)&&""!=o){switch((parseInt(o)+"").length){case 1:o="000"+o;break;case 2:o="00"+o;break;case 3:o="0"+o}t=t.substring(0,t.indexOf("亿")+1)+o}}else if(-1==t.indexOf("亿")&&-1!=t.indexOf("万")){if("."!==(b=t.substring(t.indexOf("万")+1)).substring(0,1)&&""!=b){switch((parseInt(b)+"").length){case 1:b="000"+b;break;case 2:b="00"+b;break;case 3:b="0"+b}t=t.substring(0,t.indexOf("万")+1)+b}}else if(-1!=t.indexOf("亿")&&-1!=t.indexOf("万")){var o=t.substring(t.indexOf("亿")+1,t.indexOf("万")),b=t.substring(t.indexOf("万")+1);switch((parseInt(o)+"").length){case 1:o="000"+o;break;case 2:o="00"+o;break;case 3:o="0"+o}if(t=t.substring(0,t.indexOf("亿")+1)+o+t.substring(t.indexOf("万")),"."!==b.substring(0,1)&&""!=b){switch((parseInt(b)+"").length){case 1:b="000"+b;break;case 2:b="00"+b;break;case 3:b="0"+b}t=t.substring(0,t.indexOf("万")+1)+b}}}else""!=s&&(t=a(t).format(s));return l?"-"+t:t}if(i(n,0))return k(t,r);t instanceof Date&&(t=A(t,r.date1904));var m=function(e,t){var r=_(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var s=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[a,s];if(null!=r[0].match(D)||null!=r[1].match(D)){var l=r[0].match(T),c=r[1].match(T);return N(t,l)?[a,r[0]]:N(t,c)?[a,r[1]]:[a,r[null!=l&&null!=c?2:1]]}return[a,s]}(n,t);if(i(m[1]))return k(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return C(m[1],t,r,m[0])}function R(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=g[r]){if(g[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return g[t]=e,t}e.load=R,e._table=g,e.get_table=function(){return g},e.load_table=function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&R(e[t],t)},e.init_table=o,e.format=G}(h);var i,f;h._table[22],h._table[15],h._table[14],h._table[19],h._table[18],h._table[20],h._table[2],h._table[4],h._table[10],h._table[11],i=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/g,f=/_x([\da-fA-F]{4})_/g;new Date(1899,11,31,0,0,0).getTime();var u=new Date(1900,2,1,0,0,0);function o(e,t){var r=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()),a=Date.UTC(1899,11,31,0,0,0);return t?r-=1262304e5:e>=u&&(r+=864e5),(r-a)/864e5}var g=new Date("2017-02-19T19:06:09.000Z");isNaN(g.getFullYear())&&(g=new Date("2/19/17"));var d=2017==g.getFullYear();return{datenum_local:o,genarate:function(e){var t=null,r={},c=e;if(null==e)return null;if("'"===e.toString().substr(0,1))t=e.toString().substr(1),r={fa:"@",t:"s"};else if("TRUE"===e.toString().toUpperCase())t="TRUE",r={fa:"General",t:"b"},c=!0;else if("FALSE"===e.toString().toUpperCase())t="FALSE",r={fa:"General",t:"b"},c=!1;else if(s(e))t=e.toString(),r={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))t=e.toString(),r={fa:"@",t:"s"};else if(n(e)&&Math.abs(parseFloat(e))>0&&(Math.abs(parseFloat(e))>=1e11||Math.abs(parseFloat(e))<1e-9)){var i=(c=a(e).value()).toExponential();if(i.indexOf(".")>-1){var f=i.split(".")[1].split("e")[0].length;f>5&&(f=5),r={fa:"#0."+new Array(f+1).join("0")+"E+00",t:"n"}}else r={fa:"#0.E+00",t:"n"};t=h.format(r.fa,c)}else if(e.toString().indexOf("%")>-1){var u=e.toString().indexOf("%"),b=(O=e.toString().substr(0,u)).replace(/,/g,"");if(u==e.toString().length-1&&n(b))if(O.indexOf(".")>-1)if(O.indexOf(".")==O.lastIndexOf(".")){var v=O.split(".")[0];if((x=O.split(".")[1].length)>9&&(x=9),v.indexOf(",")>-1){for(var m=!0,p=v.split(","),M=1;M<p.length;M++)if(p[M].length<3){m=!1;break}m?(r={fa:"#,##0."+new Array(x+1).join("0")+"%",t:"n"},c=a(e).value(),t=h.format(r.fa,c)):(t=e.toString(),r={fa:"@",t:"s"})}else r={fa:"0."+new Array(x+1).join("0")+"%",t:"n"},c=a(e).value(),t=h.format(r.fa,c)}else t=e.toString(),r={fa:"@",t:"s"};else if(O.indexOf(",")>-1){for(m=!0,p=O.split(","),M=1;M<p.length;M++)if(p[M].length<3){m=!1;break}m?(r={fa:"#,##0%",t:"n"},c=a(e).value(),t=h.format(r.fa,c)):(t=e.toString(),r={fa:"@",t:"s"})}else r={fa:"0%",t:"n"},c=a(e).value(),t=h.format(r.fa,c);else t=e.toString(),r={fa:"@",t:"s"}}else if(e.toString().indexOf(".")>-1)if(e.toString().indexOf(".")==e.toString().lastIndexOf(".")){var O,x,A=e.toString().split(".")[0];if((x=(O=e.toString().split(".")[1]).length)>9&&(x=9),A.indexOf(",")>-1){for(m=!0,p=A.split(","),M=1;M<p.length;M++)if(!n(p[M])||p[M].length<3){m=!1;break}m?(r={fa:"#,##0."+new Array(x+1).join("0"),t:"n"},c=a(e).value(),t=h.format(r.fa,c)):(t=e.toString(),r={fa:"@",t:"s"})}else n(A)&&n(O)?(r={fa:"0."+new Array(x+1).join("0"),t:"n"},c=a(e).value(),t=h.format(r.fa,c)):(t=e.toString(),r={fa:"@",t:"s"})}else t=e.toString(),r={fa:"@",t:"s"};else n(e)?(t=e.toString(),r={fa:"General",t:"n"},c=parseFloat(e)):l(e)&&(e.toString().indexOf(".")>-1||e.toString().indexOf(":")>-1||e.toString().length<16)?((c=o(function(e,t){var r=new Date(e);if(d)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==g.getFullYear()&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1?r:(r.setFullYear(r.getFullYear()+100),r)}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}(e.toString().replace(/-/g,"/")))).toString().indexOf(".")>-1?e.toString().length>18?r.fa="yyyy-MM-dd hh:mm:ss":e.toString().length>11?r.fa="yyyy-MM-dd hh:mm":r.fa="yyyy-MM-dd":r.fa="yyyy-MM-dd",r.t="d",t=h.format(r.fa,c)):(t=e,r.fa="General",r.t="g");return[t,r,c]},update:function(e,t){return h.format(e,t)},is_date:function(e,t){return h.is_date(e,t)},valueShowEs:function(e,t,r){var a=c(e,t,r,"m");return null==a?a=c(e,t,r,"v"):isNaN(function(e){var t=Number(e);if("number"==typeof e)return e;if(!isNaN(t))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(a))?(a=a.replace(/[(](.*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(a))?t:t/r):t/r}(a))?null!=r[e][t].ct&&"d"==r[e][t].ct.t||null!=r[e][t].ct&&"b"==r[e][t].ct.t||(a=c(e,t,r,"v")):"string"==typeof a&&a.indexOf("%")>-1||(a=c(e,t,r,"v")),a}}});
//# sourceMappingURL=../sourcemaps/methods/format.js.map
