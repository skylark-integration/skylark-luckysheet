/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../methods/get","../methods/sheetSearch","../methods/cells","../store","../locale/locale"],function(e,l,t,n,a){"use strict";const{getSheetIndex:r}=e,{luckysheet_searcharray:o}=l,i={initialHorizontal:!0,initialVertical:!0,horizontalmovestate:!1,horizontalmoveposition:null,verticalmovestate:!1,verticalmoveposition:null,cutVolumn:function(e,l){if(l<=0)return e;let t=e.slice(0,l);t[t.length-1];return e.slice(l)},saveFreezen:function(e,l,t,a){let o=n.luckysheetfile[r(n.currentSheetIndex)];null==o.freezen&&(o.freezen={}),null!=e&&(null==o.freezen.horizontal&&(o.freezen.horizontal={}),o.freezen.horizontal.freezenhorizontaldata=e,o.freezen.horizontal.top=l),null!=t&&(null==o.freezen.vertical&&(o.freezen.vertical={}),o.freezen.vertical.freezenverticaldata=t,o.freezen.vertical.left=a),null!=o.frozen&&n.saveParam("all",n.currentSheetIndex,o.frozen,{k:"frozen"})},initialFreezen:function(e){let l=this;l.frozenTofreezen();let t=n.luckysheetfile[r(e)];null!=t.freezen&&null!=t.freezen.horizontal&&null!=t.freezen.horizontal.freezenhorizontaldata?l.createFreezenHorizontal(t.freezen.horizontal.freezenhorizontaldata,t.freezen.horizontal.top):l.cancelFreezenHorizontal(e),null!=t.freezen&&null!=t.freezen.vertical&&null!=t.freezen.vertical.freezenverticaldata?l.createFreezenVertical(t.freezen.vertical.freezenverticaldata,t.freezen.vertical.left):l.cancelFreezenVertical(e),l.createAssistCanvas()},changeFreezenIndex:function(e,l){if("v"==l&&null!=n.freezenverticaldata){let l=n.freezenverticaldata[1],t=o(n.visibledatacolumn,$("#luckysheet-cell-main").scrollLeft());e-t<l&&(e-=t)}else if("h"==l&&null!=n.freezenhorizontaldata){let l=n.freezenhorizontaldata[1],t=o(n.visibledatarow,$("#luckysheet-cell-main").scrollTop());e-t<l&&(e-=t)}return e},saveFrozen:function(e,l,t={}){null==l&&(l=r(n.currentSheetIndex));const a=n.luckysheet_select_save[n.luckysheet_select_save.length-1],o=null==a.row_focus?a.row[0]:a.row_focus,i=null==a.column_focus?a.column[0]:a.column_focus,c={row_focus:t.row_focus||o,column_focus:t.column_focus||i},u={freezenRow:{type:"row"},freezenColumn:{type:"column"},freezenRC:{type:"both"},freezenRowRange:{type:"rangeRow",range:c},freezenColumnRange:{type:"rangeColumn",range:c},freezenRCRange:{type:"rangeBoth",range:c},freezenCancel:{type:"cancel"}};n.luckysheetfile[l].frozen=u[e]},frozenTofreezen:function(){let e=n.luckysheetfile[r(n.currentSheetIndex)];const l=e.frozen;if(null==l)return;let t=null;if("row"===l.type){let e=0,l=o(n.visibledatarow,e);-1==l&&(l=0);let a=n.visibledatarow[l]-2-e+n.columnHeaderHeight;t={horizontal:{freezenhorizontaldata:[n.visibledatarow[l],l+1,e,i.cutVolumn(n.visibledatarow,l+1),a],top:a}}}else if("column"===l.type){let e=0,l=o(n.visibledatacolumn,e);-1==l&&(l=0);let a=n.visibledatacolumn[l]-2-e+n.rowHeaderWidth;t={vertical:{freezenverticaldata:[n.visibledatacolumn[l],l+1,e,i.cutVolumn(n.visibledatacolumn,l+1),a],left:a}}}else if("both"===l.type){let e=0,l=o(n.visibledatarow,e);-1==l&&(l=0);let a=n.visibledatarow[l]-2-e+n.columnHeaderHeight,r=[n.visibledatarow[l],l+1,e,i.cutVolumn(n.visibledatarow,l+1),a],c=0,u=o(n.visibledatacolumn,c);-1==u&&(u=0);let f=n.visibledatacolumn[u]-2-c+n.rowHeaderWidth;t={horizontal:{freezenhorizontaldata:r,top:a},vertical:{freezenverticaldata:[n.visibledatacolumn[u],u+1,c,i.cutVolumn(n.visibledatacolumn,u+1),f],left:f}}}else if("rangeRow"===l.type){let e=0,a=o(n.visibledatarow,e),r=l.range.row_focus;r>a&&(a=r),-1==a&&(a=0);let c=n.visibledatarow[a]-2-e+n.columnHeaderHeight;t={horizontal:{freezenhorizontaldata:[n.visibledatarow[a],a+1,e,i.cutVolumn(n.visibledatarow,a+1),c],top:c}}}else if("rangeColumn"===l.type){let e=0,a=o(n.visibledatacolumn,e),r=l.range.column_focus;r>a&&(a=r),-1==a&&(a=0);let c=n.visibledatacolumn[a]-2-e+n.rowHeaderWidth;t={vertical:{freezenverticaldata:[n.visibledatacolumn[a],a+1,e,i.cutVolumn(n.visibledatacolumn,a+1),c],left:c}}}else if("rangeBoth"===l.type){let e=0,a=o(n.visibledatarow,e),r=l.range.row_focus;r>a&&(a=r),-1==a&&(a=0);let c=n.visibledatarow[a]-2-e+n.columnHeaderHeight,u=[n.visibledatarow[a],a+1,e,i.cutVolumn(n.visibledatarow,a+1),c],f=0,s=o(n.visibledatacolumn,f),z=l.range.column_focus;z>s&&(s=z),-1==s&&(s=0);let d=n.visibledatacolumn[s]-2-f+n.rowHeaderWidth;t={horizontal:{freezenhorizontaldata:u,top:c},vertical:{freezenverticaldata:[n.visibledatacolumn[s],s+1,f,i.cutVolumn(n.visibledatacolumn,s+1),d],left:d}}}else"cancel"===l.type&&(t={horizontal:null,vertical:null});e.freezen=t}};return i});
//# sourceMappingURL=../sourcemaps/methods/freezen_methods.js.map
