/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./get","../utils/util","../store"],function(l,e,o){"use strict";const{getSheetIndex:t}=l,{getObjType:r}=e;function c(l,e,c,_,n){let s,u,i={};null==n?(s=o.config,u=o.flowdata):(s=o.luckysheetfile[t(n)].config,u=o.luckysheetfile[t(n)].data);let f=s.borderInfo;if(null!=f&&f.length>0)for(let o=0;o<f.length;o++){let t=f[o].rangeType;if("range"==t){let t=f[o].borderType,n=f[o].color,y=f[o].style,m=f[o].range;for(let o=0;o<m.length;o++){let f=m[o].row[0],b=m[o].row[1],d=m[o].column[0],g=m[o].column[1];if(f<l&&(f=l),b>e&&(b=e),d<c&&(d=c),g>_&&(g=_),"border-left"==t)for(let l=f;l<=b;l++){if(null!=s.rowhidden&&null!=s.rowhidden[l])continue;null==i[l+"_"+d]&&(i[l+"_"+d]={}),i[l+"_"+d].l={color:n,style:y};let e=d-1;if(e>=0&&i[l+"_"+e])if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e],t=s.merge[o.mc.r+"_"+o.mc.c];t.c+t.cs-1==e&&(i[l+"_"+e].r={color:n,style:y})}else i[l+"_"+e].r={color:n,style:y}}else if("border-right"==t)for(let l=f;l<=b;l++){if(null!=s.rowhidden&&null!=s.rowhidden[l])continue;null==i[l+"_"+g]&&(i[l+"_"+g]={}),i[l+"_"+g].r={color:n,style:y};let e=g+1;if(e<u[0].length&&i[l+"_"+e])if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e];s.merge[o.mc.r+"_"+o.mc.c].c==e&&(i[l+"_"+e].l={color:n,style:y})}else i[l+"_"+e].l={color:n,style:y}}else if("border-top"==t){if(null!=s.rowhidden&&null!=s.rowhidden[f])continue;for(let l=d;l<=g;l++){null==i[f+"_"+l]&&(i[f+"_"+l]={}),i[f+"_"+l].t={color:n,style:y};let e=f-1;if(e>=0&&i[e+"_"+l])if(null!=u[e]&&"object"==r(u[e][l])&&null!=u[e][l].mc){let o=u[e][l],t=s.merge[o.mc.r+"_"+o.mc.c];t.r+t.rs-1==e&&(i[e+"_"+l].b={color:n,style:y})}else i[e+"_"+l].b={color:n,style:y}}}else if("border-bottom"==t){if(null!=s.rowhidden&&null!=s.rowhidden[b])continue;for(let l=d;l<=g;l++){null==i[b+"_"+l]&&(i[b+"_"+l]={}),i[b+"_"+l].b={color:n,style:y};let e=b+1;if(e<u.length&&i[e+"_"+l])if(null!=u[e]&&"object"==r(u[e][l])&&null!=u[e][l].mc){let o=u[e][l];s.merge[o.mc.r+"_"+o.mc.c].r==e&&(i[e+"_"+l].t={color:n,style:y})}else i[e+"_"+l].t={color:n,style:y}}}else if("border-all"==t){for(let l=f;l<=b;l++)if(null==s.rowhidden||null==s.rowhidden[l])for(let e=d;e<=g;e++){if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e],t=s.merge[o.mc.r+"_"+o.mc.c];t.r==l&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].t={color:n,style:y}),t.r+t.rs-1==l&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].b={color:n,style:y}),t.c==e&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y}),t.c+t.cs-1==e&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].r={color:n,style:y})}else null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y},i[l+"_"+e].r={color:n,style:y},i[l+"_"+e].t={color:n,style:y},i[l+"_"+e].b={color:n,style:y};if(l==f){let l=f-1;if(l>=0&&i[l+"_"+e])if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e],t=s.merge[o.mc.r+"_"+o.mc.c];t.r+t.rs-1==l&&(i[l+"_"+e].b={color:n,style:y})}else i[l+"_"+e].b={color:n,style:y}}if(l==b){let l=b+1;if(l<u.length&&i[l+"_"+e])if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e];s.merge[o.mc.r+"_"+o.mc.c].r==l&&(i[l+"_"+e].t={color:n,style:y})}else i[l+"_"+e].t={color:n,style:y}}if(e==d){let e=d-1;if(e>=0&&i[l+"_"+e])if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e],t=s.merge[o.mc.r+"_"+o.mc.c];t.c+t.cs-1==e&&(i[l+"_"+e].r={color:n,style:y})}else i[l+"_"+e].r={color:n,style:y}}if(e==g){let e=g+1;if(e<u[0].length&&i[l+"_"+e])if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e];s.merge[o.mc.r+"_"+o.mc.c].c==e&&(i[l+"_"+e].l={color:n,style:y})}else i[l+"_"+e].l={color:n,style:y}}}}else if("border-outside"==t){for(let l=f;l<=b;l++)if(null==s.rowhidden||null==s.rowhidden[l])for(let e=d;e<=g;e++)if(l==f||l==b||e==d||e==g){if(l==f){null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].t={color:n,style:y};let o=f-1;if(o>=0&&i[o+"_"+e])if(null!=u[o]&&"object"==r(u[o][e])&&null!=u[o][e].mc){let l=u[o][e],t=s.merge[l.mc.r+"_"+l.mc.c];t.r+t.rs-1==o&&(i[o+"_"+e].b={color:n,style:y})}else i[o+"_"+e].b={color:n,style:y}}if(l==b){null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].b={color:n,style:y};let o=b+1;if(o<u.length&&i[o+"_"+e])if(null!=u[o]&&"object"==r(u[o][e])&&null!=u[o][e].mc){let l=u[o][e];s.merge[l.mc.r+"_"+l.mc.c].r==o&&(i[o+"_"+e].t={color:n,style:y})}else i[o+"_"+e].t={color:n,style:y}}if(e==d){null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y};let o=d-1;if(o>=0&&i[l+"_"+o])if(null!=u[l]&&"object"==r(u[l][o])&&null!=u[l][o].mc){let e=u[l][o],t=s.merge[e.mc.r+"_"+e.mc.c];t.c+t.cs-1==o&&(i[l+"_"+o].r={color:n,style:y})}else i[l+"_"+o].r={color:n,style:y}}if(e==g){null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].r={color:n,style:y};let o=g+1;if(o<u[0].length&&i[l+"_"+o])if(null!=u[l]&&"object"==r(u[l][o])&&null!=u[l][o].mc){let e=u[l][o];s.merge[e.mc.r+"_"+e.mc.c].c==o&&(i[l+"_"+o].l={color:n,style:y})}else i[l+"_"+o].l={color:n,style:y}}}}else if("border-inside"==t){for(let l=f;l<=b;l++)if(null==s.rowhidden||null==s.rowhidden[l])for(let e=d;e<=g;e++)if(l==f&&e==d)null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc||(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].r={color:n,style:y},i[l+"_"+e].b={color:n,style:y});else if(l==b&&e==d)null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc||(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].r={color:n,style:y},i[l+"_"+e].t={color:n,style:y});else if(l==f&&e==g)null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc||(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y},i[l+"_"+e].b={color:n,style:y});else if(l==b&&e==g)null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc||(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y},i[l+"_"+e].t={color:n,style:y});else if(l==f)if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e],t=s.merge[o.mc.r+"_"+o.mc.c];t.c==e?(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y}):t.c+t.cs-1==e&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].r={color:n,style:y})}else null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y},i[l+"_"+e].r={color:n,style:y},i[l+"_"+e].b={color:n,style:y};else if(l==b)if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e],t=s.merge[o.mc.r+"_"+o.mc.c];t.c==e?(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y}):t.c+t.cs-1==e&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].r={color:n,style:y})}else null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y},i[l+"_"+e].r={color:n,style:y},i[l+"_"+e].t={color:n,style:y};else if(e==d)if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e],t=s.merge[o.mc.r+"_"+o.mc.c];t.r==l?(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].t={color:n,style:y}):t.r+t.rs-1==l&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].b={color:n,style:y})}else null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].r={color:n,style:y},i[l+"_"+e].t={color:n,style:y},i[l+"_"+e].b={color:n,style:y};else if(e==g)if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e],t=s.merge[o.mc.r+"_"+o.mc.c];t.r==l?(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].t={color:n,style:y}):t.r+t.rs-1==l&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].b={color:n,style:y})}else null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y},i[l+"_"+e].t={color:n,style:y},i[l+"_"+e].b={color:n,style:y};else if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e],t=s.merge[o.mc.r+"_"+o.mc.c];t.r==l?(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].t={color:n,style:y}):t.r+t.rs-1==l&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].b={color:n,style:y}),t.c==e?(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y}):t.c+t.cs-1==e&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].r={color:n,style:y})}else null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y},i[l+"_"+e].r={color:n,style:y},i[l+"_"+e].t={color:n,style:y},i[l+"_"+e].b={color:n,style:y}}else if("border-horizontal"==t){for(let l=f;l<=b;l++)if(null==s.rowhidden||null==s.rowhidden[l])for(let e=d;e<=g;e++)if(l==f)null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc||(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].b={color:n,style:y});else if(l==b)null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc||(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].t={color:n,style:y});else if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e],t=s.merge[o.mc.r+"_"+o.mc.c];t.r==l?(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].t={color:n,style:y}):t.r+t.rs-1==l&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].b={color:n,style:y})}else null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].t={color:n,style:y},i[l+"_"+e].b={color:n,style:y}}else if("border-vertical"==t){for(let l=f;l<=b;l++)if(null==s.rowhidden||null==s.rowhidden[l])for(let e=d;e<=g;e++)if(e==d)null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc||(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].r={color:n,style:y});else if(e==g)null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc||(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y});else if(null!=u[l]&&"object"==r(u[l][e])&&null!=u[l][e].mc){let o=u[l][e],t=s.merge[o.mc.r+"_"+o.mc.c]||{};t.c==e?(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y}):t.c+t.cs-1==e&&(null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].r={color:n,style:y})}else null==i[l+"_"+e]&&(i[l+"_"+e]={}),i[l+"_"+e].l={color:n,style:y},i[l+"_"+e].r={color:n,style:y}}else if("border-none"==t)for(let l=f;l<=b;l++)if(null==s.rowhidden||null==s.rowhidden[l])for(let e=d;e<=g;e++){if(null!=i[l+"_"+e]&&delete i[l+"_"+e],l==f){let l=f-1;l>=0&&i[l+"_"+e]&&delete i[l+"_"+e].b}if(l==b){let l=b+1;l<u.length&&i[l+"_"+e]&&delete i[l+"_"+e].t}if(e==d){let e=d-1;e>=0&&i[l+"_"+e]&&delete i[l+"_"+e].r}if(e==g){let e=g+1;e<u[0].length&&i[l+"_"+e]&&delete i[l+"_"+e].l}}}}else if("cell"==t){let t=f[o].value,n=t.row_index,y=t.col_index;if(n<l||n>e||y<c||y>_)continue;if(null!=s.rowhidden&&null!=s.rowhidden[n])continue;if(null!=t.l||null!=t.r||null!=t.t||null!=t.b)if(null==i[n+"_"+y]&&(i[n+"_"+y]={}),null!=u[n]&&"object"==r(u[n][y])&&null!=u[n][y].mc){let l=u[n][y],e=s.merge[l.mc.r+"_"+l.mc.c]||{};if(null!=t.l&&y==e.c){i[n+"_"+y].l={color:t.l.color,style:t.l.style};let l=y-1;if(l>=0&&i[n+"_"+l])if(null!=u[n]&&"object"==r(u[n][l])&&null!=u[n][l].mc){let e=u[n][l],o=s.merge[e.mc.r+"_"+e.mc.c];o.c+o.cs-1==l&&(i[n+"_"+l].r={color:t.l.color,style:t.l.style})}else i[n+"_"+l].r={color:t.l.color,style:t.l.style}}else i[n+"_"+y].l=null;if(null!=t.r&&y==e.c+e.cs-1){i[n+"_"+y].r={color:t.r.color,style:t.r.style};let l=y+1;if(l<u[0].length&&i[n+"_"+l])if(null!=u[n]&&"object"==r(u[n][l])&&null!=u[n][l].mc){let e=u[n][l];s.merge[e.mc.r+"_"+e.mc.c].c==l&&(i[n+"_"+l].l={color:t.r.color,style:t.r.style})}else i[n+"_"+l].l={color:t.r.color,style:t.r.style}}else i[n+"_"+y].r=null;if(null!=t.t&&n==e.r){i[n+"_"+y].t={color:t.t.color,style:t.t.style};let l=n-1;if(l>=0&&i[l+"_"+y])if(null!=u[l]&&"object"==r(u[l][y])&&null!=u[l][y].mc){let e=u[l][y],o=s.merge[e.mc.r+"_"+e.mc.c];o.r+o.rs-1==l&&(i[l+"_"+y].b={color:t.t.color,style:t.t.style})}else i[l+"_"+y].b={color:t.t.color,style:t.t.style}}else i[n+"_"+y].t=null;if(null!=t.b&&n==e.r+e.rs-1){i[n+"_"+y].b={color:t.b.color,style:t.b.style};let l=n+1;if(l<u.length&&i[l+"_"+y])if(null!=u[l]&&"object"==r(u[l][y])&&null!=u[l][y].mc){let e=u[l][y];s.merge[e.mc.r+"_"+e.mc.c].r==l&&(i[l+"_"+y].t={color:t.b.color,style:t.b.style})}else i[l+"_"+y].t={color:t.b.color,style:t.b.style}}else i[n+"_"+y].b=null}else{if(null!=t.l){i[n+"_"+y].l={color:t.l.color,style:t.l.style};let l=y-1;if(l>=0&&i[n+"_"+l])if(null!=u[n]&&"object"==r(u[n][l])&&null!=u[n][l].mc){let e=u[n][l],o=s.merge[e.mc.r+"_"+e.mc.c];o.c+o.cs-1==l&&(i[n+"_"+l].r={color:t.l.color,style:t.l.style})}else i[n+"_"+l].r={color:t.l.color,style:t.l.style}}else i[n+"_"+y].l=null;if(null!=t.r){i[n+"_"+y].r={color:t.r.color,style:t.r.style};let l=y+1;if(l<u[0].length&&i[n+"_"+l])if(null!=u[n]&&"object"==r(u[n][l])&&null!=u[n][l].mc){let e=u[n][l];s.merge[e.mc.r+"_"+e.mc.c].c==l&&(i[n+"_"+l].l={color:t.r.color,style:t.r.style})}else i[n+"_"+l].l={color:t.r.color,style:t.r.style}}else i[n+"_"+y].r=null;if(null!=t.t){i[n+"_"+y].t={color:t.t.color,style:t.t.style};let l=n-1;if(l>=0&&i[l+"_"+y])if(null!=u[l]&&"object"==r(u[l][y])&&null!=u[l][y].mc){let e=u[l][y],o=s.merge[e.mc.r+"_"+e.mc.c];o.r+o.rs-1==l&&(i[l+"_"+y].b={color:t.t.color,style:t.t.style})}else i[l+"_"+y].b={color:t.t.color,style:t.t.style}}else i[n+"_"+y].t=null;if(null!=t.b){i[n+"_"+y].b={color:t.b.color,style:t.b.style};let l=n+1;if(l<u.length&&i[l+"_"+y])if(null!=u[l]&&"object"==r(u[l][y])&&null!=u[l][y].mc){let e=u[l][y];s.merge[e.mc.r+"_"+e.mc.c].r==l&&(i[l+"_"+y].t={color:t.b.color,style:t.b.style})}else i[l+"_"+y].t={color:t.b.color,style:t.b.style}}else i[n+"_"+y].b=null}else delete i[n+"_"+y]}}return i}return{getBorderInfoCompute:function(l){let e,r,_={};return null==l?(e=o.config,r=o.flowdata):(e=o.luckysheetfile[t(l)].config,r=o.luckysheetfile[t(l)].data),_=c(0,r.length,0,r[0].length,l)},getBorderInfoComputeRange:c}});
//# sourceMappingURL=../sourcemaps/methods/border.js.map
