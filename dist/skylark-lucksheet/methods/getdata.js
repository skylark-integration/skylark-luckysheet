/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../utils/util","./get","./dynamicArray","../locale/locale","../store"],function(l,e,t,n,u){"use strict";const{getObjType:r,rgbTohex:o,textTrim:i,convertCssToStyleList:c,getFontStyleByCell:f}=l,{getSheetIndex:a}=e,{dynamicArrayCompute:s}=t;function g(l,e,t,n){let o;if(null==n&&(n="v"),null==t&&(t=u.flowdata),null!=l&&null!=e)o=t[l][e];else if(null!=l)o=t[l];else{if(null==e)return t;o=t[0].map(function(l,e){return t.map(function(l){return l[e]})})[e]}let i=o;return"object"==r(o)&&(i=o[n],"f"==n&&null!=i||("f"==n?i=o.v:o&&o.ct&&"d"==o.ct.t&&(i=o.m))),void 0==i&&(i=null),i}function h(l,e,t){if(null==l||null==e)return;let n;if(null==t)n=u.flowdata;else{n=u.getSheetByIndex(t).data}return n&&n[l]&&n[l][e]?n[l][e]:void 0}function d(l){return null!=l&&"inlineStr"==l.t&&null!=l.s&&l.s.length>0}return{getGridData:function(l){let e=[];for(let t=0;t<l.length;t++)for(let n=0;n<l[0].length;n++)null!=l[t][n]&&e.push({r:t,c:n,v:l[t][n]});return e},getdatabyselection:function(l,e){if(null==l&&(l=u.luckysheet_select_save[0]),null==l.row||0==l.row.length)return[];let t,n;null!=e&&e!=u.currentSheetIndex?(t=u.luckysheetfile[a(e)].data,n=u.luckysheetfile[a(e)].config):(t=u.deepCopyFlowData(u.flowdata),n=u.config);let r=[];for(let e=l.row[0];e<=l.row[1];e++){if(null==t[e])continue;if(null!=n.rowhidden&&null!=n.rowhidden[e])continue;let u=[];for(let n=l.column[0];n<=l.column[1];n++)u.push(t[e][n]);r.push(u)}return r},getdatabyselectionD:function(l,e){if(null==e||null==e.row||0==e.row.length)return[];let t=s(u.luckysheetfile[a(u.currentSheetIndex)].dynamicArray),n=[];if(null==l)return n;for(let u=e.row[0];u<=e.row[1];u++){if(null==l[u])continue;let r=[];for(let n=e.column[0];n<=e.column[1];n++){let e;e=u+"_"+n in t?t[u+"_"+n]:l[u][n],r.push(e)}n.push(r)}return n},getdatabyselectionNoCopy:function(l){if(null==l||null==l.row||0==l.row.length)return[];let e=[];for(let t=l.row[0];t<=l.row[1];t++){let n=[];if(null==u.config.rowhidden||null==u.config.rowhidden[t]){for(let e=l.column[0];e<=l.column[1];e++){let l="";null!=u.flowdata[t]&&null!=u.flowdata[t][e]&&(l=u.flowdata[t][e]),n.push(l)}e.push(n)}}return e},getcellvalue:g,datagridgrowth:function(l,e,t,n){if(e<=0&&t<=0)return l;e<=0&&(e=0),t<=0&&(t=0);let r=0;0==l.length?(l=[],r=0):r=l[0].length;let o=[];for(let l=0;l<t;l++)o.push(null);let i=[];for(let l=0;l<r+t;l++)i.push(null);for(let e=0;e<l.length;e++)l[e]=[].concat(l[e].concat(o));for(let t=0;t<e;t++)l.push([].concat(i));return n&&(u.saveParam("all",u.currentSheetIndex,l.length,{k:"row"}),u.saveParam("all",u.currentSheetIndex,l[0].length,{k:"column"})),l},getcellFormula:function(l,e,t,n){let u;return null==(u=null!=n?n[l][e]:h(l,e,t))?null:u.f},getOrigincell:h,getRealCellValue:function(l,e){let t=g(l,e,null,"m");if(null==t&&null==(t=g(l,e))){let n=g(l,e,null,"ct");d(n)&&(t=n.s)}return t},getInlineStringNoStyle:function(l,e){let t=g(l,e,null,"ct");if(d(t)){let l=t.s,e="";for(let t=0;t<l.length;t++){let n=l[t];null!=n.v&&(e+=n.v)}return e}return""},getInlineStringStyle:function(l,e,t){let n=g(l,e,t,"ct");if(null==t&&(t=u.flowdata),t[l][e],d(n)){let l=n.s,e="";for(let t=0;t<l.length;t++){let n=l[t];null!=n.v&&(e+="<span index='"+t+"' style='"+f(n)+"'>"+n.v+"</span>")}return e}return""},getFontStyleByCell:f,textTrim:i,isInlineStringCT:d}});
//# sourceMappingURL=../sourcemaps/methods/getdata.js.map
