/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../utils/util","./formula_methods","./validate","./datecontroll","./setdata","./getdata","../methods/cells","../methods/get","../locale/locale","../store"],function(e,t,n,l,r,a,i,u,o,p){"use strict";const{replaceHtml:b}=e,{isRealNum:y,isRealNull:d}=n,{isdatetime:f,diff:c}=l,{setcellvalue:s}=r,{getcellvalue:h}=a,{getSheetIndex:m,getRangetxt:g}=u;return{defaultItem:{type:"dropdown",type2:null,value1:"",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},curItem:null,selectRange:[],selectStatus:!1,optionLabel:{number:"数值",number_integer:"整数",number_decimal:"小数",bw:"介于",nb:"不介于",eq:"等于",ne:"不等于",gt:"大于",lt:"小于",gte:"大于等于",lte:"小于等于",include:"包括",exclude:"不包括",equal:"等于",bf:"早于",nbf:"不早于",af:"晚于",naf:"不晚于",card:"身份证号码",phone:"手机号"},optionLabel_en:{number:"numeric",number_integer:"integer",number_decimal:"decimal",bw:"between",nb:"not between",eq:"equal to",ne:"not equal to",gt:"greater",lt:"less than",gte:"greater or equal to",lte:"less than or equal to",include:"include",exclude:"not include",equal:"equal to",bf:"earlier than",nbf:"not earlier than",af:"later than",naf:"not later than",card:"identification number",phone:"phone number"},getHintText:function(e){let t=this,n=e.hintText||"";return 0==n.length&&("en"==p.lang?"dropdown"==e.type?n+="please select an option in the drop-down list":"checkbox"==e.type||("number"==e.type||"number_integer"==e.type||"number_decimal"==e.type?(n+="please enter a "+t.optionLabel_en[e.type]+" "+t.optionLabel_en[e.type2]+" "+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+=" and "+e.value2)):"text_content"==e.type?n+="please enter text "+t.optionLabel_en[e.type2]+" "+e.value1:"text_length"==e.type?(n+="please enter text with length "+t.optionLabel_en[e.type2]+" "+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+=" and "+e.value2)):"date"==e.type?(n+="please enter a date "+t.optionLabel_en[e.type2]+" "+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+=" and "+e.value2)):"validity"==e.type&&(n+="please enter the correct "+t.optionLabel_en[e.type2])):"dropdown"==e.type?n+="请选择下拉列表中的选项":"checkbox"==e.type||("number"==e.type||"number_integer"==e.type||"number_decimal"==e.type?(n+="请输入"+t.optionLabel[e.type2]+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+="和"+e.value2+"之间"),n+="的"+t.optionLabel[e.type]):"text_content"==e.type?n+="请输入内容"+t.optionLabel[e.type2]+e.value1+"的文本":"text_length"==e.type?(n+="请输入长度"+t.optionLabel[e.type2]+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+="和"+e.value2+"之间"),n+="的文本"):"date"==e.type?(n+="请输入"+t.optionLabel[e.type2]+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+="和"+e.value2+"之间"),n+="的日期"):"validity"==e.type&&(n+="请输入正确的"+t.optionLabel[e.type2]))),n},getFailureText:function(e){let t=this,n="";return"en"==p.lang?"dropdown"==e.type?n+="what you selected is not an option in the drop-down list":"checkbox"==e.type||("number"==e.type||"number_integer"==e.type||"number_decimal"==e.type?(n+="what you entered is not a "+t.optionLabel_en[e.type]+" "+t.optionLabel_en[e.type2]+" "+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+=" and "+e.value2)):"text_content"==e.type?n+="what you entered is not text that "+t.optionLabel_en[e.type2]+" "+e.value1:"text_length"==e.type?(n+="the text you entered is not length "+t.optionLabel_en[e.type2]+" "+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+=" and "+e.value2)):"date"==e.type?(n+="the date you entered is not "+t.optionLabel_en[e.type2]+" "+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+=" and "+e.value2)):"validity"==e.type&&(n+="what you entered is not a correct "+t.optionLabel_en[e.type2])):"dropdown"==e.type?n+="你选择的不是下拉列表中的选项":"checkbox"==e.type||("number"==e.type||"number_integer"==e.type||"number_decimal"==e.type?(n+="你输入的不是"+t.optionLabel[e.type2]+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+="和"+e.value2+"之间"),n+="的"+t.optionLabel[e.type]):"text_content"==e.type?n+="你输入的不是内容"+t.optionLabel[e.type2]+e.value1+"的文本":"text_length"==e.type?(n+="你输入的不是长度"+t.optionLabel[e.type2]+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+="和"+e.value2+"之间"),n+="的文本"):"date"==e.type?(n+="你输入的不是"+t.optionLabel[e.type2]+e.value1,"bw"!=e.type2&&"nb"!=e.type2||(n+="和"+e.value2+"之间"),n+="的日期"):"validity"==e.type&&(n+="你输入的不是一个正确的"+t.optionLabel[e.type2])),n},validateCellData:function(e,t){let n=this,l=t.type,r=t.type2,a=t.value1,i=t.value2;if("dropdown"==l){let t=n.getDropdownList(a),l=!1;for(let n=0;n<t.length;n++)if(t[n]==e){l=!0;break}return l}if("checkbox"==l);else if("number"==l||"number_integer"==l||"number_decimal"==l){if(!y(e))return!1;if(e=Number(e),"number_integer"==l&&e%1!=0)return!1;if("number_decimal"==l&&e%1==0)return!1;if(a=Number(a),i=Number(i),"bw"==r&&(e<a||e>i))return!1;if("nb"==r&&e>=a&&e<=i)return!1;if("eq"==r&&e!=a)return!1;if("ne"==r&&e==a)return!1;if("gt"==r&&e<=a)return!1;if("lt"==r&&e>=a)return!1;if("gte"==r&&e<a)return!1;if("lte"==r&&e>a)return!1}else if("text_content"==l){if(e=e.toString(),a=a.toString(),"include"==r&&-1==e.indexOf(a))return!1;if("exclude"==r&&e.indexOf(a)>-1)return!1;if("equal"==r&&e!=a)return!1}else if("text_length"==l){if(e=e.toString().length,a=Number(a),i=Number(i),"bw"==r&&(e<a||e>i))return!1;if("nb"==r&&e>=a&&e<=i)return!1;if("eq"==r&&e!=a)return!1;if("ne"==r&&e==a)return!1;if("gt"==r&&e<=a)return!1;if("lt"==r&&e>=a)return!1;if("gte"==r&&e<a)return!1;if("lte"==r&&e>a)return!1}else if("date"==l){if(!f(e))return!1;if("bw"==r&&(c(e,a)<0||c(e,i)>0))return!1;if("nb"==r&&c(e,a)>=0&&c(e,i)<=0)return!1;if("eq"==r&&0!=c(e,a))return!1;if("ne"==r&&0==c(e,a))return!1;if("bf"==r&&c(e,a)>=0)return!1;if("nbf"==r&&c(e,a)<0)return!1;if("af"==r&&c(e,a)<=0)return!1;if("naf"==r&&c(e,a)>0)return!1}else if("validity"==l){if("card"==r&&!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(e))return!1;if("phone"==r&&!/^[1][3,4,5,7,8][0-9]{9}$/.test(e))return!1}return!0},getDropdownList:function(e){let n=[];if(t.iscelldata(e)){let l=t.getcellrange(e),r=p.luckysheetfile[m(l.sheetIndex)].data;for(let e=l.row[0];e<=l.row[1];e++)for(let t=l.column[0];t<=l.column[1];t++){if(null==r[e])continue;let l=r[e][t];if(null==l||null==l.v)continue;let a=l.m||l.v;n.includes(a)||n.push(a)}}else{let t=e.split(",");for(let e=0;e<t.length;e++){let l=t[e];0!=l.length&&(n.includes(l)||n.push(l))}}return n}}});
//# sourceMappingURL=../sourcemaps/methods/dataVerificationCtrl_methods.js.map
