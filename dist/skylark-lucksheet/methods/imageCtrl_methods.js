/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../methods/get","../utils/util","../store","../locale/locale"],function(t,e,o,l){"use strict";const{getSheetIndex:f}=t,{replaceHtml:i}=e;return{imgItem:{type:"3",src:"",originWidth:null,originHeight:null,default:{width:null,height:null,left:null,top:null},crop:{width:null,height:null,offsetLeft:0,offsetTop:0},isFixedPos:!1,fixedLeft:null,fixedTop:null,border:{width:0,radius:0,style:"solid",color:"#000"}},images:null,currentImgId:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,cropChange:null,cropChangeXY:null,cropChangeObj:null,copyImgItemObj:null,inserImg:function(t){let e=this,l=o.luckysheet_select_save[o.luckysheet_select_save.length-1],f=l.row_focus||0,i=l.column_focus||0,h=0==i?0:o.visibledatacolumn[i-1],r=0==f?0:o.visibledatarow[f-1],d=new Image;d.onload=function(){let o=d.width,l=d.height,f={src:t,left:h,top:r,originWidth:o,originHeight:l};e.addImgItem(f)},d.src=t},generateRandomId:function(t){null==t&&(t="img");let e=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),o="";for(let t=0;t<12;t++)o+=e[Math.round(Math.random()*(e.length-1))];return t+"_"+o+"_"+(new Date).getTime()},getImgItemParam(t){let e=t.isFixedPos,o=t.default.width,l=t.default.height,f=t.default.left,i=t.default.top;t.crop.width==o&&t.crop.height==l||(o=t.crop.width,l=t.crop.height,f+=t.crop.offsetLeft,i+=t.crop.offsetTop);let h="absolute";return e&&(h="fixed",f=t.fixedLeft+t.crop.offsetLeft,i=t.fixedTop+t.crop.offsetTop),{width:o,height:l,left:f,top:i,position:h}},moveChangeSize:function(t,e,l){let f=this,i=$.extend(!0,{},f.images);if("row"==t){let t=o.visibledatarow[e],h=l-(t-(e-1==-1?0:o.visibledatarow[e-1])-1);for(let e in i){let o=i[e],l=f.getImgItemParam(o),r=o.type;if("1"==r){if(l.top>=t)o.default.top=l.top+h-o.crop.offsetTop;else if(l.top+l.height>=t-2)if(l.top<t+h){let t=(l.height+h)/l.height;o.default.height=Math.round(o.default.height*t),o.crop.height=Math.round(o.crop.height*t),o.crop.offsetTop=Math.round(o.crop.offsetTop*t)}else{let e=(l.top+l.height-t)/l.height;o.default.height=Math.round(o.default.height*e),o.crop.height=Math.round(o.crop.height*e),o.crop.offsetTop=Math.round(o.crop.offsetTop*e),o.default.top=t+h-o.crop.offsetTop}else if(l.top>t+h){let e=1/l.height;o.default.height=Math.round(o.default.height*e),o.crop.height=Math.round(o.crop.height*e),o.crop.offsetTop=Math.round(o.crop.offsetTop*e),o.default.top=t+h-o.crop.offsetTop}else if(l.top+l.height>t+h){let e=(t+h-l.top)/l.height;o.default.height=Math.round(o.default.height*e),o.crop.height=Math.round(o.crop.height*e),o.crop.offsetTop=Math.round(o.crop.offsetTop*e)}}else"2"==r&&(l.top>=t?o.default.top=l.top+h-o.crop.offsetTop:l.top>t+h&&(o.default.top=t+h-o.crop.offsetTop))}}else if("column"==t){let t=o.visibledatacolumn[e],h=l-(t-(e-1==-1?0:o.visibledatacolumn[e-1])-1);for(let e in i){let o=i[e],l=f.getImgItemParam(o),r=o.type;if("1"==r){if(l.left>=t)o.default.left=l.left+h-o.crop.offsetLeft;else if(l.left+l.width>=t-2)if(l.left<t+h){let t=(l.width+h)/l.width;o.default.width=Math.round(o.default.width*t),o.crop.width=Math.round(o.crop.width*t),o.crop.offsetLeft=Math.round(o.crop.offsetLeft*t)}else{let e=(l.left+l.width-t)/l.width;o.default.width=Math.round(o.default.width*e),o.crop.width=Math.round(o.crop.width*e),o.crop.offsetLeft=Math.round(o.crop.offsetLeft*e),o.default.left=t+h-o.crop.offsetLeft}else if(l.left>t+h){let e=1/l.width;o.default.width=Math.round(o.default.width*e),o.crop.width=Math.round(o.crop.width*e),o.crop.offsetLeft=Math.round(o.crop.offsetLeft*e),o.default.left=t+h-o.crop.offsetLeft}else if(l.left+l.width>t+h){let e=(t+h-l.left)/l.width;o.default.width=Math.round(o.default.width*e),o.crop.width=Math.round(o.crop.width*e),o.crop.offsetLeft=Math.round(o.crop.offsetLeft*e)}}else"2"==r&&(l.left>=t?o.default.left=l.left+h-o.crop.offsetLeft:l.left>t+h&&(o.default.left=t+h-o.crop.offsetLeft))}}return i},ref:function(){let t=o.luckysheetfile[f(o.currentSheetIndex)],e=this.images;o.clearjfundo&&(o.jfundo.length=0,o.jfredo.push({type:"imageCtrl",sheetIndex:o.currentSheetIndex,images:null==t.images?null:$.extend(!0,{},t.images),curImages:e})),t.images=$.extend(!0,{},e),o.saveParam("all",o.currentSheetIndex,t.images,{k:"images"})}}});
//# sourceMappingURL=../sourcemaps/methods/imageCtrl_methods.js.map
