/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../methods/get","../utils/util","../global/formula","../global/validate","../global/tooltip","../global/refresh","./constant","./resize","./server","./select","../store","../locale/locale"],function(e,t,o,c,l,a,n,r,f,d,s,i){"use strict";const{getSheetIndex:u,getRangetxt:h}=e,{replaceHtml:m}=t,{isEditMode:b}=c,{luckysheetrefreshgrid:g}=a,{luckysheetAlternateformatHtml:k,modelHTML:y}=n,{selectHightlightShow:w}=d;return{rangefocus:!1,modelfocusIndex:null,FixedModelColor:[{head:{fc:"#000",bc:"#bfbdbe"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f3f7"},foot:{fc:"#000",bc:"#dde2de"}},{head:{fc:"#000",bc:"#4bd4e7"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eaf7ff"},foot:{fc:"#000",bc:"#aae9f8"}},{head:{fc:"#000",bc:"#5ed593"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#e5fbee"},foot:{fc:"#000",bc:"#a5efcc"}},{head:{fc:"#000",bc:"#f6cb4b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fff9e7"},foot:{fc:"#000",bc:"#ffebac"}},{head:{fc:"#000",bc:"#f96420"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ffe5d9"},foot:{fc:"#000",bc:"#ffcfba"}},{head:{fc:"#000",bc:"#5599fc"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ecf2fe"},foot:{fc:"#000",bc:"#afcbfa"}},{head:{fc:"#000",bc:"#22a69b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#dff2f8"},foot:{fc:"#000",bc:"#8dd4d0"}},{head:{fc:"#000",bc:"#7a939a"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0eff7"},foot:{fc:"#000",bc:"#bdcad0"}},{head:{fc:"#000",bc:"#d7a270"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fdf3f1"},foot:{fc:"#000",bc:"#ead2b6"}},{head:{fc:"#000",bc:"#89c54b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f1f7e9"},foot:{fc:"#000",bc:"#c5e3a7"}},{head:{fc:"#000",bc:"#8f88f0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0e5ff"},foot:{fc:"#000",bc:"#c6c4f6"}},{head:{fc:"#000",bc:"#fd1664"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#feddee"},foot:{fc:"#000",bc:"#f98ab5"}},{head:{fc:"#000",bc:"#da96d3"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fce8fb"},foot:{fc:"#000",bc:"#f2caee"}},{head:{fc:"#000",bc:"#b49191"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f5ebe8"},foot:{fc:"#000",bc:"#d8c3c3"}},{head:{fc:"#000",bc:"#91b493"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0fbf0"},foot:{fc:"#000",bc:"#b4cfb6"}},{head:{fc:"#000",bc:"#b4a891"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f6f1"},foot:{fc:"#000",bc:"#d3cab8"}},{head:{fc:"#000",bc:"#91abb4"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eff7fa"},foot:{fc:"#000",bc:"#b7cbd3"}},{head:{fc:"#000",bc:"#b7ba82"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fafbeb"},foot:{fc:"#000",bc:"#dadcb4"}},{head:{fc:"#000",bc:"#df3e3e"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fde9e9"},foot:{fc:"#000",bc:"#f89292"}},{head:{fc:"#000",bc:"#f2711c"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fef0d7"},foot:{fc:"#000",bc:"#fbb335"}},{head:{fc:"#000",bc:"#b5cc18"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f9fbd4"},foot:{fc:"#000",bc:"#e2ed2a"}},{head:{fc:"#000",bc:"#00b5ad"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ccfaf9"},foot:{fc:"#000",bc:"#00e4df"}},{head:{fc:"#000",bc:"#2185d0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#d8f3fc"},foot:{fc:"#000",bc:"#3cc4f0"}},{head:{fc:"#000",bc:"#a5673f"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f6ede5"},foot:{fc:"#000",bc:"#d3a47c"}}],getModelBox:function(e,t){let o=this;$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").empty(),$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").empty();let c="";for(let l=0;l<o.FixedModelColor.length;l++){let a,n,r,f,d=o.FixedModelColor[l];e&&t?(a=d.head,n=d.one,r=d.two,f=d.foot):e?(a=d.head,n=d.one,r=d.two,f=d.one):t?(a=d.one,n=d.two,r=d.one,f=d.foot):(a=d.one,n=d.two,r=d.one,f=d.two),c+='<div class="modelbox"><div class="box"><span style="color:'+a.fc+";background-color:"+a.bc+'"> — </span><span style="color:'+n.fc+";background-color:"+n.bc+'"> — </span><span style="color:'+r.fc+";background-color:"+r.bc+'"> — </span><span style="color:'+f.fc+";background-color:"+f.bc+'"> — </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").append(c);let l=s.luckysheetfile[u(s.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(null!=l&&l.length>0){let o="";for(let c=0;c<l.length;c++){let a,n,r,f,d=l[c];e&&t?(a=d.head,n=d.one,r=d.two,f=d.foot):e?(a=d.head,n=d.one,r=d.two,f=d.one):t?(a=d.one,n=d.two,r=d.one,f=d.foot):(a=d.one,n=d.two,r=d.one,f=d.two),o+='<div class="modelbox"><div class="box"><span style="color:'+a.fc+";background-color:"+a.bc+'"> — </span><span style="color:'+n.fc+";background-color:"+n.bc+'"> — </span><span style="color:'+r.fc+";background-color:"+r.bc+'"> — </span><span style="color:'+f.fc+";background-color:"+f.bc+'"> — </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").append(o)}},init:function(){let e=this;$("#luckysheet-modal-dialog-slider-alternateformat").remove(),$("body").append(k()),r(),$("#luckysheet-modal-dialog-slider-alternateformat .luckysheet-model-close-btn").click(function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),r()}),$(document).off("focus.AFrangeInput").on("focus.AFrangeInput","#luckysheet-alternateformat-range input",function(){e.rangefocus=!0}),$(document).off("blur.AFrangeInput").on("blur.AFrangeInput","#luckysheet-alternateformat-range input",function(){e.rangefocus=!1}),$(document).off("keydown.AFrangeInput").on("keydown.AFrangeInput","#luckysheet-alternateformat-range input",function(t){$(this).val().trim();13==t.keyCode&&e.update()}),$(document).off("click.AFrangeIcon").on("click.AFrangeIcon","#luckysheet-alternateformat-range .fa-table",function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),r();let t=$(this).parents("#luckysheet-alternateformat-range").find("input").val().trim();e.rangeDialog(t)}),$(document).off("click.AFrDCf").on("click.AFrDCf","#luckysheet-alternateformat-rangeDialog-confirm",function(){let t=$(this).parents("#luckysheet-alternateformat-rangeDialog").find("input").val().trim();$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val(t),$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),r(),e.update()}),$(document).off("click.AFrDCl").on("click.AFrDCl","#luckysheet-alternateformat-rangeDialog-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),r()}),$(document).off("click.AFrDTitle").on("click.AFrDTitle","#luckysheet-alternateformat-rangeDialog .luckysheet-modal-dialog-title-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),r()}),$(document).off("change.AFrowHeader").on("change.AFrowHeader","#luckysheet-alternateformat-rowHeader",function(){let t,o;t=!!$(this).is(":checked"),o=!!$("#luckysheet-alternateformat-rowFooter").is(":checked"),e.checkboxChange(t,o),e.modelboxOn(),e.update()}),$(document).off("change.AFrowFooter").on("change.AFrowFooter","#luckysheet-alternateformat-rowFooter",function(){let t,o;t=!!$("#luckysheet-alternateformat-rowHeader").is(":checked"),o=!!$(this).is(":checked"),e.checkboxChange(t,o),e.modelboxOn(),e.update()}),$(document).off("click.AFmodelbox").on("click.AFmodelbox","#luckysheet-modal-dialog-slider-alternateformat .modelbox",function(){let t=$(this).index(),o=$(this).parents(".cf").attr("id");if("luckysheet-alternateformat-modelList"==o)e.modelfocusIndex=t;else if("luckysheet-alternateformat-modelCustom"==o){let o=e.FixedModelColor.length;e.modelfocusIndex=t+o}e.modelboxOn(),e.update()}),$(document).off("click.AFselectColor").on("click.AFselectColor","#luckysheet-modal-dialog-slider-alternateformat .luckysheet-color-menu-button-indicator",function(){let t,o,c,l=$(this).closest(".toningbox");$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-text-color")?(t="fc",o=l.find(".toningShow").data("fc")):$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-cell-color")&&(t="bc",o=l.find(".toningShow").data("bc")),l.hasClass("header")?c="0":l.hasClass("ctOne")?c="1":l.hasClass("ctTwo")?c="2":l.hasClass("footer")&&(c="3"),e.colorSelectDialog(o,t,c)}),$(document).off("click.AFselectColorConfirm").on("click.AFselectColorConfirm","#luckysheet-alternateformat-colorSelect-dialog-confirm",function(){let t=$(this).parents("#luckysheet-alternateformat-colorSelect-dialog");const o=i().alternatingColors;$("#luckysheet-modal-dialog-mask").hide(),t.hide();let c,l=t.find(".currenColor span").attr("title");t.find(".luckysheet-modal-dialog-title-text").text()==o.selectionTextColor?c="fc":t.find(".luckysheet-modal-dialog-title-text").text()==o.selectionCellColor&&(c="bc");let a,n,r=t.find(".currenColor").attr("data-source");"0"==r?("fc"==c&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("color",l),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",l),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l)),"bc"==c&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("background-color",l),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("bc",l),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l))):"1"==r?("fc"==c&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("color",l),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",l),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l)),"bc"==c&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("background-color",l),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("bc",l),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l))):"2"==r?("fc"==c&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("color",l),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",l),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l)),"bc"==c&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("background-color",l),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("bc",l),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l))):"3"==r&&("fc"==c&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("color",l),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",l),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l)),"bc"==c&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("background-color",l),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("bc",l),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l))),a=!!$("#luckysheet-alternateformat-rowHeader").is(":checked"),n=!!$("#luckysheet-alternateformat-rowFooter").is(":checked");let d,h,m=e.modelfocusIndex,b=e.FixedModelColor.length;if(m<b)d=$.extend(!0,{},e.getFormatByIndex());else{let e=(h=s.luckysheetfile[u(s.currentSheetIndex)]).luckysheet_alternateformat_save_modelCustom;d=$.extend(!0,{},e[m-b])}"0"==r?"fc"==c?d.head.fc=l:"bc"==c&&(d.head.bc=l):"1"==r?"fc"==c?d.one.fc=l:"bc"==c&&(d.one.bc=l):"2"==r?"fc"==c?d.two.fc=l:"bc"==c&&(d.two.bc=l):"3"==r&&("fc"==c&&(d.foot.fc=l),"bc"==c&&(d.foot.bc=l)),e.modelfocusIndex<b?(e.addCustomModel(d),e.modelfocusIndex=e.getIndexByFormat(d)):(h.luckysheet_alternateformat_save_modelCustom[m-b]=d,f.allowUpdate&&f.saveParam("all",s.currentSheetIndex,h.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})),e.getModelBox(a,n),e.modelboxOn(),e.update()}),$(document).off("click.AFremove").on("click.AFremove","#luckysheet-alternateformat-remove",function(){let t=$(this).data("index"),o=s.luckysheetfile[u(s.currentSheetIndex)].luckysheet_alternateformat_save,c=$.extend(!0,[],o);o.length>1?o.splice(t,1):o=[];let l=$.extend(!0,[],o);e.ref(c,l),f.allowUpdate&&f.saveParam("all",s.currentSheetIndex,o,{k:"luckysheet_alternateformat_save"}),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").hide(),r()})},perfect:function(){let e=this,t=$.extend(!0,{},s.luckysheet_select_save[0]),o=e.rangeIsExists(t)[1],c=$.extend(!0,{},s.luckysheetfile[u(s.currentSheetIndex)].luckysheet_alternateformat_save[o]),l=c.cellrange;$("#luckysheet-alternateformat-range input").val(h(s.currentSheetIndex,{row:l.row,column:l.column},s.currentSheetIndex)),s.luckysheet_select_save=[{row:l.row,column:l.column}],w();let a=c.hasRowHeader,n=c.hasRowFooter,r=c.format;e.modelfocusIndex=e.getIndexByFormat(r),null==e.modelfocusIndex&&(e.addCustomModel(r),e.modelfocusIndex=e.getIndexByFormat(r)),e.checkboxChange(a,n),e.modelboxOn(),$("#luckysheet-alternateformat-remove").data("index",o)},checkboxChange:function(e,t){e?($("#luckysheet-alternateformat-rowHeader").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .header").show()):($("#luckysheet-alternateformat-rowHeader").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .header").hide()),t?($("#luckysheet-alternateformat-rowFooter").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .footer").show()):($("#luckysheet-alternateformat-rowFooter").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .footer").hide()),this.getModelBox(e,t)},modelboxOn:function(){$("#luckysheet-modal-dialog-slider-alternateformat .modelbox").removeClass("on");let e=this.modelfocusIndex,t=this.FixedModelColor.length;e<t?$("#luckysheet-alternateformat-modelList .modelbox").eq(e).addClass("on"):$("#luckysheet-alternateformat-modelCustom .modelbox").eq(e-t).addClass("on"),this.modelToningColor()},modelToningColor:function(){let e=this.getFormatByIndex();$("#luckysheet-alternateformat-modelToning .header .toningShow").css({color:e.head.fc,"background-color":e.head.bc}),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",e.head.fc).data("bc",e.head.bc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.fc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.bc),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css({color:e.one.fc,"background-color":e.one.bc}),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",e.one.fc).data("bc",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.fc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css({color:e.two.fc,"background-color":e.two.bc}),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",e.two.fc).data("bc",e.two.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.fc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.bc),$("#luckysheet-alternateformat-modelToning .footer .toningShow").css({color:e.foot.fc,"background-color":e.foot.bc}),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",e.foot.fc).data("bc",e.foot.bc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.fc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.bc)},addCustomModel:function(e){let t=s.luckysheetfile[u(s.currentSheetIndex)];null==t.luckysheet_alternateformat_save_modelCustom&&(t.luckysheet_alternateformat_save_modelCustom=[]),t.luckysheet_alternateformat_save_modelCustom.push(e),f.allowUpdate&&f.saveParam("all",s.currentSheetIndex,t.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})},colorSelectDialog:function(e,t,o){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-alternateformat-colorSelect-dialog").remove();const c=i(),l=c.alternatingColors,a=c.button,n=c.toolbar;let r;"fc"==t?r=l.selectionTextColor:"bc"==t&&(r=l.selectionCellColor),$("body").append(m(y,{id:"luckysheet-alternateformat-colorSelect-dialog",addclass:"luckysheet-alternateformat-colorSelect-dialog",title:r,content:"<div class='currenColor' data-source='"+o+"'>"+l.currentColor+"：<span title='"+e+"' style='background-color:"+e+"'></span></div><div class='colorshowbox'></div>",botton:'<button id="luckysheet-alternateformat-colorSelect-dialog-confirm" class="btn btn-primary">'+a.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+a.cancel+"</button>",style:"z-index:100003"}));let d=$("#luckysheet-alternateformat-colorSelect-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),s=d.outerHeight(),u=d.outerWidth(),h=$(window).width(),b=$(window).height(),g=$(document).scrollLeft(),k=$(document).scrollTop();$("#luckysheet-alternateformat-colorSelect-dialog").css({left:(h+g-u)/2,top:(b+k-s)/3}).show(),$("#luckysheet-alternateformat-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:a.cancel,chooseText:n.confirmColor,togglePaletteMoreText:n.customColor,togglePaletteLessText:n.collapse,togglePaletteOnly:!0,clearText:n.clearText,noColorSelectedText:n.noColorSelectedText,localStorageKey:"spectrum.textcolor"+f.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(e){e=null!=e?e.toHexString():"#000",$("#luckysheet-alternateformat-colorSelect-dialog .currenColor span").css("background-color",e).attr("title",e)}})},rangeDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-alternateformat-rangeDialog").remove();const t=i(),o=t.alternatingColors,c=t.button;$("body").append(m(y,{id:"luckysheet-alternateformat-rangeDialog",addclass:"luckysheet-alternateformat-rangeDialog",title:o.selectRange,content:'<input readonly="readonly" placeholder="'+o.tipSelectRange+'" value="'+e+'"/>',botton:'<button id="luckysheet-alternateformat-rangeDialog-confirm" class="btn btn-primary">'+c.confirm+'</button><button id="luckysheet-alternateformat-rangeDialog-close" class="btn btn-default">'+c.cancel+"</button>",style:"z-index:100003"}));let l=$("#luckysheet-alternateformat-rangeDialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=l.outerHeight(),n=l.outerWidth(),r=$(window).width(),f=$(window).height(),d=$(document).scrollLeft(),s=$(document).scrollTop();$("#luckysheet-alternateformat-rangeDialog").css({left:(r+d-n)/2,top:(f+s-a)/3}).show()},rangeIsExists:function(e,t){let o=this,c=!1,l=null,a=$.extend(!0,[],s.luckysheetfile[u(s.currentSheetIndex)].luckysheet_alternateformat_save);if(void 0!=t&&null!=t&&(a.length>1?a.splice(t,1):a=[]),a.length>0){let t=[];for(let e=0;e<a.length;e++){let c={index:e,map:o.getRangeMap(a[e].cellrange.row,a[e].cellrange.column)};t.push(c)}let n=o.getRangeMap(e.row,e.column);for(let e in n){if(c)break;for(let o=0;o<t.length;o++)if(e in t[o].map){c=!0,l=t[o].index;break}}}return[c,l]},getRangeMap:function(e,t){let o={},c=e[0],l=e[1],a=t[0],n=t[1];for(let e=c;e<=l;e++)for(let t=a;t<=n;t++)o[e+"_"+t]=0;return o},getIndexByFormat:function(e){let t=null,o=this.FixedModelColor;for(let c=0;c<o.length;c++){let l=o[c];if(e.head.fc==l.head.fc&&e.head.bc==l.head.bc&&e.one.fc==l.one.fc&&e.one.bc==l.one.bc&&e.two.fc==l.two.fc&&e.two.bc==l.two.bc&&e.foot.fc==l.foot.fc&&e.foot.bc==l.foot.bc){t=c;break}}let c=s.luckysheetfile[u(s.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(null!=c&&c.length>0)for(let l=0;l<c.length;l++){let a=c[l];if(e.head.fc==a.head.fc&&e.head.bc==a.head.bc&&e.one.fc==a.one.fc&&e.one.bc==a.one.bc&&e.two.fc==a.two.fc&&e.two.bc==a.two.bc&&e.foot.fc==a.foot.fc&&e.foot.bc==a.foot.bc){t=o.length+l;break}}return t},getFormatByIndex:function(){let e=this,t=e.modelfocusIndex,o=e.FixedModelColor.length,c={};return c=t<o?e.FixedModelColor[t]:s.luckysheetfile[u(s.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom[t-o]},new:function(e){let t=this.getFormatByIndex(),o=s.luckysheetfile[u(s.currentSheetIndex)].luckysheet_alternateformat_save;null==o&&(o=[]);let c=$.extend(!0,[],o),l={cellrange:{row:e.row,column:e.column},format:t,hasRowHeader:!0,hasRowFooter:!1};o.push(l);let a=$.extend(!0,[],o);this.ref(c,a),f.allowUpdate&&f.saveParam("all",s.currentSheetIndex,o,{k:"luckysheet_alternateformat_save"})},update:function(){const e=i().alternatingColors;let t=$("#luckysheet-alternateformat-remove").data("index"),c=$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val().trim();if(!o.iscelldata(c))return void(b()?alert(e.errorNoRange):l.info(e.errorNoRange,""));let a,n,r=o.getcellrange(c);if(this.rangeIsExists(r,t)[0])return void(b()?alert(e.errorExistColors):l.info(e.errorExistColors,""));a=!!$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowHeader").is(":checked"),n=!!$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowFooter").is(":checked");let d=this.getFormatByIndex(),h=s.luckysheetfile[u(s.currentSheetIndex)].luckysheet_alternateformat_save;null==h&&(h=[]);let m=$.extend(!0,[],h),g={cellrange:{row:r.row,column:r.column},format:d,hasRowHeader:a,hasRowFooter:n};h[t]=g;let k=$.extend(!0,[],h);this.ref(m,k),f.allowUpdate&&f.saveParam("all",s.currentSheetIndex,h,{k:"luckysheet_alternateformat_save"})},checksAF:function(e,t,o){return e+"_"+t in o?o[e+"_"+t]:null},getComputeMap:function(){let e=s.luckysheetfile[u(s.currentSheetIndex)].luckysheet_alternateformat_save;return this.compute(e)},compute:function(e){let t={};if(null!=e&&e.length>0)for(let o=0;o<e.length;o++){let c=e[o].cellrange,l=e[o].format,a=e[o].hasRowHeader,n=e[o].hasRowFooter,r=c.row[0],f=c.row[1],d=c.column[0],s=c.column[1];if(a&&n){for(let e=d;e<=s;e++)t[r+"_"+e]=[l.head.fc,l.head.bc];if(f-r>1)for(let e=r+1;e<f;e++){let o,c;(e-r)%2!=0?(o=l.one.fc,c=l.one.bc):(o=l.two.fc,c=l.two.bc);for(let l=d;l<=s;l++)t[e+"_"+l]=[o,c]}if(f>r)for(let e=d;e<=s;e++)t[f+"_"+e]=[l.foot.fc,l.foot.bc]}else if(a){for(let e=d;e<=s;e++)t[r+"_"+e]=[l.head.fc,l.head.bc];if(f>r)for(let e=r+1;e<=f;e++){let o,c;(e-r)%2!=0?(o=l.one.fc,c=l.one.bc):(o=l.two.fc,c=l.two.bc);for(let l=d;l<=s;l++)t[e+"_"+l]=[o,c]}}else if(n){if(f>r)for(let e=r;e<f;e++){let o,c;(e-r)%2==0?(o=l.one.fc,c=l.one.bc):(o=l.two.fc,c=l.two.bc);for(let l=d;l<=s;l++)t[e+"_"+l]=[o,c]}for(let e=d;e<=s;e++)t[f+"_"+e]=[l.foot.fc,l.foot.bc]}else for(let e=r;e<=f;e++){let o,c;(e-r)%2==0?(o=l.one.fc,c=l.one.bc):(o=l.two.fc,c=l.two.bc);for(let l=d;l<=s;l++)t[e+"_"+l]=[o,c]}}return t},ref:function(e,t){if(s.clearjfundo){s.jfundo.length=0;let o={type:"updateAF"};o.sheetIndex=s.currentSheetIndex,o.data={historyRules:e,currentRules:t},s.jfredo.push(o)}let o=u(s.currentSheetIndex);s.luckysheetfile[o].luckysheet_alternateformat_save=t,setTimeout(function(){g()},1)}}});
//# sourceMappingURL=../sourcemaps/controllers/alternateformat.js.map
