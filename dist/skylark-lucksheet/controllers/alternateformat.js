/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../methods/alternateformat_methods","../methods/get","../utils/util","../methods/formula_methods","../methods/luckysheetConfigsetting","../widgets/tooltip","../widgets/constant","../widgets/resize","../widgets/select","../store","../locale/locale"],function(e,t,o,l,a,n,c,r,s,d,i){"use strict";const{getSheetIndex:u,getRangetxt:f}=t,{replaceHtml:h}=o,{isEditMode:m}=a,{luckysheetAlternateformatHtml:g,modelHTML:k}=c,{selectHightlightShow:y}=s;return Object.assign(e,{rangefocus:!1,modelfocusIndex:null,getModelBox:function(e,t){let o=this;$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").empty(),$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").empty();let l="";for(let a=0;a<o.FixedModelColor.length;a++){let n,c,r,s,d=o.FixedModelColor[a];e&&t?(n=d.head,c=d.one,r=d.two,s=d.foot):e?(n=d.head,c=d.one,r=d.two,s=d.one):t?(n=d.one,c=d.two,r=d.one,s=d.foot):(n=d.one,c=d.two,r=d.one,s=d.two),l+='<div class="modelbox"><div class="box"><span style="color:'+n.fc+";background-color:"+n.bc+'"> — </span><span style="color:'+c.fc+";background-color:"+c.bc+'"> — </span><span style="color:'+r.fc+";background-color:"+r.bc+'"> — </span><span style="color:'+s.fc+";background-color:"+s.bc+'"> — </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").append(l);let a=d.luckysheetfile[u(d.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(null!=a&&a.length>0){let o="";for(let l=0;l<a.length;l++){let n,c,r,s,d=a[l];e&&t?(n=d.head,c=d.one,r=d.two,s=d.foot):e?(n=d.head,c=d.one,r=d.two,s=d.one):t?(n=d.one,c=d.two,r=d.one,s=d.foot):(n=d.one,c=d.two,r=d.one,s=d.two),o+='<div class="modelbox"><div class="box"><span style="color:'+n.fc+";background-color:"+n.bc+'"> — </span><span style="color:'+c.fc+";background-color:"+c.bc+'"> — </span><span style="color:'+r.fc+";background-color:"+r.bc+'"> — </span><span style="color:'+s.fc+";background-color:"+s.bc+'"> — </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").append(o)}},init:function(){let e=this;$("#luckysheet-modal-dialog-slider-alternateformat").remove(),$("body").append(g()),r(),$("#luckysheet-modal-dialog-slider-alternateformat .luckysheet-model-close-btn").click(function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),r()}),$(document).off("focus.AFrangeInput").on("focus.AFrangeInput","#luckysheet-alternateformat-range input",function(){e.rangefocus=!0}),$(document).off("blur.AFrangeInput").on("blur.AFrangeInput","#luckysheet-alternateformat-range input",function(){e.rangefocus=!1}),$(document).off("keydown.AFrangeInput").on("keydown.AFrangeInput","#luckysheet-alternateformat-range input",function(t){$(this).val().trim();13==t.keyCode&&e.update()}),$(document).off("click.AFrangeIcon").on("click.AFrangeIcon","#luckysheet-alternateformat-range .fa-table",function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),r();let t=$(this).parents("#luckysheet-alternateformat-range").find("input").val().trim();e.rangeDialog(t)}),$(document).off("click.AFrDCf").on("click.AFrDCf","#luckysheet-alternateformat-rangeDialog-confirm",function(){let t=$(this).parents("#luckysheet-alternateformat-rangeDialog").find("input").val().trim();$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val(t),$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),r(),e.update()}),$(document).off("click.AFrDCl").on("click.AFrDCl","#luckysheet-alternateformat-rangeDialog-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),r()}),$(document).off("click.AFrDTitle").on("click.AFrDTitle","#luckysheet-alternateformat-rangeDialog .luckysheet-modal-dialog-title-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),r()}),$(document).off("change.AFrowHeader").on("change.AFrowHeader","#luckysheet-alternateformat-rowHeader",function(){let t,o;t=!!$(this).is(":checked"),o=!!$("#luckysheet-alternateformat-rowFooter").is(":checked"),e.checkboxChange(t,o),e.modelboxOn(),e.update()}),$(document).off("change.AFrowFooter").on("change.AFrowFooter","#luckysheet-alternateformat-rowFooter",function(){let t,o;t=!!$("#luckysheet-alternateformat-rowHeader").is(":checked"),o=!!$(this).is(":checked"),e.checkboxChange(t,o),e.modelboxOn(),e.update()}),$(document).off("click.AFmodelbox").on("click.AFmodelbox","#luckysheet-modal-dialog-slider-alternateformat .modelbox",function(){let t=$(this).index(),o=$(this).parents(".cf").attr("id");if("luckysheet-alternateformat-modelList"==o)e.modelfocusIndex=t;else if("luckysheet-alternateformat-modelCustom"==o){let o=e.FixedModelColor.length;e.modelfocusIndex=t+o}e.modelboxOn(),e.update()}),$(document).off("click.AFselectColor").on("click.AFselectColor","#luckysheet-modal-dialog-slider-alternateformat .luckysheet-color-menu-button-indicator",function(){let t,o,l,a=$(this).closest(".toningbox");$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-text-color")?(t="fc",o=a.find(".toningShow").data("fc")):$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-cell-color")&&(t="bc",o=a.find(".toningShow").data("bc")),a.hasClass("header")?l="0":a.hasClass("ctOne")?l="1":a.hasClass("ctTwo")?l="2":a.hasClass("footer")&&(l="3"),e.colorSelectDialog(o,t,l)}),$(document).off("click.AFselectColorConfirm").on("click.AFselectColorConfirm","#luckysheet-alternateformat-colorSelect-dialog-confirm",function(){let t=$(this).parents("#luckysheet-alternateformat-colorSelect-dialog");const o=i().alternatingColors;$("#luckysheet-modal-dialog-mask").hide(),t.hide();let l,a=t.find(".currenColor span").attr("title");t.find(".luckysheet-modal-dialog-title-text").text()==o.selectionTextColor?l="fc":t.find(".luckysheet-modal-dialog-title-text").text()==o.selectionCellColor&&(l="bc");let n,c,r=t.find(".currenColor").attr("data-source");"0"==r?("fc"==l&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("color",a),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",a),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",a)),"bc"==l&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("background-color",a),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("bc",a),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",a))):"1"==r?("fc"==l&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("color",a),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",a),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",a)),"bc"==l&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("background-color",a),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("bc",a),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",a))):"2"==r?("fc"==l&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("color",a),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",a),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",a)),"bc"==l&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("background-color",a),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("bc",a),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",a))):"3"==r&&("fc"==l&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("color",a),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",a),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",a)),"bc"==l&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("background-color",a),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("bc",a),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",a))),n=!!$("#luckysheet-alternateformat-rowHeader").is(":checked"),c=!!$("#luckysheet-alternateformat-rowFooter").is(":checked");let s,f,h=e.modelfocusIndex,m=e.FixedModelColor.length;if(h<m)s=$.extend(!0,{},e.getFormatByIndex());else{let e=(f=d.luckysheetfile[u(d.currentSheetIndex)]).luckysheet_alternateformat_save_modelCustom;s=$.extend(!0,{},e[h-m])}"0"==r?"fc"==l?s.head.fc=a:"bc"==l&&(s.head.bc=a):"1"==r?"fc"==l?s.one.fc=a:"bc"==l&&(s.one.bc=a):"2"==r?"fc"==l?s.two.fc=a:"bc"==l&&(s.two.bc=a):"3"==r&&("fc"==l&&(s.foot.fc=a),"bc"==l&&(s.foot.bc=a)),e.modelfocusIndex<m?(e.addCustomModel(s),e.modelfocusIndex=e.getIndexByFormat(s)):(f.luckysheet_alternateformat_save_modelCustom[h-m]=s,d.allowUpdate&&d.saveParam("all",d.currentSheetIndex,f.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})),e.getModelBox(n,c),e.modelboxOn(),e.update()}),$(document).off("click.AFremove").on("click.AFremove","#luckysheet-alternateformat-remove",function(){let t=$(this).data("index"),o=d.luckysheetfile[u(d.currentSheetIndex)].luckysheet_alternateformat_save,l=$.extend(!0,[],o);o.length>1?o.splice(t,1):o=[];let a=$.extend(!0,[],o);e.ref(l,a),d.allowUpdate&&d.saveParam("all",d.currentSheetIndex,o,{k:"luckysheet_alternateformat_save"}),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").hide(),r()})},perfect:function(){let e=this,t=$.extend(!0,{},d.luckysheet_select_save[0]),o=e.rangeIsExists(t)[1],l=$.extend(!0,{},d.luckysheetfile[u(d.currentSheetIndex)].luckysheet_alternateformat_save[o]),a=l.cellrange;$("#luckysheet-alternateformat-range input").val(f(d.currentSheetIndex,{row:a.row,column:a.column},d.currentSheetIndex)),d.luckysheet_select_save=[{row:a.row,column:a.column}],y();let n=l.hasRowHeader,c=l.hasRowFooter,r=l.format;e.modelfocusIndex=e.getIndexByFormat(r),null==e.modelfocusIndex&&(e.addCustomModel(r),e.modelfocusIndex=e.getIndexByFormat(r)),e.checkboxChange(n,c),e.modelboxOn(),$("#luckysheet-alternateformat-remove").data("index",o)},checkboxChange:function(e,t){e?($("#luckysheet-alternateformat-rowHeader").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .header").show()):($("#luckysheet-alternateformat-rowHeader").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .header").hide()),t?($("#luckysheet-alternateformat-rowFooter").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .footer").show()):($("#luckysheet-alternateformat-rowFooter").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .footer").hide()),this.getModelBox(e,t)},modelboxOn:function(){$("#luckysheet-modal-dialog-slider-alternateformat .modelbox").removeClass("on");let e=this.modelfocusIndex,t=this.FixedModelColor.length;e<t?$("#luckysheet-alternateformat-modelList .modelbox").eq(e).addClass("on"):$("#luckysheet-alternateformat-modelCustom .modelbox").eq(e-t).addClass("on"),this.modelToningColor()},modelToningColor:function(){let e=this.getFormatByIndex();$("#luckysheet-alternateformat-modelToning .header .toningShow").css({color:e.head.fc,"background-color":e.head.bc}),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",e.head.fc).data("bc",e.head.bc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.fc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.bc),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css({color:e.one.fc,"background-color":e.one.bc}),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",e.one.fc).data("bc",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.fc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css({color:e.two.fc,"background-color":e.two.bc}),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",e.two.fc).data("bc",e.two.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.fc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.bc),$("#luckysheet-alternateformat-modelToning .footer .toningShow").css({color:e.foot.fc,"background-color":e.foot.bc}),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",e.foot.fc).data("bc",e.foot.bc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.fc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.bc)},addCustomModel:function(e){let t=d.luckysheetfile[u(d.currentSheetIndex)];null==t.luckysheet_alternateformat_save_modelCustom&&(t.luckysheet_alternateformat_save_modelCustom=[]),t.luckysheet_alternateformat_save_modelCustom.push(e),d.allowUpdate&&d.saveParam("all",d.currentSheetIndex,t.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})},colorSelectDialog:function(e,t,o){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-alternateformat-colorSelect-dialog").remove();const l=i(),a=l.alternatingColors,n=l.button,c=l.toolbar;let r;"fc"==t?r=a.selectionTextColor:"bc"==t&&(r=a.selectionCellColor),$("body").append(h(k,{id:"luckysheet-alternateformat-colorSelect-dialog",addclass:"luckysheet-alternateformat-colorSelect-dialog",title:r,content:"<div class='currenColor' data-source='"+o+"'>"+a.currentColor+"：<span title='"+e+"' style='background-color:"+e+"'></span></div><div class='colorshowbox'></div>",botton:'<button id="luckysheet-alternateformat-colorSelect-dialog-confirm" class="btn btn-primary">'+n.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+n.cancel+"</button>",style:"z-index:100003"}));let s=$("#luckysheet-alternateformat-colorSelect-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),u=s.outerHeight(),f=s.outerWidth(),m=$(window).width(),g=$(window).height(),y=$(document).scrollLeft(),b=$(document).scrollTop();$("#luckysheet-alternateformat-colorSelect-dialog").css({left:(m+y-f)/2,top:(g+b-u)/3}).show(),$("#luckysheet-alternateformat-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:n.cancel,chooseText:c.confirmColor,togglePaletteMoreText:c.customColor,togglePaletteLessText:c.collapse,togglePaletteOnly:!0,clearText:c.clearText,noColorSelectedText:c.noColorSelectedText,localStorageKey:"spectrum.textcolor"+d.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(e){e=null!=e?e.toHexString():"#000",$("#luckysheet-alternateformat-colorSelect-dialog .currenColor span").css("background-color",e).attr("title",e)}})},rangeDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-alternateformat-rangeDialog").remove();const t=i(),o=t.alternatingColors,l=t.button;$("body").append(h(k,{id:"luckysheet-alternateformat-rangeDialog",addclass:"luckysheet-alternateformat-rangeDialog",title:o.selectRange,content:'<input readonly="readonly" placeholder="'+o.tipSelectRange+'" value="'+e+'"/>',botton:'<button id="luckysheet-alternateformat-rangeDialog-confirm" class="btn btn-primary">'+l.confirm+'</button><button id="luckysheet-alternateformat-rangeDialog-close" class="btn btn-default">'+l.cancel+"</button>",style:"z-index:100003"}));let a=$("#luckysheet-alternateformat-rangeDialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),n=a.outerHeight(),c=a.outerWidth(),r=$(window).width(),s=$(window).height(),d=$(document).scrollLeft(),u=$(document).scrollTop();$("#luckysheet-alternateformat-rangeDialog").css({left:(r+d-c)/2,top:(s+u-n)/3}).show()},rangeIsExists:function(e,t){let o=this,l=!1,a=null,n=$.extend(!0,[],d.luckysheetfile[u(d.currentSheetIndex)].luckysheet_alternateformat_save);if(void 0!=t&&null!=t&&(n.length>1?n.splice(t,1):n=[]),n.length>0){let t=[];for(let e=0;e<n.length;e++){let l={index:e,map:o.getRangeMap(n[e].cellrange.row,n[e].cellrange.column)};t.push(l)}let c=o.getRangeMap(e.row,e.column);for(let e in c){if(l)break;for(let o=0;o<t.length;o++)if(e in t[o].map){l=!0,a=t[o].index;break}}}return[l,a]},getRangeMap:function(e,t){let o={},l=e[0],a=e[1],n=t[0],c=t[1];for(let e=l;e<=a;e++)for(let t=n;t<=c;t++)o[e+"_"+t]=0;return o},getIndexByFormat:function(e){let t=null,o=this.FixedModelColor;for(let l=0;l<o.length;l++){let a=o[l];if(e.head.fc==a.head.fc&&e.head.bc==a.head.bc&&e.one.fc==a.one.fc&&e.one.bc==a.one.bc&&e.two.fc==a.two.fc&&e.two.bc==a.two.bc&&e.foot.fc==a.foot.fc&&e.foot.bc==a.foot.bc){t=l;break}}let l=d.luckysheetfile[u(d.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(null!=l&&l.length>0)for(let a=0;a<l.length;a++){let n=l[a];if(e.head.fc==n.head.fc&&e.head.bc==n.head.bc&&e.one.fc==n.one.fc&&e.one.bc==n.one.bc&&e.two.fc==n.two.fc&&e.two.bc==n.two.bc&&e.foot.fc==n.foot.fc&&e.foot.bc==n.foot.bc){t=o.length+a;break}}return t},getFormatByIndex:function(){let e=this,t=e.modelfocusIndex,o=e.FixedModelColor.length,l={};return l=t<o?e.FixedModelColor[t]:d.luckysheetfile[u(d.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom[t-o]},new:function(e){let t=this.getFormatByIndex(),o=d.luckysheetfile[u(d.currentSheetIndex)].luckysheet_alternateformat_save;null==o&&(o=[]);let l=$.extend(!0,[],o),a={cellrange:{row:e.row,column:e.column},format:t,hasRowHeader:!0,hasRowFooter:!1};o.push(a);let n=$.extend(!0,[],o);this.ref(l,n),d.allowUpdate&&d.saveParam("all",d.currentSheetIndex,o,{k:"luckysheet_alternateformat_save"})},update:function(){const e=i().alternatingColors;let t=$("#luckysheet-alternateformat-remove").data("index"),o=$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val().trim();if(!l.iscelldata(o))return void(m()?alert(e.errorNoRange):n.info(e.errorNoRange,""));let a,c,r=l.getcellrange(o);if(this.rangeIsExists(r,t)[0])return void(m()?alert(e.errorExistColors):n.info(e.errorExistColors,""));a=!!$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowHeader").is(":checked"),c=!!$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowFooter").is(":checked");let s=this.getFormatByIndex(),f=d.luckysheetfile[u(d.currentSheetIndex)].luckysheet_alternateformat_save;null==f&&(f=[]);let h=$.extend(!0,[],f),g={cellrange:{row:r.row,column:r.column},format:s,hasRowHeader:a,hasRowFooter:c};f[t]=g;let k=$.extend(!0,[],f);this.ref(h,k),d.allowUpdate&&d.saveParam("all",d.currentSheetIndex,f,{k:"luckysheet_alternateformat_save"})},ref:function(e,t){if(d.clearjfundo){d.jfundo.length=0;let o={type:"updateAF"};o.sheetIndex=d.currentSheetIndex,o.data={historyRules:e,currentRules:t},d.jfredo.push(o)}let o=u(d.currentSheetIndex);d.luckysheetfile[o].luckysheet_alternateformat_save=t,d.refresh()}})});
//# sourceMappingURL=../sourcemaps/controllers/alternateformat.js.map
