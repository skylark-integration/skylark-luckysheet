/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../utils/util","../methods/sort_methods","../methods/validate","../methods/datecontroll","../widgets/tooltip","../methods/getRowlen","../methods/protection_methods","../methods/luckysheetConfigsetting","../store","../vendors/numeral"],function(e,l,t,n,o,r,u,i,s,f){"use strict";const{getObjType:a}=e,{isRealNull:c,isRealNum:d}=t,h=i.isEditMode,{isdatetime:g,diff:m}=n,{rowlenByRange:v}=r,{checkProtectionAuthorityNormal:w}=u,{orderbydata:y,orderbydata1D:_}=l;return{orderbydata:y,orderbydata1D:_,sortSelection:function(e){if(!w(s.currentSheetIndex,"sort"))return;if(s.luckysheet_select_save.length>1)return void(h()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):o.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""));null==e&&(e=!0);let l,t,n=s.deepCopyFlowData(s.flowdata),r=s.luckysheet_select_save[0].row[0],u=s.luckysheet_select_save[0].row[1],i=s.luckysheet_select_save[0].column[0],f=s.luckysheet_select_save[0].column[1];for(let e=r;e<=u;e++)if(null!=n[e]&&null!=n[e][i]){let o=n[e][i];if(null!=o.mc||c(o.v))continue;if(null==l&&/[\u4e00-\u9fa5]+/g.test(o.v)){l=e+1,t=e+1;continue}null==l&&(l=e),t=e}if(null==l||l>u)return;let a=!1,d=[];for(let e=l;e<=t;e++){let l=[];for(let t=i;t<=f;t++){if(null!=n[e][t]&&null!=n[e][t].mc){a=!0;break}l.push(n[e][t])}d.push(l)}if(a)return void(h()?alert("选区有合并单元格，无法执行此操作！"):o.info("选区有合并单元格，无法执行此操作！",""));d=y(d,0,e);for(let e=l;e<=t;e++)for(let t=i;t<=f;t++)n[e][t]=d[e-l][t-i];let g={};if(null!=s.config.rowlen){let e=$.extend(!0,{},s.config);g={cfg:e=v(n,l,t,e),RowlChange:!0}}s.refreshRange(n,[{row:[l,t],column:[i,f]}],g)},sortColumnSeletion:function(e,l){if(!w(s.currentSheetIndex,"sort"))return;null==l&&(l=!0);let t,n,r=s.deepCopyFlowData(s.flowdata),u=r.length-1,i=r[0].length-1;for(let l=0;l<=u;l++)null!=r[l][e]&&null!=r[l][e].mc||(null==r[l][e]||c(r[l][e].v)||!/[\u4e00-\u9fa5]+/g.test(r[l][e].v)||null!=t?(null==t&&(t=l),null==r[l][e]||c(r[l][e].v)||(n=l)):(t=l+1,n=l+1));if(null==t||t>u)return;let f=!1,a=[];for(let e=t;e<=n;e++){let l=[];for(let t=0;t<=i;t++){if(null!=r[e][t]&&null!=r[e][t].mc){f=!0;break}l.push(r[e][t])}a.push(l)}if(f)return void(h()?alert("列排序会扩展至整个表格选区，选区有合并单元格，无法执行此操作，请选择功能栏排序功能！"):o.info("列排序会扩展至整个表格选区，选区有合并单元格，无法执行此操作，请选择功能栏排序功能！",""));a=y(a,e,l);for(let e=t;e<=n;e++)for(let l=0;l<=i;l++)r[e][l]=a[e-t][l-0];let d={};if(null!=s.config.rowlen){let e=$.extend(!0,{},s.config);d={cfg:e=v(r,t,n,e),RowlChange:!0}}s.refreshRange(r,[{row:[t,n],column:[0,i]}],d)}}});
//# sourceMappingURL=../sourcemaps/controllers/sort.js.map
