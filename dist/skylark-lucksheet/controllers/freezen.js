/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../methods/freezen_methods","../methods/get","../methods/sheetSearch","../widgets/select","./filter","../methods/cells","./postil","./dropCell","../methods/location","../store","../locale/locale"],function(e,l,t,s,c,i,o,a,n,r,h){"use strict";const{getSheetIndex:d}=l,{luckysheet_searcharray:u}=t,{selectHightlightShow:f}=s,{createFilterOptions:y}=c,{rowLocationByIndex:k,colLocationByIndex:v}=n,w=Object.assign(e,{freezenHorizontalHTML:'<div id="luckysheet-freezebar-horizontal" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-horizontal-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-horizontal-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-bar" >&nbsp;</div></div></div>',freezenVerticalHTML:'<div id="luckysheet-freezebar-vertical" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-vertical-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-vertical-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-bar" >&nbsp;</div></div></div>',windowHeight:null,windowWidth:null,cancelFreezenVertical:function(e){const l=h().freezen;$("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> '+l.freezenColumn),r.freezenverticaldata=null;let t=$("#luckysheet-freezebar-vertical").is(":visible");$("#luckysheet-freezebar-vertical").hide(),null==e&&(e=r.currentSheetIndex);let s=r.luckysheetfile[d(e)];null!=s.freezen&&(s.freezen.vertical=null),null!=s.frozen&&t&&r.saveParam("all",e,s.frozen,{k:"frozen"})},createFreezenVertical:function(e,l){let t=this;if(t.initialVertical){t.initialVertical=!1,$("#luckysheet-grid-window-1").append(t.freezenVerticalHTML),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").mousedown(function(){t.verticalmovestate=!0,t.verticalmoveposition=$(this).position().left,t.windowWidth=$("#luckysheet-grid-window-1").width(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css("cursor","-webkit-grabbing")});let e=$("#luckysheet-grid-window-1").height();$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:e-10,width:"4px",cursor:"-webkit-grab",top:"0px"}).end().find(".luckysheet-freezebar-vertical-drop").css({height:e-10,width:"4px",top:"0px",cursor:"-webkit-grab"})}if(null==e){let s=$("#luckysheet-cell-main").scrollLeft(),c=u(r.visibledatacolumn,s);-1==c&&(c=0),l=r.visibledatacolumn[c]-2-s+r.rowHeaderWidth,e=[r.visibledatacolumn[c],c+1,s,t.cutVolumn(r.visibledatacolumn,c+1),l],t.saveFreezen(null,null,e,l)}r.freezenverticaldata=e;const s=`\n            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"\n            style="user-select: none;">\n                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"\n                style="user-select: none;">\n                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">\n                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"\n                        style="user-select: none;">\n                        </div>\n                    </div>\n                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"\n                    style="user-select: none;">\n                        ${h().freezen.freezenCancel}\n                    </div>\n                </div>\n            </div>\n        `;$("#luckysheet-freezen-btn-horizontal").html(s),$("#luckysheet-freezebar-vertical").show().find(".luckysheet-freezebar-vertical-handle").css({left:l}).end().find(".luckysheet-freezebar-vertical-drop").css({left:l})},scrollFreezen:function(){let e,l,t=r.luckysheet_select_save[0].row_focus;t==r.luckysheet_select_save[0].row[0]?e=r.luckysheet_select_save[0].row[1]:t==r.luckysheet_select_save[0].row[1]&&(e=r.luckysheet_select_save[0].row[0]);let s=r.luckysheet_select_save[0].column_focus;if(s==r.luckysheet_select_save[0].column[0]?l=r.luckysheet_select_save[0].column[1]:s==r.luckysheet_select_save[0].column[1]&&(l=r.luckysheet_select_save[0].column[0]),null!=r.freezenverticaldata){let e=r.freezenverticaldata[1],t=u(r.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()),s=r.freezenverticaldata[4];e+=t,l>=r.visibledatacolumn.length&&(l=r.visibledatacolumn.length-1),e>=r.visibledatacolumn.length&&(e=r.visibledatacolumn.length-1),r.visibledatacolumn[l]<=r.visibledatacolumn[e]+s&&(console.log(1111),setTimeout(function(){$("#luckysheet-scrollbar-x").scrollLeft(0)},100))}if(null!=r.freezenhorizontaldata){let l=r.freezenhorizontaldata[1],t=u(r.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()),s=r.freezenhorizontaldata[4];l+=t,e>=r.visibledatarow.length&&(e=r.visibledatarow.length-1),l>=r.visibledatarow.length&&(l=r.visibledatarow.length-1),r.visibledatarow[e]<=r.visibledatarow[l]+s&&setTimeout(function(){$("#luckysheet-scrollbar-y").scrollTop(0)},100)}},cancelFreezenHorizontal:function(e){const l=`\n            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"\n            style="user-select: none;">\n                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"\n                style="user-select: none;">\n                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">\n                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"\n                        style="user-select: none;">\n                        </div>\n                    </div>\n                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"\n                    style="user-select: none;">\n                        ${h().freezen.default}\n                    </div>\n                </div>\n            </div>\n        `;$("#luckysheet-freezen-btn-horizontal").html(l),r.freezenhorizontaldata=null;let t=$("#luckysheet-freezebar-horizontal").is(":visible");$("#luckysheet-freezebar-horizontal").hide(),null==e&&(e=r.currentSheetIndex);let s=r.luckysheetfile[d(e)];null!=s.freezen&&(s.freezen.horizontal=null),null!=s.frozen&&t&&r.saveParam("all",e,s.frozen,{k:"frozen"})},createFreezenHorizontal:function(e,l){let t=this;if(t.initialHorizontal){t.initialHorizontal=!1,$("#luckysheet-grid-window-1").append(t.freezenHorizontalHTML),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").mousedown(function(){t.horizontalmovestate=!0,t.horizontalmoveposition=$(this).position().top,t.windowHeight=$("#luckysheet-grid-window-1").height(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css("cursor","-webkit-grabbing")});let e=$("#luckysheet-grid-window-1").width();$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:e-10,height:"4px",cursor:"-webkit-grab",left:"0px"}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:e-10,height:"4px",left:"0px",cursor:"-webkit-grab"})}if(null==e){let s=$("#luckysheet-cell-main").scrollTop(),c=u(r.visibledatarow,s);-1==c&&(c=0),l=r.visibledatarow[c]-2-s+r.columnHeaderHeight,e=[r.visibledatarow[c],c+1,s,t.cutVolumn(r.visibledatarow,c+1),l],t.saveFreezen(e,l,null,null)}r.freezenhorizontaldata=e;const s=`\n            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"\n            style="user-select: none;">\n                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"\n                style="user-select: none;">\n                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">\n                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"\n                        style="user-select: none;">\n                        </div>\n                    </div>\n                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"\n                    style="user-select: none;">\n                        ${h().freezen.freezenCancel}\n                    </div>\n                </div>\n            </div>\n        `;$("#luckysheet-freezen-btn-horizontal").html(s),$("#luckysheet-freezebar-horizontal").show().find(".luckysheet-freezebar-horizontal-handle").css({top:l}).end().find(".luckysheet-freezebar-horizontal-drop").css({top:l})},createAssistCanvas:function(){let e=this;if(e.removeAssistCanvas(),null!=r.freezenverticaldata||null!=r.freezenhorizontaldata){let l,t,s,c,i,o,a=r.luckysheetTableContentHW[0],n=r.luckysheetTableContentHW[1];null!=r.freezenverticaldata&&null!=r.freezenhorizontaldata?(l=r.freezenhorizontaldata[0],t=r.freezenhorizontaldata[1],s=r.freezenhorizontaldata[2],c=r.freezenverticaldata[0],i=r.freezenverticaldata[1],o=r.freezenverticaldata[2],e.createCanvas("freezen_3",c-o,l-s+1,r.rowHeaderWidth-1,r.columnHeaderHeight-1),e.createCanvas("freezen_4",a-c+o,l-s+1,c-o+r.rowHeaderWidth-1,r.columnHeaderHeight-1),e.createCanvas("freezen_7",c-o,n-l+s-r.columnHeaderHeight,r.rowHeaderWidth-1,l-s+r.columnHeaderHeight-1)):null!=r.freezenhorizontaldata?(l=r.freezenhorizontaldata[0],t=r.freezenhorizontaldata[1],s=r.freezenhorizontaldata[2],e.createCanvas("freezen_h",a,l-s+1,r.rowHeaderWidth-1,r.columnHeaderHeight-1)):null!=r.freezenverticaldata&&(c=r.freezenverticaldata[0],i=r.freezenverticaldata[1],o=r.freezenverticaldata[2],e.createCanvas("freezen_v",c-o,n,r.rowHeaderWidth-1,r.columnHeaderHeight-1)),e.scrollAdapt()}},createCanvas:function(e,l,t,s,c){$("<canvas/>").appendTo("#luckysheet-grid-window-1").attr({id:e,width:Math.ceil(l*r.devicePixelRatio),height:Math.ceil(t*r.devicePixelRatio)}).css({"user-select":"none",postion:"absolute",left:s,top:c,width:l,height:t,"z-index":10,"pointer-events":"none"})},removeAssistCanvas:function(){$("#luckysheet-grid-window-1 > canvas").not($("#luckysheetTableContent")).remove(),$("#luckysheet-cell-selected").css("z-index",15)},scrollAdapt:function(){let e=this;if(null!=r.luckysheet_select_save&&r.luckysheet_select_save.length>0&&e.scrollAdaptOfselect(),$("#luckysheet-cell-main .luckysheet-data-visualization-chart").length>0){const l=r.luckysheetfile[d(r.currentSheetIndex)].chart;null!=l&&l.length>0&&e.scrollAdaptOfchart()}$("#luckysheet-postil-showBoxs .luckysheet-postil-show").length>0&&e.scrollAdaptOfpostil(),$("#luckysheet-dropCell-icon").length>0&&e.scrollAdaptOfdpicon(),$("#luckysheet-filter-options-sheet"+r.currentSheetIndex+" .luckysheet-filter-options").length>0&&e.scrollAdaptOffilteroptions()},scrollAdaptOfselect:function(){$("#luckysheet-row-count-show").is(":visible")&&$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").is(":visible")&&$("#luckysheet-column-count-show").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty();let e=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft();if(null!=r.freezenhorizontaldata&&null!=r.freezenverticaldata){let t=r.freezenhorizontaldata[0],s=r.freezenhorizontaldata[1],c=e-r.freezenhorizontaldata[2],o=r.freezenverticaldata[0],a=r.freezenverticaldata[1],n=l-r.freezenverticaldata[2];for(let e=0;e<r.luckysheet_select_save.length;e++){let l=$.extend(!0,{},r.luckysheet_select_save[e]),h=l.row[0],d=l.row[1],u=r.visibledatarow[d],f=h-1==-1?0:r.visibledatarow[h-1],y=f,k=u-f-1,v=!0;h>=s?y+k<t+c?v=!1:y<t+c?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({top:t+c,height:k-(t+c-y)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({top:y,height:k}):d>=s?y+k<t+c?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({top:y+c,height:t-y}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({top:y+c,height:k-c}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css("top",y+c);let w=l.column[0],z=l.column[1],p=r.visibledatacolumn[z],b=w-1==-1?0:r.visibledatacolumn[w-1],m=b,g=p-b-1;if(w>=a?m+g<o+n?v=!1:m<o+n?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({left:o+n,width:g-(o+n-m)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({left:m,width:g}):z>=a?m+g<o+n?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({left:m+n,width:o-m}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({left:m+n,width:g-n}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css("left",m+n),v||$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).hide(),e==r.luckysheet_select_save.length-1){let e=null==l.row_focus?h:l.row_focus,s=null==l.column_focus?w:l.column_focus,a=r.visibledatarow[e],d=e-1==-1?0:r.visibledatarow[e-1],u=r.visibledatacolumn[s],f=s-1==-1?0:r.visibledatacolumn[s-1],y=i.mergeborer(r.flowdata,e,s);y&&(a=y.row[1],d=y.row[0],u=y.column[1],f=y.column[0]);let k=d,v=a-d-1,z=f,p=u-f-1,b=!0;k>=t?k+v<t+c?b=!1:k<t+c?$("#luckysheet-cell-selected-focus").show().css({top:t+c,height:v-(t+c-k)}):$("#luckysheet-cell-selected-focus").show().css({top:k,height:v}):k+v>=t?k+v<t+c?$("#luckysheet-cell-selected-focus").show().css({top:k+c,height:t-k}):$("#luckysheet-cell-selected-focus").show().css({top:k+c,height:v-c}):$("#luckysheet-cell-selected-focus").show().css("top",k+c),z>=o?z+p<o+n?b=!1:z<o+n?$("#luckysheet-cell-selected-focus").show().css({left:o+n,width:p-(o+n-z)}):$("#luckysheet-cell-selected-focus").show().css({left:z,width:p}):z+p>=o?z+p<o+n?$("#luckysheet-cell-selected-focus").show().css({left:z+n,width:o-z}):$("#luckysheet-cell-selected-focus").show().css({left:z+n,width:p-n}):$("#luckysheet-cell-selected-focus").show().css("left",z+n),b||$("#luckysheet-cell-selected-focus").hide()}}}else if(null!=r.freezenhorizontaldata){let l=r.freezenhorizontaldata[0],t=r.freezenhorizontaldata[1],s=e-r.freezenhorizontaldata[2];for(let e=0;e<r.luckysheet_select_save.length;e++){let c=$.extend(!0,{},r.luckysheet_select_save[e]),o=c.row[0],a=c.row[1],n=r.visibledatarow[a],h=o-1==-1?0:r.visibledatarow[o-1],d=h,u=n-h-1;if(o>=t?d+u<l+s?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).hide():d<l+s?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({top:l+s,height:u-(l+s-d)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({top:d,height:u}):a>=t?d+u<l+s?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({top:d+s,height:l-d}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css({top:d+s,height:u-s}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(e).show().css("top",d+s),e==r.luckysheet_select_save.length-1){let e=null==c.row_focus?o:c.row_focus,t=null==c.column_focus?c.column[0]:c.column_focus,a=r.visibledatarow[e],n=e-1==-1?0:r.visibledatarow[e-1],h=i.mergeborer(r.flowdata,e,t);h&&(a=h.row[1],n=h.row[0]);let d=n,u=a-n-1;d>=l?d+u<l+s?$("#luckysheet-cell-selected-focus").hide():d<l+s?$("#luckysheet-cell-selected-focus").show().css({top:l+s,height:u-(l+s-d)}):$("#luckysheet-cell-selected-focus").show().css({top:d,height:u}):d+u>=l?d+u<l+s?$("#luckysheet-cell-selected-focus").show().css({top:d+s,height:l-d}):$("#luckysheet-cell-selected-focus").show().css({top:d+s,height:u-s}):$("#luckysheet-cell-selected-focus").show().css("top",d+s)}}}else if(null!=r.freezenverticaldata){let e=r.freezenverticaldata[0],t=r.freezenverticaldata[1],s=l-r.freezenverticaldata[2];for(let l=0;l<r.luckysheet_select_save.length;l++){let c=$.extend(!0,{},r.luckysheet_select_save[l]),o=c.column[0],a=c.column[1],n=r.visibledatacolumn[a],h=o-1==-1?0:r.visibledatacolumn[o-1],d=h,u=n-h-1;if(o>=t?d+u<e+s?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(l).hide():d<e+s?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(l).show().css({left:e+s,width:u-(e+s-d)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(l).show().css({left:d,width:u}):a>=t?d+u<e+s?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(l).show().css({left:d+s,width:e-d}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(l).show().css({left:d+s,width:u-s}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(l).show().css("left",d+s),l==r.luckysheet_select_save.length-1){let l=null==c.row_focus?c.row[0]:c.row_focus,t=null==c.column_focus?o:c.column_focus,a=r.visibledatacolumn[t],n=t-1==-1?0:r.visibledatacolumn[t-1],h=i.mergeborer(r.flowdata,l,t);h&&(a=h.column[1],n=h.column[0]);let d=n,u=a-n-1;d>=e?d+u<e+s?$("#luckysheet-cell-selected-focus").hide():d<e+s?$("#luckysheet-cell-selected-focus").show().css({left:e+s,width:u-(e+s-d)}):$("#luckysheet-cell-selected-focus").show().css({left:d,width:u}):d+u>=e?d+u<e+s?$("#luckysheet-cell-selected-focus").show().css({left:d+s,width:e-d}):$("#luckysheet-cell-selected-focus").show().css({left:d+s,width:u-s}):$("#luckysheet-cell-selected-focus").show().css("left",d+s)}}}else f()},scrollAdaptOfchart:function(){let e=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft();if(null!=r.freezenhorizontaldata&&null!=r.freezenverticaldata){let t=r.freezenhorizontaldata[0]-r.freezenhorizontaldata[2],s=r.freezenverticaldata[0]-r.freezenverticaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(c,i){let o=$(i).position(),a=$(i).width(),n=$(i).height(),r=$(i).find("canvas").width(),h=$(i).find("canvas").height(),d=h-n,u=r-a;if(o.top-d<t){let l=t-(o.top-d);l>h+40+2?$(i).css("visibility","hidden"):($(i).css({top:t+e,height:h-l,visibility:"visible"}),$(i).find("canvas").css("top",-l))}else $(i).css({top:o.top-d+e,height:h,visibility:"visible"}),$(i).find("canvas").css("top",0);if(o.left-u<s){let e=s-(o.left-u);e>r+20+2?$(i).css("visibility","hidden"):($(i).css({left:s+l,width:r-e,visibility:"visible"}),$(i).find("canvas").css("left",-e))}else $(i).css({left:o.left-u+l,width:r,visibility:"visible"}),$(i).find("canvas").css("left",0)})}else if(null!=r.freezenhorizontaldata){let l=r.freezenhorizontaldata[0]-r.freezenhorizontaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(t,s){let c=$(s).position(),i=$(s).height(),o=$(s).find("canvas").height(),a=o-i;if(c.top-a<l){let t=l-(c.top-a);t>o+40+2?$(s).css("visibility","hidden"):($(s).css({top:l+e,height:o-t,visibility:"visible"}),$(s).find("canvas").css("top",-t))}else $(s).css({top:c.top-a+e,height:o,visibility:"visible"}),$(s).find("canvas").css("top",0)})}else if(null!=r.freezenverticaldata){let e=r.freezenverticaldata[0]-r.freezenverticaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(t,s){let c=$(s).position(),i=$(s).width(),o=$(s).find("canvas").width(),a=o-i;if(c.left-a<e){let t=e-(c.left-a);t>o+20+2?$(s).css("visibility","hidden"):($(s).css({left:e+l,width:o-t,visibility:"visible"}),$(s).find("canvas").css("left",-t))}else $(s).css({left:c.left-a+l,width:o,visibility:"visible"}),$(s).find("canvas").css("left",0)})}else $("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(t,s){let c=$(s).position(),i=$(s).width(),o=$(s).height(),a=$(s).find("canvas").width(),n=$(s).find("canvas").height(),r=n-o,h=a-i;$(s).css({top:c.top-r+e,height:n,left:c.left-h+l,width:a,visibility:"visible"}),$(s).find("canvas").css({top:0,left:0})})},scrollAdaptOfpostil:function(){let e=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft();if(null!=r.freezenhorizontaldata&&null!=r.freezenverticaldata){let t=r.freezenhorizontaldata[0],s=r.freezenverticaldata[0],c=e-r.freezenhorizontaldata[2],a=l-r.freezenverticaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(e,l){let n=$(l).attr("id"),h=n.split("luckysheet-postil-show_")[1].split("_")[0],d=n.split("luckysheet-postil-show_")[1].split("_")[1],u=r.flowdata[h][d].ps,f=r.visibledatarow[h],y=h-1==-1?0:r.visibledatarow[h-1],k=r.visibledatacolumn[d],v=d-1==-1?0:r.visibledatacolumn[d-1],w=i.mergeborer(r.flowdata,h,d);w&&(f=w.row[1],y=w.row[0],k=w.column[1],v=w.column[0]);let z=k,p=y,b=null==u.left?z+18:u.left,m=null==u.top?p-18:u.top,g=null==u.width?o.defaultWidth:u.width,_=null==u.height?o.defaultHeight:u.height;m<0&&(m=2);let x=o.getArrowCanvasSize(b,m,z,p),C=!0,H=!0;h>=r.freezenhorizontaldata[1]?m+_<t?($(l).show().find(".luckysheet-postil-show-main").css("top",m+c),$(l).show().find(".arrowCanvas").css("top",x[1]+c)):m<t+c?m+_<=t+c?C=!1:($(l).show().find(".luckysheet-postil-show-main").css({top:t+c,height:_-(t+c-m)}),$(l).show().find(".formulaInputFocus").css("margin-top",-(t+c-m)),$(l).show().find(".arrowCanvas").hide(),H=!1):($(l).show().find(".luckysheet-postil-show-main").css({top:m,height:_}),$(l).show().find(".formulaInputFocus").css("margin-top",0),$(l).show().find(".arrowCanvas").css("top",x[1])):($(l).show().find(".luckysheet-postil-show-main").css("top",m+c),$(l).show().find(".arrowCanvas").css("top",x[1]+c)),d>=r.freezenverticaldata[1]?b+g<s?($(l).show().find(".luckysheet-postil-show-main").css("left",b+a),$(l).show().find(".arrowCanvas").css("left",x[0]+a)):b<s+a?b+g<=s+a?C=!1:($(l).show().find(".luckysheet-postil-show-main").css({left:s+a,width:g-(s+a-b)}),$(l).show().find(".formulaInputFocus").css("margin-left",-(s+a-b)),$(l).show().find(".arrowCanvas").hide(),H=!1):($(l).show().find(".luckysheet-postil-show-main").css({left:b,width:g}),$(l).show().find(".formulaInputFocus").css("margin-left",0),$(l).show().find(".arrowCanvas").css("left",x[0])):($(l).show().find(".luckysheet-postil-show-main").css("left",b+a),$(l).show().find(".arrowCanvas").css("left",x[0]+a)),C||$(l).hide(),C&&H&&$(l).show().find(".arrowCanvas").show()})}else if(null!=r.freezenhorizontaldata){let l=r.freezenhorizontaldata[0],t=e-r.freezenhorizontaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(e,s){let c=$(s).attr("id"),a=c.split("luckysheet-postil-show_")[1].split("_")[0],n=c.split("luckysheet-postil-show_")[1].split("_")[1],h=r.flowdata[a][n].ps,d=r.visibledatarow[a],u=a-1==-1?0:r.visibledatarow[a-1],f=r.visibledatacolumn[n],y=n-1==-1?0:r.visibledatacolumn[n-1],k=i.mergeborer(r.flowdata,a,n);k&&(d=k.row[1],u=k.row[0],f=k.column[1],y=k.column[0]);let v=f,w=u,z=null==h.left?v+18:h.left,p=null==h.top?w-18:h.top,b=(null==h.width?o.defaultWidth:h.width,null==h.height?o.defaultHeight:h.height);p<0&&(p=2);let m=o.getArrowCanvasSize(z,p,v,w);a>=r.freezenhorizontaldata[1]?p+b<l?($(s).show().find(".luckysheet-postil-show-main").css("top",p+t),$(s).show().find(".arrowCanvas").css("top",m[1]+t)):p<l+t?p+b<=l+t?$(s).hide():($(s).show().find(".luckysheet-postil-show-main").css({top:l+t,height:b-(l+t-p)}),$(s).show().find(".formulaInputFocus").css("margin-top",-(l+t-p)),$(s).show().find(".arrowCanvas").hide()):o.buildPs(a,n,h):($(s).show().find(".luckysheet-postil-show-main").css("top",p+t),$(s).show().find(".arrowCanvas").css("top",m[1]+t))})}else if(null!=r.freezenverticaldata){let e=r.freezenverticaldata[0],t=l-r.freezenverticaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(l,s){let c=$(s).attr("id"),a=c.split("luckysheet-postil-show_")[1].split("_")[0],n=c.split("luckysheet-postil-show_")[1].split("_")[1],h=r.flowdata[a][n].ps,d=r.visibledatarow[a],u=a-1==-1?0:r.visibledatarow[a-1],f=r.visibledatacolumn[n],y=n-1==-1?0:r.visibledatacolumn[n-1],k=i.mergeborer(r.flowdata,a,n);k&&(d=k.row[1],u=k.row[0],f=k.column[1],y=k.column[0]);let v=f,w=u,z=null==h.left?v+18:h.left,p=null==h.top?w-18:h.top,b=null==h.width?o.defaultWidth:h.width;null==h.height?o.defaultHeight:h.height;p<0&&(p=2);let m=o.getArrowCanvasSize(z,p,v,w);n>=r.freezenverticaldata[1]?z+b<e?($(s).show().find(".luckysheet-postil-show-main").css("left",z+t),$(s).show().find(".arrowCanvas").css("left",m[0]+t)):z<e+t?z+b<=e+t?$(s).hide():($(s).show().find(".luckysheet-postil-show-main").css({left:e+t,width:b-(e+t-z)}),$(s).show().find(".formulaInputFocus").css("margin-left",-(e+t-z)),$(s).show().find(".arrowCanvas").hide()):o.buildPs(a,n,h):($(s).show().find(".luckysheet-postil-show-main").css("left",z+t),$(s).show().find(".arrowCanvas").css("left",m[0]+t))})}else $("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(e,l){let t=$(l).attr("id"),s=t.split("luckysheet-postil-show_")[1].split("_")[0],c=t.split("luckysheet-postil-show_")[1].split("_")[1],i=r.flowdata[s][c].ps;o.buildPs(s,c,i)})},scrollAdaptOfdpicon:function(){let e,l,t=a.copyRange.row[1],s=a.copyRange.column[1],c=a.applyRange.row[1],i=a.applyRange.column[1];if(c>=t&&i>=s?(e=c,l=i):(e=t,l=s),null!=r.freezenhorizontaldata&&null!=r.freezenverticaldata){let t=r.freezenhorizontaldata[1],s=u(r.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-r.freezenhorizontaldata[2]),c=r.freezenverticaldata[1],i=u(r.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-r.freezenverticaldata[2]);if(e>=t&&l>=c)e<t+s-1||l<c+i-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else if(e>=t)if(e<t+s-1)$("#luckysheet-dropCell-icon").hide();else{let e=v(l+i)[1];$("#luckysheet-dropCell-icon").show().css("left",e)}else if(l>=c)if(l<c+i-1)$("#luckysheet-dropCell-icon").hide();else{let l=k(e+s)[1];$("#luckysheet-dropCell-icon").show().css("top",l)}else{let t=k(e+s)[1],c=v(l+i)[1];$("#luckysheet-dropCell-icon").show().css({left:c,top:t})}}else if(null!=r.freezenhorizontaldata){let l=r.freezenhorizontaldata[1],t=u(r.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-r.freezenhorizontaldata[2]);if(e>=l)e<l+t-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else{let l=k(e+t)[1];$("#luckysheet-dropCell-icon").show().css("top",l)}}else if(null!=r.freezenverticaldata){let e=r.freezenverticaldata[1],t=u(r.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-r.freezenverticaldata[2]);if(l>=e)l<e+t-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else{let e=v(l+t)[1];$("#luckysheet-dropCell-icon").show().css("left",e)}}else{let t=k(e)[1],s=v(l)[1];$("#luckysheet-dropCell-icon").show().css({left:s,top:t})}},scrollAdaptOffilteroptions:function(){if(null!=r.freezenhorizontaldata&&null!=r.freezenverticaldata){let e=r.freezenhorizontaldata[1],l=r.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop(),t=r.freezenverticaldata[1],s=u(r.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-r.freezenverticaldata[2]);$("#luckysheet-filter-options-sheet"+r.currentSheetIndex+" .luckysheet-filter-options").each(function(c,i){let o=$(i).data("str"),a=o-1==-1?0:r.visibledatarow[o-1],n=$(i).data("cindex");if(o>=e&&n>=t)a<l||n<t+s?$(i).hide():$(i).show();else if(o>=e)if(a<l)$(i).hide();else{let e=r.visibledatacolumn[n+s]-20;$(i).show().css("left",e)}else if(n>=t)n<t+s?$(i).hide():$(i).show().css("top",a+$("#luckysheet-cell-main").scrollTop());else{let e=r.visibledatacolumn[n+s]-20;$(i).show().css({left:e,top:a+$("#luckysheet-cell-main").scrollTop()})}})}else if(null!=r.freezenhorizontaldata){let e=r.freezenhorizontaldata[1],l=r.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop();$("#luckysheet-filter-options-sheet"+r.currentSheetIndex+" .luckysheet-filter-options").each(function(t,s){let c=$(s).data("str"),i=c-1==-1?0:r.visibledatarow[c-1];c>=e?i<l?$(s).hide():$(s).show():$(s).show().css("top",i+$("#luckysheet-cell-main").scrollTop())})}else if(null!=r.freezenverticaldata){let e=r.freezenverticaldata[1],l=u(r.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-r.freezenverticaldata[2]);$("#luckysheet-filter-options-sheet"+r.currentSheetIndex+" .luckysheet-filter-options").each(function(t,s){let c=$(s).data("cindex");if(c>=e)c<e+l?$(s).hide():$(s).show();else{let e=r.visibledatacolumn[c+l]-20;$(s).show().css("left",e)}})}else $("#luckysheet-filter-options-sheet"+r.currentSheetIndex).empty(),y(r.luckysheetfile[d(r.currentSheetIndex)].filter_select)}});return r.onScrollFreezen=function(){luckysheetFreezens.scrollFreezen()},w});
//# sourceMappingURL=../sourcemaps/controllers/freezen.js.map
