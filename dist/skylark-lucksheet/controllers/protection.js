/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../store","../locale/locale","./constant","../methods/get","../methods/set","./sheetmanage","./resize","./dataVerificationCtrl","../utils/util","./select","../global/tooltip","../global/cleargridelement"],function(e,t,l,n,o,i,c,s,r,a,u,d){"use strict";const{modelHTML:h}=l,{getSheetIndex:p}=n,{setluckysheet_scroll_status:g}=o,{replaceHtml:k,transformRangeToAbsolute:y,openSelfModel:m}=r,{selectionCopyShow:f}=a;let v=!1,w=!1,x=[],b=!0,I=null,R=null,C=null,T=!0,P={},A=!1;const L=["selectLockedCells","selectunLockedCells","formatCells","formatColumns","formatRows","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","filter","usePivotTablereports","editObjects","editScenarios"];function N(e){const l=t(),n=l.protection,o=l.button;let i=e.name,c=e.sqref,s=e.password,r="";null!=s&&s.length>0&&(r='<i class="icon iconfont luckysheet-iconfont-bianji2" title="'+n.rangeItemHasPassword+'"></i>');let a=`\n        <div class="luckysheet-protection-rangeItem" title="${n.rangeItemDblclick}">\n            <div class="luckysheet-protection-rangeItem-del" title="${o.delete}">\n                <i class="icon iconfont luckysheet-iconfont-shanchu"></i>\n            </div>\n            <div class="luckysheet-protection-rangeItem-name" title="${i}">\n                ${i}${r}\n            </div>\n            <div class="luckysheet-protection-rangeItem-range" title="${c}">\n                ${c}\n            </div>\n            <div class="luckysheet-protection-rangeItem-update" title="${o.update}">\n                <i class="icon iconfont luckysheet-iconfont-bianji"></i>\n            </div>\n        </div>\n    `;$("#luckysheet-protection-rangeItem-container").append(a)}function H(e){if(w)return;w=!0;let l=t(),n=l.protection;const o=l.button;$("body").append(k(h,{id:"luckysheet-protection-rangeItem-dialog",addclass:"luckysheet-protection-rangeItem-dialog",title:n.allowRangeTitle,content:`\n            <div class="luckysheet-protection-rangeItem-content">\n                <div class="luckysheet-slider-protection-row">\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">\n                        ${n.allowRangeAddTitle}\n                    </div>\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">\n                        <input class="luckysheet-protection-rangeItemiInput" id="protection-allowRangeAdd-title"  placeHolder="${n.allowRangeAddtitleDefault}">\n                    </div>\n                </div>\n                <div class="luckysheet-slider-protection-row">\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">\n                        ${n.allowRangeAddSqrf}\n                    </div>\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">\n                        <div id="protection-allowRangeAdd-range" class="range">\n                            <input class="formulaInputFocus" spellcheck="false" placeHolder="${n.selectCellRangeHolder}">\n                            <i class="fa fa-table" aria-hidden="true" title="${n.selectCellRange}"></i>\n                        </div>\n                    </div>\n                </div>\n                <div class="luckysheet-slider-protection-row">\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">\n                        ${n.allowRangeAddTitlePassword}\n                    </div>\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">\n                        <input class="luckysheet-protection-rangeItemiInput" id="protection-allowRangeAdd-password"  placeHolder="${n.enterPassword}">\n                    </div>\n                </div>\n                <div class="luckysheet-slider-protection-row">\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">\n                        ${n.allowRangeAddTitleHint}\n                    </div>\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">\n                        <textarea class="luckysheet-protection-rangeItemTextarea" id="protection-allowRangeAdd-hint"  placeHolder="${n.allowRangeAddTitleHintTitle}"></textarea>\n                    </div>\n                </div>\n            </div>\n        `,botton:`<button id="luckysheet-protection-rangeItem-confirm" class="btn btn-primary">${o.insert}</button>\n                    <button class="btn btn-default luckysheet-model-close-btn">${o.cancel}</button>`,style:"z-index:100003"}))}function S(e){null==e&&(e={});for(let t=0;t<L.length;t++){let l=L[t],n="luckysheet-protection-check-"+l,o=e[l];null==o&&(o=0),null==o&&l in{selectLockedCells:1,selectunLockedCells:1}&&(o=1),$("#"+n).prop("checked",1==o)}null!=e.password&&e.password.length>0?"None"==e.algorithmName||null==e.algorithmName?$("#protection-password").val(e.password):$("#protection-password").val("••••••••"):$("#protection-password").val("");let t=e.sheet;null==e.sheet&&(t=0),$("#protection-swichProtectionState").prop("checked",1==t);let l=e.hintText;null==l&&(l=""),$("#protection-hint").val(l),x=[],$("#luckysheet-protection-rangeItem-container").empty();let n=e.allowRangeList;if(null!=n&&n.length>0)for(let e=0;e<n.length;e++){let t=n[e];N(t),x.push(t)}}function V(){$("#luckysheet-protection-rangeItem-dialog").hide(),$("#luckysheet-modal-dialog-slider-protection").hide(),c()}function _(e,t,l,n,o=!0){let i=!1,c=l.allowRangeList;if(null!=c&&c.length>0){let l=!1;for(let n=0;n<c.length;n++){let r=c[n],a=r.sqref,u=s.getRangeByTxt(a);if(u.length>0)for(let n=0;n<u.length;n++){let o=u[n].row[0],i=u[n].row[1],c=u[n].column[0],s=u[n].column[1];if(e>=o&&e<=i&&t>=c&&t<=s){l=!0;break}}if(l){let e=r.password;if(null!=e&&e.length>0&&!(a in P))return o&&(B(r),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide()),!1;i=!0;break}}}if(!i&&o){let e;e=null!=l.hintText&&l.hintText.length>0?l.hintText:n.defaultSheetHintText,u.info("",e),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide()}return i}function B(e){const l=t(),n=l.protection,o=l.button;A||$("body").append(k(h,{id:"luckysheet-protection-range-validation",addclass:"luckysheet-protection-sheet-validation",title:n.validationTitle,content:`\n                <div class="luckysheet-slider-protection-row">\n                    <div id="luckysheet-protection-range-validation-hint" class="luckysheet-slider-protection-column luckysheet-protection-column-10x">\n                        \n                    </div>\n                </div>\n                <div class="luckysheet-slider-protection-row" style="margin-top:20px">\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">\n                        <input type="password" class="luckysheet-protection-rangeItemiInput" placeHolder="${n.validationInputHint}">\n                    </div>\n                </div>\n            `,botton:`<button id="luckysheet-protection-range-validation-confirm" class="btn btn-primary">${o.confirm}</button>\n                        <button class="btn btn-default luckysheet-model-close-btn">${o.cancel}</button>`,style:"z-index:100003"})),A=!0,m("luckysheet-protection-range-validation");let i=$("#luckysheet-protection-range-validation-hint");null!=e.hintText&&e.hintText.length>0?i.html(e.hintText):i.html(n.defaultRangeHintText);let c=$("#luckysheet-protection-range-validation"),s=c.find("input");s.val(""),$("#luckysheet-protection-range-validation-confirm").off("click").on("click",function(){let t=s.val();if(null!=t&&0!=t.length){if(null!=e.algorithmName&&"None"!=e.algorithmName)if(null!=e.saltValue&&e.saltValue.length>0){var l=CryptoApi.getHasher(e.algorithmName);t=CryptoApi.hmac(e.saltValue,t,l)}else t=CryptoApi.hash(e.algorithmName,t);t==e.password?(P[e.sqref]=1,c.hide(),$("#luckysheet-modal-dialog-mask").hide(),alert(n.checkPasswordSucceedalert)):alert(n.checkPasswordWrongalert)}else alert(n.checkPasswordNullalert)})}return{openProtectionModal:function(l){if(v||(function(e){const l=t(),n=l.protection,o=l.button;let i="";for(let e=0;e<L.length;e++){let t=L[e];i+=`\n            <div class="luckysheet-slider-protection-row" style="height:18px;">\n                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">\n                <label for="luckysheet-protection-check-${t}"><input id="luckysheet-protection-check-${t}" name="luckysheet-protection-check-${t}" type="checkbox">${n[t]}</label>\n                </div>\n            </div>\n        `}const c=`\n    <div id="luckysheet-modal-dialog-slider-protection" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-pivot" style="display:none;">\n        <div class="luckysheet-modal-dialog-slider-title"> <span>${n.protectiontTitle}</span> <span id="luckysheet-modal-dialog-protection-close" title="${o.close}"><i class="fa fa-times" aria-hidden="true"></i></span> </div>\n        <div class="luckysheet-modal-dialog-slider-content">\n            <div class="luckysheet-slider-protection-config" style="top:10px;height:115px">\n                <div class="luckysheet-slider-protection-row">\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">\n                    <label for="protection-swichProtectionState"><input id="protection-swichProtectionState" name="protection-swichProtectionState" type="checkbox">${n.swichProtectionTip}</label>\n                    </div>\n                </div>\n                <div class="luckysheet-slider-protection-row" style="height:23px;">\n                    <div class="luckysheet-slider-protection-column" style="width:98%;">\n                        <input class="luckysheet-protection-input" id="protection-password"  placeHolder="${n.enterPassword}">\n                    </div>\n                </div>\n                <div class="luckysheet-slider-protection-row" style="height:47px;margin-top:4px;">\n                    <div class="luckysheet-slider-protection-column" style="width:98%;">\n                        <textarea class="luckysheet-protection-textarea" id="protection-hint"  placeHolder="${n.enterHintTitle}"></textarea>\n                    </div>\n                </div>\n            </div>\n            <div class="luckysheet-slider-protection-config" style="top:130px;height:290px;border-top:1px solid #c5c5c5">\n                <div class="luckysheet-slider-protection-row" style="height:20px;">\n                    ${n.authorityTitle}\n                </div>\n                ${i}\n            </div>\n            <div class="luckysheet-slider-protection-config" style="top:440px;bottom:45px;border-top:1px solid #c5c5c5">\n                <div class="luckysheet-slider-protection-row" style="height:25px;">\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:0px;line-height: 25px;">\n                        ${n.allowRangeTitle}\n                    </div>\n                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x" style="left:70%;">\n                        <div class="luckysheet-slider-protection-ok luckysheet-slider-protection-addRange" id="luckysheet-slider-protection-addRange">\n                            ${n.allowRangeAdd}\n                        </div>\n                    </div>\n                </div>\n\n                <div id="luckysheet-protection-rangeItem-container" class="luckysheet-slider-protection-row" style="top:25px;bottom:0px;position:absolute">\n                   \n                </div>\n            </div>\n            <div class="luckysheet-slider-protection-config" style="bottom:0px;height:45px">\n                <div class="luckysheet-slider-protection-column luckysheet-protection-column-5x" style="left:0px;">\n                    <div class="luckysheet-slider-protection-ok" id="luckysheet-slider-protection-ok">\n                        ${o.confirm}\n                    </div>\n                </div>\n                <div class="luckysheet-slider-protection-column luckysheet-protection-column-5x" style="left:50%;">\n                    <div class="luckysheet-slider-protection-cancel" id="luckysheet-slider-protection-cancel">\n                        ${o.cancel}\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    `;$("body").append(c),$("body").append(k(h,{id:"luckysheet-protection-sheet-validation",addclass:"luckysheet-protection-sheet-validation",title:n.validationTitle,content:`\n            <div class="luckysheet-slider-protection-row">\n                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">\n                    ${n.validationTips}\n                </div>\n            </div>\n            <div class="luckysheet-slider-protection-row" style="margin-top:20px">\n                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">\n                    <input type="password" class="luckysheet-protection-rangeItemiInput" placeHolder="${n.validationInputHint}">\n                </div>\n            </div>\n        `,botton:`<button id="luckysheet-protection-sheet-validation-confirm" class="btn btn-primary">${o.confirm}</button>\n                    <button class="btn btn-default luckysheet-model-close-btn">${o.cancel}</button>`,style:"z-index:100003"}))}(),function(l){const n=t(),o=n.protection,i=n.button;$("#luckysheet-slider-protection-ok").click(function(){let e=$("#protection-password").val(),t=$("#protection-swichProtectionState").is(":checked"),l=$("#protection-hint").val(),n=C,o={};null!=n&&null!=n.config&&null!=n.config.authority&&(o=n.config.authority);let i={};"••••••••"!=e?(i.password=e,i.algorithmName="None",i.saltValue=null):null!=o?(i.algorithmName=o.algorithmName,i.saltValue=o.saltValue,i.password=o.password):(i.algorithmName="None",i.saltValue=null,i.password=""),i.hintText=l,i.sheet=1==t?1:0;for(let e=0;e<L.length;e++){let t=L[e],l=$("#luckysheet-protection-check-"+t).is(":checked");i[t]=1==l?1:0}i.allowRangeList=x,x=[],T=!0,null==n.config&&(n.config={}),n.config.authority=i,P={},V()}),$("#luckysheet-slider-protection-cancel, #luckysheet-modal-dialog-protection-close").click(function(){V()}),$("#luckysheet-slider-protection-addRange").click(function(){H(),b=!0,$("#luckysheet-protection-rangeItem-confirm").html(i.insert),m("luckysheet-protection-rangeItem-dialog"),$("#protection-allowRangeAdd-title").val("Default"+x.length),$("#protection-allowRangeAdd-range input").val(""),$("#protection-allowRangeAdd-password").val(""),$("#protection-allowRangeAdd-hint").val("")}),$(document).off("click.luckysheetProtection.rangeItemUpdate").on("click.luckysheetProtection.rangeItemUpdate","#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-update",function(e){H(),b=!1,$("#luckysheet-protection-rangeItem-confirm").html(i.update),m("luckysheet-protection-rangeItem-dialog");let t=$(e.target).closest(".luckysheet-protection-rangeItem"),l=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").index(t),n=x[l];I=l,$("#protection-allowRangeAdd-title").val(n.name),$("#protection-allowRangeAdd-range input").val(n.sqref),"None"==n.algorithmName?$("#protection-allowRangeAdd-password").val(n.password):$("#protection-allowRangeAdd-password").val("••••••••"),$("#protection-allowRangeAdd-hint").val(n.hintText)}),$(document).off("click.luckysheetProtection.rangeItemDelete").on("click.luckysheetProtection.rangeItemDelete","#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-del",function(e){let t=$(e.target).closest(".luckysheet-protection-rangeItem"),l=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").index(t);x[l],x.splice(l,1),t.remove()}),$(document).off("click.luckysheetProtection.rangeItemConfirm").on("click.luckysheetProtection.rangeItemConfirm","#luckysheet-protection-rangeItem-confirm",function(){let e=$("#protection-allowRangeAdd-title").val(),t=$("#protection-allowRangeAdd-range input").val(),l=$("#protection-allowRangeAdd-password").val(),n=$("#protection-allowRangeAdd-hint").val();if(0==e.length)return void alert(o.rangeItemErrorTitleNull);let i=s.getRangeByTxt(t);if(0!=t.length)if(0!=i.length){if(t=y(t),b){let o={name:e,password:l,hintText:n,algorithmName:"None",saltValue:null,checkRangePasswordUrl:null,sqref:t};N(o),x.push(o)}else{let i=I,c=x[i];c.name=e,c.sqref=t,c.hintText=n,"••••••••"!=l&&(c.password=l,c.algorithmName="None");let s=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").eq(i),r=s.find(".luckysheet-protection-rangeItem-name"),a="";null!=l&&l.length>0&&(a='<i class="icon iconfont luckysheet-iconfont-bianji2" title="'+o.rangeItemHasPassword+'"></i>'),r.html(e+a).attr("title",e),s.find(".luckysheet-protection-rangeItem-range").html(t).attr("title",t)}$("#luckysheet-protection-rangeItem-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide()}else alert(o.rangeItemErrorRange);else alert(o.rangeItemErrorRangeNull)}),$(document).off("click.luckysheetProtection.validationConfirm").on("click.luckysheetProtection.validationConfirm","#luckysheet-protection-sheet-validation-confirm",function(e){let t=$("#luckysheet-protection-sheet-validation"),l=R;if(null==l)return S(R),t.hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-protection").show(),void c();let n=t.find("input").val();if(null!=n&&0!=n.length){if(null!=l.algorithmName&&"None"!=l.algorithmName)if(null!=l.saltValue&&l.saltValue.length>0){var i=CryptoApi.getHasher(l.algorithmName);n=CryptoApi.hmac(l.saltValue,n,i)}else n=CryptoApi.hash(l.algorithmName,n);n==l.password?(S(R),t.hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-protection").show(),c(),T=!1):alert(o.checkPasswordWrongalert)}else alert(o.checkPasswordNullalert)}),$("#luckysheet-protection-check-selectLockedCells").change(function(){let e=$("#luckysheet-protection-check-selectLockedCells"),t=$("#luckysheet-protection-check-selectunLockedCells"),l=e.is(":checked");t.is(":checked"),l&&t.prop("checked",!0)}),$("#luckysheet-protection-check-selectunLockedCells").change(function(){let e=$("#luckysheet-protection-check-selectLockedCells"),t=$("#luckysheet-protection-check-selectunLockedCells");e.is(":checked"),t.is(":checked")||e.prop("checked",!1)}),$(document).off("click.luckysheetProtection.dvRange").on("click.luckysheetProtection.dvRange","#protection-allowRangeAdd-range .fa-table",function(t){$("#luckysheet-protection-rangeItem-dialog").hide();let l=$(this).siblings("input").val().trim();s.rangeDialog("0",l),s.selectRange=[];let n=s.getRangeByTxt(l);if(n.length>0)for(let t=0;t<n.length;t++){let l=n[t].row[0],o=n[t].row[1],i=n[t].column[0],c=n[t].column[1],r=e.visibledatarow[o],a=l-1==-1?0:e.visibledatarow[l-1],u=e.visibledatacolumn[c],d=i-1==-1?0:e.visibledatacolumn[i-1];s.selectRange.push({left:d,width:u-d-1,top:a,height:r-a-1,left_move:d,width_move:u-d-1,top_move:a,height_move:r-a-1,row:[l,o],column:[i,c],row_focus:l,column_focus:i})}f(s.selectRange)}),$(document).off("click.luckysheetProtection.dvRange2").on("click.luckysheetProtection.dvRange2","#luckysheet-protection-rangeItem-dialog .show-box-item-dropdown .range .fa-table",function(t){$("#luckysheet-protection-rangeItem-dialog").hide();let l=$(this).siblings("input").val().trim();s.rangeDialog("1",l),s.selectRange=[];let n=s.getRangeByTxt(l);if(n.length>0)for(let t=0;t<n.length;t++){let l=n[t].row[0],o=n[t].row[1],i=n[t].column[0],c=n[t].column[1],r=e.visibledatarow[o],a=l-1==-1?0:e.visibledatarow[l-1],u=e.visibledatacolumn[c],d=i-1==-1?0:e.visibledatacolumn[i-1];s.selectRange.push({left:d,width:u-d-1,top:a,height:r-a-1,left_move:d,width_move:u-d-1,top_move:a,height_move:r-a-1,row:[l,o],column:[i,c],row_focus:l,column_focus:i})}f(s.selectRange)}),$(document).off("click.luckysheetProtection.dvRangeConfirm").on("click.luckysheetProtection.dvRangeConfirm","#luckysheet-dataVerificationRange-dialog-confirm",function(e){let t=$(this).parents("#luckysheet-dataVerificationRange-dialog").find("input").val(),l=$("#protection-allowRangeAdd-range input"),n=l.val();","==n.substr(n.length-1,1)?l.val(n+t):l.val(t),$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),f([])}),$(document).off("click.luckysheetProtection.dvRangeClose").on("click.dvRangeClose","#luckysheet-dataVerificationRange-dialog-close",function(e){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),f([])}),$(document).on("click.luckysheetProtection.luckysheetProtection","#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close",function(e){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),f([])})}(),v=!0),C=l,null!=l&&null!=l.config&&null!=l.config.authority){let e=l.config.authority;if(T&&1==e.sheet&&null!=e.password&&e.password.length>0)return R=e,$("#luckysheet-protection-sheet-validation input").val(""),void m("luckysheet-protection-sheet-validation");S(e)}else $("#luckysheet-protection-check-selectLockedCells").prop("checked",!0),$("#luckysheet-protection-check-selectunLockedCells").prop("checked",!0);$("#luckysheet-modal-dialog-slider-protection").show(),c()},closeProtectionModal:V,checkProtectionNotEnable:function(e){let l=i.getSheetByIndex(e);if(null==l)return!0;if(null==l.config||null==l.config.authority)return!0;let n=l.config.authority;if(null==n||null==n.sheet||0==n.sheet)return!0;const o=t().protection;let c;return c=null!=n.hintText&&n.hintText.length>0?n.hintText:o.defaultSheetHintText,u.info("",c),!1},checkProtectionLocked:function(e,l,n){let o=i.getSheetByIndex(n);if(null==o)return!0;if(null==o.config||null==o.config.authority)return!0;let c=o.data[e][l],s=o.config.authority;return null==s||null==s.sheet||0==s.sheet||!(!c||c.lo)||_(e,l,s,t().protection)},checkProtectionCellHidden:function(e,t,l){let n=i.getSheetByIndex(l);if(!n||!n.data[e]||!n.data[e][t])return!0;if(null==n.config||null==n.config.authority)return!0;let o=n.data[e][t],c=n.config.authority;return null==c||null==c.sheet||0==c.sheet||null==o||null==o.hi||0==o.hi},checkProtectionLockedRangeList:function(e,l){if(e[0].column[0]!==e[0].column[1])return!0;let n=i.getSheetByIndex(l);if(null==n)return!0;if(null==n.config||null==n.config.authority)return!0;let o=n.config.authority;if(null==o||null==o.sheet||0==o.sheet)return!0;if(null==e||0==e.length)return!0;let c=n.data[e[0].row[0]][e[0].column[0]];if(c&&!c.lo)return!0;const s=t().protection;for(let t=0;t<e.length;t++){let l=e[t].row[0],n=e[t].row[1],i=e[t].column[0],c=e[t].column[1];for(let e=l;e<=n;e++)for(let t=i;t<=c;t++)if(0==_(e,t,o,s))return!1}return!0},checkProtectionSelectLockedOrUnLockedCells:function(e,l,n){const o=t().protection;let c=i.getSheetByIndex(n);if(null==c)return!0;if(null==c.config||null==c.config.authority)return!0;let s=c.data[e][l],r=c.config.authority;return null==r||null==r.sheet||0==r.sheet||(s&&!s.lo?1==r.selectunLockedCells||null==r.selectunLockedCells:_(e,l,r,o,!1)?1==r.selectunLockedCells||null==r.selectunLockedCells:1==r.selectLockedCells||null==r.selectLockedCells)},checkProtectionAllSelected:function(e){t().protection;let l=i.getSheetByIndex(e);if(null==l)return!0;if(null==l.config||null==l.config.authority)return!0;let n=l.config.authority;if(null==n||null==n.sheet||0==n.sheet)return!0;let o=!1;1!=n.selectunLockedCells&&null!=n.selectunLockedCells||(o=!0);let c=!1;return 1!=n.selectLockedCells&&null!=n.selectLockedCells||(c=!0),!(!o||!c)},checkProtectionFormatCells:function(e){let l=i.getSheetByIndex(e);if(null==l)return!0;if(null==l.config||null==l.config.authority)return!0;let n=l.config.authority;if(null==n||null==n.sheet||0==n.sheet)return!0;if(1==n.formatCells||null==n.formatCells)return!0;const o=t().protection;let c;return c=null!=n.hintText&&n.hintText.length>0?n.hintText:o.defaultSheetHintText,u.info("",c),!1},checkProtectionAuthorityNormal:function(e,l="formatColumns",n=!0){let o=i.getSheetByIndex(e);if(null==o)return!0;if(null==o.config||null==o.config.authority)return!0;let c=o.config.authority;if(null==c||null==c.sheet||0==c.sheet)return!0;if(1==c[l]||null==c[l])return!0;if(n){const e=t().protection;let l;l=null!=c.hintText&&c.hintText.length>0?c.hintText:e.defaultSheetHintText,u.info("",l)}return!1}}});
//# sourceMappingURL=../sourcemaps/controllers/protection.js.map
