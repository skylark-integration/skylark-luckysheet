/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./luckysheetConfigsetting","./freezen","../global/refresh","../store","../locale/locale","./sheetmanage","../global/tooltip"],function(e,t,o,i,l,n,s){"use strict";const{luckysheetrefreshgrid:c}=o;let h=0,r=0;return function(t=!0){e.showinfobar?($("#luckysheet_info_detail").show(),i.infobarHeight=document.querySelector("#luckysheet_info_detail").offsetHeight):(i.infobarHeight=0,$("#luckysheet_info_detail").hide()),i.toobarObject&&i.toobarObject.toobarElements&&0===i.toobarObject.toobarElements.length?($("#"+i.container).find(".luckysheet-wa-editor").hide(),i.toolbarHeight=0):($("#"+i.container).find(".luckysheet-wa-editor").show(),i.toolbarHeight=document.querySelector("#"+i.container+" .luckysheet-wa-editor").offsetHeight),function(){if(!e.initShowsheetbarConfig){e.initShowsheetbarConfig=!0;const t={add:!0,menu:!0,sheet:!0};if(!e.showsheetbar)for(let e in t)t[e]=!1;"{}"!==JSON.stringify(e.showsheetbarConfig)&&Object.assign(t,e.showsheetbarConfig),e.showsheetbarConfig=t}const t=e.showsheetbarConfig;let o=0;for(let e in t)if(!t[e])switch(e){case"add":$("#luckysheet-sheets-add").hide(),o++;break;case"menu":$("#luckysheet-sheets-m").hide(),o++;break;case"sheet":$("#luckysheet-sheet-container").hide(),$("#luckysheet-sheets-leftscroll").hide(),$("#luckysheet-sheets-rightscroll").hide(),o++}3===o?($("#"+i.container).find("#luckysheet-sheet-area").hide(),i.sheetBarHeight=0):($("#"+i.container).find("#luckysheet-sheet-area").show(),i.sheetBarHeight=31)}(),function(){if(!e.initStatisticBarConfig){e.initStatisticBarConfig=!0;const t={count:!0,view:!0,zoom:!0};if(!e.showstatisticBar)for(let e in t)t[e]=!1;"{}"!==JSON.stringify(e.showstatisticBarConfig)&&Object.assign(t,e.showstatisticBarConfig),e.showstatisticBarConfig=t}const t=e.showstatisticBarConfig;let o=0;for(let e in t)if(!t[e])switch(e){case"count":$("#luckysheet-sta-content").hide(),o++;break;case"view":$(".luckysheet-print-viewList").hide(),o++;break;case"zoom":$("#luckysheet-zoom-content").hide(),o++}3===o?($("#"+i.container).find(".luckysheet-stat-area").hide(),i.statisticBarHeight=0):($("#"+i.container).find(".luckysheet-stat-area").show(),i.statisticBarHeight=23)}();const o=document.querySelector("#"+i.container+" .luckysheet-wa-calculate");e.sheetFormulaBar?(o.style.display="block",i.calculatebarHeight=o.offsetHeight):(o.style.display="none",i.calculatebarHeight=0),$("#"+i.container).find(".luckysheet-grid-container").css("top",i.toolbarHeight+i.infobarHeight+i.calculatebarHeight),h=$("#"+i.container).width(),e.showConfigWindowResize&&($("#luckysheet-modal-dialog-slider-pivot").is(":visible")?h-=$("#luckysheet-modal-dialog-slider-pivot").outerWidth():$(".chartSetting").is(":visible")?h-=$(".chartSetting").outerWidth():$("#luckysheet-modal-dialog-slider-alternateformat").is(":visible")&&(h-=$("#luckysheet-modal-dialog-slider-alternateformat").outerWidth()),$("#luckysheet-modal-dialog-slider-protection").is(":visible")&&(h-=$("#luckysheet-modal-dialog-slider-protection").outerWidth()));const u=l().toolbar;let d=!1,b=`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${u.toolMoreTip}" id="luckysheet-icon-morebtn" role="button" style="user-select: none;"> \n            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> \n                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;">\n\n                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">\n                        ${u.toolMore}\n                    </div> \n                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige" style="user-select: none;font-size:12px;">\n                    </div>\n\n                </div> \n            </div>\n         </div>`,y='<div id="luckysheet-icon-morebtn-div" class="luckysheet-wa-editor" style="position:absolute;top:'+(i.infobarHeight+i.toolbarHeight+$("#"+i.container).offset().top+$("body").scrollTop())+'px; right:0px;z-index:1003;padding:5.5px;display:none;height:auto;white-space:initial;"></div>';0==$("#luckysheet-icon-morebtn-div").length&&$("body").append(y),$("#luckysheet-icon-morebtn-div").hide(),$("#luckysheet-icon-morebtn-div > div").each(function(){const e=$(this)[0],t=$("#luckysheet-wa-editor")[0];t.appendChild(document.createTextNode(" ")),t.appendChild(e)}),$("#luckysheet-icon-morebtn").remove();const k=i.toobarObject.toobarWidths,f=i.toobarObject.toobarElements;let g=0;if(void 0!=k){for(let e=k.length-1;e>=0;e--)if(k[e]<h-90){(g=e)<k.length-1&&(d=!0);break}for(let e=g;e<f.length;e++){const t=f[e];if(t instanceof Array)for(const e of t)$("#luckysheet-icon-morebtn-div").append($(`${e}`));else $("#luckysheet-icon-morebtn-div").append($(`${t}`))}d&&($("#luckysheet-wa-editor").append(b),$("#luckysheet-icon-morebtn").click(function(){let e=$(window).width()-$("#luckysheet-icon-morebtn").offset().left-$("#luckysheet-icon-morebtn").width()+$("body").scrollLeft();if($("#luckysheet-icon-morebtn-div").toggle().css("right",e<0?0:e),$(this).find(".luckysheet-toolbar-menu-button-caption").text().indexOf(u.toolMore)>-1){const e=`\n                <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">\n                    ${u.toolClose}\n                </div> \n                <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-shangyige" style="user-select: none;font-size:12px;">\n                </div>\n                `;$(this).find(".luckysheet-toolbar-button-inner-box").html(e)}else{const e=`\n                <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">\n                    ${u.toolMore}\n                </div> \n                <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige" style="user-select: none;font-size:12px;">\n                </div>\n                `;$(this).find(".luckysheet-toolbar-button-inner-box").html(e)}}),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".luckysheet-toolbar-button-split-right").addClass("luckysheet-toolbar-button-split-right-hover")},function(){$(this).next(".luckysheet-toolbar-button-split-right").removeClass("luckysheet-toolbar-button-split-right-hover")}),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".luckysheet-toolbar-button-split-left").addClass("luckysheet-toolbar-button-hover")},function(){$(this).prev(".luckysheet-toolbar-button-split-left").removeClass("luckysheet-toolbar-button-hover")}),s.createHoverTip("#luckysheet-icon-morebtn-div",".luckysheet-toolbar-menu-button, .luckysheet-toolbar-button, .luckysheet-toolbar-combo-button")),$("#"+i.container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".luckysheet-toolbar-button-split-right").addClass("luckysheet-toolbar-button-split-right-hover")},function(){$(this).next(".luckysheet-toolbar-button-split-right").removeClass("luckysheet-toolbar-button-split-right-hover")}),$("#"+i.container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".luckysheet-toolbar-button-split-left").addClass("luckysheet-toolbar-button-hover")},function(){$(this).prev(".luckysheet-toolbar-button-split-left").removeClass("luckysheet-toolbar-button-hover")}),r=$("#"+i.container).height(),$("#"+i.container).find(".luckysheet").height(r-2).width(h-2),a(h,r),t&&c($("#luckysheet-cell-main").scrollLeft(),$("#luckysheet-cell-main").scrollTop()),n.sheetArrowShowAndHide(),n.sheetBarShowAndHide()}};function a(e,o){null==e&&(e=$("#"+i.container).width()),null==o&&(o=$("#"+i.container).height()),i.cellmainHeight=o-(i.infobarHeight+i.toolbarHeight+i.calculatebarHeight+i.columnHeaderHeight+i.sheetBarHeight+i.statisticBarHeight),i.cellmainWidth=e-i.rowHeaderWidth,$("#luckysheet-cols-h-c, #luckysheet-cell-main").width(i.cellmainWidth),$("#luckysheet-cell-main").height(i.cellmainHeight),$("#luckysheet-rows-h").height(i.cellmainHeight-i.cellMainSrollBarSize),$("#luckysheet-scrollbar-y").height(i.cellmainHeight+i.columnHeaderHeight-i.cellMainSrollBarSize-3),$("#luckysheet-scrollbar-x").height(i.cellMainSrollBarSize),$("#luckysheet-scrollbar-y").width(i.cellMainSrollBarSize),$("#luckysheet-scrollbar-x").width(i.cellmainWidth).css("left",i.rowHeaderWidth-2),i.luckysheetTableContentHW=[i.cellmainWidth+i.rowHeaderWidth-i.cellMainSrollBarSize,i.cellmainHeight+i.columnHeaderHeight-i.cellMainSrollBarSize],$("#luckysheetTableContent, #luckysheetTableContentF").attr({width:Math.ceil(i.luckysheetTableContentHW[0]*i.devicePixelRatio),height:Math.ceil(i.luckysheetTableContentHW[1]*i.devicePixelRatio)}).css({width:i.luckysheetTableContentHW[0],height:i.luckysheetTableContentHW[1]}),$("#"+i.container).find("#luckysheet-grid-window-1").css("bottom",i.sheetBarHeight),$("#"+i.container).find(".luckysheet-grid-window").css("bottom",i.statisticBarHeight);let l=$("#luckysheet-grid-window-1").width();$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:l-10}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:l-10});let n=$("#luckysheet-grid-window-1").height();$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:n-10}).end().find(".luckysheet-freezebar-vertical-drop").css({height:n-10}),t.createAssistCanvas()}});
//# sourceMappingURL=../sourcemaps/controllers/resize.js.map
