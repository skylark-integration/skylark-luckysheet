/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-pako","skylark-localForage","../widgets/loading","../widgets/constant","../methods/sheets","../methods/cells","./filter","./freezen","./postil","../widgets/imageCtrl","../widgets/dataVerificationCtrl","../widgets/hyperlinkCtrl","../utils/util","../methods/get","../store","../widgets/select","../locale/locale","skylark-moment","../methods/json"],function(e,t,l,i,n,a,o,r,s,c,u,h,d,f,m,p,g,k,y){"use strict";const{showloading:v,hideloading:w}=l,{sheetHTML:x,luckyColor:b}=i,{createFilterOptions:I}=o,{getObjType:S,replaceHtml:E,getByteLen:T}=d,{getSheetIndex:C}=f,{collaborativeEditBox:_}=p,z={retryTimer:null,wxErrorCount:0,openWebSocket:function(){let e=this;if("WebSocket"in window){let t=e.updateUrl+"?t=111&g="+encodeURIComponent(e.gridKey);e.updateUrl.indexOf("?")>-1&&(t=e.updateUrl+"&t=111&g="+encodeURIComponent(e.gridKey)),m.websocket=new WebSocket(t),m.websocket.onopen=function(){console.info(g().websocket.success),w(),e.wxErrorCount=0,e.retryTimer=setInterval(function(){m.websocket.send("rub")},6e4)},m.websocket.onmessage=function(t){m.result=t;let l=new Function("return "+t.data)();console.info(l);let i=l.type,{message:n,id:a}=l;if("用户退出"===n&&($("#luckysheet-multipleRange-show-"+a).hide(),m.cooperativeEdit.changeCollaborationSize=m.cooperativeEdit.changeCollaborationSize.filter(e=>e.id!=a),m.cooperativeEdit.checkoutData=m.cooperativeEdit.checkoutData.filter(e=>e.id!=a)),1==i);else if(2==i){let t=JSON.parse(l.data);e.wsUpdateMsg(t);let i=JSON.parse(l.data);"columnlen"==i.k?_(i.v,null):"rowlen"==i.k&&_(null,i.v)}else if(3==i){let t=l.id,i=l.username,n=JSON.parse(l.data),a=(n.t,n.i),o=n.v;0===m.cooperativeEdit.changeCollaborationSize.length&&m.cooperativeEdit.changeCollaborationSize.push({id:t,v:n.v[0],i:a}),m.cooperativeEdit.changeCollaborationSize.some(e=>e.id==t)?m.cooperativeEdit.changeCollaborationSize.forEach(e=>{e.id==t&&(e.v=n.v[0],e.i=a)}):m.cooperativeEdit.changeCollaborationSize.push({id:t,v:n.v[0],i:a}),"array"!=S(o)&&"object"!==S(o)&&(o=JSON.parse(o));let r=0,s=0;if(a==m.currentSheetIndex?"object"===S(o)&&"enterEdit"===o.op?(r=o.range[o.range.length-1].row[0],s=o.range[o.range.length-1].column[0],e.multipleRangeShow(t,i,r,s,o.op)):(r=o[o.length-1].row[0],s=o[o.length-1].column[0],e.multipleRangeShow(t,i,r,s)):"object"===S(o)&&"enterEdit"===o.op?(r=o.range[o.range.length-1].row[0],s=o.range[o.range.length-1].column[0]):(r=o[o.length-1].row[0],s=o[o.length-1].column[0]),0===m.cooperativeEdit.checkoutData.length&&(o.op?m.cooperativeEdit.checkoutData.push({id:t,username:i,r:r,c:s,op:o.op,index:a}):m.cooperativeEdit.checkoutData.push({id:t,username:i,r:r,c:s,index:a})),m.cooperativeEdit.checkoutData.some(e=>e.id==t)?m.cooperativeEdit.checkoutData.forEach(e=>{e.id==t&&(e.username=i,e.r=r,e.c=s,e.index=a,"enterEdit"===o.op&&(e.op=o.op))}):"enterEdit"===o.op?m.cooperativeEdit.checkoutData.push({id:t,username:i,r:r,c:s,op:o.op,index:a}):m.cooperativeEdit.checkoutData.push({id:t,username:i,r:r,c:s,index:a}),m.cooperativeEdit.checkoutData.forEach(e=>{e.index!=m.currentSheetIndex&&($("#luckysheet-multipleRange-show-"+e.id).hide(),e.op)}),$("#luckysheet-multipleRange-show-"+t)[0]){let e=$("#luckysheet-multipleRange-show-"+t)[0].offsetHeight-1;$("#luckysheet-multipleRange-show-"+t+">.username").css({bottom:e+"px"})}}else if(4==i){let t=""===l.data?l.data:JSON.parse(l.data);for(let l=0;l<t.length;l++)e.wsUpdateMsg(item[l])}},m.websocket.onerror=function(){e.wxErrorCount++,e.wxErrorCount>3?v(g().websocket.refresh):(v(g().websocket.wait),e.openWebSocket())},m.websocket.onclose=function(t){console.info(g().websocket.close),1e3===t.code?(clearInterval(e.retryTimer),e.retryTimer=null):alert(g().websocket.contact)}}else alert(g().websocket.support)},wsUpdateMsg:function(e){let t=e.t,l=e.i,i=e.v,a=m.luckysheetfile[C(l)];if(!["v","rv","cg","all","fc","drc","arc","f","fsc","fsr","sh","c"].includes(t)||null!=a)if("v"==t){if(null==a.data||0==a.data.length)return;let t=e.r,n=e.c;a.data[t][n]=i,l==m.currentSheetIndex&&(m.flowdata=a.data,m.webWorkerFlowDataCache(m.flowdata),null!=i&&null!=i.ps?s.buildPs(t,n,i.ps):s.buildPs(t,n,null),m.refresh())}else if("rv"==t){if(Object.keys(e.range).length>0&&(m.cooperativeEdit.merge_range=e.range,m.cooperativeEdit.merge_range.v=e.v,_()),null==a.data||0==a.data.length)return;let t=e.range.row[0],n=e.range.row[1],o=e.range.column[0],r=e.range.column[1];for(let e=t;e<=n;e++)for(let l=o;l<=r;l++)a.data[e][l]=i[e-t][l-o];if(l==m.currentSheetIndex){m.flowdata=a.data,m.webWorkerFlowDataCache(m.flowdata);for(let e=t;e<=n;e++)for(let l=o;l<=r;l++)null!=i[e-t][l-o]&&null!=i[e-t][l-o].ps?s.buildPs(e,l,i[e-t][l-o].ps):s.buildPs(e,l,null);m.refresh()}}else if("cg"==t){let t=e.k;if("borderInfo"==t)a.config.borderInfo=i;else{t in a.config||(a.config[t]={});for(let e in i)a.config[t][e]=i[e]}l==m.currentSheetIndex&&(m.config=a.config,"rowlen"!=t&&"columnlen"!=t&&"rowhidden"!=t||m.refreshGrid_rhcw(m.flowdata.length,m.flowdata[0].length),m.refresh())}else if("all"==t){let t=e.k;if(a[t]=i,"name"==t)$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+l).find("span.luckysheet-sheets-item-name").html(i);else if("color"==t){let e=$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+l);e.find(".luckysheet-sheets-item-color").remove(),null==i&&""==i||e.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+i+';"></div>')}else if("pivotTable"==t);else if("frozen"==t){if(r.frozenTofreezen(),l==m.currentSheetIndex){const e=g().freezen;null==a.freezen.horizontal?($("#luckysheet-freezen-btn-horizontal").html('<i class="fa fa-list-alt"></i> '+e.freezenRow),m.freezenhorizontaldata=null,$("#luckysheet-freezebar-horizontal").hide()):r.createFreezenHorizontal(a.freezen.horizontal.freezenhorizontaldata,a.freezen.horizontal.top),null==a.freezen.vertical?($("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> '+e.freezenColumn),m.freezenverticaldata=null,$("#luckysheet-freezebar-vertical").hide()):r.createFreezenVertical(a.freezen.vertical.freezenverticaldata,a.freezen.vertical.left),r.createAssistCanvas()}}else"filter_select"==t?l==m.currentSheetIndex&&I(i):"filter"==t?l==m.currentSheetIndex&&I(a.filter_select,i):"luckysheet_conditionformat_save"==t?l==m.currentSheetIndex&&m.refresh():"luckysheet_alternateformat_save"==t?l==m.currentSheetIndex&&m.refresh():"config"==t?l==m.currentSheetIndex&&(m.config=i,m.refreshGrid_rhcw(m.flowdata.length,m.flowdata[0].length)):"dynamicArray"==t?m.refresh():"images"==t?l==m.currentSheetIndex&&(c.images=i,c.allImagesShow(),c.init()):"dataVerification"==t?l==m.currentSheetIndex&&(m.dataVerification=i,u.init()):"hyperlink"==t&&l==m.currentSheetIndex&&(h.hyperlink=i,h.init())}else if("fc"==t){let t=e.op;e.pos;"object"!=S(i)&&(i=new Function("return "+i)());let n=i.r,o=i.c,r=null==a.calcChain?[]:a.calcChain;if("add"==t)r.push(i);else if("del"==t)for(let e=0;e<r.length;e++)n==r[e].r&&o==r[e].c&&l==r[e].index&&r.splice(e,1);m.refresh()}else if("drc"==t){if(null==a.data||0==a.data.length)return;let t=e.rc,n=i.index,o=i.len,r=i.mc,s=i.borderInfo,c=a.data;if("r"==t){a.row-=o,c.splice(n,o);let e=[];for(let t=0;t<c[0].length;t++)e.push(null);for(let t=0;t<o;t++)c.push(e)}else{a.column-=o;let e=[];for(let t=0;t<o;t++)e.push(null);for(let t=0;t<c.length;t++)c[t].splice(n,o),c[t]=c[t].concat(e)}for(let e in r){let t=r[e].r,l=r[e].c;c[t][l].mc=r[e]}a.config.merge=r,a.config.borderInfo=s,l==m.currentSheetIndex&&(m.flowdata=c,m.webWorkerFlowDataCache(m.flowdata),m.config.merge=r,m.config.borderInfo=s,m.refresh())}else if("arc"==t){if(null==a.data||0==a.data.length)return;let t=e.rc,n=i.index,o=i.len,r=i.data,s=i.direction,c=i.mc,u=i.borderInfo,h=$.extend(!0,[],a.data);if("r"==t){a.row+=o;let e=[];for(let t=0;t<h[0].length;t++)e.push(null);let t=[];for(let l=0;l<o;l++)null==r[l]?t.push(JSON.stringify(e)):t.push(JSON.stringify(r[l]));"lefttop"==s?0==n?new Function("data","return data.unshift("+t.join(",")+")")(h):new Function("data","return data.splice("+n+", 0, "+t.join(",")+")")(h):new Function("data","return data.splice("+(n+1)+", 0, "+t.join(",")+")")(h)}else{a.column+=o;for(let e=0;e<h.length;e++)h[e].splice(n,0,r[e])}for(let e in c){let t=c[e].r,l=c[e].c;h[t][l].mc=c[e]}a.data=h,a.config.merge=c,a.config.borderInfo=u,l==m.currentSheetIndex&&(m.flowdata=h,m.webWorkerFlowDataCache(m.flowdata),m.config.merge=c,m.config.borderInfo=u,m.refresh())}else if("f"==t){let t=e.op,n=e.pos,o=a.filter;null==o&&(o={}),"upOrAdd"==t?o[n]=i:"del"==t&&delete o[n],l==m.currentSheetIndex&&I(a.filter_select,o)}else if("fsc"==t)a.filter=null,a.filter_select=null,l==m.currentSheetIndex&&($("#luckysheet-filter-selected-sheet"+m.currentSheetIndex+", #luckysheet-filter-options-sheet"+m.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide());else if("fsr"==t)a.filter=i.filter,a.filter_select=i.filter_select,l==m.currentSheetIndex&&I(a.filter_select,a.filter);else if("sha"==t){m.luckysheetfile.push(i);let e="";null!=i.color&&(e='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+i.color+';"></div>'),$("#luckysheet-sheet-container-c").append(E(x,{index:i.index,active:"",name:i.name,style:"",colorset:e})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+i.index+'" class="luckysheet-datavisual-selection-set"></div>')}else if("shc"==t){let e=i.copyindex,t=i.name,n=C(e),a=$.extend(!0,{},m.luckysheetfile[n]);a.index=l,a.name=t,m.luckysheetfile.splice(n+1,0,a);let o=$("#luckysheet-sheets-item"+e);$("#luckysheet-sheet-container-c").append(E(x,{index:a.index,active:"",name:a.name,style:"",colorset:""})),$("#luckysheet-sheets-item"+a.index).insertAfter(o),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+a.index+'" class="luckysheet-datavisual-selection-set"></div>')}else if("shd"==t){for(let e=0;e<m.luckysheetfile.length;e++)if(m.luckysheetfile[e].index==i.deleIndex){if(m.currentSheetIndex===i.deleIndex){const e=i.deleIndex;m.luckysheetfile[m.getSheetIndex(e)].hide=1;let t=$("#luckysheet-sheets-item"+e);t.hide(),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active");let l=t.nextAll(":visible");l=t.nextAll(":visible").length>0?l.eq(0).data("index"):t.prevAll(":visible").eq(0).data("index"),$("#luckysheet-sheets-item"+l).addClass("luckysheet-sheets-item-active"),m.changeSheet(l)}z.sheetDeleSave.push(m.luckysheetfile[e]),m.luckysheetfile.splice(e,1);break}$("#luckysheet-sheets-item"+i.deleIndex).remove(),$("#luckysheet-datavisual-selection-set-"+i.deleIndex).remove()}else if("shr"==t)for(let e in i)m.luckysheetfile[C(e)].order=i[e];else if("shre"==t){for(let e=0;e<z.sheetDeleSave.length;e++)if(z.sheetDeleSave[e].index==i.reIndex){let t=z.sheetDeleSave[e];m.luckysheetfile.push(t);let l="";null!=i.color&&(l='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+t.color+';"></div>'),$("#luckysheet-sheet-container-c").append(E(x,{index:t.index,active:"",name:t.name,style:"",colorset:l})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+t.index+'" class="luckysheet-datavisual-selection-set"></div>');break}}else if("sh"==t){let t=e.op,i=e.cur;"hide"==t?(a.hide=1,$("#luckysheet-sheets-item"+l).hide(),l==m.currentSheetIndex&&($("#luckysheet-sheets-item"+i).addClass("luckysheet-sheets-item-active"),m.changeSheet(i))):"show"==t&&(a.hide=0,$("#luckysheet-sheets-item"+l).show())}else if("c"==t){let t=e.op,l=e.cid;if("add"==t)a.chart.push(i),luckysheet.insertChartTosheet(i.sheetIndex,i.dataSheetIndex,i.option,i.chartType,i.selfOption,i.defaultOption,i.row,i.column,i.chart_selection_color,i.chart_id,i.chart_selection_id,i.chartStyle,i.rangeConfigCheck,i.rangeRowCheck,i.rangeColCheck,i.chartMarkConfig,i.chartTitleConfig,i.winWidth,i.winHeight,i.scrollLeft1,i.scrollTop1,i.chartTheme,i.myWidth,i.myHeight,i.myLeft,i.myTop,i.myindexrank1,!0);else if("xy"==t||"wh"==t||"update"==t)for(let e=0;e<a.chart.length;e++){let t=a.chart[e];if(t.chart_id==l){for(let e in t)for(let l in i)e==l&&(t[e]=i[l]);return void n.saveChart(t)}}else if("del"==t)for(let e=0;e<a.chart.length;e++){if(a.chart[e].chart_id==l)return a.chart.splice(e,1),$("#"+l).remove(),void n.delChart($("#"+l).attr("chart_id"),$("#"+l).attr("sheetIndex"))}}else"na"==t&&$("#luckysheet_info_detail_input").val(i).css("width",10*T(i))},multipleIndex:0,multipleRangeShow:function(e,t,l,i,n){let o=this,r=m.visibledatarow[l],s=l-1==-1?0:m.visibledatarow[l-1],c=m.visibledatacolumn[i],u=i-1==-1?0:m.visibledatacolumn[i-1],h=a.mergeborer(m.flowdata,l,i);if(h&&(r=h.row[1],s=h.row[0],c=h.column[1],u=h.column[0]),T(t)>16&&(t=T(t,16)+"..."),"enterEdit"===n&&(t+=" "+g().edit.typing),$("#luckysheet-multipleRange-show-"+e).length>0)$("#luckysheet-multipleRange-show-"+e).css({position:"absolute",left:u-1,width:c-u-1,top:s-1,height:r-s-1}),$("#luckysheet-multipleRange-show-"+e+" .username").text(t),$("#luckysheet-multipleRange-show-"+e+" .username").show(),null!=m.cooperativeEdit.usernameTimeout["user"+e]&&clearTimeout(m.cooperativeEdit.usernameTimeout["user"+e]),m.cooperativeEdit.usernameTimeout["user"+e]=setTimeout(()=>{clearTimeout(m.cooperativeEdit.usernameTimeout["user"+e]),m.cooperativeEdit.usernameTimeout["user"+e]=null},1e4);else{let l=`<div \n\t\t\t\t\t\t\t\tid="luckysheet-multipleRange-show-${e}"\n\t\t\t\t\t\t\t\tclass="luckysheet-multipleRange-show"\n\t\t\t\t\t\t\t\tdata-color="${b[o.multipleIndex]}" \n\t\t\t\t\t\t\t\ttitle="${t}" \n\t\t\t\t\t\t\t\tstyle="position: absolute;left: ${u-1}px;width: ${c-u-1}px;top: ${s-1}px;height: ${r-s-1}px;border: 1px solid ${b[o.multipleIndex]};z-index: 15;">\n\n\t\t\t\t\t\t\t\t<div class="username" style="height: 19px;line-height:19px;width: max-content;position: absolute;bottom: ${r-s-1}px;right: 0;background-color: ${b[o.multipleIndex]};color:#ffffff;padding:0 10px;">\n\t\t\t\t\t\t\t\t${t}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div style="width: 100%;height: 100%;position: absolute;top: 0;right: 0;bottom: 0;left: 0;opacity: 0.03;background-color: ${b[o.multipleIndex]}">\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t</div>`;$(l).appendTo($("#luckysheet-cell-main #luckysheet-multipleRange-show")),o.multipleIndex++,null!=m.cooperativeEdit.usernameTimeout["user"+e]&&clearTimeout(m.cooperativeEdit.usernameTimeout["user"+e]),m.cooperativeEdit.usernameTimeout["user"+e]=setTimeout(()=>{clearTimeout(m.cooperativeEdit.usernameTimeout["user"+e]),m.cooperativeEdit.usernameTimeout["user"+e]=null},1e4)}},sheetDeleSave:[],submitInterval:1e3,imagesubmitInterval:5e3,submitdatalimit:50,submitcompresslimit:1e3,checksubmit:function(e){let t=this;t.submitTimeout(),clearTimeout(t.imageRequestTimeout),t.imageRequestTimeout=setTimeout(function(){t.imageRequest()},t.imagesubmitInterval)},submitTimeout:function(){let e=this;clearTimeout(e.requestTimeOut),!e.requestLock&&null!=e.requestlast&&e.requestlast.clone().add(1,"seconds").isBefore(k())&&e.request(),e.requestTimeOut=setTimeout(function(){e.submitTimeout()},e.submitInterval)},requestLock:!1,requestlast:null,firstchange:!0,requestTimeOut:null,request:function(){let e=this;this.gridKey;e.cachelocaldata(function(t,l){if(0==l.length)return;(l=encodeURIComponent(JSON.stringify(l))).length;e.requestLock=!0,""!=e.updateUrl&&$.post(e.updateUrl,{compress:!1,gridKey:e.gridKey,data:l},function(t){new Function("return "+t)().status?($("#luckysheet_info_detail_update").html("最近存档时间:"+k().format("M-D H:m:s")),$("#luckysheet_info_detail_save").html("同步成功"),e.clearcachelocaldata()):($("#luckysheet_info_detail_save").html("<span style='color:#ff2121'>同步失败</span>"),e.restorecachelocaldata()),e.requestlast=k(),e.requestLock=!1})})},imageRequestLast:null,imageRequestLock:!1,imageRequestTimeout:null,imageRequest:function(){let e=this;html2canvas($("#"+container).find(".luckysheet-grid-window").get(0),{onrendered:function(t){let l=$(t).appendTo("body");l.hide();let i=l.width(),n=l.height(),a=l.get(0).getContext("2d").getImageData(0,0,i,n),o=i,r=n;.54*o>r?o=r/.54:r=.54*o;let s=$("<canvas>").attr("width",o).attr("height",r)[0];s.getContext("2d").putImageData(a,0,0),l.attr("width",350),l.attr("height",189),l.get(0).getContext("2d").drawImage(s,0,0,350,189);let c=l.get(0).toDataURL("image/jpeg",.9),u=m.getCurSheetnoset();e.imageRequestLock=!0;let h=encodeURIComponent(JSON.stringify({t:"thumb",img:c,curindex:u}));l.remove(),""!=e.updateImageUrl&&$.post(e.updateImageUrl,{compress:!1,gridKey:e.gridKey,data:h},function(t){new Function("return "+t)().status?imageRequestLast=k():$("#luckysheet_info_detail_save").html("<span style='color:#ff2121'>网络不稳定</span>"),e.imageRequestLock=!0})}})},localdata:[],matchOpt:function(e,t){for(let l in e){if("t"==l&&e.t in{drc:1,arc:1,sha:1,shc:1,shd:1})return!1;if("v"!=l){if(!(l in t))return!1;if(t[l]!=e[l])return!1}}return!0},deleteRepeatOpt:function(e,t){let l=e,i=this;if(t instanceof Array)for(let n=0;n<t.length;n++){let a=t[n];for(let t=0;t<l.length;t++){let o=e[n];i.matchOpt(a,o)&&delete l[t]}}else for(let e=0;e<l.length;e++){let n=l[e];i.matchOpt(t,n)&&delete l[e]}let n=[];for(let e=0;e<l.length;e++)null!=l[e]&&n.push(l[e]);return n},setlocaldata:function(e,t){this.gridKey;let l=this;l.getlocaldata(function(i){null==i&&(i=[]),e instanceof Array?i=i.concat(e):i.push(e),l.localdata=i,t(l.localdata)})},getlocaldata:function(e){this.gridKey;e(this.localdata)},clearlocaldata:function(e){this.gridKey;this.localdata=[],e()},cachelocaldata:function(e){let l=this,i=this.gridKey+"__qkcache",n=l.localdata,a=n.length;if(a>1){let e=[];e[0]=n[0];for(let t=1;t<a;t++){let i=n[t],a=!0;for(let t=0;t<e.length;t++){let n=e[t];if(l.matchOpt(i,n)){e.splice(t,1,i),a=!1;break}}a&&(e=e.concat(i))}n=e}null!=n&&0!=n.length&&l.clearlocaldata(function(){t.setItem(i,n).then(function(){e(i,n)})})},clearcachelocaldata:function(e){let l=this.gridKey+"__qkcache";t.removeItem(l,function(t,l){e&&"function"==typeof e&&e()})},restorecachelocaldata:function(e){let l=this.gridKey+"__qkcache",i=this;t.getItem(l).then(function(t){let l=t;i.getlocaldata(function(t){null==t&&(t=[]);let n=l.concat(t);i.localdata=n,e instanceof Function&&e(i.localdata)})})},keepHighLightBox:function(){m.cooperativeEdit.checkoutData.forEach(e=>{e.index==m.currentSheetIndex&&("enterEdit"===e.op?z.multipleRangeShow(e.id,e.username,e.r,e.c,e.op):z.multipleRangeShow(e.id,e.username,e.r,e.c))})}};return z});
//# sourceMappingURL=../sourcemaps/controllers/server.js.map
