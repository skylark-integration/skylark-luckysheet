/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../store","../utils/util","../widgets/constant","../methods/cells","../methods/protection_methods","../locale/locale","../methods/setdata"],function(e,t,l,c,n,o,s){"use strict";const{replaceHtml:i,transformRangeToAbsolute:r,openSelfModel:u}=t,{modelHTML:h}=l,{checkProtectionNotEnable:a}=n,{setcellvalue:d}=s;let k=!1;function m(t,l){if(null!=e.luckysheet_select_save&&e.luckysheet_select_save.length>0){let n=e.getSheetByIndex().data;if(null!=n)for(let l=0;l<e.luckysheet_select_save.length;l++){let o=e.luckysheet_select_save[l],s=o.row,i=o.column;for(let e=s[0];e<=s[1];e++)for(let l=i[0];l<=i[1];l++){let o,s=c.mergeborer(n,e,l);if(s){let e=s.row[2],t=s.column[2];o=n[e][t]}else o=n[e][l];t(o,e,l,n)}}else l();return n}}function p(){if(k)return;k=!0;const t=o(),l=t.cellFormat,c=t.button;$("body").append(i(h,{id:"luckysheet-cellFormat-config",addclass:"luckysheet-cellFormat-config",title:l.cellFormatTitle,content:`\n            <div class="luckysheet-cellFormat-menu-c">\n                <div class="luckysheet-cellFormat-menu luckysheet-cellFormat-menu-active" id="luckysheet-cellFormat-protection">\n                    ${l.protection}\n                </div>\n            </div>\n            <div id="luckysheet-cellFormat-protection-content" class="luckysheet-cellFormat-content">\n                <div class="luckysheet-cellFormat-protection">\n                    <p>\n                        ${l.protectionTips}\n                    </p>\n                    <label for="luckysheet-protection-check-locked"><input id="luckysheet-protection-check-locked" name="luckysheet-protection-check-locked" type="checkbox">${l.locked}</label><span>部分选中</span>\n                    <br/>\n                    <label for="luckysheet-protection-check-hidden"><input id="luckysheet-protection-check-hidden" name="luckysheet-protection-check-hidden" type="checkbox">${l.hidden}</label><span>全部选中</span>\n                </div>\n            </div>\n        `,botton:`<button id="luckysheet-cellFormat-confirm" class="btn btn-primary">${c.confirm}</button>\n                    <button class="btn btn-default luckysheet-model-close-btn">${c.cancel}</button>`,style:"z-index:100003"})),function(){const t=o().cellFormat;$("#luckysheet-cellFormat-confirm").click(function(){let l=$("#luckysheet-protection-check-locked").is(":checked"),c=$("#luckysheet-protection-check-hidden").is(":checked");l=1==l?1:0,c=1==c?1:0;let n=m(function(e,t,n,o){null==e?d(t,n,o,{lo:l,hi:c}):(e.lo=l,e.hi=c)},function(){alert(t.sheetDataIsNullAlert)});e.refreshRange(n,void 0,void 0,!1),$("#luckysheet-cellFormat-config").hide(),$("#luckysheet-modal-dialog-mask").hide()})}()}return{openCellFormatModel:function(){p();const t=o(),l=t.cellFormat;if(t.button,$("#luckysheet-rightclick-menu").hide(),!a(e.currentSheetIndex))return;let c=!1,n=!1,s=0,i=0,r=0;if(!(null!=e.luckysheet_select_save&&e.luckysheet_select_save.length>0))return void alert(l.selectionIsNullAlert);m(function(e){null!=e&&null!=e.lo&&1!=e.lo||(c=!0,s++),null!=e&&1==e.hi&&(n=!0,i++),r++},function(){c=!0});let h="",d="";c&&(h=s==r?l.tipsAll:l.tipsPart),n&&(d=i==r?l.tipsAll:l.tipsPart),$("#luckysheet-protection-check-locked").prop("checked",c).parent().next().html(h),$("#luckysheet-protection-check-hidden").prop("checked",n).parent().next().html(d),u("luckysheet-cellFormat-config")}}});
//# sourceMappingURL=../sourcemaps/controllers/cellFormat.js.map
