/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../store","../utils/util","./constant","./sheetmanage","./menuButton","./protection","../global/refresh","../locale/locale","../global/setdata"],function(e,t,l,c,n,o,s,i,r){"use strict";const{replaceHtml:u,transformRangeToAbsolute:a,openSelfModel:h}=t,{modelHTML:d}=l,{checkProtectionNotEnable:k}=o,{jfrefreshgrid:p}=s,{setcellvalue:m}=r;let y=!1;function f(t,l){if(null!=e.luckysheet_select_save&&e.luckysheet_select_save.length>0){let o=c.getSheetByIndex().data;if(null!=o)for(let l=0;l<e.luckysheet_select_save.length;l++){let c=e.luckysheet_select_save[l],s=c.row,i=c.column;for(let e=s[0];e<=s[1];e++)for(let l=i[0];l<=i[1];l++){let c,s=n.mergeborer(o,e,l);if(s){let e=s.row[2],t=s.column[2];c=o[e][t]}else c=o[e][l];t(c,e,l,o)}}else l();return o}}function b(){if(y)return;y=!0;const e=i(),t=e.cellFormat,l=e.button;$("body").append(u(d,{id:"luckysheet-cellFormat-config",addclass:"luckysheet-cellFormat-config",title:t.cellFormatTitle,content:`\n            <div class="luckysheet-cellFormat-menu-c">\n                <div class="luckysheet-cellFormat-menu luckysheet-cellFormat-menu-active" id="luckysheet-cellFormat-protection">\n                    ${t.protection}\n                </div>\n            </div>\n            <div id="luckysheet-cellFormat-protection-content" class="luckysheet-cellFormat-content">\n                <div class="luckysheet-cellFormat-protection">\n                    <p>\n                        ${t.protectionTips}\n                    </p>\n                    <label for="luckysheet-protection-check-locked"><input id="luckysheet-protection-check-locked" name="luckysheet-protection-check-locked" type="checkbox">${t.locked}</label><span>部分选中</span>\n                    <br/>\n                    <label for="luckysheet-protection-check-hidden"><input id="luckysheet-protection-check-hidden" name="luckysheet-protection-check-hidden" type="checkbox">${t.hidden}</label><span>全部选中</span>\n                </div>\n            </div>\n        `,botton:`<button id="luckysheet-cellFormat-confirm" class="btn btn-primary">${l.confirm}</button>\n                    <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:100003"})),function(){const e=i().cellFormat;$("#luckysheet-cellFormat-confirm").click(function(){let t=$("#luckysheet-protection-check-locked").is(":checked"),l=$("#luckysheet-protection-check-hidden").is(":checked");t=1==t?1:0,l=1==l?1:0;let c=f(function(e,c,n,o){null==e?m(c,n,o,{lo:t,hi:l}):(e.lo=t,e.hi=l)},function(){alert(e.sheetDataIsNullAlert)});p(c,void 0,void 0,!1),$("#luckysheet-cellFormat-config").hide(),$("#luckysheet-modal-dialog-mask").hide()})}()}return{openCellFormatModel:function(){b();const t=i(),l=t.cellFormat;if(t.button,$("#luckysheet-rightclick-menu").hide(),!k(e.currentSheetIndex))return;let c=!1,n=!1,o=0,s=0,r=0;if(!(null!=e.luckysheet_select_save&&e.luckysheet_select_save.length>0))return void alert(l.selectionIsNullAlert);f(function(e){null!=e&&null!=e.lo&&1!=e.lo||(c=!0,o++),null!=e&&1==e.hi&&(n=!0,s++),r++},function(){c=!0});let u="",a="";c&&(u=o==r?l.tipsAll:l.tipsPart),n&&(a=s==r?l.tipsAll:l.tipsPart),$("#luckysheet-protection-check-locked").prop("checked",c).parent().next().html(u),$("#luckysheet-protection-check-hidden").prop("checked",n).parent().next().html(a),h("luckysheet-cellFormat-config")}}});
//# sourceMappingURL=../sourcemaps/controllers/cellFormat.js.map
