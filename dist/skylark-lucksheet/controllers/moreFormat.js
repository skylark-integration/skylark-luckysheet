/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../utils/util","./constant","./menuButton","../global/editor","../global/tooltip","../global/validate","../store","../locale/locale"],function(e,a,o,n,l,r,m,s){"use strict";const{replaceHtml:u}=e,{modelHTML:v}=a,{isEditMode:i}=r;return{moneyFmtList:[{name:"人民币",pos:"before",value:"¥"},{name:"美元",pos:"before",value:"$"},{name:"欧元",pos:"before",value:"€"},{name:"英镑",pos:"before",value:"￡"},{name:"港元",pos:"before",value:"$"},{name:"日元",pos:"before",value:"￥"},{name:"阿尔巴尼亚列克",pos:"before",value:"Lek"},{name:"阿尔及利亚第纳尔",pos:"before",value:"din"},{name:"阿富汗尼",pos:"after",value:"Af"},{name:"阿根廷比索",pos:"before",value:"$"},{name:"阿拉伯联合酋长国迪拉姆",pos:"before",value:"dh"},{name:"阿鲁巴弗罗林",pos:"before",value:"Afl"},{name:"阿曼里亚尔",pos:"before",value:"Rial"},{name:"阿塞拜疆马纳特",pos:"before",value:"?"},{name:"埃及镑",pos:"before",value:"￡"},{name:"埃塞俄比亚比尔",pos:"before",value:"Birr"},{name:"安哥拉宽扎",pos:"before",value:"Kz"},{name:"澳大利亚元",pos:"before",value:"$"},{name:"澳门元",pos:"before",value:"MOP"},{name:"巴巴多斯元",pos:"before",value:"$"},{name:"巴布亚新几内亚基那",pos:"before",value:"PGK"},{name:"巴哈马元",pos:"before",value:"$"},{name:"巴基斯坦卢比",pos:"before",value:"Rs"},{name:"巴拉圭瓜拉尼",pos:"after",value:"Gs"},{name:"巴林第纳尔",pos:"before",value:"din"},{name:"巴拿马巴波亚",pos:"before",value:"B/"},{name:"巴西里亚伊",pos:"before",value:"R$"},{name:"白俄罗斯卢布",pos:"after",value:"р"},{name:"百慕大元",pos:"before",value:"$"},{name:"保加利亚列弗",pos:"before",value:"lev"},{name:"冰岛克朗",pos:"before",value:"kr"},{name:"波黑可兑换马克",pos:"before",value:"KM"},{name:"波兰兹罗提",pos:"after",value:"z?"},{name:"玻利维亚诺",pos:"before",value:"Bs"},{name:"伯利兹元",pos:"before",value:"$"},{name:"博茨瓦纳普拉",pos:"before",value:"P"},{name:"不丹努扎姆",pos:"before",value:"Nu"},{name:"布隆迪法郎",pos:"before",value:"FBu"},{name:"朝鲜圆",pos:"before",value:"?KP"},{name:"丹麦克朗",pos:"after",value:"kr"},{name:"东加勒比元",pos:"before",value:"$"},{name:"多米尼加比索",pos:"before",value:"RD$"},{name:"俄国卢布",pos:"after",value:"?"},{name:"厄立特里亚纳克法",pos:"before",value:"Nfk"},{name:"非洲金融共同体法郎",pos:"before",value:"CFA"},{name:"菲律宾比索",pos:"before",value:"?"},{name:"斐济元",pos:"before",value:"$"},{name:"佛得角埃斯库多",pos:"before",value:"CVE"},{name:"福克兰群岛镑",pos:"before",value:"￡"},{name:"冈比亚达拉西",pos:"before",value:"GMD"},{name:"刚果法郎",pos:"before",value:"FrCD"},{name:"哥伦比亚比索",pos:"before",value:"$"},{name:"哥斯达黎加科朗",pos:"before",value:"?"},{name:"古巴比索",pos:"before",value:"$"},{name:"古巴可兑换比索",pos:"before",value:"$"},{name:"圭亚那元",pos:"before",value:"$"},{name:"哈萨克斯坦坚戈",pos:"before",value:"?"},{name:"海地古德",pos:"before",value:"HTG"},{name:"韩元",pos:"before",value:"?"},{name:"荷属安的列斯盾",pos:"before",value:"NAf."},{name:"洪都拉斯拉伦皮拉",pos:"before",value:"L"},{name:"吉布提法郎",pos:"before",value:"Fdj"},{name:"吉尔吉斯斯坦索姆",pos:"before",value:"KGS"},{name:"几内亚法郎",pos:"before",value:"FG"},{name:"加拿大元",pos:"before",value:"$"},{name:"加纳塞地",pos:"before",value:"GHS"},{name:"柬埔寨瑞尔",pos:"before",value:"Riel"},{name:"捷克克朗",pos:"after",value:"K?"},{name:"津巴布韦元",pos:"before",value:"$"},{name:"卡塔尔里亚尔",pos:"before",value:"Rial"},{name:"开曼群岛元",pos:"before",value:"$"},{name:"科摩罗法郎",pos:"before",value:"CF"},{name:"科威特第纳尔",pos:"before",value:"din"},{name:"克罗地亚库纳",pos:"before",value:"kn"},{name:"肯尼亚先令",pos:"before",value:"Ksh"},{name:"莱索托洛蒂",pos:"before",value:"LSL"},{name:"老挝基普",pos:"before",value:"?"},{name:"黎巴嫩镑",pos:"before",value:"L￡"},{name:"立陶宛立特",pos:"before",value:"Lt"},{name:"利比亚第纳尔",pos:"before",value:"din"},{name:"利比亚元",pos:"before",value:"$"},{name:"卢旺达法郎",pos:"before",value:"RF"},{name:"罗马尼亚列伊",pos:"before",value:"RON"},{name:"马达加斯加阿里亚里",pos:"before",value:"Ar"},{name:"马尔代夫拉菲亚",pos:"before",value:"Rf"},{name:"马拉维克瓦查",pos:"before",value:"MWK"},{name:"马来西亚林吉特",pos:"before",value:"RM"},{name:"马其顿戴第纳尔",pos:"before",value:"din"},{name:"毛里求斯卢比",pos:"before",value:"MURs"},{name:"毛里塔尼亚乌吉亚",pos:"before",value:"MRO"},{name:"蒙古图格里克",pos:"before",value:"?"},{name:"孟加拉塔卡",pos:"before",value:"?"},{name:"秘鲁新索尔",pos:"before",value:"S/"},{name:"缅甸开亚特",pos:"before",value:"K"},{name:"摩尔多瓦列伊",pos:"before",value:"MDL"},{name:"摩洛哥迪拉姆",pos:"before",value:"dh"},{name:"莫桑比克梅蒂卡尔",pos:"before",value:"MTn"},{name:"墨西哥比索",pos:"before",value:"$"},{name:"纳米比亚元",pos:"before",value:"$"},{name:"南非兰特",pos:"before",value:"R"},{name:"南苏丹镑",pos:"before",value:"￡"},{name:"尼加拉瓜科多巴",pos:"before",value:"C$"},{name:"尼泊尔卢比",pos:"before",value:"Rs"},{name:"尼日利亚奈拉",pos:"before",value:"?"},{name:"挪威克朗",pos:"after",value:"kr"},{name:"乔治亚拉瑞",pos:"before",value:"GEL"},{name:"人民币（离岸）",pos:"before",value:"￥"},{name:"瑞典克朗",pos:"after",value:"kr"},{name:"瑞士法郎",pos:"before",value:"CHF"},{name:"塞尔维亚第纳尔",pos:"before",value:"din"},{name:"塞拉利昂利昂",pos:"before",value:"SLL"},{name:"塞舌尔卢比",pos:"before",value:"SCR"},{name:"沙特里亚尔",pos:"before",value:"Rial"},{name:"圣多美多布拉",pos:"before",value:"Db"},{name:"圣赫勒拿群岛磅",pos:"before",value:"￡"},{name:"斯里兰卡卢比",pos:"before",value:"Rs"},{name:"斯威士兰里兰吉尼",pos:"before",value:"SZL"},{name:"苏丹镑",pos:"before",value:"SDG"},{name:"苏里南元",pos:"before",value:"$"},{name:"所罗门群岛元",pos:"before",value:"$"},{name:"索马里先令",pos:"before",value:"SOS"},{name:"塔吉克斯坦索莫尼",pos:"before",value:"Som"},{name:"太平洋法郎",pos:"after",value:"FCFP"},{name:"泰国铢",pos:"before",value:"?"},{name:"坦桑尼亚先令",pos:"before",value:"TSh"},{name:"汤加潘加",pos:"before",value:"T$"},{name:"特立尼达和多巴哥元",pos:"before",value:"$"},{name:"突尼斯第纳尔",pos:"before",value:"din"},{name:"土耳其里拉",pos:"before",value:"?"},{name:"瓦努阿图瓦图",pos:"before",value:"VUV"},{name:"危地马拉格查尔",pos:"before",value:"Q"},{name:"委内瑞拉博利瓦",pos:"before",value:"Bs"},{name:"文莱元",pos:"before",value:"$"},{name:"乌干达先令",pos:"before",value:"UGX"},{name:"乌克兰格里夫尼亚",pos:"before",value:"грн."},{name:"乌拉圭比索",pos:"before",value:"$"},{name:"乌兹别克斯坦苏姆",pos:"before",value:"so?m"},{name:"西萨摩亚塔拉",pos:"before",value:"WST"},{name:"新加坡元",pos:"before",value:"$"},{name:"新台币",pos:"before",value:"NT$"},{name:"新西兰元",pos:"before",value:"$"},{name:"匈牙利福林",pos:"before",value:"Ft"},{name:"叙利亚镑",pos:"before",value:"￡"},{name:"牙买加元",pos:"before",value:"$"},{name:"亚美尼亚德拉姆",pos:"before",value:"Dram"},{name:"也门里亚尔",pos:"before",value:"Rial"},{name:"伊拉克第纳尔",pos:"before",value:"din"},{name:"伊朗里亚尔",pos:"before",value:"Rial"},{name:"以色列新谢克尔",pos:"before",value:"?"},{name:"印度卢比",pos:"before",value:"?"},{name:"印度尼西亚卢比",pos:"before",value:"Rp"},{name:"约旦第纳尔",pos:"before",value:"din"},{name:"越南盾",pos:"after",value:"?"},{name:"赞比亚克瓦查",pos:"before",value:"ZMW"},{name:"直布罗陀镑",pos:"before",value:"￡"},{name:"智利比索",pos:"before",value:"$"},{name:"中非金融合作法郎",pos:"before",value:"FCFA"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"1930年8月5日",value:'yyyy"年"M"月"d"日"'},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"8月5日",value:'M"月"d"日"'},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"下午01:30",value:"上午/下午 hh:mm"},{name:"下午1:30",value:"上午/下午 h:mm"},{name:"下午1:30:30",value:"上午/下午 h:mm:ss"},{name:"08-05 下午01:30",value:"MM-dd 上午/下午 hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],createDialog:function(e){let a=this;const o=s().currencyDetail,n=s().format,l=s().button;this.moneyFmtList=[{name:o.RMB,pos:"before",value:"¥"},{name:o.USdollar,pos:"before",value:"$"},{name:o.EUR,pos:"before",value:"€"},{name:o.GBP,pos:"before",value:"￡"},{name:o.HK,pos:"before",value:"$"},{name:o.JPY,pos:"before",value:"￥"},{name:o.AlbanianLek,pos:"before",value:"Lek"},{name:o.AlgerianDinar,pos:"before",value:"din"},{name:o.Afghani,pos:"after",value:"Af"},{name:o.ArgentinePeso,pos:"before",value:"$"},{name:o.UnitedArabEmiratesDirham,pos:"before",value:"dh"},{name:o.ArubanFlorin,pos:"before",value:"Afl"},{name:o.OmaniRial,pos:"before",value:"Rial"},{name:o.Azerbaijanimanat,pos:"before",value:"?"},{name:o.EgyptianPound,pos:"before",value:"￡"},{name:o.EthiopianBirr,pos:"before",value:"Birr"},{name:o.AngolaKwanza,pos:"before",value:"Kz"},{name:o.AustralianDollar,pos:"before",value:"$"},{name:o.Patacas,pos:"before",value:"MOP"},{name:o.BarbadosDollar,pos:"before",value:"$"},{name:o.PapuaNewGuineaKina,pos:"before",value:"PGK"},{name:o.BahamianDollar,pos:"before",value:"$"},{name:o.PakistanRupee,pos:"before",value:"Rs"},{name:o.ParaguayanGuarani,pos:"after",value:"Gs"},{name:o.BahrainiDinar,pos:"before",value:"din"},{name:o.PanamanianBalboa,pos:"before",value:"B/"},{name:o.Brazilianreal,pos:"before",value:"R$"},{name:o.Belarusianruble,pos:"after",value:"р"},{name:o.BermudianDollar,pos:"before",value:"$"},{name:o.BulgarianLev,pos:"before",value:"lev"},{name:o.IcelandKrona,pos:"before",value:"kr"},{name:o.BosniaHerzegovinaConvertibleMark,pos:"before",value:"KM"},{name:o.PolishZloty,pos:"after",value:"z?"},{name:o.Boliviano,pos:"before",value:"Bs"},{name:o.BelizeDollar,pos:"before",value:"$"},{name:o.BotswanaPula,pos:"before",value:"P"},{name:o.NotDannuzhamu,pos:"before",value:"Nu"},{name:o.BurundiFranc,pos:"before",value:"FBu"},{name:o.NorthKoreanWon,pos:"before",value:"?KP"},{name:o.DanishKrone,pos:"after",value:"kr"},{name:o.EastCaribbeanDollar,pos:"before",value:"$"},{name:o.DominicaPeso,pos:"before",value:"RD$"},{name:o.RussianRuble,pos:"after",value:"?"},{name:o.EritreanNakfa,pos:"before",value:"Nfk"},{name:o.CFAfranc,pos:"before",value:"CFA"},{name:o.PhilippinePeso,pos:"before",value:"?"},{name:o.FijiDollar,pos:"before",value:"$"},{name:o.CapeVerdeEscudo,pos:"before",value:"CVE"},{name:o.FalklandIslandsPound,pos:"before",value:"￡"},{name:o.GambianDalasi,pos:"before",value:"GMD"},{name:o.Congolesefranc,pos:"before",value:"FrCD"},{name:o.ColombianPeso,pos:"before",value:"$"},{name:o.CostaRicanColon,pos:"before",value:"?"},{name:o.CubanPeso,pos:"before",value:"$"},{name:o.Cubanconvertiblepeso,pos:"before",value:"$"},{name:o.GuyanaDollar,pos:"before",value:"$"},{name:o.KazakhstanTenge,pos:"before",value:"?"},{name:o.Haitiangourde,pos:"before",value:"HTG"},{name:o.won,pos:"before",value:"?"},{name:o.NetherlandsAntillesGuilder,pos:"before",value:"NAf."},{name:o.Honduraslempiras,pos:"before",value:"L"},{name:o.DjiboutiFranc,pos:"before",value:"Fdj"},{name:o.KyrgyzstanSom,pos:"before",value:"KGS"},{name:o.GuineaFranc,pos:"before",value:"FG"},{name:o.CanadianDollar,pos:"before",value:"$"},{name:o.GhanaianCedi,pos:"before",value:"GHS"},{name:o.Cambodianriel,pos:"before",value:"Riel"},{name:o.CzechKoruna,pos:"after",value:"K?"},{name:o.ZimbabweDollar,pos:"before",value:"$"},{name:o.QatariRiyal,pos:"before",value:"Rial"},{name:o.CaymanIslandsDollar,pos:"before",value:"$"},{name:o.Comorianfranc,pos:"before",value:"CF"},{name:o.KuwaitiDinar,pos:"before",value:"din"},{name:o.CroatianKuna,pos:"before",value:"kn"},{name:o.KenyanShilling,pos:"before",value:"Ksh"},{name:o.LesothoLoti,pos:"before",value:"LSL"},{name:o.LaoKip,pos:"before",value:"?"},{name:o.LebanesePound,pos:"before",value:"L￡"},{name:o.Lithuanianlitas,pos:"before",value:"Lt"},{name:o.LibyanDinar,pos:"before",value:"din"},{name:o.LiberianDollar,pos:"before",value:"$"},{name:o.RwandaFranc,pos:"before",value:"RF"},{name:o.RomanianLeu,pos:"before",value:"RON"},{name:o.MalagasyAriary,pos:"before",value:"Ar"},{name:o.MaldivianRufiyaa,pos:"before",value:"Rf"},{name:o.MalawiKwacha,pos:"before",value:"MWK"},{name:o.MalaysianRinggit,pos:"before",value:"RM"},{name:o.MacedoniawearingDinar,pos:"before",value:"din"},{name:o.MauritiusRupee,pos:"before",value:"MURs"},{name:o.MauritanianOuguiya,pos:"before",value:"MRO"},{name:o.MongolianTugrik,pos:"before",value:"?"},{name:o.BangladeshiTaka,pos:"before",value:"?"},{name:o.PeruvianNuevoSol,pos:"before",value:"S/"},{name:o.MyanmarKyat,pos:"before",value:"K"},{name:o.MoldovanLeu,pos:"before",value:"MDL"},{name:o.MoroccanDirham,pos:"before",value:"dh"},{name:o.MozambiqueMetical,pos:"before",value:"MTn"},{name:o.MexicanPeso,pos:"before",value:"$"},{name:o.NamibianDollar,pos:"before",value:"$"},{name:o.SouthAfricanRand,pos:"before",value:"R"},{name:o.SouthSudanesePound,pos:"before",value:"￡"},{name:o.NicaraguaCordoba,pos:"before",value:"C$"},{name:o.NepaleseRupee,pos:"before",value:"Rs"},{name:o.NigerianNaira,pos:"before",value:"?"},{name:o.NorwegianKrone,pos:"after",value:"kr"},{name:o.GeorgianLari,pos:"before",value:"GEL"},{name:o.RenminbiOffshore,pos:"before",value:"￥"},{name:o.SwedishKrona,pos:"after",value:"kr"},{name:o.SwissFranc,pos:"before",value:"CHF"},{name:o.SerbianDinar,pos:"before",value:"din"},{name:o.SierraLeone,pos:"before",value:"SLL"},{name:o.SeychellesRupee,pos:"before",value:"SCR"},{name:o.SaudiRiyal,pos:"before",value:"Rial"},{name:o.SaoTomeDobra,pos:"before",value:"Db"},{name:o.SaintHelenapound,pos:"before",value:"￡"},{name:o.SriLankaRupee,pos:"before",value:"Rs"},{name:o.SwazilandLilangeni,pos:"before",value:"SZL"},{name:o.SudanesePound,pos:"before",value:"SDG"},{name:o.Surinamesedollar,pos:"before",value:"$"},{name:o.SolomonIslandsDollar,pos:"before",value:"$"},{name:o.SomaliShilling,pos:"before",value:"SOS"},{name:o.TajikistanSomoni,pos:"before",value:"Som"},{name:o.PacificFranc,pos:"after",value:"FCFP"},{name:o.ThaiBaht,pos:"before",value:"?"},{name:o.TanzanianShilling,pos:"before",value:"TSh"},{name:o.TonganPaanga,pos:"before",value:"T$"},{name:o.TrinidadandTobagoDollar,pos:"before",value:"$"},{name:o.TunisianDinar,pos:"before",value:"din"},{name:o.TurkishLira,pos:"before",value:"?"},{name:o.VanuatuVatu,pos:"before",value:"VUV"},{name:o.GuatemalanQuetzal,pos:"before",value:"Q"},{name:o.CommissionBolivar,pos:"before",value:"Bs"},{name:o.BruneiDollar,pos:"before",value:"$"},{name:o.UgandanShilling,pos:"before",value:"UGX"},{name:o.UkrainianHryvnia,pos:"before",value:"грн."},{name:o.UruguayanPeso,pos:"before",value:"$"},{name:o.Uzbekistansom,pos:"before",value:"so?m"},{name:o.WesternSamoaTala,pos:"before",value:"WST"},{name:o.SingaporeDollar,pos:"before",value:"$"},{name:o.NT,pos:"before",value:"NT$"},{name:o.NewZealandDollar,pos:"before",value:"$"},{name:o.HungarianForint,pos:"before",value:"Ft"},{name:o.SyrianPound,pos:"before",value:"￡"},{name:o.JamaicanDollar,pos:"before",value:"$"},{name:o.ArmenianDram,pos:"before",value:"Dram"},{name:o.YemeniRial,pos:"before",value:"Rial"},{name:o.IraqiDinar,pos:"before",value:"din"},{name:o.IranianRial,pos:"before",value:"Rial"},{name:o.NewIsraeliShekel,pos:"before",value:"?"},{name:o.IndianRupee,pos:"before",value:"?"},{name:o.IndonesianRupiah,pos:"before",value:"Rp"},{name:o.JordanianDinar,pos:"before",value:"din"},{name:o.VND,pos:"after",value:"?"},{name:o.ZambianKwacha,pos:"before",value:"ZMW"},{name:o.GibraltarPound,pos:"before",value:"￡"},{name:o.ChileanPeso,pos:"before",value:"$"},{name:o.CFAFrancBEAC,pos:"before",value:"FCFA"}],this.dateFmtList=s().dateFmtList,this.numFmtList=[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-moreFormat-dialog").remove();let r="",m="";if("morecurrency"==e){r=n.titleCurrency;let e="";for(let o=0;o<a.moneyFmtList.length;o++){let n=a.moneyFmtList[o].name,l=a.moneyFmtList[o].pos;e+='<div class="listItem"><div class="name">'+n+'</div><div class="value">'+a.moneyFmtList[o].value+'</div><input type="hidden" value="'+l+'"/></div>'}m='<div class="box" id="morecurrency"><div class="decimal"><label>'+n.decimalPlaces+'：</label><input type="number" class="formulaInputFocus" value="2" min="0" max="9"/></div><div class="listbox">'+e+"</div></div>"}else if("moredatetime"==e){r=n.titleDateTime;let e="";for(let o=0;o<a.dateFmtList.length;o++){e+='<div class="listItem"><div class="name">'+a.dateFmtList[o].name+'</div><div class="value">'+a.dateFmtList[o].value+"</div></div>"}m='<div class="box" id="moredatetime"><div class="listbox">'+e+"</div></div>"}else if("moredigit"==e){r=n.titleNumber;let e="";for(let o=0;o<a.numFmtList.length;o++){e+='<div class="listItem"><div class="name">'+a.numFmtList[o].name+'</div><div class="value">'+a.numFmtList[o].value+"</div></div>"}m='<div class="box" id="moredigit"><div class="listbox">'+e+"</div></div>"}$("body").append(u(v,{id:"luckysheet-moreFormat-dialog",addclass:"luckysheet-moreFormat-dialog",title:r,content:m,botton:'<button id="luckysheet-moreFormat-dialog-confirm" class="btn btn-primary">'+l.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+l.cancel+"</button>",style:"z-index:100003"}));let i=$("#luckysheet-moreFormat-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),f=i.outerHeight(),b=i.outerWidth(),p=$(window).width(),t=$(window).height(),d=$(document).scrollLeft(),c=$(document).scrollTop();$("#luckysheet-moreFormat-dialog").css({left:(p+d-b)/2,top:(t+c-f)/3}).show(),$("#luckysheet-moreFormat-dialog .listbox .listItem").eq(0).addClass("on")},init:function(){$(document).on("click","#luckysheet-moreFormat-dialog .listbox .listItem",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.moreFormatConfirm").on("click.moreFormatConfirm","#luckysheet-moreFormat-dialog #luckysheet-moreFormat-dialog-confirm",function(){$("#luckysheet-moreFormat-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide();let e=n.deepCopyFlowData(m.flowdata),a=$("#luckysheet-moreFormat-dialog .listbox .listItem.on .value").text(),r=$(this).parents("#luckysheet-moreFormat-dialog").find(".box").attr("id");if("morecurrency"==r){if(-1!=a.indexOf("?"))return;let n=parseInt($("#luckysheet-moreFormat-dialog .decimal input").val().trim());if("NaN"==n.toString()||n<0||n>9)return void(i()?alert("小数位数必须在0-9之间！"):l.info("小数位数必须在0-9之间！",""));let r="";if(n>0){for(let e=1;e<=n;e++)r+="0";r="0."+r}else r="#";let m=$("#luckysheet-moreFormat-dialog .listbox .listItem.on input:hidden").val();"before"==m?r='"'+a+'" '+r:"after"==m&&(r=r+' "'+a+'"'),o.updateFormat(e,"ct",r)}else"moredatetime"==r?o.updateFormat(e,"ct",a):"moredigit"==r&&o.updateFormat(e,"ct",a)})}}});
//# sourceMappingURL=../sourcemaps/controllers/moreFormat.js.map
