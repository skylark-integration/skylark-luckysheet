/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../store","../locale/locale","../utils/util","./sheetmanage","./resize","../global/refresh","./server","./postil","./imageCtrl"],function(o,e,t,n,l,i,u,s,a){"use strict";const{replaceHtml:c}=t,{changeSheetContainerSize:r}=l,{jfrefreshgrid_rhcw:m}=i;let h=null;function f(e){null!=o.flowdata&&0!=o.flowdata.length&&(clearTimeout(h),h=setTimeout(()=>{o.clearjfundo&&o.jfredo.push({type:"zoomChange",zoomRatio:o.zoomRatio,curZoomRatio:e,sheetIndex:o.currentSheetIndex}),o.zoomRatio=e;let t=n.getSheetByIndex();s.buildAllPs(t.data),a.images=t.images,a.allImagesShow(),a.init(),null==t.config&&(t.config={}),null==t.config.sheetViewZoom&&(t.config.sheetViewZoom={});let l=t.config.curentsheetView;null==l&&(l="viewNormal"),t.config.sheetViewZoom[l+"ZoomScale"]=e,u.saveParam("all",o.currentSheetIndex,o.zoomRatio,{k:"zoomRatio"}),u.saveParam("cg",o.currentSheetIndex,t.config.sheetViewZoom,{k:"sheetViewZoom"}),z()},100))}function z(){m(o.flowdata.length,o.flowdata[0].length),r()}function d(o){let e=1;return o<50?e=Math.round(100*(1.8*o/100+.1))/100:o>50&&(e=Math.round(100*(6*(o-50)/100+1))/100),e}function g(o){let e=Math.round(100*o)+"%";$("#luckysheet-zoom-ratioText").html(e),function(o){let e=50;o<1?e=Math.round(100*(o-.1)/.18)/10:o>1&&(e=Math.round(100*(o-1)/.6)/10+50),$("#luckysheet-zoom-cursor").css("left",e-4)}(o)}return{zoomChange:f,zoomRefreshView:z,zoomInitial:function(){$("#luckysheet-zoom-minus").click(function(){let e;e=null==o.zoomRatio?o.zoomRatio=1:Math.ceil(10*o.zoomRatio)/10,(e-=.1)==o.zoomRatio&&(e-=.1),e<=.1&&(e=.1),f(e),g(e)}),$("#luckysheet-zoom-plus").click(function(){let e;e=null==o.zoomRatio?o.zoomRatio=1:Math.floor(10*o.zoomRatio)/10,(e+=.1)==o.zoomRatio&&(e+=.1),e>=4&&(e=4),f(e),g(e)}),$("#luckysheet-zoom-slider").mousedown(function(o){let e=$(this).offset().left,t=d(o.pageX-e);f(t),g(t)}),$("#luckysheet-zoom-cursor").mousedown(function(o){let e=o.pageX,t=parseFloat($("#luckysheet-zoom-cursor").css("left"));$("#luckysheet-zoom-cursor").css("transition","none"),$(document).off("mousemove.zoomCursor").on("mousemove.zoomCursor",function(o){let n=o.pageX,l=t+(n-e),i=d(l);i>4&&(i=4,l=100),i<.1&&(i=.1,l=0),f(i);let u=Math.round(100*i)+"%";$("#luckysheet-zoom-ratioText").html(u),$("#luckysheet-zoom-cursor").css("left",l-4)}),$(document).off("mouseup.zoomCursor").on("mouseup.zoomCursor",function(o){$(document).off(".zoomCursor"),$("#luckysheet-zoom-cursor").css("transition","all 0.3s")}),o.stopPropagation()}).click(function(o){o.stopPropagation()}),$("#luckysheet-zoom-ratioText").click(function(){f(1),g(1)}),g(o.zoomRatio)},zoomNumberDomBind:g}});
//# sourceMappingURL=../sourcemaps/controllers/zoom.js.map
