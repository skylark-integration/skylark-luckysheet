/**
 * skylark-lucksheet - A version of lucksheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["../methods/location","../methods/count","../methods/border","../methods/validate","../methods/format","../methods/formula_methods","../methods/conditionformat_methods","../methods/protection_methods","../widgets/select","../methods/get","../utils/util","../store","../locale/locale","skylark-moment"],function(e,t,l,n,s,i,a,d,o,u,h,r,c,f){"use strict";const{rowLocationByIndex:m,colLocationByIndex:p}=e,{countfunc:y}=t,{getBorderInfoCompute:g}=l,{isRealNum:v}=n,{genarate:x,update:k}=s,{checkProtectionLockedRangeList:b}=d,{selectHightlightShow:C}=o,{getSheetIndex:D}=u,{getObjType:Y,replaceHtml:w}=h;return{iconHtml:'<div id="luckysheet-dropCell-icon" style="position: absolute;padding: 2px;background-color: #f1f1f1;z-index: 990;cursor: pointer;"><div id="icon_dropCell"></div></div>',typeListHtml:'<div id="luckysheet-dropCell-typeList" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${copyCell}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="1"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${sequence}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${onlyFormat}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="3"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${noFormat}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="4"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${day}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="5"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${workDay}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="6"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${month}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="7"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${year}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="8"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${chineseNumber}</div></div></div>',copyRange:{},applyRange:{},applyType:null,direction:null,chnNumChar:{"零":0,"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9},chnNameValue:{"十":{value:10,secUnit:!1},"百":{value:100,secUnit:!1},"千":{value:1e3,secUnit:!1},"万":{value:1e4,secUnit:!0},"亿":{value:1e8,secUnit:!0}},ChineseToNumber:function(e){let t=this,l=0,n=0,s=0,i=!1,a=e.split("");for(let e=0;e<a.length;e++){let d=t.chnNumChar[a[e]];if(void 0!==d)s=d,e==a.length-1&&(n+=s);else{let d=t.chnNameValue[a[e]].value;(i=t.chnNameValue[a[e]].secUnit)?(l+=n=(n+s)*d,n=0):n+=s*d,s=0}}return l+n},chnNumChar2:["零","一","二","三","四","五","六","七","八","九"],chnUnitSection:["","万","亿","万亿","亿亿"],chnUnitChar:["","十","百","千"],SectionToChinese:function(e){let t=this,l="",n="",s=0,i=!0;for(;e>0;){let a=e%10;0==a?i||(i=!0,n=t.chnNumChar2[a]+n):(i=!1,l=t.chnNumChar2[a],n=(l+=t.chnUnitChar[s])+n),s++,e=Math.floor(e/10)}return n},NumberToChinese:function(e){let t=this,l=0,n="",s="",i=!1;if(0==e)return t.chnNumChar2[0];for(;e>0;){let a=e%1e4;i&&(s=t.chnNumChar2[0]+s),n=t.SectionToChinese(a),s=(n+=0!=a?t.chnUnitSection[l]:t.chnUnitSection[0])+s,i=a<1e3&&a>0,e=Math.floor(e/1e4),l++}return s},isChnNumber:function(e){let t=this,l=!0;if(1==e.length)l="日"==e||e in t.chnNumChar;else{let n=e.split("");for(let e=0;e<n.length;e++)if(!(n[e]in t.chnNumChar||n[e]in t.chnNameValue)){l=!1;break}}return l},isExtendNumber:function(e){let t=/0|([1-9]+[0-9]*)/g,l=t.test(e);if(l){let n=e.match(t),s=n[n.length-1],i=e.lastIndexOf(s),a=e.substr(0,i),d=e.substr(i+s.length);return[l,Number(s),a,d]}return[l]},isChnWeek1:function(e){let t,l=this;return t=1==e.length&&("日"==e||l.ChineseToNumber(e)<7)},isChnWeek2:function(e){let t;return t=2==e.length&&("周一"==e||"周二"==e||"周三"==e||"周四"==e||"周五"==e||"周六"==e||"周日"==e)},isChnWeek3:function(e){let t;return t=3==e.length&&("星期一"==e||"星期二"==e||"星期三"==e||"星期四"==e||"星期五"==e||"星期六"==e||"星期日"==e)},createIcon:function(){let e,t,l=this,n=l.copyRange.row[1],s=l.copyRange.column[1],i=l.applyRange.row[1],a=l.applyRange.column[1];i>=n&&a>=s?(e=i,t=a):(e=n,t=s);let d=m(e)[1],o=(m(e)[0],p(t)[1]);p(t)[0];$("#luckysheet-dropCell-icon").remove(),$("#luckysheet-cell-main").append(l.iconHtml),$("#luckysheet-dropCell-icon").css({left:o,top:d}),$("#luckysheet-dropCell-icon").mouseover(function(){$(this).css("background-color","#ffe8e8")}).mouseleave(function(){$(this).css("background-color","#f1f1f1")}).mousedown(function(e){$("#luckysheet-dropCell-typeList").remove();const t=c().dropCell;$("body").append(w(l.typeListHtml,{copyCell:t.copyCell,sequence:t.sequence,onlyFormat:t.onlyFormat,noFormat:t.noFormat,day:t.day,workDay:t.workDay,month:t.month,year:t.year,chineseNumber:t.chineseNumber}));let n=l.typeItemHide();n[0]||n[1]||n[2]||n[3]||n[4]||n[5]||n[6]||($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=1]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide()),n[2]||($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide()),n[3]||$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide();let s=$(this).offset().left,i=$(this).offset().top+25,a=$(window).height(),d=$(window).width(),o=$("#luckysheet-dropCell-typeList").width(),u=$("#luckysheet-dropCell-typeList").height();s+o>d&&(s-=o),i+u>a&&(i=i-u-38),i<0&&(i=0),$("#luckysheet-dropCell-typeList").css({left:s,top:i}).show(),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#ffe8e8")});let h=l.applyType;$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type="+h+"]").find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'),e.stopPropagation()}),$(document).off("click.dCtypeList").on("click.dCtypeList","#luckysheet-dropCell-typeList .luckysheet-cols-menuitem",function(){$("#luckysheet-dropCell-typeList .fa-check").remove(),$(this).find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>');let e=$(this).attr("data-type");l.applyType=e,l.update(),$("#luckysheet-dropCell-typeList").hide(),$("#luckysheet-dropCell-icon").css("backgroundColor","#f1f1f1"),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#f1f1f1")}),y()})},typeItemHide:function(){let e=this,t=e.copyRange,l=t.row[0],n=t.row[1],s=t.column[0],i=t.column[1],a=!1,d=!1,o=!1,u=!1,h=!1,c=!1,f=!1;for(let t=l;t<=n;t++)for(let l=s;l<=i;l++)if(r.flowdata[t][l]){let n=r.flowdata[t][l];"object"==Y(n)&&null!=n.v&&null==n.f&&(null!=n.ct&&"n"==n.ct.t?a=!0:null!=n.ct&&"d"==n.ct.t?o=!0:e.isExtendNumber(n.m)[0]?d=!0:e.isChnNumber(n.m)&&"日"!=n.m?u=!0:"日"==n.m?h=!0:e.isChnWeek2(n.m)?c=!0:e.isChnWeek3(n.m)&&(f=!0))}return[a,d,o,u,h,c,f]},update:function(){let e=this;if(!b([e.applyRange],r.currentSheetIndex))return;if(!1===r.allowEdit)return;let t,l=r.deepCopyFlowData(r.flowdata),n=r.luckysheetfile[D(r.currentSheetIndex)],s=$.extend(!0,{},r.config),d=g(),o=$.extend(!0,{},n.dataVerification),u=e.direction,h=(e.applyType,e.copyRange),c=h.row[0],f=h.row[1],m=h.column[0],p=h.column[1],y=e.getCopyData(l,c,f,m,p,u);"down"==u||"up"==u?t=f-c+1:"right"!=u&&"left"!=u||(t=p-m+1);let k=e.applyRange,Y=k.row[0],w=k.row[1],M=k.column[0],F=k.column[1];if("down"==u||"up"==u){let n=w-Y+1;for(let a=M;a<=F;a++){let h=y[a-M],r=e.getApplyData(h,t,n);if("down"==u)for(let e=Y;e<=w;e++){let n=r[e-Y];if(null!=n.f){let t="="+i.functionCopy(n.f,"down",e-Y+1),s=i.execfunction(t,e,a);if(i.execFunctionGroup(e,a,s[1],void 0,l),n.f=s[2],n.v=s[1],null!=n.spl)n.spl=s[3].data;else if(v(n.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(n.v)){if(n.v==1/0||n.v==-1/0)n.m=n.v.toString();else if(n.v.toString().indexOf("e")>-1){let e=n.v.toString().split(".")[1].split("e")[0].length;e>5&&(e=5),n.m=n.v.toExponential(e).toString()}else{let e=x(Math.round(1e9*n.v)/1e9);n.m=e[0].toString()}n.ct={fa:"General",t:"n"}}else{let e=x(n.v);n.m=e[0].toString(),n.ct=e[1]}}l[e][a]=n;let u=c+(e-Y)%t,h=a;if(d[u+"_"+h]){let t={rangeType:"cell",value:{row_index:e,col_index:a,l:d[u+"_"+h].l,r:d[u+"_"+h].r,t:d[u+"_"+h].t,b:d[u+"_"+h].b}};s.borderInfo.push(t)}else if(d[e+"_"+a]){let t={rangeType:"cell",value:{row_index:e,col_index:a,l:null,r:null,t:null,b:null}};s.borderInfo.push(t)}o[u+"_"+h]&&(o[e+"_"+a]=o[u+"_"+h])}if("up"==u)for(let e=w;e>=Y;e--){let n=r[w-e];if(null!=n.f){let t="="+i.functionCopy(n.f,"up",w-e+1),s=i.execfunction(t,e,a);if(i.execFunctionGroup(e,a,s[1],void 0,l),n.f=s[2],n.v=s[1],null!=n.spl)n.spl=s[3].data;else if(v(n.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(n.v)){if(n.v==1/0||n.v==-1/0)n.m=n.v.toString();else if(n.v.toString().indexOf("e")>-1){let e=n.v.toString().split(".")[1].split("e")[0].length;e>5&&(e=5),n.m=n.v.toExponential(e).toString()}else{let e=x(Math.round(1e9*n.v)/1e9);n.m=e[0].toString()}n.ct={fa:"General",t:"n"}}else{let e=x(n.v);n.m=e[0].toString(),n.ct=e[1]}}l[e][a]=n;let u=f-(w-e)%t,h=a;if(d[u+"_"+h]){let t={rangeType:"cell",value:{row_index:e,col_index:a,l:d[u+"_"+h].l,r:d[u+"_"+h].r,t:d[u+"_"+h].t,b:d[u+"_"+h].b}};s.borderInfo.push(t)}else if(d[e+"_"+a]){let t={rangeType:"cell",value:{row_index:e,col_index:a,l:null,r:null,t:null,b:null}};s.borderInfo.push(t)}o[u+"_"+h]&&(o[e+"_"+a]=o[u+"_"+h])}}}else if("right"==u||"left"==u){let n=F-M+1;for(let a=Y;a<=w;a++){let h=y[a-Y],r=e.getApplyData(h,t,n);if("right"==u)for(let e=M;e<=F;e++){let n=r[e-M];if(null!=n.f){let t="="+i.functionCopy(n.f,"right",e-M+1),s=i.execfunction(t,a,e);if(i.execFunctionGroup(e,a,s[1],void 0,l),n.f=s[2],n.v=s[1],null!=n.spl)n.spl=s[3].data;else if(v(n.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(n.v)){if(n.v==1/0||n.v==-1/0)n.m=n.v.toString();else if(n.v.toString().indexOf("e")>-1){let e=n.v.toString().split(".")[1].split("e")[0].length;e>5&&(e=5),n.m=n.v.toExponential(e).toString()}else{let e=x(Math.round(1e9*n.v)/1e9);n.m=e[0].toString()}n.ct={fa:"General",t:"n"}}else{let e=x(n.v);n.m=e[0].toString(),n.ct=e[1]}}l[a][e]=n;let u=a,h=m+(e-M)%t;if(d[u+"_"+h]){let t={rangeType:"cell",value:{row_index:a,col_index:e,l:d[u+"_"+h].l,r:d[u+"_"+h].r,t:d[u+"_"+h].t,b:d[u+"_"+h].b}};s.borderInfo.push(t)}else if(d[a+"_"+e]){let t={rangeType:"cell",value:{row_index:a,col_index:e,l:null,r:null,t:null,b:null}};s.borderInfo.push(t)}o[u+"_"+h]&&(o[a+"_"+e]=o[u+"_"+h])}if("left"==u)for(let e=F;e>=M;e--){let n=r[F-e];if(null!=n.f){let t="="+i.functionCopy(n.f,"left",F-e+1),s=i.execfunction(t,a,e);if(i.execFunctionGroup(e,a,s[1],void 0,l),n.f=s[2],n.v=s[1],null!=n.spl)n.spl=s[3].data;else if(v(n.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(n.v)){if(n.v==1/0||n.v==-1/0)n.m=n.v.toString();else if(n.v.toString().indexOf("e")>-1){let e=n.v.toString().split(".")[1].split("e")[0].length;e>5&&(e=5),n.m=n.v.toExponential(e).toString()}else{let e=x(Math.round(1e9*n.v)/1e9);n.m=e[0].toString()}n.ct={fa:"General",t:"n"}}else{let e=x(n.v);n.m=e[0].toString(),n.ct=e[1]}}l[a][e]=n;let u=a,h=p-(F-e)%t;if(d[u+"_"+h]){let t={rangeType:"cell",value:{row_index:a,col_index:e,l:d[u+"_"+h].l,r:d[u+"_"+h].r,t:d[u+"_"+h].t,b:d[u+"_"+h].b}};s.borderInfo.push(t)}else if(d[a+"_"+e]){let t={rangeType:"cell",value:{row_index:a,col_index:e,l:null,r:null,t:null,b:null}};s.borderInfo.push(t)}o[u+"_"+h]&&(o[a+"_"+e]=o[u+"_"+h])}}}let N=$.extend(!0,[],n.luckysheet_conditionformat_save);if(null!=N&&N.length>0)for(let e=0;e<N.length;e++){let t=N[e].cellrange,l=[];for(let e=0;e<t.length;e++){let n=a.CFSplitRange(t[e],{row:h.row,column:h.column},{row:k.row,column:k.column},"operatePart");n.length>0&&(l=l.concat(n))}l.length>0&&N[e].cellrange.push(k)}let _={cfg:s,cdformat:N,dataVerification:o};r.refreshRange(l,r.luckysheet_select_save,_),C()},getCopyData:function(e,t,l,n,s,i){let a,d,o,u,h=this,r=[];"down"==i||"up"==i?(a=n,d=s,o=t,u=l):"right"!=i&&"left"!=i||(a=t,d=l,o=n,u=s);for(let t=a;t<=d;t++){let l={},n=[],s=[],a="",d=null,c=null,f=!0;for(let r=o;r<=u;r++){let m,p;if("down"==i||"up"==i?m=e[r][t]:"right"!=i&&"left"!=i||(m=e[t][r]),m&&m.v&&null==m.f)if(m.ct&&"n"==m.ct.t)p="number",d=null,c=null;else if(m.ct&&"d"==m.ct.t)p="date",d=null,c=null;else if(h.isExtendNumber(m.m)[0]){p="extendNumber";let e=h.isExtendNumber(m.m);null==d||null==c?(f=!0,d=e[2],c=e[3]):e[2]!=d||e[3]!=c?(f=!1,d=e[2],c=e[3]):f=!0}else h.isChnNumber(m.m)?(p="chnNumber",d=null,c=null):h.isChnWeek2(m.m)?(p="chnWeek2",d=null,c=null):h.isChnWeek3(m.m)?(p="chnWeek3",d=null,c=null):(p="other",d=null,c=null);else p="other",d=null,c=null;"extendNumber"==p?r==o?o==u?(a=p,n.push(m),s.push(r-o+1),l[a]=[],l[a].push({data:n,index:s})):(a=p,n.push(m),s.push(r-o+1)):r==u?a==p&&f?(n.push(m),s.push(r-o+1),a in l?l[a].push({data:n,index:s}):(l[a]=[],l[a].push({data:n,index:s}))):(a in l?l[a].push({data:n,index:s}):(l[a]=[],l[a].push({data:n,index:s})),a=p,(n=[]).push(m),(s=[]).push(r-o+1),a in l?l[a].push({data:n,index:s}):(l[a]=[],l[a].push({data:n,index:s}))):a==p&&f?(n.push(m),s.push(r-o+1)):(a in l?l[a].push({data:n,index:s}):(l[a]=[],l[a].push({data:n,index:s})),a=p,(n=[]).push(m),(s=[]).push(r-o+1)):r==o?o==u?(a=p,n.push(m),s.push(r-o+1),l[a]=[],l[a].push({data:n,index:s})):(a=p,n.push(m),s.push(r-o+1)):r==u?a==p?(n.push(m),s.push(r-o+1),a in l?l[a].push({data:n,index:s}):(l[a]=[],l[a].push({data:n,index:s}))):(a in l?l[a].push({data:n,index:s}):(l[a]=[],l[a].push({data:n,index:s})),a=p,(n=[]).push(m),(s=[]).push(r-o+1),a in l?l[a].push({data:n,index:s}):(l[a]=[],l[a].push({data:n,index:s}))):a==p?(n.push(m),s.push(r-o+1)):(a in l?l[a].push({data:n,index:s}):(l[a]=[],l[a].push({data:n,index:s})),a=p,(n=[]).push(m),(s=[]).push(r-o+1))}r.push(l)}return r},getApplyData:function(e,t,l){let n=this,s=[],i=n.direction,a=n.applyType,d=Math.floor(l/t),o=l%t,u=e.number,h=[];if(u)for(let e=0;e<u.length;e++){let s,r=n.getLenS(u[e].index,o),c=u[e].index.length*d+r;s="1"==a||"3"==a?n.getDataByType(u[e].data,c,i,a,"number"):"2"==a?n.getDataByType(u[e].data,c,i,a):n.getDataByType(u[e].data,c,i,"0");let f=n.getDataIndex(t,l,u[e].index);h.push({data:s,index:f})}let r=e.extendNumber,c=[];if(r)for(let e=0;e<r.length;e++){let s,u=n.getLenS(r[e].index,o),h=r[e].index.length*d+u;s="1"==a||"3"==a?n.getDataByType(r[e].data,h,i,a,"extendNumber"):"2"==a?n.getDataByType(r[e].data,h,i,a):n.getDataByType(r[e].data,h,i,"0");let f=n.getDataIndex(t,l,r[e].index);c.push({data:s,index:f})}let f=e.date,m=[];if(f)for(let e=0;e<f.length;e++){let s,u=n.getLenS(f[e].index,o),h=f[e].index.length*d+u;s="1"==a||"3"==a?n.getDataByType(f[e].data,h,i,a,"date"):"8"==a?n.getDataByType(f[e].data,h,i,"0"):n.getDataByType(f[e].data,h,i,a);let r=n.getDataIndex(t,l,f[e].index);m.push({data:s,index:r})}let p=e.chnNumber,y=[];if(p)for(let e=0;e<p.length;e++){let s,u=n.getLenS(p[e].index,o),h=p[e].index.length*d+u;s="1"==a||"3"==a?n.getDataByType(p[e].data,h,i,a,"chnNumber"):"2"==a||"8"==a?n.getDataByType(p[e].data,h,i,a):n.getDataByType(p[e].data,h,i,"0");let r=n.getDataIndex(t,l,p[e].index);y.push({data:s,index:r})}let g=e.chnWeek2,v=[];if(g)for(let e=0;e<g.length;e++){let s,u=n.getLenS(g[e].index,o),h=g[e].index.length*d+u;s="1"==a||"3"==a?n.getDataByType(g[e].data,h,i,a,"chnWeek2"):"2"==a?n.getDataByType(g[e].data,h,i,a):n.getDataByType(g[e].data,h,i,"0");let r=n.getDataIndex(t,l,g[e].index);v.push({data:s,index:r})}let x=e.chnWeek3,k=[];if(x)for(let e=0;e<x.length;e++){let s,u=n.getLenS(x[e].index,o),h=x[e].index.length*d+u;s="1"==a||"3"==a?n.getDataByType(x[e].data,h,i,a,"chnWeek3"):"2"==a?n.getDataByType(x[e].data,h,i,a):n.getDataByType(x[e].data,h,i,"0");let r=n.getDataIndex(t,l,x[e].index);k.push({data:s,index:r})}let b=e.other,C=[];if(b)for(let e=0;e<b.length;e++){let s,u=n.getLenS(b[e].index,o),h=b[e].index.length*d+u;s="2"==a||"3"==a?n.getDataByType(b[e].data,h,i,a):n.getDataByType(b[e].data,h,i,"0");let r=n.getDataIndex(t,l,b[e].index);C.push({data:s,index:r})}for(let e=1;e<=l;e++){if(h.length>0)for(let t=0;t<h.length;t++)e in h[t].index&&s.push(h[t].data[h[t].index[e]]);if(c.length>0)for(let t=0;t<c.length;t++)e in c[t].index&&s.push(c[t].data[c[t].index[e]]);if(m.length>0)for(let t=0;t<m.length;t++)e in m[t].index&&s.push(m[t].data[m[t].index[e]]);if(y.length>0)for(let t=0;t<y.length;t++)e in y[t].index&&s.push(y[t].data[y[t].index[e]]);if(v.length>0)for(let t=0;t<v.length;t++)e in v[t].index&&s.push(v[t].data[v[t].index[e]]);if(k.length>0)for(let t=0;t<k.length;t++)e in k[t].index&&s.push(k[t].data[k[t].index[e]]);if(C.length>0)for(let t=0;t<C.length;t++)e in C[t].index&&s.push(C[t].data[C[t].index[e]])}return s},getLenS:function(e,t){let l=0;for(let n=0;n<e.length&&e[n]<=t;n++)l++;return l},getDataIndex:function(e,t,l){let n={},s=Math.floor(t/e),i=t%e,a=0;if(s>0){for(let t=1;t<=s;t++)for(let s=0;s<l.length;s++)n[l[s]+(t-1)*e]=a,a++;for(let t=0;t<l.length&&l[t]<=i;t++)n[l[t]+e*s]=a,a++}else for(let e=0;e<l.length&&l[e]<=i;e++)n[l[e]]=a,a++;return n},getDataByType:function(e,t,l,n,s){let i=this,a=[];if("0"==n)"up"!=l&&"left"!=l||e.reverse(),a=i.FillCopy(e,t);else if("1"==n)if("number"==s)a=i.FillSeries(e,t,l);else if("extendNumber"==s)if(1==e.length){let n;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1),a=i.FillExtendNumber(e,t,n)}else{let n=[];for(let t=0;t<e.length;t++){let l=e[t].m;n.push(Number(i.isExtendNumber(l)[1]))}if("up"!=l&&"left"!=l||(e.reverse(),n.reverse()),i.isEqualDiff(n)){let l=n[1]-n[0];a=i.FillExtendNumber(e,t,l)}else a=i.FillCopy(e,t)}else if("date"==s)if(1==e.length){let n;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1),a=i.FillDays(e,t,n)}else{"up"!=l&&"left"!=l||e.reverse();let n=i.judgeDate(e);if(n[0]&&n[3]){let l=f(e[1].m).diff(f(e[0].m),"months");a=i.FillMonths(e,t,l)}else if(!n[0]&&n[2]){let l=f(e[1].m).diff(f(e[0].m),"days");a=i.FillDays(e,t,l)}else a=i.FillCopy(e,t)}else if("chnNumber"==s)if(1==e.length)if("日"==e[0].m||i.ChineseToNumber(e[0].m)<7){let n;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1),a=i.FillChnWeek(e,t,n)}else{let n;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1),a=i.FillChnNumber(e,t,n)}else{let n=!1;for(let t=0;t<e.length;t++)if("日"==e[t].m){n=!0;break}let s=[],d=0;for(let t=0;t<e.length;t++)"日"==e[t].m?0==t?s.push(0):(d++,s.push(7*d)):n&&i.ChineseToNumber(e[t].m)>0&&i.ChineseToNumber(e[t].m)<7?s.push(i.ChineseToNumber(e[t].m)+7*d):s.push(i.ChineseToNumber(e[t].m));if("up"!=l&&"left"!=l||(e.reverse(),s.reverse()),i.isEqualDiff(s))if(n||s[s.length-1]<6&&s[0]>0||s[0]<6&&s[s.length-1]>0){let l=s[1]-s[0];a=i.FillChnWeek(e,t,l)}else{let l=s[1]-s[0];a=i.FillChnNumber(e,t,l)}else a=i.FillCopy(e,t)}else if("chnWeek2"==s)if(1==e.length){let n;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1),a=i.FillChnWeek2(e,t,n)}else{let n=[],s=0;for(let t=0;t<e.length;t++){let l=e[t].m.substr(e[t].m.length-1,1);"周日"==e[t].m?0==t?n.push(0):(s++,n.push(7*s)):n.push(i.ChineseToNumber(l)+7*s)}if("up"!=l&&"left"!=l||(e.reverse(),n.reverse()),i.isEqualDiff(n)){let l=n[1]-n[0];a=i.FillChnWeek2(e,t,l)}else a=i.FillCopy(e,t)}else if("chnWeek3"==s)if(1==e.length){let n;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1),a=i.FillChnWeek3(e,t,n)}else{let n=[],s=0;for(let t=0;t<e.length;t++){let l=e[t].m.substr(e[t].m.length-1,1);"星期日"==e[t].m?0==t?n.push(0):(s++,n.push(7*s)):n.push(i.ChineseToNumber(l)+7*s)}if("up"!=l&&"left"!=l||(e.reverse(),n.reverse()),i.isEqualDiff(n)){let l=n[1]-n[0];a=i.FillChnWeek3(e,t,l)}else a=i.FillCopy(e,t)}else"up"!=l&&"left"!=l||e.reverse(),a=i.FillCopy(e,t);else if("2"==n)"up"!=l&&"left"!=l||e.reverse(),a=i.FillOnlyFormat(e,t);else if("3"==n){let n=i.getDataByType(e,t,l,"1",s);a=i.FillWithoutFormat(n)}else if("4"==n)if(1==e.length){let n;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1),a=i.FillDays(e,t,n)}else if(2==e.length){"up"!=l&&"left"!=l||e.reverse();let n=f(e[1].m).diff(f(e[0].m),"days");a=i.FillDays(e,t,n)}else{"up"!=l&&"left"!=l||e.reverse();let n=i.judgeDate(e);if(n[0]&&n[3]){let l=f(e[1].m).diff(f(e[0].m),"months");a=i.FillMonths(e,t,l)}else if(!n[0]&&n[2]){let l=f(e[1].m).diff(f(e[0].m),"days");a=i.FillDays(e,t,l)}else a=i.FillCopy(e,t)}else if("5"==n)if(1==e.length){let n;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1);let s=Math.round(1.5*t);for(let l=1;l<=s;l++){let s=$.extend(!0,{},e[0]),i=f(s.m).add(l,"days").day();if(0==i||6==i)continue;let d=f(s.m).add(n*l,"days").format("YYYY-MM-DD");if(s.m=d,s.v=x(d)[2],a.push(s),a.length==t)break}}else if(2==e.length)if(f(e[1].m).date()==f(e[0].m).date()&&0!=f(e[1].m).diff(f(e[0].m),"months")){"up"!=l&&"left"!=l||e.reverse();let n=f(e[1].m).diff(f(e[0].m),"months");for(let l=1;l<=t;l++){let t,s=(l-1)%e.length,i=$.extend(!0,{},e[s]),d=f(e[e.length-1]).add(n*l,"months").day();t=0==d?f(e[e.length-1]).add(n*l,"months").subtract(2,"days").format("YYYY-MM-DD"):6==d?f(e[e.length-1]).add(n*l,"months").subtract(1,"days").format("YYYY-MM-DD"):f(e[e.length-1]).add(n*l,"months").format("YYYY-MM-DD"),i.m=t,i.v=x(t)[2],a.push(i)}}else if(Math.abs(f(e[1].m).diff(f(e[0].m)))>7){let n,s;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1,e.reverse());for(let l=1;l<=t;l++){let t=(l-1)%e.length,i=$.extend(!0,{},e[t]),d=Math.ceil(l/e.length);0==t&&(s=f(i.m).add(n*d,"months").diff(f(i.m),"days"));let o,u=f(i.m).add(s,"days").day();o=0==u?f(i.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6==u?f(i.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):f(i.m).add(s,"days").format("YYYY-MM-DD"),i.m=o,i.v=x(o)[2],a.push(i)}}else{let n,s;"down"==l||"right"==l?n=7:"up"!=l&&"left"!=l||(n=-7,e.reverse());for(let l=1;l<=t;l++){let t=(l-1)%e.length,i=$.extend(!0,{},e[t]),d=Math.ceil(l/e.length);0==t&&(s=f(i.m).add(n*d,"days").diff(f(i.m),"days"));let o,u=f(i.m).add(s,"days").day();o=0==u?f(i.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6==u?f(i.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):f(i.m).add(s,"days").format("YYYY-MM-DD"),i.m=o,i.v=x(o)[2],a.push(i)}}else{let n=i.judgeDate(e);if(n[0]&&n[3]){"up"!=l&&"left"!=l||e.reverse();let n=f(e[1].m).diff(f(e[0].m),"months");for(let l=1;l<=t;l++){let t,s=(l-1)%e.length,i=$.extend(!0,{},e[s]),d=f(e[e.length-1].m).add(n*l,"months").day();t=0==d?f(e[e.length-1].m).add(n*l,"months").subtract(2,"days").format("YYYY-MM-DD"):6==d?f(e[e.length-1].m).add(n*l,"months").subtract(1,"days").format("YYYY-MM-DD"):f(e[e.length-1].m).add(n*l,"months").format("YYYY-MM-DD"),i.m=t,i.v=x(t)[2],a.push(i)}}else if(!n[0]&&n[2])if(Math.abs(f(e[1].m).diff(f(e[0].m)))>7){let n,s;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1,e.reverse());for(let l=1;l<=t;l++){let t=(l-1)%e.length,i=$.extend(!0,{},e[t]),d=Math.ceil(l/e.length);0==t&&(s=f(i.m).add(n*d,"months").diff(f(i.m),"days"));let o,u=f(i.m).add(s,"days").day();o=0==u?f(i.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6==u?f(i.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):f(i.m).add(s,"days").format("YYYY-MM-DD"),i.m=o,i.v=x(o)[2],a.push(i)}}else{let n,s;"down"==l||"right"==l?n=7:"up"!=l&&"left"!=l||(n=-7,e.reverse());for(let l=1;l<=t;l++){let t=(l-1)%e.length,i=$.extend(!0,{},e[t]),d=Math.ceil(l/e.length);0==t&&(s=f(i.m).add(n*d,"days").diff(f(i.m),"days"));let o,u=f(i.m).add(s,"days").day();o=0==u?f(i.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6==u?f(i.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):f(i.m).add(s,"days").format("YYYY-MM-DD"),i.m=o,i.v=x(o)[2],a.push(i)}}else"up"!=l&&"left"!=l||e.reverse(),a=i.FillCopy(e,t)}else if("6"==n)if(1==e.length){let n;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1),a=i.FillMonths(e,t,n)}else if(2==e.length)if(f(e[1].m).date()==f(e[0].m).date()&&0!=f(e[1].m).diff(f(e[0].m),"months")){"up"!=l&&"left"!=l||e.reverse();let n=f(e[1].m).diff(f(e[0].m),"months");a=i.FillMonths(e,t,n)}else{let n,s;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1,e.reverse());for(let l=1;l<=t;l++){let t=(l-1)%e.length,i=$.extend(!0,{},e[t]),d=Math.ceil(l/e.length);0==t&&(s=f(i.m).add(n*d,"months").diff(f(i.m),"days"));let o=f(i.m).add(s,"days").format("YYYY-MM-DD");i.m=o,i.v=x(o)[2],a.push(i)}}else{let n=i.judgeDate(e);if(n[0]&&n[3]){"up"!=l&&"left"!=l||e.reverse();let n=f(e[1].m).diff(f(e[0].m),"months");a=i.FillMonths(e,t,n)}else if(!n[0]&&n[2]){let n,s;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1,e.reverse());for(let l=1;l<=t;l++){let t=(l-1)%e.length,i=$.extend(!0,{},e[t]),d=Math.ceil(l/e.length);0==t&&(s=f(i.m).add(n*d,"months").diff(f(i.m),"days"));let o=f(i.m).add(s,"days").format("YYYY-MM-DD");i.m=o,i.v=x(o)[2],a.push(i)}}else"up"!=l&&"left"!=l||e.reverse(),a=i.FillCopy(e,t)}else if("7"==n)if(1==e.length){let n;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1),a=i.FillYears(e,t,n)}else if(2==e.length)if(f(e[1].m).date()==f(e[0].m).date()&&f(e[1].m).month()==f(e[0].m).month()&&0!=f(e[1].m).diff(f(e[0].m),"years")){"up"!=l&&"left"!=l||e.reverse();let n=f(e[1].m).diff(f(e[0].m),"years");a=i.FillYears(e,t,n)}else{let n,s;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1,e.reverse());for(let l=1;l<=t;l++){let t=(l-1)%e.length,i=$.extend(!0,{},e[t]),d=Math.ceil(l/e.length);0==t&&(s=f(i.m).add(n*d,"years").diff(f(i.m),"days"));let o=f(i.m).add(s,"days").format("YYYY-MM-DD");i.m=o,i.v=x(o)[2],a.push(i)}}else{let n=i.judgeDate(e);if(n[0]&&n[1]&&n[4]){"up"!=l&&"left"!=l||e.reverse();let n=f(e[1].m).diff(f(e[0].m),"years");a=i.FillYears(e,t,n)}else if(n[0]&&n[3]||n[2]){let n,s;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1,e.reverse());for(let l=1;l<=t;l++){let t=(l-1)%e.length,i=$.extend(!0,{},e[t]),d=Math.ceil(l/e.length);0==t&&(s=f(i.m).add(n*d,"years").diff(f(i.m),"days"));let o=f(i.m).add(s,"days").format("YYYY-MM-DD");i.m=o,i.v=x(o)[2],a.push(i)}}else"up"!=l&&"left"!=l||e.reverse(),a=i.FillCopy(e,t)}else if("8"==n)if(1==e.length){let n;"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1),a=i.FillChnNumber(e,t,n)}else{let n=[];for(let t=0;t<e.length;t++)n.push(i.ChineseToNumber(e[t].m));if("up"!=l&&"left"!=l||(e.reverse(),n.reverse()),i.isEqualDiff(n)){let l=n[1]-n[0];a=i.FillChnNumber(e,t,l)}else a=i.FillCopy(e,t)}return a},FillCopy:function(e,t){let l=[];for(let n=1;n<=t;n++){let t=(n-1)%e.length,s=$.extend(!0,{},e[t]);l.push(s)}return l},FillSeries:function(e,t,l){let n=this,s=[],i=[];for(let t=0;t<e.length;t++)i.push(Number(e[t].v));if(e.length>2&&n.isEqualRatio(i))for(let n=1;n<=t;n++){let t,i=(n-1)%e.length,a=$.extend(!0,{},e[i]);"down"==l||"right"==l?t=Number(e[e.length-1].v)*Math.pow(Number(e[1].v)/Number(e[0].v),n):"up"!=l&&"left"!=l||(t=Number(e[0].v)/Math.pow(Number(e[1].v)/Number(e[0].v),n)),a.v=t,a.m=k(a.ct.fa,t),s.push(a)}else{let a=n.getXArr(e.length);for(let d=1;d<=t;d++){let t,o=(d-1)%e.length,u=$.extend(!0,{},e[o]);"down"==l||"right"==l?t=n.forecast(e.length+d,i,a):"up"!=l&&"left"!=l||(t=n.forecast(1-d,i,a)),u.v=t,u.m=k(u.ct.fa,t),s.push(u)}}return s},FillExtendNumber:function(e,t,l){let n=[],s=/0|([1-9]+[0-9]*)/g;for(let i=1;i<=t;i++){let t=(i-1)%e.length,a=$.extend(!0,{},e[t]),d=e[e.length-1].m,o=d.match(s),u=o[o.length-1],h=Math.abs(Number(u)+l*i),r=d.lastIndexOf(u),c=d.substr(0,r)+h.toString()+d.substr(r+u.length);a.v=c,a.m=c,n.push(a)}return n},FillOnlyFormat:function(e,t){let l=[];for(let n=1;n<=t;n++){let t=(n-1)%e.length,s=$.extend(!0,{},e[t]);delete s.f,delete s.m,delete s.v,l.push(s)}return l},FillWithoutFormat:function(e){let t=[];for(let l=0;l<e.length;l++){let n,s=$.extend(!0,{},e[l]);n=null==s.f?{m:s.v.toString(),v:s.v}:{f:s.f,m:s.v.toString(),v:s.v},t.push(n)}return t},FillDays:function(e,t,l){let n=[];for(let s=1;s<=t;s++){let t=(s-1)%e.length,i=$.extend(!0,{},e[t]),a=k("yyyy-MM-dd",i.v);a=f(a).add(l*s,"days").format("YYYY-MM-DD"),i.v=x(a)[2],i.m=k(i.ct.fa,i.v),n.push(i)}return n},FillMonths:function(e,t,l){let n=[];for(let s=1;s<=t;s++){let t=(s-1)%e.length,i=$.extend(!0,{},e[t]),a=k("yyyy-MM-dd",i.v);a=f(a).add(l*s,"months").format("YYYY-MM-DD"),i.v=x(a)[2],i.m=k(i.ct.fa,i.v),n.push(i)}return n},FillYears:function(e,t,l){let n=[];for(let s=1;s<=t;s++){let t=(s-1)%e.length,i=$.extend(!0,{},e[t]),a=k("yyyy-MM-dd",i.v);a=f(a).add(l*s,"years").format("YYYY-MM-DD"),i.v=x(a)[2],i.m=k(i.ct.fa,i.v),n.push(i)}return n},FillChnWeek:function(e,t,l){let n=this,s=[];for(let i=1;i<=t;i++){let t,a=(i-1)%e.length,d=$.extend(!0,{},e[a]);(t="日"==e[e.length-1].m?7+l*i:n.ChineseToNumber(e[e.length-1].m)+l*i)<0&&(t=7*Math.ceil(Math.abs(t)/7)+t);let o=t%7;0==o?(d.m="日",d.v="日"):1==o?(d.m="一",d.v="一"):2==o?(d.m="二",d.v="二"):3==o?(d.m="三",d.v="三"):4==o?(d.m="四",d.v="四"):5==o?(d.m="五",d.v="五"):6==o&&(d.m="六",d.v="六"),s.push(d)}return s},FillChnWeek2:function(e,t,l){let n=this,s=[];for(let i=1;i<=t;i++){let t,a=(i-1)%e.length,d=$.extend(!0,{},e[a]);if("周日"==e[e.length-1].m)t=7+l*i;else{let s=e[e.length-1].m,a=s.substr(s.length-1,1);t=n.ChineseToNumber(a)+l*i}t<0&&(t=7*Math.ceil(Math.abs(t)/7)+t);let o=t%7;0==o?(d.m="周日",d.v="周日"):1==o?(d.m="周一",d.v="周一"):2==o?(d.m="周二",d.v="周二"):3==o?(d.m="周三",d.v="周三"):4==o?(d.m="周四",d.v="周四"):5==o?(d.m="周五",d.v="周五"):6==o&&(d.m="周六",d.v="周六"),s.push(d)}return s},FillChnWeek3:function(e,t,l){let n=this,s=[];for(let i=1;i<=t;i++){let t,a=(i-1)%e.length,d=$.extend(!0,{},e[a]);if("星期日"==e[e.length-1].m)t=7+l*i;else{let s=e[e.length-1].m,a=s.substr(s.length-1,1);t=n.ChineseToNumber(a)+l*i}t<0&&(t=7*Math.ceil(Math.abs(t)/7)+t);let o=t%7;0==o?(d.m="星期日",d.v="星期日"):1==o?(d.m="星期一",d.v="星期一"):2==o?(d.m="星期二",d.v="星期二"):3==o?(d.m="星期三",d.v="星期三"):4==o?(d.m="星期四",d.v="星期四"):5==o?(d.m="星期五",d.v="星期五"):6==o&&(d.m="星期六",d.v="星期六"),s.push(d)}return s},FillChnNumber:function(e,t,l){let n=this,s=[];for(let i=1;i<=t;i++){let t,a=(i-1)%e.length,d=$.extend(!0,{},e[a]),o=n.ChineseToNumber(e[e.length-1].m)+l*i;t=o<=0?"零":n.NumberToChinese(o),d.v=t,d.m=t.toString(),s.push(d)}return s},isEqualDiff:function(e){let t=!0,l=e[1]-e[0];for(let n=1;n<e.length;n++)if(e[n]-e[n-1]!=l){t=!1;break}return t},isEqualRatio:function(e){let t=!0,l=e[1]/e[0];for(let n=1;n<e.length;n++)if(e[n]/e[n-1]!=l){t=!1;break}return t},getXArr:function(e){let t=[];for(let l=1;l<=e;l++)t.push(l);return t},forecast:function(e,t,l){function n(e){let t=0;for(let l=0;l<e.length;l++)t+=e[l];return t/e.length}let s,i=n(l),a=n(t),d=0,o=0;for(let e=0;e<l.length;e++)d+=(l[e]-i)*(t[e]-a),o+=(l[e]-i)*(l[e]-i);let u=a-(s=0==o?1:d/o)*i;return Math.round(1e5*(u+s*e))/1e5},judgeDate:function(e){let t=!0,l=!0,n=!0,s=!0,i=!0,a=f(e[0].m).date(),d=f(e[0].m).month(),o=f(e[1].m).diff(f(e[0].m),"days"),u=f(e[1].m).diff(f(e[0].m),"months"),h=f(e[1].m).diff(f(e[0].m),"years");for(let r=1;r<e.length;r++)f(e[r].m).date()!=a&&(t=!1),f(e[r].m).month()!=d&&(l=!1),f(e[r].m).diff(f(e[r-1].m),"days")!=o&&(n=!1),f(e[r].m).diff(f(e[r-1].m),"months")!=u&&(s=!1),f(e[r].m).diff(f(e[r-1].m),"years")!=h&&(i=!1);return 0==o&&(n=!1),0==u&&(s=!1),0==h&&(i=!1),[t,l,n,s,i]}}});
//# sourceMappingURL=../sourcemaps/controllers/dropCell.js.map
